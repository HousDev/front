var Eg=Object.defineProperty;var Mg=(s,a,t)=>a in s?Eg(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var xo=(s,a,t)=>Mg(s,typeof a!="symbol"?a+"":a,t);import{R as Ps,j as e,r as l,y as Z,T as Xa,C as ct,a as bs,I as zc,X as ns,u as Jr,N as ar,U as Lg,b as Ms,c as qr,F as ws,d as Rs,e as Ns,M as Dg,B as Is,P as _l,S as dl,f as Ls,A as jt,E as ks,g as _a,h as Es,i as ha,k as Yt,L as eo,H as yt,l as ln,G as _t,m as rt,n as La,o as tt,p as Rg,q as Pa,s as at,t as Bt,W as nn,v as Ot,Z as Ft,D as Vr,w as Ys,x as it,z as Bs,J as ea,K as pa,O as so,Q as zg,V as uu,Y as va,_ as On,$ as Xs,a0 as gt,a1 as Gr,a2 as Ut,a3 as Xt,a4 as Yn,a5 as Sr,a6 as kr,a7 as Cr,a8 as Dt,a9 as Ds,aa as Il,ab as Fg,ac as Bg,ad as Wa,ae as to,af as ml,ag as vr,ah as uo,ai as jd,aj as er,ak as $i,al as ao,am as Og,an as Ug,ao as vd,ap as qg,aq as Vg,ar as Wg,as as fl,at as Nd,au as Hg,av as Yg,aw as wd,ax as Hl,ay as Gg,az as jl,aA as Kg,aB as Sl,aC as Fc,aD as Zl,aE as Jg,aF as Un,aG as Qg,aH as _d,aI as zt,aJ as Zn,aK as Zg,aL as Xg,aM as Sd,aN as kd,aO as Bc,aP as Oc,aQ as eh,aR as Nr,aS as Qs,aT as Gn,aU as Sa,aV as sh,aW as on,aX as Ca,aY as ga,aZ as Wt,a_ as kl,a$ as En,b0 as Mt,b1 as Oi,b2 as la,b3 as Cs,b4 as Ia,b5 as Ts,b6 as Ra,b7 as sr,b8 as qn,b9 as fs,ba as dt,bb as ft,bc as $l,bd as Kr,be as cn,bf as Va,bg as Cl,bh as Ct,bi as Uc,bj as dn,bk as ro,bl as Xl,bm as gu,bn as dr,bo as hu,bp as ka,bq as Na,br as th,bs as ah,bt as rh,bu as lh,bv as nh,bw as ih,bx as oh,by as ch,bz as pu,bA as ja,bB as Kn,bC as na,bD as dh,bE as qc,bF as Wr,bG as Ta,bH as ut,bI as pc,bJ as Ui,bK as Vc,bL as mn,bM as Jn,bN as za,bO as mh,bP as xh,bQ as uh,bR as gh,bS as Ei,bT as lo,bU as an,bV as hh,bW as bu,bX as mr,bY as fu,bZ as yu,b_ as Mi,b$ as xr,c0 as ju,c1 as ph,c2 as El,c3 as Vn,c4 as vu,c5 as Nu,c6 as Al,c7 as bh,c8 as fh,c9 as wu,ca as yh,cb as Cd,cc as Li,cd as _u,ce as Su,cf as vl,cg as en,ch as jh,ci as vh,cj as Nh,ck as wh,cl as rn,cm as ku,cn as Wc,co as qi,cp as Vi,cq as Hc,cr as Yc,cs as Gc,ct as Kc,cu as Jc,cv as Qc,cw as Zc,cx as Xc,cy as ed,cz as sd,cA as td,cB as _h,cC as Sh,cD as kh,cE as Ch,cF as Ah,cG as Ph,cH as Cu,cI as Au,cJ as Th,cK as Ad,cL as Ih,cM as $h,cN as Eh,cO as Mh,cP as bc,cQ as Lh,cR as Dh,cS as Rh,cT as zh,cU as Ks,cV as Fh}from"./vendor-react-BwvM2Qs0.js";import{Q as Pu,R as Bh,f as $a,U as Gl,X as ad,V as Oh,W as Uh,Y as Xn,Z as ei,_ as qh,$ as Vh,N as Tu}from"./vendor-H0auLbCv.js";import{p as Wh}from"./vendor-purify-CGs5VtEq.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();const Hh=s=>s instanceof Error?s.message+`
`+s.stack:JSON.stringify(s,null,2);class Yh extends Ps.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}render(){return this.state.hasError?e.jsxs("div",{className:"p-4 border border-red-500 rounded",children:[e.jsx("h2",{className:"text-red-500",children:"Something went wrong."}),e.jsx("pre",{className:"mt-2 text-sm",children:Hh(this.state.error)})]}):this.props.children}}const Gh="http://localhost:3000/api/",Kh="https://investordeal.in/api/",Jh=typeof window<"u",Qh=Jh&&/(?:^|\.)investordeal\.in$/i.test(window.location.hostname),Zh=(Qh?Kh:Gh).replace(/\/?$/,"/"),Ae=Pu.create({baseURL:Zh,timeout:6e4,headers:{"Content-Type":"application/json"}});Ae.interceptors.request.use(s=>(typeof FormData<"u"&&s.data instanceof FormData&&s.headers&&(delete s.headers["Content-Type"],s.headers.common&&delete s.headers.common["Content-Type"],s.headers.post&&delete s.headers.post["Content-Type"]),s));Ae.interceptors.request.use(s=>{const a=localStorage.getItem("token");return a&&(s.headers=s.headers??{},s.headers.Authorization=`Bearer ${a}`),s},s=>Promise.reject(s));Ae.interceptors.response.use(s=>s,s=>{var a;return((a=s.response)==null?void 0:a.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(s)});const Ha={login:async s=>(await Ae.post("/auth/signin",s)).data,register:async s=>(await Ae.post("/auth/signup",s)).data,refreshToken:async()=>(await Ae.post("/auth/refresh-token")).data,logout:async()=>(await Ae.post("/auth/logout")).data,getCurrentUser:async()=>(await Ae.get("/auth/me")).data,getProfile:async()=>(await Ae.get("/auth/profile")).data},Os={getProfile:async()=>(await Ae.get("/users/profile")).data,updateProfile:async s=>(await Ae.put("/users/profile",s)).data,changePassword:async s=>(await Ae.patch("/users/change-password",s)).data,getAllUsers:async s=>(await Ae.get("/users/get-all-user",{params:s})).data,getSalesExecutives:async()=>(await Ae.get("/users/filter",{params:{department:"Sales",role:"Sales Executive"}})).data,getUsersByFilter:async s=>(await Ae.get("/users/filter",{params:s})).data,getAgents:async()=>(await Ae.get("/users/agents")).data,getDashboardStats:async()=>(await Ae.get("/users/dashboard-stats")).data,updateUser:async(s,a)=>(await Ae.put(`/users/update/${s}`,a)).data,deleteUser:async s=>(await Ae.delete(`/users/delete/${s}`)).data,createUser:async s=>(await Ae.post("/users/create",s)).data,exportUsers:async()=>(await Ae.get("/users/export")).data,filterData:async s=>(await Ae.get("/users/filter",{params:s})).data,uploadAvatar:async s=>(await Ae.post("/users/upload-avatar",s,{headers:{"Content-Type":"multipart/form-data"}})).data,removeAvatar:async()=>(await Ae.delete("/users/remove-avatar")).data,getUserById:async s=>(await Ae.get(`/users/get-user-by/${s}`)).data,getSalesExecutivesByRoute:async s=>(await Ae.get("/users/sales-executives",{params:s})).data,getByDeptRole:async s=>(await Ae.get("/users/by-dept-role",{params:s})).data},Et={getLeads:async s=>(await Ae.get("/leads",{params:s})).data,exportLeads:async()=>(await Ae.get("/leads/export")).data,getScheduledViewings:async()=>(await Ae.get("/leads/scheduled-viewings")).data,getLead:async s=>(await Ae.get(`/leads/${s}`)).data,createLead:async s=>(await Ae.post("/leads",s)).data,updateLead:async(s,a)=>(await Ae.put(`/leads/${s}`,a)).data,deleteLead:async s=>(await Ae.delete(`/leads/${s}`)).data,bulkDeleteLeads:s=>Ae.delete("/leads/bulk/delete",{data:s}),bulkUpdateLeads:async s=>(await Ae.patch("/leads/bulk-status",s)).data,assignToExecutive:async(s,a)=>(await Ae.patch(`/leads/${s}/assign`,a)).data,bulkAssignExecutives:async s=>(await Ae.patch("/leads/bulk/assign-executive",s)).data,importLeads:async s=>(await Ae.post("/leads/import",s)).data,assignToAgent:async(s,a)=>(await Ae.patch(`/leads/${s}/assign`,a)).data,getStats:async()=>(await Ae.get("/leads/stats")).data},si={getActivities:async s=>(await Ae.get("/activities",{params:s})).data,getActivity:async s=>(await Ae.get(`/activities/${s}`)).data,createActivity:async s=>(await Ae.post("/activities",s)).data,updateActivity:async(s,a)=>(await Ae.put(`/activities/${s}`,a)).data,deleteActivity:async s=>(await Ae.delete(`/activities/${s}`)).data,complete:async(s,a)=>(await Ae.patch(`/activities/${s}/complete`,a)).data,cancel:async(s,a)=>(await Ae.patch(`/activities/${s}/cancel`,a)).data,getUpcoming:async s=>(await Ae.get("/activities/upcoming",{params:s})).data,getToday:async s=>(await Ae.get("/activities/today",{params:s})).data,getStats:async()=>(await Ae.get("/activities/stats")).data},Xh={getAnalytics:async s=>(await Ae.get("/analytics",{params:s})).data,exportAnalytics:async s=>(await Ae.get("/analytics/export",{params:s})).data},_r={getSettings:async()=>{try{return(await Ae.get("/public/system-settings")).data}catch{return(await Ae.get("/system-settings")).data}},saveSettings:async s=>{const a=s instanceof FormData;return(await Ae.post("/system-settings",s,{headers:a?{"Content-Type":"multipart/form-data"}:{}})).data}},Iu=l.createContext(null),ur=()=>{const s=l.useContext(Iu);if(s===null)throw new Error("useSystemSettings must be used within a SystemSettingsProvider");return s},Pd=()=>{var s;if(typeof window>"u")return null;try{const a=(s=window.localStorage)==null?void 0:s.getItem("systemSettings");if(a)return JSON.parse(a)}catch(a){console.warn("Failed to parse stored system settings:",a)}return null},ep=s=>{var a;if(!(typeof window>"u"))try{(a=window.localStorage)==null||a.setItem("systemSettings",JSON.stringify(s))}catch(t){console.warn("Failed to store system settings:",t)}},Qr=s=>{if(!s)return s;try{return new URL(s,window.location.origin).toString()}catch{return s}},$u=({children:s})=>{const[a,t]=l.useState(()=>Pd()),[r,i]=l.useState(!1),[n,o]=l.useState(!1),[m,g]=l.useState(null);l.useEffect(()=>{a&&ep(a)},[a]),l.useEffect(()=>{if(!(typeof window>"u"))try{let P=document.querySelector("link[rel~='icon']")||null;P||(P=document.createElement("link"),P.rel="icon",document.head.appendChild(P)),P.href=(a==null?void 0:a.company_favicon)||"",a!=null&&a.company_name&&(document.title=a.company_name)}catch(P){console.warn("Failed to update favicon/title:",P)}},[a==null?void 0:a.company_favicon,a==null?void 0:a.company_name]);const b=l.useCallback(()=>{g(null)},[]),d=l.useCallback(async()=>{try{i(!0),g(null);const P=await _r.getSettings();if(P!=null&&P.data){const w={...P.data,company_logo:Qr(P.data.company_logo),footer_logo:Qr(P.data.footer_logo),company_favicon:Qr(P.data.company_favicon)};t(w)}else throw new Error((P==null?void 0:P.message)||"Failed to load system settings")}catch(P){console.error("Error fetching system settings:",P),g((P==null?void 0:P.message)||"Failed to load system settings");const w=Pd();t(w||null)}finally{i(!1)}},[]);l.useEffect(()=>{d()},[d]);const v=l.useCallback(P=>{t(w=>w?{...w,...P}:{...P}),g(null)},[]),x=l.useCallback(async()=>{var P,w;if(!a)throw new Error("No system settings to save");try{o(!0),g(null);const $=new FormData;Object.entries(a).forEach(([k,R])=>{R!=null&&$.append(k,String(R))});const y=await _r.saveSettings($);if(y!=null&&y.success&&y.data){const k={...y.data,company_logo:Qr(y.data.company_logo),footer_logo:Qr(y.data.footer_logo),company_favicon:Qr(y.data.company_favicon)};t(k),Z.success("System settings updated successfully")}else throw new Error((y==null?void 0:y.message)||"Failed to update system settings")}catch($){console.error("Error updating system settings:",$);const y=((w=(P=$==null?void 0:$.response)==null?void 0:P.data)==null?void 0:w.message)||($==null?void 0:$.message)||"Failed to update system settings";throw g(y),Z.error(y),$}finally{o(!1)}},[a]),u=l.useCallback(async()=>{try{await d(),Z.success("System settings refreshed successfully")}catch{Z.error("Failed to refresh system settings")}},[d]),c=l.useCallback(async(P,w)=>{if(!P)return;if(!P.type.startsWith("image/")){Z.error("Please upload a valid image file");return}const $=(a==null?void 0:a.max_file_size)||5*1024*1024;if(P.size>$){Z.error(`File size must be less than ${($/1024/1024).toFixed(1)}MB`);return}try{const y=new FormData;y.append(w,P);const k=await _r.saveSettings(y);if(k!=null&&k.success&&k.data){const R=k.data[w];R&&(t(F=>({...F||{},[w]:Qr(`${R}?t=${Date.now()}`)})),await d())}else throw new Error((k==null?void 0:k.message)||"Failed to upload image")}catch(y){console.error("Error uploading file:",y);const k=(y==null?void 0:y.message)||"Failed to upload file";g(k),Z.error(k)}},[a==null?void 0:a.max_file_size,d]),f=l.useCallback(P=>{t(w=>({...w||{},[P]:""})),Z.info(`${P.replace("_"," ")} removed from settings`),g(null)},[]),p=l.useCallback(()=>{t(null),typeof window<"u"&&localStorage.removeItem("systemSettings")},[]),N={systemSettings:a,loading:r,saving:n,error:m,updateSystemSettings:v,saveSystemSettings:x,refreshSystemSettings:u,handleFileUpload:c,handleFileRemove:f,resetError:b,clearSettings:p};return e.jsx(Iu.Provider,{value:N,children:s})},go=()=>{["token","user","systemSettings","activityHistory","loginDate","todayLoginTime","theme","filters"].forEach(a=>localStorage.removeItem(a))},Eu=l.createContext(void 0),Hs=()=>{const s=l.useContext(Eu);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},sp=({children:s})=>{const[a,t]=l.useState(null),[r,i]=l.useState(!0),{clearSettings:n}=ur(),o=c=>{if(!c||typeof c!="object")return null;let f={};try{if(c.module_permissions)if(typeof c.module_permissions=="string")try{f=JSON.parse(c.module_permissions)}catch(p){console.warn("Failed to parse module_permissions JSON:",p),f={}}else typeof c.module_permissions=="object"&&c.module_permissions!==null&&(f=c.module_permissions)}catch(p){console.warn("Error handling module_permissions:",p),f={}}try{return{id:c.id,username:c.username||"",email:c.email||"",first_name:c.first_name||"",last_name:c.last_name||"",salutation:c.salutation||"",role:String(c.role||"").toLowerCase(),phone:c.phone||"",avatar:c.avatar||"",designation:c.designation||"",department:c.department||"",is_active:!!c.is_active,buyer_id:c.buyer_id??null,seller_id:c.seller_id??null,created_at:c.created_at||"",last_login:c.last_login||"",dob:c.dob||"",blood_group:c.blood_group||"",module_permissions:f}}catch(p){return console.error("Error validating user data:",p),null}};l.useEffect(()=>{(async()=>{try{const f=localStorage.getItem("token"),p=localStorage.getItem("user");if(f&&p){const N=JSON.parse(p),P=o(N);if(P)t(P);else{go(),n(),t(null),i(!1);return}try{const w=Ha.getCurrentUser&&await Ha.getCurrentUser()||Ha.getProfile&&await Ha.getProfile();if(w!=null&&w.success&&w.data){const $=o(w.data);$&&(t($),localStorage.setItem("user",JSON.stringify($)))}}catch(w){console.warn("Optional user refresh failed:",w)}}else t(null)}catch(f){console.error("Auth initialization error:",f),go(),n(),t(null)}finally{i(!1)}})()},[n]);const u={user:a,loading:r,login:async c=>{var f,p;try{const N=await Ha.login(c);if(!N.success||!N.data)throw new Error(N.message||"Login failed");const{user:P,accessToken:w}=N.data,$=o(P);if(!$)throw new Error("Invalid user data received from server");return localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify($)),t($),$}catch(N){throw console.error("âŒ [LOGIN] Error:",N),new Error(((p=(f=N==null?void 0:N.response)==null?void 0:f.data)==null?void 0:p.message)||N.message||"Login failed")}},register:async c=>{var f,p;try{const N=await Ha.register(c);if(!N.success||!N.data)throw new Error(N.message||"Registration failed");const{user:P,accessToken:w}=N.data,$=o(P);if(!$)throw new Error("Invalid user data received from server");return localStorage.setItem("token",w),localStorage.setItem("user",JSON.stringify($)),t($),$}catch(N){throw console.error("âŒ [REGISTER] Error:",N),new Error(((p=(f=N==null?void 0:N.response)==null?void 0:f.data)==null?void 0:p.message)||N.message||"Registration failed")}},logout:async()=>{try{await Ha.logout()}catch(c){console.error("Logout error:",c)}finally{go(),n(),t(null)}},isAuthenticated:!!a,hasRole:c=>{if(!a||!a.role)return!1;const f=a.role.toLowerCase(),p=Array.isArray(c)?c.map(N=>N.toLowerCase()):[c.toLowerCase()];return!!(p.includes(f)||f==="admin"||f==="manager"&&p.some(N=>["agent","executive"].includes(N))||f==="executive"&&p.includes("agent"))},updateUser:c=>{t(f=>{if(!f)return f;const p={...f,...c},N=o(p);return N?(localStorage.setItem("user",JSON.stringify(N)),N):f})},refreshUser:async()=>{try{if(!localStorage.getItem("token"))return;const f=Ha.getCurrentUser&&await Ha.getCurrentUser()||Ha.getProfile&&await Ha.getProfile();if(f!=null&&f.success&&f.data){const p=o(f.data);p&&(t(p),localStorage.setItem("user",JSON.stringify(p)))}}catch(c){console.error("Error refreshing user:",c)}}};return e.jsx(Eu.Provider,{value:u,children:s})},tp=l.createContext({workTime:0,breakTime:0,totalTime:0,isOnBreak:!1,isLoggedIn:!1,sessionStartTime:null,breakStartTime:null,startBreak:()=>{},endBreak:()=>{},login:()=>{},logout:()=>{},leadsViewed:0,leadsContacted:0,followUpsCompleted:0,notesAdded:0,incrementLead:s=>{}}),ap=({children:s})=>{const[a,t]=l.useState(0),[r,i]=l.useState(0),[n,o]=l.useState(0),[m,g]=l.useState(!1),[b,d]=l.useState(!1),[v,x]=l.useState(null),[u,c]=l.useState(null),[f,p]=l.useState(0),[N,P]=l.useState(0),[w,$]=l.useState(0),[y,k]=l.useState(0),[R,F]=l.useState(0);l.useEffect(()=>{const B=localStorage.getItem("sessionStartTime"),M=localStorage.getItem("loginDate"),A=new Date().toDateString();if(B&&M===A){d(!0),x(parseInt(B));const L=JSON.parse(localStorage.getItem("todayMetrics")||"{}");P(L.leadsViewed||0),$(L.leadsContacted||0),k(L.followUpsCompleted||0),F(L.notesAdded||0),p(L.totalBreakTime||0)}},[]),l.useEffect(()=>{if(!b||!v)return;const B=setInterval(()=>{const M=Date.now(),A=Math.floor((M-v)/1e3);if(o(A),m&&u){const L=Math.floor((M-u)/1e3);i(f+L),t(A-(f+L))}else t(A-f),i(f)},1e3);return()=>clearInterval(B)},[b,v,m,u,f]),l.useEffect(()=>{if(b){const B={leadsViewed:N,leadsContacted:w,followUpsCompleted:y,notesAdded:R,totalBreakTime:f};localStorage.setItem("todayMetrics",JSON.stringify(B))}},[N,w,y,R,f,b]);const T=()=>{const B=Date.now();d(!0),x(B),t(0),i(0),o(0),p(0),localStorage.setItem("sessionStartTime",B.toString()),localStorage.setItem("loginDate",new Date().toDateString());const M=[{id:B,label:"Session Started",type:"login",time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),timestamp:B}];localStorage.setItem("todayTimeline",JSON.stringify(M)),P(0),$(0),k(0),F(0)},j=()=>{const B=JSON.parse(localStorage.getItem("todayTimeline")||"[]");B.push({id:Date.now(),label:"Session Ended",type:"logout",time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),timestamp:Date.now()}),localStorage.setItem("todayTimeline",JSON.stringify(B)),d(!1),x(null),c(null),g(!1),localStorage.removeItem("sessionStartTime"),localStorage.removeItem("loginDate")},E=()=>{if(!m){const B=Date.now();g(!0),c(B)}},V=()=>{if(m&&u){const B=Date.now(),M=Math.floor((B-u)/1e3);p(A=>A+M),g(!1),c(null)}},W=B=>{switch(B){case"viewed":P(M=>M+1);break;case"contacted":$(M=>M+1);break;case"followup":k(M=>M+1);break;case"note":F(M=>M+1);break}};return e.jsx(tp.Provider,{value:{workTime:a,breakTime:r,totalTime:n,isOnBreak:m,isLoggedIn:b,sessionStartTime:v,breakStartTime:u,startBreak:E,endBreak:V,login:T,logout:j,leadsViewed:N,leadsContacted:w,followUpsCompleted:y,notesAdded:R,incrementLead:W},children:s})},Wi={toasts:[]},fc=new Set,Mu=()=>{fc.forEach(s=>s())},Mn=s=>{const a=Math.random().toString(36).substr(2,9),t={...s,id:a,duration:s.duration??5e3};return Wi.toasts.push(t),Mu(),t.duration&&t.duration>0&&setTimeout(()=>{Lu(a)},t.duration),a},Lu=s=>{const a=Wi.toasts.findIndex(t=>t.id===s);a>-1&&(Wi.toasts.splice(a,1),Mu())},rp=()=>{const[,s]=l.useState(0),a=l.useCallback(()=>{const t=()=>s(r=>r+1);return fc.add(t),()=>{fc.delete(t)}},[]);return Ps.useEffect(()=>a(),[a]),{toasts:Wi.toasts,toast:Mn,dismiss:Lu}},wt={success:(s,a)=>Mn({title:a,description:s,variant:"success"}),error:(s,a)=>Mn({title:a||"Error",description:s,variant:"destructive"}),warning:(s,a)=>Mn({title:a,description:s,variant:"warning"}),info:(s,a)=>Mn({title:a,description:s,variant:"default"})};function $t(...s){return Bh($a(s))}const lp={default:zc,success:bs,destructive:ct,warning:Xa},np={default:"bg-white border-gray-200 text-gray-900",success:"bg-green-50 border-green-200 text-green-900",destructive:"bg-red-50 border-red-200 text-red-900",warning:"bg-yellow-50 border-yellow-200 text-yellow-900"};function ip(){const{toasts:s,dismiss:a}=rp();return e.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm w-full",children:s.map(t=>{const r=lp[t.variant||"default"];return e.jsxs("div",{className:$t("relative flex items-start gap-3 p-4 rounded-lg border shadow-lg animate-in slide-in-from-top-2",np[t.variant||"default"]),children:[e.jsx(r,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[t.title&&e.jsx("div",{className:"font-medium text-sm",children:t.title}),t.description&&e.jsx("div",{className:"text-sm opacity-90",children:t.description}),t.action&&e.jsx("div",{className:"mt-2",children:t.action})]}),e.jsx("button",{onClick:()=>a(t.id),className:"flex-shrink-0 p-1 rounded-full hover:bg-black/10 transition-colors",children:e.jsx(ns,{className:"h-4 w-4"})})]},t.id)})})}const op={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"},ia=({size:s="md",className:a})=>e.jsx("div",{className:$t("flex items-center justify-center",a),children:e.jsx("div",{className:$t("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",op[s])})}),ho=({children:s,roles:a})=>{var b,d;const{user:t,loading:r,isAuthenticated:i,hasRole:n}=Hs(),o=Jr(),m=o.pathname;if(!!Gl("/session/:id",m)||!!Gl("/artifacts/:id",m))return e.jsx(e.Fragment,{children:s});if(r)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(ia,{size:"lg"})});if(!i||!t)return e.jsx(ar,{to:"/login",state:{from:o},replace:!0});if(a&&!n(a))return e.jsx(ar,{to:"/",replace:!0});if(n(["admin","manager","agent"]))return e.jsx(e.Fragment,{children:s});if(n(["marketing executive","sales executive","presales executive"]))return e.jsx(e.Fragment,{children:s});if(n("buyer")){const v=Gl("/buyer-dashboard/:id",m);if(!((b=v==null?void 0:v.params)!=null&&b.id))return e.jsx(ar,{to:"/",replace:!0});const x=String(v.params.id),u=t!=null&&t.buyer_id?String(t.buyer_id):"";return!u||u!==x?e.jsx(ar,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:s})}if(n("seller")){const v=Gl("/seller-dashboard/:id",m);if(!((d=v==null?void 0:v.params)!=null&&d.id))return e.jsx(ar,{to:"/",replace:!0});const x=String(v.params.id),u=t!=null&&t.seller_id?String(t.seller_id):"";return!u||u!==x?e.jsx(ar,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:s})}return e.jsx(ar,{to:"/",replace:!0})},cp=({children:s})=>{const{isAuthenticated:a,loading:t}=Hs();return t?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(ia,{size:"lg"})}):a?e.jsx(ar,{to:"/dashboard",replace:!0}):e.jsx(e.Fragment,{children:s})},dp=()=>{const{systemSettings:s}=ur();l.useEffect(()=>{if(s!=null&&s.company_name?document.title=s.company_name:document.title="Resale Expert",s!=null&&s.company_favicon){let a=document.querySelector("link[rel*='icon']");a||(a=document.createElement("link"),a.rel="icon",document.head.appendChild(a)),a.href=`${s.company_favicon}?t=${Date.now()}`}},[s])},mp=({isOpen:s,onClose:a,children:t})=>s?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-auto",children:t})}):null,po=({label:s,type:a="text",value:t,onChange:r,placeholder:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s}),e.jsx("input",{type:a,value:t,onChange:r,placeholder:i,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),bo=({label:s,value:a,onChange:t,options:r,placeholder:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s}),e.jsxs("select",{value:a,onChange:t,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:i}),r.map(n=>e.jsx("option",{value:n,children:n},n))]})]}),xp=({isOpen:s=!0,onClose:a=()=>{},onSelectBreak:t=()=>{}})=>{var c;const[r,i]=l.useState(""),[n,o]=l.useState({clientName:"",property:"",meetingNotes:"",customDuration:"",priority:"medium",meetingWith:"",meetingPurpose:""}),m=["John Doe","Jane Smith","Michael Johnson"],g=["Sunrise Apartments","Green Villa","Ocean View Flats"],b=[{id:"lunch",label:"Lunch Break",icon:Lg,duration:60,productivity:0},{id:"personal",label:"Personal Break",icon:Ms,duration:20,productivity:0},{id:"tea",label:"Tea Break",icon:qr,duration:15,productivity:.1},{id:"documentation",label:"Documentation",icon:ws,duration:20,productivity:.7},{id:"market_research",label:"Market Research",icon:Rs,duration:30,productivity:.7},{id:"meeting",label:"New Client Meeting",icon:Ns,duration:45,productivity:.8},{id:"site_visit",label:"Buyer Site Visit",icon:Dg,duration:120,productivity:1},{id:"property_visit",label:"Seller Property Visit",icon:Is,duration:90,productivity:.9}],d=()=>o({clientName:"",property:"",meetingNotes:"",customDuration:"",priority:"medium",meetingWith:"",meetingPurpose:""}),v=f=>{i(f),d()},x=()=>{if(!r)return;const f=b.find(N=>N.id===r),p={...n,duration:n.customDuration||(f==null?void 0:f.duration)||0};t(r,p),d(),i(""),a()},u=()=>{const f=b.find(w=>w.id===r);if(!f)return null;const p=["site_visit","property_visit","documentation"].includes(r),N=["site_visit","property_visit"].includes(r),P=["personal","documentation","market_research"].includes(r);return e.jsxs("div",{className:"space-y-4",children:[p&&e.jsx(bo,{label:"Client Name*",value:n.clientName,onChange:w=>o($=>({...$,clientName:w.target.value})),options:m,placeholder:"Select client"}),N&&e.jsx(bo,{label:"Property*",value:n.property,onChange:w=>o($=>({...$,property:w.target.value})),options:g,placeholder:"Select property"}),P&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:n.meetingNotes,onChange:w=>o($=>({...$,meetingNotes:w.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",rows:3,placeholder:"Add notes or details"})]}),r==="meeting"&&e.jsxs(e.Fragment,{children:[e.jsx(po,{label:"Meeting With*",value:n.meetingWith,onChange:w=>o($=>({...$,meetingWith:w.target.value})),placeholder:"e.g., Team Meeting, Client Discussion"}),e.jsx(po,{label:"Meeting Purpose",value:n.meetingPurpose,onChange:w=>o($=>({...$,meetingPurpose:w.target.value})),placeholder:"e.g., Strategy Discussion, Deal Review"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(po,{label:"Duration (minutes)",type:"number",value:n.customDuration,onChange:w=>o($=>({...$,customDuration:w.target.value})),placeholder:f.duration.toString()}),e.jsx(bo,{label:"Priority",value:n.priority,onChange:w=>o($=>({...$,priority:w.target.value})),options:["low","medium","high","urgent"],placeholder:"Select priority"})]})]})};return e.jsx(mp,{isOpen:s,onClose:a,children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Start Smart Break"}),e.jsx("button",{onClick:a,className:"p-1 hover:bg-gray-100 rounded-lg",children:e.jsx(ns,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-700 mb-4",children:"Select Break Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:b.map(f=>{const p=f.icon,N=r===f.id;return e.jsx("button",{type:"button",onClick:()=>v(f.id),className:`p-4 rounded-xl border-2 transition-all text-left ${N?"border-orange-400 bg-orange-50":"border-gray-200 hover:border-gray-300 bg-white"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"w-5 h-5 text-gray-700"}),e.jsx("h4",{className:"font-medium text-gray-900",children:f.label})]}),e.jsxs("div",{className:"flex flex-col items-end text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["~",f.duration,"m"]}),f.productivity>0?e.jsxs("span",{className:"text-green-600 font-medium",children:["+",Math.round(f.productivity*100),"% productive"]}):e.jsx("span",{className:"text-gray-400",children:"No productivity"})]})]})},f.id)})})]}),r&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base font-medium text-gray-700 mb-3",children:["Activity Details - ",(c=b.find(f=>f.id===r))==null?void 0:c.label]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:u()})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 text-gray-600 hover:text-gray-800 font-medium",children:"Cancel"}),e.jsx("button",{type:"button",onClick:x,disabled:!r,className:`px-6 py-2 rounded-lg font-medium transition ${r?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_l,{className:"w-4 h-4"})," Start Activity"]}):"Select Activity Type"})]})]})})},up=({isOpen:s,onClose:a,sessionTime:t,workTime:r,isOnBreak:i,onStartBreak:n,onEndBreak:o,loginTime:m})=>{const[g,b]=l.useState([]),[d,v]=l.useState([]),[x,u]=l.useState(!1),[c,f]=l.useState(0),[p,N]=l.useState(!1),P=l.useCallback(F=>{const T=Math.floor(F/3600),j=Math.floor(F%3600/60),E=F%60;return T>0?`${T}h ${j}m ${E}s`:j>0?`${j}m ${E}s`:`${E}s`},[]);l.useEffect(()=>{s&&(localStorage.getItem("sessionActive")!=="true"?$():N(!0))},[s]),l.useEffect(()=>{if(s)try{const F=JSON.parse(localStorage.getItem("activityHistory")||"[]");b(F.slice(-3));const T=[];let j=1,E=0;for(let W=0;W<F.length;W++)if(F[W].type==="start_break"){const B=F.find((M,A)=>A>W&&M.type==="end_break");if(B){const M=Math.floor((B.timestamp-F[W].timestamp)/1e3);E+=M,T.push({number:j++,type:F[W].breakType||"Regular Break",startTime:F[W].time,endTime:B.time,duration:P(M),details:F[W].details||"Standard break",efficiency:w(M)})}}v(T),f(E);const V=localStorage.getItem("sessionActive");N(V==="true")}catch(F){console.error("Error loading activity history:",F)}},[s,P]);const w=F=>F<=300?"95%":F<=900?"85%":"75%",$=()=>{const F={type:"start_session",timestamp:Date.now(),time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),label:"Started new session"},T=JSON.parse(localStorage.getItem("activityHistory")||"[]");T.push(F),localStorage.setItem("activityHistory",JSON.stringify(T)),localStorage.setItem("sessionActive","true"),localStorage.setItem("sessionStartTime",Date.now().toString()),N(!0),b(j=>[...j.slice(-2),F])},y=()=>{const F={type:"end_session",timestamp:Date.now(),time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),label:"Ended session"},T=JSON.parse(localStorage.getItem("activityHistory")||"[]");T.push(F),localStorage.setItem("activityHistory",JSON.stringify(T)),localStorage.setItem("sessionActive","false"),N(!1),b(j=>[...j.slice(-2),F])},k=(F,T)=>{const j={type:"start_break",breakType:F,details:T.meetingNotes||T.meetingPurpose||"",timestamp:Date.now(),time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),label:`Started ${F} break`,...T},E=JSON.parse(localStorage.getItem("activityHistory")||"[]");E.push(j),localStorage.setItem("activityHistory",JSON.stringify(E)),n(F,T),u(!1)},R=()=>{const F={type:"end_break",timestamp:Date.now(),time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),label:"Ended break"},T=JSON.parse(localStorage.getItem("activityHistory")||"[]");T.push(F),localStorage.setItem("activityHistory",JSON.stringify(T)),o()};return s?e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Smart Time Tracking & Analytics"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:$,disabled:p,className:`flex items-center space-x-2 px-4 py-2 text-white text-sm rounded-lg transition-colors shadow-sm font-medium ${p?"bg-green-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"}`,children:[e.jsx(_l,{className:"h-3 w-3"}),e.jsx("span",{children:p?"Session Active":"New Session"})]}),e.jsxs("button",{onClick:()=>{i?R():u(!0)},className:`flex items-center space-x-2 px-4 py-2 text-white text-sm rounded-lg transition-colors shadow-sm font-medium ${i?"bg-red-500 hover:bg-red-600":"bg-orange-500 hover:bg-orange-600"}`,children:[e.jsx(qr,{className:"h-3 w-3"}),e.jsx("span",{children:i?"End Break":"Smart Break"})]}),e.jsxs("button",{onClick:y,disabled:!p,className:`flex items-center space-x-2 px-4 py-2 text-white text-sm rounded-lg transition-colors shadow-sm font-medium ${p?"bg-red-500 hover:bg-red-600":"bg-gray-400 cursor-not-allowed"}`,children:[e.jsx(dl,{className:"h-3 w-3"}),e.jsx("span",{children:"End Session"})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ns,{className:"h-5 w-5 text-gray-500"})})]})]}),p&&e.jsx("div",{className:"px-6 py-2 bg-green-50 border-b border-green-200",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Session is running..."})]})}),e.jsxs("div",{className:"p-3 grid grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white border-l-4 border-l-blue-400 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between mb-3",children:[e.jsx(Ls,{className:"h-4 w-4 text-blue-400"}),e.jsxs("span",{className:"text-[10px] text-gray-500",children:["Login:"," ",m?new Date(m).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"]})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900 mb-1",children:t}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Session"})]}),e.jsxs("div",{className:"bg-white border-l-4 border-l-green-400 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Rs,{className:"h-5 w-5 text-green-500"}),e.jsx("div",{className:`w-2 h-2 rounded-full ${p?"bg-green-500 animate-pulse":"bg-gray-300"}`})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900 mb-1",children:r}),e.jsx("div",{className:"text-xs text-gray-500",children:"Active Work Time"})]}),e.jsxs("div",{className:"bg-white border-l-4 border-l-orange-400 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(qr,{className:"h-5 w-5 text-orange-500"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[d.length," breaks"]})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900 mb-1",children:P(c)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Break Time"})]}),e.jsxs("div",{className:"bg-white border-l-4 border-l-purple-400 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(jt,{className:"h-5 w-5 text-purple-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Today"})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900 mb-1",children:g.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Activity Types"})]}),e.jsxs("div",{className:"bg-white border-l-4 border-l-blue-400 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Ms,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-xs text-green-500 font-medium",children:"Excellent"})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900 mb-1",children:"100%"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Productivity Score"})]}),e.jsxs("div",{className:"bg-white border-l-4 border-l-red-400 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Ms,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:`text-xs font-medium ${p?"text-green-500":"text-red-500"}`,children:p?"ACTIVE":"INACTIVE"})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900 mb-1",children:p?"Running":"Stopped"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Session Status"})]})]}),e.jsxs("div",{className:"p-6 pt-0 grid grid-cols-3 gap-6 max-h-80 overflow-hidden",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activities"})}),e.jsx("div",{className:"p-4 space-y-3 overflow-y-auto",children:g.length>0?g.map((F,T)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${F.type==="start_session"?"bg-green-500":F.type==="end_session"?"bg-red-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:F.label}),e.jsx("p",{className:"text-xs text-gray-500",children:F.time})]}),e.jsx("div",{className:"text-xs text-gray-400",children:F.type==="start_session"?"Started":F.type==="end_session"?"Ended":"Active"})]},T)):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(jt,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No recent activities"})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Breakdown"})}),e.jsx("div",{className:"p-4 flex items-center justify-center h-32",children:d.length>0?e.jsxs("p",{className:"text-sm text-gray-700",children:[d.length," breaks taken today"]}):e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(qr,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No Activity Breakdown today"})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Insights"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("p",{children:["ðŸ“ˆ Productivity: ",e.jsx("span",{className:"font-semibold",children:"High"})]}),e.jsxs("p",{children:["â³ Avg Break Duration: ",e.jsx("span",{className:"font-semibold",children:d.length>0?d[0].duration:"0s"})]}),e.jsxs("p",{children:["âš¡ Efficiency Trend: ",e.jsx("span",{className:"font-semibold",children:"Stable"})]}),e.jsxs("p",{children:["ðŸŽ¯ Session: ",e.jsx("span",{className:`font-semibold ${p?"text-green-600":"text-red-600"}`,children:p?"Active":"Inactive"})]})]})]})]}),e.jsx("div",{className:"p-6 pt-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Smart Break History"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Break #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Start Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"End Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Duration"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Efficiency"})]})}),e.jsx("tbody",{className:"bg-white",children:d.length>0?d.map((F,T)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:F.number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:F.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:F.startTime}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:F.endTime}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:F.duration}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:F.details}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:F.efficiency})]},T)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-16 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3",children:[e.jsx(qr,{className:"h-12 w-12 text-gray-300"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"No breaks taken today"})]})})})})]})})]})})]}),x&&e.jsx(xp,{isOpen:x,onClose:()=>u(!1),onSelectBreak:k})]}):null},wa={createNotification:async s=>(await Ae.post("/client-lead-notifications/create",s)).data,getUserNotifications:async s=>(await Ae.get(`/client-lead-notifications/getallbyuserid/${s}`)).data,markAsRead:async s=>(await Ae.put(`/client-lead-notifications/markasread/${s}/read`)).data,markAllAsRead:async s=>(await Ae.put(`/client-lead-notifications/markallasread/${s}`)).data,updateNotification:async(s,a)=>{try{return s?(await Ae.put(`/client-lead-notifications/update/${s}`,a)).data:(await Ae.post("/client-lead-notifications/create",a)).data}catch(t){if(t.response&&t.response.status===404)return console.warn("âš ï¸ Notification not found, creating new one..."),(await Ae.post("/client-lead-notifications/create",a)).data;throw console.error("âŒ Error in updateNotification:",t),t}},delete:async s=>(await Ae.delete(`client-lead-notifications/${s}`)).data,deleteAllForUser:async s=>(await Ae.delete(`/client-lead-notifications/user/${s}/all`)).data,deleteReadForUser:async s=>(await Ae.delete(`/client-lead-notifications/user/${s}/read`)).data},gp=s=>{const a=typeof s=="number"?s:Number(s);return Number.isFinite(a)?a:Math.floor(Math.random()*1e9)},hp=s=>typeof s=="boolean"?s:s===1||s==="1"||s==="true",Di=s=>{if(!s)return new Date(NaN);if(s.endsWith("Z")){const r=new Date(s),i=5.5*60*60*1e3;return new Date(r.getTime()+i)}if(/[tT]|\+/.test(s))return new Date(s);const a=s.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2}):(\d{2})$/);if(a){const[,r,i,n,o,m,g]=a;return new Date(Date.UTC(+r,+i-1,+n,+o,+m,+g))}return new Date(s)},pp=s=>{if(Number.isNaN(s.getTime()))return"Unknown time";const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()],r=s.getDate(),i=s.getFullYear();let n=s.getHours();const o=s.getMinutes(),m=n>=12?"PM":"AM";n=n%12||12;const g=o<10?`0${o}`:o;return`${t} ${r}, ${i}, ${n}:${g} ${m}`},bp=s=>{const a=Di(s);if(Number.isNaN(a.getTime()))return"Unknown time";const t=Math.floor((Date.now()-a.getTime())/6e4);if(t<1)return"Just now";if(t<60)return`${t} min ago`;const r=Math.round(t/60);return r<24?`${r}h ago`:`${Math.round(r/24)}d ago`},fp=({notifications:s,onClose:a,userId:t,forceFetch:r=!1})=>{const{user:i}=Hs(),n=t??(i==null?void 0:i.id),o=Array.isArray(s)&&!r,[m,g]=l.useState(s??[]),[b,d]=l.useState(!o),[v,x]=l.useState(null),[u,c]=l.useState(!1),[f,p]=l.useState(new Set);l.useEffect(()=>{s&&!r&&(g(s),d(!1))},[s,r]),l.useEffect(()=>{if(o)return;let j=!0;const E=Number(n);if(!n||Number.isNaN(E)){g([]),d(!1);return}return(async()=>{d(!0),x(null);try{const V=await wa.getUserNotifications(E),B=(Array.isArray(V==null?void 0:V.notifications)?V.notifications:V!=null&&V.notifications?[V.notifications]:[]).map(M=>{const A=gp(M.id),L=String(M.type??"general"),D=L==="lead_assign"?"Lead Assigned":L==="property_inquiry"?"Property Inquiry":L==="visit_scheduled"?"Visit Scheduled":L==="price_suggestion"?"Price Suggestion":L==="document_ready"?"Document Ready":L,I=M.message??"",H=M.created_at??M.updated_at??"1970-01-01 00:00:00";return{id:A,title:D,message:I,type:L,priority:M.priority??"medium",timestamp:H,read:hp(M.is_read),link:M.link??null}});j&&g(B)}catch(V){console.error("âŒ Error fetching notifications:",V),j&&x((V==null?void 0:V.message)??"Failed to fetch notifications")}finally{j&&d(!1)}})(),()=>{j=!1}},[n,o]);const N=l.useCallback(async j=>{g(E=>E.map(V=>V.id===j?{...V,read:!0}:V));try{await wa.markAsRead(j)}catch(E){console.error("âŒ Error marking as read:",E),g(V=>V.map(W=>W.id===j?{...W,read:!1}:W))}},[]),P=l.useCallback(async j=>{p(V=>new Set(V).add(j));const E=m;g(V=>V.filter(W=>W.id!==j));try{await wa.delete(j)}catch(V){console.error("âŒ Error deleting notification:",V),g(E)}finally{p(V=>{const W=new Set(V);return W.delete(j),W})}},[m]),w=l.useCallback(async j=>{g(E=>E.map(V=>({...V,read:!0})));try{await wa.markAllAsRead(j)}catch(E){console.error("âŒ Error marking all as read:",E)}},[]),$=l.useCallback(async(j,E)=>{await N(j),E&&typeof window<"u"&&(window.location.href=E)},[N]),y=j=>{switch(j){case"property_inquiry":return e.jsx(Ns,{className:"text-blue-600",size:16});case"visit_scheduled":return e.jsx(ks,{className:"text-green-600",size:16});case"price_suggestion":return e.jsx(Rs,{className:"text-purple-600",size:16});case"document_ready":return e.jsx(ws,{className:"text-orange-600",size:16});case"lead_assign":return e.jsx(Ns,{className:"text-indigo-600",size:16});default:return e.jsx(ha,{className:"text-gray-600",size:16})}},k=j=>{switch(j){case"high":return"border-l-red-500 bg-red-50";case"medium":return"border-l-orange-500 bg-orange-50";case"low":return"border-l-green-500 bg-green-50";default:return"border-l-gray-500 bg-gray-50"}},R=l.useMemo(()=>m.filter(j=>!j.read).length,[m]),F=l.useMemo(()=>[...m].sort((E,V)=>{const W=Di(E.timestamp).getTime();return Di(V.timestamp).getTime()-W}).slice(0,u?10:5),[m,u]),T=m.length>5;return e.jsxs("div",{className:"relative z-50 bg-white shadow-md rounded-xl border border-gray-200 w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b bg-gray-50 rounded-t-xl",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Notifications"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[T&&e.jsx("button",{onClick:()=>c(j=>!j),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",title:u?"Show latest 5":"Show latest 10",children:u?"View less":"View all"}),a&&e.jsx("button",{onClick:a,className:"p-1 rounded hover:bg-gray-100",title:"Close",children:e.jsx(ns,{size:16})}),R>0&&n&&e.jsx("button",{onClick:()=>{const j=Number(n);Number.isNaN(j)||w(j)},className:"text-xs text-blue-600 hover:text-blue-800 font-medium",title:"Mark all as read",children:"Mark all as read"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[R," unread"]})]})]}),e.jsx("ul",{className:"divide-y divide-gray-100 max-h-[28rem] overflow-y-auto overflow-x-hidden scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:b?e.jsx("li",{className:"p-4 text-center text-gray-500 text-sm",children:"Loading notifications..."}):v?e.jsx("li",{className:"p-4 text-center text-red-500 text-sm",children:v}):F.length===0?e.jsx("li",{className:"p-6 text-center text-gray-500 text-sm",children:"No notifications yet"}):F.map(j=>{const E=Di(j.timestamp),V=f.has(j.id);return e.jsxs("li",{onClick:()=>$(j.id,j.link),className:`p-4 flex items-start space-x-3 transition-colors border-l-4 min-w-0
                  ${k(j.priority)} ${j.read?"":"bg-blue-50"}
                  hover:bg-gray-100 cursor-pointer`,children:[e.jsx("div",{className:"p-2 rounded-lg shadow-sm flex items-center justify-center min-w-[36px] shrink-0 bg-white",children:y(j.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{className:"min-w-0 max-w-full",children:[e.jsx("h4",{className:`text-sm font-medium ${j.read?"text-gray-700":"text-gray-900"} truncate`,children:j.title}),j.message?e.jsx("p",{className:"text-xs text-gray-700 mt-1 break-words whitespace-normal leading-5",style:{display:"-webkit-box",WebkitLineClamp:4,WebkitBoxOrient:"vertical",overflow:"hidden"},title:j.message,children:j.message}):null,e.jsxs("div",{className:"flex items-center flex-wrap gap-2 mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[pp(E)," Â· ",bp(j.timestamp)]}),j.priority&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${j.priority==="high"?"bg-red-100 text-red-700":j.priority==="medium"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:j.priority})]})]}),e.jsxs("div",{className:"flex space-x-1 ml-2 shrink-0",children:[e.jsx("button",{onClick:W=>{W.stopPropagation(),$(j.id,j.link)},className:"p-1 text-green-600 hover:bg-green-100 rounded disabled:opacity-50",title:"View",disabled:V,children:e.jsx(ks,{size:14})}),!j.read&&e.jsx("button",{onClick:W=>{W.stopPropagation(),N(j.id)},className:"p-1 text-blue-600 hover:bg-blue-100 rounded disabled:opacity-50",title:"Mark as read",disabled:V,children:e.jsx(_a,{size:14})}),e.jsx("button",{onClick:W=>{W.stopPropagation(),P(j.id)},className:"p-1 text-red-600 hover:bg-red-100 rounded disabled:opacity-50",title:"Delete",disabled:V,children:e.jsx(Es,{size:14})})]})]})})]},j.id)})})]})},yp=()=>{const{user:s,logout:a}=Hs(),[t,r]=l.useState(!1),i=l.useRef(null);return l.useEffect(()=>{const n=o=>{i.current&&!i.current.contains(o.target)&&r(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),e.jsxs("div",{className:"relative",ref:i,children:[e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer",onClick:()=>r(!t),children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s==null?void 0:s.first_name," ",s==null?void 0:s.last_name]}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s==null?void 0:s.role})]}),e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 overflow-hidden flex items-center justify-center",children:s!=null&&s.avatar?e.jsx("img",{src:s.avatar,alt:"User Avatar",className:"h-full w-full object-cover"}):e.jsx(Ms,{className:"h-5 w-5 text-gray-600"})})]}),t&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg z-50",children:[e.jsxs("div",{className:"p-3 border-b border-gray-100 flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 overflow-hidden flex items-center justify-center",children:s!=null&&s.avatar?e.jsx("img",{src:s.avatar,alt:"User Avatar",className:"h-full w-full object-cover"}):e.jsx(Ms,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s==null?void 0:s.first_name," ",s==null?void 0:s.last_name]}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:s==null?void 0:s.role})]})]}),e.jsxs("ul",{className:"py-2",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>window.location.href="/dashboard/profile",className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2 text-gray-500"}),"Profile"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>window.location.href="/dashboard/settings",className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(Yt,{className:"h-4 w-4 mr-2 text-gray-500"}),"Settings"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:a,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[e.jsx(eo,{className:"h-4 w-4 mr-2"}),"Logout"]})})]})]})]})};function Ws(s,a){if(!s||!s.module_permissions)return!1;const t=a.split(".");if(t.length<2)return!1;const r=t[0],i=t[1],n=s.module_permissions[r];return n?!!n[i]:!1}const jp=s=>{const a=typeof s=="number"?s:Number(s);return Number.isFinite(a)?a:Math.floor(Math.random()*1e9)},vp=s=>{if(typeof s=="boolean")return s;if(typeof s=="number")return s===1;if(typeof s=="string"){const a=s.trim().toLowerCase();return a==="1"||a==="true"}return!1},Np=s=>{const a=jp(s.id),t=(s.type??"general").toString();return{id:a,title:t==="lead_assign"?"Lead Assigned":t==="property_inquiry"?"Property Inquiry":t==="visit_scheduled"?"Visit Scheduled":t==="price_suggestion"?"Price Suggestion":t==="document_ready"?"Document Ready":t,message:s.message??"",type:t,priority:s.priority??"medium",timestamp:s.created_at??s.updated_at??"1970-01-01 00:00:00",read:vp(s.is_read),link:s.link??null,color:"green"}},wp=()=>{const[s,a]=l.useState(!1),[t,r]=l.useState(!1),[i,n]=l.useState("00:00:00"),[o,m]=l.useState("00:00:00"),[g,b]=l.useState(!1),[d,v]=l.useState(null),[x,u]=l.useState(0),[c,f]=l.useState(null),[p,N]=l.useState(!1),[P,w]=l.useState(""),[$,y]=l.useState(!1),[k,R]=l.useState(new Set),F=Jr(),{user:T,logout:j,hasRole:E}=Hs(),{systemSettings:V}=ur(),W=l.useRef(d),B=l.useRef(x),M=l.useRef(g),A=l.useRef(null),L=l.useRef(null),[D,I]=l.useState(!1),H=l.useRef(null),h=fp,[Y,K]=l.useState([]),[q,ne]=l.useState(0),le="#0b3855",S=`text-[${le}]`,C=`group-hover:text-[${le}]`,J=l.useCallback(O=>O?Array.isArray(O)?O.some(Ie=>Ws(T,Ie)):Ws(T,O):!0,[T]),ue=l.useCallback(O=>{R(Ie=>{const ze=new Set(Ie);return ze.has(O)?(ze.delete(O),ze):new Set([O])})},[]);l.useEffect(()=>{const O=F.pathname,Ie={cms:["/dashboard/blog-manager"],crm:["/dashboard/leads","/dashboard/buyers","/dashboard/sellers","/dashboard/properties","/dashboard/contact-messages"],administrator:["/dashboard/document-center","/dashboard/template-center","/dashboard/accounts"],tools:["/dashboard/vendors","/dashboard/ai-training"],reports:["/dashboard/activities","/dashboard/analytics"],settings:["/dashboard/settings","/dashboard/settings/roles-permissions","/dashboard/settings/integrations","/dashboard/settings/ai","/dashboard/settings/master-data","/dashboard/settings/veriable-center","/dashboard/settings/import-export"]};let ze=null;Object.entries(Ie).some(([xe,Ee])=>Ee.some(Ke=>O.startsWith(Ke))?(ze=xe,!0):!1),R(ze?new Set([ze]):new Set)},[F.pathname]);const Q=l.useCallback(O=>{for(let Ie=O.length-1;Ie>=0;Ie--){if(O[Ie].type==="login"||O[Ie].type==="end_break")return O[Ie].timestamp;if(O[Ie].type==="start_break")return null}return W.current},[]),he=l.useMemo(()=>{const O=[{name:"Overview",href:"/dashboard",icon:yt,exact:!0,colorClass:S,type:"single",required:["lead.read","property.read","buyer.read"]}];return E("admin")&&O.push({name:"Admin Dashboard",href:"/dashboard/admin",icon:va,exact:!0,colorClass:S,type:"single",required:"system.manage"}),E(["admin","manager"])&&O.push({name:"Manager Dashboard",href:"/dashboard/manager",icon:La,exact:!0,colorClass:S,type:"single",required:["lead.read","report.read"]}),E(["admin","manager","agent"])&&O.push({name:"Agent Dashboard",href:"/dashboard/agent",icon:On,exact:!0,colorClass:S,type:"single",required:["lead.read","buyer.read","seller.read"]}),O.push({name:"CMS",icon:_t,colorClass:S,type:"dropdown",key:"cms",required:["blog.read"],submenu:[{name:"Home Manager",href:"/dashboard/home-manager",icon:yt,colorClass:S,required:"blog.read"},{name:"Blog Manager",href:"/dashboard/blog-manager",icon:ln,colorClass:S,required:"blog.read"}]},{name:"CRM",icon:Ns,colorClass:S,type:"dropdown",key:"crm",required:["lead.read","buyer.read","seller.read","property.read"],submenu:[{name:"Leads",href:"/dashboard/leads",icon:rt,colorClass:S,required:"lead.read"},{name:"Buyers",href:"/dashboard/buyers",icon:La,colorClass:S,required:"buyer.read"},{name:"Sellers",href:"/dashboard/sellers",icon:Ns,colorClass:S,required:"seller.read"},{name:"Properties",href:"/dashboard/properties",icon:Is,colorClass:S,required:"property.read"},{name:"Contact Messages",href:"/dashboard/contact-messages",icon:tt,colorClass:S,required:"lead.read"}]},{name:"Administrator",icon:at,colorClass:S,type:"dropdown",key:"administrator",required:"system.manage",submenu:[{name:"Document Center",href:"/dashboard/document-center",icon:ws,colorClass:S,required:"system.manage"},{name:"Template Center",href:"/dashboard/template-center",icon:Rg,colorClass:S,required:"system.manage"},{name:"Accounts",href:"/dashboard/accounts",icon:Pa,colorClass:S,required:"system.manage"}]},{name:"Communication",href:"/dashboard/communication",icon:Bt,exact:!0,colorClass:S,type:"single",required:["lead.read","buyer.read","seller.read"]},{name:"Tools",icon:nn,colorClass:S,type:"dropdown",key:"tools",required:E("admin")?void 0:["property.read","vendor.read"],submenu:[{name:"Vendors",href:"/dashboard/vendors",icon:Is,colorClass:S,required:E("admin")?void 0:"vendor.read"},{name:"AI Training",href:"/dashboard/ai-training",icon:ws,colorClass:S,required:"system.manage"}]},{name:"Reports",icon:Rs,colorClass:S,type:"dropdown",key:"reports",required:"report.read",submenu:[{name:"Activities",href:"/dashboard/activities",icon:jt,colorClass:S,required:"report.read"},{name:"Analytics",href:"/dashboard/analytics",icon:Ot,colorClass:S,required:"report.read"}]}),O.push({name:"Settings",icon:Yt,colorClass:S,type:"dropdown",key:"settings",required:["system.manage","data.export","data.import"],submenu:[{name:"General Settings",href:"/dashboard/settings",icon:Yt,colorClass:S,required:"system.manage"},{name:"Roles & Permissions",href:"/dashboard/settings/roles-permissions",icon:at,colorClass:S,required:"system.manage"},{name:"Integrations",href:"/dashboard/settings/integrations",icon:Ft,colorClass:S,required:"system.manage"},{name:"AI Settings",href:"/dashboard/settings/ai",icon:Ft,colorClass:S,required:"system.manage"},{name:"Master Data",href:"/dashboard/settings/master-data",icon:Vr,colorClass:S,required:"system.manage"},{name:"Variable Center",href:"/dashboard/settings/veriable-center",icon:Vr,colorClass:S,required:"system.manage"},{name:"Import/Export",href:"/dashboard/settings/import-export",icon:Ys,colorClass:S,required:["data.import","data.export"]}]}),E("admin")&&O.push({name:"Users",href:"/dashboard/users",icon:Ns,exact:!0,colorClass:S,type:"single",required:"user.read"}),O.map(ze=>{if(!J(ze.required))return null;if(ze.type==="dropdown"){const xe=ze.submenu.filter(Ee=>J(Ee.required));return xe.length===0?null:{...ze,submenu:xe}}return ze}).filter(ze=>ze!==null)},[E,S,J]),se=l.useMemo(()=>{if(!P.trim())return he;const O=[];return he.forEach(Ie=>{if(Ie.type==="single")Ie.name.toLowerCase().includes(P.toLowerCase())&&O.push(Ie);else{const ze=Ie.submenu.filter(xe=>xe.name.toLowerCase().includes(P.toLowerCase()));(Ie.name.toLowerCase().includes(P.toLowerCase())||ze.length>0)&&O.push({...Ie,submenu:ze.length>0?ze:Ie.submenu})}}),O},[he,P]);l.useEffect(()=>{function O(Ie){H.current&&Ie.target instanceof Node&&(H.current.contains(Ie.target)||I(!1))}return document.addEventListener("click",O),()=>document.removeEventListener("click",O)},[]),l.useEffect(()=>{let O;const Ie=async()=>{try{if(!(T!=null&&T.id))return;const ze=Number(T.id);if(Number.isNaN(ze))return;const xe=await wa.getUserNotifications(ze),Ke=(Array.isArray(xe==null?void 0:xe.notifications)?xe.notifications:xe!=null&&xe.notifications?[xe.notifications]:[]).map(Np);K(ye=>JSON.stringify(ye)!==JSON.stringify(Ke)?Ke:ye);const Xe=Ke.filter(ye=>!ye.read).length;ne(ye=>ye!==Xe?Xe:ye)}catch(ze){console.error("âŒ Error fetching notifications:",ze)}};return T!=null&&T.id&&(Ie(),O=setInterval(Ie,1e4)),()=>O&&clearInterval(O)},[T==null?void 0:T.id]);const ge=l.useCallback(async()=>{if(N(O=>!O),q>0&&(T!=null&&T.id))try{const O=Number(T.id);Number.isNaN(O)||await wa.markAllAsRead(O),K(Ie=>Ie.map(ze=>({...ze,read:!0}))),ne(0)}catch(O){console.error("âŒ Error marking notifications as read:",O)}},[q,T==null?void 0:T.id]);l.useEffect(()=>{W.current=d},[d]),l.useEffect(()=>{B.current=x},[x]),l.useEffect(()=>{M.current=g},[g]),l.useEffect(()=>{if(T&&!d){const O=Date.now();v(O);const Ie=new Date().toDateString();localStorage.setItem("todayLoginTime",O.toString()),localStorage.setItem("loginDate",Ie);const ze=JSON.parse(localStorage.getItem("activityHistory")||"[]");ze.push({label:"Login",type:"login",time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),timestamp:O}),localStorage.setItem("activityHistory",JSON.stringify(ze))}},[T,d]),l.useEffect(()=>{if(!d)return;const O=setInterval(()=>{const Ie=Date.now(),ze=Math.floor((Ie-(W.current??0))/1e3),xe=Math.floor(ze/3600),Ee=Math.floor(ze%3600/60),Ke=ze%60,Xe=`${xe.toString().padStart(2,"0")}:${Ee.toString().padStart(2,"0")}:${Ke.toString().padStart(2,"0")}`;n(Me=>Me!==Xe?Xe:Me);let ye=B.current??0;if(!M.current){const Me=JSON.parse(localStorage.getItem("activityHistory")||"[]"),Ye=Q(Me);Ye&&(ye+=Math.floor((Ie-Ye)/1e3))}const Ce=Math.floor(ye/3600),_=Math.floor(ye%3600/60),ae=ye%60,ke=`${Ce.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}:${ae.toString().padStart(2,"0")}`;m(Me=>Me!==ke?ke:Me)},1e3);return()=>clearInterval(O)},[d,Q]);const ee=l.useCallback(()=>{if(M.current)return;const O=Date.now();b(!0),f(O);const Ie=JSON.parse(localStorage.getItem("activityHistory")||"[]"),ze=Q(Ie);if(ze){const xe=Math.floor((O-ze)/1e3);u(Ee=>Ee+xe)}Ie.push({label:"Start Break",type:"start_break",time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),timestamp:O}),localStorage.setItem("activityHistory",JSON.stringify(Ie))},[Q]),de=l.useCallback(()=>{if(!M.current)return;const O=Date.now();b(!1),f(null);const Ie=JSON.parse(localStorage.getItem("activityHistory")||"[]");Ie.push({label:"End Break",type:"end_break",time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),timestamp:O}),localStorage.setItem("activityHistory",JSON.stringify(Ie))},[]),U=l.useCallback(async()=>{try{const O=Date.now(),Ie=JSON.parse(localStorage.getItem("activityHistory")||"[]");if(!M.current&&W.current){const ze=Q(Ie);if(ze){const xe=Math.floor((O-ze)/1e3);u(Ee=>Ee+xe)}}Ie.push({label:"Logout",type:"logout",time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),timestamp:O}),localStorage.setItem("activityHistory",JSON.stringify(Ie)),localStorage.removeItem("todayLoginTime"),localStorage.removeItem("loginDate"),await j()}catch(O){console.error("Logout error:",O)}},[j,Q]),X=l.useCallback((O,Ie=!1)=>Ie?F.pathname===O:F.pathname.startsWith(O),[F.pathname]),re=l.useCallback(O=>O.some(Ie=>F.pathname.startsWith(Ie.href)),[F.pathname]),fe=l.useCallback(()=>{s&&a(!1)},[s]),G=l.useCallback(O=>w(O.target.value),[]),me=l.useCallback(()=>y(!0),[]),oe=l.useCallback(()=>y(!1),[]),Fe=l.useCallback(()=>{w(""),L.current&&L.current.focus()},[]),$e=l.useCallback(()=>r(!0),[]),Le=l.useCallback(()=>r(!1),[]),je=l.useCallback(()=>a(!1),[]),_e=l.useCallback(()=>a(!0),[]),ve=l.useCallback(()=>N(!1),[]);if(!T)return e.jsx(ar,{to:"/login",replace:!0});const Pe=V==null?void 0:V.company_logo,We=V==null?void 0:V.company_name,pe=l.useMemo(()=>e.jsxs("div",{className:"flex flex-col h-full",ref:A,children:[e.jsx("div",{className:"flex items-center h-16 px-6 border-b border-slate-200 ",children:Pe?e.jsx("img",{src:Pe,alt:`${We}`,className:"h-10 max-h-10 flex-1 object-contain"}):e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("div",{className:"hidden sm:block",children:e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-800 to-orange-500 bg-clip-text text-transparent",children:We})})})}),e.jsx("div",{className:"px-4 py-4 border-b border-slate-200 bg-slate-50",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(it,{className:$t("h-4 w-4 transition-colors duration-200",$?"text-blue-600":"text-slate-400")})}),e.jsx("input",{ref:L,type:"text",placeholder:"Search navigation...",value:P,onChange:G,onFocus:me,onBlur:oe,className:$t("block w-full pl-10 pr-10 py-2.5 border border-slate-300 rounded-xl text-sm bg-white","placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-blue-600","transition-all duration-200 hover:border-slate-400 shadow-sm",$&&"shadow-md"),"aria-label":"Search navigation"}),P&&e.jsx("button",{onClick:Fe,className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:text-slate-700 text-slate-400 transition-colors",type:"button","aria-label":"Clear search",children:e.jsx(ns,{className:"h-4 w-4"})})]})}),e.jsxs("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto bg-white",role:"navigation","aria-label":"Main sidebar navigation",children:[se.map(O=>e.jsx("div",{children:O.type==="single"?e.jsxs(Bs,{to:O.href,onClick:fe,className:$t("group flex items-center px-4 py-3 text-sm font-medium rounded-xl transition-all duration-200 hover:translate-x-1",X(O.href,O.exact)?"bg-gradient-to-r from-blue-700 to-blue-800 text-white shadow-lg shadow-blue-700/25":"text-blue-700 hover:bg-gradient-to-r hover:from-blue-50 hover:to-blue-100 hover:text-blue-800 hover:shadow-md"),children:[e.jsx(O.icon,{className:$t("mr-3 h-5 w-5 flex-shrink-0 transition-colors duration-150",X(O.href,O.exact)?"text-white":`${O.colorClass} ${C}`)}),e.jsx("span",{className:$t("flex-1",X(O.href,O.exact)?"":`${O.colorClass}`),children:O.name}),X(O.href,O.exact)&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-90"})]}):e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>ue(O.key),onKeyDown:Ie=>{(Ie.key==="Enter"||Ie.key===" ")&&ue(O.key)},"aria-expanded":k.has(O.key),"aria-controls":`menu-${O.key}`,tabIndex:0,className:$t("group flex items-center w-full px-4 py-3 text-sm font-medium rounded-xl transition-all duration-200 hover:translate-x-1",re(O.submenu)?"bg-gradient-to-r from-blue-700 to-blue-800 text-white shadow-lg":"text-blue-700 hover:bg-gradient-to-r hover:from-blue-50 hover:to-blue-100 hover:text-blue-800 hover:shadow-md"),type:"button",children:[e.jsx(O.icon,{className:$t("mr-3 h-5 w-5 flex-shrink-0 transition-colors duration-150",re(O.submenu)?"text-white":`${O.colorClass} ${C}`)}),e.jsx("span",{className:$t("flex-1 text-left",re(O.submenu)?"":`${O.colorClass}`),children:O.name}),k.has(O.key)?e.jsx(ea,{className:$t("h-4 w-4 transition-transform duration-200",re(O.submenu)?"text-white":"text-blue-500")}):e.jsx(pa,{className:$t("h-4 w-4 transition-transform duration-200",re(O.submenu)?"text-white":"text-blue-500")})]}),k.has(O.key)&&e.jsx("div",{id:`menu-${O.key}`,className:"ml-6 mt-2 space-y-1 border-l-2 border-blue-200 pl-4",children:O.submenu.map(Ie=>e.jsxs(Bs,{to:Ie.href,onClick:fe,className:$t("group flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 hover:translate-x-1",X(Ie.href)?"bg-gradient-to-r from-blue-700 to-blue-800 text-white shadow-md":"text-blue-600 hover:bg-gradient-to-r hover:from-blue-50 hover:to-blue-100 hover:text-blue-800 hover:shadow-sm"),children:[e.jsx(Ie.icon,{className:$t("mr-3 h-4 w-4 flex-shrink-0 transition-colors duration-150",X(Ie.href)?"text-white":`${Ie.colorClass} ${C}`)}),e.jsx("span",{className:$t("flex-1",X(Ie.href)?"":`${Ie.colorClass}`),children:Ie.name}),X(Ie.href)&&e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full opacity-90"})]},Ie.name))})]})},O.name)),P&&se.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(it,{className:"h-8 w-8 text-slate-300 mx-auto mb-2"}),e.jsxs("p",{className:"text-slate-500 text-sm",children:['No results found for "',P,'"']})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-200 bg-slate-50",children:e.jsxs("button",{onClick:U,className:"group flex items-center w-full px-4 py-3 text-sm font-medium text-red-600 rounded-xl hover:bg-red-50 hover:text-red-700 transition-all duration-150 hover:translate-x-1 hover:shadow-md",type:"button",children:[e.jsx(eo,{className:"mr-3 h-5 w-5 text-red-500 group-hover:text-red-600 transition-colors duration-150"}),e.jsx("span",{className:"flex-1 font-semibold",children:"Sign out"})]})})]}),[Pe,We,$,P,G,me,oe,Fe,se,X,re,fe,U,k,ue,C]);return e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-blue-50 via-slate-50 to-blue-100/50",children:[e.jsxs("div",{className:$t("fixed inset-0 z-50 lg:hidden",s?"block":"hidden"),children:[e.jsx("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-60 backdrop-blur-sm",onClick:je,"aria-hidden":!0}),e.jsxs("div",{className:"relative flex flex-col w-full max-w-xs bg-white shadow-2xl h-full max-h-screen",children:[e.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2 z-20",children:e.jsx("button",{type:"button",className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white hover:bg-slate-800 transition-colors",onClick:je,"aria-label":"Close sidebar",children:e.jsx(ns,{className:"h-6 w-6 text-white"})})}),e.jsx("div",{className:"h-full overflow-y-auto",style:{WebkitOverflowScrolling:"touch"},children:pe})]})]}),e.jsx("aside",{className:"hidden lg:flex lg:flex-shrink-0",children:e.jsx("div",{className:"flex flex-col w-64 bg-white shadow-2xl border-r border-slate-200",children:pe})}),e.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[e.jsx("header",{className:"bg-white shadow-lg border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{type:"button",className:"lg:hidden -ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-xl text-slate-500 hover:text-blue-700 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-600 transition-colors",onClick:_e,"aria-label":"Open sidebar",children:e.jsx(so,{className:"h-6 w-6"})}),e.jsxs(Bs,{to:"/home",title:"Go back to website",className:"ml-3 flex items-center justify-center text-white font-semibold  bg-[#0c3854] px-2 py-1 rounded-xl text-sm  hover:bg-[#0b3858]/95 transition-colors shadow-md hover:shadow-lg",children:[e.jsx(zg,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:"Website"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"hidden lg:flex items-center space-x-3",children:[e.jsxs("button",{onClick:$e,title:"Click to open activity tracker",className:"flex items-center space-x-2 px-4 py-2 rounded-xl bg-gradient-to-r from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 transition-all group shadow-sm hover:shadow-md",type:"button",children:[e.jsx(Ls,{className:`h-4 w-4 ${S} group-hover:opacity-90`}),e.jsx("span",{className:"text-blue-700 text-sm font-semibold group-hover:text-blue-800",children:i})]}),e.jsxs("button",{title:"Activity progress",className:"flex items-center space-x-2 px-4 py-2 rounded-xl bg-gradient-to-r from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 transition-all group shadow-sm hover:shadow-md",type:"button",children:[e.jsx(jt,{className:`h-4 w-4 ${S} group-hover:opacity-90`}),e.jsx("span",{className:"text-blue-700 text-sm font-semibold group-hover:text-blue-800",children:"100%"})]}),e.jsxs("button",{title:"Coffee breaks taken",className:"flex items-center space-x-2 px-4 py-2 rounded-xl bg-gradient-to-r from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 transition-all group shadow-sm hover:shadow-md",type:"button",children:[e.jsx(qr,{className:`h-4 w-4 ${S} group-hover:opacity-90`}),e.jsx("span",{className:"text-blue-700 text-sm font-semibold group-hover:text-blue-800",children:"10"})]})]}),e.jsxs("div",{className:"relative lg:hidden",ref:H,children:[e.jsx("button",{onClick:O=>{O.stopPropagation(),I(Ie=>!Ie)},title:"Open timers",className:"p-2.5 rounded-xl bg-gradient-to-r from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 transition-all focus:outline-none focus:ring-2 focus:ring-blue-600 shadow-sm",type:"button","aria-haspopup":"true","aria-expanded":D,children:e.jsx(Ls,{className:`h-5 w-5 ${S}`})}),D&&e.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-50 py-2",onClick:O=>O.stopPropagation(),children:e.jsxs("div",{className:"px-3",children:[e.jsxs("button",{onClick:()=>{I(!1),$e()},title:"Open activity tracker",className:"w-full flex items-center space-x-2 px-3 py-2.5 rounded-lg hover:bg-blue-50 transition-colors",type:"button",children:[e.jsx(Ls,{className:`h-4 w-4 ${S}`}),e.jsx("span",{className:"text-sm font-medium text-blue-700",children:i})]}),e.jsxs("button",{onClick:()=>I(!1),title:"Activity progress",className:"w-full flex items-center space-x-2 px-3 py-2.5 rounded-lg hover:bg-blue-50 transition-colors",type:"button",children:[e.jsx(jt,{className:`h-4 w-4 ${S}`}),e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"100%"})]}),e.jsxs("button",{onClick:()=>I(!1),title:"Coffee breaks",className:"w-full flex items-center space-x-2 px-3 py-2.5 rounded-lg hover:bg-blue-50 transition-colors",type:"button",children:[e.jsx(qr,{className:`h-4 w-4 ${S}`}),e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"10"})]})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:ge,title:"Notifications",className:"relative p-2.5 text-slate-400 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-600 rounded-xl hover:bg-blue-50 transition-all shadow-sm",type:"button","aria-haspopup":"true","aria-expanded":p,children:[e.jsx(ha,{className:"h-5 w-5"}),q>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-gradient-to-br from-orange-500 to-orange-600 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full shadow-lg animate-pulse font-semibold",children:q})]}),p&&e.jsx("div",{className:"absolute right-0 mt-2 z-50 w-80 md:right-0 lg:right-0 sm:right-2",children:e.jsx(h,{notifications:Y,onClose:ve})})]}),e.jsx(yp,{})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto focus:outline-none bg-gradient-to-br from-blue-50/30 via-slate-50 to-blue-100/20",children:e.jsx("div",{className:"px-4",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx(uu,{})})})})]}),e.jsx(up,{isOpen:t,onClose:Le,sessionTime:i,workTime:o,isOnBreak:g,onStartBreak:ee,onEndBreak:de,loginTime:d})]})},_p=({isOpen:s,onClose:a})=>{const[t,r]=l.useState("pro"),[i,n]=l.useState("yearly"),[o,m]=l.useState(!1);if(!s)return null;const g=[{id:"basic",name:"Basic",icon:Xs,color:"blue",monthlyPrice:999,yearlyPrice:9999,description:"Perfect for casual property seekers",features:["Browse unlimited properties","Contact up to 5 owners per month","Basic property alerts","Standard customer support","Mobile app access"],limitations:["Limited to 5 property contacts per month","No priority support","Basic search filters only"]},{id:"pro",name:"Pro",icon:va,color:"purple",monthlyPrice:1999,yearlyPrice:19999,popular:!0,description:"Most popular for serious buyers/sellers",features:["Everything in Basic","Unlimited property contacts","Advanced AI property matching","Priority customer support","Detailed market analytics","Property price predictions","Virtual property tours","Dedicated relationship manager","Priority listing placement"],limitations:[]},{id:"enterprise",name:"Enterprise",icon:Ft,color:"orange",monthlyPrice:4999,yearlyPrice:49999,description:"For real estate professionals & agencies",features:["Everything in Pro","Multiple user accounts","White-label solutions","API access","Custom integrations","Advanced analytics dashboard","Bulk property uploads","Premium listing features","Dedicated account manager","Custom branding options"],limitations:[]}],b=async()=>{m(!0);try{await new Promise(v=>setTimeout(v,2e3)),gt.success(`Successfully subscribed to ${t.toUpperCase()} plan!`),a()}catch{gt.error("Payment failed. Please try again.")}finally{m(!1)}},d=(v,x)=>{const u=v*12;return Math.round((u-x)/u*100)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Choose Your Plan"}),e.jsx("p",{className:"text-gray-600",children:"Unlock premium features and find your dream property faster"})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ns,{size:20})})]}),e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl p-1 shadow-sm border border-gray-200 inline-flex",children:[e.jsx("button",{onClick:()=>n("monthly"),className:`px-6 py-2 rounded-lg text-sm font-medium transition-colors ${i==="monthly"?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"}),e.jsxs("button",{onClick:()=>n("yearly"),className:`px-6 py-2 rounded-lg text-sm font-medium transition-colors relative ${i==="yearly"?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:["Yearly",e.jsx("span",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"Save 17%"})]})]})})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-stretch",children:g.map(v=>{const x=v.icon,u=t===v.id,c=i==="yearly"?v.yearlyPrice:v.monthlyPrice,f=i==="yearly"?d(v.monthlyPrice,v.yearlyPrice):0;return e.jsxs("div",{className:`relative rounded-2xl border-2 p-6 cursor-pointer transition-all hover:shadow-lg flex flex-col h-full ${u?`border-${v.color}-500 bg-${v.color}-50`:"border-gray-200 hover:border-gray-300"} ${v.popular?"ring-2 ring-purple-500/50":""}`,onClick:()=>r(v.id),children:[v.popular&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-1 rounded-full text-sm font-bold shadow",children:"Most Popular"})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsx("div",{className:`w-10 h-10 bg-gradient-to-r from-${v.color}-500 to-${v.color}-600 rounded-2xl flex items-center justify-center mx-auto mb-4`,children:e.jsx(x,{className:"text-white",size:20})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:v.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:v.description}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:["â‚¹",c.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["per ",i==="yearly"?"year":"month"]}),i==="yearly"&&f>0&&e.jsxs("div",{className:"text-sm text-green-600 font-semibold",children:["Save ",f,"% annually"]})]})]}),e.jsxs("div",{className:"space-y-4 mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Included:"}),e.jsx("ul",{className:"space-y-2",children:v.features.map((p,N)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(_a,{className:"text-green-500 mt-0.5 flex-shrink-0",size:16}),e.jsx("span",{className:"text-sm text-gray-700",children:p})]},N))})]}),v.limitations.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Limitations:"}),e.jsx("ul",{className:"space-y-2",children:v.limitations.map((p,N)=>e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(ns,{className:"text-red-500 mt-0.5 flex-shrink-0",size:16}),e.jsx("span",{className:"text-sm text-gray-600",children:p})]},N))})]})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsx("button",{className:`w-full py-3 px-4 rounded-lg font-semibold transition-colors ${u?`bg-gradient-to-r from-${v.color}-600 to-${v.color}-700 text-white`:`border border-${v.color}-600 text-${v.color}-600 hover:bg-${v.color}-50`}`,children:u?"Selected":"Choose Plan"})})]},v.id)})})}),e.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Why Subscribe?"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(at,{className:"text-blue-600 mt-1",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Verified Properties"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Access to 100% verified properties with legal clearance"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Rs,{className:"text-green-600 mt-1",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Market Insights"}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered market trends and price predictions"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ns,{className:"text-purple-600 mt-1",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Expert Support"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Dedicated support from real estate experts"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 p-6 border-t border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 text-center sm:text-left",children:"â€¢ Cancel anytime â€¢ 30-day money back guarantee â€¢ No hidden fees"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:a,className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Maybe Later"}),e.jsx("button",{onClick:b,disabled:o,className:"px-3 py-2 bg-[#E6761D] hover:bg-[#CC6A1A] text-white rounded-lg transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(va,{size:18}),e.jsx("span",{children:"Subscribe Now"})]})})]})]})]})})},Sp=({isOpen:s,onClose:a,onSubscribe:t,featureType:r})=>{var b,d,v;const[i,n]=l.useState("pay-per-view-5");if(!s)return null;const o={"ai-recommendations":"AI Recommendations","ai-investment":"AI Investment Analysis","premium-details":"Premium Property Details"},m=[{id:"pay-per-view-5",name:"5 Property Views",price:299,views:5,validity:"1 Month",popular:!1,features:["AI Investment Analysis","AI Recommendations","Price Predictions","Market Insights","ROI Calculations"]},{id:"pay-per-view-12",name:"12 Property Views",price:599,views:12,validity:"1 Month",popular:!0,features:["Everything in 5 Views","Advanced Market Analytics","Detailed Investment Reports","Priority Support","Market Trend Reports"]},{id:"unlimited",name:"Unlimited Views",price:1999,views:"Unlimited",validity:"1 Month",popular:!1,features:["Everything in 12 Views","Unlimited AI Analysis","Premium Customer Support","Custom Investment Reports","Real-time Market Alerts"]}],g=()=>{const x=m.find(u=>u.id===i);if(x){const u={key:"rzp_test_your_key_here",amount:x.price*100,currency:"INR",name:"ResaleExpert",description:`${x.name} - AI Property Analysis`,handler:function(f){t(i),a()},prefill:{name:"Customer Name",email:"customer@example.com",contact:"+91 9999999999"},theme:{color:"#2563eb"}};new window.Razorpay(u).open()}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"relative  text-white p-6 rounded-t-2xl",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition-colors",children:e.jsx(ns,{size:20})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Gr,{className:"text-white",size:28})}),e.jsxs("h2",{className:"text-2xl font-bold mb-2",children:["Unlock ",o[r]]}),e.jsx("p",{className:"text-blue-100",children:"Get detailed AI-powered insights for smarter property decisions"})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Choose Your Plan"}),e.jsx("p",{className:"text-gray-600",children:"Pay only for what you need - no hidden charges"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:m.map(x=>e.jsxs("div",{onClick:()=>n(x.id),className:`relative rounded-2xl border-2 p-6 cursor-pointer transition-all hover:shadow-lg ${i===x.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${x.popular?"ring-2 ring-purple-500 ring-opacity-50":""}`,children:[x.popular&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-1 rounded-full text-sm font-bold",children:"Most Popular"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 ${x.id==="pay-per-view-5"?"bg-blue-100":x.id==="pay-per-view-12"?"bg-purple-100":"bg-orange-100"}`,children:x.id==="pay-per-view-5"?e.jsx(ks,{className:"text-blue-600",size:24}):x.id==="pay-per-view-12"?e.jsx(va,{className:"text-purple-600",size:24}):e.jsx(Ft,{className:"text-orange-600",size:24})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:x.name}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:["â‚¹",x.price.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[x.views," views â€¢ ",x.validity]})]}),e.jsx("div",{className:"space-y-3 mb-6",children:x.features.map((u,c)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-500 flex-shrink-0",size:16}),e.jsx("span",{className:"text-sm text-gray-700",children:u})]},c))}),e.jsx("div",{className:`text-center font-medium ${i===x.id?"text-blue-600":"text-gray-600"}`,children:i===x.id?"âœ“ Selected":"Select Plan"})]},x.id))}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:(b=m.find(x=>x.id===i))==null?void 0:b.name}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Valid for ",(d=m.find(x=>x.id===i))==null?void 0:d.validity]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["â‚¹",(v=m.find(x=>x.id===i))==null?void 0:v.price.toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"One-time payment"})]})]}),e.jsxs("button",{onClick:g,className:"w-full  bg-[#E6761D]  hover:bg-[#E6761D]  text-white py-4 px-6 rounded-xl transition-all font-semibold text-lg flex items-center justify-center space-x-2",children:[e.jsx(Ut,{size:20}),e.jsx("span",{children:"Pay with Razorpay"})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(bs,{className:"text-green-500",size:14}),e.jsx("span",{children:"Secure Payment"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(bs,{className:"text-green-500",size:14}),e.jsx("span",{children:"Instant Access"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(bs,{className:"text-green-500",size:14}),e.jsx("span",{children:"No Auto-renewal"})]})]})})]})]})]})})},Td=s=>s?Pu.create({baseURL:s,withCredentials:!0}):Ae,As={getProperties:async s=>(await Ae.get("/properties",{params:s})).data,getProperty:async s=>(await Ae.get(`/properties/getPropertyById/${s}`)).data,PublicgetProperties:async s=>(await Ae.get("/properties/get-all/",{params:s})).data,PublicgetProperty:async s=>(await Ae.get(`/properties/get-one/${s}`)).data,PublicgetPropertyBySlug:async s=>{try{return(await Ae.get(`/properties/pro-page/${s}`)).data}catch(a){throw a}},createProperty:async s=>(await Ae.post("/properties/create",s)).data,updateProperty:async(s,a)=>(await Ae.put(`/properties/${s}`,a)).data,deleteProperty:async s=>(await Ae.delete(`/properties/delete/${s}`)).data,importBulk:async s=>(await Ae.post("/properties/import-bulk",{rows:s})).data,updateStatus:async(s,a)=>(await Ae.put(`/status-update/${s}/status`,a)).data,getStatusHistory:async s=>(await Ae.get(`/status-update/${s}/status-history`)).data,bulkUpdateStatus:async s=>(await Ae.post("/bulk-operations/status",s)).data,bulkMarkPublic:async s=>(await Ae.post("/bulk-operations/mark-public",s)).data,bulkMarkPrivate:async s=>(await Ae.post("/bulk-operations/mark-private",s)).data,bulkSetVisibility:async s=>(await Ae.post("/bulk-operations/visibility",s)).data,bulkDelete:async s=>(await Ae.delete("/bulk-operations/delete",{data:s})).data,bulkExport:async s=>{const a=await Ae.post("/bulk-operations/export",s,{responseType:s.format==="csv"?"blob":"json"});if(s.format==="csv"){const t=window.URL.createObjectURL(new Blob([a.data])),r=document.createElement("a");return r.href=t,r.setAttribute("download",`properties_export_${Date.now()}.csv`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(t),{success:!0,message:"Export downloaded successfully",data:{downloadCompleted:!0}}}return a.data},markPublic:async(s,a)=>(await Ae.patch(`/bulk-operations/${s}/mark-public`,{updatedBy:a})).data,markPrivate:async(s,a)=>(await Ae.patch(`/bulk-operations/${s}/mark-private`,{updatedBy:a})).data,setVisibility:async(s,a,t)=>(await Ae.patch(`/bulk-operations/${s}/visibility`,{isPublic:a,updatedBy:t})).data,getBulkOperationStatus:async s=>(await Ae.get(`/bulk-operations/operations/${s}`)).data,search:async s=>(await Ae.get("/properties/search",{params:s})).data,getSearch:async s=>(await Ae.get("/properties/search",{params:s})).data,searchProperties:async s=>{var r;const a={city:s.city,location:s.location,budget_min:s.minPrice,budget_max:s.maxPrice,sort:s.sort,propertyType:Array.isArray(s.propertyType)?s.propertyType.join(","):s.propertyType,propertySubtype:Array.isArray(s.propertySubtype)?s.propertySubtype.join(","):s.propertySubtype,unitType:Array.isArray(s.unitType)?s.unitType.join(","):s.unitType,unitTypes:(r=s.unitTypes)==null?void 0:r.join(","),furnishing:s.furnishing,possession:s.possession,featured:s.featured===void 0?void 0:typeof s.featured=="boolean"?s.featured?"1":"0":s.featured,verified:s.verified===void 0?void 0:typeof s.verified=="boolean"?s.verified?"1":"0":s.verified,min_rating:s.minRating,parking:s.parking,floor_min:s.floor_min,floor_max:s.floor_max,bathrooms:s.bathrooms,bedrooms:Array.isArray(s.bedrooms)?s.bedrooms.join(","):s.bedrooms,filter_token:s.filterToken??void 0};return Object.keys(a).forEach(i=>{(a[i]===void 0||a[i]===null||a[i]==="")&&delete a[i]}),(await Ae.get("/properties/",{params:a})).data},getStats:async()=>(await Ae.get("/properties/stats")).data,exportProperties:async()=>(await Ae.get("/properties/export")).data,getSavedProperties:async()=>(await Ae.get("/properties/saved")).data,getRecommendedProperties:async()=>(await Ae.get("/properties/recommended")).data,getPropertyAnalytics:async s=>(await Ae.get(`/properties/${s}/analytics`)).data,generateDescription:async(s,a)=>(await Td(a).post("/ai/generate-description",s)).data,getPropertyBySlug:async s=>{try{return(await Ae.get(`/properties/page/${s}`)).data}catch(a){throw a}},sendPropertyEvent:async(s,a,t,r={},i={})=>{const n=Td(i.baseURLOverride),o={event_type:a,event_name:t,payload:r||{},slug:i.slug,filterToken:i.filterToken},m={params:{},withCredentials:!0};return i.filterParamKey&&i.filterToken?m.params[i.filterParamKey]=String(i.filterToken):i.filterToken&&(m.params.filterToken=String(i.filterToken)),i.slug&&(m.params.slug=String(i.slug)),(await n.post(`/properties/${s}/event`,o,m)).data},createFilterContext:async s=>{var r,i,n;const a=await Ae.post("/properties/filters",s);return{success:((r=a==null?void 0:a.data)==null?void 0:r.success)??!0,id:((i=a==null?void 0:a.data)==null?void 0:i.id)??((n=a==null?void 0:a.data)==null?void 0:n.filterId)??void 0,data:(a==null?void 0:a.data)??void 0}},getFilterContext:async s=>(await Ae.get(`/properties/filters/${encodeURIComponent(s)}`)).data,searchByCityLocation:async s=>{const a={city:s.city,limit:s.limit,offset:s.offset,status:"Available"};return s.locations&&(Array.isArray(s.locations)?a.locations=s.locations.join(","):a.locations=s.locations),s.propertyType&&(a.propertyType=s.propertyType),(await Ae.get("/properties/city-locations",{params:a})).data},generateBrochuresBulkSinglePDF:async(s,a)=>(await Ae.post(`/properties/${encodeURIComponent(s)}/BrochuresBulkSinglePDF`,a,{responseType:"blob"})).data,updateAssignedTo:async(s,a)=>(await Ae.patch(`/properties/${s}/assigned-to`,a)).data,getSimilarProperties:async s=>{try{const a={limit:s.limit??6,exclude_current:s.excludeCurrent!==!1};return s.propertyId!=null&&(a.property_id=s.propertyId),s.type&&(a.type=s.type),!s.type&&s.propertyType&&(a.property_type=s.propertyType),s.subtype&&(a.subtype=s.subtype),s.unitType&&(a.unit_type=s.unitType),s.city&&(a.city=s.city),s.location&&(a.location=s.location),s.furnishing&&(a.furnishing=s.furnishing),s.bedrooms!=null&&(a.bedrooms=s.bedrooms),(await Ae.get("/properties/similar",{params:a})).data}catch(a){return console.error("Error fetching similar properties:",a),{success:!1,data:[],message:"Failed to fetch similar properties"}}},downloadBrochure:(s,a)=>Ae.post(`/properties/${s}/brochure`,a,{responseType:"blob"})},Tr="/views",cr={getTotal:async()=>{try{return(await Ae.get(`${Tr}/total`)).data}catch(s){return console.error("viewsAPI.getTotal failed:",s),{success:!1,total_views:0,unique_views:0}}},getByProperty:async(s,a=!1)=>{try{return(await Ae.get(`${Tr}/property/${s}`,{params:{unique:a}})).data}catch(t){return console.error(`viewsAPI.getByProperty(${s}) failed:`,t),{success:!1,property_id:s,total_views:0,unique_views:0}}},recordView:async(s,a={})=>{if(!s)try{return(await Ae.post(`${Tr}/record`,a)).data}catch(t){return console.error("viewsAPI.recordView (fallback) failed:",t),{success:!1}}try{return(await Ae.post(`${Tr}/property/${s}/record`,a)).data}catch(t){try{return(await Ae.post(`${Tr}/record`,{property_id:s,...a})).data}catch(r){return console.error("viewsAPI.recordView failed:",t,r),{success:!1}}}},getTop:async(s=10,a=!1)=>{try{return(await Ae.get(`${Tr}/top`,{params:{limit:s,unique:a}})).data}catch(t){return console.error("viewsAPI.getTop failed:",t),{success:!1,rows:[]}}},getBottom:async(s=10,a=!1)=>{try{return(await Ae.get(`${Tr}/bottom`,{params:{limit:s,unique:a}})).data}catch(t){return console.error("viewsAPI.getBottom failed:",t),{success:!1,rows:[]}}},getAll:async(s=!1)=>{try{return(await Ae.get(`${Tr}/all`,{params:{unique:s}})).data}catch(a){return console.error("viewsAPI.getAll failed:",a),{success:!1,rows:[]}}}},Du="fltcnt",Hi="re_filter_token",Ya=s=>encodeURIComponent(s||""),kp=s=>{var a;return typeof window<"u"&&((a=window.location)!=null&&a.origin)?window.location.origin:s||"https://investordeal.in"},Cp=s=>{if(typeof window>"u")return null;try{return new URL(window.location.href).searchParams.get(s)}catch{return null}},Ap=(s,a)=>{if(!(typeof window>"u"||!s||!a))try{const t=new URL(window.location.href);t.searchParams.set(s,a),window.history.replaceState({},"",t.toString())}catch{}},Pp=()=>{if(typeof window>"u")return null;try{return sessionStorage.getItem(Hi)||localStorage.getItem(Hi)}catch{return null}},Tp=s=>{if(!(typeof window>"u"||!s))try{sessionStorage.setItem(Hi,s),localStorage.setItem(Hi,s)}catch{}},Ip=({url:s,propertyId:a,slug:t,trackingToken:r,absoluteBase:i,trackingParamKey:n=Du})=>{if(s)try{if(r){const b=new URL(s);return b.searchParams.set(n,r),b.toString()}return s}catch{return s}const o=kp(i);let m="";if(t){const b=t.replace(/^\//,"");m=b.startsWith("properties/")?`/${b}`:`/properties/${b}`}else if(a)m=`/properties/${a}`;else if(typeof window<"u")try{const b=new URL(window.location.href);return r&&b.searchParams.set(n,r),b.toString()}catch{return window.location.href}else return o;const g=new URL(o+m);return r&&g.searchParams.set(n,r),g.toString()};function xn(s){const{onClose:a,title:t="Page Title",description:r="",image:i,url:n,propertyId:o,slug:m,trackingParamKey:g=Du,trackingToken:b,autoCreateTrackingToken:d=!0,absoluteBase:v}=s,[x,u]=l.useState(b),c=l.useRef(!1),f=l.useCallback(async(V,W={})=>{try{const B=o??"0";await As.sendPropertyEvent(B,"share",V,W,{slug:m?String(m):void 0,filterToken:x,filterParamKey:"filter_token"})}catch{}},[o,m,x]);l.useEffect(()=>{c.current||(c.current=!0,(async()=>{var W;let V=b||Cp(g)||Pp()||"";if(!V&&d)try{const B=await As.createFilterContext({filters:{source:"share_modal",slug:m||null,propertyId:o??null},user_id:null});V=(B==null?void 0:B.id)||((W=B==null?void 0:B.data)==null?void 0:W.id)||""}catch{V=""}V&&(u(V),Tp(V),Ap(g,V))})())},[d,g,b,o,m]);const p=t||"",N=r||"",P=l.useMemo(()=>Ip({url:n,propertyId:o,slug:m,trackingToken:x,absoluteBase:v,trackingParamKey:g}),[n,o,m,x,v,g]),w=p+(N?` â€” ${N}`:""),$=`${w}

${P}`,y=`https://wa.me/?text=${Ya($)}`,k=`https://www.facebook.com/sharer/sharer.php?u=${Ya(P)}`,R=`https://twitter.com/intent/tweet?text=${Ya(w)}&url=${Ya(P)}`,F=`https://www.linkedin.com/shareArticle?mini=true&url=${Ya(P)}&title=${Ya(p)}&summary=${Ya(N)}`,T=`https://t.me/share/url?url=${Ya(P)}&text=${Ya(w)}`,j=`mailto:?subject=${Ya(p)}&body=${Ya($)}`,E=async()=>{var W;const V=P;try{if((W=navigator.clipboard)!=null&&W.writeText)await navigator.clipboard.writeText(V),Z.success("Share link copied to clipboard!");else{const B=document.createElement("textarea");B.value=V,B.style.position="fixed",B.style.left="-9999px",document.body.appendChild(B),B.select(),document.execCommand("copy"),document.body.removeChild(B),Z.success("Share link copied to clipboard!")}f("share_copy",{url:P})}catch(B){console.error("Copy failed",B),Z.error("Could not copy. Please copy manually.")}};return l.useEffect(()=>{f("share_open",{hasToken:!!x,trackingParamKey:g})},[x]),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black/50 p-4 !mt-0",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-4 relative",children:[e.jsx("button",{onClick:()=>{f("share_close"),a()},"aria-label":"Close share modal",className:"absolute top-2 right-2 text-gray-500 hover:text-gray-800",children:e.jsx(ns,{size:20})}),e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Share"}),p&&e.jsx("h3",{className:"text-sm font-medium mb-1 truncate",children:p}),N?e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-3",children:N}):null,i?e.jsx("img",{src:i,alt:p,className:"w-full rounded-md mb-3 object-cover max-h-48"}):null,e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{value:P,readOnly:!0,className:"flex-1 text-xs border rounded px-2 py-1 bg-gray-50",onFocus:V=>V.currentTarget.select()}),e.jsxs("button",{onClick:E,className:"flex items-center gap-1 px-2 py-1 text-sm border rounded hover:bg-gray-100",children:[e.jsx(Xt,{size:14})," Copy"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[e.jsxs("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 p-2 rounded-md hover:bg-gray-100 text-xs",onClick:()=>f("share_click",{platform:"whatsapp",url:P}),children:[e.jsx(Yn,{size:18,className:"text-green-600"}),"WhatsApp"]}),e.jsxs("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 p-2 rounded-md hover:bg-gray-100 text-xs",onClick:()=>f("share_click",{platform:"facebook",url:P}),children:[e.jsx(Sr,{size:18,className:"text-blue-600"}),"Facebook"]}),e.jsxs("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 p-2 rounded-md hover:bg-gray-100 text-xs",onClick:()=>f("share_click",{platform:"twitter",url:P}),children:[e.jsx(kr,{size:18,className:"text-sky-500"}),"Twitter"]}),e.jsxs("a",{href:F,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 p-2 rounded-md hover:bg-gray-100 text-xs",onClick:()=>f("share_click",{platform:"linkedin",url:P}),children:[e.jsx(Cr,{size:18,className:"text-blue-700"}),"LinkedIn"]}),e.jsxs("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 p-2 rounded-md hover:bg-gray-100 text-xs",onClick:()=>f("share_click",{platform:"telegram",url:P}),children:[e.jsx(Dt,{size:18,className:"text-sky-600"}),"Telegram"]}),e.jsxs("a",{href:j,className:"flex flex-col items-center gap-1 p-2 rounded-md hover:bg-gray-100 text-xs",onClick:()=>f("share_click",{platform:"email",url:P}),children:[e.jsx(Ds,{size:18,className:"text-red-500"}),"Email"]})]})]})})}const $p=48,Ep=({images:s=[],isOpen:a,onClose:t,initialIndex:r=0})=>{const[i,n]=l.useState(r),[o,m]=l.useState(!1),g=l.useRef(null),b=l.useRef(null),d=l.useRef(!1),v=l.useRef(0);l.useEffect(()=>{n(r)},[r]),l.useEffect(()=>{if(!a)return;v.current=window.scrollY||document.documentElement.scrollTop||0;const $=document.body;return $.style.position="fixed",$.style.top=`-${v.current}px`,$.style.left="0",$.style.right="0",$.style.width="100%",$.style.overflow="hidden",()=>{const y=document.body;y.style.position="",y.style.top="",y.style.left="",y.style.right="",y.style.width="",y.style.overflow="",window.scrollTo(0,v.current)}},[a]),l.useEffect(()=>{const $=y=>{a&&(y.key==="Escape"&&t(),y.key==="ArrowLeft"&&x(),y.key==="ArrowRight"&&u())};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[a,i]);const x=()=>{s.length&&(n($=>($-1+s.length)%s.length),m(!1))},u=()=>{s.length&&(n($=>($+1)%s.length),m(!1))},c=$=>{n($),m(!1)},f=$=>{if(!a)return;const y=$.touches[0];g.current=y.clientX,b.current=y.clientY,d.current=!1},p=()=>{d.current=!0},N=$=>{if(!a||g.current==null||!d.current)return;const y=$.changedTouches[0],k=y.clientX-g.current,R=y.clientY-(b.current??y.clientY);Math.abs(k)>Math.abs(R)&&Math.abs(k)>$p&&(k<0?u():x()),g.current=null,b.current=null,d.current=!1};if(!a)return null;const P=s&&s.length>0,w=P?s[i]:"";return Il.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100000] bg-black",style:{height:"100dvh",paddingTop:"calc(env(safe-area-inset-top) + 0px)",paddingBottom:"calc(env(safe-area-inset-bottom) + 0px)",overscrollBehavior:"contain"},onTouchStart:f,onTouchMove:p,onTouchEnd:N,role:"dialog","aria-modal":"true","aria-label":"Property Gallery",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 z-50 bg-gradient-to-b from-black/80 to-transparent pointer-events-none",children:e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-6 pointer-events-auto",children:[e.jsxs("div",{className:"text-white",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Property Gallery"}),e.jsx("p",{className:"text-sm text-gray-300 mt-1",children:P?`${i+1} / ${s.length}`:"No images"})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("button",{onClick:()=>m($=>!$),className:"p-2 md:p-3 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors backdrop-blur-sm","aria-label":o?"Zoom out":"Zoom in",children:o?e.jsx(Fg,{size:20}):e.jsx(Bg,{size:20})}),e.jsx("button",{onClick:t,className:"p-2 md:p-3 bg-white/10 hover:bg-white/20 rounded-lg text-white transition-colors backdrop-blur-sm","aria-label":"Close gallery",children:e.jsx(ns,{size:20})})]})]})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pt-20 pb-[120px] md:pb-40 px-4",children:e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[e.jsxs("div",{className:`relative transition-transform duration-300 ${o?"scale-150 cursor-grab active:cursor-grabbing":"scale-100"} max-w-full max-h-full`,style:{willChange:"transform",overflow:"hidden"},children:[P?e.jsx("img",{src:w,alt:`Property photo ${i+1}`,className:"max-w-full max-h-full w-auto h-auto object-contain select-none pointer-events-auto",draggable:!1}):e.jsx("div",{className:"text-white/70 text-sm",children:"No images available"}),P&&e.jsx("div",{className:"absolute inset-0 pointer-events-none select-none",children:e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-30",children:e.jsx("div",{className:"text-white font-bold text-2xl md:text-2xl lg:text-2xl whitespace-nowrap",children:"ResaleExpert.in"})})})]}),P&&s.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:x,className:"absolute left-2 md:left-4 p-3 md:p-4 bg-black/50 hover:bg-black/70 rounded-full text-white transition-colors backdrop-blur-sm","aria-label":"Previous image",children:e.jsx(Wa,{size:24,className:"md:w-8 md:h-8"})}),e.jsx("button",{onClick:u,className:"absolute right-2 md:right-4 p-3 md:p-4 bg-black/50 hover:bg-black/70 rounded-full text-white transition-colors backdrop-blur-sm","aria-label":"Next image",children:e.jsx(pa,{size:24,className:"md:w-8 md:h-8"})})]})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent",style:{paddingBottom:"calc(env(safe-area-inset-bottom) + 8px)"},children:e.jsx("div",{className:"p-4 md:p-6 overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:e.jsx("div",{className:"flex gap-2 md:gap-3 justify-start md:justify-center min-w-min",children:P&&s.map(($,y)=>e.jsxs("button",{onClick:()=>c(y),className:`relative flex-shrink-0 w-16 h-16 md:w-20 md:h-20 rounded-lg overflow-hidden transition-all ${i===y?"ring-4 ring-blue-500 scale-110":"ring-2 ring-white/30 hover:ring-white/60 opacity-60 hover:opacity-100"}`,children:[e.jsx("img",{src:$,alt:`Thumbnail ${y+1}`,className:"w-full h-full object-cover pointer-events-none",draggable:!1}),i===y&&e.jsx("div",{className:"absolute inset-0 bg-blue-500/20"})]},y))})})})]}),document.body)},Ml={sofa:{label:"Sofa",Icon:Kg,bg:"bg-amber-50",fg:"text-amber-700"},recliner:{label:"Recliner",Icon:wd,bg:"bg-indigo-50",fg:"text-indigo-700"},"center-table":{label:"Center Table",Icon:Hl,bg:"bg-orange-50",fg:"text-orange-700"},"side-table":{label:"Side Table",Icon:Hl,bg:"bg-orange-50",fg:"text-orange-700"},"dining-set":{label:"Dining Set",Icon:Hl,bg:"bg-lime-50",fg:"text-lime-700"},"tv-unit":{label:"TV Unit",Icon:$i,bg:"bg-purple-50",fg:"text-purple-700"},"bed-king":{label:"King Bed",Icon:jl,bg:"bg-violet-50",fg:"text-violet-700"},"bed-queen":{label:"Queen Bed",Icon:jl,bg:"bg-violet-50",fg:"text-violet-700"},mattress:{label:"Mattress",Icon:jl,bg:"bg-slate-50",fg:"text-slate-700"},"bedside-table":{label:"Bedside Table",Icon:Hl,bg:"bg-slate-50",fg:"text-slate-700"},wardrobe:{label:"Wardrobe (Almirah)",Icon:Gg,bg:"bg-emerald-50",fg:"text-emerald-700"},"dressing-table":{label:"Dressing Table",Icon:uo,bg:"bg-zinc-50",fg:"text-zinc-700"},"study-table":{label:"Study Table",Icon:Hl,bg:"bg-blue-50",fg:"text-blue-700"},"study-chair":{label:"Study Chair",Icon:wd,bg:"bg-blue-50",fg:"text-blue-700"},bookshelf:{label:"Bookshelf",Icon:Yg,bg:"bg-amber-50",fg:"text-amber-700"},"shoe-rack":{label:"Shoe Rack",Icon:dl,bg:"bg-rose-50",fg:"text-rose-700"},"pooja-unit":{label:"Pooja Mandir",Icon:Nd,bg:"bg-lime-50",fg:"text-lime-700"},curtains:{label:"Curtains",Icon:dl,bg:"bg-fuchsia-50",fg:"text-fuchsia-700"},carpet:{label:"Carpet / Rug",Icon:dl,bg:"bg-rose-50",fg:"text-rose-700"},"wall-art":{label:"Wall Art / Frames",Icon:Hg,bg:"bg-pink-50",fg:"text-pink-700"},"indoor-plant":{label:"Indoor Plant",Icon:Nd,bg:"bg-emerald-50",fg:"text-emerald-700"},mirror:{label:"Mirror",Icon:uo,bg:"bg-zinc-50",fg:"text-zinc-700"},"balcony-set":{label:"Balcony Chairs/Table",Icon:vr,bg:"bg-green-50",fg:"text-green-700"},"modular-kitchen":{label:"Modular Kitchen",Icon:ml,bg:"bg-lime-50",fg:"text-lime-700"},chimney:{label:"Chimney",Icon:vd,bg:"bg-slate-50",fg:"text-slate-700"},"gas-stove":{label:"Gas Stove / Hob",Icon:ml,bg:"bg-orange-50",fg:"text-orange-700"},"ro-purifier":{label:"RO Purifier",Icon:fl,bg:"bg-sky-50",fg:"text-sky-700"},refrigerator:{label:"Refrigerator",Icon:Wg,bg:"bg-teal-50",fg:"text-teal-700"},microwave:{label:"Microwave/OTG",Icon:Vg,bg:"bg-rose-50",fg:"text-rose-700"},"utensils-crockery":{label:"Utensils & Crockery",Icon:ml,bg:"bg-zinc-50",fg:"text-zinc-700"},"mixer-grinder":{label:"Mixer Grinder",Icon:ml,bg:"bg-zinc-50",fg:"text-zinc-700"},"washing-machine":{label:"Washing Machine",Icon:qg,bg:"bg-cyan-50",fg:"text-cyan-700"},ac:{label:"Split/Window AC",Icon:vd,bg:"bg-cyan-50",fg:"text-cyan-700"},"ceiling-fan":{label:"Ceiling Fan",Icon:Ug,bg:"bg-slate-50",fg:"text-slate-700"},"air-cooler":{label:"Air Cooler",Icon:jd,bg:"bg-teal-50",fg:"text-teal-700"},geyser:{label:"Geyser",Icon:Og,bg:"bg-rose-50",fg:"text-rose-700"},"inverter-ups":{label:"Inverter / UPS",Icon:Ft,bg:"bg-yellow-50",fg:"text-yellow-700"},stabilizer:{label:"Stabilizer",Icon:Ft,bg:"bg-yellow-50",fg:"text-yellow-700"},"wifi-router":{label:"Wi-Fi Router",Icon:ao,bg:"bg-indigo-50",fg:"text-indigo-700"},tv:{label:"Television",Icon:$i,bg:"bg-purple-50",fg:"text-purple-700"},soundbar:{label:"Soundbar / HT",Icon:$i,bg:"bg-violet-50",fg:"text-violet-700"},lighting:{label:"Lights / Lamps",Icon:er,bg:"bg-amber-50",fg:"text-amber-700"},"tube-light":{label:"Tube Light",Icon:er,bg:"bg-zinc-50",fg:"text-zinc-700"},"iron-board":{label:"Iron + Board",Icon:dl,bg:"bg-blue-50",fg:"text-blue-700"},"vacuum-cleaner":{label:"Vacuum Cleaner",Icon:jd,bg:"bg-slate-50",fg:"text-slate-700"},"locker-safe":{label:"Safe / Locker",Icon:Gr,bg:"bg-slate-50",fg:"text-slate-700"},"key-holder":{label:"Key Holder",Icon:dl,bg:"bg-slate-50",fg:"text-slate-700"},clock:{label:"Wall Clock",Icon:uo,bg:"bg-zinc-50",fg:"text-zinc-700"},"outdoor-planter":{label:"Outdoor Planter",Icon:vr,bg:"bg-green-50",fg:"text-green-700"},"bbq-grill":{label:"BBQ Grill",Icon:ml,bg:"bg-orange-50",fg:"text-orange-700"},other:{label:"Other",Icon:to,bg:"bg-gray-50",fg:"text-gray-700"}},Mp=[[/(^|\b)(sofa|couch|diwan|divan|sectional|loveseat)(\b|$)/i,"sofa"],[/(recliner|loung(e)? chair)/i,"recliner"],[/(center|coffee)\s*table/i,"center-table"],[/(side|end)\s*table/i,"side-table"],[/(dining)\s*(table|set|chair)/i,"dining-set"],[/tv\s*(unit|console|cabinet)/i,"tv-unit"],[/(king)\s*bed/i,"bed-king"],[/(queen)\s*bed/i,"bed-queen"],[/\bmattress\b|coir|spring|foam/i,"mattress"],[/(bedside|night)\s*table/i,"bedside-table"],[/(wardrobe|almirah|almera|closet|cupboard)/i,"wardrobe"],[/dressing\s*(table)?|dresser/i,"dressing-table"],[/(study|office)\s*(table|desk)/i,"study-table"],[/(study|office)\s*chair/i,"study-chair"],[/(book\s*shelf|bookcase|library)/i,"bookshelf"],[/(shoe\s*(rack|cabinet))/i,"shoe-rack"],[/(pooja|puja|mandir|temple)/i,"pooja-unit"],[/(curtain|curtains|drape|blind)/i,"curtains"],[/(carpet|rug|mat)/i,"carpet"],[/(wall\s*(art|frame|painting|photo))/i,"wall-art"],[/(indoor\s*plant|planter)/i,"indoor-plant"],[/(mirror|looking\s*glass)/i,"mirror"],[/(balcony).*(chair|table|set)|patio/i,"balcony-set"],[/(modular\s*kitchen|kitchen\s*cabinet|pantry)/i,"modular-kitchen"],[/(chimney|hood|exhaust)/i,"chimney"],[/(gas\s*(stove|hob)|cooktop|burner|chulha)/i,"gas-stove"],[/(ro|r\.o\.|water\s*purifier|aquaguard|kent)/i,"ro-purifier"],[/(fridge|refrigerator|freezer)/i,"refrigerator"],[/(microwave|otg|toaster|convection|oven)/i,"microwave"],[/(utensil|crockery|cutlery|plates?|bowls?|spoons?|forks?)/i,"utensils-crockery"],[/(mixer|grinder|blender)/i,"mixer-grinder"],[/(washing\s*machine|washer)/i,"washing-machine"],[/(a\.?\s?c\.?|air\s?cond|split\s?ac|window\s?ac)/i,"ac"],[/(ceiling\s*fan|fan\b)/i,"ceiling-fan"],[/(air\s*cooler|desert\s*cooler)/i,"air-cooler"],[/(geyser|water\s*heater)/i,"geyser"],[/(inverter|ups|power\s*backup)/i,"inverter-ups"],[/(stabilizer)/i,"stabilizer"],[/(wi[- ]?fi|router|broadband|internet)/i,"wifi-router"],[/(^tv$|television|smart\s*tv)/i,"tv"],[/(soundbar|home\s*theatre|home\s*theater)/i,"soundbar"],[/(light|lamp|chandelier|pendant)/i,"lighting"],[/(tube\s*light|cfl|fluorescent)/i,"tube-light"],[/(iron|ironing\s*board|press)/i,"iron-board"],[/(vacuum|vacuum\s*cleaner|hoover)/i,"vacuum-cleaner"],[/(safe|locker)/i,"locker-safe"],[/(key\s*(holder|box))/i,"key-holder"],[/(clock|wall\s*clock|alarm)/i,"clock"],[/(outdoor\s*plant|garden\s*pot|planter)/i,"outdoor-planter"],[/(bbq|barbecue|grill)/i,"bbq-grill"]];function Lp(s){const a=(s||"").trim();if(!a)return Ml.other;if(Ml[a])return Ml[a];const t=Object.values(Ml).find(i=>i.label.toLowerCase()===a.toLowerCase());if(t)return t;const r=Mp.find(([i])=>i.test(a));return r?Ml[r[1]]:{...Ml.other,label:a}}function Ru({name:s,size:a=14,compact:t=!1,className:r=""}){const{Icon:i,label:n,bg:o,fg:m}=Lp(s);return e.jsxs("div",{className:["inline-flex items-center gap-2 rounded-lg",o,t?"px-2 py-1":"p-2",r].join(" "),title:n,children:[e.jsx(i,{size:a,className:m}),e.jsx("span",{className:["truncate",t?"text-xs":"text-sm",m].join(" "),children:n})]})}function Dp(s){return(s||"").toLowerCase().replace(/&/g,"and").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")||"other"}const fo={amphitheatre:{label:"Amphitheatre",Icon:Ns,bg:"bg-purple-50",fg:"text-purple-700"},"bicycle-cycle-storage":{label:"Bicycle / Cycle Storage",Icon:sh,bg:"bg-emerald-50",fg:"text-emerald-700"},"business-center":{label:"Business Center",Icon:Ns,bg:"bg-gray-50",fg:"text-gray-700"},cctv:{label:"CCTV",Icon:Sa,bg:"bg-emerald-50",fg:"text-emerald-700"},cafeteria:{label:"Cafeteria",Icon:ml,bg:"bg-lime-50",fg:"text-lime-700"},"car-wash":{label:"Car Wash",Icon:fl,bg:"bg-gray-50",fg:"text-gray-700"},clubhouse:{label:"Clubhouse",Icon:Nr,bg:"bg-purple-50",fg:"text-purple-700"},"common-toilets":{label:"Common Toilets",Icon:Gn,bg:"bg-sky-50",fg:"text-sky-700"},"conference-room":{label:"Conference Room",Icon:Ns,bg:"bg-gray-50",fg:"text-gray-700"},creche:{label:"Creche",Icon:Sd,bg:"bg-pink-50",fg:"text-pink-700"},"cricket-pitch-nets":{label:"Cricket Pitch / Nets",Icon:Zl,bg:"bg-amber-50",fg:"text-amber-700"},"dg-rooms":{label:"DG Rooms",Icon:Zn,bg:"bg-yellow-50",fg:"text-yellow-700"},"double-height-lobbies":{label:"Double Height Lobbies",Icon:Nr,bg:"bg-slate-50",fg:"text-slate-700"},"drop-off-area":{label:"Drop-off Area",Icon:Qs,bg:"bg-slate-50",fg:"text-slate-700"},"ev-charging":{label:"EV Charging",Icon:Zn,bg:"bg-yellow-50",fg:"text-yellow-700"},elevator:{label:"Elevator",Icon:Nr,bg:"bg-slate-50",fg:"text-slate-700"},elevators:{label:"Elevators",Icon:Nr,bg:"bg-slate-50",fg:"text-slate-700"},escalator:{label:"Escalator",Icon:Nr,bg:"bg-slate-50",fg:"text-slate-700"},"fire-alarm":{label:"Fire Alarm",Icon:Xa,bg:"bg-red-50",fg:"text-red-700"},"fire-safety":{label:"Fire Safety",Icon:Xa,bg:"bg-red-50",fg:"text-red-700"},"fire-staircases":{label:"Fire Staircases",Icon:Xa,bg:"bg-red-50",fg:"text-red-700"},"game-rooms":{label:"Game Rooms",Icon:kd,bg:"bg-violet-50",fg:"text-violet-700"},"garbage-chute":{label:"Garbage Chute",Icon:Es,bg:"bg-rose-50",fg:"text-rose-700"},garden:{label:"Garden",Icon:vr,bg:"bg-green-50",fg:"text-green-700"},"generator-rooms":{label:"Generator Rooms",Icon:Zn,bg:"bg-yellow-50",fg:"text-yellow-700"},"green-building-certification":{label:"Green Building Certification",Icon:eh,bg:"bg-green-50",fg:"text-green-700"},"guest-rooms":{label:"Guest Rooms",Icon:Oc,bg:"bg-blue-50",fg:"text-blue-700"},"gym-fitness-center":{label:"Gym / Fitness Center",Icon:Bc,bg:"bg-fuchsia-50",fg:"text-fuchsia-700"},"indoor-games-room":{label:"Indoor Games Room",Icon:kd,bg:"bg-violet-50",fg:"text-violet-700"},"jogging-track":{label:"Jogging Track",Icon:Zl,bg:"bg-amber-50",fg:"text-amber-700"},"kids-play-area":{label:"Kids Play Area",Icon:Sd,bg:"bg-pink-50",fg:"text-pink-700"},library:{label:"Library",Icon:_d,bg:"bg-amber-50",fg:"text-amber-700"},"locker-room":{label:"Locker Room",Icon:Un,bg:"bg-emerald-50",fg:"text-emerald-700"},"lush-landscapes":{label:"Lush Landscapes",Icon:vr,bg:"bg-green-50",fg:"text-green-700"},"meeting-room":{label:"Meeting Room",Icon:Ns,bg:"bg-gray-50",fg:"text-gray-700"},"mini-theatre":{label:"Mini Theatre",Icon:$i,bg:"bg-purple-50",fg:"text-purple-700"},"music-room":{label:"Music Room",Icon:Xg,bg:"bg-purple-50",fg:"text-purple-700"},"open-sitting-area":{label:"Open Sitting Area",Icon:Ns,bg:"bg-gray-50",fg:"text-gray-700"},pharmacy:{label:"Pharmacy",Icon:Zg,bg:"bg-teal-50",fg:"text-teal-700"},"power-backup":{label:"Power Backup",Icon:Zn,bg:"bg-yellow-50",fg:"text-yellow-700"},"prayer-room":{label:"Prayer Room",Icon:zt,bg:"bg-amber-50",fg:"text-amber-700"},"rainwater-harvesting":{label:"Rainwater Harvesting",Icon:fl,bg:"bg-blue-50",fg:"text-blue-700"},"reading-room":{label:"Reading Room",Icon:_d,bg:"bg-amber-50",fg:"text-amber-700"},restaurant:{label:"Restaurant",Icon:ml,bg:"bg-lime-50",fg:"text-lime-700"},"retail-shopping":{label:"Retail/Shopping",Icon:Qg,bg:"bg-rose-50",fg:"text-rose-700"},"security-cabin":{label:"Security Cabin",Icon:Un,bg:"bg-emerald-50",fg:"text-emerald-700"},"servant-room":{label:"Servant Room",Icon:Ns,bg:"bg-gray-50",fg:"text-gray-700"},"smart-lighting":{label:"Smart Lighting",Icon:er,bg:"bg-yellow-50",fg:"text-yellow-700"},"smoke-detectors":{label:"Smoke Detectors",Icon:Xa,bg:"bg-red-50",fg:"text-red-700"},"society-office":{label:"Society Office",Icon:Ns,bg:"bg-gray-50",fg:"text-gray-700"},"solar-power":{label:"Solar Power",Icon:Jg,bg:"bg-yellow-50",fg:"text-yellow-700"},spa:{label:"Spa",Icon:vr,bg:"bg-green-50",fg:"text-green-700"},"sports-courts":{label:"Sports Courts",Icon:Zl,bg:"bg-amber-50",fg:"text-amber-700"},"street-lighting":{label:"Street Lighting",Icon:er,bg:"bg-yellow-50",fg:"text-yellow-700"},"swimming-pool":{label:"Swimming Pool",Icon:Fc,bg:"bg-blue-50",fg:"text-blue-700"},"valet-parking":{label:"Valet Parking",Icon:Sl,bg:"bg-amber-50",fg:"text-amber-700"},"visitor-parking":{label:"Visitor Parking",Icon:Sl,bg:"bg-amber-50",fg:"text-amber-700"},"water-treatment":{label:"Water Treatment",Icon:fl,bg:"bg-blue-50",fg:"text-blue-700"},"water-treatment-plant":{label:"Water Treatment Plant",Icon:fl,bg:"bg-blue-50",fg:"text-blue-700"},"wellness-spa":{label:"Wellness / Spa",Icon:vr,bg:"bg-green-50",fg:"text-green-700"},"wifi-in-common-areas":{label:"WiFi in Common Areas",Icon:ao,bg:"bg-indigo-50",fg:"text-indigo-700"},"yoga-meditation-area":{label:"Yoga / Meditation Area",Icon:vr,bg:"bg-green-50",fg:"text-green-700"}},Rp=[[/swim|pool/i,"swimming-pool"],/wifi|wi[-_\s]?fi|internet/i.test.toString?[/wifi|wi[-_\s]?fi|internet/i,"wifi-in-common-areas"]:[/wifi/i,"wifi-in-common-areas"],[/gym|fitness/i,"gym-fitness-center"],[/garden|landscape/i,"garden"],[/club/i,"clubhouse"],[/elevat|escalator/i,"elevator"],[/park(ing)?\b|valet|visitor/i,"visitor-parking"],[/bath|toilet|washroom/i,"common-toilets"],[/cctv|camera|security cabin|security/i,"cctv"],[/ac|air.?cond/i,"elevator"],[/heater|geyser/i,"common-toilets"],[/water treatment|stp|sewage/i,"water-treatment"],[/kids|play|creche/i,"kids-play-area"],[/conference|meeting/i,"conference-room"],[/kitchen|cafeteria|restaurant/i,"cafeteria"],[/ev.?charging|charging/i,"ev-charging"],[/solar/i,"solar-power"],[/generator|power backup|dg rooms/i,"power-backup"],[/garbage|waste|chute/i,"garbage-chute"],[/library|reading/i,"library"],[/music/i,"music-room"],[/game/i,"game-rooms"],[/cricket|sport|court/i,"sports-courts"],[/prayer|temple/i,"prayer-room"],[/pharmacy|medical/i,"pharmacy"],[/smart.*light|street.*light|lighting/i,"street-lighting"],[/shopping|retail/i,"retail-shopping"],[/bicycle|cycle/i,"bicycle-cycle-storage"],[/drop[-\s]?off/i,"drop-off-area"],[/guest/i,"guest-rooms"]];function zp(s){const a=Dp(s);if(fo[a])return fo[a];const t=Rp.find(([r])=>r.test(s));if(t){const r=fo[t[1]];if(r)return r}return{label:(s||"Other").trim(),Icon:to,bg:"bg-gray-50",fg:"text-gray-700"}}function zu({name:s,size:a=14,className:t="",compact:r=!1}){const i=zp(s),{Icon:n,label:o,bg:m,fg:g}=i;return e.jsxs("div",{className:["inline-flex items-center gap-2 rounded-lg",m,r?"px-2 py-1":"p-2",t].join(" "),title:o,children:[e.jsx(n,{size:a,className:g}),e.jsx("span",{className:["truncate",r?"text-xs":"text-sm",g].join(" "),children:o})]})}const Wn={"new listing":{bg:"bg-emerald-600/90",text:"text-white",ring:"ring-white/20",emoji:"ðŸ†•"},"hot deal":{bg:"bg-rose-600/90",text:"text-white",ring:"ring-white/20",emoji:"ðŸ”¥"},verified:{bg:"bg-gradient-to-r from-green-500 to-emerald-600 backdrop-blur-sm",text:"text-white font-bold",ring:"ring-green-400/50",emoji:bs},"urgent sale":{bg:"bg-amber-600/90",text:"text-white",ring:"ring-white/20",emoji:"â³  "},exclusive:{bg:"bg-purple-600/90",text:"text-white",ring:"ring-white/20",emoji:"ðŸ”’"},"direct owner":{bg:"bg-teal-600/90",text:"text-white",ring:"ring-white/20",emoji:"ðŸ‘¤"},featured:{bg:"bg-gradient-to-r from-orange-500 to-red-500",text:"text-white font-bold",ring:"ring-white/20",emoji:Ft},"recently updated":{bg:"bg-cyan-600/90",text:"text-white",ring:"ring-white/20",emoji:"ðŸ•’"},"best price":{bg:"bg-yellow-600/90",text:"text-white",ring:"ring-white/20",emoji:"ðŸ·ï¸"},premium:{bg:"bg-amber-500/95",text:"text-white font-semibold",ring:"ring-amber-200/50",emoji:"ðŸ’Ž"},"sold out":{bg:"bg-neutral-500/80",text:"text-white font-semibold",ring:"ring-white/10",emoji:"ðŸ›‘"},"on hold":{bg:"bg-amber-500/90",text:"text-white font-semibold",ring:"ring-white/20",emoji:"â¸ï¸"},available:{bg:"bg-green-600/90",text:"text-white font-semibold",ring:"ring-white/20",emoji:"âœ…"}},Fp={bg:"bg-black/60",text:"text-white",ring:"ring-white/10"},Bp=s=>String(s??"").trim();function Ea(s,a){const t=Bp(s).toLowerCase();return(a?{...Wn,...Op(a)}:Wn)[t]??Fp}function Op(s){const a={};return Object.entries(s).forEach(([t,r])=>a[t.toLowerCase()]=r),a}async function Zr(s){const{data:a}=await s;if(a.success===!1)throw new Error(a.message||"Request failed");return a.data}const Qt={async getAll(){return Zr(Ae.get("/property-tags/getall"))},async getById(s){return Zr(Ae.get(`/property-tags/${s}`))},async replace(s,a,t="User"){return Zr(Ae.put(`/property-tags/${s}`,{tags:a,updatedBy:t}))},async add(s,a,t="User"){return Zr(Ae.post(`/property-tags/${s}/add`,{tags:a,updatedBy:t}))},async remove(s,a,t="User"){return Zr(Ae.post(`/property-tags/${s}/remove`,{tags:a,updatedBy:t}))},async deleteRow(s){return Zr(Ae.delete(`/property-tags/${s}`))},async deleteTagEverywhere(s){return Zr(Ae.delete(`/property-tags/tags/${encodeURIComponent(s)}`))}};function Id(s,a){if(!s)return" - ";const t=Array.from(new Set(a.filter(Boolean))).sort((n,o)=>o.length-n.length);if(!t.length)return s;const r=new RegExp(`(${t.map(n=>n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|")})`,"gi");return s.split(r).map((n,o)=>r.test(n)?e.jsx("strong",{className:"font-semibold text-gray-900",children:n},o):e.jsx("span",{children:n},o))}function Up(s,a){var c,f,p;const t=[],r=(N,P)=>{if(P==null)return;const w=String(P).trim();!w||w==="-"||w==="null"||t.push({label:N,value:w})},i=s.match(/(\d{2,5})\s*(sq\.?\s*ft|sqft|sq ft|sq\.? m|sqm)/i),n=s.match(/â‚¹\s?[\d,\.]+(\s*cr|\s*l(ak)?h)?/i),o=s.match(/(\d+)\s*(bh?k)/i),m=s.match(/(\d+)\s*bath(room)?s?/i),g=s.match(/(\d+)\s*parking/i),b=s.match(/(19|20)\d{2}/),d=s.match(/\b(east|west|north|south|north-east|south-east|north-west|south-west)\b/i),v=s.match(/\b(un-?furnished|semi-?furnished|fully-?furnished)\b/i),x=s.match(/\b(in|at)\s+([A-Za-z ]+,\s*[A-Za-z ]+)\b/);r("Price",n==null?void 0:n[0]),r("Configuration",(c=o==null?void 0:o[0])==null?void 0:c.toUpperCase()),r("Carpet Area",i?`${i[1]} ${i[2]}`:void 0),r("Bathrooms",m==null?void 0:m[1]),r("Parking",g==null?void 0:g[0]),r("Built Year",b==null?void 0:b[0]),r("Facing",(f=d==null?void 0:d[0])==null?void 0:f.toUpperCase()),r("Furnishing",(p=v==null?void 0:v[0])==null?void 0:p.replace(/-/g," ")),r("Location",x==null?void 0:x[2]),a&&(r("City",a.city),r("Locality",a.locality||a.area),r("Bedrooms",a.bedrooms),r("Bathrooms",a.bathrooms),r("Parking",a.parking),r("Carpet Area",a.carpet_area&&`${a.carpet_area} sq ft`),r("Built Year",a.built_year),r("Facing",a.facing),r("Furnishing",a.furnishing),r("Type",a.property_type));const u=new Set;return t.filter(N=>{const P=N.label+":"+N.value.toLowerCase();return u.has(P)?!1:(u.add(P),!0)})}function qp(s){return s.split(new RegExp("\\n+|(?<=\\.)\\s+")).map(a=>a.trim().replace(/^[-â€¢\u2022]\s*/,"")).filter(a=>a.length>=20&&a.length<=180).slice(0,6)}function Vp({description:s,property:a}){const[t,r]=l.useState(!1),i=(s==null?void 0:s.trim())||" - ",n=l.useMemo(()=>Up(i,a),[i,a]);l.useMemo(()=>qp(i),[i]);const o=l.useMemo(()=>{const m=["2BHK","3BHK","Commercial","Prime location","Covered parking","Carpet Area","Budget","Furnishing","Unfurnished","Semi Furnished","Fully Furnished","Baner","Mumbai","Visibility","Accessibility"];return n.forEach(g=>m.push(g.value)),m},[n]);return e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm p-3 sm:p-4 mb-3 sm:mb-4",children:[e.jsx("h2",{className:"font-bold text-gray-900 text-sm sm:text-base mb-2 sm:mb-3",children:"Property Description"}),e.jsx("div",{className:"text-xs sm:text-sm md:text-base text-gray-700 leading-relaxed",children:t?e.jsx("p",{children:Id(i,o)}):e.jsx("p",{children:Id(i.slice(0,420)+(i.length>420?"â€¦":""),o)})}),e.jsx("div",{children:"ðŸ“ž Call now to schedule a site visit and make this beautiful home yours!"}),i.length>420&&e.jsx("button",{onClick:()=>r(m=>!m),className:"mt-2 text-xs sm:text-sm font-medium text-indigo-600 hover:underline",children:t?"Show less":"Read more"})]})}const Wp=({properties:s,loading:a,currentPropertyId:t,debug:r=!1})=>{const[i,n]=l.useState({}),[o,m]=l.useState(!1),g=$=>{if($!=null){if(typeof $=="number"&&Number.isFinite($))return $;if(typeof $=="string"){const y=Number($.replace(/[^\d.]/g,""));return Number.isFinite(y)?y:void 0}}},b=$=>{const y=g($);return!y||y<1||y>12?"":new Date(0,y-1).toLocaleString("en",{month:"short"})},d=$=>$==null||!Number.isFinite($)?"Price on request":$>=1e7?`â‚¹${($/1e7).toFixed(1)} Cr`:$>=1e5?`â‚¹${($/1e5).toFixed(1)} L`:`â‚¹${$.toLocaleString("en-IN")}`,v=($,y)=>{var k;return $[y]??((k=$.raw)==null?void 0:k[y])},x=$=>{const y=v($,"title");if(y)return String(y);const k=[v($,"type"),v($,"unitType")||v($,"unit_type"),v($,"subtype")].filter(Boolean);return k.length?k.join(" "):"Property Listing"},u=$=>$==null||$===""?"-":String($),c=$=>{var k,R,F,T,j,E,V,W,B,M,A;const y=[(k=$.photos)==null?void 0:k[0],(R=$.images)==null?void 0:R[0],(T=(F=$.raw)==null?void 0:F.photos)==null?void 0:T[0],(E=(j=$.raw)==null?void 0:j.images)==null?void 0:E[0],(W=(V=$.raw)==null?void 0:V.photoUrls)==null?void 0:W[0],(A=(M=(B=$.raw)==null?void 0:B.media)==null?void 0:M[0])==null?void 0:A.url];for(const L of y)if(L&&typeof L=="string")return L.startsWith("/")?`${window.location.origin}${L}`:L;return"https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=400&h=250&fit=crop"},f=$=>{var k,R,F,T,j;const y=[$.price,(k=$.raw)==null?void 0:k.price,(R=$.raw)==null?void 0:R.budget,(F=$.raw)==null?void 0:F.amount,(T=$.raw)==null?void 0:T.listing_price,(j=$.raw)==null?void 0:j.listingPrice];for(const E of y){const V=g(E);if(V!==void 0)return d(V)}return"Price on request"},p=$=>$.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"").slice(0,80),N=l.useMemo(()=>s.filter($=>$.id!==t).slice(0,6),[s,t]);l.useEffect(()=>{let $=!0;async function y(){if(!N.length){n({}),m(!0);return}const k={};await Promise.all(N.map(async R=>{try{const F=await Qt.getById(R.id);k[R.id]=(F==null?void 0:F.tags)||[]}catch{k[R.id]=[]}})),$&&(n(k),m(!0))}return y(),()=>{$=!1}},[N]);const P=$=>{var j;const y=$.slug||((j=$.raw)==null?void 0:j.slug),k=(y==null?void 0:y.trim())||`${$.id}-${p(x($))}`,R=new URLSearchParams(window.location.search),F=R.get("fltcnt")||R.get("filter_token"),T=F?`/properties/${encodeURIComponent(k)}?fltcnt=${encodeURIComponent(F)}`:`/properties/${encodeURIComponent(k)}`;window.open(T,"_blank")},w=({property:$})=>{var B;const y=f($),k=g(v($,"square_feet")||v($,"area")),R=g($.price)??g((B=$.raw)==null?void 0:B.price),T=R&&k?Math.round(R/k):void 0,j=b(v($,"possession_month")),E=v($,"possession_year"),V=[j,E].filter(Boolean).join(" "),W=i[$.id]||[];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 cursor-pointer hover:border-[#0b3856] overflow-hidden group",onClick:()=>P($),children:[e.jsxs("div",{className:"relative h-32 sm:h-36",children:[e.jsx("img",{src:c($),alt:x($),className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),!!W.length&&e.jsx("div",{className:"absolute top-2 left-2 z-10 flex gap-1 flex-wrap max-w-[85%]",children:W.slice(0,2).map((M,A)=>{const L=Ea(M),D=L.emoji;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded ring-1 uppercase ${L.bg} ${L.text} ${L.ring} text-[10px] font-medium`,children:[typeof D=="string"?e.jsx("span",{children:D}):D&&Ps.createElement(D,{size:11}),e.jsx("span",{className:"truncate max-w-[80px]",children:M})]},A)})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("span",{className:"bg-[#E6761D] text-white px-2 py-1 rounded text-[11px] font-semibold",children:y})}),V&&e.jsx("div",{className:"absolute bottom-2 left-2",children:e.jsxs("span",{className:"bg-white/95 text-[#0b3856] px-2 py-1 rounded text-[10px] font-medium border border-gray-300",children:["Possession: ",V]})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-[#0b3856] mb-1 line-clamp-1 group-hover:text-[#0c3854]",children:x($)}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-[13px] font-bold text-[#0b3856]",children:y}),T&&e.jsxs("div",{className:"text-[11px] text-gray-600 mt-0.5",children:["â‚¹",T,"/sq ft"]})]}),e.jsxs("div",{className:"flex items-start gap-1 text-gray-600 mb-2",children:[e.jsx(Qs,{size:12,className:"mt-0.5"}),e.jsx("span",{className:"text-xs line-clamp-2",children:u(v($,"locationNormalized")||$.city)})]})]})]})};return a?e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 ring-1 ring-gray-100 animate-pulse space-y-3",children:[1,2,3].map($=>e.jsx("div",{className:"h-20 bg-gray-100 rounded-lg"},$))}):N.length?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 ring-1 ring-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(yt,{size:18,className:"text-[#0b3856]"}),e.jsx("h3",{className:"font-bold text-[#0b3856] text-sm",children:"Similar Properties"})]}),e.jsx("div",{className:"space-y-4",children:N.map($=>e.jsx(w,{property:$},$.id))}),e.jsx("div",{className:"text-center mt-4 pt-4 border-t border-gray-100",children:e.jsx("button",{className:"bg-[#E6761D]  hover:bg-[#E6761D]  text-white px-4 py-2 rounded-lg text-xs font-semibold shadow-sm w-full",onClick:()=>window.location.href="/properties",children:"View All Properties"})})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 ring-1 ring-gray-100 text-center",children:[e.jsx(yt,{size:24,className:"text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No similar properties found"})]})},Xr="/buyer-saved-properties",Hr={toggle:async(s,a,t="toggle")=>{try{const{data:r}=await Ae.post(`${Xr}`,{buyerId:s,propertyId:a,mode:t});return r}catch(r){throw console.error("Toggle save failed:",r),r}},listByBuyer:async(s,a)=>{try{const t=new URLSearchParams;a!=null&&a.includeProperty&&t.set("includeProperty","true"),(a==null?void 0:a.limit)!=null&&t.set("limit",String(a.limit)),(a==null?void 0:a.offset)!=null&&t.set("offset",String(a.offset));const r=`${Xr}/${s}${t.toString()?`?${t.toString()}`:""}`,{data:i}=await Ae.get(r);return i}catch(t){throw console.error("List saved properties failed:",t),t}},isSaved:async(s,a)=>{try{const{data:t}=await Ae.get(`${Xr}/check/${s}/${a}`);return t}catch(t){throw console.error("Check saved failed:",t),t}},removePair:async(s,a)=>{try{const{data:t}=await Ae.delete(`${Xr}/pair/${s}/${a}`);return t}catch(t){throw console.error("Remove pair failed:",t),t}},removeById:async s=>{try{const{data:a}=await Ae.delete(`${Xr}/${s}`);return a}catch(a){throw console.error("Remove by ID failed:",a),a}},countByProperty:async s=>{try{const{data:a}=await Ae.get(`${Xr}/count/by-property/${s}`);return a}catch(a){throw console.error("Count by property failed:",a),a}},countByBuyer:async s=>{const{data:a}=await Ae.get(`${Xr}/count/by-buyer/${s}`);return a}},Nt={getAllMasterTypes:async s=>(await Ae.get(`/masters/get-all/${s}`)).data,createMasterType:async s=>(await Ae.post("/masters",s)).data,getMasterType:async s=>(await Ae.get(`/masters/type/${s}`)).data,updateMasterType:async(s,a)=>(await Ae.put(`/masters/type/update/${s}`,a)).data,deleteMasterType:async s=>(await Ae.delete(`/masters/type/${s}`)).data,exportMasterTypes:async s=>(await Ae.get(`/masters/export/${s}`,{responseType:"blob"})).data,importMasterTypes:async(s,a)=>{const t=new FormData;return t.append("file",a),(await Ae.post(`/masters/import/${s}`,t,{headers:{"Content-Type":"multipart/form-data"}})).data},getMasterValues:async s=>(await Ae.get(`masters/values/${s}`)).data,createMasterValue:async(s,a)=>{if(!s)throw new Error("masterTypeId is required");if(!(a!=null&&a.value))throw new Error("Value is required");const t={value:a.value,status:a.status||"Active"};return(await Ae.post(`/masters/values/${s}`,t)).data},updateMasterValue:async(s,a)=>(await Ae.put(`/masters/values/${s}`,a)).data,deleteMasterValue:async s=>(await Ae.delete(`/masters/values/${s}`)).data,exportMasterValues:async s=>(await Ae.get(`/masters/values/export/${s}`,{responseType:"blob"})).data,importMasterValues:async(s,a)=>{const t=new FormData;return t.append("file",a),(await Ae.post(`/masters/values/import/${s}`,t,{headers:{"Content-Type":"multipart/form-data"}})).data}},Gt=async(s=[])=>{try{const t=(await Promise.all(s.map(n=>Nt.getAllMasterTypes(n)))).flat(),r=await Promise.all(t.map(n=>Nt.getMasterValues(n.id))),i={};return t.forEach((n,o)=>{const m=r[o]||[];i[n.name.toLowerCase()]=m.map(g=>({value:g.value||g.name||"Unknown",label:g.value||g.name||"Unknown"}))}),i}catch(a){throw console.error("Error fetching master dropdown options",a),a}},Vt={getAll:async()=>(await Ae.get("/buyers/get-all-buyers")).data,getById:async s=>{if(!s)throw new Error("Buyer ID is required");return(await Ae.get(`/buyers/getBuyerById/${s}`)).data},create:async s=>{if(!(s!=null&&s.name))throw new Error("Buyer name is required");return(await Ae.post("/buyers/createBuyer",s)).data},update:async(s,a)=>{if(!s)throw new Error("Buyer ID is required");return(await Ae.put(`/buyers/updateBuyer/${s}`,a)).data},delete:async s=>{if(!s)throw new Error("Buyer ID is required");return(await Ae.delete(`/buyers/deleteBuyer/${s}`)).data},bulkDelete:async(s,a=!1)=>{if(!s||s.length===0)throw new Error("Buyer IDs are required");return(await Ae.post("/buyers/bulk-delete",{ids:s,hard:a})).data},importBuyers:async s=>{const a={buyers:s};try{return(await Ae.post("/buyers/bulk-import",a,{timeout:3e5,headers:{"Content-Type":"application/json"}})).data}catch(t){throw(t==null?void 0:t.code)==="ECONNABORTED"?new Error("Import timed out. Try again or reduce the batch size."):t}},assignExecutive:async(s,a)=>{if(!s)throw new Error("Buyer ID is required");return(await Ae.post(`/buyers/assign-executive/${s}`,{executive_id:a||null})).data},bulkAssignExecutive:async(s,a,t=!1)=>{if(!Array.isArray(s)||s.length===0)throw new Error("Buyer IDs array is required");return(await Ae.post("/buyers/bulk/assign-executive",{buyer_ids:s,executive_id:a||null,only_empty:t})).data},updateLeadField:async(s,a,t)=>(await Ae.post(`/buyers/updateLeadField/${s}`,{field:a,value:t})).data,bulkUpdateLeadField:async(s,a,t,r=!1)=>(await Ae.post("/buyers/bulkUpdateLeadField",{buyer_ids:s,field:a,value:t,only_empty:r})).data},rd=({property:s,onBack:a})=>{var Ze,ls,$s,Gs,Se,Ge;const[t,r]=l.useState(!1),[i,n]=l.useState(0),[o,m]=l.useState(!1),[g,b]=l.useState(!1),[d,v]=l.useState("ai-recommendations"),[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState([]),[P,w]=l.useState(!1),[$,y]=l.useState([]),[k,R]=l.useState(!1),[F,T]=l.useState({}),[j,E]=l.useState(!1),V=Ps.useRef({}),[W,B]=l.useState({salutation:"",name:"",phone:"",email:"",source:"website"}),[M,A]=l.useState(!1),[L,D]=l.useState(0),{slug:I}=on(),H=Ca(),[h,Y]=l.useState(null),[K,q]=l.useState(null),[ne,le]=l.useState(null),[S,C]=l.useState(0),[J,ue]=l.useState(80),[Q,he]=l.useState(8.5),[se,ge]=l.useState(20),{currentUser:ee,user:de}=Hs();l.useEffect(()=>{(async()=>{try{E(!0);const te=await Gt(["common"]);T(te||{})}catch(te){console.error("Error fetching master data:",te)}finally{E(!1)}})()},[]);const U=F.salutation||[{value:"Mr",label:"Mr"},{value:"Ms",label:"Ms"},{value:"Mrs",label:"Mrs"},{value:"Dr",label:"Dr"}],X=()=>{var te;const z=ee??de??{};return typeof(z==null?void 0:z.buyer_id)=="number"?z.buyer_id:typeof(z==null?void 0:z.buyerId)=="number"?z.buyerId:typeof((te=z==null?void 0:z.buyer)==null?void 0:te.id)=="number"?z.buyer.id:((z==null?void 0:z.role)==="buyer"||(z==null?void 0:z.type)==="buyer")&&typeof(z==null?void 0:z.id)=="number"?z.id:null},[re,fe]=l.useState(!1),G={stampDuty:.07,registration:.01,maxRegistration:3e4,legalFees:1e4},me=z=>{const te=(z==null?void 0:z.price)||0;z!=null&&z.square_feet;const ce=Math.round(te*G.stampDuty),Re=Math.min(Math.round(te*G.registration),G.maxRegistration),Te=G.legalFees,qe=ce+Re+Te,as=te+qe,xs=te>0?qe/te*100:0;return{basePrice:te,stampDuty:{amount:ce,rate:7},registration:{amount:Re,rate:1},legalFees:Te,additionalCharges:qe,totalCost:as,percentageOverBase:xs}},oe=(z,te,ce)=>{if(!z||z<=0||!te||te<=0||!ce||ce<=0)return{emi:0,totalPayment:0,totalInterest:0,principal:0,interestRate:te,tenureYears:ce};const Re=te/12/100,Te=ce*12,qe=z*Re*Math.pow(1+Re,Te)/(Math.pow(1+Re,Te)-1),as=qe*Te,xs=as-z;return{emi:Math.round(qe),totalPayment:Math.round(as),totalInterest:Math.round(xs),principal:z,interestRate:te,tenureYears:ce}};l.useEffect(()=>{if(h){const z=me(h);q(z);const te=Math.round((h.price||0)*(J/100));C(te);const ce=oe(te,Q,se);le(ce)}},[h,J,Q,se]);const Fe=z=>{ue(z);const te=Math.round(((h==null?void 0:h.price)||0)*(z/100));C(te);const ce=oe(te,Q,se);le(ce)},$e=z=>{he(z);const te=oe(S,z,se);le(te)},Le=z=>{ge(z);const te=oe(S,Q,z);le(te)},je=z=>{var te,ce;return((te=z==null?void 0:z.status)==null?void 0:te.toLowerCase().includes("ready"))||((ce=z==null?void 0:z.possession)==null?void 0:ce.toLowerCase().includes("ready"))},_e=async()=>{try{const z=X(),te=ke(h);if(!z||!te)return;const ce=await Hr.isSaved(z,te);ce!=null&&ce.success&&we(!!ce.saved)}catch(z){console.warn("checkSavedStatus failed",z)}};l.useEffect(()=>{h&&_e()},[h,ee]),l.useEffect(()=>{if(!h)return;const z=()=>_e();return window.addEventListener("focus",z),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&z()}),()=>{window.removeEventListener("focus",z),document.removeEventListener("visibilitychange",z)}},[h]);const ve=async z=>{if(z&&z.stopPropagation(),!h)return;const te=X();if(!te){m(!0);return}const ce=ke(h);if(!ce){Z.error("Property ID not found");return}try{fe(!0);const Re=await Hr.toggle(te,ce,"toggle");if(Re!=null&&Re.success){const Te=!!Re.saved;we(Te),Te?Z.success("Saved to your shortlist"):Z.info("Removed from your shortlist"),window.dispatchEvent(new CustomEvent("buyerSaved:changed",{detail:{propertyId:ce,saved:Te}}))}else Z.error("Could not update save status")}catch(Re){console.error("toggle failed:",Re),Z.error("Failed to update shortlist")}finally{fe(!1)}};l.useEffect(()=>{const z=te=>{var Re;const ce=ke(h);ce&&((Re=te==null?void 0:te.detail)==null?void 0:Re.propertyId)===ce&&we(!!te.detail.saved)};return window.addEventListener("buyerSaved:changed",z),()=>window.removeEventListener("buyerSaved:changed",z)},[h]),l.useEffect(()=>{(async()=>{if(h){R(!0);try{const te={propertyId:h.id,type:h.type,propertyType:h.type,subtype:h.subtype,unitType:h.unitType,city:h.city,location:h.locationNormalized,bedrooms:h.bedrooms,furnishing:h.furnishing,price:h.price,limit:6,excludeCurrent:!0},ce=await As.getSimilarProperties(te),Re=(ce==null?void 0:ce.data)||[],Te=await Promise.all(Re.map(async qe=>{var as,xs;try{const ps=(qe==null?void 0:qe.slug)??((as=qe==null?void 0:qe.raw)==null?void 0:as.slug)??null,ys=(qe==null?void 0:qe.id)??((xs=qe==null?void 0:qe.raw)==null?void 0:xs.id)??null;let He=null;if(ps&&As.PublicgetPropertyBySlug){const vs=await As.PublicgetPropertyBySlug(ps);He=(vs==null?void 0:vs.data)??vs??null}else if(ys&&As.getProperty){const vs=await As.getProperty(ys);He=(vs==null?void 0:vs.data)??vs??null}return ye(He||qe)}catch{return ye(qe)}}));y(Te)}catch(te){console.error("âŒ Error fetching similar:",te),y([])}finally{R(!1)}}})()},[h]);const Pe=z=>{const te=ke(z);return te?`REX${String(te).padStart(4,"0")}`:"REXâ€”"},We=z=>z==null||typeof z=="string"&&z.trim()===""||typeof z=="number"&&!Number.isFinite(z)?" - ":z,pe=z=>{const te=Number(z);if(!Number.isFinite(te)||te<=0)return" - ";const ce=1e7,Re=1e5;if(te>=ce){const Te=te/ce;return`â‚¹${parseFloat(Te.toFixed(2))}Cr`}if(te>=Re){const Te=te/Re;return`â‚¹${parseFloat(Te.toFixed(0))}L`}return`â‚¹${te.toLocaleString("en-IN")}`},O=()=>{var ce;return(((ce=h==null?void 0:h.executiveTo)==null?void 0:ce.phone)||""||"").replace(/\D/g,"")||"+91999999999"},Ie=z=>{z&&z.stopPropagation();const te=O();typeof window<"u"&&(window.location.href=`tel:${te}`)},ze=z=>Array.isArray(z==null?void 0:z.amenities)&&z.amenities.length?z.amenities.map(String):Array.isArray(z==null?void 0:z.features)&&z.features.length?z.features.map(String):typeof(z==null?void 0:z.amenities)=="string"&&z.amenities.trim()?z.amenities.split(",").map(te=>te.trim()).filter(Boolean):Array.isArray(z==null?void 0:z.amenityList)&&z.amenityList.length?z.amenityList.map(String):[],xe=z=>/^\d{5,6}$/.test((z||"").replace(/\s+/g,"")),Ee=z=>{if(!z&&z!=="")return{};if(typeof z=="object"){const te=(z.locality??z.location_name??z.neighborhood??z.subLocality??z.area??"").toString().trim(),ce=(z.city??z.city_name??z.town??z.district??z.region??z.state??"").toString().trim(),Re=te&&ce?`${te}, ${ce}`:te||ce||void 0;return{locality:te||void 0,city:ce||void 0,label:Re}}if(typeof z=="string"){const te=z.replace(/\r?\n/g,",").replace(/[-|\/]+/g,",").replace(/\s+/g," ").trim();if(!te)return{};const ce=te.split(",").map(xs=>xs.trim()).filter(Boolean),Re=ce[ce.length-1],Te=xe(Re)?ce.slice(0,-1):ce;if(Te.length===1)return{city:Te[0],label:Te[0]};const qe=Te[Te.length-1],as=Te[Te.length-2];return{locality:as,city:qe,label:as&&qe?`${as}, ${qe}`:qe||as}}return{}},Ke=({tags:z})=>!z||z.length===0?null:e.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 mb-3",children:z.map((te,ce)=>{const Re=Ea(te);return e.jsxs("span",{className:`
              inline-flex items-center mt-0.5 px-2 sm:px-2.5 py-1 rounded-full 
              text-[8px] xs:text-[10px] sm:text-xs font-bold uppercase 
              transition-all duration-200 min-h-[24px] sm:min-h-[26px]
              ${Re.bg} ${Re.text} ring-1 ${Re.ring}
              hover:scale-105 transform transition-transform
            `,children:[Re.emoji&&e.jsx(e.Fragment,{children:typeof Re.emoji=="string"?e.jsx("span",{className:"text-[8px] xs:text-[10px] sm:text-xs mr-1 uppercase flex-shrink-0","aria-hidden":"true",children:Re.emoji}):Ps.createElement(Re.emoji,{size:"clamp(8px, 2vw, 12px)",className:"mr-1 uppercase flex-shrink-0","aria-hidden":!0})}),e.jsx("span",{className:"whitespace-nowrap truncate max-w-[80px] xs:max-w-[100px] sm:max-w-[120px] md:max-w-none",children:te})]},ce)})}),Xe=async z=>{if(z)try{w(!0);const te=await Qt.getById(z);N(te.tags||[])}catch(te){console.error("Error fetching property tags:",te),N([])}finally{w(!1)}},ye=z=>{var Fs,ht,vt,De,is,Qe;if(!z)return null;const te=Number((z==null?void 0:z.budget)??(z==null?void 0:z.price)??(z==null?void 0:z.amount)??(z==null?void 0:z.listing_price)??(z==null?void 0:z.listingPrice)),Re=[z==null?void 0:z.carpet_area,z==null?void 0:z.builtup_area,z==null?void 0:z.area,z==null?void 0:z.super_builtup_area,z==null?void 0:z.sqft,z==null?void 0:z.square_feet,z==null?void 0:z.size].reduce((ds,os)=>{if(ds!==void 0||os==null)return ds;const zs=Number(os);return Number.isFinite(zs)&&zs>0?zs:ds},void 0),Te=Array.isArray(z==null?void 0:z.images)?z.images:Array.isArray(z==null?void 0:z.photos)?z.photos:Array.isArray(z==null?void 0:z.photoUrls)?z.photoUrls:Array.isArray(z==null?void 0:z.media)?z.media.map(ds=>(ds==null?void 0:ds.url)??ds):[],qe=(z==null?void 0:z.location)??(z==null?void 0:z.address)??(z==null?void 0:z.place)??(z==null?void 0:z.locality)??(z==null?void 0:z.address_line)??(z==null?void 0:z.addr)??z,as=(z==null?void 0:z.created_at)??(z==null?void 0:z.publication_date)??(z==null?void 0:z.createdAt)??(z==null?void 0:z.created_at_at)??(z==null?void 0:z.created_at_date)??(z==null?void 0:z.created_at_timestamp)??(z==null?void 0:z.published_at)??null,ps=(ds=>{if(!ds&&ds!==0)return null;if(ds instanceof Date&&!isNaN(ds.getTime()))return ds;if(typeof ds=="number"&&Number.isFinite(ds))return ds<1e12?new Date(ds*1e3):new Date(ds);if(typeof ds=="string"){const os=ds.trim(),zs=new Date(os);if(!isNaN(zs.getTime()))return zs;const Us=Number(os.replace(/[^\d]/g,""));if(!isNaN(Us)&&Us>0)return Us<1e12?new Date(Us*1e3):new Date(Us)}return null})(as),He=(ds=>{if(!ds)return;const zs=Date.now()-ds.getTime();if(Number.isFinite(zs))return zs<0?0:Math.floor(zs/(1e3*60*60*24))})(ps),vs=typeof qe=="object"?qe:{locality:z==null?void 0:z.locality,location_name:z==null?void 0:z.location_name,city:z==null?void 0:z.city,city_name:z==null?void 0:z.city_name,address:z==null?void 0:z.address},{locality:_s,city:et,label:ts}=Ee(vs);return{raw:z,id:(z==null?void 0:z.id)??(z==null?void 0:z.property_id)??(z==null?void 0:z.uuid)??(z==null?void 0:z.slug)??null,title:(z==null?void 0:z.title)??(z==null?void 0:z.name)??(z==null?void 0:z.headline)??"",type:(z==null?void 0:z.type)??(z==null?void 0:z.property_type)??(z==null?void 0:z.property_type_name)??"",unitType:(z==null?void 0:z.unitType)??(z==null?void 0:z.unit_type)??(z==null?void 0:z.unit)??"",subtype:(z==null?void 0:z.subtype)??(z==null?void 0:z.property_subtype_name)??(z==null?void 0:z.property_subtype)??"",location:qe,locationNormalized:ts,city:(z==null?void 0:z.city_name)??(z==null?void 0:z.city)??et,locality:(z==null?void 0:z.locality)??(z==null?void 0:z.location_name)??_s,price:Number.isFinite(te)?te:void 0,square_feet:Re,area:Re,bedrooms:Number((z==null?void 0:z.bedrooms)??(z==null?void 0:z.beds)??(z==null?void 0:z.bhk)??0)||void 0,bathrooms:Number((z==null?void 0:z.bathrooms)??(z==null?void 0:z.baths)??(z==null?void 0:z.washrooms)??0)||void 0,parking:Number((z==null?void 0:z.parking)??(z==null?void 0:z.parking_spots)??(z==null?void 0:z.car_parking)??0)||void 0,amenities:ze(z),images:Te.length?Te:void 0,photos:Te.length?Te:void 0,description:(z==null?void 0:z.description)??(z==null?void 0:z.desc)??(z==null?void 0:z.about)??"",verified:!!((z==null?void 0:z.verified)??(z==null?void 0:z.is_verified)??(z==null?void 0:z.isVerified)),featured:!!((z==null?void 0:z.featured)??(z==null?void 0:z.is_featured)??(z==null?void 0:z.isFeatured)),badge:z!=null&&z.featured||z!=null&&z.is_featured||z!=null&&z.isFeatured?"Premium":(z==null?void 0:z.badge)??"Standard",views:Number((z==null?void 0:z.views)??(z==null?void 0:z.view_count)??(z==null?void 0:z.totalViews))||void 0,listedDays:(()=>{const ds=(z==null?void 0:z.listedDays)??(z==null?void 0:z.listed_days)??(z==null?void 0:z.days_listed),os=Number(ds);return Number.isFinite(os)&&os>=0?Math.floor(os):He})(),possession:(z==null?void 0:z.possession)??(z==null?void 0:z.possession_status)??(z==null?void 0:z.possessionStatus)??"",furnishing:(z==null?void 0:z.furnishing)??(z==null?void 0:z.furnishing_status)??"",builtYear:(z==null?void 0:z.builtYear)??(z==null?void 0:z.year_built)??(z==null?void 0:z.construction_year)??"",facing:(z==null?void 0:z.facing)??(z==null?void 0:z.direction)??"",executiveTo:{name:((Fs=z==null?void 0:z.assignedTo)==null?void 0:Fs.name)||((ht=z==null?void 0:z.executiveTo)==null?void 0:ht.name)||"Executive Not Assigned",phone:((vt=z==null?void 0:z.assignedTo)==null?void 0:vt.phone)||((De=z==null?void 0:z.executiveTo)==null?void 0:De.phone)||"",email:((is=z==null?void 0:z.assignedTo)==null?void 0:is.email)||((Qe=z==null?void 0:z.executiveTo)==null?void 0:Qe.email)||""},aiScore:(z==null?void 0:z.aiScore)??(z==null?void 0:z.score),priceGrowth:z==null?void 0:z.priceGrowth,investmentGrade:z==null?void 0:z.investmentGrade,property_status:(z==null?void 0:z.property_status)||(z==null?void 0:z.status),possessionMonth:(z==null?void 0:z.possession_month)??(z==null?void 0:z.possessionMonth)??null,possessionYear:(z==null?void 0:z.possession_year)??(z==null?void 0:z.possessionYear)??null,created_at:as??null,parkingType:(z==null?void 0:z.parkingType)??(z==null?void 0:z.parking_type)??"",parkingQty:(z==null?void 0:z.parkingQty)??(z==null?void 0:z.parking_qty)??(z==null?void 0:z.parking_spots)??"",floor:(z==null?void 0:z.floor)??"",totalFloors:(z==null?void 0:z.totalFloors)??(z==null?void 0:z.total_floors)??"",status:(z==null?void 0:z.status)??(z==null?void 0:z.property_status)??"",finalPrice:(z==null?void 0:z.finalPrice)??(z==null?void 0:z.final_price)??null,priceType:(z==null?void 0:z.priceType)??(z==null?void 0:z.price_type)??"Fixed",wing:(z==null?void 0:z.wing)??"",unitNo:(z==null?void 0:z.unitNo)??(z==null?void 0:z.unit_no)??"",society:(z==null?void 0:z.society)??"",address:(z==null?void 0:z.address)??"",selling_rights:(z==null?void 0:z.selling_rights)??(z==null?void 0:z.sellingRights)??"",leadSource:(z==null?void 0:z.leadSource)??(z==null?void 0:z.lead_source)??"",purchaseMonth:(z==null?void 0:z.purchaseMonth)??(z==null?void 0:z.purchase_month)??null,purchaseYear:(z==null?void 0:z.purchaseYear)??(z==null?void 0:z.purchase_year)??null,furnishingItems:Array.isArray(z==null?void 0:z.furnishingItems)?z.furnishingItems:Array.isArray(z==null?void 0:z.furnishing_items)?z.furnishing_items:[],nearby_places:Array.isArray(z==null?void 0:z.nearby_places)?z.nearby_places:Array.isArray(z==null?void 0:z.nearbyPlaces)?z.nearbyPlaces:Array.isArray(z==null?void 0:z.nearby)?z.nearby:[],balcony:(z==null?void 0:z.balcony)??(z==null?void 0:z.balconies)??(z==null?void 0:z.balcony_count)??""}};l.useEffect(()=>{if(s){const z=ye(s);Y(z)}},[s]);const[Ce,_]=l.useState(()=>!s);l.useEffect(()=>{!s&&I&&(async()=>{if(I)try{_(!0);const te=await As.PublicgetPropertyBySlug(I),ce=(te==null?void 0:te.data)??te??null,Re=ye(ce);Y(Re)}catch(te){console.error("Error fetching property:",te),Y(null)}finally{_(!1)}})()},[I,s]),l.useEffect(()=>{if(h){const z=ke(h);z&&Xe(z)}},[h]);const ae=()=>{if(typeof a=="function")try{a();return}catch(z){console.error("onBack threw:",z)}try{H("/properties")}catch{typeof window<"u"&&(window.location.href="/properties")}},ke=z=>{var qe,as;if(!z)return null;const te=z.raw??{},ce=[te.id,te.property_id,te.id_number,z.id];for(const xs of ce){if(xs==null)continue;const ps=Number(String(xs).replace(/[^0-9]/g,""));if(Number.isFinite(ps)&&ps>0)return ps}const Te=String(z.id||((qe=z.raw)==null?void 0:qe.slug)||((as=z.raw)==null?void 0:as.id)||"").match(/^(\d+)(?:-|$)/);return Te?Number(Te[1]):null},Me=async(z,te)=>{var ps;if(!z)return;const ce=te==null?void 0:te.windowMinutes,Re=ke(z),Te=((ps=z==null?void 0:z.raw)==null?void 0:ps.slug)??(z==null?void 0:z.id)??null,qe=`viewed_property_${Re??Te??String(Math.random()).slice(2)}`,as=String(Re??Te??"unknown");if(V.current[as]){try{if(Re){const ys=await cr.getByProperty(Re,!1);ys!=null&&ys.success&&(ys==null?void 0:ys.total_views)!==void 0&&Y(He=>!He||He.views===ys.total_views?He:{...He,views:ys.total_views})}else if(Te){const ys=await As.PublicgetPropertyBySlug(Te),He=(ys==null?void 0:ys.data)??ys??null,vs=ye(He);(vs==null?void 0:vs.views)!==void 0&&Y(_s=>!_s||_s.views===vs.views?_s:{..._s,views:vs.views})}}catch{}return}try{const ys=localStorage.getItem(qe);if(ys){const He=Number(ys);if(!Number.isNaN(He)&&Date.now()-He<ce*60*1e3){V.current[as]=!0;try{if(Re){const _s=await cr.getByProperty(Re,!1);_s!=null&&_s.success&&(_s==null?void 0:_s.total_views)!==void 0&&Y(et=>!et||et.views===_s.total_views?et:{...et,views:_s.total_views})}}catch{}return}}}catch(ys){console.warn("localStorage unavailable for view dedupe:",ys)}const xs={source:"client",path:typeof window<"u"?window.location.pathname:null,referrer:typeof document<"u"?document.referrer:null,slug:Te??null};try{await cr.recordView(Re,xs);try{localStorage.setItem(qe,String(Date.now()))}catch{}V.current[as]=!0}catch(ys){console.warn("viewsAPI.recordView failed:",ys)}try{if(Re){const ys=await cr.getByProperty(Re,!1);if(ys!=null&&ys.success&&(ys==null?void 0:ys.total_views)!==void 0){Y(He=>!He||He.views===ys.total_views?He:{...He,views:ys.total_views});return}}if(Te){const ys=await As.PublicgetPropertyBySlug(Te),He=(ys==null?void 0:ys.data)??ys??null,vs=ye(He);(vs==null?void 0:vs.views)!==void 0&&Y(_s=>!_s||_s.views===vs.views?_s:{..._s,views:vs.views})}}catch{}},Ye=z=>{var Re;const te=ke(z),ce=((Re=z==null?void 0:z.raw)==null?void 0:Re.slug)??(z==null?void 0:z.id)??"unknown";return`liked_property_${te??ce}`},[ie,we]=l.useState(!1);l.useEffect(()=>{if(h)try{const z=localStorage.getItem(Ye(h));we(z==="1")}catch{}},[h]);const Be=z=>{if(!z)return"";const te=typeof z=="string"?parseInt(z):z;return isNaN(te)||te<1||te>12?"":new Date(0,te-1).toLocaleString("en",{month:"long"})};if(l.useEffect(()=>{if(!h)return;const z=String(ke(h)??(h==null?void 0:h.id)??"unknown");if(!V.current[z])return(async()=>{try{await Me(h,{windowMinutes:10})}catch(te){console.warn("recordView failed:",te)}finally{}})(),()=>{}},[h]),Ce)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"animate-pulse text-gray-400",children:"Loading property..."})})});if(!h)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(yt,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Property Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The property you're looking for doesn't exist."}),e.jsx("button",{onClick:ae,className:"bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-6 py-3 rounded-lg font-semibold shadow-md transition-colors duration-300",children:"Back to Properties"})]})});const Ve=Array.isArray(h==null?void 0:h.images)&&h.images.length?h.images:Array.isArray(h==null?void 0:h.photos)&&h.photos.length?h.photos:["https://images.pexels.com/photos/106399/pexels-photo-106399.jpeg","https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg","https://images.pexels.com/photos/1643383/pexels-photo-1643383.jpeg"],Je=(h==null?void 0:h.unitType)??"",Ue=(h==null?void 0:h.subtype)??"",Oe=async z=>{var te,ce,Re,Te;z.preventDefault();try{const qe={salutation:W.salutation,name:W.name.trim(),phone:W.phone.replace(/\D/g,""),email:((te=W.email)==null?void 0:te.trim())||void 0,source:"Website",property_interested:h!=null&&h.id?String(h.id):void 0,property_slug:(h==null?void 0:h.slug)||((ce=h==null?void 0:h.raw)==null?void 0:ce.slug),status:"new_lead",lead_type:"property_inquiry"},as=await Vt.create(qe),xs=(as==null?void 0:as.data)??as,ps=(xs==null?void 0:xs.data)??xs;!!(ps!=null&&ps.id)?(console.log("âœ… Buyer created:",ps),Z.success("We'll contact you shortly!"),m(!1),B({salutation:"Mr",name:"",phone:"",email:"",source:"website"})):(console.error("âŒ Unexpected create response:",xs),Z.error("Failed to submit request. Please try again."))}catch(qe){console.error("ðŸ”¥ Error creating buyer:",qe),Z.error(((Te=(Re=qe==null?void 0:qe.response)==null?void 0:Re.data)==null?void 0:Te.message)||(qe==null?void 0:qe.message)||"Something went wrong. Please try again.")}},rs=z=>{if(!c){v(z),b(!0);return}v(z),b(!0)},ms=z=>{u(!0),b(!1)},cs=Number.isFinite(h==null?void 0:h.price)?h.price:void 0,gs=Number.isFinite(h==null?void 0:h.square_feet)?h.square_feet:void 0,Ne=cs&&gs?Math.round(cs/gs):void 0;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:" bg-white shadow-sm border-b pt-20 sticky top-0 z-40 mb-1",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between ",children:e.jsxs("button",{onClick:ae,className:"flex items-center text-white hover:text-[#CC6A1A] transition-colors text-sm font-medium",children:[e.jsx(ga,{size:18,className:"mr-1"}),"Back to Properties"]})})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 pb-28 md:pb-6 pt-0 bg-gradient-to-b from-white via-slate-50 to-white",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4 sm:space-y-5 lg:space-y-6",children:[e.jsxs("div",{className:"relative w-full h-64 sm:h-80 md:h-[420px] lg:h-[520px] bg-gray-900 overflow-hidden rounded-lg sm:rounded-xl md:rounded-2xl shadow-xl ring-1 ring-black/10 group",children:[e.jsx("img",{src:Ve[i],alt:(h==null?void 0:h.title)||"Property Image",className:"w-full h-full object-cover transform transition-transform duration-500 group-hover:scale-[1.02]"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/25 to-transparent"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none select-none z-10",children:e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"text-white font-bold text-2xl sm:text-3xl md:text-4xl lg:text-5xl whitespace-nowrap drop-shadow-2xl",children:"ResaleExpert.in"})})}),e.jsxs("div",{className:"absolute top-2 sm:top-3 md:top-6 left-2 sm:left-3 md:left-4 z-20 text-white max-w-[75%] sm:max-w-[85%] flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"font-bold text-base sm:text-lg md:text-xl truncate drop-shadow",children:[(h==null?void 0:h.type)&&e.jsx("span",{className:"mr-1 sm:mr-2",children:h.type}),Je&&e.jsx("span",{className:"mr-1 sm:mr-2",children:Je}),Ue&&e.jsx("span",{className:"mr-1 sm:mr-2",children:Ue})]}),e.jsx("span",{className:"text-white ",children:Pe(h)})]}),e.jsxs("div",{className:"flex items-center text-xs sm:text-sm md:text-base drop-shadow",children:[e.jsx(Qs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 shrink-0"}),e.jsx("span",{className:"truncate",children:We(h==null?void 0:h.locationNormalized)})]})]}),e.jsx("div",{className:"flex items-center gap-1.5 sm:gap-2 mt-0.5 sm:mt-1 ",children:e.jsx("div",{className:"absolute top-0 right-3 z-20 hidden sm:block ",children:e.jsx(Ke,{tags:p})})}),e.jsxs("div",{className:"absolute top-2 sm:top-3 md:top-8 right-2 sm:right-3 md:right-4 z-20 flex flex-col space-y-1.5 sm:space-y-2",children:[e.jsx("button",{onClick:()=>r(!0),className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 flex items-center justify-center rounded-full bg-white/95 backdrop-blur-md shadow-lg ring-1 ring-black/10 hover:bg-white hover:scale-110 hover:shadow-xl transition-all duration-200","aria-label":"Share property",children:e.jsx(Wt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-700"})}),e.jsx("button",{onClick:ve,disabled:re,className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 flex items-center justify-center rounded-full bg-white/95 backdrop-blur-md shadow-lg ring-1 ring-black/10 hover:bg-white hover:scale-110 hover:shadow-xl transition-all duration-200","aria-label":"Save property",title:ie?"Unsave":"Save",children:e.jsx(kl,{className:`w-4 h-4 sm:w-5 sm:h-5 ${ie?"text-[#E6761D] fill-[#E6761D]":"text-gray-700"}`})})]}),e.jsx("div",{className:"absolute bottom-8 sm:bottom-10 md:bottom-12 left-2 sm:left-3 md:left-4 z-20 w-[90%]",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 md:gap-5 items-start sm:items-center",children:[e.jsxs("div",{className:"flex flex-col text-left",children:[e.jsx("div",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-white leading-tight",children:pe(h==null?void 0:h.price)}),e.jsx("div",{className:"text-xs sm:text-sm md:text-base text-white mt-0.5 sm:mt-1",children:Ne?`â‚¹${Ne.toLocaleString("en-IN")}/sq ft`:" - "})]}),e.jsxs("div",{className:"flex flex-col items-left",children:[e.jsx("span",{className:"text-sm sm:text-base md:text-lg font-semibold text-white",children:"Carpet Area"}),e.jsxs("span",{className:"text-xs sm:text-sm md:text-base text-white",children:[We(h==null?void 0:h.square_feet)," sq ft"]})]})]})}),Ve.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>n(z=>(z-1+Ve.length)%Ve.length),className:`absolute left-2 sm:left-3 md:left-4 top-1/2 -translate-y-1/2\r
                    bg-white/20 hover:bg-white/40 backdrop-blur-md text-white p-2 sm:p-2.5 md:p-3 rounded-full z-20 \r
                    transition-all duration-200 shadow-xl ring-1 ring-white/30 hover:scale-110`,children:e.jsx(Wa,{size:12,className:"sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>n(z=>(z+1)%Ve.length),className:`absolute right-2 sm:right-3 md:right-4 top-1/2 -translate-y-1/2\r
                    bg-white/20 hover:bg-white/40 backdrop-blur-md text-white p-2 sm:p-2.5 md:p-3 rounded-full z-20 \r
                    transition-all duration-200 shadow-xl ring-1 ring-white/30 hover:scale-110`,children:e.jsx(pa,{size:12,className:"sm:w-4 sm:h-4"})})]}),e.jsxs("div",{className:"absolute bottom-3 sm:bottom-4 right-2 sm:right-3 md:right-4 z-20 bg-gradient-to-r from-slate-900/70 to-black/60 backdrop-blur-md text-white px-2 sm:px-3 py-1 rounded-full text-[10px] sm:text-xs shadow-lg ring-1 ring-white/20",children:[i+1," / ",Ve.length]}),Ve.length>1&&Ve.length<=8&&e.jsx("div",{className:"absolute bottom-16 sm:bottom-20 left-1/2 -translate-x-1/2 z-20 flex space-x-1.5 sm:space-x-2",children:Ve.map((z,te)=>e.jsx("button",{onClick:()=>n(te),className:`w-1.5 h-1.5 sm:w-2 sm:h-2 md:w-2.5 md:h-2.5 rounded-full transition-all duration-300 ${te===i?"bg-white w-6 sm:w-8 shadow-lg":"bg-white/50 hover:bg-white/75"}`},te))}),e.jsxs("div",{className:"absolute bottom-14 sm:bottom-16 right-2 sm:right-3 md:right-4 z-20 flex space-x-1.5 sm:space-x-2",children:[e.jsxs("button",{onClick:()=>{D(i),A(!0)},className:"bg-white/95 backdrop-blur-md text-gray-900 px-2 sm:px-2.5 md:px-3 py-1 sm:py-1.5 rounded-lg sm:rounded-xl flex items-center gap-1 hover:bg-white hover:scale-105 transition-all duration-200 text-[10px] sm:text-xs font-semibold shadow-xl border border-white/60",children:[e.jsx(Sa,{size:12,className:"sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden xs:inline",children:"Photos"})]}),M&&e.jsx(Ep,{images:Ve,isOpen:M,onClose:()=>A(!1),initialIndex:L}),e.jsxs("button",{className:"bg-white/95 backdrop-blur-md text-gray-900 px-2 sm:px-2.5 md:px-3 py-1 sm:py-1.5 rounded-lg sm:rounded-xl flex items-center gap-1 hover:bg-white hover:scale-105 transition-all duration-200 text-[10px] sm:text-xs font-semibold shadow-xl border border-white/60",children:[e.jsx(En,{size:12,className:"sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden xs:inline",children:"Tour"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm p-3 sm:p-4 md:p-5 !mt-3 sm:!mt-4 ring-1 ring-gray-100",children:[e.jsx("div",{className:"  block sm:hidden",children:e.jsx(Ke,{tags:p})}),e.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm p-3 sm:p-4 mb-3 sm:mb-4",children:e.jsx(Vp,{description:h==null?void 0:h.description,property:h})}),e.jsxs("div",{className:"bg-white/95 backdrop-blur rounded-xl sm:rounded-2xl border border-gray-200 shadow-sm hover:shadow-md transition-all ring-1 ring-gray-100",children:[e.jsx("div",{className:"px-3 sm:px-4 md:px-5 pt-3 sm:pt-4",children:e.jsx("h3",{className:"font-bold text-gray-900 text-sm sm:text-base mb-3 sm:mb-4",children:"Property Details"})}),e.jsx("div",{className:"px-3 sm:px-4 md:px-5 pb-3 sm:pb-4 md:pb-5",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 text-xs sm:text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Property type:"}),e.jsx("span",{className:"text-gray-600 ml-1 break-words",children:We(h==null?void 0:h.type)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Unit Type:"}),e.jsx("span",{className:"text-gray-600 ml-1 break-words",children:We(h==null?void 0:h.unitType)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Subtype:"}),e.jsx("span",{className:"text-gray-600 ml-1 break-words",children:We(h==null?void 0:h.subtype)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Parking Type:"}),e.jsx("span",{className:"text-gray-600 ml-1 break-words",children:We(h==null?void 0:h.parkingType)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Floor:"}),e.jsx("span",{className:"text-gray-600 ml-1 break-words",children:h!=null&&h.floor&&(h!=null&&h.totalFloors)?`${h.floor} / ${h.totalFloors}`:We(h==null?void 0:h.floor)})]}),(h==null?void 0:h.square_feet)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Carpet Area:"}),e.jsxs("span",{className:"text-gray-600 ml-1",children:[We(h.square_feet)," Sq.ft."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Status:"}),e.jsx("span",{className:"text-gray-600 ml-1 break-words",children:We(h==null?void 0:h.status)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Price:"}),e.jsxs("span",{className:"text-gray-600 ml-1",children:[pe(h==null?void 0:h.price),"(",We(h==null?void 0:h.priceType),")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Furnishing:"}),e.jsx("span",{className:"text-gray-600 ml-1 break-words",children:We(h==null?void 0:h.furnishing)})]}),((h==null?void 0:h.possessionMonth)||(h==null?void 0:h.possessionYear))&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Property Age:"}),e.jsx("span",{className:"text-gray-600 ml-1",children:[Be(h==null?void 0:h.possessionMonth),h==null?void 0:h.possessionYear].filter(Boolean).join(" ")})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-3 sm:gap-4 mt-3 sm:mt-4",children:[e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 p-3 sm:p-4 ring-1 ring-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm sm:text-base mb-2 sm:mb-3",children:"Amenities"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-2 2xl:grid-cols-3 gap-2",children:(()=>{var te,ce;let z=[];return Array.isArray(h==null?void 0:h.amenities)&&h.amenities.length>0?z=h.amenities:Array.isArray((te=h==null?void 0:h.raw)==null?void 0:te.amenities)&&h.raw.amenities.length>0?z=h.raw.amenities:typeof(h==null?void 0:h.amenities)=="string"&&h.amenities.trim()?z=h.amenities.split(",").map(Re=>Re.trim()).filter(Boolean):typeof((ce=h==null?void 0:h.raw)==null?void 0:ce.amenities)=="string"&&h.raw.amenities.trim()&&(z=h.raw.amenities.split(",").map(Re=>Re.trim()).filter(Boolean)),z.length>0?z.map((Re,Te)=>e.jsx(zu,{name:Re},Te)):e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 col-span-full",children:"No amenities listed"})})()})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 p-3 sm:p-4 ring-1 ring-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm sm:text-base mb-2 sm:mb-3",children:"Furnishing Items"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-2 2xl:grid-cols-3 gap-2",children:(()=>{var te,ce;let z=[];return Array.isArray(h==null?void 0:h.furnishingItems)&&h.furnishingItems.length>0?z=h.furnishingItems:Array.isArray((te=h==null?void 0:h.raw)==null?void 0:te.furnishingItems)&&h.raw.furnishingItems.length>0?z=h.raw.furnishingItems:Array.isArray((ce=h==null?void 0:h.raw)==null?void 0:ce.furnishing_items)&&h.raw.furnishing_items.length>0&&(z=h.raw.furnishing_items),z.length>0?z.map((Re,Te)=>e.jsx(Ru,{name:Re},Te)):e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 col-span-full",children:"No furnishing items listed"})})()})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg sm:rounded-xl p-3 sm:p-4 mb-4 sm:mb-6 md:mb-8 mt-3 sm:mt-4 border border-purple-100 ring-1 ring-purple-100/70",children:e.jsx("div",{className:"flex items-center space-x-2 sm:space-x-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-1.5 mb-2 sm:mb-3 md:mb-4",children:[e.jsx(Mt,{className:"text-purple-600",size:16}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm sm:text-base mb-0.5 sm:mb-1",children:"AI Property Analysis"})]}),x||!c?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 text-xs sm:text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"AI Score: "}),e.jsxs("span",{className:"font-bold text-purple-600",children:[We((h==null?void 0:h.aiScore)??"94"),"/100"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Growth: "}),e.jsx("span",{className:"font-bold text-green-600",children:We((h==null?void 0:h.priceGrowth)??"+12.5%")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Investment: "}),e.jsx("span",{className:"font-bold text-blue-600",children:We((h==null?void 0:h.investmentGrade)??"A+")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ROI Potential: "}),e.jsx("span",{className:"font-bold text-orange-600",children:"18.2%"})]})]}):e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 text-xs sm:text-sm blur-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"AI Score: "}),e.jsx("span",{className:"font-bold text-purple-600",children:"â€¢â€¢/100"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Growth: "}),e.jsx("span",{className:"font-bold text-green-600",children:"+â€¢â€¢.â€¢%"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Investment: "}),e.jsx("span",{className:"font-bold text-blue-600",children:"â€¢â€¢"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ROI Potential: "}),e.jsx("span",{className:"font-bold text-orange-600",children:"â€¢â€¢.â€¢%"})]})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("button",{onClick:()=>rs("ai-investment"),className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold shadow-lg hover:shadow-xl transition-all flex items-center space-x-1.5 sm:space-x-2",children:[e.jsx(Gr,{size:14,className:"sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Unlock AI Analysis - â‚¹299"}),e.jsx("span",{className:"xs:hidden",children:"Unlock â‚¹299"})]})})]})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm p-3 sm:p-4 md:p-5 relative ring-1 ring-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-1.5 sm:space-x-2 mb-2 sm:mb-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-lg p-1",children:e.jsx(er,{className:"text-blue-600",size:16})}),e.jsx("h2",{className:"font-bold text-gray-900 text-sm sm:text-base",children:"AI Recommendations"})]}),x?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-2.5 sm:p-3 border border-green-100",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-1.5 mb-1 sm:mb-1.5",children:[e.jsx(Rs,{className:"text-green-600"}),e.jsx("span",{className:"font-semibold text-green-800 text-xs sm:text-sm",children:"Price Appreciation"})]}),e.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600 leading-tight",children:"+15.2%"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-green-700 mt-0.5",children:"Expected in next 12 months"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-2.5 sm:p-3 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-1.5 mb-1 sm:mb-1.5",children:[e.jsx(Oi,{className:"text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-800 text-xs sm:text-sm",children:"Market Position"})]}),e.jsx("div",{className:"text-lg sm:text-xl font-bold text-blue-600 leading-tight",children:"Top 10%"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-blue-700 mt-0.5",children:"In this locality"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-2.5 sm:p-3 border border-orange-100",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-1.5 mb-1 sm:mb-1.5",children:[e.jsx(ct,{className:"text-orange-600"}),e.jsx("span",{className:"font-semibold text-orange-800 text-xs sm:text-sm",children:"Investment Timing"})]}),e.jsx("div",{className:"text-lg sm:text-xl font-bold text-orange-600 leading-tight",children:"Excellent"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-orange-700 mt-0.5",children:"Buy now recommended"})]})]}):e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 sm:gap-3 blur-md pointer-events-none select-none",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-2.5 sm:p-3 border border-green-100",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-1.5 mb-1 sm:mb-1.5",children:[e.jsx(Rs,{className:"text-green-600",size:14}),e.jsx("span",{className:"font-semibold text-green-800 text-xs sm:text-sm",children:"Price Appreciation"})]}),e.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600 leading-tight",children:"+â€¢â€¢.â€¢%"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-green-700 mt-0.5",children:"Expected in next 12 months"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-2.5 sm:p-3 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-1.5 mb-1 sm:mb-1.5",children:[e.jsx(Oi,{className:"text-blue-600",size:14}),e.jsx("span",{className:"font-semibold text-blue-800 text-xs sm:text-sm",children:"Market Position"})]}),e.jsx("div",{className:"text-lg sm:text-xl font-bold text-blue-600 leading-tight",children:"Top â€¢â€¢%"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-blue-700 mt-0.5",children:"In this locality"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-2.5 sm:p-3 border border-orange-100",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-1.5 mb-1 sm:mb-1.5",children:[e.jsx(ct,{className:"text-orange-600",size:14}),e.jsx("span",{className:"font-semibold text-orange-800 text-xs sm:text-sm",children:"Investment Timing"})]}),e.jsx("div",{className:"text-lg sm:text-xl font-bold text-orange-600 leading-tight",children:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-orange-700 mt-0.5",children:"Buy now recommended"})]})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center bg-white/95 p-3 sm:p-4 rounded-lg shadow-lg border border-gray-200 max-w-xs w-[85%] sm:w-[80%]",children:[e.jsx(Gr,{className:"text-blue-600 mx-auto mb-1",size:16}),e.jsx("h3",{className:"font-bold text-gray-900 text-xs sm:text-sm mb-1",children:"Premium AI Insights"}),e.jsx("p",{className:"text-gray-600 text-[10px] sm:text-xs mb-2 sm:mb-3 leading-snug",children:"Get detailed recommendations and market analysis"}),e.jsx("button",{onClick:()=>rs("ai-recommendations"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-3 py-1.5 rounded-md text-xs sm:text-sm font-semibold hover:shadow-md transition-all",children:"Unlock for â‚¹299"})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-5 md:p-6 ring-1 ring-gray-100",children:[e.jsxs("h2",{className:"font-bold text-[#0b3856] text-base sm:text-lg mb-3 flex items-center gap-2",children:[e.jsx(Qs,{className:"text-[#E6761D] w-5 h-5"}),"Location & Connectivity"]}),e.jsx("div",{className:"rounded-lg overflow-hidden mb-4 ring-1 ring-[#0b3856]/20",children:e.jsx("iframe",{src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3781.30130000024!2d73.78210647468123!3d18.60551298250459!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bc2b92079f4046d%3A0xff65689f48a7dbd3!2sTamara%20Uprise!5e0!3m2!1sen!2sin!4v1761138421746!5m2!1sen!2sin",width:"100%",height:"250",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"rounded-lg p-3 bg-[#0b3856]/5 ring-1 ring-[#0b3856]/20 hover:bg-[#0b3856]/10 transition-all duration-200",children:[e.jsx("h3",{className:"font-semibold text-[#0b3856] mb-2 flex items-center gap-1.5 text-sm",children:"ðŸš† Transportation"}),e.jsxs("ul",{className:"space-y-1 text-sm text-[#0b3856] leading-tight",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(la,{className:"w-3.5 h-3.5 text-[#E6761D]"}),"Pune Station â€“ 0.5 km"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(la,{className:"w-3.5 h-3.5 text-[#E6761D]"}),"Airport â€“ 8 km"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(la,{className:"w-3.5 h-3.5 text-[#E6761D]"}),"Highway Access â€“ 1 km"]})]})]}),e.jsxs("div",{className:"rounded-lg p-3 bg-[#E6761D]/10 ring-1 ring-[#E6761D]/20 hover:bg-[#E6761D]/20 transition-all duration-200",children:[e.jsx("h3",{className:"font-semibold text-[#E6761D] mb-2 flex items-center gap-1.5 text-sm",children:"ðŸ¥ Essential Services"}),e.jsx("div",{className:"mt-0.5 text-[12px] text-slate-800",children:(Ze=h.nearby_places)!=null&&Ze.length?e.jsx("div",{className:"flex flex-wrap gap-1",children:h.nearby_places.map((z,te)=>e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-slate-700",children:e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(la,{className:"w-3.5 h-3.5 text-slate-700"}),z.type||""," ",z.distance?` â€“ ${z.distance} ${z.unit||""}`:"","  ",z.name||""]})},te))}):e.jsx("span",{className:"text-[12px] font-semibold text-slate-800/80",children:"Not Available"})})]})]}),e.jsx("div",{className:"mt-5 text-center",children:e.jsxs("a",{href:"https://www.google.com/maps?q=Tamara+Uprise",target:"_blank",rel:"noopener noreferrer",className:"group inline-flex items-center justify-center gap-2 px-5 py-2.5 rounded-lg text-white bg-[#E6761D] hover:bg-[#E6761D]  font-semibold text-sm shadow-md transition-all duration-200",children:["View on Google Maps",e.jsx(la,{className:"w-4 h-4 transition-transform duration-200 group-hover:translate-x-1"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm p-3 sm:p-4 md:p-5 ring-1 ring-gray-100",children:[e.jsx("h2",{className:"font-bold text-gray-900 text-sm sm:text-base mb-2 sm:mb-3",children:"Customer Reviews"}),e.jsxs("div",{className:"flex items-center mb-3 sm:mb-4",children:[e.jsx("div",{className:"flex items-center space-x-0.5 sm:space-x-1 mr-2 sm:mr-3",children:[1,2,3,4,5].map(z=>e.jsx(Xs,{size:14,className:"sm:w-4 sm:h-4 text-yellow-400 fill-current"},z))}),e.jsx("span",{className:"text-sm sm:text-base md:text-lg font-semibold text-gray-900 leading-none",children:"4.8"}),e.jsx("span",{className:"text-gray-600 ml-1.5 sm:ml-2 text-xs sm:text-sm leading-none",children:"(24 reviews)"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 sm:gap-3",children:[{name:"Rajesh Kumar",rating:5,comment:"Excellent property with great amenities. Highly recommended!",date:"2 days ago"},{name:"Priya Sharma",rating:4,comment:"Beautiful location and well-maintained property.",date:"1 week ago"},{name:"Amit Patel",rating:5,comment:"Perfect for families. Great connectivity and facilities.",date:"2 weeks ago"}].map((z,te)=>e.jsxs("div",{className:"border border-gray-100 rounded-lg p-2.5 sm:p-3 bg-white shadow-sm hover:shadow ring-1 ring-gray-100/70 transition",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-1.5",children:[e.jsxs("div",{className:"flex items-center space-x-1.5 sm:space-x-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ms,{size:12,className:"sm:w-3.5 sm:h-3.5 text-blue-600"})}),e.jsx("span",{className:"font-medium text-gray-900 text-xs sm:text-sm truncate",children:z.name})]}),e.jsxs("div",{className:"flex items-center space-x-1.5 sm:space-x-2 flex-shrink-0",children:[e.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(ce=>e.jsx(Xs,{size:10,className:`sm:w-3 sm:h-3 ${ce<=z.rating?"text-yellow-400 fill-current":"text-gray-300"}`},ce))}),e.jsx("span",{className:"text-[10px] sm:text-xs text-gray-500",children:z.date})]})]}),e.jsx("p",{className:"text-gray-700 text-xs sm:text-sm leading-snug",children:z.comment})]},te))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"hidden md:block lg:self-start lg:overflow-visible sticky top-24 z-40",children:e.jsx("div",{className:"sticky top-20",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-2 ring-1 ring-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-50 ring-1 ring-blue-200 flex items-center justify-center shadow-sm",children:e.jsx(Ms,{size:16,className:"text-blue-600","aria-hidden":"true"})}),e.jsx("div",{children:e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:We((ls=h==null?void 0:h.executiveTo)==null?void 0:ls.name)===" - "?" - ":(($s=h==null?void 0:h.executiveTo)==null?void 0:$s.name)||"-"})})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("button",{onClick:Ie,className:`flex-1 flex flex-col items-center justify-center py-2 rounded-xl \r
              bg-gradient-to-br from-blue-50 to-blue-100 \r
              text-blue-700 hover:from-blue-100 hover:to-blue-200 \r
              transition-all shadow-sm hover:shadow-md hover:scale-105`,children:e.jsx(Cs,{size:16})}),e.jsx("button",{onClick:z=>{var He;z.stopPropagation(),z.preventDefault();const te=O(),ce=te.startsWith("91")||te.length>10?"":"91",Re=(h==null?void 0:h.title)||[h==null?void 0:h.unitType,h==null?void 0:h.type].filter(Boolean).join(" ")||"a property",Te=(h==null?void 0:h.locationNormalized)||(h==null?void 0:h.location)||(h==null?void 0:h.city)||"your listed property location",qe=Number((h==null?void 0:h.price)||0),as=isNaN(qe)?"Price on request":`â‚¹${qe.toLocaleString("en-IN")}`,xs=(h==null?void 0:h.slug)||((He=h==null?void 0:h.raw)==null?void 0:He.slug)||(typeof window<"u"?window.location.pathname.split("/").pop():"")||"",ps=`${window.location.origin}/properties/${encodeURIComponent(String(xs))}`,ys=`Hi! I'm interested in ${Re} at ${Te}. Price: ${as}. Can you provide more details?
${ps}`;typeof window<"u"&&window.open(`https://wa.me/${ce}${te}?text=${encodeURIComponent(ys)}`,"_blank","noopener,noreferrer")},className:`flex-1 flex flex-col items-center justify-center py-2 rounded-xl \r
  bg-gradient-to-br from-green-50 to-green-100 \r
  text-green-700 hover:from-green-100 hover:to-green-200 \r
  transition-all shadow-sm hover:shadow-md hover:scale-105`,children:e.jsx(Ia,{size:16,className:"text-[#25D366]"})}),e.jsx("button",{onClick:()=>m(!0),className:`flex-1 flex flex-col items-center justify-center py-2 rounded-xl \r
              bg-gradient-to-br from-purple-50 to-purple-100 \r
              text-purple-700 hover:from-purple-100 hover:to-purple-200 \r
              transition-all shadow-sm hover:shadow-md hover:scale-105`,children:e.jsx(tt,{size:16})}),e.jsx("button",{onClick:()=>m(!0),className:`flex-1 flex flex-col items-center justify-center py-2 rounded-xl \r
              bg-gradient-to-br from-emerald-50 to-emerald-100 \r
              text-emerald-700 hover:from-emerald-100 hover:to-emerald-200 \r
              transition-all shadow-sm hover:shadow-md hover:scale-105`,children:e.jsx(Ts,{size:16})})]})]})})}),e.jsx("div",{className:"fixed inset-x-0 bottom-[max(env(safe-area-inset-bottom,0),8px)] z-[60] md:hidden pointer-events-none",children:e.jsx("div",{className:"mx-auto max-w-sm px-3",children:e.jsxs("div",{className:`pointer-events-auto bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/80 z-50\r
       shadow-[0_10px_30px_-10px_rgba(0,0,0,.35)]\r
      ring-1 ring-gray-200 border border-white/60 p-2.5`,role:"toolbar","aria-label":"Mobile quick actions",children:[e.jsxs("div",{className:"flex items-center gap-2.5 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-50 ring-1 ring-blue-200 flex items-center justify-center shadow-sm",children:e.jsx(Ms,{size:16,className:"text-blue-600","aria-hidden":"true"})}),e.jsx("h3",{className:"font-semibold text-gray-900 text-[13px] leading-none truncate",children:We((Gs=h==null?void 0:h.executiveTo)==null?void 0:Gs.name)===" - "?" - ":((Se=h==null?void 0:h.executiveTo)==null?void 0:Se.name)||"Rohit Sharma"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsx("button",{onClick:Ie,"aria-label":"Call executiveTo",className:`flex flex-col items-center justify-center gap-1 rounded-xl\r
          bg-gradient-to-br from-blue-50 to-blue-100 text-blue-700 border border-blue-200/60\r
          transition-all shadow-sm hover:shadow-md active:scale-[0.98] py-1.5`,children:e.jsx("span",{className:"w-4 h-4 rounded-full flex items-center justify-center ring-1 ring-blue-200/60",children:e.jsx(Cs,{size:14,"aria-hidden":"true"})})}),e.jsx("button",{onClick:z=>{var He,vs,_s,et,ts;z.stopPropagation(),z.preventDefault();const te=((vs=(He=h==null?void 0:h.executiveTo)==null?void 0:He.phone)==null?void 0:vs.replace(/\D/g,""))||((et=(_s=h==null?void 0:h.executive)==null?void 0:_s.phone)==null?void 0:et.replace(/\D/g,""))||"919637009639",ce=te.startsWith("91")||te.length>10?"":"91",Re=(h==null?void 0:h.title)||[h==null?void 0:h.unitType,h==null?void 0:h.type].filter(Boolean).join(" ")||"a property",Te=(h==null?void 0:h.locationNormalized)||(h==null?void 0:h.location)||(h==null?void 0:h.city)||"your listed property location",qe=Number((h==null?void 0:h.price)||0),as=isNaN(qe)?"Price on request":`â‚¹${qe.toLocaleString("en-IN")}`,xs=(h==null?void 0:h.slug)||((ts=h==null?void 0:h.raw)==null?void 0:ts.slug)||(typeof window<"u"?window.location.pathname.split("/").pop():"")||"",ps=`${window.location.origin}/properties/${encodeURIComponent(String(xs))}`,ys=`Hi, I'm interested in ${Re} at ${Te}. Price: ${as}. Can you share more details?
${ps}`;window.open(`https://wa.me/${ce}${te}?text=${encodeURIComponent(ys)}`,"_blank","noopener,noreferrer")},"aria-label":"WhatsApp executiveTo",className:`flex flex-col items-center justify-center gap-1 rounded-xl\r
  bg-[#25D366]/10 hover:bg-[#25D366]/15 text-[#128C7E]\r
  border border-[#25D366]/30 transition-all shadow-sm hover:shadow-md active:scale-[0.98] py-1.5`,children:e.jsx("span",{className:"w-4 h-4 rounded-full flex items-center justify-center ring-1 ring-[#25D366]/30",children:e.jsx(Ia,{size:14,"aria-hidden":"true"})})}),e.jsx("button",{onClick:()=>m(!0),"aria-label":"Message executiveTo",className:`flex flex-col items-center justify-center gap-1 rounded-xl\r
          bg-gradient-to-br from-purple-50 to-purple-100 text-purple-700 border border-purple-200/60\r
          transition-all shadow-sm hover:shadow-md active:scale-[0.98] py-1.5`,children:e.jsx("span",{className:"w-4 h-4 rounded-full flex items-center justify-center ring-1 ring-purple-200/60",children:e.jsx(tt,{size:14,"aria-hidden":"true"})})}),e.jsx("button",{"aria-label":"Schedule visit",className:`flex flex-col items-center justify-center gap-1 rounded-xl\r
          bg-gradient-to-br from-emerald-50 to-emerald-100 text-emerald-700 border border-emerald-200/60\r
          transition-all shadow-sm hover:shadow-md active:scale-[0.98] py-1.5`,children:e.jsx("span",{className:"w-4 h-4 rounded-full flex items-center justify-center ring-1 ring-emerald-200/60",children:e.jsx(Ts,{size:14,"aria-hidden":"true"})})})]})]})})}),e.jsxs("div",{className:"px-2 py-1 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm mb-4",children:"Property Activity"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-1 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ks,{className:"text-green-600",size:16}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Views"})]}),e.jsx("span",{className:"text-green-600",children:(h==null?void 0:h.views)??"â€”"})]}),e.jsxs("div",{className:"flex items-center justify-between p-1 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ra,{className:"text-blue-600",size:16}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Shortlisted By"})]}),e.jsx("span",{className:"text-blue-600",children:"23 People"})]}),e.jsxs("div",{className:"flex items-center justify-between p-1 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{className:"text-orange-600",size:16}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Contact Requests"})]}),e.jsx("span",{className:" text-orange-600",children:"12 This Week"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden ring-1 ring-gray-100",children:[e.jsx("div",{className:"px-2 py-1 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white",children:e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Property Highlights"})}),e.jsx("div",{className:"p-2 md:p-3 grid grid-cols-2 gap-2",children:[{label:"Bedrooms",icon:e.jsx(jl,{size:14,className:"text-blue-600"}),value:(h==null?void 0:h.bedrooms)??"-"},{label:"Bathrooms",icon:e.jsx(Gn,{size:14,className:"text-green-600"}),value:(h==null?void 0:h.bathrooms)??"-"},{label:"Parking",icon:e.jsx(Sl,{size:14,className:"text-orange-600"}),value:(h==null?void 0:h.parkingQty)??"-"},{label:"Balcony",icon:e.jsx(Nr,{size:14,className:"text-cyan-600"}),value:(h==null?void 0:h.balcony)||"-"},{label:"Property Type",icon:e.jsx(Is,{size:14,className:"text-blue-600"}),value:(h==null?void 0:h.type)??"-"},{label:"Built Year",icon:e.jsx(Ts,{size:14,className:"text-green-600"}),value:(h==null?void 0:h.possessionYear)??"-"},{label:"Furnishing",icon:e.jsx(yt,{size:14,className:"text-purple-600"}),value:(h==null?void 0:h.furnishing)??"-"},{label:"Facing",icon:e.jsx(rt,{size:14,className:"text-orange-600"}),value:(h==null?void 0:h.facing)??"-"}].map((z,te)=>e.jsxs("div",{className:`h-11 px-2 rounded-lg bg-white border border-gray-200/70 ring-1 ring-gray-50\r
                   flex items-center justify-between gap-2 hover:shadow-sm transition-all`,children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-lg\r
                           bg-gray-50 ring-1 ring-gray-100`,children:z.icon}),e.jsx("span",{className:"text-[12px] font-medium text-gray-600",children:z.label})]}),e.jsx("span",{className:"text-[12px] font-semibold text-gray-900 leading-none",children:z.value})]},te))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-5 ring-1 ring-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-base sm:text-lg mb-4",children:"Price Breakdown"}),K?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-700",children:"Base Price"}),e.jsx("span",{className:"font-medium text-gray-900",children:pe(K.basePrice)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Total Taxes & Charges"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Stamp Duty "}),e.jsx("span",{className:"text-xs text-green-600 font-medium ml-1",children:"7%"})]}),e.jsx("span",{className:"font-medium text-gray-900",children:pe(K.stampDuty.amount)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Registration Charges "}),e.jsx("span",{className:"text-xs text-green-600 font-medium ml-1",children:"1% or (Max â‚¹30,000)"})]}),e.jsx("span",{className:"font-medium text-gray-900",children:pe(K.registration.amount)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Legal & Documentation"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium ml-1",children:"(â‚¹10,000-15,000)"})]}),e.jsx("span",{className:"font-medium text-gray-900",children:pe(K.legalFees)})]}),e.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded text-xs text-gray-600",children:e.jsxs("p",{className:"flex items-start",children:[e.jsx(bs,{size:12,className:"mr-1 mt-0.5 flex-shrink-0 text-green-600"}),e.jsxs("span",{children:[e.jsx("strong",{children:"For Resale Properties:"})," No GST,Society Charges (at actual)."]})]})})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Taxes & Charges"}),e.jsx("span",{className:"font-medium",children:pe(K.additionalCharges)})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["That's ",K.percentageOverBase.toFixed(1),"% over the base price"]})]}),e.jsxs("div",{className:"border-t pt-3 flex items-center justify-between bg-[#E6761D]/5 p-3 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900 text-base",children:"Total Cost"}),e.jsxs("div",{className:" text-xs text-gray-500 mt-1",children:["Including: 7% Stamp Duty + Registration",e.jsx("br",{}),"+ Legal Fees"]})]}),e.jsx("span",{className:"font-bold text-[#E6761D] text-lg",children:pe(K.totalCost)})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"font-semibold text-blue-900 flex items-center",children:[e.jsx(sr,{size:18,className:"mr-2"}),"Smart EMI Calculator"]}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:(je(h),"Resale Property")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Loan Percentage"}),e.jsxs("span",{className:"font-semibold",children:[J,"%"]})]}),e.jsx("div",{className:"flex space-x-2 mb-3",children:[70,75,80,85,90].map(z=>e.jsxs("button",{onClick:()=>Fe(z),className:`flex-1 py-1.5 text-xs rounded ${J===z?"bg-[#E6761D] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[z,"%"]},z))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-white p-2 rounded border",children:[e.jsx("div",{className:"text-gray-600 text-xs",children:"Loan Amount"}),e.jsx("div",{className:"font-bold text-blue-700",children:pe(S)}),e.jsxs("div",{className:"text-xs text-gray-500",children:["(",J,"% of property value)"]})]}),e.jsxs("div",{className:"bg-white p-2 rounded border",children:[e.jsx("div",{className:"text-gray-600 text-xs",children:"Self Payment"}),e.jsx("div",{className:"font-bold text-green-700",children:pe(K.totalCost-S)}),e.jsxs("div",{className:"text-xs text-gray-500",children:["(",100-J,"% required)"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Interest Rate"}),e.jsxs("span",{className:"font-semibold",children:[Q,"%"]})]}),e.jsx("input",{type:"range",min:"7",max:"12",step:"0.1",value:Q,onChange:z=>$e(parseFloat(z.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-[#E6761D]"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"7%"}),e.jsx("span",{children:"9.5%"}),e.jsx("span",{children:"12%"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Loan Tenure"}),e.jsxs("span",{className:"font-semibold",children:[se," years"]})]}),e.jsx("div",{className:"flex space-x-2",children:[15,20,25,30].map(z=>e.jsxs("button",{onClick:()=>Le(z),className:`flex-1 py-1.5 text-xs rounded ${se===z?"bg-[#E6761D] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[z," years"]},z))})]}),ne&&e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-gray-700",children:"Monthly EMI"}),e.jsxs("span",{className:"text-2xl font-bold text-[#E6761D]",children:["â‚¹",(Ge=ne.emi)==null?void 0:Ge.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["For ",S>=1e7?"â‚¹"+(S/1e7).toFixed(2)+"Cr":"â‚¹"+(S/1e5).toFixed(2)+"L","loan at ",Q,"% for ",se," years"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 text-xs",children:[e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"text-gray-600",children:"Principal"}),e.jsx("div",{className:"font-semibold",children:pe(ne.principal)})]}),e.jsxs("div",{className:"text-center p-2 bg-red-50 rounded",children:[e.jsx("div",{className:"text-gray-600",children:"Interest"}),e.jsx("div",{className:"font-semibold",children:pe(ne.totalInterest)})]}),e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"text-gray-600",children:"Total"}),e.jsx("div",{className:"font-semibold",children:pe(ne.totalPayment)})]})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{years:15,rate:8.4},{years:20,rate:8.5},{years:25,rate:8.6}].map((z,te)=>{var Re;const ce=oe(S,z.rate,z.years);return e.jsxs("button",{onClick:()=>{ge(z.years),he(z.rate)},className:`text-xs p-2 bg-white border rounded hover:bg-blue-50 transition ${se===z.years&&Math.abs(Q-z.rate)<.1?"border-[#E6761D] bg-blue-50":""}`,children:[e.jsxs("div",{className:"font-medium",children:[z.years," Years"]}),e.jsxs("div",{className:"text-gray-600",children:[z.rate,"%"]}),e.jsxs("div",{className:"text-[#E6761D] font-semibold",children:["â‚¹",(Re=ce.emi)==null?void 0:Re.toLocaleString("en-IN")]})]},te)})}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:e.jsxs("p",{className:"flex items-start",children:[e.jsx(zc,{size:12,className:"mr-1 mt-0.5 flex-shrink-0"}),"EMI calculated for illustrative purposes. Actual rates may vary based on credit score, bank policies, and market conditions."]})})]})]})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"animate-pulse text-gray-400",children:"Calculating charges..."})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl shadow-sm p-4 sm:p-5 relative ring-1 ring-purple-100/70",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-3",children:[e.jsx(Mt,{className:"text-purple-600",size:16}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"AI Investment Analysis"})]}),x?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Purchase Recommendation"}),e.jsx("span",{className:"font-bold text-green-600 text-sm sm:text-base leading-tight",children:"Strong Buy"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Expected ROI (5 years)"}),e.jsx("span",{className:"font-bold text-blue-600 text-sm sm:text-base leading-tight",children:"18.2%"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Risk Level"}),e.jsx("span",{className:"font-bold text-yellow-600 text-sm sm:text-base leading-tight",children:"Low"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Market Timing"}),e.jsx("span",{className:"font-bold text-purple-600 text-sm sm:text-base leading-tight",children:"Excellent"})]})})]}),e.jsx("div",{className:"p-3 bg-white rounded-lg border border-purple-100",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(zt,{className:"text-purple-600 mt-0.5",size:16}),e.jsxs("p",{className:"text-xs text-gray-700 leading-snug",children:[e.jsx("strong",{children:"AI Insight:"})," This property is in the top 5% for investment potential in this area. Current market conditions favor immediate purchase."]})]})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 blur-sm pointer-events-none select-none",children:[e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Purchase Recommendation"}),e.jsx("span",{className:"font-bold text-green-600 text-sm sm:text-base",children:"â€¢â€¢â€¢â€¢â€¢â€¢ â€¢â€¢â€¢"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Expected ROI (5 years)"}),e.jsx("span",{className:"font-bold text-blue-600 text-sm sm:text-base",children:"â€¢â€¢.â€¢%"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Risk Level"}),e.jsx("span",{className:"font-bold text-yellow-600 text-sm sm:text-base",children:"â€¢â€¢â€¢"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Market Timing"}),e.jsx("span",{className:"font-bold text-purple-600 text-sm sm:text-base",children:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})})]})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center bg-white/95 p-4 rounded-lg shadow-lg border border-gray-200 max-w-xs w-[92%]",children:[e.jsx(va,{className:"text-purple-600 mx-auto mb-2",size:18}),e.jsx("h4",{className:"font-bold text-gray-900 mb-1 text-base",children:"Investment Analysis"}),e.jsx("p",{className:"text-xs text-gray-600 mb-3 leading-snug",children:"Get AI-powered investment insights"}),e.jsx("button",{onClick:()=>rs("ai-investment"),className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-3 py-1.5 rounded-md text-sm font-semibold hover:shadow-md transition-all",children:"Unlock â‚¹299"})]})})]})]}),e.jsx(Wp,{properties:$,loading:k,debug:!0})]})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-[#0b3856]",children:"Call Back Request"}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-[#0b3856]",children:e.jsx(ns,{size:20})})]}),e.jsxs("form",{onSubmit:Oe,className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#0b3856] mb-1",children:"Salutation *"}),e.jsxs("select",{value:W.salutation,onChange:z=>B({...W,salutation:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] focus:border-transparent text-sm",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),U.map(z=>e.jsx("option",{value:z.value||z.label,children:z.label||z.value},z.value||z.label))]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-[#0b3856] mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:W.name,onChange:z=>B({...W,name:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] focus:border-transparent text-sm",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#0b3856] mb-1",children:"Phone *"}),e.jsx("input",{type:"tel",value:W.phone,onChange:z=>B({...W,phone:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] focus:border-transparent text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#0b3856] mb-1",children:"Email"}),e.jsx("input",{type:"email",value:W.email,onChange:z=>B({...W,email:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] focus:border-transparent text-sm"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-[#0b3856] text-[#0b3856] rounded-lg hover:bg-[#0b3856] hover:text-white transition-colors text-sm",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-[#E6761D] text-white rounded-lg hover:bg-[#CC6A1A] transition-colors text-sm",children:"Submit"})]})]})]})}),e.jsx(Sp,{isOpen:g,onClose:()=>b(!1),onSubscribe:ms,featureType:d}),t&&(()=>{var as,xs,ps,ys;const te=[(h==null?void 0:h.type)??"",(h==null?void 0:h.unitType)??"",(h==null?void 0:h.subtype)??""].map(He=>(He||"").toString().trim()).filter(Boolean),ce=te.length?te.join(" "):(h==null?void 0:h.title)||"Property Listing",Re=h!=null&&h.description&&h.description!==""?h.description:((as=h==null?void 0:h.raw)==null?void 0:as.description)??((xs=h==null?void 0:h.raw)==null?void 0:xs.short_description)??"",Te=Array.isArray(h==null?void 0:h.images)&&h.images[0]||Array.isArray(h==null?void 0:h.photos)&&h.photos[0]||((ps=h==null?void 0:h.raw)==null?void 0:ps.image)||((ys=h==null?void 0:h.raw)==null?void 0:ys.photo)||"",qe=typeof window<"u"?window.location.href:"";return e.jsx(xn,{url:qe,title:ce,description:Re,image:Te,propertyId:h.id,slug:`${h.id}-${h.slug}`,onClose:()=>r(!1)})})()]})},ma=({isOpen:s,onClose:a,title:t,subtitle:r,children:i,width:n="max-w-[95vw] sm:max-w-sm md:max-w-md lg:max-w-lg"})=>(l.useEffect(()=>{if(!s)return;const o={overflow:document.body.style.overflow,paddingRight:document.body.style.paddingRight};document.body.style.overflow="hidden";const m=window.innerWidth-document.documentElement.clientWidth;return m>0&&(document.body.style.paddingRight=`${m}px`),()=>{document.body.style.overflow=o.overflow,document.body.style.paddingRight=o.paddingRight}},[s]),s?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center","aria-modal":"true",role:"dialog",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:a,"aria-hidden":"true"}),e.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl w-full ${n} max-h-[90vh] flex flex-col z-50`,onClick:o=>o.stopPropagation(),style:{minWidth:320},children:[(t||r)&&e.jsxs("div",{className:"sticky top-0 bg-gray-100 text-gray-800  z-[60] p-4 py-2 rounded-t-lg shadow-md",children:[t&&e.jsx("h2",{className:"text-xl font-semibold",children:t}),r&&e.jsx("p",{className:"text-sm opacity-90",children:r})]}),e.jsx("div",{id:"modal-portal",className:"absolute left-0 right-0 pointer-events-auto z-[55]"}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 rounded-b-lg",children:i}),e.jsx("button",{onClick:a,className:"absolute top-3 right-3 text-gray-700 hover:text-gray-500 text-xl p-1 z-[65] rounded-lg","aria-label":"Close modal",children:"âœ•"})]})]}):null),Hp={default:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-400",primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",ghost:"text-gray-700 hover:bg-gray-50 focus:ring-blue-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},Yp={sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-xs",lg:"px-2 py-2 text-xs"},ss=({variant:s="primary",size:a="md",loading:t=!1,disabled:r,className:i,children:n,...o})=>e.jsxs("button",{className:$t("inline-flex items-center justify-center font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",Hp[s],Yp[a],i),disabled:r||t,...o,children:[t&&e.jsx(ia,{size:"sm",className:"mr-2"}),n]}),da=({options:s=[],value:a,onChange:t,placeholder:r="Select...",label:i,align:n="left",className:o="",triggerClassName:m="",disabled:g=!1,searchable:b=!1,searchPlaceholder:d="Search...",noOptionsLabel:v="No options"})=>{const[x,u]=l.useState(!1),[c,f]=l.useState(""),p=l.useRef(null),N=l.useRef(null),P=l.useMemo(()=>Array.isArray(s)?s:[],[s]),w=l.useMemo(()=>{if(!b||!c.trim())return P;const R=c.trim().toLowerCase();return P.filter(F=>(F.label||F.value).toLowerCase().includes(R))},[P,b,c]),$=l.useMemo(()=>P.find(R=>R.value===(a??"")),[P,a]);l.useEffect(()=>{const R=F=>{p.current&&!p.current.contains(F.target)&&u(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]),l.useEffect(()=>{const R=F=>{F.key==="Escape"&&u(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[]),l.useEffect(()=>{if(x&&b){const R=setTimeout(()=>{var F;return(F=N.current)==null?void 0:F.focus()},50);return()=>clearTimeout(R)}else f("")},[x,b]);const y=R=>{R.disabled||(R.action?R.action():t&&t(R.value),u(!1),f(""))},k=()=>{g||u(R=>!R)};return e.jsxs("div",{className:"w-full",ref:p,children:[i&&e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:i}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button","aria-haspopup":"listbox","aria-expanded":x,disabled:g,className:["inline-flex justify-between items-center w-full rounded-md border border-gray-300 shadow-sm px-3 bg-white text-xs font-medium text-gray-700","hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 h-9",g?"opacity-60 cursor-not-allowed":"",o,m].join(" ").trim(),onClick:k,children:[($==null?void 0:$.label)||e.jsx("span",{className:"text-gray-400",children:r}),e.jsx(ea,{className:`ml-2 h-3 w-3 transition-transform ${x?"rotate-180":""}`})]}),x&&e.jsxs("div",{role:"listbox",tabIndex:-1,className:["origin-top-right absolute mt-1 w-full rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50 max-h-60 overflow-hidden",n==="right"?"right-0":"left-0"].join(" "),children:[b&&e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{ref:N,type:"text",value:c,onChange:R=>f(R.target.value),placeholder:d,className:"w-full px-2 py-1 border border-gray-200 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500"})}),e.jsx("div",{className:"py-1 max-h-44 overflow-y-auto",children:w.length===0?e.jsx("div",{className:"px-3 py-2 text-xs text-gray-400 select-none",children:v}):w.map(R=>{const F=a===R.value,T="block w-full text-left px-3 py-2 text-xs transition-colors",j=R.danger?"text-red-700 hover:bg-red-50":"text-gray-700 hover:bg-gray-100",E=F?"bg-blue-50 text-blue-600":"",V=R.disabled?"opacity-50 cursor-not-allowed hover:bg-transparent":"";return e.jsx("button",{type:"button",role:"option","aria-selected":F,onClick:()=>y(R),className:[T,j,E,V].join(" "),disabled:R.disabled,children:R.label},R.value)})})]})]})]})},st={getAll:async()=>(await Ae.get("/sellers/getSellers")).data.data,getById:async s=>{if(!s)throw new Error("Seller ID is required");return(await Ae.get(`/sellers/getSellerById/${s}`)).data},create:async s=>{if(!(s!=null&&s.name))throw new Error("Seller name is required");return(await Ae.post("/sellers/createSeller",s)).data},update:async(s,a)=>{if(!s)throw new Error("Seller ID is required");return(await Ae.put(`/sellers/updateSeller/${s}`,a)).data},delete:async s=>{if(!s)throw new Error("Seller ID is required");return(await Ae.delete(`/sellers/deleteSeller/${s}`)).data},bulkDelete:async s=>{const{data:a}=await Ae.post("/sellers/hard-delete",{ids:s});return a},importSellers:async s=>(await Ae.post("/sellers/bulk-import",s)).data,bulkAssignExecutive:async(s,a,t=!1)=>{if(!Array.isArray(s)||!s.length)throw new Error("Seller IDs are required");return(await Ae.post("/sellers/bulk/assign-executive",{sellerIds:s,executiveId:a,onlyEmpty:t})).data},updateLeadField:async(s,a,t)=>{if(!s)throw new Error("Seller ID is required");if(!a)throw new Error("Field name is required");return(await Ae.post(`/sellers/${s}/lead-field`,{field:a,value:t})).data},bulkUpdateLeadField:async(s,a,t,r=!1)=>{if(!Array.isArray(s)||!s.length)throw new Error("Seller IDs are required");return(await Ae.post("/sellers/bulk/lead-field",{sellerIds:s,field:a,value:t,onlyEmpty:r})).data}},Or=1e7,Yi=1e5,$d=Yi,yo=new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}),ti=s=>{if(s<=0)return"0L";if(s<Or){const t=s/Yi;return`${parseFloat(t.toFixed(0))}L`}const a=s/Or;return`${parseFloat(a.toFixed(2))}Cr`},ai=(s,a=0,t=1/0)=>Math.max(a,Math.min(t,s)),ri=s=>Math.round(s/$d)*$d,ld=({minLakh:s=20,maxCrore:a=5,initialMax:t=s/100,onChange:r,className:i=""})=>{const n=Math.round(s*Yi),o=Math.round(a*Or),m=Math.round(t*Or),g=ai(ri(m),n,o),[b,d]=l.useState(g),[v,x]=l.useState(!1),u=l.useRef(null),c=k=>{const R=ai(ri(k),n,o);d(F=>F===R?F:R)};l.useEffect(()=>{const k=ai(ri(Math.round(t*Or)),n,o);d(R=>R===k?R:k)},[t,n,o]);const f=l.useRef();l.useEffect(()=>{f.current=r},[r]),l.useEffect(()=>{var k;(k=f.current)==null||k.call(f,{min:n/Or,max:b/Or,readable:ti(b)})},[b,n]);const N=(k=>(k-n)/(o-n)*100)(b),P=k=>{const R=u.current;if(!R)return n;const F=R.getBoundingClientRect(),T=ai((k-F.left)/F.width,0,1);return ri(n+T*(o-n))};l.useEffect(()=>{if(!v)return;const k=F=>c(P(F.clientX)),R=()=>x(!1);return window.addEventListener("mousemove",k),window.addEventListener("mouseup",R),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",R)}},[v]);const[w,$]=l.useState(yo.format(g));l.useEffect(()=>{$(yo.format(b))},[b]);const y=k=>{const R=k.target.value;$(R);const F=R.replace(/,/g,"").toLowerCase();if(/^\d+$/.test(F)){c(parseInt(F,10));return}if(F.endsWith("l")){c(parseFloat(F)*Yi);return}F.endsWith("cr")&&c(parseFloat(F)*Or)};return e.jsxs("div",{className:`w-full ${i}`,children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-2",children:"Amount (â‚¹)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:w,onChange:y,onBlur:()=>$(yo.format(b)),className:"border px-2 py-1.5 rounded text-sm"}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:ti(b)})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{ref:u,className:"relative h-2 bg-gray-200 rounded cursor-pointer",onMouseDown:k=>{c(P(k.clientX)),x(!0)},children:[e.jsx("div",{className:"absolute h-full bg-orange-500 rounded",style:{width:`${N}%`}}),e.jsx("div",{className:"absolute w-4 h-4 bg-orange-600 rounded-full top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:`${N}%`}})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:ti(n)}),e.jsx("span",{children:ti(o)})]})]})]})},Fu=1e7,Gp=1e5;function jo(s){const a=(s||"").trim().toLowerCase();if(!a)return 0;const t=a.replace(/â‚¹/g,"").replace(/\s+/g,""),r=t.replace(/,/g,"");if(/^\d+$/.test(r))return parseInt(r,10)||0;const i=t.match(/^([\d,.]+)l$/);if(i)return Math.round(parseFloat(i[1].replace(/,/g,""))*Gp)||0;const n=t.match(/^([\d,.]+)(cr|c)$/);if(n)return Math.round(parseFloat(n[1].replace(/,/g,""))*Fu)||0;const o=parseFloat(r);return Number.isNaN(o)?0:Math.round(o)}function Kp(s){return!s||s<=0?.01:s/Fu}const Lt="block text-xs font-semibold text-gray-700 mb-1",yc="w-full h-10 px-3 rounded-lg text-sm border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",Jp=yc+" flex items-center justify-between",Qp="space-y-3 bg-white p-4 py-0 rounded-lg shadow-sm",Kt=s=>e.jsx(da,{...s});function Zp(s){const a=[];let t=(s==null?void 0:s.parentElement)||null;for(;t;){const i=window.getComputedStyle(t).overflowY;(i==="auto"||i==="scroll"||t===document.body)&&a.push(t),t=t.parentElement}return a}const Ed=({options:s,selectedValues:a,onToggle:t,label:r,placeholder:i="Select options..."})=>{const[n,o]=l.useState(!1),[m,g]=l.useState(""),b=l.useRef(null),d=l.useRef(null),[v,x]=l.useState(null),u=l.useMemo(()=>s.filter(R=>(R.label||"").toLowerCase().includes(m.toLowerCase())),[s,m]),c=l.useMemo(()=>{if(a.length===0)return i;if(a.length===1){const R=s.find(F=>String(F.value)===String(a[0]));return(R==null?void 0:R.label)||a[0]}return`${a.length} items selected`},[a,s,i]);l.useEffect(()=>{if(!n)return;const R=F=>{const T=F.target;d.current&&d.current.contains(T)||b.current&&b.current.contains(T)||(o(!1),g(""))};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[n]);const f=()=>{if(!b.current)return x(null);x(b.current.getBoundingClientRect())};l.useEffect(()=>{if(!n)return;f();const R=()=>f(),F=()=>f();window.addEventListener("resize",R),window.addEventListener("scroll",F,!0);const T=Zp(b.current),j=()=>f();return T.forEach(E=>E.addEventListener("scroll",j,!0)),()=>{window.removeEventListener("resize",R),window.removeEventListener("scroll",F,!0),T.forEach(E=>E.removeEventListener("scroll",j,!0))}},[n]),l.useEffect(()=>{const R=document.body.style.overflow;return n?document.body.style.overflow="hidden":document.body.style.overflow=R||"",()=>{document.body.style.overflow=R||""}},[n]);const p=()=>typeof document>"u"?null:document.getElementById("modal-portal")||document.body,N=typeof document<"u"&&!!document.getElementById("modal-portal"),P=1050,w=9999999,$=v?{position:"fixed",zIndex:N?P:w,top:v.bottom+window.scrollY+6,left:v.left+window.scrollX,minWidth:v.width,maxHeight:"40vh",overflow:"hidden",pointerEvents:"auto",boxShadow:"0 10px 20px rgba(0,0,0,0.08)"}:{position:"fixed",zIndex:N?P:w,top:0,left:0,minWidth:200,pointerEvents:"auto"},y=e.jsxs("div",{ref:d,className:"bg-white border rounded-lg shadow-lg overflow-hidden",style:$,children:[e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{type:"text",placeholder:"Search...",value:m,onChange:R=>g(R.target.value),className:"w-full px-2 py-2 border border-gray-100 rounded text-sm focus:outline-none",autoFocus:!0})}),e.jsx("div",{className:"max-h-56 overflow-y-auto",children:u.length===0?e.jsx("p",{className:"text-xs text-gray-500 p-3",children:"No options found"}):u.map(R=>e.jsxs("label",{className:"flex items-center p-3 hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.map(String).includes(String(R.value)),onChange:()=>{t(String(R.value))},className:"mr-3 h-4 w-4 rounded border-gray-300 accent-blue-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:R.label})]},String(R.value)))}),a.length>0&&e.jsxs("div",{className:"p-2 bg-gray-50 border-t text-xs text-blue-600",children:["Selected: ",a.length," item(s)"]})]}),k=typeof document<"u"?p():null;return e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:Lt,children:r}),e.jsxs("button",{ref:b,type:"button",onClick:R=>{R.stopPropagation(),o(F=>!F),setTimeout(f,0)},className:`${Jp} text-left px-3`,children:[e.jsx("span",{className:a.length===0?"text-gray-400":"text-gray-900",children:c}),e.jsx("span",{className:"text-gray-400 text-sm",children:"â–¾"})]}),n&&b.current&&k&&Il.createPortal(y,k)]})},Md=({preview:s,onRemove:a})=>{var t,r,i;return e.jsx("div",{className:"relative group",children:s.type==="image"?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.url,alt:s.name||((t=s.file)==null?void 0:t.name)||"Image",className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all rounded-lg flex items-center justify-center",children:e.jsx("button",{onClick:a,className:"opacity-0 group-hover:opacity-100 bg-red-500 text-white rounded-full p-2 transition-opacity hover:bg-red-600",title:"Remove",children:e.jsx(ns,{size:16})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-sm p-2 rounded-b-lg truncate",children:s.name||((r=s.file)==null?void 0:r.name)||"Image"})]}):e.jsxs("div",{className:"relative bg-gray-50 border border-gray-200 rounded-lg p-3 h-24 flex flex-col items-center justify-center",children:[e.jsx(ws,{className:"text-blue-500 mb-2",size:24}),e.jsx("span",{className:"text-sm text-gray-700 text-center truncate w-full",children:s.name||((i=s.file)==null?void 0:i.name)||"Document"}),e.jsx("button",{onClick:a,className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",title:"Remove",children:e.jsx(ns,{size:12})})]})})},Ld=({possessionMonth:s,possessionYear:a,onMonthChange:t,onYearChange:r,title:i})=>{const n=new Date,o=n.getFullYear(),m=n.getMonth()+1,g=l.useMemo(()=>["January","February","March","April","May","June","July","August","September","October","November","December"],[]),b=parseInt(a)||o,d=parseInt(s)||m;l.useEffect(()=>{b===o&&d>m&&t(m.toString())},[b,d,m,o,t]);const v=Array.from({length:40},(u,c)=>{const f=(o-c).toString();return{value:f,label:f}}),x=g.map((u,c)=>{const f=c+1,p=b===o&&f>m;return{value:f.toString(),label:u,disabled:p}});return e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:i}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Kt,{placeholder:"Year",options:v,value:a,onChange:r,className:"w-full"})}),e.jsx("div",{className:"flex-1",children:e.jsx(Kt,{placeholder:"Month",options:x.filter(u=>!u.disabled),value:s,onChange:t,className:"w-full"})})]}),s&&a&&e.jsxs("div",{className:"mt-2 text-sm text-blue-600 bg-blue-50 px-2 py-1 rounded",children:["Selected: ",g[parseInt(s)-1]," ",a]})]})},Bu=({isOpen:s,onClose:a,onSubmit:t,mode:r="create",propertyId:i,initialData:n,seller:o})=>{const m=new Date,g=m.getFullYear(),b=m.getMonth()+1,[d,v]=l.useState(1),[x,u]=l.useState(()=>({salutation:"Mr",ownerName:"",ownerPhone:"",ownerWhatsapp:"",sameAsPhone:!1,ownerEmail:"",ownerType:"individual",seller:"",propertyType:"",propertySubtype:"",unitType:"",wing:"",unitNo:"",furnishing:"",parkingType:"",parkingQty:"",city:"",location:"",society:"",floor:"",totalFloors:"",carpetArea:"",builtupArea:"",budget:"",address:"",status:"",leadSource:"",possessionMonth:String(b),possessionYear:String(g),purchaseMonth:String(b),purchaseYear:String(g),sellingRights:"Standard",amenities:[],furnishingItems:[],description:"",nearby_places:[],ownershipDoc:null,photos:[],bedrooms:"",bathrooms:"",facing:"",priceType:"Fixed",finalPrice:""})),[c,f]=l.useState(null),[p,N]=l.useState([]),[P,w]=l.useState({name:"",distance:"",unit:"",type:""}),[$,y]=l.useState({}),[k,R]=l.useState(!1),[F,T]=l.useState(null),[j,E]=l.useState({}),[V,W]=l.useState(!1),[B,M]=l.useState(!1),A=(pe=[],O)=>{if(!O||!pe||!Array.isArray(pe))return"";const Ie=pe.find(Ee=>String(Ee.value)===String(O));if(Ie)return Ie.label||"";const ze=pe.find(Ee=>String(Ee.value).toLowerCase()===String(O).toLowerCase());if(ze)return ze.label||"";const xe=pe.find(Ee=>String(Ee.label).toLowerCase()===String(O).toLowerCase());return xe&&xe.label||""},L=pe=>{const O=URL.createObjectURL(pe),Ie=pe.type.startsWith("image/")?"image":"document";return{file:pe,url:O,type:Ie,isExisting:!1}},D=(pe,O)=>{const Ie=/\.(jpg|jpeg|png|gif|webp)$/i.test(pe)?"image":"document";return{url:pe,type:Ie,isExisting:!0,name:O}},I=pe=>{!pe.isExisting&&pe.url&&URL.revokeObjectURL(pe.url)},H=()=>{c&&!c.isExisting&&I(c),p.forEach(pe=>{pe.isExisting||I(pe)})},h=pe=>{const O={};if(!pe)return O;if((ze=>{!ze||typeof ze!="object"||Object.keys(ze).forEach(xe=>{const Ee=ze[xe],Ke=(xe||"").toLowerCase().trim();Array.isArray(Ee)?O[Ke]=Ee:Ee&&typeof Ee=="object"&&Object.keys(Ee).forEach(Xe=>{const ye=Ee[Xe];Array.isArray(ye)&&(O[(Xe||"").toLowerCase().trim()]=ye)})})})(pe),Object.keys(O).length===0)try{Object.keys(pe).forEach(ze=>{const xe=pe[ze];Array.isArray(xe)&&(O[ze.toLowerCase().trim()]=xe)})}catch{}return O},Y=async()=>{try{const pe=await Gt(["lead","common","property"]),O=h(pe);E(O);const ze=(O["lead source"]||O.lead||[]).find(xe=>xe.label&&String(xe.label).toLowerCase()==="website"||String(xe.value).toLowerCase()==="website");u(ze?xe=>({...xe,leadSource:String(ze.value)}):xe=>({...xe,leadSource:"Website"})),W(!0)}catch(pe){T(`Failed to load dropdown options: ${pe instanceof Error?pe.message:String(pe)}`)}};l.useEffect(()=>{if(s){if(T(null),y({}),Y(),r==="edit"&&n){const pe={salutation:n.salutation||"Mr",ownerName:n.ownerName||"",ownerPhone:n.ownerPhone||"",ownerWhatsapp:n.ownerWhatsapp||"",sameAsPhone:n.sameAsPhone??!1,ownerEmail:n.ownerEmail||"",ownerType:n.ownerType||"individual",seller:n.seller||"",propertyType:n.propertyType||"",propertySubtype:n.propertySubtype||"",unitType:n.unitType||"",wing:n.wing||"",unitNo:n.unitNo||"",furnishing:n.furnishing||"",parkingType:n.parkingType||"",parkingQty:n.parkingQty||"",city:n.city||"",location:n.location||"",society:n.society||"",floor:n.floor||"",totalFloors:n.totalFloors||"",carpetArea:n.carpetArea||"",builtupArea:n.builtupArea||"",budget:n.budget||"",address:n.address||"",status:n.status||"",leadSource:n.leadSource||"",possessionMonth:n.possessionMonth||String(b),possessionYear:n.possessionYear||String(g),purchaseMonth:n.purchaseMonth||String(b),purchaseYear:n.purchaseYear||String(g),sellingRights:n.sellingRights||"Standard",amenities:(n.amenities||[]).map(String),furnishingItems:(n.furnishingItems||[]).map(String),description:n.description||"",nearby_places:n.nearby_places||[],ownershipDoc:null,photos:[],ownershipDocUrl:n.existingOwnershipDocUrl,photoUrls:(n.existingPhotos||[]).map(Ie=>Ie.url),bedrooms:n.bedrooms||"",bathrooms:n.bathrooms||"",facing:n.facing||"",priceType:n.priceType||"Fixed",finalPrice:n.finalPrice||""};u(pe),n.existingOwnershipDocUrl?f(D(n.existingOwnershipDocUrl,n.existingOwnershipDocName||"Ownership Document")):f(null);const O=(n.existingPhotos||[]).map(Ie=>D(Ie.url,Ie.name||"Photo"));N(O)}else u(pe=>({...pe,possessionMonth:String(b),possessionYear:String(g),purchaseMonth:String(b),purchaseYear:String(g),sellingRights:"Standard",sameAsPhone:!1})),f(null),N([]);return v(1),()=>{H(),f(null),N([])}}},[s,r,n]);const K=()=>{const pe=[];if(x.wing&&x.wing.trim()&&pe.push(`Wing ${x.wing.trim()}`),x.unitNo&&x.unitNo.trim()&&pe.push(`Unit No ${x.unitNo.trim()}`),x.society&&j.society){const O=A(j.society,x.society);O&&pe.push(O)}if(x.floor&&j.floor){const O=A(j.floor,x.floor);O&&pe.push(O.toLowerCase().includes("floor")?O:`${O} Floor`)}if(x.location&&j.location){const O=A(j.location,x.location);O&&pe.push(O)}if(x.city&&j.city){const O=A(j.city,x.city);O&&pe.push(O)}return pe.join(", ")};l.useEffect(()=>{if(!s||r!=="create"||Object.keys(j).length===0)return;const pe=K();pe&&u(O=>({...O,address:pe}))},[s,r,x.wing,x.unitNo,x.society,x.floor,x.location,x.city,j]);const q=pe=>{const{name:O,value:Ie,type:ze}=pe.target,xe=pe.target.checked,Ee=ze==="checkbox"?xe:Ie;u(Ke=>{const Xe={...Ke,[O]:Ee};return O==="sameAsPhone"&&Ee===!0&&(Xe.ownerWhatsapp=Xe.ownerPhone),O==="ownerPhone"&&Ke.sameAsPhone&&(Xe.ownerWhatsapp=Ie),Xe}),$[O]&&y(Ke=>({...Ke,[O]:""}))},ne=pe=>O=>{pe==="leadSource"&&V||(u(Ie=>({...Ie,[pe]:O})),$[pe]&&y(Ie=>({...Ie,[pe]:""})))},le=(pe,O)=>{u(Ie=>({...Ie,[pe]:O})),$[pe]&&y(Ie=>({...Ie,[pe]:""}))},S=pe=>{u(O=>{const ze=O.amenities.map(String).includes(String(pe))?O.amenities.filter(xe=>String(xe)!==String(pe)):[...O.amenities.map(String),String(pe)];return{...O,amenities:ze}})},C=pe=>{u(O=>{const ze=O.furnishingItems.map(String).includes(String(pe))?O.furnishingItems.filter(xe=>String(xe)!==String(pe)):[...O.furnishingItems.map(String),String(pe)];return{...O,furnishingItems:ze}})},J=(pe,O)=>{w(Ie=>({...Ie,[pe]:O}))},ue=()=>{const{name:pe,distance:O,unit:Ie,type:ze}=P;if(!pe||!O||!Ie||!ze)return;const xe=A(j["place name"]||[],pe)||pe,Ee=A(j["place type"]||[],ze)||ze;u(Ke=>({...Ke,nearby_places:[...Ke.nearby_places,{name:xe,distance:O,unit:Ie,type:Ee}]})),w({name:"",distance:"",unit:"",type:""})},Q=pe=>{u(O=>({...O,nearby_places:O.nearby_places.filter((Ie,ze)=>ze!==pe)}))},he=pe=>{if(c&&!c.isExisting&&I(c),pe){const O=L(pe);f(O),u(Ie=>({...Ie,ownershipDoc:pe}))}else f(null),u(O=>({...O,ownershipDoc:null}))},se=pe=>{const O=p.filter(ze=>ze.isExisting),Ie=pe.map(L);N([...O,...Ie]),u(ze=>({...ze,photos:[...ze.photos||[],...pe]}))},ge=()=>{c&&!c.isExisting&&I(c),f(null),u(pe=>({...pe,ownershipDoc:null}))},ee=pe=>{const O=[...p],Ie=O.splice(pe,1)[0];Ie&&!Ie.isExisting&&I(Ie),N(O);const ze=O.filter(xe=>!xe.isExisting&&xe.file).map(xe=>xe.file);u(xe=>({...xe,photos:ze}))},de=(pe="")=>pe.replace(/\D/g,""),U=(pe="")=>{const O=de(pe);return O?O.length===10?`+91${O}`:O.startsWith("91")&&O.length===12?`+${O}`:O.startsWith("0")&&O.length===11?`+91${O.slice(1)}`:pe.startsWith("+")?pe:`+${O}`:""},X=pe=>{const O=pe.startsWith("+")?pe:pe.startsWith("91")?`+${pe}`:pe.length===10?`+91${pe}`:pe;u(Ie=>{const ze={...Ie,ownerPhone:O};return Ie.sameAsPhone&&(ze.ownerWhatsapp=O),ze}),$.ownerPhone&&y(Ie=>({...Ie,ownerPhone:""}))},re=pe=>{const O=pe.startsWith("+")?pe:pe.startsWith("91")?`+${pe}`:pe.length===10?`+91${pe}`:pe;u(Ie=>({...Ie,ownerWhatsapp:O})),$.ownerWhatsapp&&y(Ie=>({...Ie,ownerWhatsapp:""}))},fe=pe=>{u(O=>{const Ie=O[pe]||"",ze=U(Ie);return pe==="ownerPhone"&&O.sameAsPhone?{...O,ownerPhone:ze,ownerWhatsapp:ze}:{...O,[pe]:ze}})},G=(pe=!1)=>{const O={};return(!x.ownerPhone||de(x.ownerPhone).length<10)&&(O.ownerPhone="Please enter a valid phone number"),pe&&(!x.ownerWhatsapp||de(x.ownerWhatsapp).length<10)&&(O.ownerWhatsapp="Please enter a valid WhatsApp number"),y(Ie=>({...Ie,...O})),Object.keys(O).length===0},me=()=>{const pe={};return x.ownerName||(pe.ownerName="Owner name is required"),x.ownerPhone||(pe.ownerPhone="Owner phone is required"),x.ownerEmail||(pe.ownerEmail="Owner email is required"),x.propertyType||(pe.propertyType="Property type is required"),x.propertySubtype||(pe.propertySubtype="Property subtype is required"),x.city||(pe.city="City is required"),x.location||(pe.location="Location is required"),x.society||(pe.society="Society is required"),x.carpetArea||(pe.carpetArea="Carpet area is required"),x.budget||(pe.budget="Budget is required"),y(pe),Object.keys(pe).length===0},oe=async pe=>{var O;try{if(st!=null&&st.createSeller)return await st.createSeller(pe);if(st!=null&&st.create)return await st.create(pe);if(As!=null&&As.createSeller)return await As.createSeller(pe);const Ie=await fetch("/api/sellers",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(pe)});if(!Ie.ok){const xe=await Ie.text();throw console.error("API error response:",{status:Ie.status,statusText:Ie.statusText,body:xe}),new Error(`HTTP ${Ie.status}: ${xe||Ie.statusText}`)}return await Ie.json()}catch(Ie){if(console.error("Error in createSellerSafe:",Ie),Ie.name==="TypeError"&&Ie.message.includes("fetch"))throw new Error("Network error: Unable to connect to seller API");if(Ie.response){const ze=((O=Ie.response.data)==null?void 0:O.message)||Ie.response.statusText||"Unknown API error";throw new Error(`API Error: ${ze}`)}throw new Error(Ie.message||"Unknown error creating seller")}},Fe=pe=>{var Ie,ze,xe,Ee,Ke;if(!pe)return console.warn("extractIdFromResponse: No response object provided"),null;const O=[pe.id,pe._id,pe.seller_id,pe.sellerId,(Ie=pe.data)==null?void 0:Ie.id,(ze=pe.data)==null?void 0:ze._id,(xe=pe.data)==null?void 0:xe.seller_id,(Ee=pe.result)==null?void 0:Ee.id,(Ke=pe.result)==null?void 0:Ke._id];for(const Xe of O)if(Xe!=null)return String(Xe);return console.warn("No ID found in response object:",pe),null},$e=()=>{const pe=new FormData;["salutation","ownerName","ownerPhone","ownerWhatsapp","ownerEmail","ownerType","seller","propertyType","propertySubtype","unitType","wing","unitNo","furnishing","parkingType","parkingQty","city","location","society","floor","totalFloors","carpetArea","builtupArea","budget","address","status","leadSource","possessionMonth","possessionYear","purchaseMonth","purchaseYear","sellingRights","description","bedrooms","bathrooms","facing","priceType","finalPrice"].forEach(Ee=>pe.append(Ee,String(x[Ee]??"")));const Ie=j.society||[],xe=A(Ie,x.society)||x.society||"";if(pe.append("society_name",xe),pe.append("sameAsPhone",String(x.sameAsPhone??!0)),pe.append("amenities",JSON.stringify(x.amenities||[])),pe.append("furnishingItems",JSON.stringify(x.furnishingItems||[])),pe.append("nearby_places",JSON.stringify(x.nearby_places||[])),r==="edit"){const Ee=p.filter(Ke=>Ke.isExisting).map(Ke=>Ke.url);pe.append("existingPhotoUrls",JSON.stringify(Ee)),c!=null&&c.isExisting&&pe.append("existingOwnershipDocUrl",c.url)}x.ownershipDoc&&pe.append("ownershipDoc",x.ownershipDoc,x.ownershipDoc.name),(x.photos||[]).forEach(Ee=>{Ee&&pe.append("photos",Ee,Ee.name)});for(let[Ee,Ke]of pe.entries());return pe};l.useEffect(()=>{if(!s||r!=="create")return;const pe=`${x.salutation||""} ${x.ownerName||""}`.trim();u(O=>({...O,seller:pe}))},[x.salutation,x.ownerName,s,r]),l.useEffect(()=>{if(!s||r!=="create")return;const pe=`${x.salutation||""} ${x.ownerName||""}`.trim();(!x.seller||x.seller.trim()==="")&&u(O=>({...O,seller:pe}))},[x.salutation,x.ownerName,s,r]);const Le=async()=>{var pe,O,Ie,ze;if(!me()){v(2);return}if(G())try{R(!0),T(null);let xe;if(r==="edit"&&i){const Ee=$e();xe=await As.updateProperty(String(i),Ee),Z.success("Property updated successfully")}else{let Ee=null,Ke="";if(x.ownerName&&x.ownerName.trim()&&(x.ownerEmail||x.ownerPhone))try{const Ce={salutation:x.salutation,name:x.ownerName,email:x.ownerEmail,phone:x.ownerPhone,whatsapp:x.ownerWhatsapp},_=await oe(Ce);Ee=Fe(_),Ke=`${x.salutation?x.salutation+" ":""}${x.ownerName}`.trim()}catch(Ce){Z.error("Failed to create seller: "+(Ce.message||"unknown")),R(!1);return}const ye=$e();Ee&&(ye.append("seller_id",String(Ee)),ye.append("seller_name",Ke));try{xe=await As.createProperty(ye),Ee&&(xe={...xe,seller_id:Ee,seller_name:Ke})}catch(Ce){console.error("Property creation failed:",Ce);const _=((O=(pe=Ce==null?void 0:Ce.response)==null?void 0:pe.data)==null?void 0:O.message)||(Ce==null?void 0:Ce.message)||"Failed to create property";T(_),Z.error(_);return}}if(M(!0),typeof t=="function")try{t(xe)}catch(Ee){console.error("onSubmit handler threw:",Ee)}else console.warn("PublicSellPropertyForm: onSubmit not provided; skipping callback.")}catch(xe){console.error("Unexpected error in handleSubmit:",xe);const Ee=((ze=(Ie=xe==null?void 0:xe.response)==null?void 0:Ie.data)==null?void 0:ze.message)||(xe==null?void 0:xe.message)||`Failed to ${r==="edit"?"update":"create"} property`;T(Ee),Z.error(Ee)}finally{R(!1)}},je=pe=>{if(!pe)return[];const O=pe.toLowerCase().trim();if(j[pe])return j[pe];if(j[O])return j[O];for(const Ie in j){if(!Array.isArray(j[Ie]))continue;if(Ie.toLowerCase().includes(O))return j[Ie];const ze=j[Ie];if(ze.find(Ee=>Ee.label&&Ee.label.toLowerCase().includes(O)||String(Ee.value).toLowerCase().includes(O)))return ze}return[]},_e=r==="edit"?"Edit Property":d===1?"Owner Details":"Sell Your Property",ve=r==="edit"?"Update Property":"Submit Property",Pe=r==="edit"?ft:fs;if(!s)return null;const We=e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Owner Information"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Step 1 of 2"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salutation"}),e.jsxs("select",{name:"salutation",value:x.salutation||"",onChange:q,className:"border border-gray-300 rounded w-full h-8 px-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Mr",children:"Mr"}),e.jsx("option",{value:"Ms",children:"Ms"}),e.jsx("option",{value:"Mrs",children:"Mrs"}),e.jsx("option",{value:"Dr",children:"Dr"}),e.jsx("option",{value:"Mx",children:"Mx"})]})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"ownerName",value:x.ownerName||"",onChange:pe=>{const O=pe.target.value.replace(/[0-9]/g,"");q({target:{name:"ownerName",value:O}})},placeholder:"Enter your full name",className:"border border-gray-300 rounded w-full h-8 px-2 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",required:!0}),$.ownerName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.ownerName})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"ownerEmail",value:x.ownerEmail||"",onChange:q,placeholder:"your.email@example.com",className:"border px-2 border-gray-300 rounded w-full h-8 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",required:!0}),$.ownerEmail&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.ownerEmail})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(qn,{country:"in",value:x.ownerPhone||"",onChange:pe=>X(String(pe||"")),onBlur:()=>fe("ownerPhone"),inputClass:"!w-full !h-8 !rounded !border-gray-300 !text-xs focus:!ring-1 focus:!ring-blue-500 focus:!border-transparent",containerClass:"!w-full",inputProps:{name:"ownerPhone",required:!0,autoFocus:!1}}),$.ownerPhone&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.ownerPhone})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1 flex items-center gap-2",children:[e.jsx(Ia,{className:"text-green-500"})," WhatsApp Number",e.jsx("div",{className:"ml-auto flex items-center",children:e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.sameAsPhone,onChange:pe=>{const O=pe.target.checked;u(Ie=>({...Ie,sameAsPhone:O,ownerWhatsapp:O?Ie.ownerPhone:Ie.ownerWhatsapp})),O&&$.ownerWhatsapp&&y(Ie=>({...Ie,ownerWhatsapp:""}))},className:"sr-only"}),e.jsx("div",{className:`w-8 h-3 rounded-full relative transition-colors duration-200 ease-in-out ${x.sameAsPhone?"bg-[#E6761D]":"bg-gray-300"}`,children:e.jsx("div",{className:`absolute top-0.5 left-0.5 bg-white w-2 h-2 rounded-full transition-transform duration-200 ease-in-out ${x.sameAsPhone?"translate-x-5":"translate-x-0"}`})}),e.jsx("span",{className:"ml-2 text-xs text-gray-600",children:x.sameAsPhone?"Same as phone":"Different (optional)"})]})})]}),e.jsx("input",{type:"tel",name:"ownerWhatsapp",value:x.sameAsPhone?x.ownerPhone||"":x.ownerWhatsapp||"",onChange:pe=>re(pe.target.value),onBlur:()=>fe("ownerWhatsapp"),disabled:x.sameAsPhone,placeholder:"WhatsApp (optional)",maxLength:10,className:`border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent ${x.sameAsPhone?"bg-gray-100":""}`}),$.ownerWhatsapp&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.ownerWhatsapp})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(ss,{variant:"outline",onClick:()=>{try{a()}catch{}},children:"Cancel"}),e.jsxs(ss,{onClick:()=>{const pe={};x.ownerName||(pe.ownerName="Owner name is required"),x.ownerEmail||(pe.ownerEmail="Owner email is required"),x.ownerPhone||(pe.ownerPhone="Owner phone is required"),y(pe),Object.keys(pe).length===0&&(fe("ownerPhone"),x.sameAsPhone&&fe("ownerWhatsapp"),v(2))},className:"bg-[#E6761D] hover:bg-[#CC6A1A] text-white font-semibold transition-all",children:["Next",e.jsx(la,{className:"h-4 w-4 ml-2 inline"})]})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(ma,{isOpen:s,onClose:a,title:_e,subtitle:e.jsxs(e.Fragment,{children:[e.jsx(la,{size:18,className:"mr-1 inline"}),e.jsx("span",{children:d===1?"Provide owner contact details":"Owner Information â€¢ Property details"})]}),width:"max-w-[95vw] md:max-w-4xl lg:max-w-5xl",children:e.jsxs("div",{className:"space-y-6 relative",children:[k&&e.jsxs("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-20",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-3 text-sm",children:r==="edit"?"Updating...":"Saving..."})]}),F&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 text-red-700 p-3 rounded",children:F}),d===1?We:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:x.ownerName||"â€”"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[x.ownerEmail?e.jsxs("span",{children:[x.ownerEmail," â€¢ "]}):null,x.ownerPhone?e.jsx("span",{children:x.ownerPhone}):null,x.sameAsPhone?e.jsx("span",{className:"ml-2 text-xs text-green-600",children:"WhatsApp same as phone"}):x.ownerWhatsapp?e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["WhatsApp: ",x.ownerWhatsapp]}):e.jsx("span",{className:"ml-2 text-xs text-gray-400",children:"WhatsApp: not provided"})]})]}),e.jsx("div",{children:e.jsx(ss,{variant:"outline",onClick:()=>v(1),children:"Edit Owner"})})]}),e.jsx("div",{className:Qp,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:Lt,children:["Property Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Kt,{placeholder:"Select Property Type",options:je("property type"),value:x.propertyType,onChange:ne("propertyType"),className:"w-full"}),$.propertyType&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.propertyType})]}),e.jsxs("div",{children:[e.jsxs("label",{className:Lt,children:["Property Subtype ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Kt,{placeholder:"Select Property Subtype",options:je("property subtype"),value:x.propertySubtype,onChange:ne("propertySubtype"),className:"w-full"}),$.propertySubtype&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.propertySubtype})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Unit Type"}),e.jsx(Kt,{placeholder:"Select Unit Type",options:je("unit type"),value:x.unitType,onChange:ne("unitType"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Wing"}),e.jsx("input",{type:"text",placeholder:"Wing name/number",value:x.wing,onChange:pe=>le("wing",pe.target.value),className:yc})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Unit No"}),e.jsx("input",{type:"text",placeholder:"Unit/Flat no",value:x.unitNo,onChange:pe=>le("unitNo",pe.target.value),className:yc})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Furnishing"}),e.jsx(Kt,{placeholder:"Select Furnishing",options:je("furnishing"),value:x.furnishing,onChange:ne("furnishing"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Parking Type"}),e.jsx(Kt,{placeholder:"Select Parking Type",options:je("parking type"),value:x.parkingType,onChange:ne("parkingType"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bedrooms"}),e.jsx(Kt,{placeholder:"Select Bedrooms",options:je("bedrooms"),value:x.bedrooms,onChange:ne("bedrooms"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bathrooms"}),e.jsx(Kt,{placeholder:"Select Bathrooms",options:je("bathrooms"),value:x.bathrooms,onChange:ne("bathrooms"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Facing"}),e.jsx(Kt,{placeholder:"Select Facing",options:je("facing"),value:x.facing,onChange:ne("facing"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Parking Qty"}),e.jsx(Kt,{placeholder:"Select Parking Quantity",options:je("parking qty"),value:x.parkingQty,onChange:ne("parkingQty"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:Lt,children:["City ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Kt,{placeholder:"Select City",options:je("city"),value:x.city,onChange:ne("city"),className:"w-full"}),$.city&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.city})]}),e.jsxs("div",{children:[e.jsxs("label",{className:Lt,children:["Location ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Kt,{placeholder:"Select Location",options:je("location"),value:x.location,onChange:ne("location"),className:"w-full"}),$.location&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.location})]}),e.jsxs("div",{children:[e.jsxs("label",{className:Lt,children:["Society Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Kt,{placeholder:"Select Society",options:je("society"),value:x.society,onChange:ne("society"),className:"w-full"}),$.society&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.society})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Total Floors"}),e.jsx(Kt,{placeholder:"Select Total Floors",options:je("total floors"),value:x.totalFloors,onChange:ne("totalFloors"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Floor"}),e.jsx(Kt,{placeholder:"Select Floor",options:je("floor"),value:x.floor,onChange:ne("floor"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Carpet Area (sq.ft)*"}),e.jsx("input",{type:"text",placeholder:"Enter carpet area",value:x.carpetArea,onChange:pe=>{const O=pe.target.value;(/^\d*\.?\d*$/.test(O)||O==="")&&le("carpetArea",O)},className:`w-full px-3 py-2 border rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent ${$.carpetArea?"border-red-500":"border-gray-300"}`}),$.carpetArea&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.carpetArea})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Builtup Area (sq.ft) (optional)"}),e.jsx("input",{type:"text",placeholder:"Enter builtup area",value:x.builtupArea,onChange:pe=>{const O=pe.target.value;(/^\d*\.?\d*$/.test(O)||O==="")&&le("builtupArea",O)},className:"w-full px-3 py-2 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Property Status"}),e.jsx(Kt,{placeholder:"Select Status",options:je("property status"),value:x.status,onChange:ne("status"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Lead Source"}),V?e.jsxs("div",{children:[e.jsx(Kt,{placeholder:"Lead Source",options:je("lead source"),value:x.leadSource,onChange:ne("leadSource"),className:"w-full opacity-70 cursor-not-allowed",disabled:!0}),e.jsx("input",{type:"hidden",name:"leadSource",value:x.leadSource})]}):e.jsx(Kt,{placeholder:"Select Lead Source",options:je("lead source"),value:x.leadSource,onChange:ne("leadSource"),className:"w-full"})]}),e.jsx("div",{children:e.jsx(Ld,{title:"Purchase Month & Year",possessionMonth:x.purchaseMonth,possessionYear:x.purchaseYear,onMonthChange:pe=>le("purchaseMonth",pe),onYearChange:pe=>le("purchaseYear",pe)})}),e.jsx("div",{children:e.jsx(Ld,{title:"Possession Month & Year",possessionMonth:x.possessionMonth,possessionYear:x.possessionYear,onMonthChange:pe=>le("possessionMonth",pe),onYearChange:pe=>le("possessionYear",pe)})}),e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Selling Rights"}),e.jsx(Kt,{placeholder:"Select Selling Rights",options:je("selling rights"),value:x.sellingRights,onChange:ne("sellingRights"),className:"w-full"})]}),e.jsxs("div",{className:"md:col-span-3 lg:col-span-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("label",{className:"block text-xs font-semibold text-gray-800 bt-8",children:"Sell Price (â‚¹)*"})}),e.jsx(ld,{initialMax:Kp(jo(x.budget)),max:10,onChange:({max:pe})=>{const O=Math.round(pe*1e7);le("budget",String(O)),x.priceType==="Negotiable"&&le("finalPrice",String(O))},className:"p-0 mt-1"}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("label",{className:"inline-flex items-center gap-1.5 text-xs font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",name:"priceType",className:"h-3 w-3 text-orange-600 rounded focus:ring-orange-500",value:"Fixed",checked:(x.priceType||"Fixed")==="Fixed",onChange:()=>le("priceType","Fixed")}),"Fixed"]}),e.jsxs("label",{className:"inline-flex items-center gap-1.5 text-xs font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",name:"priceType",className:"h-3 w-3 text-orange-600 rounded focus:ring-orange-500",value:"Negotiable",checked:x.priceType==="Negotiable",onChange:()=>le("priceType","Negotiable")}),"Negotiable"]})]}),x.priceType==="Negotiable"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Final Price (â‚¹)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",className:"w-40 md:w-48 border rounded px-2 py-1.5 text-sm outline-none",value:x.finalPrice||"",onChange:pe=>{le("finalPrice",pe.target.value)},onBlur:pe=>{const O=jo(pe.target.value);le("finalPrice",String(O))},placeholder:"e.g. 45,00,000","aria-label":"Final negotiated price"}),e.jsx("span",{className:"text-[11px] text-green-800 whitespace-nowrap",children:(()=>{const pe=jo(x.finalPrice||"");return!pe||pe<=0?"":pe<1e7?`${Math.round(pe/1e5)}L`:`${(pe/1e7).toFixed(pe%1e7?2:0)}Cr`})()})]})]}),$.budget&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:$.budget})]}),e.jsxs("div",{className:"",children:[e.jsx(Ed,{label:"Amenities",options:je("amenities"),selectedValues:x.amenities,onToggle:S,placeholder:"Select amenities..."}),x.amenities.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:x.amenities.map(pe=>{const O=je("amenities").find(Ie=>String(Ie.value)===String(pe));return e.jsxs("span",{className:"flex items-center bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-[10px]",children:[(O==null?void 0:O.label)||pe,e.jsx("button",{type:"button",onClick:()=>S(String(pe)),className:"ml-1 text-purple-500 hover:text-purple-700",children:"Ã—"})]},String(pe))})})]}),e.jsxs("div",{className:"w-full z-40",children:[e.jsx(Ed,{label:"Furnishing Items",options:je("furnishing items"),selectedValues:x.furnishingItems,onToggle:C,placeholder:"Select furnishing items..."}),x.furnishingItems.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:x.furnishingItems.map(pe=>{const O=je("furnishing items").find(Ie=>String(Ie.value)===String(pe));return e.jsxs("span",{className:"flex items-center bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-[10px]",children:[(O==null?void 0:O.label)||pe,e.jsx("button",{type:"button",onClick:()=>C(String(pe)),className:"ml-1 text-purple-500 hover:text-purple-700",children:"Ã—"})]},String(pe))})})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-2",children:[e.jsx("label",{className:Lt,children:"Address"}),e.jsx("textarea",{placeholder:"Auto-filled based on selections (editable)",value:x.address,onChange:pe=>le("address",pe.target.value),rows:3,className:"w-full px-3 py-2 rounded-lg border border-gray-200 text-sm focus:ring-2 focus:ring-blue-500 bg-gray-50"})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Nearby Places"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 md:col-span-4",children:[e.jsx("label",{className:Lt,children:"Place Name"}),e.jsx(Kt,{placeholder:"Select Place",options:je("place name"),value:P.name,onChange:pe=>J("name",pe),className:"w-full"})]}),e.jsxs("div",{className:"col-span-6 md:col-span-2",children:[e.jsx("label",{className:Lt,children:"Distance"}),e.jsx("input",{type:"text",className:"w-full h-10 px-3 rounded-lg border border-gray-200 text-sm focus:ring-2 focus:ring-blue-500",placeholder:"Enter distance",value:P.distance,onChange:pe=>J("distance",pe.target.value)})]}),e.jsxs("div",{className:"col-span-6 md:col-span-2",children:[e.jsx("label",{className:Lt,children:"Unit"}),e.jsxs("select",{className:"w-full h-10 px-3 rounded-lg border border-gray-200 text-sm focus:ring-2 focus:ring-blue-500",value:P.unit,onChange:pe=>J("unit",pe.target.value),children:[e.jsx("option",{value:"",children:"Select Unit"}),e.jsx("option",{value:"km",children:"km"}),e.jsx("option",{value:"m",children:"m"}),e.jsx("option",{value:"min",children:"min"})]})]}),e.jsxs("div",{className:"col-span-12 md:col-span-3",children:[e.jsx("label",{className:Lt,children:"Place Type"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Kt,{placeholder:"Select",options:je("place type"),value:P.type,onChange:pe=>J("type",pe),className:"flex-1"}),e.jsx("button",{type:"button",onClick:ue,className:"h-10 px-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300",disabled:!P.name||!P.distance||!P.unit||!P.type,title:"Add place",children:e.jsx(fs,{size:16})})]})]})]}),e.jsx("div",{className:"space-y-2",children:x.nearby_places.length===0?e.jsx("div",{className:"text-sm text-gray-500 italic p-3 bg-gray-50 rounded",children:"No nearby places added yet. Fill the form above and click + to add places."}):x.nearby_places.map((pe,O)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium text-blue-600",children:pe.name}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",pe.distance," ",pe.unit,")"]}),e.jsx("span",{className:"text-green-600 ml-2 capitalize",children:pe.type})]}),e.jsx("button",{type:"button",onClick:()=>Q(O),className:"text-red-600 hover:text-red-800 transition-colors",title:"Remove",children:e.jsx(Es,{size:16})})]},O))})]})]}),e.jsx("div",{className:"md:col-span-2 lg:col-span-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Ownership Doc (PDF/JPG/PNG)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center hover:border-gray-300 transition-colors bg-white",children:[e.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:pe=>{var O;return he(((O=pe.target.files)==null?void 0:O[0])||null)},className:"hidden",id:"ownership-doc"}),e.jsxs("label",{htmlFor:"ownership-doc",className:"cursor-pointer",children:[e.jsx(dt,{className:"h-5 w-5 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Choose Document"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG up to 10MB"})]})]})]}),c&&e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Document Preview"}),e.jsx(Md,{preview:c,onRemove:ge})]})]})}),e.jsx("div",{className:"md:col-span-2 lg:col-span-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:Lt,children:"Property Photos (JPG/PNG, Multiple)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center hover:border-gray-300 transition-colors bg-white",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png",multiple:!0,onChange:pe=>{const O=Array.from(pe.target.files||[]);O.length>0&&se(O)},className:"hidden",id:"property-photos"}),e.jsxs("label",{htmlFor:"property-photos",className:"cursor-pointer",children:[e.jsx(dt,{className:"h-5 w-5 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:p.length>0?"Add More Photos":"Choose Photos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG up to 5MB each"})]})]})]}),p.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:Lt,children:["Photos Preview (",p.length," files)"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 max-h-56 overflow-y-auto",children:p.map((pe,O)=>e.jsx(Md,{preview:pe,onRemove:()=>ee(O)},O))})]})]})})]})}),e.jsxs("div",{className:"space-y-2 p-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Description"}),e.jsx("div",{className:"relative",children:e.jsx("textarea",{value:x.description||"",onChange:pe=>u(O=>({...O,description:pe.target.value})),className:"w-full px-3 py-3 pr-32 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[160px]",placeholder:"Additional property details, special features, etc."})})]}),e.jsxs("div",{className:"flex justify-between space-x-4 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ss,{variant:"outline",onClick:()=>v(1),disabled:k,children:"Back"}),e.jsx(ss,{variant:"outline",onClick:()=>{v(1)},children:"Edit Owner"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ss,{variant:"outline",onClick:a,disabled:k,children:"Cancel"}),e.jsxs(ss,{onClick:Le,disabled:k,className:"bg-[#E6761D] hover:bg-[#CC6A1A] text-white font-semibold transition-all",children:[Ps.createElement(Pe,{className:"h-4 w-4 mr-2"}),ve]})]})]})]})]})}),B&&typeof document<"u"&&Il.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[999999] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/70 to-purple-600/70 backdrop-blur-sm"}),e.jsxs("div",{className:"relative bg-gradient-to-br from-white via-blue-50 to-purple-50 rounded-2xl shadow-2xl p-8 max-w-md w-full text-center animate-fadeInUp border border-blue-100",children:[e.jsx("div",{className:"flex items-center justify-center w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-r from-green-400 to-green-600 shadow-lg",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-3xl font-extrabold text-gray-900 mb-3",children:"ðŸŽ‰ Thank you!"}),e.jsxs("p",{className:"text-gray-700 mb-6 leading-relaxed",children:["Your property details have been ",e.jsx("span",{className:"font-semibold text-blue-600",children:"submitted successfully"}),". Our executive will contact you soon."]}),e.jsx("button",{onClick:()=>{M(!1);try{a==null||a()}catch{}},className:"px-6 py-2.5 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold shadow hover:from-blue-600 hover:to-purple-700 focus:ring-2 focus:ring-purple-400 focus:outline-none transition",children:"Close"})]})]}),document.body)]})},Xp={primary:"#E6761D"},gn=({children:s})=>e.jsxs("li",{className:"flex items-start gap-3 p-3 rounded-xl border border-gray-100 hover:border-gray-200 hover:shadow-sm transition",children:[e.jsx($l,{className:"w-5 h-5 shrink-0 mt-0.5 text-[#E6761D]"}),e.jsx("span",{className:"text-gray-800 text-sm sm:text-base",children:s})]}),e0=({open:s,onClose:a,onFreeValuation:t})=>e.jsx(ma,{isOpen:s,onClose:a,title:"Why Sell with Resale Expert?",width:"max-w-[95vw] md:max-w-2xl lg:max-w-5xl",children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative p-6 sm:p-8",style:{background:"radial-gradient(120% 120% at 10% 0%, #FFE7D3 0%, #FFF6EF 45%, white 100%)"},children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold",children:"Sell Faster. Sell Smarter."}),e.jsx("p",{className:"text-black text-sm sm:text-base mt-1",children:"We combine data-driven pricing, verified demand, and full support to maximize your resale value."})]}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs(gn,{children:[e.jsx("strong",{children:"AI-Based Valuation:"})," Get an accurate resale price instantly."]}),e.jsxs(gn,{children:[e.jsx("strong",{children:"Verified Buyers Only:"})," Serious buyers, no time-wasters."]}),e.jsxs(gn,{children:[e.jsx("strong",{children:"Zero Listing Fees:"})," List your property free of cost."]}),e.jsxs(gn,{children:[e.jsx("strong",{children:"Full Support:"})," From paperwork to home loan assistance."]}),e.jsxs(gn,{children:[e.jsx("strong",{children:"Trusted Experts:"})," Puneâ€™s leading resale property advisors."]})]}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:()=>{a(),t()},className:"px-2 py-2 rounded-lg text-white font-medium shadow-sm hover:shadow focus:outline-none focus:ring-2 transition",style:{backgroundColor:Xp.primary},children:"Get Free Valuation"}),e.jsx("button",{onClick:a,className:"px-2 py-2 rounded-lg border border-gray-300 text-gray-800 font-medium hover:bg-gray-50 transition",children:"Maybe Later"})]}),e.jsx("div",{className:"mt-4 text-xs text-gray-500",children:"*No spam. No hidden charges. Just expert guidance tailored to you."})]})}),s0=s=>{const a=Array.isArray(s==null?void 0:s.tags)?s.tags.map(t=>String(t).trim().toLowerCase()):[];return(s==null?void 0:s.featured)===!0||(s==null?void 0:s.is_featured)===!0||(s==null?void 0:s.isFeatured)===!0||(s==null?void 0:s.badge)==="Premium"||a.includes("featured")};function hn(s){const a=(s==null?void 0:s.id)??(s==null?void 0:s.ID)??(s==null?void 0:s._id)??(s==null?void 0:s.uuid),t=(s==null?void 0:s.created_at)??(s==null?void 0:s.createdAt)??(s==null?void 0:s.created_on)??"",r=(s==null?void 0:s.updated_at)??(s==null?void 0:s.updatedAt)??(s==null?void 0:s.updated_on)??t??"";return{id:a,title:(s==null?void 0:s.title)??"",description:(s==null?void 0:s.description)??"",photos:Array.isArray(s==null?void 0:s.photos)?s.photos:[],created_at:t,updated_at:r}}function pn(s){return s?Array.isArray(s)?s:Array.isArray(s.rows)?s.rows:Array.isArray(s.data)?s.data:Array.isArray(s.items)?s.items:s.item?[s.item]:s.row?[s.row]:[]:[]}const Fr={async list(){const{data:s}=await Ae.get("/home-hero");return pn(s).map(hn)},async getById(s){const{data:a}=await Ae.get(`/home-hero/${s}`),t=pn(a);if(!t.length)throw new Error("Not found");return hn(t[0])},async create(s){const a=new FormData;a.append("title",s.title),a.append("description",s.description),(s.photos||[]).forEach((n,o)=>{n.file&&a.append("photos",n.file,n.name||`photo-${o}.jpg`)});const{data:t}=await Ae.post("/home-hero",a),i=pn(t)[0]??t.row??t.item??t;return hn(i)},async update(s,a){if(!Array.isArray(a.photos)){const{data:g}=await Ae.put(`/home-hero/${s}`,{title:a.title,description:a.description}),d=pn(g)[0]??g.row??g.item??g;return hn(d)}const r=new FormData;a.title!=null&&r.append("title",a.title),a.description!=null&&r.append("description",a.description);const i=[];(a.photos||[]).forEach((g,b)=>{g.file?r.append("photos",g.file,g.name||`photo-${b}.jpg`):i.push({url:g.url,name:g.name,size:g.size})}),r.append("existingPhotos",JSON.stringify(i));const{data:n}=await Ae.put(`/home-hero/${s}`,r),m=pn(n)[0]??n.row??n.item??n;return hn(m)},async remove(s){const{data:a}=await Ae.delete(`/home-hero/${s}`);return a}},vo={},t0=s=>{if(s==null)return;const a=Number(typeof s=="string"?s.replace(/[^\d.]/g,""):s);return Number.isFinite(a)?a:void 0},a0=s=>({...s,city:(s.city||"").trim(),locality:(s.locality||"").trim(),propertyType:(s.propertyType||"").trim(),unitType:(s.unitType||"").trim(),carpet_sqft:t0(s.carpet_sqft),floor:(s.floor??"").toString().trim()||void 0,parking:(s.parking??"").toString().trim()||void 0,age:(s.age??"").toString().trim()||void 0,amenities:Array.isArray(s.amenities)?s.amenities.filter(Boolean):[]}),Dd=s=>{var v;const a=s.city.toLowerCase().includes("mumbai")?28e3:s.city.toLowerCase().includes("pune")?12e3:s.city.toLowerCase().includes("bengaluru")?17e3:1e4,t=s.carpet_sqft??900,r=s.age==="0-2"?1.08:s.age==="3-5"?1.03:s.age==="6-10"?.97:s.age==="10+"?.92:1,i=Math.min(1.12,1+(((v=s.amenities)==null?void 0:v.length)||0)*.0075),n=Math.round(a*r*i),o=Math.round(n*t*.95),m=Math.round(n*t*1.05),g=new Date().toLocaleString("en-US",{month:"short",year:"numeric"}),b=[{society:"Sunshine Residency",distance_km:.8,month:g,price:Math.round(n*(t*.98))},{society:"Emerald Heights",distance_km:1.3,month:g,price:Math.round(n*(t*.95))},{society:"Skyline Enclave",distance_km:2.1,month:g,price:Math.round(n*(t*1.02))}],d=t>=1200?"High":t>=800?"Medium":"Low";return{low:o,high:m,ppsf:n,confidence:d,comps:b}};async function r0(s,a={}){var n,o;const t=a0(s),r=String((vo==null?void 0:vo.VITE_MOCK_VALUATION)||"").toLowerCase()==="true";if(!!(a.mock||r))return{success:!0,data:Dd(t)};try{const{data:m}=await Ae.post("/valuation/estimate",t);return m!=null&&m.success?m:{success:!1,error:(m==null?void 0:m.error)||"Could not estimate"}}catch(m){return r?{success:!0,data:Dd(t)}:{success:!1,error:((o=(n=m==null?void 0:m.response)==null?void 0:n.data)==null?void 0:o.error)||(m==null?void 0:m.message)||"Request failed"}}}const l0={estimate:r0},No=s=>typeof s=="number"?`â‚¹${s.toLocaleString("en-IN")}`:"-",n0=s=>!!s.fullName&&!!s.phone&&!!s.email&&!!s.type&&!!s.unitType&&!!s.society&&!!s.location&&!!s.carpet,i0=s=>/^\S+@\S+\.\S+$/.test(s),wo=s=>s.replace(/[^\d]/g,""),o0=({open:s,onClose:a,onListProperty:t})=>{const[r,i]=l.useState(1),[n,o]=l.useState(!1),[m,g]=l.useState(!0),[b,d]=l.useState({}),[v,x]=l.useState({fullName:"",phone:"",email:"",type:"",unitType:"",society:"",location:"",carpet:""}),[u,c]=l.useState(null);l.useEffect(()=>{s&&(i(1),c(null))},[s]);const f=w=>{const $={},y=k=>{!k||typeof k!="object"||Object.entries(k).forEach(([R,F])=>{Array.isArray(F)?$[String(R).toLowerCase()]=F:F&&typeof F=="object"&&y(F)})};return y(w),$};l.useEffect(()=>{if(!s)return;(async()=>{try{g(!0);const $=await Gt(["common","property"]),y=f($),k={"property type":y["property type"]||[],"unit type":y["unit type"]||[]};d(k)}catch{Z.error("Failed to load options")}finally{g(!1)}})()},[s]);const p=l.useMemo(()=>{const w=b["unit type"]||[];if(!v.type)return w;const $=w.filter(y=>y.label.toLowerCase().includes(v.type.toLowerCase()));return $.length?$:w},[b,v.type]),N=()=>{if(!n0(v))return Z.info("Please fill all required fields.");if(!i0(v.email))return Z.info("Please enter a valid email address.");if(wo(v.phone).length<10)return Z.info("Please enter a valid 10-digit phone number.");P()},P=async()=>{o(!0);try{const w={locality:v.location,propertyType:v.type,unitType:v.unitType,carpet_sqft:v.carpet?Number(v.carpet):void 0,contact:{name:v.fullName,phone:wo(v.phone),email:v.email},society:v.society},$=await l0.estimate(w),y=$.data??$;if(!y)throw new Error("Estimation failed");c(y),i(2)}catch(w){Z.error((w==null?void 0:w.message)||"Estimation failed")}finally{o(!1)}};return e.jsx(ma,{isOpen:s,onClose:a,title:"Free Instant Property Valuation",width:"max-w-[95vw] md:max-w-3xl lg:max-w-5xl",children:e.jsxs("div",{className:"text-gray-800 max-w-5xl w-full",children:[e.jsx("p",{className:"text-xs text-gray-500 -mt-2 mb-3",children:"AI-powered estimate in under 30 seconds"}),e.jsx("div",{className:"px-1 pt-1 mb-3",children:e.jsx("div",{className:"flex items-center justify-between text-sm",children:[{n:1,label:"Property Details"},{n:2,label:"Estimate"}].map((w,$)=>{const y=r===w.n,k=r>w.n;return e.jsxs("div",{className:"flex-1 flex items-center",children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full border text-xs mr-2 ${k?"bg-green-600 text-white border-green-600":y?"bg-[#E6761D] text-white border-[#E6761D]":"bg-white text-gray-600 border-gray-300"}`,children:w.n}),e.jsx("span",{className:`${y?"text-gray-900 font-medium":"text-gray-500"} mr-2`,children:w.label}),$===0&&e.jsx("div",{className:"flex-1 h-px bg-gray-200"})]},$)})})}),r===1&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Full Name *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",placeholder:"e.g. Kamlesh Shah",value:v.fullName,onChange:w=>x({...v,fullName:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Phone *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",inputMode:"numeric",placeholder:"e.g. 98XXXXXXXX",value:v.phone,onChange:w=>x({...v,phone:wo(w.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Email *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",type:"email",placeholder:"e.g. you@domain.com",value:v.email,onChange:w=>x({...v,email:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Property Type *"}),e.jsxs("select",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",value:v.type,onChange:w=>x({...v,type:w.target.value,unitType:""}),children:[e.jsx("option",{value:"",children:"Select"}),(b["property type"]||[]).map(w=>e.jsx("option",{value:w.value,children:w.label},w.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Unit Type *"}),e.jsxs("select",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",value:v.unitType,onChange:w=>x({...v,unitType:w.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),p.map(w=>e.jsx("option",{value:w.value,children:w.label},w.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Society *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",placeholder:"e.g. Kumar Primavera",value:v.society,onChange:w=>x({...v,society:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Location *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",placeholder:"e.g. Viman Nagar, Pune",value:v.location,onChange:w=>x({...v,location:w.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-800",children:"Carpet Area (sqft) *"}),e.jsx("input",{className:"w-full mt-1 border rounded-lg p-2 text-sm text-gray-800",inputMode:"numeric",placeholder:"e.g. 925",value:v.carpet,onChange:w=>x({...v,carpet:w.target.value.replace(/[^\d.]/g,"")})})]})]})}),r===2&&u&&e.jsx("div",{className:"space-y-5 text-gray-800",children:e.jsxs("div",{className:"bg-gray-50 border rounded-xl p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Estimated Price Range"}),e.jsxs("div",{className:"text-xl font-bold text-gray-800 mt-1",children:[No(u.low)," â€“ ",No(u.high)]}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Confidence: ",u.confidence]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Avg PPSF: ",No(u.ppsf)]})]})}),r===2&&!u&&n&&e.jsxs("div",{className:"flex items-center justify-center py-12 text-gray-600",children:[e.jsx(Kr,{className:"mr-2 h-4 w-4 animate-spin"})," Estimatingâ€¦"]}),e.jsxs("div",{className:"mt-6 border-t pt-3",children:[r===1&&e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"px-4 py-2 rounded-lg border text-gray-800",onClick:a,children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded-lg bg-[#E6761D] text-white",onClick:N,disabled:m||n,children:"Continue"})]}),r===2&&e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[e.jsx("button",{className:"border rounded-lg px-4 py-2 text-gray-800",onClick:t,children:"List My Property"}),e.jsx("button",{className:"bg-[#E6761D] text-white rounded-lg px-4 py-2",onClick:()=>Z.info("Generating detailed PDF reportâ€¦"),children:"Download Report (PDF)"}),e.jsx("button",{className:"border rounded-lg px-4 py-2 text-gray-800",onClick:()=>Z.success("Our executive will contact you."),children:"Schedule Visit"}),e.jsx("button",{className:"border rounded-lg px-4 py-2 text-gray-800",onClick:a,children:"Close"})]})]})]})})},c0=({tags:s})=>{if(!s||s.length===0)return null;const a=s.slice(0,2);return e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[a.map((t,r)=>{const i=Ea(t),n=typeof i.emoji=="string"?()=>e.jsx("span",{className:"text-xs mr-1 uppercase","aria-hidden":"true",children:i.emoji}):i.emoji;return e.jsxs("span",{className:`
              inline-flex items-center px-2 py-1 rounded-full text-xs font-bold uppercase 
              ${i.bg} ${i.text} ring-1 ${i.ring}
              transition-all duration-200
            `,children:[i.emoji&&(typeof i.emoji=="string"?e.jsx(n,{}):e.jsx(n,{size:10,className:"mr-1"})),t]},r)}),s.length>2&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:["+",s.length-2]})]})},Rd=s=>!!((s==null?void 0:s.is_public)??(s==null?void 0:s.isPublic)??(s==null?void 0:s.public)??(typeof(s==null?void 0:s.visibility)=="string"&&s.visibility.toLowerCase()==="public")),d0=({onPageChange:s,onPropertyView:a,onAuthAction:t})=>{var _,ae,ke,Me,Ye;const[r,i]=l.useState(""),[n,o]=l.useState("Pune"),[m,g]=l.useState(""),[b,d]=l.useState([]),[v,x]=l.useState(""),[u,c]=l.useState(""),[f,p]=l.useState([]),[N,P]=l.useState(!0),[w,$]=l.useState(0),[y,k]=l.useState(!1),[R,F]=l.useState(null),[T,j]=l.useState(new Set),[E,V]=l.useState(!0),[W,B]=l.useState({}),[M,A]=l.useState([]),[L,D]=l.useState(!1),[I,H]=l.useState(!1),[h,Y]=l.useState(!1),[K,q]=l.useState(!1),[ne,le]=l.useState([]),[S,C]=l.useState([]),[J,ue]=l.useState(0),Q=l.useRef(null),he=Ca(),se=Jr(),ge=Ps.useCallback(ie=>{if(s){s(ie);return}ie==="properties"&&he("/properties"),ie==="services"&&he("/services")},[s,he]),ee=new URLSearchParams(se.search),de=ee.has("filterToken")?"filterToken":ee.has("tf")?"tf":void 0,U=de?ee.get(de)??void 0:void 0;l.useEffect(()=>{(async()=>{try{V(!0);const we=await Gt(["common","lead","property"]);B(we||{})}catch(we){console.error("Error fetching master options:",we)}finally{V(!1)}})()},[]);const[X,re]=l.useState(new Set);l.useEffect(()=>{try{const ie=localStorage.getItem("liked_properties");if(ie){const we=JSON.parse(ie);Array.isArray(we)&&re(new Set(we.map(Number)))}}catch{}},[]);const{systemSettings:fe}=ur(),G=fe==null?void 0:fe.company_name,me=async ie=>{try{const we=await cr.getByProperty(ie,!1);return{total_views:(we==null?void 0:we.total_views)||0}}catch(we){return console.error(`Error fetching views for property ${ie}:`,we),{total_views:0}}},oe=async ie=>{try{const we=await Qt.getById(ie);return(we==null?void 0:we.tags)||[]}catch(we){return console.warn(`Could not load tags for property ${ie}:`,we),[]}};l.useEffect(()=>{(async()=>{try{P(!0);const we=await As.PublicgetProperties({status:"Available",limit:12,isPublic:!0,is_public:1,visibility:"public",publicOnly:1});console.log("API Response:",we),console.log("Raw data:",we==null?void 0:we.data);let Ve=(Array.isArray(we==null?void 0:we.data)?we.data:Array.isArray(we)?we:[]).filter(Rd);if(!Ve.length){const Oe=await As.PublicgetProperties({status:"Available",limit:12,isPublic:!0,is_public:1,visibility:"public",publicOnly:1});Ve=(Array.isArray(Oe==null?void 0:Oe.data)?Oe.data:Array.isArray(Oe)?Oe:[]).filter(Rd)}Ve.sort((Oe,rs)=>{const ms=Oe!=null&&Oe.publication_date?new Date(Oe.publication_date).getTime():0;return(rs!=null&&rs.publication_date?new Date(rs.publication_date).getTime():0)-ms});const Ue=(await Promise.all(Ve.slice(0,12).map(async Oe=>{var as,xs,ps,ys;const rs=Array.isArray(Oe.photos)?Oe.photos.map(He=>(He||"").replace(/\\/g,"/")):Array.isArray(Oe.photoUrls)?Oe.photoUrls:[],ms=Oe.city_name||Oe.city||Oe.town||Oe.cityName||"",cs=Oe.location_name||Oe.locality||Oe.area||Oe.neighbourhood||Oe.location||Oe.address||"",gs=Oe.state||Oe.region||"",Ne=[cs,ms,gs].filter(Boolean).slice(0,2).join(", "),[Ze,ls]=await Promise.all([oe(Oe.id),me(Oe.id)]),$s=(Oe.unit_type||Oe.unit_type_name||Oe.unit||Oe.unitType||"").toString().trim(),Gs=(Oe.property_subtype_name||Oe.property_subtype||Oe.unit_category_name||Oe.subtype||"").toString().trim(),Se=(Oe==null?void 0:Oe.slug)??(Oe==null?void 0:Oe.url_slug)??(Oe==null?void 0:Oe.generated_slug),Ge=typeof Se=="string"&&Se.trim().length>0?Se.trim():void 0,z=Number(Oe.carpet_area)||0,te=Number(Oe.builtup_area)||0,ce=Number(Oe.super_builtup_area)||0,Re=z||te||ce||Number(Oe.area)||void 0,Te=Oe.budget||Oe.price||Oe.amount,qe=Te?Number(Te):void 0;return{id:Oe.id,propertyId:Oe.property_id&&String(Oe.property_id).trim()||`REX${String(Oe.id??"").padStart(4,"0")}`,title:(Oe.title||`${$s?$s+" ":""}${Oe.property_type_name||Oe.property_type||""}`).trim(),price:qe,bedrooms:Number(Oe.bedrooms)||void 0,bathrooms:Number(Oe.bathrooms)||void 0,square_feet:Re,city:ms,property_type:Oe.property_type_name||Oe.property_type||"",status:Oe.status||"",images:rs,location:Ne,area:Re,type:Oe.property_type_name||Oe.property_type||"",unitType:$s,subtype:Gs,amenities:Array.isArray(Oe.amenities)?Oe.amenities.map(String).map(He=>He.trim()).filter(Boolean):typeof Oe.amenities=="string"?Oe.amenities.split(",").map(He=>He.trim()).filter(Boolean):Array.isArray(Oe.features)?Oe.features.map(String).map(He=>He.trim()).filter(Boolean):typeof Oe.features=="string"?Oe.features.split(",").map(He=>He.trim()).filter(Boolean):[],badge:Oe.featured?"Premium":Oe.badge||"Standard",rating:typeof Oe.rating=="number"?Oe.rating:4.5+Math.random()*.4,views:ls.total_views||0,total_views:ls.total_views||0,aiScore:Number(Oe.aiScore)||Math.floor(Math.random()*20)+80,sellerName:Oe.seller_name||Oe.owner_name||((as=Oe.seller)==null?void 0:as.name)||"",slug:Ge,possessionMonth:Oe.possession_month??Oe.possessionMonth??null,possessionYear:Oe.possession_year??Oe.possessionYear??null,property_status:Oe.property_status??Oe.status??"",created_at:Oe.created_at??null,public_views:Oe.public_views??null,executive:{phone:Oe.executive_phone||((xs=Oe.executive)==null?void 0:xs.phone)||"",name:Oe.executive_name||((ps=Oe.executive)==null?void 0:ps.name)||"",email:Oe.executive_email||((ys=Oe.executive)==null?void 0:ys.email)||""},tags:Ze,featured:Oe.featured||Oe.is_featured||!1}}))).filter(s0);p(Ue.length?Ue:[])}catch(we){console.error("Error fetching featured properties (public-only):",we),p([])}finally{P(!1)}})()},[]),l.useEffect(()=>{(async()=>{try{const we=await Fr.list();le(we||[]);const Be=[];for(const Ve of we||[])(Array.isArray(Ve.photos)?Ve.photos:[]).forEach(Ue=>{const Oe=((Ue==null?void 0:Ue.url)||"").replace(/\\/g,"/");Oe&&Be.push({url:Oe,title:Ve.title,description:Ve.description})});C(Be),ue(0)}catch(we){console.warn("[HomePage] homeHeroAPI.list() failed, will fallback to featured images",we),le([]),C([])}})()},[]),l.useEffect(()=>{if(S.length)return Q.current&&window.clearInterval(Q.current),Q.current=window.setInterval(()=>{ue(ie=>(ie+1)%S.length)},5e3),()=>{Q.current&&window.clearInterval(Q.current)}},[S.length]);const Fe=ie=>{k(!0),t&&t(ie)},$e=ie=>{if(!W||typeof W!="object")return[];const we={};Object.keys(W).forEach(Be=>we[Be.toLowerCase().replace(/\s+/g,"")]=Be);for(const Be of ie){const Ve=Be.toLowerCase().replace(/\s+/g,"");if(we[Ve])return W[we[Ve]]}for(const Be of ie){const Ve=Be.toLowerCase().replace(/\s+/g,""),Je=Object.keys(W).find(Ue=>Ue.toLowerCase().replace(/\s+/g,"").includes(Ve));if(Je)return W[Je]}return[]},Le=l.useMemo(()=>$e(["city"]),[W]),je=l.useMemo(()=>$e(["property type","property_type","propertytype","type","property"]),[W]),_e=l.useMemo(()=>$e(["location","locality","localities","area","neighbourhood","neighborhood","locality_name"]),[W]),ve=ie=>{const we=Number(ie);if(!Number.isFinite(we)||we<=0)return" - ";const Be=1e7,Ve=1e5;if(we>=Be){const Je=we/Be;return`â‚¹${parseFloat(Je.toFixed(2))}Cr`}if(we>=Ve){const Je=we/Ve;return`â‚¹${parseFloat(Je.toFixed(0))}L`}return`â‚¹${we.toLocaleString("en-IN")}`},[Pe,We]=l.useState("buy"),pe=ie=>{const we=(ie??m??"").toString().trim();if(!we)return;const Be=we.replace(/\s{2,}/g," ").replace(/(^,|,$)/g,"").trim();if(Be){if(b.includes(Be)){g(""),A([]),D(!1);return}if(b.length>=5){console.warn("Maximum 5 localities allowed"),g(""),A([]),D(!1);return}d(Ve=>[...Ve,Be]),g(""),A([]),D(!1)}},O=ie=>d(we=>we.filter((Be,Ve)=>Ve!==ie)),Ie=l.useRef(null);l.useEffect(()=>{const ie=(m||"").trim().toLowerCase();if(!ie||!Array.isArray(_e)||_e.length===0){A(Je=>Je.length?[]:Je),D(Je=>Je&&!1);return}const we=_e.filter(Je=>{const Ue=(Je.label||"").toString().toLowerCase(),Oe=(Je.value||"").toString().toLowerCase();return Ue.includes(ie)||Oe.includes(ie)}).slice(0,10);we.length===M.length&&we.every((Je,Ue)=>{var Oe,rs;return Je.value===((Oe=M[Ue])==null?void 0:Oe.value)&&Je.label===((rs=M[Ue])==null?void 0:rs.label)})||A(we),D(we.length>0)},[m,_e]);const ze=async ie=>{if(ie&&ie.preventDefault(),Pe==="rent"){console.warn("Rent search not implemented yet. Only Buy is active.");return}const we=n.trim(),Be=b.map(Je=>Je.trim());if(!we&&Be.length===0){he("/properties?status=Available");return}const Ve={city:we};Be.length>0&&(Ve.locations=Be);try{P(!0);const Je=await As.searchByCityLocation(Ve),Ue=Array.isArray(Je==null?void 0:Je.data)?Je.data:Array.isArray(Je)?Je:[];await Promise.all(Ue.map(async ms=>ms));const Oe=new URLSearchParams;we&&Oe.set("city",we),b.length>0&&Oe.set("locations",b.join(",")),u&&Oe.set("propertyType",u),v&&Oe.set("budget",v),Oe.set("status","Available"),U&&de&&Oe.set(de,U);const rs=Oe.toString();he(`/properties${rs?`?${rs}`:""}`,{replace:!0})}catch(Je){console.error("Error fetching properties from city/location API:",Je)}finally{P(!1)}},xe=()=>{t?t("sell"):H(!0)},Ee=async ie=>{try{H(!1)}catch(we){console.error("Error saving seller/property:",we)}},Ke=async ie=>{const we=ie.id,Be=ie.slug;if(!Be){console.warn("Attempted to navigate to property without slug:",we);return}if(T.has(we)){let Je=`/properties/${encodeURIComponent(String(Be))}`;U&&(Je+=`?${encodeURIComponent(de||"tf")}=${encodeURIComponent(U)}`),he(Je);return}const Ve={search:r||null,location:b.length?b.join(", "):null,city:n||null,budget:v||null,propertyType:u||null,source:"homepage",clickedPropertyId:we};try{let Je=U,Ue=de||"tf";if(!Je)try{const rs=await As.createFilterContext({filters:Ve});rs&&rs.id?Je=rs.id:console.warn("createFilterContext did not return id, response:",rs)}catch(rs){console.warn("createFilterContext failed (proceeding without token):",rs)}try{await As.sendPropertyEvent(we,"click","listing_card_click",{source:"homepage",title:ie.title||null},{slug:Be,filterToken:Je||void 0,filterParamKey:Ue}),j(rs=>new Set(rs).add(we))}catch(rs){console.warn("sendPropertyEvent failed (we will still navigate):",rs)}let Oe=`/properties/${encodeURIComponent(String(Be))}`;Je&&(Oe+=`?${encodeURIComponent(Ue)}=${encodeURIComponent(Je)}`),he(Oe)}catch(Je){console.error("handleNavigateToProperty unexpected error:",Je),he(`/properties/${encodeURIComponent(String(Be))}`)}};if(R)return e.jsx(rd,{property:R,onBack:()=>F(null)});const Xe=S.length>0?(_=S[J])==null?void 0:_.url:((ke=(ae=f[w])==null?void 0:ae.images)==null?void 0:ke[0])||"",ye=S.length>0&&((Me=S[J])==null?void 0:Me.title)||"",Ce=S.length>0&&((Ye=S[J])==null?void 0:Ye.description)||"";return e.jsxs("div",{className:"",children:[e.jsxs("section",{className:"relative bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 text-white overflow-hidden min-h-[calc(100vh-80px)] md:min-h-[calc(100vh-80px)]",children:[e.jsx("div",{className:"absolute inset-0 bg-black/30"}),Xe&&e.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-all duration-1000",style:{backgroundImage:`url(${Xe})`,filter:"brightness(0.35)"}}),S.length>0&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"absolute bottom-6 left-0 right-0 z-20 flex items-center justify-center gap-2",children:S.map((ie,we)=>e.jsx("button",{onClick:()=>ue(we),"aria-label":`Go to slide ${we+1}`,className:`h-2.5 w-2.5 rounded-full transition-all ${we===J?"bg-white w-6":"bg-white/60"}`,type:"button"},we))})}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"w-full max-w-4xl mx-auto",children:e.jsxs("div",{className:"text-center px-4",children:[(ye||Ce)&&e.jsxs("div",{className:"mb-4",children:[ye&&e.jsx("h1",{className:"text-3xl font-bold mb-2 ",children:ye}),Ce&&e.jsx("p",{className:"text-blue-100 mb-6",children:Ce})]}),e.jsxs("div",{className:"grid grid-cols-1  gap-1 md:gap-2 mb-4 items-center justify-center text-center",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3",children:[e.jsx("button",{type:"button",onClick:()=>We("buy"),className:`px-4 sm:px-5 py-1.5 sm:py-2 rounded-full text-sm sm:text-base ring-1 ring-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition
        bg-[#E6761D] text-white`,"aria-pressed":!0,children:"Buy"}),e.jsx("button",{type:"button",onClick:()=>{},className:"px-4 sm:px-5 py-1.5 sm:py-2 rounded-full text-sm sm:text-base ring-1 ring-transparent focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition bg-gray-100 text-gray-700 opacity-60 cursor-not-allowed",title:"Launching soon !",disabled:!0,"aria-disabled":"true","aria-pressed":!1,children:"Rent"})]}),e.jsx("div",{className:"w-full grid justify-center md:w-auto",children:E?e.jsx("div",{className:"text-sm text-white/80 px-3 py-1",children:"Loading types..."}):e.jsx("div",{className:`\r
          mx-auto max-w-full\r
          overflow-x-auto\r
          [-webkit-overflow-scrolling:touch]\r
          [scrollbar-width:none]\r
          [-ms-overflow-style:none]\r
          px-1\r
        `,style:{scrollbarWidth:"none"},children:e.jsxs("div",{className:"flex gap-2 py-1 snap-x snap-mandatory",children:[e.jsx("button",{type:"button",onClick:()=>c(""),"aria-pressed":u==="",className:`
              shrink-0 snap-start whitespace-nowrap
              px-3 sm:px-4 py-1.5 rounded-full text-sm
              focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition
              ${u===""?"bg-white text-black":"bg-white/30 text-white hover:bg-white/40"}`,children:"All"}),je.map(ie=>e.jsx("button",{type:"button",onClick:()=>c(ie.value),"aria-pressed":u===ie.value,title:ie.label,className:`
                shrink-0 snap-start whitespace-nowrap
                px-3 sm:px-4 py-1.5 rounded-full text-sm
                focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition
                ${u===ie.value?"bg-white text-black":"bg-white/20 text-white hover:bg-white/30"}`,children:ie.label},ie.value))]})})})]}),e.jsxs("form",{onSubmit:ze,className:"bg-white/10 text-white bg-opacity-95 backdrop-blur-sm rounded-2xl p-4 shadow-xl max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row",children:[e.jsxs("div",{className:"relative w-full md:w-48",children:[e.jsxs("select",{value:n,onChange:ie=>o(ie.target.value),disabled:E,className:"appearance-none px-3 py-2 border z-10 rounded-lg w-full bg-transparent text-white border-white/30 focus:outline-none focus:ring-1 focus:ring-white",children:[e.jsx("option",{value:"",className:"bg-[#0b3856] text-white",children:E?"Loading cities...":"Select city"}),Le.map(ie=>e.jsx("option",{value:ie.value,className:"bg-[#0b3856] text-white",children:ie.label},ie.value))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center",children:e.jsx(pa,{className:"text-white rotate-90",size:14})})]}),e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-white",size:18}),e.jsx("input",{ref:Ie,value:m,onChange:ie=>g(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"?(ie.preventDefault(),pe()):ie.key==="Escape"&&D(!1)},onFocus:()=>{M.length>0&&D(!0)},onBlur:()=>{setTimeout(()=>D(!1),120)},className:"pl-10 pr-16 h-10 w-full text-sm bg-white/10 text-white placeholder-white/70 outline-none focus:ring-1 focus:ring-gray-400 rounded-lg",placeholder:"Search properties by locality or area"}),L&&M.length>0&&e.jsx("ul",{className:"absolute left-0 right-0 mt-1 max-h-32 lg:max-w-60 overflow-auto bg-[#0b3856] border rounded-lg shadow-lg z-[200] custom-scroll",children:M.map((ie,we)=>e.jsx("li",{onMouseDown:Be=>Be.preventDefault(),onClick:()=>{var Ve,Je;const Be=((Ve=ie.label)==null?void 0:Ve.toString().trim())||((Je=ie.value)==null?void 0:Je.toString().trim());pe(Be)},className:"px-3 py-2 hover:bg-white/20 cursor-pointer text-sm",children:ie.label||ie.value},`${ie.value}-${we}`))})]}),e.jsx("button",{type:"submit",className:"bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-4 py-2 rounded-lg w-full md:w-28 text-base transition-colors duration-300",children:"Search"})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[b.map((ie,we)=>e.jsxs("div",{className:"flex items-center bg-white/20 text-white px-3 py-1 rounded-full text-sm",children:[e.jsx("span",{className:"mr-2",children:ie}),e.jsx("button",{type:"button",onClick:()=>O(we),className:"text-gray-200 hover:text-white",children:"Ã—"})]},we)),b.length===0&&e.jsx("div",{className:"text-xs text-gray-100",children:"Add up to 1 localities."})]})]})]})})})]}),e.jsx("section",{className:"py-6 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-[#0b3856] to-[#0c3854] bg-clip-text text-transparent",children:"AI Market Intelligence"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Real-time market analysis powered by advanced AI algorithms"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white border border-gray-100 p-5 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:items-start sm:text-left gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-green-50 ring-1 ring-green-100",children:e.jsx(Rs,{className:"text-green-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Price Trends"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Andheri West ",e.jsx("span",{className:"font-medium text-green-600",children:"+12.5%"})]})]})]})}),e.jsx("div",{className:"bg-white border border-gray-100 p-5 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:items-start sm:text-left gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-blue-50 ring-1 ring-blue-100",children:e.jsx(rt,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Best ROI"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Bandra West ",e.jsx("span",{className:"font-medium text-blue-600",children:"18.2%"})]})]})]})}),e.jsx("div",{className:"bg-white border border-gray-100 p-5 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:items-start sm:text-left gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-purple-50 ring-1 ring-purple-100",children:e.jsx(Ot,{className:"text-purple-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Market Heat"}),e.jsx("div",{className:"text-xs",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-red-50 text-red-600 border border-red-100 text-[11px]",children:"Powai Â· Hot"})})]})]})}),e.jsx("div",{className:"bg-white border border-gray-100 p-5 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:items-start sm:text-left gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-orange-50 ring-1 ring-orange-100",children:e.jsx(zt,{className:"text-orange-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"AI Score"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Avg ",e.jsx("span",{className:"font-medium text-orange-600",children:"92/100"})]})]})]})})]}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("button",{onClick:()=>Fe("subscribe"),className:"inline-flex items-center justify-center gap-2 bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-5 py-2.5 rounded-xl font-medium transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#E6761D]",children:"Get Full AI Report"}),e.jsx(_p,{isOpen:y,onClose:()=>k(!1)})]})]})}),e.jsx("section",{className:"py-3 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Featured Properties"}),e.jsx("p",{className:"text-gray-600",children:"Handpicked premium properties with AI recommendations"})]}),N?e.jsx("div",{className:"flex justify-center",children:e.jsx(ia,{size:"lg"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 items-stretch",children:f.map(ie=>{const we=Array.isArray(ie.amenities)?ie.amenities:[],Be=we.slice(0,2),Ve=Math.max(we.length-Be.length,0);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden group h-full flex flex-col",children:[e.jsxs("div",{className:"relative",children:[ie.images&&ie.images.length?e.jsxs("div",{onClick:()=>Ke(ie),className:"cursor-pointer relative",children:[e.jsx("img",{src:ie.images[0],alt:ie.title||"Property image",className:"w-full h-48 object-cover group-hover:scale-105 transition-transform"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("span",{className:"text-white text-2xl font-bold opacity-40 select-none",children:"ResaleExpert.in"})})]}):e.jsx("div",{className:"h-48 bg-gray-200 flex items-center justify-center",children:e.jsx(Is,{className:"text-gray-400"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex items-start flex-wrap gap-2 z-20",children:[e.jsx("div",{className:"max-w-[72vw] sm:max-w-none overflow-hidden",children:e.jsx(c0,{tags:ie.tags||[]})}),(ie.aiScore??0)>=90&&e.jsxs("span",{className:"flex-none whitespace-nowrap bg-purple-600 text-white px-2 py-1 rounded-full text-[8px] sm:text-xs font-bold leading-none flex items-center shadow-sm",children:[e.jsx(Mt,{size:12,className:"mr-1"}),"AI ",Math.round(ie.aiScore??0)]})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 flex items-center gap-2",children:[e.jsxs("div",{className:"bg-white/90 rounded-full px-2 py-1 flex items-center gap-1",children:[e.jsx(Xs,{className:"text-yellow-500",size:12}),e.jsx("span",{className:"text-xs font-semibold text-gray-900",children:(ie.rating||4.5).toFixed(1)})]}),e.jsx("div",{className:"bg-white/90 rounded-full px-2 py-1",children:e.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[ie.total_views||ie.views||0," views"]})})]})]}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:"pr-4",children:e.jsx("div",{className:"text-lg font-bold text-[#0b3856] mb-1 group-hover:text-[#E6761D] transition-colors",children:[ie.type,ie.unitType,ie.subtype].filter(Boolean).join("  ")||" - "})}),e.jsx("div",{className:"text-lg text-gray-500",children:ie.propertyId||`REX${String(ie.id??"").padStart(4,"0")}`})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:ve(ie.price)}),e.jsxs("div",{className:"text-sm text-gray-500",children:[ie.unitType||ie.type," â€¢ ",ie.square_feet??ie.area??" - "," sq ft"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Price per sq ft"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:["â‚¹",Math.round((ie.price||0)/(ie.square_feet||ie.area||1)).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-3",children:[e.jsx(Qs,{size:16,className:"mr-2"}),e.jsx("span",{children:ie.location||ie.city||" - "})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[Be.map((Je,Ue)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:Je},Ue)),Ve>0&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs",children:["+",Ve," more"]})]}),e.jsxs("div",{className:"mt-auto flex items-center gap-3",children:[ie.slug?e.jsx("div",{className:"flex-1",children:e.jsx("button",{onClick:()=>Ke(ie),className:"w-full bg-[#E6761D] text-white py-2 rounded-lg hover:bg-[#CC6A1A] transition-colors",children:"View Details"})}):e.jsx("button",{disabled:!0,className:"w-full bg-gray-300 text-gray-600 py-2 rounded-lg cursor-not-allowed",title:"Details not available",children:"View Details"}),e.jsx("button",{onClick:Je=>{var Oe;Je.stopPropagation(),Je.preventDefault();const Ue=((Oe=ie.executive)==null?void 0:Oe.phone)||"919999999999";window.location.href=`tel:${Ue}`},className:"p-3 rounded-lg transition-colors duration-300 bg-green-50 text-green-600 hover:bg-green-600 hover:text-white",title:"Call",type:"button",children:e.jsx(Cs,{size:18})}),e.jsx("button",{onClick:Je=>{var Ze,ls;Je.stopPropagation(),Je.preventDefault();const Ue=((ls=(Ze=ie==null?void 0:ie.executive)==null?void 0:Ze.phone)==null?void 0:ls.replace(/\D/g,""))||"9637009639",Oe=(ie==null?void 0:ie.title)||[ie==null?void 0:ie.unitType,ie==null?void 0:ie.type].filter(Boolean).join(" ")||"a property",rs=(ie==null?void 0:ie.location)||(ie==null?void 0:ie.city)||"your listed property location",ms=Number((ie==null?void 0:ie.price)||0),cs=isNaN(ms)?"Price on request":`â‚¹${ms.toLocaleString("en-IN")}`,gs=ie!=null&&ie.slug?`${window.location.origin}/properties/${encodeURIComponent(String(ie.slug))}`:`${window.location.origin}/properties`,Ne=`Hi, I'm interested in ${Oe} at ${rs}. Price: ${cs}. Can you share more details?
${gs}`;window.open(`https://wa.me/${Ue}?text=${encodeURIComponent(Ne)}`,"_blank","noopener,noreferrer")},className:"p-3 rounded-lg transition-colors duration-300 bg-[#25D366] text-white hover:bg-[#1ebe57]",title:"Chat on WhatsApp",type:"button",children:e.jsx(Yn,{size:18})})]})]})]},ie.id)})}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(Bs,{to:"/properties",children:e.jsx("button",{onClick:()=>s&&s("properties"),className:"bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-4 py-2 rounded-xl font-medium transition-colors duration-300",children:"View All Properties"})})})]})}),e.jsx("section",{className:"py-8 text-white",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Sell Your Resale Property Faster & Smarter in Pune"}),e.jsx("p",{className:"text-gray-200 mb-4",children:"Get instant AI-based property valuation, connect with verified buyers, and close deals faster â€” all with Resale Expert."}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsx("button",{onClick:xe,className:`w-full sm:w-auto shrink-0 bg-[#E6761D] hover:bg-[#CC6A1A] text-white\r
                 px-5 py-3 rounded-lg font-medium shadow-md transition-colors duration-300\r
                 text-sm sm:text-base`,children:"List My Property"}),e.jsx("button",{onClick:()=>q(!0),className:"w-full sm:w-auto border-2 border-white/90 text-white px-5 py-3 rounded-lg font-medium transition-colors duration-300 hover:bg-[#E6761D] hover:border-[#E6761D] hover:text-white text-sm sm:text-base",children:"Free Valuation"}),e.jsx(o0,{open:K,onClose:()=>q(!1),onListProperty:()=>H(!0)}),e.jsx("button",{onClick:()=>Y(!0),className:`w-full sm:w-auto border-2 border-white/90 text-white\r
                 px-5 py-3 rounded-lg font-medium transition-colors duration-300\r
                 hover:bg-[#E6761D] hover:border-[#E6761D] hover:text-white\r
                 text-sm sm:text-base`,children:"Why Sell ResaleExpert"})]})})]}),e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:"https://images.pexels.com/photos/3184291/pexels-photo-3184291.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Sell",className:"rounded-2xl shadow-xl w-full object-cover"}),e.jsxs("div",{className:"absolute -bottom-4 left-4 bg-white px-4 py-2 rounded-xl shadow-lg flex items-center gap-2 border border-gray-100",children:[e.jsx(cn,{className:"text-[#0b3856] w-5 h-5"}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"â‚¹500Cr+ Properties Sold"})]})]})]})})}),e.jsx("section",{className:"py-8 bg-gray-50 border-t border-gray-100",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Why ChooseÂ ",G,"?"]}),e.jsx("h3",{className:"text-base sm:text-lg text-gray-700 font-medium mb-3",children:"Trusted Resale Property Consultant in Pune & PCMC"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto leading-relaxed",children:"Buying or selling a resale property can be overwhelming. That's why thousands of homeowners and buyers choose Resale Expert for hassle-free transactions."})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 items-stretch",children:[e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl p-6 text-center shadow-sm hover:shadow-md transition-all flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-[#E6761D] flex items-center justify-center mb-4",children:e.jsx(Un,{className:"text-white",size:26})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"Verified Listings Only"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"Every property undergoes legal and documentation checks."})]}),e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl p-6 text-center shadow-sm hover:shadow-md transition-all flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-[#E6761D] flex items-center justify-center mb-4",children:e.jsx(Va,{className:"text-white",size:26})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"Fair Market Valuation"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"Transparent pricing â€” no hidden charges, no inflated rates."})]}),e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl p-6 text-center shadow-sm hover:shadow-md transition-all flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-[#E6761D] flex items-center justify-center mb-4",children:e.jsx(Ns,{className:"text-white",size:26})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"Local Market Expertise"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"Deep understanding of Pune and PCMC real estate trends."})]}),e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl p-6 text-center shadow-sm hover:shadow-md transition-all flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-[#E6761D] flex items-center justify-center mb-4",children:e.jsx(Cl,{className:"text-white",size:26})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"End-to-End Assistance"}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"From property search to registration and possession."})]})]})]})}),e.jsx("section",{className:"py-5 bg-white border-t border-gray-100",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-6 items-stretch text-center",children:[e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl px-6 py-8 flex flex-col items-center justify-center shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-blue-100 flex items-center justify-center mb-4",children:e.jsx(yt,{className:"text-blue-600",size:20})}),e.jsx("h4",{className:"text-2xl font-bold text-gray-900",children:"10K+"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Properties"})]}),e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl px-6 py-8 flex flex-col items-center justify-center shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-green-100 flex items-center justify-center mb-4",children:e.jsx(Ns,{className:"text-green-600",size:20})}),e.jsx("h4",{className:"text-2xl font-bold text-gray-900",children:"25K+"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Customers"})]}),e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl px-6 py-8 flex flex-col items-center justify-center shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-orange-100 flex items-center justify-center mb-4",children:e.jsx(Ct,{className:"text-orange-600",size:20})}),e.jsx("h4",{className:"text-2xl font-bold text-gray-900",children:"15+"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Years"})]}),e.jsxs("div",{className:"h-full bg-white border border-gray-100 rounded-2xl px-6 py-8 flex flex-col items-center justify-center shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-purple-100 flex items-center justify-center mb-4",children:e.jsx(Xs,{className:"text-purple-600",size:20})}),e.jsx("h4",{className:"text-2xl font-bold text-gray-900",children:"4.9â˜…"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Rating"})]})]})})}),e.jsx("section",{className:"py-5 text-white border-b border-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Customer Success Stories"}),e.jsx("p",{className:"text-sm text-gray-800",children:"See how our AI-powered solutions are helping people buy & sell properties smarter"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{name:"Rajesh Kumar",text:"Found my dream home in 2 weeks with AI matching!",rating:5,property:"3BHK Wakad"},{name:"Priya Sharma",text:"Sold my property 20% above market rate with their AI pricing.",rating:5,property:"2BHK Baner"},{name:"Amit Patel",text:"Seamless process from search to registration.",rating:5,property:"2BHK Hinjewadi"}].map((ie,we)=>e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border-t-4 border-[#E6761D]",children:[e.jsx("div",{className:"flex items-center space-x-1 mb-3",children:Array.from({length:5},(Be,Ve)=>e.jsx(Xs,{size:14,className:"text-[#E6761D] fill-current"},Ve))}),e.jsxs("p",{className:"text-gray-700 mb-4 text-sm italic",children:['"',ie.text,'"']}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#E6761D] rounded-full flex items-center justify-center text-white font-bold text-sm",children:ie.name.split(" ").map(Be=>Be[0]).join("")}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:ie.name}),e.jsx("div",{className:"text-xs text-gray-500",children:ie.property})]})]})]},we))})]})}),e.jsx("section",{className:"py-8 text-white",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Ready to Find Your Perfect Property?"}),e.jsx("p",{className:"text-gray-300 mb-6 max-w-2xl mx-auto",children:"Join thousands who found their dream properties with AI-powered search"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsx("button",{onClick:()=>ge("properties"),className:"w-full sm:w-auto bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-5 py-3 rounded-xl font-semibold shadow-md transition-colors duration-300",children:"Browse Properties"}),e.jsx("button",{onClick:()=>ge("services"),className:"w-full sm:w-auto px-5 py-3 rounded-xl font-semibold border-2 border-white text-white transition-colors duration-300 hover:bg-[#E6761D] hover:border-[#E6761D] hover:text-white",children:"View All Services"})]})]})}),e.jsx(Bu,{isOpen:I,onClose:()=>H(!1),onSubmit:Ee}),e.jsx(e0,{open:h,onClose:()=>Y(!1),onFreeValuation:()=>{Y(!1),q(!0)}})]})},m0=s=>{var t;if(!s)return!1;const a=(s.visibility||((t=s._raw)==null?void 0:t.visibility)||"").toString().toLowerCase();return s.is_public===1||s.isPublic===!0||s.public===!0||a==="public"},zd=s=>{const a=Number(s);if(!Number.isFinite(a)||a<=0)return" - ";const t=1e7,r=1e5;if(a>=t){const i=a/t;return`â‚¹${parseFloat(i.toFixed(2))}Cr`}if(a>=r){const i=a/r;return`â‚¹${parseFloat(i.toFixed(0))}L`}return`â‚¹${a.toLocaleString("en-IN")}`},x0=s=>{switch(s.toLowerCase()){case"swimming pool":return e.jsx(Fc,{size:14});case"gym":return e.jsx(Bc,{size:14});case"24/7 security":case"security":return e.jsx(at,{size:14});case"garden":return e.jsx(vr,{size:14});case"parking":return e.jsx(Sl,{size:14});case"wifi":return e.jsx(ao,{size:14});default:return e.jsx(bs,{size:14})}},nd=s=>{var t,r;const a=[s.type,(t=s._raw)==null?void 0:t.unit_type,(r=s._raw)==null?void 0:r.unit_type_name,s.title,s.property_type].filter(Boolean).map(String);for(const i of a){const n=i.match(/(\d+\s*BHK|\d+BHK|studio|1RK)/i);if(n)return n[0].replace(/\s+/g,"")}return s.bedrooms&&Number.isFinite(s.bedrooms)&&s.bedrooms>0?`${s.bedrooms}BHK`:""},Fd=s=>{var n,o,m,g;const a=[],t=(s.property_type||s.type||((n=s._raw)==null?void 0:n.property_type_name)||"").toString().trim();t&&a.push(t);const r=nd(s);r&&a.push(r);const i=(((o=s._raw)==null?void 0:o.property_subtype_name)||((m=s._raw)==null?void 0:m.property_subtype)||((g=s._raw)==null?void 0:g.subtype)||s.society||"").toString().trim();return i&&a.push(i),a.length===0&&s.title?s.title:a.join(" ")},u0=s=>{var i,n;const a=nd(s),t=s.area||s.square_feet||((i=s._raw)==null?void 0:i.carpet_area)||((n=s._raw)==null?void 0:n.builtup_area),r=t?`${Number(t).toFixed(t%1===0?0:2).replace(/\.0+$/,"")} sq ft`:"";return[a,r].filter(Boolean).join(" â€¢ ")},Bd=s=>{const a=(s.location||"").toString();if(!a)return{locationPart:"",cityPart:s.city||""};const t=a.split(",").map(n=>n.trim()).filter(Boolean);if(t.length===1)return{locationPart:t[0],cityPart:s.city||""};const r=t.slice(-1).join(", ");return{locationPart:t.slice(0,-1).join(", "),cityPart:r||s.city||""}},li=s=>{if(!s)return NaN;const a=s.toLowerCase().replace(/\s+/g,""),t=a.match(/^([0-9.,]+)(k|m|l|cr|crore|lakh)?\+?$/i);if(t){let i=parseFloat(t[1].replace(/,/g,""));const n=(t[2]||"").toLowerCase();return n==="k"?i*=1e3:n==="m"?i*=1e6:n==="l"||n==="lakh"?i*=1e5:(n==="cr"||n==="crore")&&(i*=1e7),Math.round(i)}const r=parseFloat(a.replace(/,/g,""));return isNaN(r)?NaN:r},g0=s=>{if(!s)return[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];const a=s.toString().trim();if(a.includes("-")){const r=a.split("-").map(o=>o.trim()),i=li(r[0]),n=li(r[1]);return[isNaN(i)?Number.NEGATIVE_INFINITY:i,isNaN(n)?Number.POSITIVE_INFINITY:n]}if(a.endsWith("+")){const r=a.replace(/\+$/,""),i=li(r);return[isNaN(i)?Number.NEGATIVE_INFINITY:i,Number.POSITIVE_INFINITY]}const t=a.match(/([0-9.,]+)\s*(k|m|l|cr|crore|lakh)?/gi);if(t&&t.length===1){const r=li(t[0]);return[Number.NEGATIVE_INFINITY,isNaN(r)?Number.POSITIVE_INFINITY:r]}return[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY]},h0=(s,a)=>{if(!a)return!0;const[t,r]=g0(a),i=s.price||0;return i>=(isFinite(t)?t:Number.NEGATIVE_INFINITY)&&i<=(isFinite(r)?r:Number.POSITIVE_INFINITY)},_o=s=>{var a,t,r,i;return s?s.floor!==void 0&&s.floor!==null?Number(s.floor):(a=s._raw)!=null&&a.floor_number?Number(s._raw.floor_number):(t=s._raw)!=null&&t.floor?Number(s._raw.floor):(r=s._raw)!=null&&r.current_floor?Number((i=s._raw)==null?void 0:i.current_floor):null:null},p0=s=>{var a,t,r,i;return s?s.bathrooms!==void 0&&s.bathrooms!==null?Number(s.bathrooms):(a=s._raw)!=null&&a.bathrooms?Number((t=s._raw)==null?void 0:t.bathrooms):(r=s._raw)!=null&&r.toilets?Number((i=s._raw)==null?void 0:i.toilets):null:null},Ou=s=>{var i,n,o,m,g,b;if(!s)return 0;const a=[s.parking,s.parkingQty,s.parking_qty,s.parking_spots,s.car_parking,(i=s._raw)==null?void 0:i.parking,(n=s._raw)==null?void 0:n.parkingQty,(o=s._raw)==null?void 0:o.parking_qty,(m=s._raw)==null?void 0:m.parking_spots,(g=s._raw)==null?void 0:g.car_parking,(b=s._raw)==null?void 0:b.parking_count];for(const d of a)if(d!=null&&d!==""){const v=Number(d);if(Number.isFinite(v)&&v>=0)return v}return(Array.isArray(s.amenities)?s.amenities:[]).some(d=>d.toLowerCase().includes("parking")||d.toLowerCase().includes("car parking"))?1:0},b0=s=>{const a=s._raw||{};let t=[];return a.parking_types&&(Array.isArray(a.parking_types)?t=a.parking_types.map(i=>i.toString().toLowerCase()):typeof a.parking_types=="string"&&(t=a.parking_types.split(",").map(i=>i.trim().toLowerCase()))),a.parking_details&&(typeof a.parking_details=="string"?t=t.concat(a.parking_details.split(",").map(i=>i.trim().toLowerCase())):Array.isArray(a.parking_details)&&(t=t.concat(a.parking_details.map(i=>i.toString().toLowerCase())))),Ou(s)>0&&t.push("4w","2w"),Array.isArray(s.amenities)&&s.amenities.forEach(i=>{const n=i.toLowerCase();(n.includes("2 wheeler")||n.includes("2-wheeler")||n.includes("two wheeler"))&&t.push("2w"),(n.includes("4 wheeler")||n.includes("4-wheeler")||n.includes("four wheeler")||n.includes("car parking"))&&t.push("4w")}),Array.from(new Set(t))},Od=({tags:s})=>{if(!s||s.length===0)return null;const a=s.slice(0,2);return e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[a.map((t,r)=>{const i=Ea(t),n=typeof i.emoji=="string"?()=>e.jsx("span",{className:"text-xs mr-1",children:i.emoji?typeof i.emoji=="string"?e.jsx("span",{className:"text-xs mr-1 uppercase","aria-hidden":"true",children:i.emoji}):Ps.createElement(i.emoji,{size:10,className:"mr-1 uppercase","aria-hidden":!0}):null}):i.emoji;return e.jsxs("span",{className:`
              inline-flex items-center px-2 py-1 rounded-full text-xs font-bold uppercase 
              ${i.bg} ${i.text} ring-1 ${i.ring}
              transition-all duration-200
            `,children:[i.emoji&&(typeof i.emoji=="string"?e.jsx(n,{}):e.jsx(n,{size:10,className:"mr-1"})),t]},r)}),s.length>2&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:["+",s.length-2]})]})},f0=({onPropertyView:s})=>{var z;const a=Ca(),t=Jr(),[r,i]=l.useState(""),[n,o]=l.useState("Pune"),[m,g]=l.useState(""),[b,d]=l.useState([]),[v,x]=l.useState(""),[u,c]=l.useState(""),[f,p]=l.useState(""),[N,P]=l.useState("relevance"),[w,$]=l.useState("grid"),[y,k]=l.useState(!1),[R,F]=l.useState([]),[T,j]=l.useState(1),[E]=l.useState(12),[V,W]=l.useState(!0),[B,M]=l.useState(""),[A,L]=l.useState([]),[D,I]=l.useState(!0),[H,h]=l.useState(""),[Y,K]=l.useState(!0),[q,ne]=l.useState({}),[le,S]=l.useState(new Set),[C,J]=l.useState(null),[ue,Q]=l.useState(""),[he,se]=l.useState("any"),[ge,ee]=l.useState(""),[de,U]=l.useState(""),[X,re]=l.useState(""),[fe,G]=l.useState(""),[me,oe]=l.useState(""),[Fe,$e]=l.useState("buy"),[Le,je]=l.useState(""),_e=new URLSearchParams(t.search),ve=_e.has("filterToken")?"filterToken":_e.has("fltcnt")?"fltcnt":void 0,Pe=ve?_e.get(ve)??void 0:void 0,We=l.useRef(null),[pe,O]=l.useState([]),[Ie,ze]=l.useState(!1),xe=l.useRef(null);l.useEffect(()=>{(async()=>{try{K(!0);const ce=await Gt(["common","lead","property"]);ne(ce||{})}catch(ce){console.error("Error fetching master options:",ce)}finally{K(!1)}})()},[]);const Ee=te=>{if(!q||typeof q!="object")return[];const ce={};Object.keys(q).forEach(Re=>{ce[Re.toLowerCase().replace(/\s+/g,"")]=Re});for(const Re of te){const Te=Re.toLowerCase().replace(/\s+/g,"");if(ce[Te]){const qe=ce[Te],as=q[qe];if(Array.isArray(as))return as}}for(const Re of te){const Te=Re.toLowerCase().replace(/\s+/g,""),qe=Object.keys(q).find(as=>as.toLowerCase().replace(/\s+/g,"").includes(Te));if(qe){const as=q[qe];if(Array.isArray(as))return as}}return[]},Xe=Ee(["city"]).map(te=>({value:te.value,label:te.label})),Ce=Ee(["price range","price_range","budget","budget range","priceRange","price"]).map(te=>({value:te.value,label:te.label})),ae=Ee(["property type","property_type","type","place type","category"]).map(te=>({value:te.value||te.label,label:te.label||te.value}));Ee(["property subtype","property_subtype","subtype","unit subtype"]).map(te=>({value:te.value||te.label,label:te.label||te.value})),Ee(["unit type","unit_type","unit","bhk","bedrooms"]).map(te=>({value:te.value||te.label,label:te.label||te.value})).filter(Boolean);const ie=Ee(["bedrooms","bhk","beds","unit type","unit","unit_type"]).map(te=>{const ce=(te.value||te.label||"").toString(),Re=ce.match(/(\d+)/);if(Re){const Te=Re[1];return{value:Te,label:`${Te} BHK`}}return{value:ce,label:te.label||ce}}).filter((te,ce,Re)=>Re.findIndex(Te=>Te.value===te.value)===ce),we=Ee(["location","locality","localities","area","neighbourhood","neighborhood","locality_name"]),Be=async te=>{try{const ce=await cr.getByProperty(te,!1);return{total_views:(ce==null?void 0:ce.total_views)||0}}catch(ce){return console.error(`Error fetching views for property ${te}:`,ce),{total_views:0}}},Ve=async te=>{try{const ce=await Qt.getById(te);return(ce==null?void 0:ce.tags)||[]}catch{return[]}};l.useEffect(()=>{const te=new URLSearchParams(t.search),ce=te.get("city")||"Pune";o(ce);let Re=[];const Te=te.getAll("location");if(Te.length>0)Te.forEach(qe=>{qe.split(",").forEach(as=>{const xs=as.trim();xs&&Re.push(xs)})});else{const qe=te.get("locations");qe&&qe.split(",").forEach(as=>{const xs=as.trim();xs&&Re.push(xs)})}Re=Array.from(new Set(Re)).slice(0,5),d(Re),Re.length?i(Re.join(", ")):i(ce),j(1)},[t.search]);const Je=l.useCallback(async()=>{I(!0),h("");try{const te=new URLSearchParams(t.search),ce=!!(te.get("propertyType")||te.get("property_type")||te.get("budget_min")||te.get("minPrice")||te.get("budget_max")||te.get("maxPrice")||te.get("unitTypes")||te.get("unitType")||te.get("unit_type")||te.get("furnishing")||te.get("possession")||te.get("min_rating")||te.get("parking")||te.get("floor_min")||te.get("floor_max")||te.get("bathrooms")||te.get("bedrooms")||te.get("property_subtype")||te.get("propertySubtype")||te.get("sort")),Re=He=>Array.isArray(He)?He:He!=null&&He.data&&Array.isArray(He.data)?He.data:He!=null&&He.results&&Array.isArray(He.results)?He.results:He!=null&&He.properties&&Array.isArray(He.properties)?He.properties:Array.isArray(He==null?void 0:He.items)?He.items:[],Te=()=>{const He={isPublic:!0,is_public:1,visibility:"public",publicOnly:1},vs=te.getAll("location");vs.length>0?He.location=vs.join(","):te.get("location")&&(He.location=te.get("location")),te.get("city")&&(He.city=te.get("city"));const _s=te.get("propertyType")||te.get("property_type");_s&&(He.propertyType=_s,He.property_type=_s);const et=te.get("property_subtype")||te.get("propertySubtype");et&&(He.propertySubtype=et,He.property_subtype=et);let ts=[];te.get("unitTypes")?ts=(te.get("unitTypes")||"").split(",").map(ht=>ht.trim()).filter(Boolean):(te.get("unitType")||te.get("unit_type"))&&(ts=[te.get("unitType")||te.get("unit_type")].filter(Boolean)),ts.length&&(He.unitTypes=ts,He.unitType=ts[0],He.unit_type=ts.join(","));const js=te.get("budget_min")||te.get("minPrice"),Fs=te.get("budget_max")||te.get("maxPrice");return js&&(He.budget_min=Number(js),He.minPrice=Number(js)),Fs&&(He.budget_max=Number(Fs),He.maxPrice=Number(Fs)),te.get("sort")&&(He.sort=te.get("sort")),te.get("furnishing")&&(He.furnishing=te.get("furnishing")),te.get("possession")&&(He.possession=te.get("possession")),te.get("min_rating")&&(He.minRating=Number(te.get("min_rating"))),te.get("parking")&&(He.parking=te.get("parking")),te.get("floor_min")&&(He.floor_min=Number(te.get("floor_min"))),te.get("floor_max")&&(He.floor_max=Number(te.get("floor_max"))),te.get("bathrooms")&&(He.bathrooms=Number(te.get("bathrooms"))),te.get("bedrooms")&&(He.bedrooms=te.get("bedrooms")),te.get("status")&&(He.status=te.get("status")),ve&&Pe&&(He.filterToken=Pe),He},qe=()=>{const He={status:te.get("status")||"Available",limit:50,isPublic:!0,is_public:1,visibility:"public",publicOnly:1},vs=te.getAll("location");return vs.length>0?He.location=vs.join(","):te.get("location")&&(He.location=te.get("location")),te.get("city")&&(He.city=te.get("city")),te.get("search")&&(He.q=te.get("search")),He},as=!!(te.get("propertyType")||te.get("property_type"));let xs=null,ps=[];if(ce){const He=Te();try{xs=await As.searchProperties(He),ps=Re(xs)}catch(vs){console.warn("Advanced search failed, will relax. Error:",vs),ps=[]}if(!ps.length){const vs={...He};delete vs.propertySubtype,delete vs.property_subtype,delete vs.unitTypes,delete vs.unitType,delete vs.unit_type,delete vs.furnishing,delete vs.possession,delete vs.parking,delete vs.minRating,delete vs.floor_min,delete vs.floor_max,delete vs.bathrooms,"bedrooms"in vs&&!Number(vs.bedrooms)&&delete vs.bedrooms;try{const _s=await As.getSearch(vs);ps=Re(_s)}catch(_s){console.warn("Relaxed advanced failed, will try simple list. Error:",_s),ps=[]}}if(!ps.length)try{const vs=qe(),_s=await As.PublicgetProperties(vs);ps=Re(_s)}catch(vs){console.warn("PublicgetProperties failed after advanced attempts",vs),ps=[]}if(!ps.length&&as)try{const vs=Te();delete vs.propertyType,delete vs.property_type;const _s=await As.getSearch(vs);if(ps=Re(_s),!ps.length){const et=qe(),ts=await As.PublicgetProperties(et);ps=Re(ts)}}catch(vs){console.warn("No-PT fallback failed",vs)}}else try{xs=await As.PublicgetProperties(qe()),ps=Re(xs)}catch(He){console.warn("PublicgetProperties failed, fallback to empty",He),ps=[]}ps=ps.filter(m0);const ys=await Promise.all(ps.map(async(He,vs)=>{const[_s,et]=await Promise.all([Be(He.id),Ve(He.id)]),ts=Ou(He);return{id:He.id,slug:He.slug||He.url_slug||He.generated_slug,propertyId:He.property_id&&String(He.property_id).trim()||`REX${String(He.id??"").padStart(4,"0")}`,title:He.title||`${He.unit_type||""} ${He.property_type_name||""}`.trim()||`Property ${He.id}`,price:Number(He.budget)||Number(He.price)||0,bedrooms:Number(He.bedrooms)||0,bathrooms:Number(He.bathrooms)||0,square_feet:Number(He.carpet_area)||Number(He.builtup_area)||0,city:He.city_name||He.city||"",property_type:He.property_type_name||He.property_type||"",status:He.status||"",images:Array.isArray(He.photos)?He.photos.map(Fs=>Fs.replace(/\\/g,"/")):Array.isArray(He.photoUrls)?He.photoUrls:["https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800"],location:`${He.location_name||He.location||""}`.replace(/\s*,\s*$/,""),society:He.society_name||He.project_name||`Society ${He.id}`,area:Number(He.carpet_area)||Number(He.builtup_area)||0,parking:ts,type:He.unit_type||He.property_subtype||He.property_type_name||He.property_type||"Apartment",furnishing:He.furnishing_status||["Fully Furnished","Semi Furnished","Unfurnished"][vs%3],possession:He.possession_status||["Ready to Move","Under Construction"][vs%2],amenities:He.amenities?Array.isArray(He.amenities)?He.amenities:typeof He.amenities=="string"?He.amenities.split(",").map(Fs=>Fs.trim()):["Swimming Pool","Gym","Security","Garden","Club House","Power Backup"]:["Swimming Pool","Gym","Security","Garden","Club House","Power Backup"],rating:He.rating?Number(He.rating):4+Math.random()*1,reviews:He.reviews?Number(He.reviews):Math.floor(Math.random()*50)+5,postedDate:He.created_at?He.created_at.split("T")[0]:`2025-01-${String(Math.floor(Math.random()*15)+1).padStart(2,"0")}`,views:_s.total_views||0,total_views:_s.total_views,aiScore:He.ai_score||Math.floor(Math.random()*30)+70,priceGrowth:He.price_growth||`+${(Math.random()*20+5).toFixed(1)}%`,investmentGrade:He.investment_grade||["A++","A+","A","B+"][Math.floor(Math.random()*4)],executiveTo:He.assignedTo?{name:He.assignedTo.name||"Not Assigned",phone:He.assignedTo.phone||"Not Available",rating:He.rating||4+Math.random(),email:He.assignedTo.email||"Not Available"}:{name:"Not Assigned",phone:"Not Available",rating:He.rating||4+Math.random(),email:"Not Available"},highlights:He.highlights||["Prime Location","Good Value","Verified","No Brokerage"].slice(0,vs%4+1),nearbyPlaces:He.nearby_places||[{name:"Metro Station",distance:`${(Math.random()*2).toFixed(1)} km`},{name:"Shopping Mall",distance:`${(Math.random()*3).toFixed(2)} km`},{name:"School",distance:`${(Math.random()*2).toFixed(1)} km`}],public_views:He.public_views??null,floor:_o({...He,_raw:He}),tags:et,_raw:He}}));L(ys),h("")}catch(te){console.error("Error fetching properties:",te),h("Failed to load properties. Please try again."),L([])}finally{I(!1)}},[t.search,ve,Pe]);l.useEffect(()=>{Je()},[Je]),l.useEffect(()=>{const te=(m||"").trim().toLowerCase();if(!te||!Array.isArray(we)||we.length===0){O([]),ze(!1);return}const ce=we.filter(Re=>{const Te=(Re.label||"").toString().toLowerCase(),qe=(Re.value||"").toString().toLowerCase();return Te.includes(te)||qe.includes(te)}).slice(0,10);O(ce),ze(ce.length>0)},[m,we]);const Ue=te=>{if(!te)return"";const ce=te.split(",").map(Re=>Re.trim()).filter(Boolean);return ce.length?ce[ce.length-1].toLowerCase():""},Oe=te=>{const ce=(te??m??"").toString().trim();if(!ce)return;const Re=ce.split(",").map(Te=>Te.trim()).filter(Boolean);d(Te=>{const qe=Ue(n),as=[...Te];for(const xs of Re){if(as.length>=5)break;qe&&xs.toLowerCase()===qe||as.includes(xs)||as.push(xs)}return as}),g(""),O([]),ze(!1)},rs=te=>{d(ce=>ce.filter((Re,Te)=>Te!==te))},ms=te=>{if(!te){je(""),c(""),x(""),p(""),i(""),d([]),g(""),G(""),oe(""),$e("buy"),J(null),Q(""),se("any"),ee(""),U(""),re(""),a("/properties",{replace:!0});return}je(ce=>ce===te?"":te),c(ce=>ce===te?"":te)};l.useEffect(()=>{je(u||"")},[u]);const cs=A.filter(te=>{var Qe,ds;const ce=String(te.title||"").toLowerCase(),Re=String(te.location||"").toLowerCase(),Te=String(te.city||"").toLowerCase(),qe=String(te.property_type||te.type||"").toLowerCase(),as=String(((Qe=te._raw)==null?void 0:Qe.property_subtype_name)||((ds=te._raw)==null?void 0:ds.property_subtype)||te.property_subtype||"").toLowerCase(),xs=String(r||"").trim().toLowerCase(),ps=String(n||"").trim().toLowerCase(),ys=String(u||"").trim().toLowerCase(),He=String(fe||"").trim().toLowerCase(),vs=String(v||"").trim(),_s=String(f||"").trim(),et=String(me||"").trim().toLowerCase(),ts=xs===""||ce.includes(xs)||Re.includes(xs)||(te.society||"").toString().toLowerCase().includes(xs)||Te.includes(xs),js=ps===""||Re.includes(ps)||Te.includes(ps)||b.length>0&&b.some(os=>Re.includes(os.toLowerCase())),Fs=ys===""||qe===ys||qe.includes(ys),ht=He===""||as===He||as.includes(He),vt=h0(te,vs);_s===""||_s==="Any"||(Number(_s)>0?(te.bedrooms,Number(_s)):_s.toString().toLowerCase().includes("1")&&te.bedrooms);const De=(nd(te)||"").toLowerCase(),is=et===""||De===et||De.includes(et)||Number.isFinite(Number(et))&&Number(te.bedrooms)===Number(et);if(!Fs||!ht||!is||!ts||!js||!vt||C!=null&&(te.rating||0)<Number(C)||ue&&ue!==""&&!String(te.possession||"").toLowerCase().includes(String(ue).toLowerCase()))return!1;if(he&&he!=="any"){const os=b0(te);if(he==="2w"&&!os.includes("2w")||he==="4w"&&!os.includes("4w"))return!1}if(ge!==""&&Number.isFinite(Number(ge))){const os=_o(te);if(os===null||os<Number(ge))return!1}if(de!==""&&Number.isFinite(Number(de))){const os=_o(te);if(os===null||os>Number(de))return!1}if(X!==""&&Number.isFinite(Number(X))){const os=p0(te);if(os===null||os<Number(X))return!1}return!0}),gs=[...cs].sort((te,ce)=>{switch(N){case"price_low":return te.price-ce.price;case"price_high":return ce.price-te.price;case"newest":return new Date(ce.postedDate||"").getTime()-new Date(te.postedDate||"").getTime();case"area_large":return(ce.area||ce.square_feet||0)-(te.area||te.square_feet||0);case"rating":return(ce.rating||0)-(te.rating||0);case"ai_score":return(ce.aiScore||0)-(te.aiScore||0);case"price_growth":return parseFloat((ce.priceGrowth||"0").replace("+","").replace("%",""))-parseFloat((te.priceGrowth||"0").replace("+","").replace("%",""));default:return 0}}),Ne=Math.max(1,Math.ceil(gs.length/E)),Ze=(T-1)*E,ls=gs.slice(Ze,Ze+E),$s=(te,ce,Re)=>{const Te=new URLSearchParams(te||"");Re&&Te.set(ce,Re);const qe=Te.toString();return qe?`?${qe}`:""},Gs=async te=>{const ce=te.id,Re=te.slug;if(!Re){console.warn("Attempted to navigate to property without slug:",ce),M(te),s&&s(te);return}if(le.has(ce)){const ys=$s(t.search,ve||"fltcnt",Pe);a(`/properties/${encodeURIComponent(String(Re))}${ys}`);return}let Te=Pe??null;const qe=ve??"fltcnt",as={search:r||null,location:n||null,budget:v||null,propertyType:u||null,bedrooms:f||null,clickedPropertyId:ce,source:"properties_list"};if(!Te)try{const ys=await As.createFilterContext({filters:as});if(ys){const He=ys.id||ys.filterId||null;He&&(Te=String(He))}}catch(ys){console.warn("createFilterContext failed (continuing without token):",ys)}try{await As.sendPropertyEvent(ce,"click","listing_card_click",{source:"properties_list",title:te.title||null},{slug:Re,filterToken:Te||void 0,filterParamKey:qe}),S(ys=>{const He=new Set(ys);return He.add(ce),He})}catch(ys){console.warn("sendPropertyEvent failed (we will still navigate):",ys)}const xs=$s(t.search,qe,Te),ps=`/properties/${encodeURIComponent(String(Re))}${xs}`;a(ps)},Se=te=>{te&&te.preventDefault();const ce=new URLSearchParams;if(b.length>0){const Re=(n||"").split(",").map(Te=>Te.trim()).filter(Boolean);if(Re.length>=1){const Te=Re.slice(-1).join(", ");Te&&ce.append("city",Te)}b.forEach(Te=>{Te&&Te.trim()&&ce.append("location",Te.trim())})}else{const Re=String(n||"").trim();if(Re){const Te=Re.split(",").map(qe=>qe.trim()).filter(Boolean);Te.length===1?ce.append("city",Te[0]):Te.length>=2&&(ce.append("city",Te.slice(-1).join(", ")),ce.append("location",Te.slice(0,-1).join(", ")))}}ce.append("status","Available"),j(1),a(`/properties${ce.toString()?`?${ce.toString()}`:""}`,{replace:!0})},Ge=()=>k(te=>!te);return B?e.jsx(rd,{property:B}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"py-5 pt-28",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-3 text-white",children:"Explore Premium Properties"}),e.jsx("p",{className:"text-lg text-blue-100 mb-2 max-w-2xl mx-auto",children:"Discover verified properties from trusted sellers across top locations"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 md:gap-2 mb-4 items-center justify-center text-center",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3",children:[e.jsx("button",{type:"button",onClick:()=>$e("buy"),className:`px-4 sm:px-5 py-1.5 sm:py-2 rounded-full text-sm sm:text-base transition focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70
                    bg-[#E6761D] text-white`,"aria-pressed":!0,children:"Buy"}),e.jsx("button",{type:"button",onClick:()=>{},className:"px-4 sm:px-5 py-1.5 sm:py-2 rounded-full text-sm sm:text-base transition bg-gray-100 text-gray-700 opacity-60 cursor-not-allowed",title:"Launching Soon !",disabled:!0,"aria-disabled":"true","aria-pressed":!1,children:"Rent"})]}),e.jsx("div",{className:"w-full grid justify-center md:w-auto",children:Y?e.jsx("div",{className:"text-sm text-white/80 px-3 py-1",children:"Loading types..."}):e.jsx("div",{className:"relative ml-2 md:ml-0 max-w-full overflow-x-auto [-webkit-overflow-scrolling:touch] [scrollbar-width:none] [-ms-overflow-style:none] px-1",style:{scrollbarWidth:"none"},children:e.jsxs("div",{className:"flex gap-2 py-1 snap-x snap-mandatory",children:[e.jsx("button",{type:"button",onClick:()=>ms(""),"aria-pressed":Le==="",className:`shrink-0 snap-start whitespace-nowrap px-3 sm:px-4 py-1.5 rounded-full text-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition
                          ${Le===""?"bg-white text-black":"bg-white/30 text-white hover:bg-white/40"}`,children:"All"}),ae.map(te=>e.jsx("button",{type:"button",onClick:()=>ms(te.value),"aria-pressed":Le===te.value,title:te.label,className:`shrink-0 snap-start whitespace-nowrap px-3 sm:px-4 py-1.5 rounded-full text-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70 transition
                            ${Le===te.value?"bg-white text-black":"bg-white/20 text-white hover:bg-white/30"}`,children:te.label},te.value))]})})})]}),e.jsxs("form",{onSubmit:Se,className:"bg-white/10 text-white bg-opacity-95 backdrop-blur-sm rounded-2xl p-2 shadow-xl max-w-4xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-center",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsxs("select",{value:n,onChange:te=>{const ce=te.target.value||"";o(ce),i(ce),ce&&ce.split(",").map(Re=>Re.trim()).filter(Boolean).length===1&&d([])},disabled:Y,className:"appearance-none px-3 py-2 border rounded-lg w-full bg-white/30 text-white border-white/30 focus:outline-none focus:ring-1 focus:ring-white disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",className:"bg-[#0b3856] text-white",children:Y?"Loading cities...":"Select City"}),Xe.map(te=>e.jsx("option",{value:te.value,className:"bg-[#0b3856] text-white",children:te.label},te.value))]})}),e.jsx("div",{className:"relative md:col-span-3 flex items-center gap-2 bg-[#0b3856] border border-gray-200 rounded-xl w-full max-w-[700px] mx-auto",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-white",size:16}),e.jsx("input",{ref:xe,value:m,onChange:te=>g(te.target.value),onKeyDown:te=>{te.key==="Enter"?(te.preventDefault(),Oe()):te.key==="Escape"&&ze(!1)},onFocus:()=>{pe.length>0&&ze(!0)},onBlur:()=>{setTimeout(()=>ze(!1),120)},className:"pl-10 pr-16 h-10 w-full text-sm bg-white/10 text-white placeholder-white/70 outline-none focus:ring-1 focus:ring-gray-400 rounded-lg",placeholder:"Search properties by locality or area","aria-autocomplete":"list","aria-haspopup":"listbox","aria-expanded":Ie,disabled:b.length>=5}),Ie&&pe.length>0&&e.jsx("ul",{role:"listbox",className:"absolute left-0 right-0 mt-1 max-h-32 lg:max-w-60 overflow-auto bg-[#0b3856] border rounded-lg shadow-lg z-[200] custom-scroll",children:pe.map((te,ce)=>e.jsx("li",{role:"option",onMouseDown:Re=>Re.preventDefault(),onClick:()=>{var Te,qe;const Re=((Te=te.label)==null?void 0:Te.toString().trim())||((qe=te.value)==null?void 0:qe.toString().trim());Oe(Re)},className:"px-3 py-2 hover:bg-white/20 cursor-pointer text-sm",children:te.label||te.value},`${te.value}-${ce}`))})]})}),e.jsxs("div",{className:"md:col-span-1 flex items-center justify-center md:justify-end gap-1",children:[e.jsx("button",{type:"submit",className:"bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-5 py-2 rounded-lg w-full md:w-28 text-base font-medium transition-colors duration-300",children:"Search"}),e.jsx("button",{type:"button",onClick:()=>{i(""),o(""),d([]),g(""),x(""),c(""),p(""),G(""),oe(""),a("/properties",{replace:!0})},className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-5 py-2 rounded-lg w-full md:w-28 text-base font-medium transition-colors duration-300",children:"Reset"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[b.map((te,ce)=>e.jsxs("div",{className:"flex items-center bg-white/30 text-white px-2 py-1 rounded-full text-xs",children:[e.jsx("span",{className:"mr-1",children:te}),e.jsx("button",{type:"button",onClick:Re=>{Re.preventDefault(),Re.stopPropagation(),rs(ce)},className:"text-gray-200 hover:text-white","aria-label":`Remove locality ${te}`,children:"Ã—"})]},ce)),b.length<5&&e.jsx("div",{className:"text-xs text-white px-2 py-1",children:"Add up to 1 localities."})]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h2",{className:"text-xl font-bold text-[#0b3856] flex items-center gap-3 flex-wrap",children:["All Properties ",!D&&!H&&`(${cs.length})`,V&&!D&&A.length>0&&e.jsxs("div",{className:`\r
      flex items-center gap-2\r
      bg-white\r
      border border-gray-100\r
      shadow-sm\r
      px-4 py-2\r
      rounded-xl\r
      text-sm\r
      w-full sm:w-[520px] lg:w-[800px]\r
    `,children:[e.jsx(Mt,{className:"text-[#E6761D] shrink-0",size:22}),e.jsxs("div",{className:"flex-1 leading-snug",children:[e.jsx("div",{className:"font-semibold text-gray-800",children:"AI Recommendations"}),e.jsxs("div",{className:"text-gray-600 text-xs",children:["Found ",e.jsx("span",{className:"font-medium text-gray-800",children:A.length})," public properties.",e.jsxs("span",{className:"ml-1",children:[n||"Top areas"," show strong growth potential."]})]})]}),e.jsx("button",{onClick:()=>W(!1),className:`\r
        text-gray-500\r
        hover:text-gray-800\r
        hover:bg-gray-100\r
        px-2 py-1\r
        rounded-lg\r
        transition\r
      `,"aria-label":"Close AI recommendations",children:"Ã—"})]})]}),!!(n||b.length||v)&&e.jsxs("p",{className:"text-gray-600 text-sm",children:[n&&`in ${n} â€¢ `,b.length>0&&`${b.join(", ")} â€¢ `,v&&`${((z=Ce.find(te=>(te.value||te.label)===v))==null?void 0:z.label)||v} â€¢ `,"Showing ",Ze+1,"-",Math.min(Ze+E,gs.length)," of"," ",cs.length," results"]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>$("grid"),className:`p-2 rounded-lg w-10 h-10 flex items-center justify-center ${w==="grid"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:e.jsx(Uc,{size:18})}),e.jsx("button",{onClick:()=>$("list"),className:`p-2 rounded-lg w-10 h-10 flex items-center justify-center ${w==="list"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:e.jsx(dn,{size:18})})]})]}),e.jsxs("div",{className:"flex items-end justify-end gap-3 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(rt,{className:"text-blue-600",size:16}),e.jsx("span",{children:"AI-Powered Search"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:Ge,"aria-expanded":y,"aria-controls":"advanced-filters-panel",className:"bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-3 py-1 flex gap-1 text-xs items-center rounded-xl transition-colors font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#E6761D]",children:[e.jsx(ro,{size:12}),e.jsx("span",{className:"hidden md:inline",children:"Filters"}),e.jsx(ea,{size:14,className:`transition-transform ${y?"rotate-180":""}`})]}),y&&e.jsxs("div",{id:"advanced-filters-panel",ref:We,className:"absolute right-0 top-full mt-2 z-20 w-[min(92vw,1000px)] bg-white rounded-2xl shadow-lg p-6 border border-gray-200 max-h-[70vh] overflow-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#0b3856] mb-4",children:"Advanced Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Location"}),e.jsxs("select",{value:n,onChange:te=>{const ce=te.target.value||"";o(ce),ce&&ce.split(",").map(Re=>Re.trim()).filter(Boolean).length===1&&d([])},disabled:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:opacity-60 text-xs",children:[e.jsx("option",{value:"",children:Y?"Loading locations...":"All Locations"}),Xe.map(te=>e.jsx("option",{value:te.value,children:te.label},te.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Budget"}),e.jsxs("select",{value:v,onChange:te=>x(te.target.value),disabled:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:opacity-60 text-xs",children:[e.jsx("option",{value:"",children:Y?"Loading budgets...":"Any Budget"}),Ce.map(te=>e.jsx("option",{value:te.value||te.label,children:te.label||te.value},te.value||te.label))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsxs("select",{value:u,onChange:te=>{c(te.target.value),je(te.target.value)},disabled:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:opacity-60 text-xs",children:[e.jsx("option",{value:"",children:Y?"Loading types...":"All Types"}),ae.map(te=>e.jsx("option",{value:te.value,children:te.label},te.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bedrooms"}),e.jsxs("select",{value:f,onChange:te=>p(te.target.value),disabled:Y,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:opacity-60 text-xs",children:[e.jsx("option",{value:"",children:Y?"Loading...":"Any"}),ie.map(te=>e.jsx("option",{value:te.value,children:te.label},te.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsx("select",{value:N,onChange:te=>P(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:[{value:"relevance",label:"Most Relevant"},{value:"price_low",label:"Price: Low to High"},{value:"price_high",label:"Price: High to Low"},{value:"newest",label:"Newest First"},{value:"area_large",label:"Largest First"},{value:"rating",label:"Highest Rated"},{value:"ai_score",label:"AI Score High"},{value:"price_growth",label:"Best Growth"}].map(te=>e.jsx("option",{value:te.value,children:te.label},te.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Possession"}),e.jsxs("select",{value:ue,onChange:te=>Q(te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"Ready to Move",children:"Ready to Move"}),e.jsx("option",{value:"Under Construction",children:"Under Construction"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Min Rating"}),e.jsx("input",{type:"number",min:0,max:5,step:.1,value:C,onChange:te=>J(te.target.value===""?null:Number(te.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Floor (min)"}),e.jsx("input",{type:"number",value:ge,onChange:te=>ee(te.target.value===""?"":Number(te.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"e.g. 1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Floor (max)"}),e.jsx("input",{type:"number",value:de,onChange:te=>U(te.target.value===""?"":Number(te.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"e.g. 10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bathrooms (min)"}),e.jsx("input",{type:"text",min:0,value:X,onChange:te=>re(te.target.value===""?"":Number(te.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"e.g. 2"})]}),e.jsxs("div",{className:"col-span-full flex gap-3 justify-end pt-2",children:[e.jsx("button",{onClick:()=>{const te=new URLSearchParams;if(b.length>0){b.forEach(Re=>{Re&&Re.trim()&&te.append("location",Re.trim())});const ce=(n||"").split(",").map(Re=>Re.trim()).filter(Boolean);ce.length>=1&&te.set("city",ce.slice(-1).join(", "))}else if(n){const Re=n.trim().split(",").map(Te=>Te.trim()).filter(Boolean);Re.length===1?te.set("city",Re[0]):Re.length>=2&&(te.set("city",Re.slice(-1).join(", ")),te.set("location",Re.slice(0,-1).join(", ")))}u&&te.set("propertyType",u),v&&te.set("budget",v),f&&te.set("bedrooms",f),C!=null&&te.set("min_rating",String(C)),ue&&te.set("possession",ue),he&&he!=="any"&&te.set("parking",he),ge!==""&&te.set("floor_min",String(ge)),de!==""&&te.set("floor_max",String(de)),X!==""&&te.set("bathrooms",String(X)),fe&&te.set("property_subtype",fe),me&&te.set("unitType",me),Fe&&te.set("transaction",Fe),r&&te.set("search",r),N&&te.set("sort",N),te.set("status","Available"),j(1),a(`/properties?${te.toString()}`,{replace:!0}),k(!1)},className:" bg-[#E6761D] text-white px-4 py-2 rounded-lg text-xs",children:"Apply Filters"}),e.jsx("button",{onClick:()=>k(!1),className:"border border-gray-300 px-4 py-2 rounded-lg text-xs hover:bg-gray-50",children:"Close"}),e.jsx("button",{onClick:()=>{o(""),x(""),c(""),p(""),i(""),J(null),Q(""),se("any"),ee(""),U(""),re(""),G(""),oe(""),d([]),g(""),je(""),$e("buy"),a("/properties",{replace:!0})},className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-xs",children:"Clear All"})]})]})]})]})]})]}),D&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(ia,{size:"lg"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Loading properties..."})]}),H&&!D&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(yt,{className:"mx-auto text-gray-300 mb-6",size:64}),e.jsx("h3",{className:"text-lg font-bold text-[#0b3856] mb-4",children:"Error Loading Properties"}),e.jsx("p",{className:"text-gray-600 mb-8",children:H}),e.jsx("button",{onClick:()=>Je(),className:"bg-blue-600 text-white px-8 py-3 rounded-xl hover:bg-blue-700 transition-colors font-semibold",children:"Try Again"})]}),!D&&!H&&e.jsxs(e.Fragment,{children:[w==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 items-stretch",children:ls.map(te=>{var ys;const ce=Fd(te),{locationPart:Re,cityPart:Te}=Bd(te),qe=Array.isArray(te.amenities)?te.amenities:[],as=qe.slice(0,2),xs=Math.max(qe.length-as.length,0),ps=te.parking||0;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 group cursor-pointer h-full flex flex-col",onClick:()=>{if(te.slug){Gs(te);return}M(te),s&&s(te)},children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:((ys=te.images)==null?void 0:ys[0])||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800",alt:String(te.title),className:"w-full h-48 object-cover group-hover:scale-110 transition-transform duration-500"}),e.jsxs("div",{className:"absolute top-3 left-3 flex items-center flex-wrap gap-2 z-20",children:[e.jsx(Od,{tags:te.tags||[]}),(te.aiScore??0)>=90&&e.jsxs("span",{className:"flex items-center bg-purple-600 text-white px-2 py-[3px] rounded-full text-[8px] sm:text-xs font-bold whitespace-nowrap shadow-sm",children:[e.jsx(Mt,{size:12,className:"mr-1"}),"AI ",Math.round(te.aiScore??0)]})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("span",{className:"text-white text-2xl font-bold opacity-40 select-none",children:"ResaleExpert.in"})}),e.jsxs("div",{className:"absolute bottom-3 right-3 bg-black/50 text-white px-2 py-1 rounded-full text-xs flex items-center space-x-1",children:[e.jsx(ks,{size:10}),e.jsx("span",{children:te.total_views||te.views||0})]})]}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-[#0b3856] mb-1 group-hover:text-[#E6761D] transition-colors",children:ce}),e.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[e.jsx(Qs,{size:14,className:"mr-1"}),e.jsxs("span",{children:[Re,Re&&Te?", ":"",Te]})]})]}),e.jsx("div",{className:"ml-2 shrink-0 text-[10px] sm:text-xs text-gray-500 font-medium",children:te.propertyId||`REX${String(te.id??"").padStart(4,"0")}`})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:zd(te.price)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[te.type||te.property_type," â€¢ ",te.area||te.square_feet," sq ft"]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Xs,{className:"text-yellow-400 fill-current",size:14}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:(te.rating||4.2).toFixed(1)}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",te.reviews||0," reviews)"]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:te.postedDate})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3 p-2 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rs,{size:12}),e.jsx("span",{className:"text-xs text-green-600 font-semibold",children:te.priceGrowth||"+12%"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ot,{size:12}),e.jsxs("span",{className:"text-xs text-blue-600 font-semibold",children:["Grade ",te.investmentGrade||"A"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(jl,{size:12}),e.jsxs("span",{children:[te.bedrooms," Beds"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{size:12}),e.jsxs("span",{children:[te.bathrooms," Baths"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Sl,{size:12}),e.jsxs("span",{children:[ps," Parking"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[as.map((He,vs)=>e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs",children:[x0(He),e.jsx("span",{children:He})]},vs)),xs>0&&e.jsxs("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs",children:["+",xs]})]}),e.jsxs("div",{className:"mt-auto flex items-center space-x-2",children:[typeof te.slug=="string"&&te.slug.trim().length>0?e.jsx("div",{className:"flex-1",children:e.jsx("button",{onClick:He=>{He.stopPropagation(),Gs(te)},className:"w-full bg-[#E6761D] hover:bg-[#CC6A1A] text-white py-2 px-3 rounded-lg font-medium transition-colors duration-300 text-sm shadow-md",children:"View Details"})}):e.jsx("button",{disabled:!0,"aria-disabled":"true",title:"Details not available â€“ missing backend slug",className:"w-full bg-gray-300 text-gray-600 py-2 px-3 rounded-lg cursor-not-allowed text-sm",children:"View Details"}),e.jsx("button",{onClick:He=>{var _s;He.stopPropagation();const vs=((_s=te.executiveTo)==null?void 0:_s.phone)||"919999999999";vs!=="Not Available"&&window.open(`tel:${vs}`)},className:"p-2 rounded-lg transition-colors duration-300 bg-green-50 text-green-600 hover:bg-green-600 hover:text-white",title:"Call",children:e.jsx(Cs,{size:16})}),e.jsx("button",{onClick:He=>{var vt,De;He.stopPropagation(),He.preventDefault();const vs=((De=(vt=te==null?void 0:te.executiveTo)==null?void 0:vt.phone)==null?void 0:De.replace(/\D/g,""))||"9637009639",_s=(te==null?void 0:te.title)||[te==null?void 0:te.type].filter(Boolean).join(" ")||"a property",et=(te==null?void 0:te.location)||(te==null?void 0:te.city)||"your listed property location",ts=Number((te==null?void 0:te.price)||0),js=isNaN(ts)?"Price on request":`â‚¹${ts.toLocaleString("en-IN")}`,Fs=te!=null&&te.slug?`${window.location.origin}/properties/${encodeURIComponent(String(te.slug))}`:`${window.location.origin}/properties`,ht=`Hi, I'm interested in ${_s} at ${et}. Price: ${js}. Can you share more details?
${Fs}`;window.open(`https://wa.me/${vs}?text=${encodeURIComponent(ht)}`,"_blank","noopener,noreferrer")},className:"p-2 rounded-lg transition-colors duration-300 bg-[#25D366] text-white hover:bg-[#1ebe57]",title:"WhatsApp",type:"button",children:e.jsx(Ia,{size:16})})]})]})]},te.id)})}):e.jsx("div",{className:"space-y-6",children:ls.map(te=>{var xs;const ce=Fd(te),Re=u0(te),{locationPart:Te,cityPart:qe}=Bd(te),as=te.parking||0;return e.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all group cursor-pointer",onClick:()=>{if(te.slug){Gs(te);return}M(te),s&&s(te)},children:e.jsxs("div",{className:"md:flex",children:[e.jsxs("div",{className:"md:w-1/3 relative",children:[e.jsx("img",{src:((xs=te.images)==null?void 0:xs[0])||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800",alt:String(te.title),className:"w-full h-64 md:h-full object-cover group-hover:scale-105 transition-transform duration-500"}),e.jsx("div",{className:"absolute top-3 left-3 flex space-x-2",children:e.jsx(Od,{tags:te.tags||[]})}),e.jsxs("div",{className:"absolute bottom-3 right-3 bg-black bg-opacity-50 text-white px-2 py-1 rounded-full text-xs flex items-center space-x-1",children:[e.jsx(ks,{size:10}),e.jsxs("span",{children:[te.total_views||te.views||0," views"]})]})]}),e.jsxs("div",{className:"md:w-2/3 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#0b3856] mb-2 group-hover:text-blue-600 transition-colors",children:ce}),e.jsxs("div",{className:"flex items-center text-gray-600 mb-2",children:[e.jsx(Qs,{size:16,className:"mr-2"}),e.jsxs("span",{children:[Te,Te&&qe?", ":"",qe]})]}),e.jsx("div",{className:"text-sm text-gray-600",children:e.jsx("span",{children:Re})})]}),e.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-50 px-2 py-1 rounded-lg",children:[e.jsx(Xs,{size:16}),e.jsx("span",{className:"font-semibold text-gray-700",children:(te.rating||4.2).toFixed(1)}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",te.reviews||0,")"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:zd(te.price)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["â‚¹",Math.round(te.price/(te.area||te.square_feet||1)).toLocaleString(),"/sq ft"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx(jl,{className:"mx-auto text-gray-600 mb-1",size:20}),e.jsx("div",{className:"font-semibold text-[#0b3856]",children:te.bedrooms}),e.jsx("div",{className:"text-xs text-gray-500",children:"Bedrooms"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx(Is,{className:"mx-auto text-gray-600 mb-1",size:20}),e.jsx("div",{className:"font-semibold text-[#0b3856]",children:te.bathrooms}),e.jsx("div",{className:"text-xs text-gray-500",children:"Bathrooms"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx(yt,{className:"mx-auto text-gray-600 mb-1",size:20}),e.jsx("div",{className:"font-semibold text-[#0b3856]",children:te.area||te.square_feet}),e.jsx("div",{className:"text-xs text-gray-500",children:"Sq Ft"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx(Sl,{className:"mx-auto text-gray-600 mb-1",size:20}),e.jsx("div",{className:"font-semibold text-[#0b3856]",children:as}),e.jsx("div",{className:"text-xs text-gray-500",children:"Parking"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded-lg",children:[e.jsx(Rs,{className:"mx-auto text-green-600 mb-1",size:16}),e.jsx("div",{className:"text-sm font-semibold text-green-600",children:te.priceGrowth||"+12%"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Growth"})]}),e.jsxs("div",{className:"text-center p-2 bg-purple-50 rounded-lg",children:[e.jsx(Mt,{className:"mx-auto text-purple-600 mb-1",size:16}),e.jsx("div",{className:"text-sm font-semibold text-purple-600",children:te.aiScore||85}),e.jsx("div",{className:"text-xs text-gray-500",children:"AI Score"})]}),e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded-lg",children:[e.jsx(Ot,{className:"mx-auto text-blue-600 mb-1",size:16}),e.jsx("div",{className:"text-sm font-semibold text-blue-600",children:te.investmentGrade||"A"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Grade"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"text-sm text-gray-500",children:["Posted ",te.postedDate]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[typeof te.slug=="string"&&te.slug.trim().length>0?e.jsx("button",{onClick:ps=>{ps.stopPropagation(),Gs(te)},className:" bg-[#E6761D] text-white px-6 py-2 rounded-lg hover:bg-[#E6761D] transition-colors font-medium",children:"View Details"}):e.jsx("button",{disabled:!0,"aria-disabled":"true",title:"Details not available â€“ missing backend slug",className:"bg-gray-300 text-gray-600 px-6 py-2 rounded-lg cursor-not-allowed",children:"View Details"}),e.jsx("button",{onClick:ps=>{ps.stopPropagation(),F(ys=>ys.includes(te.id.toString())?ys.filter(He=>He!==te.id.toString()):[...ys,te.id.toString()])},className:"p-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:e.jsx(Ra,{size:16,className:R.includes(te.id.toString())?"text-red-500 fill-current":"text-gray-600"})})]})]})]})]})},te.id)})}),Ne>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-10",children:[e.jsx("button",{onClick:()=>j(te=>Math.max(te-1,1)),disabled:T===1,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,Ne)},(te,ce)=>{const Re=ce+1;return e.jsx("button",{onClick:()=>j(Re),className:`px-4 py-2 rounded-lg ${T===Re?"bg-blue-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:Re},Re)})}),e.jsx("button",{onClick:()=>j(te=>Math.min(te+1,Ne)),disabled:T===Ne,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),!D&&!H&&cs.length===0&&A.length>0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(yt,{className:"mx-auto text-gray-300 mb-6",size:64}),e.jsx("h3",{className:"text-2xl font-bold text-[#0b3856] mb-4",children:"No Properties Found"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Try adjusting your search criteria or browse all properties"}),e.jsx("button",{onClick:()=>{i(""),o(""),x(""),c(""),p(""),d([]),g(""),je(""),$e("buy")},className:"bg-blue-600 text-white px-8 py-3 rounded-xl hover:bg-blue-700 transition-colors font-semibold",children:"Clear Filters"})]}),!D&&!H&&A.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(yt,{className:"mx-auto text-gray-300 mb-6",size:64}),e.jsx("h3",{className:"text-2xl font-bold text-[#0b3856] mb-4",children:"No Properties Available (0)"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Properties will appear here once they are added to the system"}),e.jsx("button",{onClick:()=>Je(),className:"bg-blue-600 text-white px-8 py-3 rounded-xl hover:bg-blue-700 transition-colors font-semibold",children:"Refresh Page"})]})]})]})},y0=()=>{const s=[{label:"Properties Sold",value:"10,000+",icon:yt},{label:"Happy Customers",value:"25,000+",icon:Ns},{label:"Years of Experience",value:"12+",icon:Ct},{label:"Cities Covered",value:"50+",icon:Is}],a=[{icon:at,title:"Trust & Transparency",description:"We believe in complete transparency in all our dealings. Every property is verified, and all information is accurate and up-to-date."},{icon:rt,title:"Customer First",description:"Our customers are at the heart of everything we do. We go above and beyond to ensure their real estate journey is smooth and successful."},{icon:Xs,title:"Excellence",description:"We strive for excellence in every aspect of our service, from property listings to customer support and after-sales service."},{icon:Ra,title:"Integrity",description:"We conduct our business with the highest level of integrity, ensuring fair deals and honest communication with all parties."}],t=[{name:"Laxman Vhadade",role:"Founder & CEO",experience:"15+ years",specialization:"Luxury Properties",image:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=300"}],r=[{year:"2013",title:"Company Founded",description:"Started with a vision to revolutionize real estate in Pune"},{year:"2015",title:"Digital Transformation",description:"Launched online platform and mobile app for seamless property search"},{year:"2018",title:"Pan-India Expansion",description:"Expanded operations to 25+ cities across India"},{year:"2020",title:"AI Integration",description:"Introduced AI-powered property matching and market analysis"},{year:"2023",title:"Industry Recognition",description:'Awarded "Best Real Estate Platform" by Property Awards India'}],{systemSettings:i}=ur(),n=i==null?void 0:i.company_name;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("section",{className:" text-white py-32 pt-28 ",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-3 text-white",children:["AboutÂ ",n]}),e.jsx("p",{className:"text-lg text-blue-100 mb-4 max-w-3xl mx-auto",children:"India's most trusted real estate platform, connecting millions of buyers, sellers, and renters with verified properties and expert guidance since 2010."}),e.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:"12+"}),e.jsx("div",{className:"text-blue-200",children:"Years Experience"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:"10K+"}),e.jsx("div",{className:"text-blue-200",children:"Properties Sold"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold text-white",children:"25K+"}),e.jsx("div",{className:"text-blue-200",children:"Happy Customers"})]})]})]})})}),e.jsx("section",{className:"py-3 bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Our Mission"}),e.jsx("p",{className:"text-lg text-gray-700 mb-6 leading-relaxed",children:"To make real estate transactions transparent, efficient, and accessible for everyone. We leverage technology and expertise to simplify the complex process of buying, selling, and renting properties."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bs,{className:"text-green-600",size:20}),e.jsx("span",{className:"text-gray-700",children:"100% Verified Properties"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bs,{className:"text-green-600",size:20}),e.jsx("span",{className:"text-gray-700",children:"Expert Legal Guidance"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bs,{className:"text-green-600",size:20}),e.jsx("span",{className:"text-gray-700",children:"End-to-End Support"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bs,{className:"text-green-600",size:20}),e.jsx("span",{className:"text-gray-700",children:"AI-Powered Matching"})]})]})]}),e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:"https://images.pexels.com/photos/3184291/pexels-photo-3184291.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Our Mission",className:"rounded-2xl shadow-xl w-full object-cover"}),e.jsxs("div",{className:"absolute -bottom-4 left-4 bg-white px-4 py-2 rounded-full shadow-lg flex items-center gap-2 border border-gray-200",children:[e.jsx(Rs,{className:"text-blue-600 w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"98% Customer Satisfaction"})]})]})]})})}),e.jsx("section",{className:"py-3",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Our Impact in Numbers"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Trusted by thousands of customers across India"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:s.map((o,m)=>{const g=o.icon;return e.jsxs("div",{className:"text-center group",children:[e.jsx("div",{className:"bg-[#E6761D] w-10 h-10 rounded-2xl flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform",children:e.jsx(g,{className:"text-white",size:20})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-2",children:o.value}),e.jsx("div",{className:"text-gray-600",children:o.label})]},m)})})]})}),e.jsx("section",{className:"py-3 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Our Core Values"}),e.jsx("p",{className:"text-xl text-gray-600",children:"The principles that guide everything we do"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:a.map((o,m)=>{const g=o.icon;return e.jsx("div",{className:"bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-[#E6761D] p-3 rounded-xl",children:e.jsx(g,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:o.title}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:o.description})]})]})},m)})})]})}),e.jsx("section",{className:"py-3",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Meet Our Expert Team"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Experienced professionals dedicated to your success"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:t.map((o,m)=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:o.image,alt:o.name,className:"w-full h-64 object-cover group-hover:scale-105 transition-transform"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:o.name}),e.jsx("div",{className:"text-blue-600 font-medium mb-2",children:o.role}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[o.experience," experience"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Specializes in ",o.specialization]})]})]},m))})]})}),e.jsx("section",{className:"py-3 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Our Journey"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Milestones that shaped our success story"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 w-1 h-full bg-[#0c3854]"}),e.jsx("div",{className:"space-y-12",children:r.map((o,m)=>e.jsxs("div",{className:`flex items-center ${m%2===0?"flex-row":"flex-row-reverse"}`,children:[e.jsx("div",{className:`w-1/2 ${m%2===0?"pr-8 text-right":"pl-8 text-left"}`,children:e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-2",children:o.year}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:o.title}),e.jsx("p",{className:"text-gray-700",children:o.description})]})}),e.jsx("div",{className:"relative z-10",children:e.jsx("div",{className:"w-12 h-12 bg-[#E6761D] rounded-full flex items-center justify-center",children:e.jsx(Xs,{className:"text-white",size:20})})}),e.jsx("div",{className:"w-1/2"})]},m))})]})]})}),e.jsx("section",{className:"py-3 bg-gradient-to-r from-blue-50 to-purple-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Awards & Recognition"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Industry recognition for our excellence"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-8 text-center shadow-lg",children:[e.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 w-10 h-10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(va,{className:"text-white",size:20})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Best Real Estate Platform 2023"}),e.jsx("p",{className:"text-gray-600",children:"Property Awards India"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-8 text-center shadow-lg",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-emerald-500 w-10 h-10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ct,{className:"text-white",size:20})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Customer Choice Award 2022"}),e.jsx("p",{className:"text-gray-600",children:"Real Estate Excellence Awards"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-8 text-center shadow-lg",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-indigo-500 w-10 h-10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Xl,{className:"text-white",size:20})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Innovation in PropTech 2021"}),e.jsx("p",{className:"text-gray-600",children:"Technology Innovation Awards"})]})]})]})})]})},Ri="/assets/png/RE-C-KQu9TZ.png",j0=({open:s,onClose:a,title:t="Talk to an Expert",phoneE164:r="+919637009639",displayPhone:i="+91 9637 00 9639",availabilityText:n="Available 9:00 AM â€“ 9:00 PM (IST)",initialSubject:o="",presetMessage:m="",meta:g=null})=>{if(!s)return null;const b=r.replace(/\D/g,""),d=`tel:${r}`,x=`https://wa.me/${b}?text=${(()=>{const u=m&&m.trim()||"Hi team, I'm interested in your services. Please guide me.";return encodeURIComponent(u)})()}`;return e.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-end sm:items-center justify-center p-3 bg-black/70 backdrop-blur-sm animate-[fadeIn_0.2s_ease]",role:"dialog","aria-modal":"true","aria-labelledby":"contact-modal-title",onClick:a,children:[e.jsxs("div",{className:"w-full max-w-sm bg-gradient-to-br from-indigo-50 via-white to-purple-50 rounded-2xl shadow-xl overflow-hidden transform transition-all animate-[slideUp_0.25s_ease] relative",onClick:u=>u.stopPropagation(),children:[e.jsx("div",{className:"pointer-events-none absolute top-0 right-0 w-24 h-24 bg-gradient-to-br from-purple-400/20 to-transparent rounded-full blur-2xl"}),e.jsx("div",{className:"pointer-events-none absolute -bottom-6 -left-6 w-24 h-24 bg-gradient-to-tr from-indigo-400/20 to-transparent rounded-full blur-2xl"}),e.jsxs("div",{className:"relative flex items-center justify-between px-4 py-3 border-b border-white-200/60 bg-white/80 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-full bg-white flex items-center justify-center shadow",children:e.jsx("img",{src:Ri,alt:"RE",className:"w-7 h-7 object-contain"})}),e.jsx("h3",{id:"contact-modal-title",className:"text-base font-semibold text-gray-900",children:t})]}),e.jsx("button",{onClick:a,className:"p-1.5 hover:bg-gray-200/70 rounded-full transition-all duration-200 hover:rotate-90","aria-label":"Close",children:e.jsx(ns,{size:16,className:"text-gray-600"})})]}),e.jsxs("div",{className:"relative px-4 py-4 space-y-4",children:[(o||m)&&e.jsxs("div",{className:"rounded-lg border border-indigo-100 bg-white/70 px-3 py-2",children:[o&&e.jsxs("div",{className:"text-[11px] font-semibold text-indigo-700",children:["Service:Â ",e.jsx("span",{className:"font-bold",children:o})]}),m&&e.jsx("div",{className:"text-[11px] text-gray-600 mt-0.5",children:m})]}),e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed text-center",children:"Choose your preferred way to reach us. We're here to help and usually respond within minutes."}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",className:"group relative overflow-hidden rounded-lg bg-gradient-to-br from-green-500 to-green-600 shadow-sm hover:shadow-md transition-all duration-200 hover:scale-[1.01] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-green-500/40","aria-label":"Chat on WhatsApp",children:e.jsxs("div",{className:"relative px-2.5 py-1.5 flex flex-col items-center justify-center gap-0.5 text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("svg",{className:"w-4 h-4 relative z-10",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347M12.051 22a9.87 9.87 0 0 1-5.396-1.592l-3.725.979 1-3.653A9.86 9.86 0 0 1 2 11.892C2 6.34 6.44 1.9 12 1.9s10 4.44 10 9.992C22 17.44 17.56 22 12.051 22Z"})}),e.jsx("span",{className:"text-[11px] font-medium relative z-10",children:"WhatsApp"})]})}),e.jsx("a",{href:d,className:"group relative overflow-hidden rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 shadow-sm hover:shadow-md transition-all duration-200 hover:scale-[1.01] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-blue-500/40","aria-label":`Call ${i}`,children:e.jsxs("div",{className:"relative px-2.5 py-1.5 flex flex-col items-center justify-center gap-0.5 text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx(Cs,{className:"w-4 h-4 relative z-10"}),e.jsx("span",{className:"text-[11px] font-medium relative z-10",children:"Call Now"})]})})]}),e.jsx("div",{className:"text-center",children:e.jsx("a",{href:d,className:"inline-block text-base font-bold text-gray-900 hover:text-indigo-600 transition-colors",children:i})}),e.jsxs("div",{className:"flex items-center justify-center gap-2 px-3 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-100",children:[e.jsx(Ls,{size:14,className:"text-indigo-600"}),e.jsx("span",{className:"text-[11px] font-medium text-gray-700",children:n})]})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
      `})]})},v0={blue:{bg:"bg-blue-500",hover:"hover:bg-blue-600",text:"text-blue-600",lite:"bg-blue-50",dotBg:"bg-blue-100",dotText:"text-blue-700"},green:{bg:"bg-green-500",hover:"hover:bg-green-600",text:"text-green-600",lite:"bg-green-50",dotBg:"bg-green-100",dotText:"text-green-700"},purple:{bg:"bg-purple-500",hover:"hover:bg-purple-600",text:"text-purple-600",lite:"bg-purple-50",dotBg:"bg-purple-100",dotText:"text-purple-700"},orange:{bg:"bg-orange-500",hover:"hover:bg-orange-600",text:"text-orange-600",lite:"bg-orange-50",dotBg:"bg-orange-100",dotText:"text-orange-700"},indigo:{bg:"bg-indigo-500",hover:"hover:bg-indigo-600",text:"text-indigo-600",lite:"bg-indigo-50",dotBg:"bg-indigo-100",dotText:"text-indigo-700"},pink:{bg:"bg-pink-500",hover:"hover:bg-pink-600",text:"text-pink-600",lite:"bg-pink-50",dotBg:"bg-pink-100",dotText:"text-pink-700"}},N0=()=>{const[s,a]=Ps.useState(!1),[t,r]=Ps.useState(null),i="+91 9637 00 9639",n="+919637009639",o=[{id:"property-buying",title:"Property Buying",subtitle:"Find Your Dream Home",description:"Comprehensive assistance in finding and purchasing your perfect property with expert guidance and verified listings.",icon:yt,color:"blue",features:["AI-powered property matching","Verified property listings","Expert property evaluation","Negotiation support","Legal documentation assistance","Post-purchase support"],process:["Requirement Analysis","Property Shortlisting","Site Visits & Evaluation","Price Negotiation","Legal Verification","Registration & Handover"],price:"No Hidden Charges",duration:"15-30 days",successRate:"95%"},{id:"property-selling",title:"Property Selling",subtitle:"Maximize Your Returns",description:"End-to-end selling support with premium marketing, verified buyers, and transparent pricing to get the best value.",icon:Is,color:"green",features:["Professional property photography","Multi-channel marketing","Verified buyer database","Price optimization strategies","Legal documentation support","Hassle-free transactions"],process:["Property Valuation","Documentation Review","Marketing & Promotion","Buyer Screening","Negotiation & Closure","Registration Support"],price:"2% Commission",duration:"30-60 days",successRate:"92%"},{id:"loan-assistance",title:"Home Loan Assistance",subtitle:"Best Rates Guaranteed",description:"Get the best home loan deals with our banking partnerships and expert assistance throughout the process.",icon:Ut,color:"purple",features:["Multiple bank partnerships","Competitive interest rates","Quick loan approval","Documentation support","EMI calculation tools","Loan processing assistance"],process:["Eligibility Assessment","Bank Selection","Application Submission","Documentation Support","Loan Approval","Disbursement"],price:"Free Service",duration:"3-15 days",successRate:"99%"},{id:"legal-services",title:"Legal Services",subtitle:"Complete Documentation",description:"Expert legal services for all property transactions with experienced lawyers and transparent pricing.",icon:ws,color:"orange",features:["Title verification","Legal document preparation","Due diligence support","Registration assistance","Dispute resolution","Compliance support"],process:["Document Review","Title Verification","Legal Opinion","Agreement Drafting","Registration Support","Post-transaction Support"],price:"â‚¹10,000 onwards",duration:"5-10 days",successRate:"99%"},{id:"property-management",title:"Property Management",subtitle:"Hassle-Free Rentals",description:"Complete property management services including tenant screening, rent collection, and maintenance.",icon:at,color:"indigo",features:["Tenant screening & verification","Rent collection management","Property maintenance","Legal compliance support","Regular property inspections","24/7 customer support"],process:["Property Assessment","Tenant Sourcing","Agreement Execution","Move-in Support","Ongoing Management","Renewal/Exit Support"],price:"8% of rental income",duration:"Ongoing",successRate:"96%"},{id:"investment-advisory",title:"Investment Advisory",subtitle:"Smart Investment Decisions",description:"Data-driven investment advice with market analysis and portfolio recommendations for maximum returns.",icon:Rs,color:"pink",features:["Market trend analysis","Investment opportunity identification","ROI calculations","Risk assessment","Portfolio diversification","Exit strategy planning"],process:["Investment Goal Analysis","Market Research","Opportunity Identification","Risk Assessment","Investment Execution","Performance Monitoring"],price:"â‚¹25,000 consultation",duration:"30-45 days",successRate:"85%"}],m=[{title:"Property Valuation",description:"Professional property valuation for accurate market pricing",icon:sr,price:"Contact for Pricing"},{title:"Virtual Property Tours",description:"360Â° virtual tours for remote property viewing",icon:ks,price:"Contact for Pricing"},{title:"Market Research Reports",description:"Detailed market analysis and trends for specific areas",icon:it,price:"Contact for Pricing"},{title:"Interior Design Consultation",description:"Expert interior design advice for home staging",icon:gu,price:"Contact for Pricing"}],g=[{title:"12+ Years Experience",description:"Decades of expertise in real estate",icon:Ct,stat:"12+"},{title:"Verified Properties",description:"100% legal and verified listings",icon:at,stat:"100%"},{title:"Expert Team",description:"Certified real estate professionals",icon:Ns,stat:"50+"},{title:"Customer Satisfaction",description:"Happy customers across India",icon:Xs,stat:"98%"}],b=[{step:"1",title:"Consultation",description:"Free consultation to understand your requirements"},{step:"2",title:"Planning",description:"Detailed planning and strategy development"},{step:"3",title:"Execution",description:"Professional execution with regular updates"},{step:"4",title:"Completion",description:"Successful completion with post-service support"}],[d,v]=Ps.useState(null),x=p=>v(N=>N===p?null:p),{systemSettings:u}=ur(),c=u==null?void 0:u.company_name,f=p=>{r({id:p.id,title:p.title}),a(!0)};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("section",{className:"text-white py-32 pt-28",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-3 text-white",children:"Complete Real Estate Solutions"}),e.jsx("p",{className:"text-lg mb-4 text-blue-100 max-w-4xl mx-auto leading-relaxed",children:"From property search to final registration, we provide end-to-end real estate services with expert guidance and transparent pricing"}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{className:`inline-flex items-center justify-center\r
               w-full max-w-[240px] sm:max-w-none sm:w-auto\r
               px-4 sm:px-5 py-2 sm:py-2\r
               text-[13px] sm:text-base\r
               rounded-lg sm:rounded-xl\r
               font-semibold text-white\r
               shadow-md ring-1 ring-white/20\r
               hover:shadow-lg active:scale-[0.98]\r
               transition`,style:{backgroundColor:"#E6761D"},onMouseEnter:p=>p.currentTarget.style.backgroundColor="#CC6A1A",onMouseLeave:p=>p.currentTarget.style.backgroundColor="#E6761D",onClick:()=>a(!0),children:"Get Free Consultation"})})]})})}),e.jsx("section",{className:"py-3 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Our Core Services"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Comprehensive real estate solutions tailored to your specific needs"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-stretch",children:o.map(p=>{const N=p.icon,P=v0[p.color],w=p.id==="investment-advisory";return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all group h-full flex flex-col p-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-4",children:[e.jsx("div",{className:`p-4 rounded-2xl group-hover:shadow-lg transition-all ${P.bg}`,children:e.jsx(N,{className:"text-white",size:22})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:p.title}),e.jsx("p",{className:`${P.text} font-semibold mb-3`,children:p.subtitle}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:p.description})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Key Features"}),e.jsx("ul",{className:"space-y-2",children:p.features.map(($,y)=>e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:`${P.text}`,size:16}),e.jsx("span",{className:"text-gray-700 text-sm",children:$})]},y))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Process Steps"}),e.jsx("ol",{className:"space-y-2",children:p.process.map(($,y)=>e.jsxs("li",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-6 h-6 ${P.dotBg} ${P.dotText} rounded-full flex items-center justify-center text-xs font-bold`,children:y+1}),e.jsx("span",{className:"text-gray-700 text-sm",children:$})]},y))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:`text-center p-3 ${P.lite} rounded-lg`,children:[e.jsx("div",{className:`text-lg font-bold ${P.text}`,children:p.price}),e.jsx("div",{className:"text-xs text-gray-600",children:"Pricing"})]}),e.jsxs("div",{className:`text-center p-3 ${P.lite} rounded-lg`,children:[e.jsx("div",{className:`text-lg font-bold ${P.text}`,children:p.duration}),e.jsx("div",{className:"text-xs text-gray-600",children:"Duration"})]}),e.jsxs("div",{className:`text-center p-3 ${P.lite} rounded-lg`,children:[e.jsx("div",{className:`text-lg font-bold ${P.text}`,children:p.successRate}),e.jsx("div",{className:"text-xs text-gray-600",children:"Success Rate"})]})]})]}),e.jsx("button",{className:`w-full mt-6 py-3 px-6 rounded-xl font-semibold transition-all group-hover:shadow-lg ${w?"bg-pink-500 text-white hover:bg-pink-600":`${P.bg} text-white ${P.hover}`}`,onClick:()=>f({id:p.id,title:p.title}),children:"Get Started"})]},p.id)})})]})}),e.jsx("section",{className:"py-3 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Additional Services"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Specialized services to enhance your property experience"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 items-stretch",children:m.map((p,N)=>{const P=p.icon,w=p.title.toLowerCase().replace(/\s+/g,"-");return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all group text-center h-full flex flex-col",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-100 to-gray-200 w-10 h-10 rounded-2xl flex items-center justify-center mx-auto mb-4 group-hover:from-blue-100 group-hover:to-purple-100 transition-all",children:e.jsx(P,{className:"text-gray-600 group-hover:text-blue-600",size:20})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:p.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:p.description}),e.jsx("div",{className:"text-blue-600 font-bold mb-4",children:p.price}),e.jsx("div",{className:"mt-auto",children:e.jsx("button",{onClick:()=>f({id:w,title:p.title}),className:"w-full bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-blue-100 hover:text-blue-700 transition-all",children:"Learn More"})})]},N)})})]})}),e.jsx("section",{className:"py-3  bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Why ChooseÂ ",c,"?"]}),e.jsx("p",{className:"text-lg text-gray-600",children:"Excellence backed by experience and innovation"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:g.map((p,N)=>{const P=p.icon;return e.jsxs("div",{className:"text-center group",children:[e.jsx("div",{className:"bg-white w-10 h-10 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:shadow-xl group-hover:scale-110 transition-all",children:e.jsx(P,{className:"text-blue-600",size:20})}),e.jsx("div",{className:"text-xl font-bold text-gray-800 mb-2",children:p.stat}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:p.title}),e.jsx("p",{className:"text-gray-600",children:p.description})]},N)})})]})}),e.jsx("section",{className:"py-3 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Our Service Process"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Simple, transparent, and efficient workflow"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:b.map((p,N)=>e.jsxs("div",{className:"text-center group",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-[#E6761D] rounded-full flex items-center justify-center mx-auto text-white font-bold text-xl group-hover:shadow-lg transition-all",children:p.step}),N<b.length-1&&e.jsx("div",{className:"hidden md:block absolute top-8 left-full w-full h-0.5 bg-gray-300 -translate-x-1/2"})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:p.title}),e.jsx("p",{className:"text-gray-600",children:p.description})]},N))})]})}),e.jsx("section",{className:"py-3 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Client Success Stories"}),e.jsx("p",{className:"text-lg text-gray-600",children:"What our clients say about our services"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{name:"Rajesh Kumar",service:"Property Buying",text:"ResaleExpert helped me find my dream home within my budget. Their AI matching is incredible!",rating:5,location:"Mumbai",image:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=200"},{name:"Priya Sharma",service:"Property Selling",text:"Sold my property 20% above market rate with their expert marketing strategies.",rating:5,location:"Pune",image:"https://images.pexels.com/photos/3756679/pexels-photo-3756679.jpeg?auto=compress&cs=tinysrgb&w=200"},{name:"Amit Patel",service:"Home Loan",text:"Got the best interest rate and quick approval. Saved â‚¹5L in total interest!",rating:5,location:"Delhi",image:"https://images.pexels.com/photos/2182970/pexels-photo-2182970.jpeg?auto=compress&cs=tinysrgb&w=200"}].map((p,N)=>e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow",children:[e.jsx("div",{className:"flex items-center space-x-1 mb-4",children:Array.from({length:5},(P,w)=>e.jsx(Xs,{size:16,className:"text-yellow-400 fill-current"},w))}),e.jsxs("p",{className:"text-gray-700 mb-6 leading-relaxed italic",children:['"',p.text,'"']}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:p.image,alt:p.name,className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:p.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[p.service," â€¢ ",p.location]})]})]})]},N))})]})}),e.jsx("section",{className:"py-3 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Transparent Pricing"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Choose the plan that works best for you"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 items-stretch",children:[e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-2xl p-8 hover:border-blue-500 transition-all h-full flex flex-col",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Basic"}),e.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"Free"}),e.jsx("p",{className:"text-gray-600",children:"Perfect for first-time users"})]}),e.jsx("ul",{className:"space-y-3 mb-8 flex-1",children:["Property search & listings","Basic property details","Contact property owners","Basic market insights"].map((p,N)=>e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-500",size:16}),e.jsx("span",{className:"text-gray-700",children:p})]},N))}),e.jsx("button",{onClick:()=>f({id:"basic-plan",title:"Basic Plan"}),className:"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-xl font-semibold hover:bg-gray-200 transition-all mt-auto",children:"Get Started"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-700 text-white rounded-2xl p-8 transform scale-105 shadow-xl h-full flex flex-col",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx(va,{className:"text-yellow-300",size:24}),e.jsx("h3",{className:"text-2xl font-bold",children:"Premium"})]}),e.jsx("div",{className:"text-4xl font-bold mb-2",children:"â‚¹2,999"}),e.jsx("p",{className:"text-blue-100",children:"Most popular choice"})]}),e.jsx("ul",{className:"space-y-3 mb-8 flex-1",children:["Everything in Basic","Expert consultation","Site visit assistance","Legal verification","Loan assistance"].map((p,N)=>e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-300",size:16}),e.jsx("span",{children:p})]},N))}),e.jsx("button",{onClick:()=>f({id:"premium-plan",title:"Premium Plan"}),className:"w-full bg-white text-blue-600 py-3 px-6 rounded-xl font-semibold hover:bg-gray-100 transition-all mt-auto",children:"Choose Premium"})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-2xl p-8 hover:border-purple-500 transition-all h-full flex flex-col",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Enterprise"}),e.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"Custom"}),e.jsx("p",{className:"text-gray-600",children:"For large portfolios"})]}),e.jsx("ul",{className:"space-y-3 mb-8 flex-1",children:["Everything in Premium","Dedicated relationship manager","Priority support","Custom solutions"].map((p,N)=>e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-500",size:16}),e.jsx("span",{className:"text-gray-700",children:p})]},N))}),e.jsx("button",{onClick:()=>f({id:"enterprise-plan",title:"Enterprise Plan"}),className:"w-full bg-purple-600 text-white py-3 px-6 rounded-xl font-semibold hover:bg-purple-700 transition-all mt-auto",children:"Contact Sales"})]})]})]})}),e.jsx("section",{className:"py-3 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Frequently Asked Questions"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Get answers to common questions about our services"})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:[{question:"What makes ResaleExpert different from other platforms?",answer:"We offer 100% verified properties, AI-powered matching, and end-to-end support with transparent pricing. Our expert team ensures a smooth experience from search to registration."},{question:"How do you verify properties?",answer:"Our verification process includes legal document checks, physical property inspection, ownership verification, and compliance checks to ensure authenticity and legal clarity."},{question:"What are your fees for selling a property?",answer:"We charge a transparent 2% commission only after successful sale. No hidden fees, no upfront charges. You pay only when we deliver results."},{question:"How long does it typically take to sell a property?",answer:"On average, properties sell within 30-60 days with our marketing strategies. Premium locations and well-priced properties often sell faster."},{question:"Do you provide legal support?",answer:"Yes, we have experienced legal partners who assist with documentation, title verification, registration, and ensure all transactions are legally compliant."}].map((p,N)=>{const P=d===N;return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>x(N),"aria-expanded":P,"aria-controls":`faq-panel-${N}`,className:"w-full flex items-center justify-between gap-4 p-6 text-left",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:p.question}),e.jsx(ea,{className:`shrink-0 transition-transform duration-300 ${P?"rotate-180":""}`})]}),e.jsx("div",{id:`faq-panel-${N}`,role:"region",className:`grid transition-[grid-template-rows] duration-300 ease-out ${P?"grid-rows-[1fr]":"grid-rows-[0fr]"}`,children:e.jsx("div",{className:"overflow-hidden",children:e.jsx("div",{className:"px-6 pb-6 pt-0 text-gray-700 leading-relaxed",children:p.answer})})})]},N)})})]})}),e.jsxs("section",{className:"py-8 text-white",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Ready to Get Started?"}),e.jsx("p",{className:"text-lg text-blue-100 mb-8 max-w-3xl mx-auto",children:"Let our experts help you with your real estate needs. Get a free consultation today!"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-6",children:[e.jsx("button",{onClick:()=>a(!0),className:"w-full sm:w-auto bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-5 py-3 rounded-xl font-semibold shadow-md transition-colors duration-300",children:"Get Free Consultation"}),e.jsxs("button",{className:"w-full sm:w-auto hover:bg-[#CC6A1A] border border-white text-white px-5 py-3 rounded-xl font-semibold shadow-md transition-colors duration-300",children:["Call Now: ",i]})]})]}),e.jsx(j0,{open:s,onClose:()=>a(!1),phoneE164:n,displayPhone:i,title:t?`Talk to an Expert â€” ${t.title}`:"Talk to an Expert",presetMessage:t?`Hi team, I'm interested in "${t.title}". Please guide me.`:"Hi team, I'm interested in your services. Please guide me."})]})]})},wr=({label:s,error:a,helpText:t,className:r,id:i,...n})=>{const o=i||`input-${Math.random().toString(36).substr(2,9)}`;return e.jsxs("div",{className:"space-y-1",children:[s&&e.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-white",children:s}),e.jsx("input",{id:o,className:$t("block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",a?"border-red-300 text-red-900 placeholder-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300",r),...n}),a&&e.jsx("p",{className:"text-sm text-red-600",children:a}),t&&!a&&e.jsx("p",{className:"text-sm text-gray-500",children:t})]})},w0=()=>{var N,P;const[s,a]=l.useState({username:"",password:""}),[t,r]=l.useState(!1),[i,n]=l.useState(!1),[o,m]=l.useState({}),{login:g}=Hs(),b=Ca(),v=((P=(N=Jr().state)==null?void 0:N.from)==null?void 0:P.pathname)||"/dashboard",{systemSettings:x}=ur(),u=x==null?void 0:x.company_name,c=w=>{const{name:$,value:y}=w.target;a(k=>({...k,[$]:y})),o[$]&&m(k=>({...k,[$]:""}))},f=()=>{const w={};return s.username.trim()||(w.username="Username is required"),s.password||(w.password="Password is required"),m(w),Object.keys(w).length===0},p=async w=>{if(w.preventDefault(),!!f()){n(!0);try{const y=await g(s);if(!y){Z.error("Invalid login response");return}const k=(y.role??"").toString().trim().toLowerCase();if(console.log("Login user:",y),console.log("Normalized role:",k),k==="buyer"&&y.buyer_id){b(`/buyer-dashboard/${y.buyer_id}`,{replace:!0});return}if(k==="seller"&&y.seller_id){b(`/seller-dashboard/${y.seller_id}`,{replace:!0});return}if(["marketing executive","sales executive","presales executive"].includes(k)){b(v||"/dashboard",{replace:!0});return}b(v||"/dashboard",{replace:!0})}catch($){Z.error(($==null?void 0:$.message)||"Login failed. Please try again.")}finally{n(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-indigo-600/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-600/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-blue-600/10 rounded-full blur-3xl"})]}),e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAxMCAwIEwgMCAwIDAgMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1vcGFjaXR5PSIwLjAzIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=')] opacity-50"}),e.jsxs("div",{className:"relative w-full max-w-7xl mx-auto flex flex-col lg:flex-row items-center gap-12 z-10",children:[e.jsxs("div",{className:"flex-1 text-center lg:text-left space-y-8 px-4",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 backdrop-blur-sm rounded-full border border-indigo-500/20",children:[e.jsx(zt,{className:"h-4 w-4 text-indigo-400"}),e.jsx("span",{className:"text-sm font-medium text-indigo-300",children:"AI-Powered CRM Platform"})]}),e.jsxs("h1",{className:"text-4xl lg:text-6xl font-bold text-white leading-tight",children:["Welcome to",e.jsx("span",{className:"block mt-2 bg-gradient-to-r from-indigo-400 via-purple-400 to-indigo-300 bg-clip-text text-transparent",children:u})]}),e.jsx("p",{className:"text-lg text-slate-300 max-w-2xl leading-relaxed",children:"Transform your real estate business with intelligent automation, streamlined workflows, and data-driven insights."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl",children:[{icon:at,title:"Secure",desc:"Enterprise-grade security",color:"from-emerald-500 to-teal-500"},{icon:Ft,title:"Fast",desc:"Lightning-quick responses",color:"from-amber-500 to-orange-500"},{icon:zt,title:"Smart",desc:"AI-powered insights",color:"from-indigo-500 to-purple-500"}].map((w,$)=>e.jsxs("div",{className:"group p-4 bg-white/5 backdrop-blur-sm rounded-2xl border border-white/10 hover:bg-white/10 hover:border-white/20 transition-all duration-300",children:[e.jsx("div",{className:`inline-flex p-3 bg-gradient-to-r ${w.color} rounded-xl mb-3 group-hover:scale-110 transition-transform duration-300`,children:e.jsx(w.icon,{className:"h-6 w-6 text-white"})}),e.jsx("h3",{className:"font-semibold text-white text-base mb-1",children:w.title}),e.jsx("p",{className:"text-sm text-slate-400",children:w.desc})]},$))})]}),e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-white/5 backdrop-blur-2xl rounded-3xl border border-white/10 shadow-2xl p-8 hover:bg-white/[0.07] transition-all duration-300",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl mb-4 shadow-lg shadow-indigo-500/50",children:e.jsx(Is,{className:"h-8 w-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Sign in to continue to your account"})]}),e.jsxs("form",{className:"space-y-5",onSubmit:p,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(wr,{label:"Username",name:"username",type:"text",autoComplete:"username",value:s.username,onChange:c,error:o.username,placeholder:"Enter your username",className:"bg-white/10 border-white/20 text-white placeholder-slate-400 focus:border-indigo-400 focus:ring-indigo-400/20"}),e.jsxs("div",{className:"relative",children:[e.jsx(wr,{label:"Password",name:"password",type:t?"text":"password",autoComplete:"current-password",value:s.password,onChange:c,error:o.password,placeholder:"Enter your password",className:"bg-white/10 border-white/20 text-white placeholder-slate-400 focus:border-indigo-400 focus:ring-indigo-400/20"}),e.jsx("button",{type:"button",className:"absolute right-3 top-9 text-slate-400 hover:text-indigo-400 transition-colors",onClick:()=>r(!t),children:t?e.jsx(dr,{className:"h-5 w-5"}):e.jsx(ks,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"flex items-center cursor-pointer group",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 text-indigo-500 focus:ring-indigo-400 border-white/30 rounded bg-white/10 cursor-pointer"}),e.jsx("span",{className:"ml-2 text-slate-300 group-hover:text-white transition-colors",children:"Remember me"})]}),e.jsx("a",{href:"#",className:"font-medium text-indigo-400 hover:text-indigo-300 transition-colors",children:"Forgot password?"})]}),e.jsx(ss,{type:"submit",className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 border-0 text-white font-semibold py-3 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg shadow-indigo-500/30 hover:shadow-indigo-500/50",loading:i,disabled:i,children:i?"Signing in...":"Sign In"})]}),e.jsxs("div",{className:"mt-8 space-y-4 text-center",children:[e.jsx("div",{className:"pt-6 border-t border-white/10",children:e.jsx("span",{className:"text-slate-400 text-sm",children:"Don't have an account? "})}),e.jsx("div",{children:e.jsxs(Bs,{to:"/",className:"text-sm text-slate-400 hover:text-white transition-colors inline-flex items-center gap-2 group",children:[e.jsx("span",{className:"group-hover:-translate-x-1 transition-transform duration-200",children:"â†"}),"Back to website"]})})]})]})})]})]})},Nl={getLeads:async s=>(await Ae.get("/leads",{params:s})).data,exportLeads:async()=>(await Ae.get("/leads/export")).data,getScheduledViewings:async()=>(await Ae.get("/leads/scheduled-viewings")).data,getLead:async s=>(await Ae.get(`/leads/${s}`)).data,createLead:async s=>(await Ae.post("/leads",s)).data,updateLead:async(s,a)=>(await Ae.put(`/leads/${s}`,a)).data,deleteLead:async s=>(await Ae.delete(`/leads/${s}`)).data,updateStatus:async(s,a)=>(await Ae.patch(`/leads/${s}/status`,a)).data,assignToAgent:async(s,a)=>(await Ae.patch(`/leads/${s}/assign`,a)).data,getStats:async()=>(await Ae.get("/leads/stats")).data},Ud=[{id:1,text:"Every call you make is a step closer to a deal. Keep dialing! ðŸ“ž",language:"english",category:"motivation",icon:e.jsx(Ft,{className:"h-4 w-4"}),roles:["sales","presales","team leader"],timeOfDay:"afternoon"},{id:2,text:"Great teams are built one interaction at a time. Make every conversation count! ðŸ‘¥",language:"english",category:"teamwork",icon:e.jsx(Ns,{className:"h-4 w-4"}),roles:["manager","team leader","sales"],forManager:!0},{id:3,text:"Focus on the process, and the results will follow. Stay consistent! ðŸŽ¯",language:"english",category:"focus",icon:e.jsx(rt,{className:"h-4 w-4"}),roles:["presales","sales","manager"],timeOfDay:"morning"},{id:4,text:"Energy is contagious. Your positivity can uplift the entire team! âš¡",language:"english",category:"energy",icon:e.jsx(zt,{className:"h-4 w-4"}),roles:["all"]},{id:5,text:"Each property sold is a dream fulfilled. Keep making dreams come true! ðŸ ",language:"english",category:"success",icon:e.jsx(Zl,{className:"h-4 w-4"}),roles:["sales","presales"]},{id:6,text:"à¤¹à¤° à¤•à¥‰à¤² à¤¨à¤ˆ à¤¸à¤‚à¤­à¤¾à¤µà¤¨à¤¾ à¤²à¤¾à¤¤à¥€ à¤¹à¥ˆà¥¤ à¤²à¤—à¤¾à¤¤à¤¾à¤° à¤•à¥‹à¤¶à¤¿à¤¶ à¤•à¤°à¤¤à¥‡ à¤°à¤¹à¥‡à¤‚! ðŸ’ª",language:"hindi",category:"motivation",icon:e.jsx(Ft,{className:"h-4 w-4"}),roles:["sales","presales","team leader"]},{id:7,text:"à¤Ÿà¥€à¤® à¤•à¥€ à¤¤à¤¾à¤•à¤¤ à¤¹à¥€ à¤…à¤¸à¤²à¥€ à¤¤à¤¾à¤•à¤¤ à¤¹à¥ˆà¥¤ à¤¸à¤¾à¤¥ à¤®à¤¿à¤²à¤•à¤° à¤•à¤¾à¤® à¤•à¤°à¥‡à¤‚! ðŸ¤",language:"hindi",category:"teamwork",icon:e.jsx(Ns,{className:"h-4 w-4"}),roles:["manager","team leader"],forManager:!0},{id:8,text:"à¤ªà¥à¤°à¤¤à¥à¤¯à¥‡à¤• à¤•à¥‰à¤² à¤¨à¤µà¥€à¤¨ à¤¸à¤‚à¤§à¥€ à¤†à¤£à¤¤à¥‡. à¤¸à¤¤à¤¤ à¤ªà¥à¤°à¤¯à¤¤à¥à¤¨ à¤•à¤°à¤¾! ðŸŒŸ",language:"marathi",category:"motivation",icon:e.jsx(Ft,{className:"h-4 w-4"}),roles:["sales","presales"]},{id:9,text:"à¤¸à¤‚à¤˜à¤¾à¤šà¥€ à¤¶à¤•à¥à¤¤à¥€ à¤–à¤°à¥€ à¤¶à¤•à¥à¤¤à¥€ à¤†à¤¹à¥‡. à¤à¤•à¤¤à¥à¤° à¤•à¤¾à¤® à¤•à¤°à¥‚à¤¯à¤¾! ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦",language:"marathi",category:"teamwork",icon:e.jsx(Ns,{className:"h-4 w-4"}),roles:["manager","team leader","sales"],forManager:!0},{id:10,text:"Remember to take breaks! A refreshed mind performs better. â˜•",language:"english",category:"wellness",icon:e.jsx(qr,{className:"h-4 w-4"}),roles:["all"],timeOfDay:"afternoon"},{id:11,text:"Your health is your wealth. Stand up and stretch for 5 minutes! ðŸ§˜",language:"english",category:"wellness",icon:e.jsx(Ra,{className:"h-4 w-4"}),roles:["all"]},{id:12,text:"Every challenge is an opportunity to grow. Embrace it! ðŸŒ±",language:"english",category:"growth",icon:e.jsx(Rs,{className:"h-4 w-4"}),roles:["all"]},{id:13,text:"Top performer this week gets a special treat! Aim for the stars! â­",language:"english",category:"reward",icon:e.jsx(Ct,{className:"h-4 w-4"}),roles:["sales","presales"],timeOfDay:"morning"}],_0=[{id:1,title:"Performance Bonus",description:"Earn up to 20% of your monthly salary as performance bonus",icon:e.jsx(ka,{className:"h-5 w-5"}),category:"financial",forRoles:["sales","presales","manager"]},{id:2,title:"Health Insurance",description:"Comprehensive health coverage for you and your family",icon:e.jsx(Ra,{className:"h-5 w-5"}),category:"health",forRoles:["all"]},{id:3,title:"Skill Development",description:"Monthly training sessions and certification support",icon:e.jsx(Va,{className:"h-5 w-5"}),category:"career",forRoles:["all"]},{id:4,title:"Flexi Hours",description:"2-3 hours flexible timing based on your productivity",icon:e.jsx(Ls,{className:"h-5 w-5"}),category:"wellness",forRoles:["all"]},{id:5,title:"Star Performer Awards",description:"Monthly recognition with gifts and certificates",icon:e.jsx(Ct,{className:"h-5 w-5"}),category:"recognition",forRoles:["all"]},{id:6,title:"Team Outings",description:"Quarterly team building activities and outings",icon:e.jsx(Ns,{className:"h-5 w-5"}),category:"wellness",forRoles:["all"]}],qd={presales:["motivation","focus","teamwork","growth"],sales:["motivation","success","energy","focus","reward"],manager:["teamwork","motivation","focus","leadership"],"team leader":["teamwork","motivation","energy","leadership"],default:["motivation","energy","teamwork","wellness"]},S0=[{id:1,task:"Power Hour - Focused calling",duration:"60 minutes",benefit:"High conversion rate during this hour",icon:e.jsx(Ls,{className:"h-5 w-5"})},{id:2,task:"Break for mindfulness",duration:"10 minutes",benefit:"Reduces stress, increases focus",icon:e.jsx(Va,{className:"h-5 w-5"})},{id:3,task:"Review weekly goals",duration:"15 minutes",benefit:"Stay aligned with targets",icon:e.jsx(rt,{className:"h-5 w-5"})},{id:4,task:"Share success story",duration:"5 minutes",benefit:"Motivates entire team",icon:e.jsx(Bt,{className:"h-5 w-5"})}],Vd={leads:{total_leads:0,new_leads:0,converted_leads:0,today_leads:0},properties:{total_properties:0,available_properties:0,sold_properties:0,today_listings:0},activities:{total_activities:0,pending_activities:0,today_activities:0,upcoming_week_activities:0}},Wd=(s,a)=>{for(const t of a){const r=s==null?void 0:s[t];if(r){const i=new Date(r).getTime();if(!Number.isNaN(i))return i}}return-1/0},Hd=(s,a)=>[...s].sort((t,r)=>Wd(r,a)-Wd(t,a)),Pt=s=>{if(s==null)return"";const a=String(s).trim();return a==="null"||a==="undefined"?"":a},Yd=(s,a=new Date)=>s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()&&s.getDate()===a.getDate(),Gd=s=>{if(!s)return null;const a=new Date(s);return Number.isNaN(a.getTime())?null:a},k0=()=>{const{user:s}=Hs(),[a,t]=l.useState(Vd),[r,i]=l.useState([]),[n,o]=l.useState([]),[m,g]=l.useState(!0),[b,d]=l.useState(Ud[0]),[v,x]=l.useState([]),[u,c]=l.useState("default"),[f,p]=l.useState(!0),[N,P]=l.useState([]),[w,$]=l.useState(75),[y,k]=l.useState({completed:3,target:10});l.useEffect(()=>{var A;if(s){const L=((A=s.role)==null?void 0:A.toLowerCase())||"default";if(c(L),L==="manager"){P([{id:1,type:"reminder",message:"Remember to check on your team's motivation levels today!",timestamp:new Date,read:!1,forManager:!0}]);const I=setInterval(()=>{const H={id:Date.now(),type:"reminder",message:"Team check-in time! Boost your team's energy with some positive words.",timestamp:new Date,read:!1,forManager:!0};P(h=>[H,...h]),wt.info("Team motivation check-in reminder!")},7200*1e3);return()=>clearInterval(I)}}},[s]);const R=()=>{const A=qd[u]||qd.default,L=new Date().getHours(),D=L<12?"morning":L<17?"afternoon":"evening";return Ud.filter(I=>{const H=I.roles.includes("all")||I.roles.includes(u)||I.roles.some(Y=>A.includes(I.category)),h=!I.timeOfDay||I.timeOfDay===D||I.timeOfDay==="any";return H&&h})},F=()=>{const A=R(),L=A.filter(H=>!v.includes(H.id)||v.length>=A.length);if(L.length===0)return x([]),A[Math.floor(Math.random()*A.length)];const D=Math.floor(Math.random()*L.length),I=L[D];if(x(H=>[...H,I.id]),I.forManager&&u==="manager"){const H={id:Date.now(),type:"motivation",message:`New motivational message ready for your team: "${I.text}"`,timestamp:new Date,read:!1,forManager:!0};P(h=>[H,...h])}return I},T=()=>Math.floor(Math.random()*300001)+9e5;l.useEffect(()=>{if(!s)return;const A=F();d(A);const L=setInterval(()=>{const D=F();d(D),$(H=>Math.min(100,Math.max(20,H+(Math.random()>.5?5:-5)))),wt.success(`${s.first_name}, ${D.text.split("!")[0]}!`);const I={id:Date.now(),type:"motivation",message:`${s.first_name}, ${D.text}`,timestamp:new Date,read:!1};P(H=>[I,...H])},T());return()=>clearInterval(L)},[s,u]);const j=A=>{const L=[Pt(A.title),Pt(A.property_title),Pt(A.name),Pt(A.display_name),Pt(A.unit_name),Pt(A.unitName),Pt(A.listing_title),Pt(A.label)],D=(()=>{const q=Pt(A.unit_type),ne=Pt(A.bhk);return q&&ne?`${q} â€¢ ${ne}${typeof ne=="string"&&!ne.toLowerCase().includes("bhk")?" BHK":""}`:q||(ne?`${ne}${typeof ne=="string"&&!ne.toLowerCase().includes("bhk")?" BHK":""}`:"")})();D&&L.push(D);for(const q of L)if(q)return q;const I=[],H=Pt(A.city),h=Pt(A.location),Y=Pt(A.unit_type),K=Pt(A.bhk);return Y&&I.push(Y),K&&I.push(`${K}${typeof K=="string"&&!K.toLowerCase().includes("bhk")?" BHK":""}`),h&&I.push(h),H&&I.push(H),I.length?I.join(" â€¢ "):"Untitled"},E=A=>{const L=[`${Pt(A.first_name)} ${Pt(A.last_name)}`.trim(),Pt(A.full_name),Pt(A.name),Pt(A.display_name),Pt(A.contact_name),Pt(A.first_name),Pt(A.last_name),Pt(A.email),Pt(A.phone),Pt(A.mobile),Pt(A.username),Pt(A.user_name)];for(const D of L)if(D)return D;return`Lead ${Pt(A.id)||""}`.trim()};l.useEffect(()=>{let A=!0;return s?(async()=>{A&&g(!0);let D=null,I=null;try{const[h,Y]=await Promise.all([Nl.getLeads({limit:50}).catch(()=>null),As.getProperties({limit:50}).catch(()=>null)]);if(h){const K=h.data??h;Array.isArray(K)?D=K:Array.isArray(K==null?void 0:K.rows)?D=K.rows:Array.isArray(K==null?void 0:K.data)&&(D=K.data)}if(Y){const K=Y.data??Y;Array.isArray(K)?I=K:Array.isArray(K==null?void 0:K.rows)?I=K.rows:Array.isArray(K==null?void 0:K.data)&&(I=K.data)}}catch{}if(A){if(Array.isArray(D)){const h=Hd(D,["updated_at","created_at","updatedAt","createdAt"]).slice(0,5);i(h)}if(Array.isArray(I)){const h=Hd(I,["updated_at","created_at","updatedAt","createdAt"]).slice(0,5);o(h)}}const H=JSON.parse(JSON.stringify(Vd));if(Array.isArray(D)&&(H.leads.total_leads=D.length,H.leads.today_leads=D.reduce((h,Y)=>{const K=Gd(Y.created_at??Y.createdAt);return h+(K&&Yd(K)?1:0)},0),H.leads.new_leads=D.reduce((h,Y)=>h+(String(Y.status??"").trim().toLowerCase()==="new"?1:0),0),H.leads.converted_leads=D.reduce((h,Y)=>h+(String(Y.status??"").trim().toLowerCase()==="converted"?1:0),0)),Array.isArray(I)){const h=Y=>String(Y??"").trim().toLowerCase();H.properties.total_properties=I.length,H.properties.available_properties=I.filter(Y=>h(Y.status)==="available").length,H.properties.sold_properties=I.filter(Y=>h(Y.status)==="sold").length,H.properties.today_listings=I.reduce((Y,K)=>{const q=Gd(K.created_at??K.createdAt);return Y+(q&&Yd(q)?1:0)},0)}A&&(t(H),!Array.isArray(D)&&!Array.isArray(I)&&wt.error("Failed to load dashboard data"),g(!1))})():g(!1),()=>{A=!1}},[s]);const V=A=>{if(!A)return"-";const L=new Date(A);return isNaN(L.getTime())?"-":L.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},W=()=>{const A=new Date().getHours();return A<12?"Good morning":A<18?"Good afternoon":"Good evening"},B=A=>{P(L=>L.map(D=>D.id===A?{...D,read:!0}:D))},M=()=>{`${s==null?void 0:s.first_name}`,wt.success("Motivation sent to team!");const A={id:Date.now(),type:"team",message:`${s==null?void 0:s.first_name} sent team motivation: "Keep up the great work!"`,timestamp:new Date,read:!1};P(L=>[A,...L])};return m?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx("div",{className:`flex-1 transition-all duration-300 ${f?"mr-80":"mr-0"}`,children:e.jsxs("div",{className:"space-y-6 mb-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[W(),", ",(s==null?void 0:s.first_name)??"User","!"]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>p(!f),className:"p-2 rounded-lg bg-indigo-100 text-indigo-600 hover:bg-indigo-200",children:f?e.jsx(ns,{className:"h-5 w-5"}):e.jsx(zt,{className:"h-5 w-5"})}),e.jsx(Bs,{to:"/dashboard/leads",children:e.jsxs(ss,{children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Add Lead"]})})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:b.icon}),e.jsx("div",{children:e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsxs("span",{className:"text-xl font-semibold text-gray-800",children:["Dear"," ",e.jsx("span",{className:"text-blue-600",children:(s==null?void 0:s.first_name)||"Team Member"}),", ",b.text]})})})]}),e.jsxs("div",{className:"hidden md:flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(A=>e.jsx(Xs,{className:`h-4 w-4 ${A<=4?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},A))}),e.jsx("span",{className:"text-sm text-gray-600",children:"Motivation Level: 4/5"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Ns,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Leads"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:a.leads.total_leads??0}),e.jsxs("p",{className:"text-sm text-green-600",children:["+",a.leads.today_leads??0," today"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Properties"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:a.properties.total_properties??0}),e.jsxs("p",{className:"text-sm text-green-600",children:[a.properties.available_properties??0," available"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(jt,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activities"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:a.activities.pending_activities??0}),e.jsxs("p",{className:"text-sm text-yellow-600",children:[a.activities.today_activities??0," today"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Rs,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:a.leads.converted_leads??0}),e.jsx("p",{className:"text-sm text-purple-600",children:"This month"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(Bs,{to:"/dashboard/leads",className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Ns,{className:"h-5 w-5 text-blue-600 mr-3"}),e.jsx("span",{className:"text-sm font-medium",children:"Manage Leads"})]}),e.jsxs(Bs,{to:"/dashboard/properties",className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Is,{className:"h-5 w-5 text-green-600 mr-3"}),e.jsx("span",{className:"text-sm font-medium",children:"View Properties"})]}),e.jsxs(Bs,{to:"/dashboard/activities",className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Ts,{className:"h-5 w-5 text-yellow-600 mr-3"}),e.jsx("span",{className:"text-sm font-medium",children:"Schedule Activity"})]}),e.jsxs(Bs,{to:"/dashboard/analytics",className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Rs,{className:"h-5 w-5 text-purple-600 mr-3"}),e.jsx("span",{className:"text-sm font-medium",children:"View Analytics"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Leads"}),e.jsxs(Bs,{to:"/dashboard/leads",className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:["View all",e.jsx(la,{className:"h-4 w-4 inline ml-1"})]})]})}),e.jsx("div",{className:"p-6",children:r.length>0?e.jsx("div",{className:"space-y-4",children:r.map(A=>e.jsx(Bs,{to:`/dashboard/leads/${A.id}`,className:"block hover:bg-gray-50 p-3 rounded-lg transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:E(A)}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",A.status??"-"]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:V(A.created_at??A.createdAt)})]})},String(A.id)))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent leads"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Properties"}),e.jsxs(Bs,{to:"/dashboard/properties",className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:["View all",e.jsx(la,{className:"h-4 w-4 inline ml-1"})]})]})}),e.jsx("div",{className:"p-6",children:n.length>0?e.jsx("div",{className:"space-y-4",children:n.map(A=>e.jsx(Bs,{to:`/dashboard/properties/${A.id}`,className:"block hover:bg-gray-50 p-3 rounded-lg transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:j(A)}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",A.status??"-"]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:V(A.created_at??A.createdAt)})]})},String(A.id)))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent properties"})})]})]})]})}),f&&e.jsx("div",{className:"fixed right-0 top-0 h-screen w-80 bg-gradient-to-b from-gray-50 to-white border-l border-gray-200 shadow-xl overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg",children:e.jsx(zt,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Motivation Hub"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["For ",(s==null?void 0:s.first_name)||"Team Member"]})]})]}),e.jsx("button",{onClick:()=>p(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ns,{className:"h-5 w-5 text-gray-500"})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-4 mb-6 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Team Energy Level"})]}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[w,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${w>70?"bg-green-500":w>40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${w}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsx("span",{children:"Low"}),e.jsx("span",{children:"High"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 mb-6 shadow-sm border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Daily Goal Progress"}),e.jsx(rt,{className:"h-5 w-5 text-green-600"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Calls Made"}),e.jsxs("span",{className:"font-semibold",children:[y.completed,"/",y.target]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${y.completed/y.target*100}%`}})})]}),e.jsx("button",{className:"w-full mt-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-medium hover:opacity-90 transition",children:"Update Progress"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Benefits"}),e.jsx(hu,{className:"h-5 w-5 text-purple-600"})]}),e.jsx("div",{className:"space-y-3",children:_0.filter(A=>A.forRoles.includes("all")||A.forRoles.includes(u)).slice(0,3).map(A=>e.jsx("div",{className:"bg-white p-3 rounded-lg border border-gray-200 hover:border-purple-300 transition",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:A.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:A.title}),e.jsx("p",{className:"text-xs text-gray-600",children:A.description})]})]})},A.id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Quick Boost Tasks"}),e.jsx(Ls,{className:"h-5 w-5 text-orange-600"})]}),e.jsx("div",{className:"space-y-3",children:S0.map(A=>e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 p-4 rounded-xl border border-orange-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[A.icon,e.jsx("span",{className:"font-medium text-gray-900",children:A.task})]}),e.jsx("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded",children:A.duration})]}),e.jsx("p",{className:"text-sm text-gray-600",children:A.benefit})]},A.id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),e.jsx(ha,{className:"h-5 w-5 text-red-600"})]}),e.jsxs("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:[N.slice(0,5).map(A=>e.jsx("div",{className:`p-3 rounded-lg border ${A.read?"bg-gray-50":"bg-blue-50 border-blue-200"}`,onClick:()=>B(A.id),children:e.jsxs("div",{className:"flex items-start space-x-2",children:[A.type==="motivation"&&e.jsx(zt,{className:"h-4 w-4 text-blue-600 mt-0.5"}),A.type==="reminder"&&e.jsx(ha,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),A.type==="achievement"&&e.jsx(Zl,{className:"h-4 w-4 text-green-600 mt-0.5"}),A.type==="team"&&e.jsx(Ns,{className:"h-4 w-4 text-purple-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-800",children:A.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:A.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},A.id)),N.length===0&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No notifications"})]})]}),u==="manager"&&e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-4 mb-6 border border-indigo-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Manager Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:M,className:"w-full py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg font-medium hover:opacity-90 transition flex items-center justify-center space-x-2",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsx("span",{children:"Send Team Motivation"})]}),e.jsxs("button",{className:"w-full py-2 bg-white border border-indigo-300 text-indigo-700 rounded-lg font-medium hover:bg-indigo-50 transition flex items-center justify-center space-x-2",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:"Recognize Achiever"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Today's Quick Stats"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.leads.today_leads}),e.jsx("div",{className:"text-xs text-gray-600",children:"New Leads"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.properties.today_listings}),e.jsx("div",{className:"text-xs text-gray-600",children:"New Listings"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:a.leads.converted_leads}),e.jsx("div",{className:"text-xs text-gray-600",children:"Conversions"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-yellow-600",children:[w,"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Energy"})]})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(zt,{className:"h-4 w-4"}),e.jsx("span",{children:"Stay Motivated!"})]}),e.jsx("div",{className:"text-xs",children:"Next message in: ~15 min"})]})})]})}),!f&&e.jsx("button",{onClick:()=>p(!0),className:"fixed right-4 top-24 p-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all z-50",children:e.jsx(zt,{className:"h-5 w-5"})})]})},C0=({currentPage:s,totalPages:a,onPageChange:t,className:r=""})=>{const n=()=>{const m=[];let g=Math.max(1,s-Math.floor(2.5)),b=Math.min(a,g+5-1);a>5&&b-g+1<5&&(g=b-5+1);for(let d=g;d<=b;d++)m.push(d);return m},o=m=>{m>=1&&m<=a&&t(m)};return a<=1?null:e.jsxs("div",{className:`flex items-center justify-center gap-1 ${r}`,children:[e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>o(s-1),disabled:s===1,className:"h-8 w-8 p-0",children:e.jsx(Wa,{className:"h-4 w-4"})}),n().map(m=>e.jsx(ss,{variant:s===m?"default":"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>o(m),children:m},m)),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>o(s+1),disabled:s===a,className:"h-8 w-8 p-0",children:e.jsx(pa,{className:"h-4 w-4"})})]})};function Da(s,a){const t=o=>(o??"").toString().trim().toLowerCase().replace(/[\s-_/]+/g,""),r=t((s==null?void 0:s.role)||""),i=t((s==null?void 0:s.department)||""),n=(o,m=!1)=>{const g=o.salutation||"",b=o.first_name||o.name||"You",d=o.last_name||"";let v=`${g?g+" ":""}${b}${d?" "+d:""}`;return m&&(v+=" (Self)"),{id:o.id??o.user_id??o._id,salutation:g,name:v,phone:o.phone??"",email:o.email??"",designation:o.designation??"",department:o.department??"",raw:o,selfOnly:m}};return r==="executive"&&(i==="presales"||i==="presale")?[n(s,!0)]:r==="manager"&&(i==="presales"||i==="presale")?a.map(o=>n(o,!1)):r==="admin"?a.map(o=>n(o,!1)):[]}const A0=s=>{if(!s)return"";if(s.display_name&&s.display_name.trim())return s.display_name.trim();if(s.full_name&&s.full_name.trim())return s.full_name.trim();const a=s.salutation?`${s.salutation}. `:"",t=s.first_name||"",r=s.last_name||"",i=`${a}${t}${r?" "+r:""}`.trim();return i||(s.username&&s.username.trim()?s.username.trim():s.email&&s.email.trim()?s.email.split("@")[0]:"Unknown User")},Ir=({placeholder:s,options:a,value:t,onChange:r,className:i="",searchable:n=!1})=>{const[o,m]=Ps.useState(!1),[g,b]=Ps.useState(0),[d,v]=Ps.useState(""),x=Ps.useRef(null),u=Ps.useRef(null),c=a.find(p=>p.value===t)||null,f=n?a.filter(p=>p.label.toLowerCase().includes(d.toLowerCase())):a;return Ps.useEffect(()=>{x.current&&b(x.current.offsetWidth)},[o]),Ps.useEffect(()=>{const p=N=>{u.current&&!u.current.contains(N.target)&&(m(!1),v(""))};return o&&document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[o]),e.jsxs("div",{className:`relative ${i}`,ref:u,children:[e.jsxs("button",{ref:x,type:"button",className:"flex items-center justify-between w-full border border-gray-300 rounded px-3 h-8 text-left focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent text-xs bg-white",onClick:()=>m(!o),children:[e.jsx("span",{className:"truncate",children:c?c.label:s}),e.jsx("svg",{className:`ml-2 h-4 w-4 transition-transform duration-200 flex-shrink-0 ${o?"rotate-180":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),o&&e.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:()=>{m(!1),v("")},children:e.jsxs("div",{className:"absolute bg-white shadow-lg rounded-md py-1 text-xs ring-1 ring-black ring-opacity-5 focus:outline-none max-h-60 overflow-hidden",style:{width:g,top:x.current?x.current.getBoundingClientRect().bottom+window.scrollY+4:0,left:x.current?x.current.getBoundingClientRect().left+window.scrollX:0,zIndex:9999},onClick:p=>p.stopPropagation(),children:[n&&e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{type:"text",placeholder:"Search...",value:d,onChange:p=>v(p.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",onClick:p=>p.stopPropagation()})}),e.jsx("div",{className:"overflow-y-auto max-h-48",children:f.length>0?f.map(p=>e.jsx("button",{className:`block w-full text-left px-3 py-2 hover:bg-gray-100 ${t===p.value?"bg-blue-50 text-blue-600":""}`,onClick:()=>{r(p.value),m(!1),v("")},children:p.label},p.value)):e.jsx("div",{className:"px-3 py-2 text-gray-500",children:n?"No matching options":"No options available"})})]})})]})},So={salutation:"",name:"",phone:"",email:"",lead_type:"",lead_source:"",whatsapp_number:"",state:"",city:"",location:"",status:"new",assigned_executive:"",priority:""},jc=({isOpen:s,onClose:a,onSave:t,lead:r})=>{const{user:i}=Hs(),n=!!(r!=null&&r.id),[o,m]=l.useState({...So}),[g,b]=l.useState(!1),[d,v]=l.useState(!1),[x,u]=l.useState(null),[c,f]=l.useState({salutation:[],leadType:[],leadSource:[],leadStatus:[],states:[],cities:[],locations:[],priority:[]}),[p,N]=l.useState([]),P=B=>B?String(B).replace(/\D/g,""):"",w=B=>{if(!B)return"";const M=P(B);return M?M.startsWith("0")?`+${M.replace(/^0+/,"")}`:`+${M}`:""},$=B=>P(B);l.useEffect(()=>{if(!s)return;let B=!0;const M=A=>(A||"").toString().trim().toLowerCase().replace(/[\s-_/]+/g,"").replace(/[^a-z]/g,"");return(async()=>{try{console.log("Fetching users for executives...");const A=await Os.getAllUsers();console.log("Raw API response:",A);const L=Array.isArray(A==null?void 0:A.data)&&A.data||Array.isArray(A==null?void 0:A.users)&&A.users||Array.isArray(A)&&A||[];console.log("Total users found:",L.length);const D=L.filter(I=>{const H=M((I==null?void 0:I.department)||(I==null?void 0:I.department_name)),h=M((I==null?void 0:I.role)||(I==null?void 0:I.role_name)||(I==null?void 0:I.title));console.log(`User: ${I.email||I.username}, Dept: ${H}, Role: ${h}`);const Y=H.includes("presale"),K=h.includes("executive");return Y&&K}).map(I=>{const H=A0(I);return console.log(`Presales Executive found: ${H} (ID: ${I.id})`),{id:String(I.id||I._id||I.user_id),name:H,salutation:I.salutation,first_name:I.first_name,last_name:I.last_name,username:I.username,email:I.email,department:I.department,role:I.role,...I}});if(console.log("Filtered Presales Executives:",D),!B)return;N(D)}catch(A){if(console.error("Error fetching users:",A),!B)return;N([])}})(),()=>{B=!1}},[s]);const y=async()=>{try{v(!0),u(null);const[B,M]=await Promise.all([Nt.getAllMasterTypes("lead"),Nt.getAllMasterTypes("common")]),A=[...B||[],...M||[]],L=await Promise.all(A.map(I=>Nt.getMasterValues(I.id))),D={};A.forEach((I,H)=>{const h=L[H]||[];D[(I.name||"").toString().toLowerCase()]=h.map(Y=>({value:String(Y.id),label:Y.value||Y.name||"Unknown"}))}),f({salutation:D.salutation||[],leadType:D["lead type"]||D.leadtype||[],leadSource:D["lead source"]||D.leadsource||[],leadStatus:D["lead status"]||D.leadstatus||[],states:D.state||[],cities:D.city||[],locations:D.location||[],priority:D["lead priority"]||D.leadpriority||[]})}catch(B){console.error("Failed to load master data:",B),u(`Failed to load dropdown options: ${B instanceof Error?B.message:String(B)}`)}finally{v(!1)}};l.useEffect(()=>{if(s){if(y(),n&&r){m({id:r.id,salutation:r.salutation||"",name:r.name||"",phone:r.phone||"",email:r.email||"",lead_type:r.lead_type||"",lead_source:r.lead_source||"",whatsapp_number:r.whatsapp_number||"",state:r.state||"",city:r.city||"",location:r.location||"",status:r.status||"new",assigned_executive:r.assigned_executive||"",priority:r.priority||""});const B=P(r.phone),M=P(r.whatsapp_number);b(!!M&&B&&M===B.replace(/^91/,"")||M===B)}else{const B={...So},M=((i==null?void 0:i.department)||"").toString().toLowerCase(),A=((i==null?void 0:i.role)||"").toString().toLowerCase();M.includes("presale")&&A.includes("executive")&&(B.assigned_executive=String(i.id)),m(B),b(!1)}u(null)}else m({...So}),b(!1),u(null),v(!1)},[s,n,r==null?void 0:r.id,i]);const k=(B,M)=>A=>{const L=M.find(D=>D.value===A);m(D=>({...D,[B]:L?L.label:A}))},R=B=>{const M=w(B);m(A=>{const L={...A,phone:M};if(g){const D=P(M),I=D.startsWith("91")?D.replace(/^91/,""):D;L.whatsapp_number=I}return L})},F=B=>{const M=P(B);m(A=>({...A,whatsapp_number:M}))},T=B=>{if(b(B),B){const M=P(o.phone||""),A=M.startsWith("91")?M.replace(/^91/,""):M;m(L=>({...L,whatsapp_number:A}))}},j=B=>w(B),E=()=>{var A;if(!String(o.name||"").trim()){Z.error("Please enter a valid name");return}if(!o.phone){Z.error("Please enter phone number");return}const B=((A=o.email)==null?void 0:A.trim())||"";if(B&&B!==""&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B)){Z.error("Please enter a valid email address");return}const M={salutation:o.salutation||"",name:String(o.name||"").trim(),phone:j(o.phone)||"",email:B,lead_type:o.lead_type||"",lead_source:o.lead_source||"",whatsapp_number:$(o.whatsapp_number)||"",state:o.state||"",city:o.city||"",location:o.location||"",status:o.status||"new",assigned_executive:o.assigned_executive||"",priority:o.priority||"",created_by:String((i==null?void 0:i.id)||"")};n&&o.id&&(M.id=o.id),console.log("Submitting lead payload - Email:",M.email,"Type:",typeof M.email,"Is empty?",M.email===""),t(M)},V=(B,M)=>{var A;return(M?(A=B.find(L=>L.label===M))==null?void 0:A.value:void 0)||(M??"")},W=Da(i,p);return l.useEffect(()=>{s&&(console.log("Assignable Executives:",W),console.log("Presales Users raw:",p))},[s,W,p]),e.jsx(ma,{isOpen:s,onClose:a,title:n?"Edit Lead":"Add New Lead",width:"max-w-[95vw] md:max-w-2xl lg:max-w-3xl",children:e.jsxs("div",{className:"space-y-4 relative",style:{minHeight:"320px"},children:[d&&e.jsxs("div",{className:"absolute inset-0 bg-white bg-opacity-50 flex items-center justify-center z-10",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2",children:"Loading options..."})]}),x&&e.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4",children:[e.jsx("p",{children:x}),e.jsx("button",{onClick:y,className:"mt-2 text-sm text-red-600 hover:text-red-800 font-medium",children:"Retry Loading Data"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salutation"}),e.jsx(Ir,{placeholder:"Select Salutation",options:c.salutation,value:V(c.salutation,o.salutation),onChange:k("salutation",c.salutation),className:"w-full"})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:o.name||"",onChange:B=>{const M=B.target.value.replace(/[0-9]/g,"");m(A=>({...A,name:M}))},placeholder:"Enter Name",className:"border border-gray-300 rounded w-full h-8 px-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email "}),e.jsx("input",{type:"email",name:"email",value:o.email||"",onChange:B=>{const M=B.target.value;m(A=>({...A,email:M}))},placeholder:"Enter Email (Optional)",className:"border border-gray-300 rounded w-full h-8 px-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(qn,{country:"in",value:o.phone||"",onChange:B=>R(B),inputClass:"!w-full !h-8 !rounded !border-gray-300 !text-xs focus:!ring-1 focus:!ring-blue-500 focus:!border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1 flex items-center gap-2",children:[e.jsx(Ia,{className:"text-green-500"})," WhatsApp Number",e.jsx("div",{className:"ml-auto flex items-center",children:e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:B=>T(B.target.checked),className:"sr-only"}),e.jsx("div",{className:`w-8 h-3 rounded-full relative transition-colors duration-200 ease-in-out ${g?"bg-blue-500":"bg-gray-300"}`,children:e.jsx("div",{className:`absolute top-0.3 left-0.5 bg-white w-3 h-3 rounded-full transition-transform duration-200 ease-in-out ${g?"translate-x-5":"translate-x-0"}`})}),e.jsx("span",{className:"ml-2 text-xs text-gray-600",children:g?"Same as phone":"Different"})]})})]}),e.jsx("input",{type:"tel",value:o.whatsapp_number||"",onChange:B=>F(B.target.value),placeholder:"9876543210",className:`border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent ${g?"bg-gray-100":""}`,maxLength:10,disabled:g})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Type"}),e.jsx(Ir,{placeholder:"Select Lead Type",options:c.leadType,value:V(c.leadType,o.lead_type),onChange:k("lead_type",c.leadType),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Priority"}),e.jsx(Ir,{placeholder:"Select Priority",options:c.priority,value:V(c.priority,o.priority),onChange:k("priority",c.priority),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Source"}),e.jsx(Ir,{placeholder:"Select Lead Source",options:c.leadSource,value:V(c.leadSource,o.lead_source),onChange:k("lead_source",c.leadSource),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Status"}),e.jsx(Ir,{placeholder:"Select Status",options:c.leadStatus,value:V(c.leadStatus,o.status),onChange:k("status",c.leadStatus),className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"State"}),e.jsx(Ir,{placeholder:"Select State",options:c.states,value:V(c.states,o.state),onChange:k("state",c.states),className:"w-full",searchable:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"City"}),e.jsx(Ir,{placeholder:"Select City",options:c.cities,value:V(c.cities,o.city),onChange:k("city",c.cities),className:"w-full",searchable:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Location"}),e.jsx(Ir,{placeholder:"Select Location",options:c.locations,value:V(c.locations,o.location),onChange:k("location",c.locations),className:"w-full",searchable:!0})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Assigned Executive (Presales Executives Only)"}),(()=>{var B;if(console.log("Rendering executive dropdown, assignableExecutives:",W),W.length===1&&W[0].selfOnly){const M=W[0];return e.jsxs("div",{className:"px-2 py-1.5 border rounded-lg text-xs bg-gray-100 inline-block",children:[M.name," (Auto-assigned to you)"]})}return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{className:"px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 w-full max-w-xs",value:String(o.assigned_executive||""),onChange:M=>{const A=M.target.value;console.log("Selected executive ID:",A);const L=p.find(D=>D.id===A);console.log("Found selected exec:",L),m(D=>({...D,assigned_executive:A}))},children:[e.jsx("option",{value:"",children:"Unassigned"}),W.length>0?W.map(M=>e.jsxs("option",{value:String(M.id),children:[M.name," ",M.id===(i==null?void 0:i.id)?"(You)":""]},M.id)):e.jsx("option",{value:"",disabled:!0,children:"No Presales Executives found"})]}),o.assigned_executive&&e.jsxs("div",{className:"text-xs text-gray-600",children:["Selected: ",e.jsx("span",{className:"font-medium",children:((B=p.find(M=>M.id===o.assigned_executive))==null?void 0:B.name)||"Unknown"})]}),W.length===0&&e.jsx("div",{className:"text-xs text-red-500",children:"No Presales Executives available. Please check user roles."})]})})()]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-6 mt-4",children:[e.jsx(ss,{variant:"outline",onClick:a,children:"Cancel"}),e.jsx(ss,{onClick:E,children:n?"Save Changes":"Add Lead"})]})]})})},Ba=ad,P0=s=>{var t,r,i,n;const a=(s==null?void 0:s.role)||(s==null?void 0:s.roles)||((t=s==null?void 0:s.raw)==null?void 0:t.role)||((r=s==null?void 0:s.raw)==null?void 0:r.roles)||((i=s==null?void 0:s.user)==null?void 0:i.role)||((n=s==null?void 0:s.user)==null?void 0:n.roles)||"";return Array.isArray(a)?a.join(",").toLowerCase():String(a||"").toLowerCase()},T0=s=>{const a=P0(s);return!!a&&/executive/.test(a)&&!/admin|manager|super/.test(a)},I0=s=>(s||"").trim().replace(/\.{2,}/g,"."),Uu=s=>{if(s==null||String(s).trim()==="")return{display:"",key:""};let a=String(s).trim();if(/e\+\d+$/i.test(a)){const r=Number(a);isNaN(r)||(a=Math.round(r).toString())}a=a.replace(/[^\d+]/g,""),a=a.replace(/^0+/,"");const t=a.replace(/[^\d]/g,"");if(/^\+?91\d{10}$/.test(a)||/^91\d{10}$/.test(a)||/^\d{10}$/.test(t)){const r=t.slice(-10);return{display:`+91${r}`,key:r}}return{display:a.startsWith("+")?a:`+${a}`,key:t}},$0=s=>Uu(s).display;function E0({isOpen:s,onClose:a,title:t="Import Summary",duplicates:r,skippedRows:i,updatedRows:n}){if(!s)return null;const o=new Set;[...r.map(g=>g.data),...i.map(g=>g.data),...n.map(g=>g.data)].forEach(g=>{Object.entries(g||{}).forEach(([b,d])=>{d!=null&&String(d).trim()!==""&&o.add(b)})});const m=Array.from(o);return e.jsx(ma,{isOpen:s,onClose:a,title:t,width:"max-w-6xl",children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"text-sm text-gray-700 flex flex-wrap gap-4",children:[e.jsxs("span",{children:["Duplicates: ",e.jsx("span",{className:"font-semibold",children:r.length})]}),e.jsxs("span",{children:["Skipped: ",e.jsx("span",{className:"font-semibold",children:i.length})]}),n.length>0&&e.jsxs("span",{children:["Updated: ",e.jsx("span",{className:"font-semibold",children:n.length})]})]}),r.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-700 mb-2",children:"Duplicates (in file or CRM)"}),e.jsx("div",{className:"max-h-[260px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-purple-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"Duplicate Fields"}),e.jsx("th",{className:"border px-2 py-1",children:"Existing ID"}),e.jsx("th",{className:"border px-2 py-1",children:"Reason"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:r.map((g,b)=>e.jsxs("tr",{className:"hover:bg-purple-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row??"-"}),e.jsx("td",{className:"border px-2 py-1",children:g.duplicateFields&&g.duplicateFields.length>0?g.duplicateFields.join(", "):"-"}),e.jsx("td",{className:"border px-2 py-1 text-center",children:g.existingId??"-"}),e.jsx("td",{className:"border px-2 py-1 text-purple-700",children:g.reason}),m.map(d=>{var v;return e.jsx("td",{className:"border px-2 py-1",children:(v=g.data)!=null&&v[d]&&String(g.data[d]).trim()!==""?g.data[d]:""},d)})]},b))})]})})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-red-700 mb-2",children:"Skipped (non-duplicate issues)"}),e.jsx("div",{className:"max-h-[240px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-red-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"Reason"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:i.map((g,b)=>e.jsxs("tr",{className:"hover:bg-red-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row}),e.jsx("td",{className:"border px-2 py-1 text-red-600",children:g.reason}),m.map(d=>e.jsx("td",{className:"border px-2 py-1",children:g.data[d]&&String(g.data[d]).trim()!==""?g.data[d]:""},d))]},b))})]})})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:"Updated (existing in CRM)"}),e.jsx("div",{className:"max-h-[240px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-green-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"ID"}),e.jsx("th",{className:"border px-2 py-1",children:"Note"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:n.map((g,b)=>e.jsxs("tr",{className:"hover:bg-green-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row??"-"}),e.jsx("td",{className:"border px-2 py-1 text-center",children:g.id??"-"}),e.jsx("td",{className:"border px-2 py-1 text-green-700",children:g.note||"Updated"}),m.map(d=>{var v;return e.jsx("td",{className:"border px-2 py-1",children:(v=g.data)!=null&&v[d]&&String(g.data[d]).trim()!==""?g.data[d]:""},d)})]},b))})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ss,{variant:"outline",onClick:a,children:"Close"})})]})})}const M0=()=>{const s=[["Salutation*","Name*","Phone*","Email","Lead_type","Lead_source","Whatsapp_number","State","City","Location","Status","Stage","Priority"],["Mr","Rahul Sharma","9876543210","rahul.sharma@gmail.com","Walk-In Lead","Website","9876543210","Maharashtra","Mumbai","Bandra","New","New","Medium"]],a=Ba.utils.aoa_to_sheet(s);[0,1,2].forEach(i=>{const n=Ba.utils.encode_cell({r:0,c:i});a[n]&&(a[n].s={font:{color:{rgb:"FF0000"},bold:!0},alignment:{horizontal:"center",vertical:"center"}})});for(let i=3;i<s[0].length;i++){const n=Ba.utils.encode_cell({r:0,c:i});a[n]&&(a[n].s={font:{bold:!0},alignment:{horizontal:"center",vertical:"center"}})}for(let i=1;i<s.length;i++)for(let n=0;n<s[i].length;n++){const o=Ba.utils.encode_cell({r:i,c:n});a[o]&&(a[o].s={alignment:{horizontal:"left",vertical:"center"}})}a["!cols"]=[12,16,15,24,16,16,16,16,12,16,12,12,12].map(i=>({width:i}));const r=Ba.utils.book_new();Ba.utils.book_append_sheet(r,a,"Leads Template"),Ba.writeFile(r,"Leads_Import_Template.xlsx")};function L0({isOpen:s,onClose:a}){var he;const{user:t}=Hs(),[r,i]=l.useState(null),[n,o]=l.useState(""),[m,g]=l.useState(!1),[b,d]=l.useState(!1),[v,x]=l.useState([]),[u,c]=l.useState([]),[f,p]=l.useState([]),[N,P]=l.useState(!1),[w,$]=l.useState(!1),[y,k]=l.useState([]),[R,F]=l.useState(!1),[T,j]=l.useState(""),[E,V]=l.useState(new Set),[W,B]=l.useState("none"),M=T0(t),A=l.useRef(null);l.useEffect(()=>{function se(ge){A.current&&!A.current.contains(ge.target)&&F(!1)}return R&&document.addEventListener("mousedown",se),()=>document.removeEventListener("mousedown",se)},[R]),l.useEffect(()=>{s&&(async()=>{var se;try{$(!0);const ge=fe=>{const G=fe!=null&&fe.salutation?`${fe.salutation} `:"",me=(fe==null?void 0:fe.first_name)||"",oe=(fe==null?void 0:fe.last_name)||"",Fe=(fe==null?void 0:fe.username)||(fe==null?void 0:fe.email)||"Executive";return`${G}${me} ${oe}`.trim()||Fe};if(M){const fe=(t==null?void 0:t.id)||(t==null?void 0:t.userId)||(t==null?void 0:t._id)||(t==null?void 0:t.uuid)||((se=t==null?void 0:t.raw)==null?void 0:se.id)||String((t==null?void 0:t.email)||(t==null?void 0:t.username)||"me"),G=ge(t),me={id:fe,name:G,email:t==null?void 0:t.email,username:t==null?void 0:t.username};k([me]),V(new Set([fe])),B("selected");return}const ee=async fe=>{var G;return(G=Os.getByDeptRole)==null?void 0:G.call(Os,{department:fe,role:"executive",is_active:1,limit:100})};let de;try{de=await ee("presales")}catch{de=await ee("pre-sales")}const U=((de==null?void 0:de.items)??(de==null?void 0:de.data)??de??[]).map(fe=>({...fe,id:fe.id??fe.userId??fe._id??fe.uuid??String(fe.email||fe.username||Math.random()),name:ge(fe)})),re=(Da(t,U)||[]).map(fe=>{var G;return{id:fe.id,name:fe.name,email:fe.email,username:((G=fe.raw)==null?void 0:G.username)||fe.username}});k(re)}catch(ge){console.error(ge),Z.error("Could not fetch executives")}finally{$(!1)}})()},[s,t,M]);const L=l.useMemo(()=>{if(!T.trim())return y;const se=T.toLowerCase();return y.filter(ge=>String(ge.name||"").toLowerCase().includes(se)||String(ge.email||"").toLowerCase().includes(se)||String(ge.username||"").toLowerCase().includes(se))},[T,y]),D=se=>{V(ge=>{const ee=new Set(ge);return ee.has(se)?ee.delete(se):ee.add(se),ee})},I=()=>V(new Set(y.map(se=>se.id))),H=()=>V(new Set),h=se=>/duplicate/i.test(se||""),Y=(se,ge)=>{const ee=[],de=(se||"").toLowerCase();return de.includes("phone")&&ee.push("phone"),de.includes("email")&&ee.push("email"),ee.length===0&&((ge["Phone*"]||ge.phone||ge.Phone)&&ee.push("phone"),(ge.Email||ge.email)&&ee.push("email")),Array.from(new Set(ee))},K=se=>{const ge=new Set,ee=new Set,de=[],U=[],X=[];return se.forEach((re,fe)=>{const G=fe+2,me=re["Salutation*"]?String(re["Salutation*"]).trim():"",oe=me?I0(me):"",Fe=re["Name*"]?String(re["Name*"]).trim():"",$e=Uu(re["Phone*"]),Le=$e.display,je=$e.key,_e=re.Email?String(re.Email).trim():"";if(!oe||!Fe||!je){const O=[];oe||O.push("Salutation"),Fe||O.push("Name"),je||O.push("Phone"),U.push({row:G,reason:`Missing mandatory fields: ${O.join(", ")}`,data:{...re,"Phone* (parsed)":Le,"Salutation (normalized)":oe}});return}if(je&&ge.has(je)){X.push({row:G,reason:"Duplicate in file (phone)",data:{...re,"Phone* (parsed)":Le,"Salutation (normalized)":oe},duplicateFields:["phone"]});return}if(_e&&ee.has(_e.toLowerCase())){X.push({row:G,reason:"Duplicate in file (email)",data:{...re,"Phone* (parsed)":Le,"Salutation (normalized)":oe},duplicateFields:["email"]});return}const ve=Le.replace(/[^\d+]/g,"");if(!(/^\+91\d{10}$/.test(ve)||/^\+\d{10,15}$/.test(ve))){U.push({row:G,reason:`Invalid phone format (${Le})`,data:{...re,"Phone* (parsed)":Le,"Salutation (normalized)":oe}});return}if(_e&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_e)){U.push({row:G,reason:"Invalid email format",data:{...re,"Phone* (parsed)":Le,"Salutation (normalized)":oe}});return}const We=re.Whatsapp_number,pe=We?$0(We):"";de.push({salutation:oe,name:Fe,phone:Le,email:_e||"",lead_type:re.Lead_type||"",lead_source:re.Lead_source||"",whatsapp_number:pe,state:re.State||"",city:re.City||"",location:re.Location||"",status:re.Status||"",stage:re.Stage||"",priority:re.Priority||""}),ge.add(je),_e&&ee.add(_e.toLowerCase())}),{validData:de,nonDuplicateSkipped:U,localDuplicates:X}},q=se=>{var de;if(M){const U=(t==null?void 0:t.id)||(t==null?void 0:t.userId)||(t==null?void 0:t._id)||(t==null?void 0:t.uuid)||((de=t==null?void 0:t.raw)==null?void 0:de.id)||String((t==null?void 0:t.email)||(t==null?void 0:t.username)||"me");return se.map(X=>({...X,assigned_executive:U}))}if(W==="none")return se.map(U=>({...U,assigned_executive:""}));const ge=Array.from(E);if(ge.length===0)return se.map(U=>({...U,assigned_executive:""}));const ee=ge.length;return se.map((U,X)=>({...U,assigned_executive:ge[X%ee]}))},ne=async se=>{try{return await Et.importLeads(se)}catch{try{return await Et.importLeads({rows:se})}catch{try{return await Et.importLeads({data:se})}catch(de){throw console.error("All importLeads formats failed:",de),de}}}},le=async(se,ge)=>{var ve,Pe,We,pe,O,Ie,ze,xe;p([]),x([]),c([]),P(!1);const{validData:ee,nonDuplicateSkipped:de,localDuplicates:U}=K(se);if(ee.length===0){x(de),p(U),c([]),P(!0),U.length===0&&Z.error(`No valid leads found in the ${ge}`);return}const X=q(ee);let re;try{re=await ne(X)}catch(Ee){console.error(Ee),Z.error((Ee==null?void 0:Ee.message)||`Import failed from ${ge}`);return}if(!((re==null?void 0:re.success)===!0||(re==null?void 0:re.ok)===!0||typeof(re==null?void 0:re.status)=="number"&&re.status>=200&&re.status<300||typeof(re==null?void 0:re.inserted)<"u"||Array.isArray(re==null?void 0:re.insertedRows))){Z.error((re==null?void 0:re.message)||`Import failed from ${ge}`);return}const G=(re==null?void 0:re.insertedRows)??((ve=re==null?void 0:re.data)==null?void 0:ve.insertedRows)??((Pe=re==null?void 0:re.meta)==null?void 0:Pe.insertedRows)??[],me=(re==null?void 0:re.inserted)??((We=re==null?void 0:re.data)==null?void 0:We.inserted)??((pe=re==null?void 0:re.meta)==null?void 0:pe.inserted)??(Array.isArray(G)?G.length:void 0)??X.length,oe=(re==null?void 0:re.skippedRows)??((O=re==null?void 0:re.data)==null?void 0:O.skippedRows)??((Ie=re==null?void 0:re.meta)==null?void 0:Ie.skippedRows)??[],Fe=(re==null?void 0:re.updatedRows)??((ze=re==null?void 0:re.data)==null?void 0:ze.updatedRows)??((xe=re==null?void 0:re.meta)==null?void 0:xe.updatedRows)??[],$e=[],Le=[];if(Array.isArray(oe))for(const Ee of oe){const Ke=String((Ee==null?void 0:Ee.reason)||""),Xe=(Ee==null?void 0:Ee.data)||Ee||{};h(Ke)?$e.push({row:Ee==null?void 0:Ee.row,reason:Ke||"Duplicate in CRM",data:Xe,duplicateFields:Y(Ke,Xe),existingId:(Ee==null?void 0:Ee.id)||(Ee==null?void 0:Ee.existingId)}):Le.push({row:(Ee==null?void 0:Ee.row)??0,reason:Ke||"Skipped by server",data:Xe})}const je=[...U,...$e],_e=[...de,...Le];if(p(je),x(_e),c(Fe||[]),(me??0)>0&&je.length===0&&_e.length===0){if(Z.success(`Imported ${me} lead(s) successfully.`),typeof Et.getLeads=="function")try{await Et.getLeads()}catch{}J()}else{const Ee=[];(me??0)>0&&Ee.push(`${me} imported`),je.length>0&&Ee.push(`${je.length} duplicate`),_e.length>0&&Ee.push(`${_e.length} skipped`),Z.info(`Import summary: ${Ee.join(" â€¢ ")}`),P(!0)}},S=async()=>{if(!r)return Z.error("Please select an Excel/CSV file");if(!M&&W==="selected"&&E.size===0)return Z.error("Please select at least one executive or choose None.");g(!0);try{const se=new FileReader;se.onload=async ee=>{var de;try{const U=(de=ee.target)==null?void 0:de.result;if(!U){Z.error("Failed to read file");return}let X;if(r.name.toLowerCase().endsWith(".csv")){const me=typeof U=="string"?U:String(U);X=Ba.read(me,{type:"string",raw:!0})}else{const me=U;X=Ba.read(me,{type:"array",raw:!0})}const fe=X.Sheets[X.SheetNames[0]];if(!fe){Z.error("No sheet found in file");return}const G=Ba.utils.sheet_to_json(fe,{raw:!0,defval:""});if(!G||G.length===0){Z.error("File appears to be empty");return}await le(G,"file")}catch(U){console.error(U),Z.error("Error processing file. Please check the format.")}finally{g(!1)}},r.name.toLowerCase().endsWith(".csv")?se.readAsText(r):se.readAsArrayBuffer(r)}catch(se){console.error(se),Z.error("Error reading file"),g(!1)}},C=async()=>{if(!n.trim())return Z.error("Please enter a Google Sheet URL");if(!M&&W==="selected"&&E.size===0)return Z.error("Please select at least one executive or choose None.");g(!0);try{const se=n.match(/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);if(!se){Z.error("Invalid Google Sheet URL"),g(!1);return}const ee=`https://docs.google.com/spreadsheets/d/${se[1]}/export?format=csv`,de=await fetch(ee);if(!de.ok){Z.error(de.status===403?"Sheet is not publicly accessible. Make it 'Anyone with link can view'.":"Failed to access Google Sheet."),g(!1);return}const U=await de.text();if(!U.trim()){Z.error("Google Sheet appears to be empty"),g(!1);return}const X=Ba.read(U,{type:"string",raw:!0}),re=X.Sheets[X.SheetNames[0]];if(!re){Z.error("No sheet found in Google Sheet"),g(!1);return}const fe=Ba.utils.sheet_to_json(re,{raw:!0,defval:""});if(!fe||fe.length===0){Z.error("No data found in Google Sheet"),g(!1);return}await le(fe,"Google Sheet")}catch(se){console.error(se),Z.error("Error processing Google Sheet")}finally{g(!1)}},J=()=>{i(null),o(""),x([]),c([]),p([]),P(!1),g(!1),d(!1),a()},ue=()=>{J()},Q=se=>{var de,U;const ge=((de=se.target.files)==null?void 0:de[0])??null;if(!ge)return;const ee=((U=ge.name.split(".").pop())==null?void 0:U.toLowerCase())??"";if(!["csv","xlsx","xls"].includes(ee)){Z.error("Please upload only Excel (.xlsx, .xls) or CSV files");return}i(ge)};return e.jsxs(e.Fragment,{children:[e.jsx(ma,{isOpen:s,onClose:ue,title:"",width:"max-w-5xl",children:e.jsxs("div",{className:"space-y-4 p-2",children:[e.jsx("div",{className:"border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Import Leads"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Import leads from Excel files or Google Sheets"})]})]}),e.jsx(ns,{onClick:ue,className:"w-5 h-5 text-gray-400 hover:text-gray-600 cursor-pointer"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-3 items-stretch",children:[e.jsxs("div",{className:"flex flex-col h-full p-3 space-y-2 border rounded-md bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Upload File"})]}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-md p-4 text-center flex-1 min-h-0 transition-all duration-200 ${b?"border-blue-400 bg-blue-50":r?"border-green-400 bg-green-50":"border-gray-300 hover:border-gray-400 bg-gray-50"}`,onDragEnter:se=>{se.preventDefault(),se.stopPropagation(),d(!0)},onDragLeave:se=>{se.preventDefault(),se.stopPropagation(),d(!1)},onDragOver:se=>{se.preventDefault(),se.stopPropagation(),d(!0)},onDrop:se=>{var ee,de;se.preventDefault(),se.stopPropagation(),d(!1);const ge=(ee=se.dataTransfer)==null?void 0:ee.files;if(ge&&ge.length>0){const U=ge[0],X=((de=U.name.split(".").pop())==null?void 0:de.toLowerCase())??"";["csv","xlsx","xls"].includes(X)?i(U):Z.error("Please upload only Excel (.xlsx, .xls) or CSV files")}},children:[e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:Q,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),r?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"w-8 h-8 mx-auto bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-xs font-medium text-green-700 truncate",children:r.name}),e.jsx("p",{className:"text-[10px] text-green-600",children:"Click to change file"})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"w-8 h-8 mx-auto bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsx("p",{className:"text-xs font-medium text-gray-900",children:"Drop file or click"}),e.jsx("p",{className:"text-[10px] text-gray-500",children:"Excel (.xlsx, .xls) or CSV"})]})]}),e.jsx(ss,{onClick:S,disabled:!r||m,className:"mt-auto w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-1.5 text-xs rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"inline-flex items-center justify-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):"Import from File"})]}),e.jsxs("div",{className:"flex flex-col h-full p-3 space-y-2 border rounded-md bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Google Sheets"})]}),e.jsxs("div",{className:"space-y-2 flex-1 min-h-0",children:[e.jsx("input",{type:"text",placeholder:"https://docs.google.com/spreadsheets/...",value:n,onChange:se=>o(se.target.value),className:"w-full border border-gray-300 rounded-md px-2.5 py-1.5 text-xs focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-2.5",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 mt-0.5 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-[11px] leading-5 text-blue-700",children:[e.jsx("p",{className:"font-medium mb-0.5",children:"Make sure your Google Sheet is:"}),e.jsxs("ul",{className:"space-y-0.5",children:[e.jsx("li",{children:"â€¢ Anyone with link can view"}),e.jsx("li",{children:"â€¢ Headers same as template"}),e.jsx("li",{children:"â€¢ Phone numbers are text"})]})]})]})})]}),e.jsx(ss,{onClick:C,disabled:!n.trim()||m,className:"mt-auto w-full bg-green-600 hover:bg-green-700 text-white font-medium py-1.5 text-xs rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"inline-flex items-center justify-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Importing..."]}):"Import from Google Sheet"})]})]}),e.jsx("div",{className:"p-3 border rounded-md bg-white shadow-sm",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Lead Assignment"}),e.jsxs("label",{className:`flex items-center gap-2 text-sm mb-1.5 ${M?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{type:"radio",className:"accent-blue-600",checked:W==="none",onChange:()=>!M&&B("none"),disabled:M}),e.jsx("span",{children:"None"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"radio",className:"accent-blue-600",checked:W==="selected"||M,onChange:()=>B("selected"),disabled:!!M}),e.jsx("span",{children:M?"Assigned to you":"Selected executives (round-robin)"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"relative",ref:A,children:[e.jsxs("button",{type:"button",onClick:()=>F(se=>!se),className:`w-full flex items-center justify-between rounded-md border px-3 py-1.5 text-sm ${W==="selected"||M?"bg-white border-gray-300":"bg-gray-100 border-gray-200 cursor-not-allowed"}`,disabled:!(W==="selected"||M),children:[e.jsx("span",{className:"truncate",children:M?((he=y[0])==null?void 0:he.name)||"You":E.size>0?`${E.size} executive(s) selected`:"Select executives (checkbox)"}),e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),R&&(W==="selected"||M)&&!M&&e.jsxs("div",{className:"absolute z-20 mt-1 w-full rounded-md border bg-white shadow-lg",children:[e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{type:"text",value:T,onChange:se=>j(se.target.value),placeholder:"Search executive...",className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsx("div",{className:"max-h-56 overflow-auto",children:w?e.jsx("div",{className:"p-3 text-sm text-gray-500",children:"Loading..."}):L.length===0?e.jsx("div",{className:"p-3 text-sm text-gray-500",children:"No executives found"}):L.map(se=>e.jsxs("label",{className:"flex items-start gap-2 px-3 py-2 hover:bg-gray-50 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"mt-1 accent-blue-600",checked:E.has(se.id),onChange:()=>D(se.id)}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-gray-900 truncate",children:se.name}),se.email&&e.jsx("span",{className:"text-xs text-gray-500 truncate",children:se.email})]})]},se.id))}),e.jsxs("div",{className:"flex items-center justify-between p-2 border-t bg-gray-50",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ss,{variant:"outline",onClick:I,className:"px-3 py-1 text-xs",children:"Select All"}),e.jsx(ss,{variant:"outline",onClick:H,className:"px-3 py-1 text-xs",children:"Clear"})]}),e.jsx(ss,{variant:"outline",onClick:()=>F(!1),className:"px-3 py-1 text-xs",children:"Done"})]})]})]}),!M&&e.jsx("p",{className:"mt-1.5 text-[10px] text-gray-600",children:"Tip: If you select 3 executives and import 50 leads, they'll be assigned ~16/17 each (round-robin)."}),M&&e.jsx("p",{className:"mt-1.5 text-[10px] text-gray-600",children:"You are logged in as an Executive â€” imports will be assigned to you automatically."})]})]})})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.664-.833-2.464 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-amber-800 mb-1",children:"Required Fields & Validation Rules"}),e.jsxs("div",{className:"text-xs text-amber-700 space-y-1",children:[e.jsx("p",{className:"font-medium",children:"Mandatory fields (marked with *):"}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-[10px] font-medium",children:"Salutation*"}),e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-[10px] font-medium",children:"Name*"}),e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-[10px] font-medium",children:"Phone*"})]}),e.jsxs("p",{className:"text-[11px] mt-2 text-amber-600",children:["â€¢ Email is optional but recommended",e.jsx("br",{}),"â€¢ Intra-file duplicate phone/emails will be skipped (handles +91 / 91 / leading zero / scientific notation)",e.jsx("br",{}),"â€¢ CRM duplicates are ",e.jsx("b",{children:"never updated"}),`; they're shown as "Duplicate in CRM"`,e.jsx("br",{}),"â€¢ Scientific notation in phone numbers will be converted automatically",e.jsx("br",{}),"â€¢ Salutation cleaning: multiple dots collapse to a single dot (e.g., Dr.. â†’ Dr.)"]})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[e.jsx(ss,{onClick:M0,className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-medium py-3 rounded-lg transition-all duration-200 transform hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download Template"]})}),e.jsx(ss,{variant:"outline",onClick:ue,className:"flex-1 sm:flex-none border-2 border-gray-300 hover:border-gray-400 text-gray-700 font-medium py-3 px-8 rounded-lg transition-colors",children:"Cancel"})]})]})}),e.jsx(E0,{isOpen:N,onClose:()=>P(!1),duplicates:f,skippedRows:v,updatedRows:u})]})}const D0=[{label:"Newest â†’ Oldest",value:"desc"},{label:"Oldest â†’ Newest",value:"asc"}],R0=({isOpen:s,onClose:a,filters:t,setFilters:r,clearFilters:i,statusOptions:n,sourceOptions:o,leadTypeOptions:m,assignedOptions:g,createdByOptions:b,priorityOptions:d})=>(l.useEffect(()=>{const v=x=>x.key==="Escape"&&a();return s&&document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[s,a]),l.useEffect(()=>{t!=null&&t.ignoreDate&&(t.dateFrom||t.dateTo)&&r({...t,dateFrom:"",dateTo:""})},[t==null?void 0:t.ignoreDate]),typeof window>"u"?null:Il.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300 
        ${s?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),e.jsxs("div",{className:`fixed top-0 right-0 h-full bg-gradient-to-b from-indigo-50 via-white to-purple-50 
        shadow-2xl w-full sm:w-[380px] transform transition-transform duration-300 ease-out
        ${s?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-indigo-500 to-purple-500 text-white",children:[e.jsx("h3",{className:"text-sm font-semibold tracking-wide",children:"Smart Filters"}),e.jsx("button",{onClick:a,className:"p-1 rounded-full bg-white/20 hover:bg-white/30 transition",children:e.jsx(ns,{size:18})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto h-[calc(100%-56px)] text-xs space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Status"}),e.jsx(da,{options:n,value:t.status,onChange:v=>r({...t,status:v}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Lead Source"}),e.jsx(da,{options:o,value:t.source,onChange:v=>r({...t,source:v}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Lead Type"}),e.jsx(da,{options:m,value:t.leadType,onChange:v=>r({...t,leadType:v}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx(da,{options:d,value:t.priority,onChange:v=>r({...t,priority:v}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Assigned Executive"}),e.jsx(da,{options:g,value:t.assignedExecutive,onChange:v=>r({...t,assignedExecutive:v}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Created By"}),e.jsx(da,{options:b,value:t.createdBy,onChange:v=>r({...t,createdBy:v}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Sort by Created Date"}),e.jsx(da,{options:D0,value:t.sortOrder??"desc",onChange:v=>r({...t,sortOrder:v}),triggerClassName:"w-full text-xs"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{id:"ignoreDate",type:"checkbox",checked:!!t.ignoreDate,onChange:v=>r({...t,ignoreDate:v.target.checked}),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"ignoreDate",className:"text-gray-700",children:"Ignore Date"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx(wr,{type:"date",value:t.dateFrom,onChange:v=>r({...t,dateFrom:v.target.value}),disabled:!!t.ignoreDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx(wr,{type:"date",value:t.dateTo,onChange:v=>r({...t,dateTo:v.target.value}),disabled:!!t.ignoreDate})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(ss,{variant:"outline",onClick:()=>{i(),r(v=>({...v,sortOrder:"desc"}))},className:"flex-1 text-xs border-red-400 text-red-500 hover:bg-red-50",children:"Clear All"}),e.jsx(ss,{onClick:a,className:"flex-1 text-xs bg-indigo-500 hover:bg-indigo-600 text-white shadow-md",children:"Apply"})]})]})]})]}),document.body)),z0=(s,a,t=[])=>{if(!s)return[];const r=(s.role||"").toLowerCase(),i=(s.department||"").toLowerCase(),n=String(s.id||"");if(r==="superadmin"||r==="admin")return a;if(i.includes("presales")&&r.includes("executive"))return a.filter(o=>o.assigned_executive?String(o.assigned_executive)===n:!1);if(i.includes("presales")&&r.includes("manager")){const m=t.filter(g=>{const b=(g.department||"").toLowerCase(),d=(g.role||"").toLowerCase(),v=String(g.reports_to||g.manager_id||"");return b.includes("presales")&&d.includes("executive")&&v===n}).map(g=>String(g.id||g._id||g.user_id||""));return a.filter(g=>!g.assigned_executive||g.assigned_executive===""?!0:m.includes(String(g.assigned_executive))||String(g.assigned_executive)===n)}if(i.includes("sales")&&r.includes("executive"))return a.filter(o=>o.assigned_executive?String(o.assigned_executive)===n:!1);if(i.includes("sales")&&r.includes("manager")){const m=t.filter(g=>{const b=(g.department||"").toLowerCase(),d=(g.role||"").toLowerCase(),v=String(g.reports_to||g.manager_id||"");return b.includes("sales")&&d.includes("executive")&&v===n}).map(g=>String(g.id||g._id||g.user_id||""));return a.filter(g=>!g.assigned_executive||g.assigned_executive===""?!0:m.includes(String(g.assigned_executive))||String(g.assigned_executive)===n)}return a.filter(o=>String(o.created_by)===n)},F0=()=>{const{user:s}=Hs(),a=Ws(s,"lead.read"),t=Ws(s,"lead.create"),r=Ws(s,"lead.update"),i=Ws(s,"lead.delete"),n=Ws(s,"lead.assign"),o=Ws(s,"lead.bulk_delete"),m=Ws(s,"data.import"),g=Ws(s,"data.export");if(!a)return e.jsx("div",{className:"h-full flex flex-col bg-gray-50",children:e.jsx("div",{className:"flex-1 grid place-items-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("div",{className:"text-gray-600 text-sm",children:"You do not have permission to view leads."})]})})});const[b,d]=l.useState([]),[v,x]=l.useState([]),[u,c]=l.useState(!1),[f,p]=l.useState(!1),[N,P]=l.useState([]),[w,$]=l.useState(!1),[y,k]=l.useState(1),[R,F]=l.useState(1),[T,j]=l.useState(()=>Number(localStorage.getItem("leads_rows_per_page"))||10),[E,V]=l.useState(!1),[W,B]=l.useState(!1),[M,A]=l.useState(null),[L,D]=l.useState("all"),[I,H]=l.useState({name:"",contact:"",location:"",source:"",status:"",created:"",priority:""}),[h,Y]=l.useState({status:"all",source:"all",leadType:"all",assignedExecutive:"all",createdBy:"all",priority:"all",city:"",location:"",dateFrom:"",dateTo:"",ignoreDate:!1,sortOrder:"desc"}),[K,q]=l.useState(""),[ne,le]=l.useState(""),[S,C]=l.useState(!1),J=_=>String(_??"").trim().toLowerCase(),ue=_=>({label:_.charAt(0).toUpperCase()+_.slice(1),value:_}),Q=_=>{if(!_)return"";const ae=_!=null&&_.salutation?`${_.salutation} `:"",ke=(_==null?void 0:_.first_name)||(_==null?void 0:_.name)||"",Me=(_==null?void 0:_.last_name)||"";return`${ae}${ke}${Me?" "+Me:""}`.trim()},he=l.useMemo(()=>Q(s)||"Admin",[s]),se=l.useMemo(()=>{const _={};return(v||[]).forEach(ae=>{const ke=String(ae.id??ae._id??ae.user_id??ae.value??"");ke&&(_[ke]=ae)}),_},[v]),ge=_=>{if(!_)return"";const ae=se[String(_)];return ae?Q(ae):""},ee=l.useMemo(()=>[{label:"All",value:"all"},...Array.from(new Set(b.map(_=>_.status?_.status.toLowerCase():"new").filter(Boolean))).map(ue)],[b]),de=l.useMemo(()=>[{label:"All",value:"all"},{label:"Unassigned",value:"Unassigned"},...Array.from(new Set(b.map(_=>_.assigned_executive_name||"").filter(Boolean))).map(_=>({label:_,value:_}))],[b]),U=l.useMemo(()=>[{label:"All",value:"all"},...Array.from(new Set(b.map(_=>_.created_by_name||"").filter(Boolean))).map(_=>({label:_,value:_}))],[b]),X=l.useMemo(()=>[{label:"All",value:"all"},...Array.from(new Set(b.map(_=>(_.lead_source?_.lead_source.toLowerCase():"").replace(/\s+/g,"_")).filter(Boolean))).map(_=>({label:_.replace(/_/g," "),value:_}))],[b]),re=l.useMemo(()=>[{label:"All",value:"all"},...Array.from(new Set(b.map(_=>(_.lead_type?_.lead_type.toLowerCase():"").trim()).filter(Boolean))).map(ue)],[b]),fe=l.useMemo(()=>{const _=ae=>(ae??"").trim().toLowerCase();return(v||[]).filter(ae=>{const ke=_(ae.role);return _(ae.department)==="presales"&&ke==="presales executive"})},[v]),G=l.useMemo(()=>Da(s,fe).map(ae=>({id:String(ae.id),name:ae.name,selfOnly:ae.selfOnly??!1,raw:ae.raw??null})),[s,fe]),me={blue:{active:"bg-blue-100 text-blue-700 border-blue-200",badge:"bg-blue-200"},purple:{active:"bg-purple-100 text-purple-700 border-purple-200",badge:"bg-purple-200"},yellow:{active:"bg-yellow-100 text-yellow-700 border-yellow-200",badge:"bg-yellow-200"},green:{active:"bg-green-100 text-green-700 border-green-200",badge:"bg-green-200"},red:{active:"bg-red-100 text-red-700 border-red-200",badge:"bg-red-200"}},oe=l.useMemo(()=>[{id:"all",label:"All",color:"blue",count:b.length},{id:"new",label:"New",color:"yellow",count:b.filter(_=>J(_.status)==="new").length},{id:"contacted",label:"Contacted",color:"purple",count:b.filter(_=>J(_.status)==="contacted").length},{id:"qualified",label:"Qualified",color:"green",count:b.filter(_=>J(_.status)==="qualified").length},{id:"unqualified",label:"Unqualified",color:"red",count:b.filter(_=>J(_.status)==="unqualified").length}],[b]),Fe=async()=>{var _;if(!a){Z.error("You do not have permission to view leads");return}try{c(!0);const ae=await Et.getLeads();let Me=Array.isArray(ae==null?void 0:ae.data)?ae.data:((_=ae==null?void 0:ae.data)==null?void 0:_.data)??[];if(!v||v.length===0)try{const Be=await Os.getAllUsers();x(Be.data||[])}catch(Be){console.error("Failed to fetch users",Be)}const Ye=z0(s,Me,v||[]),ie={};(v||[]).forEach(Be=>{const Ve=String(Be.id??Be._id??Be.user_id??"");Ve&&(ie[Ve]=Be)});const we=Ye.map(Be=>{const Ve={...Be};if(Be.assigned_executive){const Je=ie[String(Be.assigned_executive)];Je&&(Ve.assigned_executive_name=Q(Je))}if(Be.created_by){const Je=ie[String(Be.created_by)];Je&&(Ve.created_by_name=Q(Je))}if(Be.last_contacted_by){const Je=ie[String(Be.last_contacted_by)];Je&&(Ve.last_contacted_by_name=Q(Je))}return Ve});d(we)}catch(ae){console.error("Error fetching leads:",ae),Z.error("Failed to fetch leads")}finally{c(!1)}};l.useEffect(()=>{(async()=>{try{const ae=await Os.getAllUsers();x(ae.data||[])}catch(ae){console.error("Failed to fetch users",ae)}})()},[]),l.useEffect(()=>{s&&a&&Fe()},[s,v]),l.useEffect(()=>{localStorage.setItem("leads_rows_per_page",String(T))},[T]);const $e=_=>{const ae=new Date(_);if(isNaN(ae.getTime()))return"Invalid Date";const ke=String(ae.getDate()).padStart(2,"0"),Me=String(ae.getMonth()+1).padStart(2,"0"),Ye=ae.getFullYear();let ie=ae.getHours();const we=String(ae.getMinutes()).padStart(2,"0"),Be=ie>=12?"PM":"AM";ie=ie%12||12;const Ve=String(ie).padStart(2,"0");return`${ke}/${Me}/${Ye} ${Ve}:${we} ${Be}`},Le=l.useMemo(()=>[{label:"All",value:"all"},...Array.from(new Set(b.map(_=>(_.priority?_.priority.toLowerCase():"").trim()).filter(Boolean))).map(_=>({label:_.charAt(0).toUpperCase()+_.slice(1),value:_}))],[b]),je=l.useMemo(()=>{const _=h,ae=I,ke=ie=>(ie??"").toLowerCase(),Me=ie=>{if(_.ignoreDate||!_.dateFrom&&!_.dateTo)return!0;const we=new Date(ie);if(Number.isNaN(we.getTime()))return!1;if(_.dateFrom){const Be=new Date(_.dateFrom);if(we<Be)return!1}if(_.dateTo){const Be=new Date(_.dateTo+"T23:59:59");if(we>Be)return!1}return!0};let Ye=b.filter(ie=>{if(_.status!=="all"&&ke(ie.status)!==ke(_.status)||_.source!=="all"&&ke(ie.lead_source)!==ke(_.source)||_.leadType!=="all"&&ke(ie.lead_type)!==ke(_.leadType)||_.city&&!ke(ie.city).includes(ke(_.city))||_.location&&!ke(ie.location).includes(ke(_.location))||!Me(ie.created_at)||_.createdBy!=="all"&&ie.created_by_name!==_.createdBy||_.priority!=="all"&&ke(ie.priority)!==ke(_.priority)||ae.name&&!ke(ie.name).includes(ke(ae.name)))return!1;if(ae.contact){const we=ke(ae.contact);if(!ke(ie.phone).includes(we)&&!ke(ie.email).includes(we))return!1}if(ae.location){const we=ke(ae.location);if(!ke(ie.city).includes(we)&&!ke(ie.location).includes(we))return!1}if(ae.source&&!ke(ie.lead_source).includes(ke(ae.source))||ae.status&&!ke(ie.status).includes(ke(ae.status))||ae.priority&&!ke(ie.priority).includes(ke(ae.priority))||ae.created&&!$e(ie.created_at).toLowerCase().includes(ae.created.toLowerCase()))return!1;if(_.assignedExecutive!=="all"){if(_.assignedExecutive==="Unassigned"){if(ie.assigned_executive_name&&ie.assigned_executive_name.trim()!=="")return!1}else if(ie.assigned_executive_name!==_.assignedExecutive)return!1}return!(L!=="all"&&J(ie.status)!==L)});return Ye=Ye.sort((ie,we)=>{const Be=new Date(ie.created_at).getTime(),Ve=new Date(we.created_at).getTime();return _.sortOrder==="asc"?Be-Ve:Ve-Be}),Ye},[b,h,I,L]);l.useEffect(()=>{k(1)},[h,I,L]),l.useEffect(()=>{F(Math.max(1,Math.ceil(je.length/T)))},[je,T]);const _e=l.useMemo(()=>{const _=(y-1)*T;return je.slice(_,_+T)},[je,y,T]),ve=async _=>{var ae,ke,Me,Ye;if(!t){Z.error("You do not have permission to create leads");return}try{const ie=await Et.createLead(_),we=((ae=ie==null?void 0:ie.data)==null?void 0:ae.data)??(ie==null?void 0:ie.data)??{},Be=we.id??we._id??String(Date.now());if(_.assigned_executive){const Ve=String(_.assigned_executive),Je=ge(Ve)||"User";if(Ve===String(s==null?void 0:s.id)){const Ue=v.filter(Oe=>(Oe.role||"").toLowerCase()==="admin"||(Oe.role||"").toLowerCase()==="superadmin");for(const Oe of Ue)await wa.createNotification({leadId:Be,userId:Oe.id,message:`Lead assigned to you by ${he}`,type:"lead_assign",link:`/dashboard/leads/${Be}`});Z.success("Lead created and assigned to you successfully")}else await wa.createNotification({leadId:Be,userId:Ve,message:`New lead assigned to you by ${he}`,type:"lead_assign",link:`/dashboard/leads/${Be}`}),Z.success(`Lead assigned to ${Je} successfully`)}else Z.success("Lead added successfully");await Fe(),_.assigned_executive===(s==null?void 0:s.id)||D("all"),k(1),V(!1)}catch(ie){console.error("Error adding lead:",ie),((ke=ie==null?void 0:ie.response)==null?void 0:ke.status)===409?Z.error(((Ye=(Me=ie==null?void 0:ie.response)==null?void 0:Me.data)==null?void 0:Ye.message)||"Duplicate entry found"):Z.error("Failed to add lead")}},Pe=async _=>{var ae,ke,Me,Ye;if(!r){Z.error("You do not have permission to update leads");return}try{const ie={..._,assigned_executive:_.assigned_executive};delete ie.assigned_executive_name;const we=await Et.updateLead(ie.id,ie),Be=(we==null?void 0:we.data)??((ae=we==null?void 0:we.data)==null?void 0:ae.data);if(Be){const Ve=b.find(Oe=>Oe.id===(Be.id??_.id)),Je=(Ve==null?void 0:Ve.assigned_executive)&&String(Ve.assigned_executive)===String(s==null?void 0:s.id),Ue=Be.assigned_executive&&String(Be.assigned_executive)===String(s==null?void 0:s.id);if(await Fe(),Je&&!Ue&&D("all"),!Je&&Ue&&D("all"),k(1),Be.assigned_executive&&String(Be.assigned_executive)!==String((Ve==null?void 0:Ve.assigned_executive)||""))try{await wa.createNotification({leadId:Be.id??_.id,userId:Be.assigned_executive,message:`Lead reassigned to you by ${he}`,type:"lead_assign",link:`/dashboard/leads/${Be.id??_.id}`})}catch(Oe){console.error("Failed to send notification:",Oe)}Z.success("Lead updated successfully"),B(!1),A(null)}}catch(ie){console.error("Error updating lead:",ie),((ke=ie==null?void 0:ie.response)==null?void 0:ke.status)===409?Z.error(((Ye=(Me=ie==null?void 0:ie.response)==null?void 0:Me.data)==null?void 0:Ye.message)||"Duplicate entry found"):Z.error("Failed to update lead")}},We=_=>{P(ae=>ae.includes(_)?ae.filter(ke=>ke!==_):[...ae,_])},pe=()=>{const _=_e.map(ke=>ke.id),ae=_.length>0&&_.every(ke=>N.includes(ke));P(ae?ke=>ke.filter(Me=>!_.includes(Me)):ke=>Array.from(new Set([...ke,..._])))},O=async _=>{if(!i){Z.error("You do not have permission to delete leads");return}if(window.confirm("Are you sure you want to delete this lead?"))try{await Et.deleteLead(_),d(ae=>ae.filter(ke=>ke.id!==_)),P(ae=>ae.filter(ke=>ke!==_)),Z.success("Lead deleted successfully")}catch(ae){console.error("Error deleting lead:",ae),Z.error("Failed to delete lead")}},Ie=async()=>{if(!g){Z.error("You do not have permission to export leads");return}try{const _=["Salutation","Name","Phone","Email","City","Location","Lead Source","Lead Type","Status","Created At","Assigned Executive","Priority"],ae=je.map(we=>[we.salutation,we.name,we.phone,we.email,we.city,we.location,we.lead_source,we.lead_type,we.status,we.created_at,we.assigned_executive_name||"Unassigned",we.priority||"N/A"]),ke=[_,...ae].map(we=>we.map(Be=>`"${(Be??"").toString().replace(/"/g,'""')}"`).join(",")).join(`
`),Me=new Blob([ke],{type:"text/csv"}),Ye=window.URL.createObjectURL(Me),ie=document.createElement("a");ie.href=Ye,ie.download=`leads-export-${new Date().toISOString().split("T")[0]}.csv`,ie.click(),window.URL.revokeObjectURL(Ye),Z.success("Leads exported successfully")}catch(_){console.error("Error exporting leads:",_),Z.error("Failed to export leads")}},ze=_=>{const ae=(_||"").toLowerCase().replace(/[^a-z]/g,"");return{emailmarketing:"bg-indigo-100 text-indigo-800",referral:"bg-emerald-100 text-emerald-800",socialmedia:"bg-fuchsia-100 text-fuchsia-800",walkin:"bg-sky-100 text-sky-800",website:"bg-blue-100 text-blue-800",googleads:"bg-amber-100 text-amber-800",facebook:"bg-rose-100 text-rose-800",facebookads:"bg-rose-100 text-rose-800",instagram:"bg-pink-100 text-pink-800",whatsapp:"bg-green-100 text-green-800",coldcall:"bg-slate-100 text-slate-800",portal:"bg-indigo-100 text-indigo-800",event:"bg-purple-100 text-purple-800"}[ae]||"bg-gray-100 text-gray-800"},xe=_=>{let ae="bg-gray-100",ke="text-gray-800";const Me={hot:{bg:"bg-red-100",text:"text-red-800"},warm:{bg:"bg-yellow-100",text:"text-yellow-800"},cold:{bg:"bg-blue-100",text:"text-blue-800"},qualified:{bg:"bg-green-100",text:"text-green-800"},converted:{bg:"bg-purple-100",text:"text-purple-800"},lost:{bg:"bg-gray-100",text:"text-gray-800"},new:{bg:"bg-sky-100",text:"text-sky-800"},contacted:{bg:"bg-indigo-100",text:"text-indigo-800"},unqualified:{bg:"bg-rose-100",text:"text-rose-800"}};return _&&Me[_.toLowerCase()]&&(ae=Me[_.toLowerCase()].bg,ke=Me[_.toLowerCase()].text),`${ae} ${ke}`},Ee=_=>{const ae=(_||"").toLowerCase();return{high:"bg-red-100 text-red-700",medium:"bg-yellow-100 text-yellow-700",low:"bg-green-100 text-green-700"}[ae]||"bg-gray-100 text-gray-700"},Ke=async()=>{if(!o){Z.error("You do not have permission to bulk delete leads");return}if(N.length===0){Z.error("No leads selected");return}if(window.confirm(`Are you sure you want to delete ${N.length} lead(s)?`)){C(!0);try{if(Et.bulkDeleteLeads)await Et.bulkDeleteLeads({ids:N});else for(const _ of N)await Et.deleteLead(_);d(_=>_.filter(ae=>!N.includes(ae.id))),Z.success(`Deleted ${N.length} lead${N.length>1?"s":""}`),P([])}catch(_){console.error("Bulk delete failed:",_),Z.error("Bulk delete failed")}finally{C(!1)}}},Xe=async()=>{if(!r){Z.error("You do not have permission to update leads");return}if(!K){Z.error("Please select a status to update");return}if(N.length===0){Z.error("No leads selected");return}C(!0);try{await Et.bulkUpdateLeads({ids:N,status:K}),d(_=>_.map(ae=>N.includes(ae.id)?{...ae,status:K}:ae)),Z.success(`Updated ${N.length} lead${N.length>1?"s":""} to "${K}"`),P([]),q("")}catch(_){console.error("Bulk status update failed:",_),Z.error("Bulk status update failed")}finally{C(!1)}},ye=async()=>{if(!n){Z.error("You do not have permission to assign leads");return}if(N.length===0){Z.error("No leads selected");return}if(!ne){Z.error("Please choose an assignee (or Unassign)");return}C(!0);try{const _=ne==="Unassigned"?null:ne,ae=String((s==null?void 0:s.id)||""),ke={};if(N.forEach(Ye=>{const ie=b.find(we=>we.id===Ye);ie&&(ke[Ye]=String(ie.assigned_executive||""))}),Et.bulkAssignExecutives)await Et.bulkAssignExecutives({ids:N,assigned_executive:_});else if(Et.bulkUpdateLeads)await Et.bulkUpdateLeads({ids:N,assigned_executive:_});else for(const Ye of N)await Et.updateLead(Ye,{assigned_executive:_});if(_&&String(_)===ae?await Fe():d(_?Ye=>Ye.filter(ie=>!N.includes(ie.id)):Ye=>Ye.filter(ie=>!N.includes(ie.id))),_){const Ye=ge(_)||"User";for(const ie of N){const we=ke[ie];if(!we||String(we)!==String(_))try{await wa.createNotification({leadId:ie,userId:_,message:`New lead assigned to you by ${he}`,type:"lead_assign",link:`/dashboard/leads/${ie}`})}catch(Be){console.error("Notification failed:",Be)}}Z.success(`Assigned ${N.length} lead${N.length>1?"s":""} to ${Ye}`)}else Z.success(`Unassigned ${N.length} lead${N.length>1?"s":""}`);P([]),le("")}catch(_){console.error("Bulk assignment failed:",_),Z.error("Bulk assignment failed")}finally{C(!1)}},Ce=l.useMemo(()=>{const _=((s==null?void 0:s.role)||"").toLowerCase(),ae=((s==null?void 0:s.department)||"").toLowerCase();return _.includes("executive")||ae.includes("sales")||ae.includes("presales")},[s]);return e.jsxs("div",{className:"flex bg-gray-50",children:[e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl",children:e.jsx(Ns,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Leads Management"}),e.jsx("p",{className:"text-gray-600 mt-1 text-xs",children:"Manage and track your sales leads"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[g&&e.jsxs(ss,{variant:"outline",onClick:Ie,className:"px-3 py-1 rounded-lg text-xs whitespace-nowrap",children:[e.jsx(Ys,{className:"h-3 w-3"}),e.jsx("span",{children:"Export"})]}),m&&e.jsx(ss,{onClick:()=>$(!0),children:"Import Leads"}),t&&e.jsxs(ss,{className:"px-3 py-1 rounded-lg text-xs whitespace-nowrap",onClick:()=>V(!0),children:[e.jsx(fs,{className:"h-3 w-3"}),e.jsx("span",{children:"Add Lead"})]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:oe.map(_=>{const ae=L===_.id,ke=me[_.color];return e.jsxs("button",{onClick:()=>{D(_.id),k(1)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap text-sm font-medium ${ae?ke.active:"text-gray-600 hover:bg-gray-100"} border ${ae?"":"border-transparent"}`,children:[e.jsx("span",{children:_.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${ae?ke.badge:"bg-gray-200"}`,children:_.count})]},_.id)})}),e.jsxs("div",{className:"flex items-center gap-4 ml-4 flex-shrink-0",children:[e.jsx("div",{className:"flex items-center gap-2 text-xs",children:e.jsx("select",{value:T,onChange:_=>j(parseInt(_.target.value,10)),className:"border border-gray-300 rounded px-2 py-1 bg-white",children:[10,20,50,100].map(_=>e.jsx("option",{value:_,children:_},_))})}),e.jsxs(ss,{variant:"outline",onClick:()=>p(!f),className:"flex items-center gap-2",children:[e.jsx(Na,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters"})]}),(Object.values(I).some(_=>_!=="")||h.status!=="all"||h.source!=="all"||h.leadType!=="all"||h.assignedExecutive!=="all"||h.createdBy!=="all"||h.sortOrder!=="desc"||h.city||h.location||!h.ignoreDate&&(h.dateFrom||h.dateTo))&&e.jsx(ss,{variant:"outline",onClick:()=>{Y({status:"all",source:"all",leadType:"all",assignedExecutive:"all",createdBy:"all",priority:"all",city:"",location:"",dateFrom:"",dateTo:"",ignoreDate:!1,sortOrder:"desc"}),H({name:"",contact:"",location:"",source:"",status:"",created:"",priority:""}),D("all")},className:"text-red-600 hover:text-red-800",children:"Clear All"})]})]})}),N.length>0&&(r||n||o)&&e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 bg-white border border-gray-200 rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"text-sm",children:["Selected: ",e.jsx("span",{className:"font-medium",children:N.length})]}),r&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Update status:"}),e.jsxs("select",{value:K,onChange:_=>q(_.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm bg-white",children:[e.jsx("option",{value:"",children:"-- choose --"}),["new","contacted","qualified","unqualified","hot","warm","cold","converted","lost",...Array.from(new Set(ee.map(_=>_.value).filter(_=>_!=="all")))].filter((_,ae,ke)=>ke.indexOf(_)===ae).map(_=>e.jsx("option",{value:_,children:_.charAt(0).toUpperCase()+_.slice(1)},_))]}),e.jsx(ss,{onClick:Xe,disabled:S||!K,children:S?"Updatingâ€¦":"Apply Status"})]}),e.jsx("div",{className:"hidden md:block h-6 w-px bg-gray-200"}),n&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs text-gray-600 whitespace-nowrap",children:"Assign to:"}),e.jsxs("select",{value:ne,onChange:_=>le(_.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm bg-white min-w-[220px]",children:[e.jsx("option",{value:"",children:"-- choose executive --"}),e.jsx("option",{value:"Unassigned",children:"Unassign"}),G.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]}),e.jsx(ss,{onClick:ye,disabled:S||!ne,children:S?"Assigningâ€¦":"Apply Assignment"})]}),e.jsxs("div",{className:"flex items-center gap-2 md:ml-auto",children:[o&&e.jsx(ss,{variant:"outline",onClick:Ke,disabled:S||N.length===0,className:"text-red-600 border-red-300 hover:bg-red-50",children:S?"Deletingâ€¦":`Delete (${N.length})`}),e.jsx(ss,{variant:"outline",onClick:()=>P([]),children:"Clear Selection"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden flex-1",children:a?u?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsxs(e.Fragment,{children:[Ce&&e.jsxs("div",{className:"bg-blue-50 border-b border-blue-100 px-4 py-2 text-xs text-blue-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"font-semibold",children:"Visibility Note:"})," ","You are viewing only leads assigned to you. Unassigned leads are visible to Admins and Managers only."]}),e.jsxs("div",{className:"text-blue-500",children:["Total visible leads: ",e.jsx("span",{className:"font-bold",children:je.length})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsxs("thead",{className:"bg-gray-100",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3 w-8 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",checked:_e.length>0&&_e.every(_=>N.includes(_.id)),onChange:pe,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-3 w-3"})}),e.jsx("th",{className:"px-3 py-3 min-w-[150px] text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-3 py-3 min-w-[160px] text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-3 py-3 min-w-[100px] text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"px-3 py-3 min-w-[120px] text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"px-3 py-3 min-w-[100px] text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-3 py-3 min-w-[100px] text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-3 py-3 min-w-[120px] text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-3 py-3 min-w-[100px] text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"px-3 py-2"}),e.jsx("th",{className:"px-3 py-2",children:e.jsx("input",{type:"text",placeholder:"Search name...",value:I.name,onChange:_=>H({...I,name:_.target.value}),className:"w-full border-gray-300 rounded text-xs py-1 px-2"})}),e.jsx("th",{className:"px-3 py-2",children:e.jsx("input",{type:"text",placeholder:"Search contact...",value:I.contact,onChange:_=>H({...I,contact:_.target.value}),className:"w-full border-gray-300 rounded text-xs py-1 px-2"})}),e.jsx("th",{className:"px-3 py-2",children:e.jsx("input",{type:"text",placeholder:"Search location...",value:I.location,onChange:_=>H({...I,location:_.target.value}),className:"w-full border-gray-300 rounded text-xs py-1 px-2"})}),e.jsx("th",{className:"px-3 py-2",children:e.jsx("input",{type:"text",placeholder:"Search source...",value:I.source,onChange:_=>H({...I,source:_.target.value}),className:"w-full border-gray-300 rounded text-xs py-1 px-2"})}),e.jsx("th",{className:"px-3 py-2",children:e.jsx("input",{type:"text",placeholder:"Search priority...",value:I.priority||"",onChange:_=>H({...I,priority:_.target.value}),className:"w-full border-gray-300 rounded text-xs py-1 px-2"})}),e.jsx("th",{className:"px-3 py-2",children:e.jsx("input",{type:"text",placeholder:"Search status...",value:I.status,onChange:_=>H({...I,status:_.target.value}),className:"w-full border-gray-300 rounded text-xs py-1 px-2"})}),e.jsx("th",{className:"px-3 py-2",children:e.jsx("input",{type:"text",placeholder:"Search date...",value:I.created,onChange:_=>H({...I,created:_.target.value}),className:"w-full border-gray-300 rounded text-xs py-1 px-2"})}),e.jsx("th",{})]})]}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-xs",children:_e.length>0?_e.map(_=>{var ae,ke,Me,Ye;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-3",children:e.jsx("input",{type:"checkbox",checked:N.includes(_.id),onChange:()=>We(_.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-3 w-3"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs(Bs,{to:`/dashboard/leads/${_.id}`,className:"flex items-center gap-2 ",children:[e.jsx("div",{className:"h-7 w-7 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium",children:((ke=(ae=_.name)==null?void 0:ae[0])==null?void 0:ke.toUpperCase())||""}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[_.salutation&&`${_.salutation}. `,_.name]}),e.jsx("p",{className:"text-gray-500",children:(Me=_.lead_type)==null?void 0:Me.toUpperCase()}),e.jsxs("p",{className:"text-[10px] text-[#0b3856] bg-[#0b3856]/10 px-2 py-0.5 rounded-md inline-block",children:["Id : ",String(_.id).slice(0,4)]})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Cs,{className:"h-3 w-3 text-blue-500"}),e.jsx("a",{href:`tel:${_.phone}`,className:"hover:text-blue-600",children:_.phone})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ds,{className:"h-3 w-3 text-red-500"}),e.jsx("a",{href:`mailto:${_.email}`,className:"hover:text-red-600 truncate max-w-[140px]",children:_.email})]}),!!_.whatsapp_number&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(th,{className:"h-3 w-3 text-green-500"}),e.jsx("a",{href:`https://wa.me/${_.whatsapp_number.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"hover:text-green-600",children:_.whatsapp_number.replace(/\D/g,"")})]})]})}),e.jsxs("td",{className:"px-3 py-3",children:[_.city||"-",_.location&&e.jsx("p",{className:"text-gray-500",children:_.location})]}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium capitalize ${ze(_.lead_source)}`,children:((Ye=_.lead_source)==null?void 0:Ye.replace("_"," "))||"-"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium capitalize ${Ee(_.priority)}`,children:_.priority||"N/A"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${xe(_.status)}`,children:_.status||"New"})}),e.jsx("td",{className:"px-3 py-3 align-top",children:e.jsxs("div",{className:"flex flex-col gap-1 text-gray-800",children:[e.jsx("div",{className:"text-gray-800",children:_.created_at?$e(_.created_at):"N/A"}),_.assigned_executive_name?e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-purple-500 font-semibold",children:"Assigned To:"})," ",e.jsx("span",{className:"text-gray-800",children:_.assigned_executive_name})]}):e.jsx("div",{className:"text-xs text-gray-400",children:"Unassigned"}),_.created_by_name&&e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-green-600 font-semibold",children:"Created By:"})," ",e.jsx("span",{className:"text-gray-800",children:_.created_by_name})]})]})}),e.jsx("td",{className:"px-3 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[a&&e.jsx(Bs,{to:`/dashboard/leads/${_.id}`,children:e.jsx(ss,{variant:"outline",size:"sm",className:"border-blue-200 text-blue-600 hover:bg-blue-50 hover:text-blue-700",children:e.jsx(ks,{className:"h-3 w-3"})})}),r&&e.jsx(ss,{variant:"outline",size:"sm",className:"border-green-200 text-green-600 hover:bg-green-50 hover:text-green-700",onClick:()=>{A(_),B(!0)},children:e.jsx(ft,{className:"h-3 w-3"})}),i&&e.jsx(ss,{variant:"outline",size:"sm",className:"border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>O(_.id),children:e.jsx(Es,{className:"h-3 w-3"})})]})})]},_.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-3 py-6 text-center text-sm text-gray-500",children:"No leads found"})})})]})}),e.jsxs("div",{className:"px-3 py-2 border-t border-gray-200 flex items-center justify-between text-xs",children:[e.jsxs("div",{children:["Showing ",_e.length," of ",je.length," filtered lead",je.length!==1?"s":""]}),e.jsx(C0,{currentPage:y,totalPages:R,onPageChange:k})]})]}):e.jsx("div",{className:"p-6 text-center text-sm text-red-600",children:"You do not have permission to view leads."})})]})}),e.jsx(R0,{isOpen:f,onClose:()=>p(!1),filters:h,setFilters:Y,clearFilters:()=>Y({status:"all",source:"all",leadType:"all",assignedExecutive:"all",createdBy:"all",priority:"all",city:"",location:"",dateFrom:"",dateTo:"",ignoreDate:!1,sortOrder:"desc"}),statusOptions:ee,sourceOptions:X,leadTypeOptions:re,assignedOptions:de,createdByOptions:U,priorityOptions:Le}),t&&e.jsx(jc,{isOpen:E,onClose:()=>V(!1),onSave:ve}),r&&e.jsx(jc,{isOpen:W,lead:M||void 0,onClose:()=>{B(!1),A(null)},onSave:Pe}),m&&e.jsx(L0,{isOpen:w,onClose:()=>$(!1)})]})},ni={getAllFollowups:async()=>(await Ae.get("/followups/get-all")).data,createFollowup:async s=>(await Ae.post("/followups/create",s)).data,getFollowupById:async s=>(await Ae.get(`/followups/getById/${s}`)).data,updateFollowup:async(s,a)=>(await Ae.put(`/followups/update/${s}`,a)).data,deleteFollowup:async s=>(await Ae.delete(`/followups/delete/${s}`)).data,getFollowupsByLeadId:async s=>{var a;try{return(await Ae.get(`/followups/getByLeadId/${s}`)).data}catch(t){if(((a=t==null?void 0:t.response)==null?void 0:a.status)===404)return console.warn("No followups found for lead:",s),[];throw t}},getFollowupCountByLeadId:async s=>(await Ae.get(`/followups/countByLeadId/${s}`)).data},yl={getAllRemarks:async()=>(await Ae.get("/connected-remarks/get-all")).data,createRemark:async s=>(await Ae.post("/connected-remarks/create",s)).data,getRemarkById:async s=>(await Ae.get(`/connected-remarks/getById/${s}`)).data,updateRemark:async(s,a)=>(await Ae.put(`/connected-remarks/update/${s}`,a)).data,deleteRemark:async s=>(await Ae.delete(`/connected-remarks/delete/${s}`)).data,getRemarksByTabId:async s=>(await Ae.get(`/connected-remarks/by-tab/${s}`)).data},Ur=[{value:"Phone Call",Icon:Cs,color:"blue"},{value:"WhatsApp",Icon:Ia,color:"green"},{value:"Email",Icon:Ds,color:"indigo"},{value:"Site Visit",Icon:Qs,color:"orange"},{value:"Meeting",Icon:Ns,color:"purple"},{value:"Other",Icon:Bt,color:"gray"}],id=s=>Array.from(new Set(s.map(a=>(a||"").trim()).filter(Boolean))),B0=(s,a)=>{const t=[];return s.forEach(r=>{r.type1Name===a&&t.push(r.value1Name),r.type2Name===a&&t.push(r.value2Name)}),id(t)},ko=(s,a)=>{const t=[];return s.forEach(r=>{const i=r.type1Name==="Lead Stage"&&r.value1Name===a&&r.type2Name==="Lead Status",n=r.type2Name==="Lead Stage"&&r.value2Name===a&&r.type1Name==="Lead Status";i&&t.push(r.value2Name),n&&t.push(r.value1Name)}),id(t)},Co=(s,a)=>{const t=[];return s.forEach(r=>{(r.type1Name==="Lead Status"&&r.value1Name===a||r.type2Name==="Lead Status"&&r.value2Name===a)&&Array.isArray(r.remarks)&&r.remarks.length&&t.push(...r.remarks.filter(Boolean)),r.type1Name==="Lead Status"&&r.value1Name===a&&r.type2Name==="Remarks"&&t.push(r.value2Name),r.type2Name==="Lead Status"&&r.value2Name===a&&r.type1Name==="Remarks"&&t.push(r.value1Name)}),id(t)},Kd={blue:"text-blue-600",green:"text-green-600",indigo:"text-indigo-600",orange:"text-orange-600",purple:"text-purple-600",gray:"text-gray-600"},qu=({options:s,value:a,onChange:t,disabled:r})=>{const[i,n]=l.useState(!1),o=l.useRef(null);l.useEffect(()=>{const d=v=>{o.current&&!o.current.contains(v.target)&&n(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const m=s.find(d=>d.value===a)??s[0],g=m.Icon,b=Kd[m.color]||"text-gray-600";return e.jsxs("div",{className:"relative",ref:o,children:[e.jsxs("button",{type:"button",disabled:r,onClick:()=>n(d=>!d),className:`mt-1 w-full border border-gray-300 rounded-md px-3 py-2 text-left flex items-center gap-2 
                    focus:outline-none focus:ring-2 focus:ring-blue-500 ${r?"opacity-60":""}`,"aria-haspopup":"listbox","aria-expanded":i,children:[e.jsx(g,{size:18,className:b}),e.jsx("span",{className:"flex-1",children:m.value}),e.jsx("svg",{viewBox:"0 0 20 20",className:"w-4 h-4",children:e.jsx("path",{d:"M5.5 7.5L10 12l4.5-4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round"})})]}),i&&!r&&e.jsx("div",{role:"listbox",className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:s.map(d=>{const v=d.Icon,x=Kd[d.color]||"text-gray-600",u=d.value===a;return e.jsxs("button",{type:"button",role:"option","aria-selected":u,onClick:()=>{t(d.value),n(!1)},className:`w-full px-3 py-2 text-left flex items-center gap-2 hover:bg-gray-50 
                            ${u?"bg-indigo-50":""}`,children:[e.jsx(v,{size:18,className:x}),e.jsx("span",{children:d.value})]},d.value)})})]})};qu.displayName="ColoredFollowupTypeSelect";const O0=({isOpen:s,onClose:a,onSave:t,tabId:r,leadId:i,initialForm:n})=>{if(!s)return null;const o=!!(n!=null&&n.id),[m,g]=l.useState([]),[b,d]=l.useState([]),[v,x]=l.useState(!1),[u,c]=l.useState(null),[f,p]=l.useState(!1),[N,P]=l.useState([]),[w,$]=l.useState([]),[y,k]=l.useState([]),[R,F]=l.useState(()=>({followupType:(n==null?void 0:n.followupType)||Ur[0].value,leadStage:(n==null?void 0:n.leadStage)||"",leadStatus:(n==null?void 0:n.leadStatus)||"",remark:(n==null?void 0:n.remark)||"",customRemark:(n==null?void 0:n.customRemark)||"",nextAction:(n==null?void 0:n.nextAction)||"",scheduleDate:(n==null?void 0:n.scheduleDate)||"",scheduleTime:(n==null?void 0:n.scheduleTime)||"",priority:(n==null?void 0:n.priority)||" - "}));l.useEffect(()=>{s&&(async()=>{try{const L=await Gt(["lead"]);L["lead priority"]&&g(L["lead priority"])}catch(L){gt.error("âŒ Error fetching lead priority:",L)}})()},[s]),l.useEffect(()=>{(async()=>{if(s){x(!0),c(null);try{const L=await yl.getRemarksByTabId(r),D=Array.isArray(L)?L:[];d(D);const I=B0(D,"Lead Stage");if(P(I),n!=null&&n.leadStage){const H=ko(D,n.leadStage);if($(H),n.leadStatus){const h=Co(D,n.leadStatus);k(h)}else k([])}else $([]),k([])}catch(L){gt.error("Failed to load follow-up options:",L),c("Failed to load follow-up options."),d([]),P([]),$([]),k([])}finally{x(!1)}}})()},[s,r]);const T=A=>L=>F(D=>({...D,[A]:L.target.value})),j=A=>{const L=A.target.value,D=L?ko(b,L):[];$(D),k([]),F(I=>({...I,leadStage:L,leadStatus:"",remark:"",customRemark:""}))},E=A=>{const L=A.target.value,D=L?Co(b,L):[];k(D),F(I=>({...I,leadStatus:L,remark:"",customRemark:""}))},V=A=>{const L=A.target.value;F(D=>({...D,remark:L,customRemark:L?`${L} â€“ `:""}))},W=A=>{if(A.preventDefault(),f)return;if(!R.leadStage){alert("Please select a Lead Stage.");return}if(!R.leadStatus){alert("Please select a Lead Status.");return}const L={...R,lead_id:i,...(n==null?void 0:n.id)!=null?{id:String(n.id)}:{}};p(!0);try{t(L),a()}catch(D){gt.error("Save failed:",D),p(!1);return}F({followupType:Ur[0].value,leadStage:"",leadStatus:"",remark:"",customRemark:"",nextAction:"",scheduleDate:"",scheduleTime:"",priority:" - "}),p(!1)};l.useEffect(()=>{if(s)if(F({followupType:(n==null?void 0:n.followupType)||Ur[0].value,leadStage:(n==null?void 0:n.leadStage)||"",leadStatus:(n==null?void 0:n.leadStatus)||"",remark:(n==null?void 0:n.remark)||"",customRemark:(n==null?void 0:n.customRemark)||"",nextAction:(n==null?void 0:n.nextAction)||"",scheduleDate:(n==null?void 0:n.scheduleDate)||"",scheduleTime:(n==null?void 0:n.scheduleTime)||"",priority:(n==null?void 0:n.priority)||"Medium"}),b.length&&(n!=null&&n.leadStage)){const A=ko(b,n.leadStage);$(A);const L=n.leadStatus?Co(b,n.leadStatus):[];k(L)}else $([]),k([])},[s,n,b]);const B=Ur.find(A=>A.value===R.followupType)||Ur[0],M=B.color==="blue"?"focus:ring-blue-500":B.color==="green"?"focus:ring-green-500":B.color==="indigo"?"focus:ring-indigo-500":B.color==="orange"?"focus:ring-orange-500":B.color==="purple"?"focus:ring-purple-500":"focus:ring-gray-500";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-xl p-5 m-4 max-h-[90vh] overflow-y-auto border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-transparent bg-clip-text",children:o?"Edit Follow-up":"Add New Follow-up"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl leading-none","aria-label":"Close",children:"Ã—"})]}),u&&e.jsx("div",{className:"mb-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:u}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Followup Type"}),e.jsx(qu,{options:Ur,value:R.followupType,onChange:A=>F(L=>({...L,followupType:A})),disabled:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lead Priority"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",value:R.priority,onChange:T("priority"),children:[e.jsx("option",{value:"",children:"Select Priority"}),m.map(A=>e.jsx("option",{value:A.value,children:A.label},A.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lead Stage"}),e.jsxs("select",{className:`mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none ${M}`,value:R.leadStage,onChange:j,disabled:v||N.length===0,children:[e.jsx("option",{value:"",children:"Select stageâ€¦"}),N.map(A=>e.jsx("option",{value:A,children:A},A))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lead Status"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:R.leadStatus,onChange:E,disabled:v||!R.leadStage||w.length===0,children:[e.jsx("option",{value:"",children:R.leadStage?"Select statusâ€¦":"Select stage first"}),w.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",value:R.remark,onChange:V,disabled:v||!R.leadStatus||y.length===0,children:[e.jsx("option",{value:"",children:R.leadStatus?"Select remarkâ€¦":"Select status first"}),y.map(A=>e.jsx("option",{value:A,children:A},A))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Custom Remark"}),e.jsx("textarea",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 min-h-[90px] focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Select a remark above or type your own detailsâ€¦",value:R.customRemark,onChange:T("customRemark")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Next Action"}),e.jsx("input",{type:"text",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter next action...",value:R.nextAction,onChange:T("nextAction")})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Schedule Date"}),(()=>{const A=new Date;A.setDate(A.getDate()+1);const L=A.toISOString().split("T")[0];return e.jsx("input",{type:"date",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500",value:R.scheduleDate,onChange:T("scheduleDate"),min:L})})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Schedule Time"}),e.jsx("input",{type:"time",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500",value:R.scheduleTime,onChange:T("scheduleTime")})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md text-white bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 hover:brightness-110 transition-colors",disabled:v||f,children:o?f?"Updating...":"Update Follow-up":f?"Saving...":"Save Follow-up"})]})]})]})]})},U0={transferToBuyer:async s=>(await Ae.post("/transfer-to-buyer",s)).data},q0=({initialMin:s=.32,initialMax:a=4.95,max:t=10,onChange:r,className:i="",sliderLimit:n=6,collisionThresholdPercent:o=6})=>{const m=H=>Number.isNaN(H)?0:Math.max(0,H),g=m(Math.min(s,a)),b=m(Math.max(s,a)),[d,v]=l.useState(g),[x,u]=l.useState(b),[c,f]=l.useState(null),p=l.useRef(null),N=n>0?n:6,P=Array.from({length:Math.floor(N)+1},(H,h)=>h),w=H=>{if(H<=0)return"â‚¹0";if(H<1)return`â‚¹${Math.round(H*100)}L`;const h=H>=N?"+":"";return`â‚¹${Number.isInteger(H)?H.toString():H.toFixed(2)}Cr${h}`};l.useEffect(()=>{const H=`${w(d)} - ${w(x)}`,h=1e7,Y=Math.round(d*h),K=Math.round(x*h);r==null||r({min:Y,max:K,readable:H})},[d,x]);const $=H=>{const h=p.current;if(!h)return 0;const Y=h.getBoundingClientRect(),K=H-Y.left,q=Math.max(0,Math.min(1,K/Y.width));return Number((q*N).toFixed(2))},y=H=>{const h=$(H),Y=Math.min(d,N),K=Math.min(x,N),q=Math.abs(h-Y),ne=Math.abs(h-K);if(q<=ne){const le=Math.min(h,N);v(Number(Math.max(0,le).toFixed(2))),f("min")}else{const le=Math.min(h,N);u(Number(Math.min(t,le).toFixed(2))),f("max")}},k=(H,h)=>{H.preventDefault(),f(h)},R=H=>{if(!c||!p.current||H===null)return;const h=$(H);c==="min"?v(Number(Math.max(0,Math.min(N,h)).toFixed(2))):u(Number(Math.max(0,Math.min(t,h)).toFixed(2)))},F=()=>f(null);l.useEffect(()=>{const H=q=>R(q.clientX),h=()=>F(),Y=q=>{q.touches.length&&(q.preventDefault(),R(q.touches[0].clientX))},K=()=>F();return c&&(window.addEventListener("mousemove",H),window.addEventListener("mouseup",h),window.addEventListener("touchmove",Y,{passive:!1}),window.addEventListener("touchend",K)),()=>{window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",h),window.removeEventListener("touchmove",Y),window.removeEventListener("touchend",K)}},[c,d,x,N]);const T=H=>Math.min(H,N)/N*100,j=T(d),E=T(x),V=(j+E)/2,W=H=>{const h=Number.isNaN(H)?0:H,Y=d<1?h/100:h;Y>=0&&v(Number(Y.toFixed(2)))},B=H=>{const h=Number.isNaN(H)?0:H,Y=x<1?h/100:h;Y>=0&&u(Number(Y.toFixed(2)))},M=`
    /* hide number input spinners (Chrome, Edge, Safari) */
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    /* hide Firefox spinner */
    input[type=number] {
      -moz-appearance: textfield;
    }
  `,A=d<1?String(Math.round(d*100)):String(Number(d.toFixed(2))),L=x<1?String(Math.round(x*100)):String(Number(x.toFixed(2))),I=Math.abs(E-j)<=o;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 items-end text-xs mb-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Minimum Budget ",d<1?"(Lacs)":"(Crores)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:0,step:d<1?1:.01,value:A,onChange:H=>{const h=H.target.value===""?"0":H.target.value,Y=parseFloat(h);W(Y)},className:"w-full px-2 py-1 border border-gray-300 rounded-lg text-xs outline-none focus:ring-1 focus:ring-purple-500 focus:border-transparent",placeholder:d<1?"e.g. 32":"e.g. 0.32"}),e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500",children:d<1?"L":"Cr"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Maximum Budget ",x<1?"(Lacs)":"(Crores)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:0,step:x<1?1:.01,value:L,onChange:H=>{const h=H.target.value===""?"0":H.target.value,Y=parseFloat(h);B(Y)},className:"w-full px-2 py-1 border border-gray-300 rounded-lg text-xs outline-none focus:ring-1 focus:ring-purple-500 focus:border-transparent",placeholder:x<1?"e.g. 32":"e.g. 0.32"}),e.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500",children:[x<1?"L":"Cr",x>=N?"+":""]})]})]}),e.jsx("div",{className:"flex flex-col gap-1",children:e.jsx("button",{type:"button",onClick:()=>{v(.32),u(Math.min(4.95,t))},className:"px-3 py-1 text-xs border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:"Reset to Default"})})]}),e.jsxs("div",{className:`max-w-full ${i}`,children:[e.jsx("style",{children:M}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"relative h-6 mb-1 pointer-events-none",children:I?e.jsxs("div",{className:"absolute text-xs font-medium text-gray-700 transform -translate-x-1/2 bg-white px-2 py-0.5 rounded shadow-sm border",style:{left:`${V}%`,top:"-.2rem",whiteSpace:"nowrap"},"aria-hidden":!0,children:[w(d)," - ",w(x)]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute text-xs font-medium text-gray-700 transform -translate-x-1/2 bg-white px-2 py-0.5 rounded shadow-sm border",style:{left:`${j}%`,top:"-.2rem",whiteSpace:"nowrap"},"aria-hidden":!0,children:w(d)}),e.jsx("div",{className:"absolute text-xs font-medium text-gray-700 transform -translate-x-1/2 bg-white px-2 py-0.5 rounded shadow-sm border",style:{left:`${E}%`,top:"-.2rem",whiteSpace:"nowrap"},"aria-hidden":!0,children:w(x)})]})}),e.jsxs("div",{ref:p,className:"relative h-2 bg-gray-200 rounded-full mb-2 cursor-pointer",onMouseDown:H=>y(H.clientX),onTouchStart:H=>{H.touches.length&&(y(H.touches[0].clientX),H.preventDefault())},children:[e.jsx("div",{className:"absolute rounded-full",style:{height:"100%",left:`${Math.min(j,E)}%`,width:`${Math.abs(E-j)}%`,background:"linear-gradient(90deg,#7c3aed,#6d28d9)"}}),e.jsx("div",{role:"slider",tabIndex:0,"aria-valuemin":0,"aria-valuemax":N,"aria-valuenow":Math.min(d,N),className:"absolute w-4 h-4 bg-white border-2 border-purple-500 rounded-full cursor-pointer transform -translate-x-1/2 -translate-y-1/2 top-1/2 hover:scale-105 transition-transform shadow z-20",style:{left:`${j}%`},onMouseDown:H=>k(H,"min"),onTouchStart:H=>{H.touches.length&&(f("min"),H.preventDefault())},onKeyDown:H=>{(H.key==="ArrowLeft"||H.key==="ArrowDown")&&v(h=>Number(Math.max(0,Number((h-.01).toFixed(2))))),(H.key==="ArrowRight"||H.key==="ArrowUp")&&v(h=>Number(Math.min(N,Number((h+.01).toFixed(2)))))}}),e.jsx("div",{role:"slider",tabIndex:0,"aria-valuemin":0,"aria-valuemax":N,"aria-valuenow":Math.min(x,N),className:"absolute w-4 h-4 bg-white border-2 border-purple-500 rounded-full cursor-pointer transform -translate-x-1/2 -translate-y-1/2 top-1/2 hover:scale-105 transition-transform shadow z-20",style:{left:`${E}%`},onMouseDown:H=>k(H,"max"),onTouchStart:H=>{H.touches.length&&(f("max"),H.preventDefault())},onKeyDown:H=>{(H.key==="ArrowLeft"||H.key==="ArrowDown")&&u(h=>Number(Math.max(0,Number((h-.01).toFixed(2))))),(H.key==="ArrowRight"||H.key==="ArrowUp")&&u(h=>Number(Math.min(t,Number((h+.01).toFixed(2)))))}}),P.map(H=>{const h=H/N*100;return e.jsx("div",{style:{left:`${h}%`},className:"absolute top-0 transform -translate-x-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("div",{className:"w-0.5 h-3 bg-gray-400 rounded"})},String(H))})]}),e.jsx("div",{className:"flex justify-between text-xs text-gray-600 mb-2",children:P.map(H=>e.jsx("span",{className:"transform -translate-x-1/2",children:H===0?"â‚¹0":H===N?`â‚¹${H}Cr+`:`â‚¹${H}Cr`},String(H)))}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-600",children:"Selected Range :"}),e.jsxs("span",{className:"text-xs font-bold text-purple-600",children:[w(d)," - ",w(x)]})]})]})]})]})};function Vu(s,a){const t=a!=null?String(a):"",r=s.replace(/\/+$/g,"");return t?`${r}/${encodeURIComponent(t)}`:r}function Jd(s,a){const t=a!=null?String(a):"",r=(s||"/dashboard/buyers").replace(/\/+$/g,"");return t?`${r}/${encodeURIComponent(t)}`:r}async function Ao({lead:s,userId:a,message:t,type:r,link:i}){const n=Number((s==null?void 0:s.assignment_notification_id)??(s==null?void 0:s.notification_id)??0)||null,o=i&&i.trim().length?i:Vu("/dashboard/leads",s==null?void 0:s.id);await wa.updateNotification(n,{leadId:s.id,userId:a,message:t,type:r,link:o})}const V0=({lead:s,followups:a=[],onClose:t,onTransferSuccess:r})=>{var se,ge;const{user:i}=Hs(),[n,o]=l.useState(!1),[m,g]=l.useState(!1),[b,d]=l.useState(!1),v=l.useRef(null),x=l.useRef(null),u=l.useRef(null),[c,f]=l.useState(!0),[p,N]=l.useState({}),[P,w]=l.useState([]),[$,y]=l.useState([]),[k,R]=l.useState([]),[F,T]=l.useState(!1),[j,E]=l.useState({salutation:"",name:"",phone:"",whatsapp_number:"",email:"",city:"",state:"",location:"",lead_source:"",lead_type:"",priority:"",status:"",stage:"",created_at:"",created_by:"",last_contact:"",last_contacted_by:"",budget_range:"",budget_range_readable:"",budget_min:0,budget_max:0,preferred_unit_type:[],preferred_location:[],property_subtype:"",property_type:"",assigned_executive:"",remark:"",nearbylocations:"",updated_at:"",is_active:!0});l.useEffect(()=>{console.info("BuyerFormModal received followups:",a)},[a]),l.useEffect(()=>{(async()=>{var ee;try{const de=await((ee=Os.getAllUsers)==null?void 0:ee.call(Os)),U=(de==null?void 0:de.data)||[];w(U);const X=G=>(G??"").toString().trim().toLowerCase().replace(/[\s-_/]+/g,""),re=U.filter(G=>{const me=X((G==null?void 0:G.department)||(G==null?void 0:G.department_name)),oe=X((G==null?void 0:G.role)||(G==null?void 0:G.role_name));return me==="presales"&&oe==="executive"});y(re);const fe=U.filter(G=>{const me=X((G==null?void 0:G.department)||(G==null?void 0:G.department_name)),oe=X((G==null?void 0:G.role)||(G==null?void 0:G.role_name));return me==="sales"&&oe==="executive"});R(fe)}catch(de){console.error("Failed to load users:",de)}})()},[]),l.useEffect(()=>{if(!s)return;let ee=0,de=0;if(s.budget_min!=null||s.budget_max!=null)ee=Number(s.budget_min)||0,de=Number(s.budget_max)||0;else if(s.budget_range){const U=String(s.budget_range).split("-").map(X=>parseFloat(X)||0);ee=U[0]??0,de=U[1]??U[0]??0}E(U=>({...U,salutation:s.salutation??"",name:s.name??"",phone:s.phone??"",whatsapp_number:s.whatsapp_number??"",email:s.email??"",city:s.city??"",state:s.state??"",location:s.location??"",lead_source:s.lead_source??"",lead_type:s.lead_type??"",priority:s.priority??"",status:s.status??"",stage:s.stage??"",created_at:s.created_at??"",created_by:s.created_by??"",last_contact:s.last_contact??"",last_contacted_by:s.last_contacted_by??"",budget_range:s.budget_range??(ee||de?`${ee}-${de}`:""),budget_range_readable:s.budget_range_readable??"",budget_min:ee,budget_max:de,preferred_unit_type:s.preferred_unit_type??[],preferred_location:s.preferred_location??[],property_subtype:s.property_subtype??"",property_type:s.property_type??"",assigned_executive:s.assigned_executive??"",remark:s.remark??"",nearbylocations:s.nearbylocations??"",updated_at:s.updated_at??"",is_active:s.is_active!=null?!!s.is_active:!0}))},[s]),l.useEffect(()=>{(async()=>{try{f(!0);const de=await Gt(["common","property"]);N(de)}catch(de){console.error("Error fetching master options:",de)}finally{f(!1)}})()},[]);const V=ee=>{for(const de of ee){const U=p[de];if(Array.isArray(U)&&U.length)return U.map(X=>typeof X=="string"?X:X.name??X.label??X.title??X.value??X.id)}return[]},W=V(["location","locations","preferred_location","locations_list"]),B=V(["unit type","unit_type","unitType","unit_types","unitTypes"]),M=V(["property subtype","property_subtype","propertySubtype","property_subtypes"]),A=V(["property type","property_type","propertyType","property_types"]),L=ee=>{if(!ee)return"";const de=P.find(U=>String(U.id)===String(ee)||String(U._id)===String(ee));return(de==null?void 0:de.name)||(de==null?void 0:de.full_name)||(de==null?void 0:de.username)||`${(de==null?void 0:de.first_name)||""} ${(de==null?void 0:de.last_name)||""}`.trim()||""},D="border-2 border-green-400 rounded-lg p-2 mt-2 space-y-3 bg-white",I="w-full border rounded h-9 px-2 text-xs bg-white focus:outline-none focus:border-green-600",H="w-full border rounded px-2 py-1 text-xs bg-white focus:outline-none focus:border-green-600 resize-none",h="w-full flex items-center justify-between space-x-1 border rounded p-1 text-xs bg-white hover:bg-gray-50",Y=()=>{if(!(j!=null&&j.assigned_executive))return!1;const ee=String(j.assigned_executive);return!!k.find(U=>String(U.id)===ee||String(U._id)===ee)},K=()=>{const ee=s==null?void 0:s.assigned_executive_name;if(j!=null&&j.assigned_executive){const de=String(j.assigned_executive),U=k.find(X=>String(X.id)===de||String(X._id)===de);return U?U.name||U.full_name||`${U.first_name||""} ${U.last_name||""}`.trim()||"Executive":"Unassigned (Currently Presales)"}return ee&&String(ee).trim()!==""&&ee.toLowerCase()!=="unassigned"?k.find(U=>{const X=U.name||U.full_name||`${U.first_name||""} ${U.last_name||""}`.trim();return String(X||"").toLowerCase()===ee.toLowerCase()})?ee:"Unassigned (Currently Presales)":"Unassigned"},q=()=>{const de=((Da==null?void 0:Da(i,k))??k).filter(Boolean).map(re=>({...re,name:re.name||re.full_name||`${re.first_name||""} ${re.last_name||""}`.trim()||"Executive"})),U=String(j.assigned_executive||"");return Y()&&U!==""?de.filter(re=>String(re.id)!==U):de},ne=async ee=>{try{const de=j.assigned_executive;if(E(U=>({...U,assigned_executive:ee})),d(!1),ee&&ee.trim()!==""){const U=String(ee),X=k.find(fe=>String(fe.id)===U||String(fe._id)===U)||$.find(fe=>String(fe.id)===U||String(fe._id)===U)||P.find(fe=>String(fe.id)===U||String(fe._id)===U),re=(X==null?void 0:X.name)||(X==null?void 0:X.full_name)||`${(X==null?void 0:X.first_name)||""} ${(X==null?void 0:X.last_name)||""}`.trim()||L(ee)||"Executive";if(ee!==de)try{await Ao({lead:s,userId:Number(ee),message:`Buyer lead assigned to ${re}`,type:"buyer_assign",link:Vu("/dashboard/leads",s==null?void 0:s.id)})}catch(fe){console.error("Failed to update assignment notification:",fe),Z.warn("Executive assigned but notification update failed")}Z.success(`Buyer assigned to ${re}`)}else Z.success("Executive assignment removed")}catch(de){console.error("Error assigning executive:",de),Z.error("Failed to assign. Please try again.")}},le=ee=>{const{name:de,value:U}=ee.target;E(X=>({...X,[de]:U}))},S=(ee,de)=>{E(U=>{const X=U[ee]??[],re=X.includes(de)?X.filter(fe=>fe!==de):[...X,de];return{...U,[ee]:re}})},C=ee=>{const{value:de}=ee.target;E(U=>({...U,nearbylocations:de}))},J=ee=>{const{value:de}=ee.target;E(U=>({...U,remark:de}))},ue=()=>{g(!1),d(!1),o(ee=>!ee)},Q=()=>{o(!1),d(!1),g(ee=>!ee)};l.useEffect(()=>{const ee=de=>{const U=de.target;v.current&&!v.current.contains(U)&&n&&o(!1),x.current&&!x.current.contains(U)&&m&&g(!1),u.current&&!u.current.contains(U)&&b&&d(!1)};return document.addEventListener("click",ee),()=>document.removeEventListener("click",ee)},[n,m,b]);const he=async ee=>{var _e,ve,Pe,We;if(ee.preventDefault(),F)return;const de=Number(j.budget_min)||0,U=Number(j.budget_max)||0,X={propertyType:j.property_type||null,property_subtype:j.property_subtype||null,unitTypes:Array.isArray(j.preferred_unit_type)?j.preferred_unit_type:[],preferredLocations:Array.isArray(j.preferred_location)?j.preferred_location:[],nearbylocations:j.nearbylocations?typeof j.nearbylocations=="string"?j.nearbylocations.split(",").map(pe=>pe.trim()).filter(pe=>pe):j.nearbylocations:[]},{budget_range:re,budget_range_readable:fe,property_type:G,property_subtype:me,preferred_unit_type:oe,preferred_location:Fe,nearbylocations:$e,...Le}=j,je={budget_min:de,budget_max:U,requirements:X,assigned_executive:j.assigned_executive||null,updated_at:new Date().toISOString(),is_active:j.is_active!==void 0?!!j.is_active:!0,remark:j.remark||""};try{T(!0);const pe=await U0.transferToBuyer({leadId:s.id,overrides:je,createdBy:i==null?void 0:i.id});if(j.assigned_executive&&String(j.assigned_executive).trim()!=="")try{const O=String(j.assigned_executive),Ie=k.find(Ee=>String(Ee.id)===O||String(Ee._id)===O)||$.find(Ee=>String(Ee.id)===O||String(Ee._id)===O)||P.find(Ee=>String(Ee.id)===O||String(Ee._id)===O),ze=(Ie==null?void 0:Ie.name)||(Ie==null?void 0:Ie.full_name)||`${(Ie==null?void 0:Ie.first_name)||""} ${(Ie==null?void 0:Ie.last_name)||""}`.trim()||"Executive",xe=((_e=pe==null?void 0:pe.data)==null?void 0:_e.id)||(pe==null?void 0:pe.id)||s.id;await Ao({lead:s,userId:Number(O),message:`New buyer transferred and assigned to ${ze}`,type:"buyer_transfer",link:Jd("/dashboard/buyers",xe)})}catch(O){console.error("Failed to update transfer notification:",O)}if(s.created_by&&String(s.created_by)!==String(i==null?void 0:i.id))try{const O=((ve=pe==null?void 0:pe.data)==null?void 0:ve.id)||(pe==null?void 0:pe.id)||s.id;await Ao({lead:s,userId:Number(s.created_by),message:`Your lead "${s.name}" has been transferred to buyer`,type:"lead_transfer",link:Jd("/dashboard/buyers",O)})}catch(O){console.error("Failed to update creator notification:",O)}Z.success("Lead successfully transferred to buyer!"),r&&pe&&r(pe),t()}catch(pe){console.error("âŒ Buyer transfer failed:",pe),(We=(Pe=pe==null?void 0:pe.response)==null?void 0:Pe.data)!=null&&We.message?Z.error(`Transfer failed: ${pe.response.data.message}`):pe!=null&&pe.message?Z.error(`Transfer failed: ${pe.message}`):Z.error("Failed to transfer lead to buyer. Please try again.")}finally{T(!1)}};return e.jsx(ma,{isOpen:!0,onClose:t,title:"Transfer to Buyer",width:"max-w-4xl",children:e.jsx("div",{className:"text-xs",children:e.jsxs("form",{onSubmit:he,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-2 p-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salutation"}),e.jsx("input",{type:"text",name:"salutation",value:j.salutation,readOnly:!0,className:"border border-gray-300 rounded w-full h-8 px-1 text-xs bg-gray-100 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:j.name,readOnly:!0,className:"border border-gray-300 rounded w-full h-8 px-1 text-xs bg-gray-100 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium",children:"Phone"}),e.jsx("input",{type:"text",name:"phone",value:j.phone,readOnly:!0,className:"border border-gray-300 rounded w-full h-8 px-1 text-xs bg-gray-100 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium",children:"WhatsApp Number"}),e.jsx("input",{type:"text",name:"whatsapp_number",value:j.whatsapp_number,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:j.email,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"State"}),e.jsx("input",{type:"text",name:"state",value:j.state,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"City"}),e.jsx("input",{type:"text",name:"city",value:j.city,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:j.location,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Lead Source"}),e.jsx("input",{type:"text",name:"lead_source",value:j.lead_source,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Lead Type"}),e.jsx("input",{type:"text",name:"lead_type",value:j.lead_type,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Status"}),e.jsx("input",{type:"text",name:"status",value:j.status,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Created By"}),e.jsx("input",{type:"text",name:"created_by",value:(s==null?void 0:s.created_by_name)||L(j.created_by)||j.created_by||"",readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]})]})]}),e.jsxs("div",{className:D,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Property Type"}),e.jsxs("select",{name:"property_type",value:j.property_type,onChange:le,className:I,children:[e.jsx("option",{value:"",children:"Select Property Type"}),A.length>0?A.map(ee=>e.jsx("option",{value:ee,children:ee},ee)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"Commercial",children:"Commercial"}),e.jsx("option",{value:"Residential",children:"Residential"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Property Subtype"}),e.jsxs("select",{name:"property_subtype",value:j.property_subtype,onChange:le,className:I,children:[e.jsx("option",{value:"",children:"Select Property Subtype"}),M.length>0?M.map(ee=>e.jsx("option",{value:ee,children:ee},ee)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"Apartment",children:"Apartment"}),e.jsx("option",{value:"Row House",children:"Row House"}),e.jsx("option",{value:"Plot",children:"Plot"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-green-700",children:"Assigned Sales Executive"}),e.jsxs("div",{className:"relative",ref:u,children:[e.jsxs("button",{type:"button",onClick:()=>d(!b),className:h,children:[e.jsx("span",{className:"truncate text-xs",children:K()}),e.jsx(ea,{className:"w-3 h-3 flex-shrink-0"})]}),b&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-full bg-white rounded-lg shadow-lg border z-[9999] text-xs",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wide px-2 py-1 border-b truncate",children:"Assign to Sales Executive"}),(()=>{const ee=q();return!ee||ee.length===0?e.jsx("div",{className:"px-2 py-2 text-xs text-gray-500",children:"No sales executives available"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>ne(""),className:`w-full text-left px-2 py-2 hover:bg-gray-100 rounded text-xs truncate ${!j.assigned_executive||j.assigned_executive===""?"bg-blue-50 text-blue-600 font-medium":"text-gray-800"}`,children:"Unassigned"},"unassigned"),ee.map(de=>e.jsxs("button",{type:"button",onClick:()=>ne(String(de.id)),className:`w-full text-left px-2 py-2 hover:bg-gray-100 rounded text-xs truncate ${String(j.assigned_executive)===String(de.id)?"bg-blue-50 text-blue-600 font-medium":"text-gray-800"}`,children:[de.name,de.selfOnly&&e.jsx("span",{className:"text-[10px] text-gray-400 ml-1",children:"(Self)"})]},de.id))]})})()]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"relative grid",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Preferred Unit Type"}),e.jsxs("div",{children:[e.jsxs("div",{ref:v,role:"button",tabIndex:0,onClick:ue,className:h,children:[e.jsx("div",{className:"flex flex-wrap gap-1 text-xs",children:((se=j.preferred_unit_type)==null?void 0:se.length)>0?j.preferred_unit_type.map(ee=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[e.jsx("span",{children:ee}),e.jsx("span",{role:"button",tabIndex:0,onClick:de=>{de.stopPropagation(),S("preferred_unit_type",ee)},className:"ml-1 text-blue-600 hover:text-blue-800 text-xs cursor-pointer","aria-label":`Remove ${ee}`,children:"Ã—"})]},ee)):e.jsx("span",{className:"text-xs",children:"Select Unit Types"})}),e.jsx("span",{className:"text-gray-500 ml-2",children:"â–¼"})]}),n&&v.current&&e.jsx("div",{className:"bg-white border rounded shadow-lg text-xs",style:{position:"fixed",zIndex:9999,top:v.current.getBoundingClientRect().bottom+window.scrollY+4,left:v.current.getBoundingClientRect().left+window.scrollX,width:v.current.getBoundingClientRect().width},children:(B.length>0?B:["1BHK","2BHK","3BHK","Villa"]).map(ee=>{var de;return e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 cursor-pointer text-xs",children:[e.jsx("input",{type:"checkbox",checked:(de=j.preferred_unit_type)==null?void 0:de.includes(ee),onChange:()=>S("preferred_unit_type",ee),className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:ee})]},ee)})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Preferred Location"}),e.jsxs("div",{children:[e.jsxs("div",{ref:x,role:"button",tabIndex:0,onClick:Q,className:h,children:[e.jsx("div",{className:"flex flex-wrap gap-1 text-xs",children:((ge=j.preferred_location)==null?void 0:ge.length)>0?j.preferred_location.map(ee=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:[e.jsx("span",{children:ee}),e.jsx("span",{role:"button",tabIndex:0,onClick:de=>{de.stopPropagation(),S("preferred_location",ee)},className:"ml-1 text-green-600 hover:text-green-800 cursor-pointer text-xs","aria-label":`Remove ${ee}`,children:"Ã—"})]},ee)):e.jsx("span",{className:"text-xs",children:"Select Locations"})}),e.jsx("span",{className:"text-gray-500 ml-2",children:"â–¼"})]}),m&&x.current&&e.jsx("div",{className:"bg-white border rounded shadow-lg max-h-40 overflow-y-auto text-xs",style:{position:"fixed",zIndex:9999,top:x.current.getBoundingClientRect().bottom+window.scrollY+4,left:x.current.getBoundingClientRect().left+window.scrollX,width:x.current.getBoundingClientRect().width},children:(W.length>0?W:["Hinjewadi","Baner","Wakad","Pune"]).map(ee=>{var de;return e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 cursor-pointer text-xs",children:[e.jsx("input",{type:"checkbox",checked:(de=j.preferred_location)==null?void 0:de.includes(ee),onChange:()=>S("preferred_location",ee),className:"mr-2 h-3 w-3"}),e.jsx("span",{className:"text-xs",children:ee})]},ee)})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Budget Range"}),e.jsx("div",{className:"mt-2",children:e.jsx(q0,{initialMin:Number(j==null?void 0:j.budget_min)||j!=null&&j.budget_range&&parseFloat(String(j.budget_range).split("-")[0])||.32,initialMax:Number(j==null?void 0:j.budget_max)||j!=null&&j.budget_range&&parseFloat(String(j.budget_range).split("-")[1])||4.95,max:50,onChange:({min:ee,max:de,readable:U})=>{const X=Number(ee)||0,re=Number(de)||X;E(fe=>({...fe,budget_min:X,budget_max:re,budget_range:`${X}-${re}`,budget_range_readable:U}))}})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-2 gap-2 items-start",children:[e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("label",{htmlFor:"nearbylocations",className:"block text-xs font-medium text-gray-700 mb-1",children:"Nearby Location"}),e.jsx("textarea",{id:"nearbylocations",name:"nearbylocations",value:j.nearbylocations,onChange:C,rows:3,placeholder:"e.g. Near City Mall, beside Community Park",className:H})]}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Buyer Remark"}),e.jsx("textarea",{name:"remark",value:j.remark,onChange:J,rows:3,placeholder:"Add any buyer remarks here...",className:H})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-1",children:[e.jsx("button",{type:"button",onClick:t,disabled:F,className:"px-3 py-1 bg-gray-300 rounded text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:F,className:"px-3 py-1 bg-blue-600 text-white rounded text-xs disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:F?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Transfer to Buyer"})]})]})})})},W0={transferToSeller:async s=>(await Ae.post("/transfer-to-seller",s)).data},Po=1e7,H0=()=>{};function Qd(s,a){const t=a!=null?String(a):"",r=(s||"/dashboard/leads").replace(/\/+$/g,"");return t?`${r}/${encodeURIComponent(t)}`:r}const Y0=({lead:s,followups:a=[],onClose:t=H0,onTransferSuccess:r,isOpen:i=!0})=>{const{user:n}=Hs(),o="border-2 border-green-400 rounded-lg p-2 mt-2 space-y-3 bg-white",m="w-full border rounded h-9 px-2 text-xs bg-white focus:outline-none focus:border-green-600",g="w-full border rounded px-2 py-1 text-xs bg-white focus:outline-none focus:border-green-600 resize-none",b="w-full flex items-center justify-between space-x-1 border rounded p-1 text-xs bg-white hover:bg-gray-50",[d,v]=l.useState(!1),x=l.useRef(null);l.useEffect(()=>{const ge=ee=>{const de=ee.target;x.current&&!x.current.contains(de)&&d&&v(!1)};return document.addEventListener("click",ge),()=>document.removeEventListener("click",ge)},[d]);const[u,c]=l.useState(!0),[f,p]=l.useState({});l.useEffect(()=>{(async()=>{try{c(!0);const ge=await Gt(["property","common"]);p(ge)}catch(ge){console.error("Masters load failed:",ge)}finally{c(!1)}})()},[]);const N=ge=>{for(const ee of ge){const de=f[ee];if(Array.isArray(de)&&de.length)return de.map(U=>typeof U=="string"?U:U.name??U.label??U.title??U.value??U.id)}return[]},P=N(["property type","property_type","propertyType","property_types"]),w=N(["property subtype","property_subtype","propertySubtype","property_subtypes"]),$=N(["unit type","unit_type","unitType","unit_types","unitTypes"]),y=N(["location name","location_name","location","locations","locations_list"]),k=N(["society","society_name","societies","society_list"]),R=N(["city name","city_name","city","cities","city_list"]),[F,T]=l.useState([]),[j,E]=l.useState([]),[V,W]=l.useState([]);l.useEffect(()=>{(async()=>{var ge;try{const ee=await((ge=Os.getAllUsers)==null?void 0:ge.call(Os)),de=(ee==null?void 0:ee.data)||[];T(de);const U=fe=>(fe??"").toString().trim().toLowerCase().replace(/[\s-_/]+/g,""),X=de.filter(fe=>{const G=U((fe==null?void 0:fe.department)||(fe==null?void 0:fe.department_name)),me=U((fe==null?void 0:fe.role)||(fe==null?void 0:fe.role_name));return G==="presales"&&me==="executive"});E(X);const re=de.filter(fe=>{const G=U((fe==null?void 0:fe.department)||(fe==null?void 0:fe.department_name)),me=U((fe==null?void 0:fe.role)||(fe==null?void 0:fe.role_name));return G==="sales"&&me==="executive"});W(re)}catch(ee){console.error("Failed to load users:",ee)}})()},[]);const B=ge=>{if(!ge)return"";const ee=F.find(de=>String(de.id)===String(ge)||String(de._id)===String(ge));return(ee==null?void 0:ee.name)||(ee==null?void 0:ee.full_name)||(ee==null?void 0:ee.username)||`${(ee==null?void 0:ee.first_name)||""} ${(ee==null?void 0:ee.last_name)||""}`.trim()||""},[M,A]=l.useState({salutation:"",name:"",phone:"",whatsapp_number:"",email:"",city:"",state:"",location:"",lead_source:"",lead_type:"",priority:"",status:"",stage:"",created_at:"",created_by:"",last_contact:"",last_contacted_by:"",updated_at:"",is_active:!0,assigned_executive:"",property_type:"",property_subtype:"",unit_type:"",society_name:"",location_name:"",city_name:"",carpet_area:"",seller_remark:"",id:"",price_min_cr:.01,price_max_cr:.01,price_max_rupees:1e5,price_readable:"1L"}),L=()=>{if(!(M!=null&&M.assigned_executive))return!1;const ge=String(M.assigned_executive);return!!V.find(de=>String(de.id)===ge||String(de._id)===ge)},D=()=>{const ge=s==null?void 0:s.assigned_executive_name;if(M!=null&&M.assigned_executive){const ee=String(M.assigned_executive),de=V.find(U=>String(U.id)===ee||String(U._id)===ee)||null;return de?de.name||de.full_name||`${de.first_name||""} ${de.last_name||""}`.trim()||"Executive":"Unassigned (Currently Presales)"}return ge&&String(ge).trim()!==""&&ge.toLowerCase()!=="unassigned"?V.find(de=>{const U=de.name||de.full_name||`${de.first_name||""} ${de.last_name||""}`.trim();return String(U||"").toLowerCase()===ge.toLowerCase()})?ge:"Unassigned (Currently Presales)":"Unassigned"},I=()=>{const ee=((Da==null?void 0:Da(n,V))??V).filter(Boolean).map(X=>({...X,name:X.name||X.full_name||`${X.first_name||""} ${X.last_name||""}`.trim()||"Executive"})),de=String(M.assigned_executive||"");return L()&&de!==""?ee.filter(X=>String(X.id)!==de):ee},H=async({userId:ge,message:ee,type:de,link:U})=>{const X=Number((s==null?void 0:s.assignment_notification_id)??(s==null?void 0:s.notification_id)??0)||null,re=U&&U.trim().length?Qd(U,s==null?void 0:s.id):Qd("/dashboard/leads",s==null?void 0:s.id);await wa.updateNotification(X,{leadId:String(s.id),userId:ge,message:ee,type:de,link:re})},h=async ge=>{try{const ee=M.assigned_executive;if(A(de=>({...de,assigned_executive:ge})),v(!1),ge&&ge.trim()!==""){const de=String(ge),U=V.find(re=>String(re.id)===de||String(re._id)===de)||j.find(re=>String(re.id)===de||String(re._id)===de)||F.find(re=>String(re.id)===de||String(re._id)===de),X=(U==null?void 0:U.name)||(U==null?void 0:U.full_name)||`${(U==null?void 0:U.first_name)||""} ${(U==null?void 0:U.last_name)||""}`.trim()||B(ge)||"Executive";if(ge!==ee)try{await H({userId:Number(ge),message:`Seller lead assigned to ${X}`,type:"seller_assign",link:"/dashboard/leads"})}catch(re){console.error("Notification update failed:",re),Z.warn("Executive assigned but notification update failed")}Z.success(`Seller assigned to ${X}`)}else Z.success("Executive assignment removed")}catch(ee){console.error("Assign error:",ee),Z.error("Failed to assign. Please try again.")}};l.useEffect(()=>{s&&A(ge=>({...ge,salutation:s.salutation??"",name:s.name??"",phone:s.phone??"",whatsapp_number:s.whatsapp_number??"",email:s.email??"",city:s.city??"",state:s.state??"",location:s.location??"",lead_source:s.lead_source??"",lead_type:s.lead_type??"",priority:s.priority??"",status:s.status??"",stage:s.stage??"",created_at:s.created_at??"",created_by:s.created_by??"",last_contact:s.last_contact??"",last_contacted_by:s.last_contacted_by??"",updated_at:s.updated_at??new Date().toISOString(),is_active:s.is_active!=null?!!s.is_active:!0,assigned_executive:s.assigned_executive??"",unit_type:s.unit_type??ge.unit_type,society_name:s.society_name??ge.society_name,location_name:s.location_name??ge.location_name,city_name:s.city_name??ge.city_name,carpet_area:s.carpet_area??ge.carpet_area,id:s.id??"",price_min_cr:(s==null?void 0:s.price_min_cr)??ge.price_min_cr,price_max_cr:(s==null?void 0:s.price_max_cr)??ge.price_max_cr,price_max_rupees:(s==null?void 0:s.price_max_rupees)??Math.round(((s==null?void 0:s.price_max_cr)??ge.price_max_cr)*Po),price_readable:(s==null?void 0:s.price_readable)??ge.price_readable}))},[s]),l.useEffect(()=>{if(a!=null&&a.length)try{const ge=a.map(ee=>({id:ee==null?void 0:ee.id,type:ee==null?void 0:ee.type,remark:(ee==null?void 0:ee.remark)??(ee==null?void 0:ee.customRemark),nextAction:(ee==null?void 0:ee.next_action)??(ee==null?void 0:ee.nextAction),scheduledDate:(ee==null?void 0:ee.scheduledDate)??(ee==null?void 0:ee.scheduled_date),priority:ee==null?void 0:ee.priority,stage:ee==null?void 0:ee.stage,status:ee==null?void 0:ee.status,createdAt:(ee==null?void 0:ee.createdAt)??(ee==null?void 0:ee.created_at)}))}catch{}},[a]);const[Y,K]=l.useState(!1),[q,ne]=l.useState({}),[le,S]=l.useState(null),C=ge=>{const{name:ee,value:de,type:U,checked:X}=ge.target;A(re=>({...re,[ee]:U==="checkbox"?!!X:de}))},J=()=>{const ge={};return(!M.name||String(M.name).trim().length<2)&&(ge.name="Name is required"),(!M.phone||String(M.phone).trim().length<6)&&(ge.phone="Valid phone required"),ne(ge),Object.keys(ge).length===0},ue=ge=>{if(!ge)return null;const ee=new Date(ge);return Number.isNaN(ee.getTime())?null:ee},Q=ge=>ge?`${ge.getFullYear()}-${String(ge.getMonth()+1).padStart(2,"0")}-${String(ge.getDate()).padStart(2,"0")}`:null,he=ge=>ge?`${String(ge.getHours()).padStart(2,"0")}:${String(ge.getMinutes()).padStart(2,"0")}:${String(ge.getSeconds()).padStart(2,"0")}`:null,se=async ge=>{var ee,de,U,X,re;if(ge&&ge.preventDefault(),!!J()){K(!0);try{const fe=M.assigned_executive&&String(M.assigned_executive).trim()!==""?Number(M.assigned_executive):null,G=(()=>{if(!fe)return null;const Pe=V.find(We=>Number(We.id)===fe)||j.find(We=>Number(We.id)===fe)||F.find(We=>Number(We.id)===fe);return(Pe==null?void 0:Pe.name)||(Pe==null?void 0:Pe.full_name)||`${(Pe==null?void 0:Pe.first_name)||""} ${(Pe==null?void 0:Pe.last_name)||""}`.trim()||null})(),me=new Date().toISOString(),oe={salutation:M.salutation||null,name:M.name||null,phone:M.phone||null,whatsapp:M.whatsapp_number||null,email:M.email||null,state:M.state||null,city:M.city||null,location:M.location||null,countryCode:null,stage:M.stage||null,leadType:M.lead_type||null,priority:M.priority||null,status:M.status||null,source:M.lead_source||null,notes:M.seller_remark||null,seller_dob:null,expected_close:null,last_activity:me,lead_score:null,deal_value:null,visits:0,total_visits:0,stage_progress:null,deal_potential:null,response_rate:null,avg_response_time:null,assigned_to:fe,assigned_to_name:G,notifications:null,is_active:(s==null?void 0:s.is_active)!=null?!!s.is_active:!0,created_at:me,updated_at:me,current_stage:M.stage||null,lead_id:(s==null?void 0:s.id)??null},Fe=Number(M.price_max_cr)||0,$e=Math.round(Number(M.price_max_rupees)||Fe*Po||0)||0,Le={seller_id:null,seller_name:oe.name||null,lead_id:String((s==null?void 0:s.id)||""),assigned_to:fe,property_type_name:M.property_type||null,property_subtype_name:M.property_subtype||null,unit_type:M.unit_type||null,wing:null,unit_no:null,furnishing:null,bedrooms:null,bathrooms:null,facing:null,parking_type:null,parking_qty:null,city_name:M.city_name||M.city||null,location_name:M.location_name||M.location||null,society_name:M.society_name||null,floor:null,total_floors:null,carpet_area:M.carpet_area||null,builtup_area:null,price_max_cr:Fe,price_max_rupees:$e,budget:$e,final_price:$e,address:null,status:"new",lead_source:M.lead_source||null,possession_month:null,possession_year:null,purchase_month:null,purchase_year:null,selling_rights:null,ownership_doc_path:null,photos:null,amenities:null,furnishing_items:null,description:null,created_at:me,updated_at:me,is_public:0,publication_date:null,created_by:(n==null?void 0:n.id)||null,updated_by:(n==null?void 0:n.id)||null,public_views:0,public_inquiries:0,slug:null},je=(a||[]).map(Pe=>{const We=ue(Pe==null?void 0:Pe.scheduled_date)||ue(Pe==null?void 0:Pe.scheduledDate)||ue(Pe==null?void 0:Pe.scheduled_at)||ue(Pe==null?void 0:Pe.scheduledAt)||null,pe=ue(Pe==null?void 0:Pe.completed_date)||ue(Pe==null?void 0:Pe.completedDate)||ue(Pe==null?void 0:Pe.completed_at)||null;return{followup_id:(Pe==null?void 0:Pe.id)??null,lead_id:(s==null?void 0:s.id)??null,seller_id:null,followup_type:(Pe==null?void 0:Pe.type)||(Pe==null?void 0:Pe.followup_type)||"other",status:(Pe==null?void 0:Pe.status)||null,priority:(Pe==null?void 0:Pe.priority)||"Medium",notes:(Pe==null?void 0:Pe.remark)||(Pe==null?void 0:Pe.customRemark)||null,assigned_to:M.assigned_executive&&String(M.assigned_executive).trim()!==""?Number(M.assigned_executive):(Pe==null?void 0:Pe.assigned_to)??(Pe==null?void 0:Pe.assigned_executive)??null,followup_date:Q(We),followup_time:he(We),reminder:null,seller_lead_stage:(Pe==null?void 0:Pe.stage)??null,seller_lead_status:(Pe==null?void 0:Pe.status)??null,remark:(Pe==null?void 0:Pe.remark)??null,custom_remark:(Pe==null?void 0:Pe.custom_remark)??(Pe==null?void 0:Pe.customRemark)??null,next_action:(Pe==null?void 0:Pe.next_action)??(Pe==null?void 0:Pe.nextAction)??null,completed_date:pe?`${Q(pe)} ${he(pe)}`:null,transferred_from_lead:1,transferred_at:me,transferred_by:(n==null?void 0:n.id)??null,transfer_type:"lead_transfer",created_by:(Pe==null?void 0:Pe.created_by)??(n==null?void 0:n.id)??null,updated_by:(Pe==null?void 0:Pe.updated_by)??(n==null?void 0:n.id)??null,created_at:(Pe==null?void 0:Pe.created_at)??me,updated_at:(Pe==null?void 0:Pe.updated_at)??me}}),_e={leadId:s==null?void 0:s.id,createdBy:(n==null?void 0:n.id)||null,seller:oe,my_property:Le,seller_followups:je,__debug_source:{formData:M}};S(_e);const ve=await W0.transferToSeller(_e);if(M.assigned_executive&&String(M.assigned_executive).trim()!=="")try{const Pe=((ee=ve==null?void 0:ve.seller)==null?void 0:ee.id)||(ve==null?void 0:ve.seller_id)||(ve==null?void 0:ve.id),We=Pe!=null?`/dashboard/sellers/${encodeURIComponent(Pe)}`:"/dashboard/leads";await H({userId:Number(M.assigned_executive),message:`New seller transferred and assigned to ${D()||"Executive"}`,type:"seller_transfer",link:We})}catch(Pe){console.error("Transfer notification update failed:",Pe)}Z.success("Lead transferred to seller!"),r==null||r(ve),t==null||t()}catch(fe){console.error("Seller transfer failed:",fe);const G=((U=(de=fe==null?void 0:fe.response)==null?void 0:de.data)==null?void 0:U.message)||((re=(X=fe==null?void 0:fe.response)==null?void 0:X.data)==null?void 0:re.error)||(fe==null?void 0:fe.message)||"Failed to transfer lead to seller.";Z.error(G)}finally{K(!1)}}};return e.jsx(ma,{isOpen:!!i,onClose:()=>t==null?void 0:t(),title:"Transfer to Seller",width:"max-w-4xl",children:e.jsxs("form",{onSubmit:se,className:"space-y-3 text-xs",children:[e.jsxs("div",{className:"space-y-2 p-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salutation"}),e.jsx("input",{type:"text",name:"salutation",value:M.salutation,readOnly:!0,className:"border border-gray-300 rounded w-full h-8 px-1 text-xs bg-gray-100 cursor-not-allowed focus:outline-none"})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:M.name,readOnly:!0,className:"border border-gray-300 rounded w-full h-8 px-1 text-xs bg-gray-100 cursor-not-allowed focus:outline-none"}),q.name&&e.jsx("div",{className:"text-red-600 text-[11px] mt-1",children:q.name})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium",children:"Phone"}),e.jsx("input",{type:"text",name:"phone",value:M.phone,readOnly:!0,className:"border border-gray-300 rounded w-full h-8 px-1 text-xs bg-gray-100 cursor-not-allowed focus:outline-none"}),q.phone&&e.jsx("div",{className:"text-red-600 text-[11px] mt-1",children:q.phone})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium",children:"WhatsApp Number"}),e.jsx("input",{type:"text",name:"whatsapp_number",value:M.whatsapp_number,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:M.email,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"State"}),e.jsx("input",{type:"text",name:"state",value:M.state,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"City"}),e.jsx("input",{type:"text",name:"city",value:M.city,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:M.location,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Lead Source"}),e.jsx("input",{type:"text",name:"lead_source",value:M.lead_source,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Lead Type"}),e.jsx("input",{type:"text",name:"lead_type",value:M.lead_type,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Status"}),e.jsx("input",{type:"text",name:"status",value:M.status,readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Created By"}),e.jsx("input",{type:"text",name:"created_by",value:(s==null?void 0:s.created_by_name)||B(M.created_by)||(M.created_by??""),readOnly:!0,className:"w-full border p-1 rounded bg-gray-100 cursor-not-allowed text-xs"})]})]})]}),e.jsxs("div",{className:o,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 md:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Property Type"}),e.jsxs("select",{name:"property_type",value:M.property_type,onChange:C,className:m,children:[e.jsx("option",{value:"",children:"Select Property Type"}),P.length>0?P.map(ge=>e.jsx("option",{value:ge,children:ge},ge)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"Residential",children:"Residential"}),e.jsx("option",{value:"Commercial",children:"Commercial"}),e.jsx("option",{value:"Plot",children:"Plot"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Property Subtype"}),e.jsxs("select",{name:"property_subtype",value:M.property_subtype,onChange:C,className:m,children:[e.jsx("option",{value:"",children:"Select Property Subtype"}),w.length>0?w.map(ge=>e.jsx("option",{value:ge,children:ge},ge)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"Apartment",children:"Apartment"}),e.jsx("option",{value:"Row House",children:"Row House"}),e.jsx("option",{value:"Office",children:"Office"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Society Name"}),e.jsxs("select",{name:"society_name",value:M.society_name,onChange:C,className:m,children:[e.jsx("option",{value:"",children:"Select Society"}),k.length>0?k.map(ge=>e.jsx("option",{value:ge,children:ge},ge)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"Society A",children:"Society A"}),e.jsx("option",{value:"Society B",children:"Society B"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-green-700",children:"Assigned Sales Executive"}),e.jsxs("div",{className:"relative",ref:x,children:[e.jsxs("button",{type:"button",onClick:()=>v(ge=>!ge),className:b,children:[e.jsx("span",{className:"truncate text-xs",children:D()}),e.jsx(ea,{className:"w-3 h-3 flex-shrink-0"})]}),d&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-full bg-white rounded-lg shadow-lg border z-[9999] text-xs",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wide px-2 py-1 border-b truncate",children:"Assign to Sales Executive"}),(()=>{const ge=I();return ge!=null&&ge.length?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>h(""),className:`w-full text-left px-2 py-2 hover:bg-gray-100 rounded text-xs truncate ${!M.assigned_executive||M.assigned_executive===""?"bg-blue-50 text-blue-600 font-medium":"text-gray-800"}`,children:"Unassigned"},"unassigned"),ge.map(ee=>e.jsxs("button",{type:"button",onClick:()=>h(String(ee.id)),className:`w-full text-left px-2 py-2 hover:bg-gray-100 rounded text-xs truncate ${String(M.assigned_executive)===String(ee.id)?"bg-blue-50 text-blue-600 font-medium":"text-gray-800"}`,children:[ee.name,ee.selfOnly&&e.jsx("span",{className:"text-[10px] text-gray-400 ml-1",children:"(Self)"})]},ee.id))]}):e.jsx("div",{className:"px-2 py-2 text-xs text-gray-500",children:"No sales executives available"})})()]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 md:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Unit Type"}),e.jsxs("select",{name:"unit_type",value:M.unit_type,onChange:C,className:m,children:[e.jsx("option",{value:"",children:"Select Unit Type"}),$.length>0?$.map(ge=>e.jsx("option",{value:ge,children:ge},ge)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"1BHK",children:"1BHK"}),e.jsx("option",{value:"2BHK",children:"2BHK"}),e.jsx("option",{value:"3BHK",children:"3BHK"}),e.jsx("option",{value:"Villa",children:"Villa"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Location Name"}),e.jsxs("select",{name:"location_name",value:M.location_name,onChange:C,className:m,children:[e.jsx("option",{value:"",children:"Select Location"}),y.length>0?y.map(ge=>e.jsx("option",{value:ge,children:ge},ge)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"Hinjewadi",children:"Hinjewadi"}),e.jsx("option",{value:"Baner",children:"Baner"}),e.jsx("option",{value:"Wakad",children:"Wakad"}),e.jsx("option",{value:"Pune",children:"Pune"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"City"}),e.jsxs("select",{name:"city_name",value:M.city_name,onChange:C,className:m,children:[e.jsx("option",{value:"",children:"Select City"}),R.length>0?R.map(ge=>e.jsx("option",{value:ge,children:ge},ge)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"Pune",children:"Pune"}),e.jsx("option",{value:"Mumbai",children:"Mumbai"}),e.jsx("option",{value:"Bengaluru",children:"Bengaluru"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Carpet Area (sqft)"}),e.jsx("input",{name:"carpet_area",value:M.carpet_area,onChange:C,placeholder:"e.g. 750",className:m})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-4 md:grid-cols-4 gap-2",children:e.jsxs("div",{className:"sm:col-span-2 md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium",children:"Sell Price (Max)"}),e.jsx(ld,{initialMax:Number(M.price_max_cr)||.01,max:10,onChange:({min:ge,max:ee,readable:de})=>{A(U=>({...U,price_min_cr:ge,price_max_cr:ee,price_max_rupees:Math.round(ee*Po),price_readable:de}))},className:"mt-1"})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-2",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium",children:"Seller Remark"}),e.jsx("textarea",{name:"seller_remark",value:M.seller_remark,onChange:C,rows:3,placeholder:"Add any seller remarks here...",className:g})]})})]}),le?e.jsxs("div",{className:"mt-2 border rounded p-2 bg-gray-50 text-[11px]",children:[e.jsx("div",{className:"font-semibold mb-1 text-gray-700",children:"Submitted Payload (debug)"}),e.jsx("pre",{className:"whitespace-pre-wrap break-all",children:JSON.stringify(le,null,2)})]}):e.jsxs("div",{className:"mt-2 border rounded p-2 bg-gray-50 text-[11px] text-gray-500",children:["Click ",e.jsx("b",{children:"Transfer to Seller"})," to see the exact payload here."]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-1",children:[e.jsx("button",{type:"button",onClick:()=>t==null?void 0:t(),disabled:Y,className:"px-3 py-1 bg-gray-300 rounded text-xs disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:Y,className:"px-3 py-1 bg-blue-600 text-white rounded text-xs disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:Y?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Transfer to Seller"})]})]})})},G0=s=>s&&s.length?s[0]:null,Zd={blue:{container:"bg-blue-50 border-blue-200 hover:bg-blue-50",icon:"text-blue-600",leftBar:"border-blue-400",badge:"bg-blue-100 text-blue-800 border-blue-200"},green:{container:"bg-green-50 border-green-200 hover:bg-green-50",icon:"text-green-600",leftBar:"border-green-400",badge:"bg-green-100 text-green-800 border-green-200"},indigo:{container:"bg-indigo-50 border-indigo-200 hover:bg-indigo-50",icon:"text-indigo-600",leftBar:"border-indigo-400",badge:"bg-indigo-100 text-indigo-800 border-indigo-200"},orange:{container:"bg-orange-50 border-orange-200 hover:bg-orange-50",icon:"text-orange-600",leftBar:"border-orange-400",badge:"bg-orange-100 text-orange-800 border-orange-200"},purple:{container:"bg-purple-50 border-purple-200 hover:bg-purple-50",icon:"text-purple-600",leftBar:"border-purple-400",badge:"bg-purple-100 text-purple-800 border-purple-200"},gray:{container:"bg-gray-50 border-gray-200 hover:bg-gray-50",icon:"text-gray-600",leftBar:"border-gray-400",badge:"bg-gray-100 text-gray-800 border-gray-200"}},Hn=s=>(s??"").toString().trim().toLowerCase().replace(/[\s-_/]+/g,""),K0=(s,a)=>{const t=m=>(m??"").toString().trim().toLowerCase().replace(/[\s-_/]+/g,""),r=t(s==null?void 0:s.role),i=t(s==null?void 0:s.department),n=m=>({id:m.id??m.user_id??m._id,name:`${m.first_name||""} ${m.last_name||""}`.trim()||m.name||"Executive",department:m.department,role:m.role,selfOnly:!1,salutation:m.salutation||""});return r==="executive"&&(i==="presales"||i==="presale")?[{...n(s),selfOnly:!0,name:`${s!=null&&s.salutation?s.salutation+" ":""}${(s==null?void 0:s.first_name)||(s==null?void 0:s.name)||"You"}${s!=null&&s.last_name?" "+s.last_name:""} (Self)`}]:r==="manager"&&(i==="presales"||i==="presale")||r==="admin"?a.map(n):[{...n(s),selfOnly:!0,name:`${s!=null&&s.salutation?s.salutation+" ":""}${(s==null?void 0:s.first_name)||(s==null?void 0:s.name)||"You"}${s!=null&&s.last_name?" "+s.last_name:""} (Self)`}]},J0=(s,a)=>{if(!a)return s;const t=Hn(a.role),r=a.id||a.user_id;return t==="admin"||t==="manager"?s:t==="executive"?s.filter(i=>i.assigned_executive&&String(i.assigned_executive)===String(r)):s},Q0=async s=>{var r;const a=Hn(s==null?void 0:s.role),t=Hn(s==null?void 0:s.department);if(a==="admin"||a==="manager"||a==="manager"&&(t==="presales"||t==="presale"))try{const i=await((r=Os.getAllUsers)==null?void 0:r.call(Os)),n=(i==null?void 0:i.data)??(i==null?void 0:i.items)??i??[];return Array.isArray(n)?n:[]}catch(i){return console.warn("User fetch failed (may be permission issue):",i),[]}return[]},Z0=()=>{var Ve,Je;const s=Ca(),{id:a}=on(),{user:t}=Hs(),r=Ws(t,"lead.read"),i=Ws(t,"lead.update"),n=Ws(t,"lead.delete"),o=Ws(t,"lead.assign"),m=Ws(t,"followup.read"),g=Ws(t,"followup.create"),b=Ws(t,"followup.update"),d=Ws(t,"followup.delete"),[v,x]=l.useState(!1),[u,c]=l.useState(null),[f,p]=l.useState(!0),[N,P]=l.useState(null),[w,$]=l.useState([]),[y,k]=l.useState([]),[R,F]=l.useState(0),[T,j]=l.useState(!1),[E,V]=l.useState(!1),W=l.useRef(null),[B,M]=l.useState([]),[A,L]=l.useState(!1),[D,I]=l.useState(null),[H,h]=l.useState({salutation:[],leadType:[],leadSource:[],leadStatus:[],states:[],cities:[],locations:[],agents:[]}),[Y,K]=l.useState([]),[q,ne]=l.useState(!0),[le,S]=l.useState(!1),[C,J]=l.useState(!1),[ue,Q]=l.useState(!1),[he,se]=l.useState(null);l.useEffect(()=>{r||p(!1)},[r]),l.useEffect(()=>{let Ue=!0;return(async()=>{try{ne(!0);const rs=await Q0(t);if(!Ue)return;const ms=rs.filter(cs=>{const gs=Hn(cs==null?void 0:cs.role),Ne=Hn(cs==null?void 0:cs.department);return gs==="executive"&&(Ne==="presales"||Ne==="presale")}).map(cs=>({id:String(cs.id??cs.user_id??cs._id??""),name:`${cs.first_name||""} ${cs.last_name||""}`.trim()||cs.name||"Executive",department:cs.department,role:cs.role,salutation:cs.salutation||""}));K(ms)}catch(rs){console.error("Failed to load presales executives:",rs),K([])}finally{ne(!1)}})(),()=>{Ue=!1}},[t]),l.useEffect(()=>{const Ue=J0(w,t);if(k(Ue),u&&Ue.length>0){const Oe=Ue.findIndex(rs=>String(rs.id)===String(u.id));F(Oe>=0?Oe:0)}},[w,t,u]);const ge=l.useMemo(()=>K0(t,Y),[t,Y]),ee=()=>{if(!u)return"Unassigned";if(u.assigned_executive_name&&u.assigned_executive_name!=="Unassigned")return u.assigned_executive_name;if(u.assigned_executive&&Y.length>0){const Oe=Y.find(rs=>String(rs.id)===String(u.assigned_executive));if(Oe)return Oe.name}const Ue=(t==null?void 0:t.id)??(t==null?void 0:t.user_id);return u.assigned_executive&&String(u.assigned_executive)===String(Ue)?`${t!=null&&t.salutation?t.salutation+" ":""}${(t==null?void 0:t.first_name)||(t==null?void 0:t.name)||"You"}${t!=null&&t.last_name?" "+t.last_name:""} (Self)`:"Unassigned"};l.useEffect(()=>{const Ue=Oe=>{W.current&&!W.current.contains(Oe.target)&&j(!1)};return document.addEventListener("mousedown",Ue),()=>document.removeEventListener("mousedown",Ue)},[]);const de=async Ue=>{var rs;if(!m)return M([]),I("You do not have permission to view follow-ups"),L(!1),[];const Oe=a;if(!Oe)return M([]),I(null),L(!1),[];try{L(!0),I(null);const ms=await ni.getFollowupsByLeadId(Oe);let cs=[];return Array.isArray(ms==null?void 0:ms.data)?cs=ms.data:Array.isArray(ms)?cs=ms:Array.isArray(ms==null?void 0:ms.Payload)?cs=ms.Payload:Array.isArray(ms==null?void 0:ms.result)&&(cs=ms.result),cs=(cs||[]).map(gs=>({id:gs.id||gs._id||gs.followup_id||"",leadId:gs.leadId||gs.lead_id||Oe,type:gs.type||gs.followupType||"general",stage:gs.stage||gs.leadStage||"",status:gs.status||gs.leadStatus||"",remark:gs.remark||"",customRemark:gs.customRemark||gs.custom_remark||"",nextAction:gs.nextAction||gs.next_action||"",scheduledDate:gs.scheduledDate||gs.scheduled_date||gs.schedule||gs.createdAt||gs.created_at||null,createdAt:gs.createdAt||gs.created_at||null,priority:gs.priority||"Medium",createdByFirstName:gs.createdByFirstName||gs.created_by_first_name||gs.created_first_name||"",createdByLastName:gs.createdByLastName||gs.created_by_last_name||gs.created_last_name||"",...gs})),cs.sort((gs,Ne)=>{const Ze=new Date(gs.scheduledDate||gs.createdAt||0).getTime(),ls=new Date(Ne.scheduledDate||Ne.createdAt||0).getTime();return ls!==Ze?ls-Ze:gs.id&&Ne.id?gs.id>Ne.id?-1:1:0}),M(cs),cs}catch(ms){console.error("Error fetching followups:",ms);const cs=((rs=ms==null?void 0:ms.response)==null?void 0:rs.status)||(ms==null?void 0:ms.status);return cs===404||cs===204?(M([]),I(null),[]):(Z.error("Failed to fetch follow-ups"),I("Failed to fetch follow-ups"),M([]),[])}finally{L(!1)}};l.useEffect(()=>{a&&de()},[a,m]),l.useEffect(()=>{const Ue=async()=>{try{if(p(!0),!r){P("You do not have permission to view this lead."),p(!1);return}if(a){const[rs,ms]=await Promise.all([Et.getLead(a),Et.getLeads()]);if(ms!=null&&ms.success&&ms.data){const Se=Array.isArray(ms.data)?ms.data.map(Ge=>({...Ge,id:String(Ge.id||Ge._id||"")})):[];$(Se)}const cs=(rs==null?void 0:rs.data)??rs;if(!cs){P("No lead data returned");return}const gs=Se=>{if(!Se)return null;const Ge=Y.find(z=>String(z.id)===String(Se));return(Ge==null?void 0:Ge.name)??null},Ne=cs.assigned_executive_name||gs(cs.assigned_executive)||"Unassigned",Ze=cs.created_by_name||`${cs.created_first_name||cs.createdByFirstName||""} ${cs.created_last_name||cs.createdByLastName||""}`.trim()||"System",ls=cs.updated_by_name||`${cs.updated_first_name||cs.updatedByFirstName||""} ${cs.updated_last_name||cs.updatedByLastName||""}`.trim()||"System",$s=cs.last_contacted_by_name||cs.updated_by_name||null,Gs={id:String(cs.id||cs._id||""),salutation:cs.salutation||"",name:cs.name||"",phone:cs.phone||"",email:cs.email||"",lead_type:cs.lead_type||cs.leadType||"",lead_source:cs.lead_source||cs.leadSource||"",whatsapp_number:cs.whatsapp_number||cs.whatsapp||"",state:cs.state||"",city:cs.city||"",location:cs.location||"",status:cs.status||"New",assigned_executive:cs.assigned_executive?String(cs.assigned_executive):"",assigned_executive_name:Ne||"Unassigned",created_at:cs.created_at||new Date().toISOString(),updated_at:cs.updated_at||new Date().toISOString(),priority:cs.priority||" -",stage:cs.stage||"-",created_by:cs.created_by||cs.createdBy||"System",last_contact:cs.last_contact||cs.lastContact||"",last_contacted_by:cs.last_contacted_by||cs.last_contact_by||cs.lastContactedBy||"",last_contacted_by_name:$s||void 0,created_by_name:Ze,updated_by_name:ls};c(Gs)}}catch(rs){console.error("Error fetching lead details:",rs),Z.error("Error fetching lead details"),P("Failed to fetch lead details")}finally{p(!1)}};(async()=>{try{P(null);const[rs,ms]=await Promise.all([Nt.getAllMasterTypes("lead"),Nt.getAllMasterTypes("common")]),cs=[...rs,...ms],gs=await Promise.all(cs.map(async ls=>{try{return await Nt.getMasterValues(ls.id)}catch{return[]}})),Ne={};cs.forEach((ls,$s)=>{const Gs=gs[$s]||[],Se=(ls.name||"").toLowerCase().trim();Ne[Se]=Gs.map(Ge=>({value:Ge.value,label:Ge.value||Ge.name||"Unknown",role:Ge.role||"Agent"}))});const Ze=Ne.agent||Ne.agents||[];h(ls=>({...ls,salutation:Ne.salutation||Ne.salutations||[],leadType:Ne["lead type"]||Ne.leadtype||Ne.lead_type||[],leadSource:Ne["lead source"]||Ne.leadsource||Ne.lead_source||[],leadStatus:Ne["lead status"]||Ne.leadstatus||Ne.lead_status||Ne.status||[],states:Ne.state||Ne.states||[],cities:Ne.city||Ne.cities||[],locations:Ne.location||Ne.locations||[],agents:Ze.map($s=>({value:$s.value,label:$s.label,role:$s.role||"Agent"}))}))}catch(rs){console.error("Failed to load master data:",rs),P("Failed to load dropdown options")}})(),Ue()},[a,q,r]),l.useEffect(()=>{if(u!=null&&u.assigned_executive&&Y.length>0){const Ue=Y.find(Oe=>String(Oe.id)===String(u.assigned_executive));Ue&&c(Oe=>Oe&&{...Oe,assigned_executive_name:Ue.name})}},[Y,u==null?void 0:u.assigned_executive]);const U=async()=>{if(a){if(!n){Z.error("You do not have permission to delete leads");return}if(confirm("Are you sure you want to delete this lead?"))try{(await Et.deleteLead(a)).success?(Z.success("Lead deleted âœ…"),s("/dashboard/leads")):Z.error("Failed to delete lead âŒ")}catch(Ue){console.error("Error deleting lead:",Ue),Z.error("Error deleting lead")}}},X=async(Ue,Oe)=>{if(u){if(!o){Z.error("You do not have permission to assign leads");return}try{const rs=u.assigned_executive||"";if(c({...u,assigned_executive:Ue,assigned_executive_name:Oe}),S(!1),await Et.assignToExecutive(u.id,{assigned_executive:Ue}),Ue&&Ue!==rs)try{await wa.createNotification({leadId:String(u.id),userId:String(Ue),message:`Lead assigned to ${Oe}`,type:"lead_assign",link:`/dashboard/leads/${u.id}`})}catch(ms){console.error("Notification error:",ms),Z.warn("Lead assigned but notification failed")}Z.success(`Lead assigned to ${Oe}`)}catch(rs){console.error("Error assigning executive:",rs),c(ms=>ms&&{...ms,assigned_executive:u.assigned_executive,assigned_executive_name:u.assigned_executive_name}),Z.error("Failed to assign. Please try again.")}}},re=async Ue=>{if(Ue){if(!i){Z.error("You do not have permission to update leads");return}try{const Oe=(u==null?void 0:u.assigned_executive)||"",rs=Ue.assigned_executive||"",ms=await Et.updateLead(Ue.id,Ue),cs=(ms==null?void 0:ms.data)||ms;if(c(gs=>({...gs||{},...cs})),$(gs=>gs.map(Ne=>String(Ne.id)===String(cs.id)?{...Ne,...cs}:Ne)),rs&&rs!==Oe){const gs=Y.find(Ze=>String(Ze.id)===String(rs)),Ne=(gs==null?void 0:gs.name)||cs.assigned_executive_name||"Executive";try{await wa.createNotification({leadId:String(Ue.id),userId:String(rs),message:`Lead updated and assigned to ${Ne}`,type:"lead_update",link:`/dashboard/leads/${Ue.id}`})}catch(Ze){console.error("Notification error:",Ze)}}V(!1),Z.success("Lead details updated successfully!")}catch(Oe){console.error("Error saving lead:",Oe),Z.error("Failed to save lead. Please try again.")}}},fe=async Ue=>{var cs;if(!(u!=null&&u.id)){Z.error("Lead not loaded.");return}if(he&&!b){Z.error("You do not have permission to update follow-ups");return}if(!he&&!g){Z.error("You do not have permission to create follow-ups");return}let Oe=null;const rs=Ue.scheduleDate?`${Ue.scheduleDate}T${Ue.scheduleTime||"00:00"}:00`:null,ms={leadId:Ue.lead_id??u.id,type:Ue.followupType,stage:Ue.leadStage,status:Ue.leadStatus,remark:Ue.remark,customRemark:Ue.customRemark,nextAction:Ue.nextAction,scheduledDate:rs,priority:Ue.priority,updated_by:(t==null?void 0:t.id)??(t==null?void 0:t.user_id)};try{if(he)await ni.updateFollowup(String(he.id),ms),Oe={...he,...ms,updatedAt:new Date().toISOString()},se(null),M(gs=>gs.map(Ne=>Ne.id===he.id?Oe:Ne)),Z.success("Follow-up updated successfully!");else{const gs=await ni.createFollowup(ms);Oe={id:((cs=gs==null?void 0:gs.data)==null?void 0:cs.id)||(gs==null?void 0:gs.id)||`temp-${Date.now()}`,leadId:ms.leadId,type:ms.type,stage:ms.stage,status:ms.status,remark:ms.remark,customRemark:ms.customRemark,nextAction:ms.nextAction,scheduledDate:rs,createdAt:new Date().toISOString(),priority:ms.priority,createdByFirstName:(t==null?void 0:t.first_name)||"",createdByLastName:(t==null?void 0:t.last_name)||""},M(Ze=>[Oe,...Ze]),Z.success("Follow-up saved successfully!")}}catch(gs){console.error("Error saving followup:",gs),Z.error(`Failed to ${he?"update":"save"} follow-up. Please try again.`);return}try{await Et.updateLead(u.id,{stage:Ue.leadStage,status:Ue.leadStatus,priority:Ue.priority,updated_by:(t==null?void 0:t.id)??(t==null?void 0:t.user_id)}),c(gs=>gs&&{...gs,stage:Ue.leadStage||gs.stage,status:Ue.leadStatus||gs.status,priority:Ue.priority})}catch(gs){console.error("Error updating lead:",gs)}if(u.assigned_executive&&String(u.assigned_executive).trim()!=="")try{await wa.createNotification({leadId:String(u.id),userId:String(u.assigned_executive),message:`New follow-up added for lead "${u.name}" by ${(t==null?void 0:t.first_name)||"User"}`,type:"followup_add",link:`/dashboard/leads/${u.id}`})}catch(gs){console.error("Notification error:",gs)}x(!1);try{await de()}catch{}},G=Ue=>{if(!b){Z.error("You do not have permission to edit follow-ups");return}se(Ue),x(!0)},me=async Ue=>{if(!d){Z.error("You do not have permission to delete follow-ups");return}if(!confirm("Are you sure you want to delete this follow-up?"))return;const Oe=[...B];M(rs=>rs.filter(ms=>ms.id!==Ue));try{await ni.deleteFollowup(String(Ue)),Z.success("Follow-up deleted successfully")}catch(rs){console.error("Error deleting followup:",rs),M(Oe),Z.error("Failed to delete follow-up")}},oe=()=>{if(y.length===0||R<=0)return;const Ue=R-1,Oe=y[Ue];F(Ue),s(`/dashboard/leads/${Oe.id}`)},Fe=()=>{if(y.length===0||R>=y.length-1)return;const Ue=R+1,Oe=y[Ue];F(Ue),s(`/dashboard/leads/${Oe.id}`)},$e=Ue=>{if(!Ue)return{date:"-",time:"-"};try{const Oe=new Date(Ue);return{date:Oe.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),time:Oe.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0})}}catch{return{date:"-",time:"-"}}},Le=(Ue,Oe)=>{const rs=((Ue==null?void 0:Ue.stage)||"").trim().toLowerCase(),ms=((Ue==null?void 0:Ue.status)||"").trim().toLowerCase(),cs=((Oe==null?void 0:Oe.stage)||"").trim().toLowerCase(),gs=((Oe==null?void 0:Oe.status)||"").trim().toLowerCase();return(rs==="contacted"||rs==="connected")&&ms==="qualified"||(cs==="contacted"||cs==="connected")&&gs==="qualified"},je=Ue=>{switch(Ue==null?void 0:Ue.toLowerCase()){case"contacted":return"bg-blue-100 text-blue-800 border-blue-200";case"new":return"bg-purple-100 text-purple-800 border-purple-200";case"qualified":return"bg-teal-100 text-teal-800 border-teal-200";case"unqualified":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},_e=Ue=>{switch(Ue==null?void 0:Ue.toLowerCase()){case"buyer-self":return"bg-green-100 text-green-800 border-green-200";case"buyer inverstor":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"seller self":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"seller inverstor":return"bg-red-100 text-red-800 border-red-200";case"seller builder":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},ve=Ue=>{switch(Ue==null?void 0:Ue.toLowerCase()){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Pe=Ue=>{switch(Ue==null?void 0:Ue.toLowerCase()){case"attempting contact":return"bg-blue-100 text-blue-800 border-blue-200";case"contacted":return"bg-purple-100 text-purple-800 border-purple-200";case"converted to opportunity":return"bg-green-100 text-green-800 border-green-200";case"disqualified":return"bg-red-100 text-red-800 border-red-200";case"new":return"bg-gray-100 text-gray-800 border-gray-200";case"nurturing":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"qualified":return"bg-teal-100 text-teal-800 border-teal-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},We=l.useMemo(()=>G0(B),[B]),{date:pe,time:O}=$e((u==null?void 0:u.created_at)||null),{date:Ie,time:ze}=$e((u==null?void 0:u.updated_at)||null),{date:xe,time:Ee}=$e((u==null?void 0:u.last_contact)||""),Ke=()=>s("/dashboard/leads"),Xe=()=>{if(!i){Z.error("You do not have permission to edit leads");return}V(!0)},ye=()=>(u==null?void 0:u.phone)&&window.open(`tel:${u.phone}`,"_self"),Ce=()=>(u==null?void 0:u.whatsapp_number)&&window.open(`https://wa.me/${u.whatsapp_number.replace(/\D/g,"")}`,"_blank"),_=()=>(u==null?void 0:u.email)&&window.open(`mailto:${u.email}`,"_self"),ae=()=>u&&window.open(`https://calendar.google.com/calendar/render?action=TEMPLATE&text=Meeting+with+${encodeURIComponent(u.name||"")}&details=${encodeURIComponent(`Discuss lead ${u.id}`)}&location=Online&dates=20240101T100000Z/20240101T110000Z`,"_blank"),ke=Ue=>{const Oe=Ur.find(rs=>rs.value===Ue);return Oe?Oe.Icon:Bt},Me=Ue=>{var rs;const Oe=((rs=Ur.find(ms=>ms.value===Ue))==null?void 0:rs.color)||"gray";return Zd[Oe]||Zd.gray},Ye=Ue=>{if(!Ue)return"-";const Oe=new Date(Ue),rs=Oe.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),ms=Oe.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0});return`${rs} â€¢ ${ms}`},ie=()=>{var cs,gs,Ne,Ze;const Ue=((cs=u==null?void 0:u.status)==null?void 0:cs.toLowerCase())||"",Oe=((gs=u==null?void 0:u.stage)==null?void 0:gs.toLowerCase())||"",rs=((Ne=u==null?void 0:u.lead_type)==null?void 0:Ne.toLowerCase())||"",ms=((Ze=u==null?void 0:u.priority)==null?void 0:Ze.toLowerCase())||"";return ms==="high"?"from-red-600 to-red-700":ms==="low"?"from-green-600 to-green-700":Ue==="qualified"||Oe==="qualified"?"from-teal-600 to-teal-700":Ue==="contacted"||Oe==="contacted"?"from-purple-600 to-purple-700":Ue==="unqualified"||Oe==="disqualified"?"from-rose-600 to-rose-700":rs==="seller builder"?"from-orange-600 to-orange-700":rs==="buyer-self"?"from-green-600 to-green-700":rs==="buyer inverstor"?"from-indigo-600 to-indigo-700":"from-blue-600 to-indigo-700"};if(!r)return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("div",{className:"text-gray-600 text-sm",children:"You do not have permission to view leads."})]})});if(N)return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:N}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})});if(f||!u)return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{children:"Loading lead details..."})]})});const we="lead",Be=a||"";return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-2 sm:p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 bg-white rounded-xl lg:rounded-2xl shadow-lg lg:shadow-xl border border-gray-100 overflow-visible p-2",children:[e.jsxs("div",{className:"mb-4 flex flex-col space-y-3 lg:flex-row lg:items-center lg:justify-between lg:space-y-0",children:[e.jsxs("button",{onClick:Ke,className:"flex items-center gap-1 px-2 py-1 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors w-fit text-xs",children:[e.jsx(ah,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Back to Leads"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("button",{onClick:Xe,className:`flex items-center justify-center gap-1 px-2 py-1 text-xs border ${i?"border-gray-300 hover:bg-gray-50 bg-white":"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed"} rounded-md transition-colors`,disabled:!i,children:[e.jsx(rh,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),e.jsxs("button",{onClick:U,className:`flex items-center justify-center gap-1 px-2 py-1 text-xs border rounded-md transition-colors ${n?"border-red-300 text-red-600 hover:bg-red-50 bg-white":"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed"}`,disabled:!n,children:[e.jsx(lh,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]}),e.jsxs("button",{onClick:oe,disabled:R<=0,className:`flex items-center justify-center gap-1 px-2 py-1 text-xs border border-gray-300 rounded-md transition-colors bg-white ${R<=0?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,title:`Previous lead (${R>0?(Ve=y[R-1])==null?void 0:Ve.name:"No more leads"})`,children:[e.jsx(nh,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Previous"})]}),e.jsxs("button",{onClick:Fe,disabled:R>=y.length-1,className:`flex items-center justify-center gap-1 px-2 py-1 text-xs border border-gray-300 rounded-md transition-colors bg-white ${R>=y.length-1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,title:`Next lead (${R<y.length-1?(Je=y[R+1])==null?void 0:Je.name:"No more leads"})`,children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx(ih,{className:"w-4 h-4"})]})]})]}),e.jsx("div",{className:`bg-gradient-to-r ${ie()} px-3 py-3 sm:px-4 sm:py-4 text-white rounded-lg`,children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[e.jsx("div",{className:"bg-white bg-opacity-20 p-2 rounded-full shadow-md",children:e.jsx(Ms,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h2",{className:"text-base sm:text-lg font-bold truncate",children:[u.salutation," ",u.name]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-xs sm:text-sm text-white text-opacity-80 truncate",children:["Lead ID: ",String(u.id).slice(0,4)]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold border w-fit ${_e(u.lead_type||"")}`,children:u.lead_type}),e.jsxs("span",{className:"text-xs text-white text-opacity-80",children:["(",R+1," of ",y.length,")"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[e.jsxs("button",{onClick:()=>{if(!g){Z.error("You do not have permission to create follow-ups");return}se(null),x(!0)},className:`flex items-center space-x-1 bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-2.5 py-1.5 rounded-md shadow text-xs ${g?"":"opacity-60 cursor-not-allowed"}`,title:"Add Follow-up",children:[e.jsx("div",{className:"p-1 rounded-md bg-[#ea8634]",children:e.jsx(oh,{className:"w-3.5 h-3.5 text-white"})}),e.jsx("span",{className:"hidden sm:inline",children:"Follow Up"})]}),e.jsx("div",{className:"relative",children:le&&o&&e.jsx("div",{className:"absolute right-0 mt-2 w-44 bg-white rounded-lg shadow-lg border z-10 text-xs",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wide px-2 py-1 border-b truncate",children:"Assign to Presales Executive"}),ge.length===0?e.jsx("div",{className:"px-2 py-2 text-xs text-gray-500",children:"No presales executives available"}):ge.map(Ue=>e.jsx("button",{onClick:()=>X(String(Ue.id),Ue.name),className:`w-full text-left px-2 py-2 hover:bg-gray-100 rounded text-xs truncate ${String(u.assigned_executive)===String(Ue.id)?"bg-blue-50 text-blue-600 font-medium":"text-gray-800"}`,children:Ue.name},Ue.id))]})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ye,className:"bg-green-600 hover:bg-green-700 text-white p-2 rounded-md transition shadow",title:"Call",children:e.jsx(Cs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:Ce,className:"bg-green-500 hover:bg-green-600 text-white p-2 rounded-md transition shadow",title:"WhatsApp",children:e.jsx(Ia,{className:"w-4 h-4"})}),e.jsx("button",{onClick:_,className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-md transition shadow",title:"Email",children:e.jsx(Ds,{className:"w-4 h-4"})}),e.jsx("button",{onClick:ae,className:"bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-md transition shadow",title:"Schedule Meeting",children:e.jsx(Ts,{className:"w-4 h-4"})})]})]})]})}),e.jsxs("div",{className:"p-4 sm:p-6 pt-0 sm:pt-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsxs("div",{className:"w-full md:w-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Contact Details"}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-4 w-full md:w-fit",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Cs,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Phone"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm break-all",children:u.phone})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ds,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm break-all",children:u.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ia,{className:"w-4 h-4"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"WhatsApp"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm break-all",children:u.whatsapp_number})]})]})]})]}),e.jsxs("div",{className:"w-full md:w-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Location Details"}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-4 w-full md:w-fit",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Qs,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"State"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:u.state||"-"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Qs,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"City"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:u.city||"-"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Qs,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Location"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:u.location||"-"})]})]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Lead Classification"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Source:"}),e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:u.lead_source})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Priority:"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${ve(u.priority||"")}`,children:u.priority||"-"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Stage:"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${Pe(u.stage||"")}`,children:u.stage||"-"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Status:"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${je(u.status)}`,children:u.status})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 sm:flex sm:flex-wrap",children:[e.jsxs("div",{className:"flex items-start space-x-1 p-1 bg-gray-50 rounded-md",children:[e.jsx(Ls,{className:"w-3 h-3 text-gray-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wide",children:"Created"}),e.jsx("p",{className:"text-[11px] text-gray-700",children:pe}),e.jsx("p",{className:"text-[11px] text-gray-700",children:O})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wide",children:"Updated"}),e.jsx("p",{className:"text-[11px] text-gray-700",children:Ie}),e.jsx("p",{className:"text-[11px] text-gray-700",children:ze})]})]})]}),e.jsxs("div",{className:"p-1 bg-gray-50 rounded-md",children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wide",children:"Created By"}),e.jsx("p",{className:"text-[11px] text-gray-700",children:u.created_by_name||"System"}),e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wide mt-1",children:"Updated By"}),e.jsx("p",{className:"text-[11px] text-gray-700",children:u.updated_by_name||"System"})]}),e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx(Ls,{className:"w-4 h-4 text-gray-600 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Last Contact"}),e.jsxs("p",{className:"text-xs font-medium text-gray-800",children:[xe," ",Ee]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["By: ",u.last_contacted_by_name||u.last_contacted_by||u.updated_by_name||u.created_by_name||"-"]})]})]}),e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-green-50 rounded-lg border border-green-200",children:[e.jsx(Ns,{className:"w-4 h-4 text-green-600 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 uppercase tracking-wide",children:"Assigned Executive"}),e.jsx("p",{className:"font-medium text-gray-800 text-xs",children:ee()})]})]}),e.jsxs("div",{className:"relative inline-block",ref:W,children:[Le(u,We)&&e.jsxs("button",{onClick:()=>j(!T),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-md shadow hover:bg-blue-700",children:[e.jsx(ch,{className:"w-4 h-4"}),"Transfer Lead"]}),T&&e.jsxs("div",{className:"absolute top-0 left-full ml-2 w-40 rounded z-[9999]",children:[e.jsx("button",{className:"px-2 py-1 text-white text-xs rounded bg-green-500 hover:bg-green-600",onClick:()=>{j(!1),J(!0)},children:"Transfer to Buyer"}),e.jsx("button",{className:"px-2 py-1 text-white text-xs rounded bg-red-500 hover:bg-red-600",onClick:()=>{j(!1),Q(!0)},children:"Transfer to Seller"})]})]})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl lg:rounded-2xl shadow-lg lg:shadow-xl border border-gray-100 p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Follow-ups TimeLine"}),e.jsx("div",{className:"flex gap-2"})]}),A&&e.jsx("div",{className:"text-xs text-gray-500",children:"Loading follow-upsâ€¦"}),!A&&!a&&e.jsx("div",{className:"text-xs text-gray-500",children:"No follow-up data â€” invalid lead."}),!A&&a&&D&&e.jsx("div",{className:"text-xs text-red-600",children:D}),!A&&a&&!D&&B.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 py-8 px-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[e.jsx(Bt,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm font-medium",children:"No follow-ups yet"})]}),!A&&!D&&B.length>0&&e.jsx("div",{className:"space-y-3 overflow-y-auto",style:{maxHeight:"calc(100vh - 250px)"},children:B.map(Ue=>{const Oe=ke(Ue.type),rs=Ye(Ue.scheduledDate||Ue.createdAt||""),ms=Me(Ue.type);return e.jsx("div",{className:`border rounded-lg p-3 transition ${ms.container} border-l-4 ${ms.leftBar}`,children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Oe,{className:`h-5 w-5 ${ms.icon}`})}),e.jsxs("div",{className:"flex-1 space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-semibold border ${ms.badge}`,children:Ue.type}),e.jsxs("div",{className:"flex items-center gap-1",children:[b&&e.jsx("button",{onClick:()=>G(Ue),className:"p-1 rounded hover:bg-gray-200 transition",title:"Edit",children:e.jsx(pu,{className:"h-3.5 w-3.5 text-gray-600"})}),d&&e.jsx("button",{onClick:()=>me(Ue.id),className:"p-1 rounded hover:bg-red-100 transition",title:"Delete",children:e.jsx(Es,{className:"h-3.5 w-3.5 text-red-600"})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Lead Priority:"}),(Ue.priority||u.priority)&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-medium border ${ve(Ue.priority||u.priority||"")}`,children:Ue.priority||u.priority}),e.jsx("span",{className:"font-medium text-gray-600",children:"Lead Stage:"}),Ue.stage&&e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-medium bg-white/70 text-gray-800 border border-gray-200",children:Ue.stage}),e.jsx("span",{className:"font-medium text-gray-600",children:"Lead Status:"}),Ue.status&&e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-medium bg-white/70 text-gray-800 border border-gray-200",children:Ue.status})]}),e.jsxs("div",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Remark:"})," ",Ue.customRemark||Ue.remark||"â€”"]}),Ue.nextAction&&e.jsxs("div",{className:"text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Next Action:"})," ",Ue.nextAction]}),e.jsx("div",{className:"mt-2 flex justify-end text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{children:rs}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ms,{className:"h-3 w-3 text-gray-400"}),`${Ue.createdByFirstName||""} ${Ue.createdByLastName||""}`.trim()||"System"]})]})})]})]})},Ue.id)})})]})]}),e.jsx(O0,{isOpen:v,onClose:()=>{x(!1),se(null)},onSave:fe,tabId:we,leadId:Be,initialForm:he?{id:he.id,followupType:he.type,leadStage:he.stage||"",leadStatus:he.status||"",remark:he.remark||"",customRemark:he.customRemark||"",nextAction:he.nextAction||"",scheduleDate:he.scheduledDate?new Date(he.scheduledDate).toISOString().slice(0,10):"",scheduleTime:he.scheduledDate?new Date(he.scheduledDate).toTimeString().slice(0,5):"",priority:he.priority||u.priority||"Medium",lead_id:Be}:{priority:u.priority||"Medium"}}),C&&u&&e.jsx(V0,{lead:u,followups:B,onClose:()=>J(!1)}),ue&&u&&e.jsx(Y0,{lead:u,followups:B,onClose:()=>Q(!1)}),e.jsx(jc,{isOpen:E,onClose:()=>V(!1),onSave:re,lead:u||void 0})]})},X0=()=>{var W,B,M,A;const a=on().id,t=Ca(),{user:r}=Hs(),[i,n]=l.useState(null),[o,m]=l.useState([]),[g,b]=l.useState(null),[d,v]=l.useState(!0),[x,u]=l.useState(0),[c,f]=l.useState(!1),[p,N]=l.useState("overview");l.useEffect(()=>{if(!a){v(!1);return}P(),w(),$()},[a]);const P=async()=>{if(a)try{const L=await As.getProperty(a);L!=null&&L.success&&L.data?n(L.data):(wt.error("Property not found"),n(null))}catch(L){console.error("Error fetching property details:",L),wt.error("Failed to load property details"),n(null)}finally{v(!1)}},w=async()=>{if(a){if(typeof(Et==null?void 0:Et.getLeads)!="function"){console.warn("leadsAPI.getLeads not available");return}try{const L=await Et.getLeads({property_id:a});L!=null&&L.success&&Array.isArray(L.data)&&m(L.data)}catch(L){console.error("Error fetching property inquiries:",L)}}},$=async()=>{if(a)try{const L=await As.getPropertyAnalytics(a);L!=null&&L.success&&L.data&&b(L.data)}catch(L){console.error("Error fetching property analytics:",L)}},y=async L=>{if(a)try{await As.updateProperty(a,{status:L}),n(D=>D?{...D,status:L}:null),wt.success("Property status updated successfully")}catch(D){console.error("Error updating property status:",D),wt.error("Failed to update property status")}},k=async()=>{if(a&&window.confirm("Are you sure you want to delete this property? This action cannot be undone."))try{await As.deleteProperty(a),wt.success("Property deleted successfully"),t("/dashboard/properties")}catch(L){console.error("Error deleting property:",L),wt.error("Failed to delete property")}},R=L=>{switch(L==null?void 0:L.toLowerCase()){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"sold":return"bg-blue-100 text-blue-800";case"rented":return"bg-purple-100 text-purple-800";case"off_market":case"off market":return"bg-gray-100 text-gray-800";case"draft":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},F=(L=0)=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(L),T=(L=0)=>new Intl.NumberFormat("en-US").format(L),j=()=>{i!=null&&i.images&&i.images.length>0&&u(L=>(L+1)%i.images.length)},E=()=>{i!=null&&i.images&&i.images.length>0&&u(L=>(L-1+i.images.length)%i.images.length)};if(d)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})});if(!i)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Property Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The property you're looking for doesn't exist or has been deleted."}),e.jsx(Bs,{to:"/dashboard/properties",children:e.jsx(ss,{children:"Back to Properties"})})]})});const V=i.images??[];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(ss,{variant:"outline",onClick:()=>t("/dashboard/properties"),children:[e.jsx(ga,{className:"h-4 w-4 mr-2"}),"Back to Properties"]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:i.title}),i.is_featured&&e.jsx("div",{className:"bg-yellow-500 text-white p-1 rounded-full",children:e.jsx(Xs,{className:"h-5 w-5"})})]}),e.jsxs("p",{className:"text-gray-600 mt-1 flex items-center",children:[e.jsx(Qs,{className:"h-4 w-4 mr-1"}),i.address]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(ss,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(ja,{className:"h-4 w-4"}),e.jsx("span",{children:"Share"})]}),e.jsx(Bs,{to:`/dashboard/properties/${a}/edit`,children:e.jsxs(ss,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(ft,{className:"h-4 w-4"}),e.jsx("span",{children:"Edit"})]})}),e.jsxs(ss,{variant:"outline",onClick:k,className:"flex items-center space-x-2 text-red-600 hover:text-red-800",children:[e.jsx(Es,{className:"h-4 w-4"}),e.jsx("span",{children:"Delete"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("div",{className:"relative h-96",children:[V.length>0?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:V[x],alt:i.title,className:"w-full h-full object-cover cursor-pointer",onClick:()=>f(!0)}),V.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:E,className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70",children:e.jsx(Wa,{className:"h-5 w-5"})}),e.jsx("button",{onClick:j,className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70",children:e.jsx(pa,{className:"h-5 w-5"})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:V.map((L,D)=>e.jsx("button",{onClick:()=>u(D),className:`w-2 h-2 rounded-full ${D===x?"bg-white":"bg-white bg-opacity-50"}`},D))})]})]}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:e.jsx(Sa,{className:"h-16 w-16 text-gray-400"})}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${R(i.status)}`,children:i.status||"Draft"})}),e.jsxs("div",{className:"absolute top-4 right-4 flex space-x-2",children:[e.jsxs("div",{className:"bg-black bg-opacity-70 text-white px-3 py-1 rounded text-sm",children:[i.views||0," views"]}),e.jsxs("div",{className:"bg-black bg-opacity-70 text-white px-3 py-1 rounded text-sm",children:[i.favorites||0," â™¥"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:F(i.price)}),e.jsxs("select",{value:i.status,onChange:L=>y(L.target.value),className:"text-sm border border-gray-300 rounded px-3 py-1",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"sold",children:"Sold"}),e.jsx("option",{value:"rented",children:"Rented"}),e.jsx("option",{value:"off_market",children:"Off Market"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[i.virtual_tour_url&&e.jsxs(ss,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(Kn,{className:"h-4 w-4"}),e.jsx("span",{children:"Virtual Tour"})]}),e.jsxs(ss,{className:"flex items-center space-x-2",children:[e.jsx(ks,{className:"h-4 w-4"}),e.jsx("span",{children:"View on Website"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(jl,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:i.bedrooms})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Bedrooms"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(Gn,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:i.bathrooms})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Bathrooms"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(dl,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:T(i.area)})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Sq Ft"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(Ts,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:i.year_built??"N/A"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Year Built"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8","aria-label":"Tabs",children:[e.jsx("button",{onClick:()=>N("overview"),className:`py-4 px-1 border-b-2 font-medium text-sm ${p==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Overview"}),e.jsxs("button",{onClick:()=>N("inquiries"),className:`py-4 px-1 border-b-2 font-medium text-sm ${p==="inquiries"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Inquiries (",o.length,")"]}),e.jsx("button",{onClick:()=>N("analytics"),className:`py-4 px-1 border-b-2 font-medium text-sm ${p==="analytics"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Analytics"})]})}),e.jsxs("div",{className:"p-6",children:[p==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Description"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:i.description})]}),i.features&&i.features.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Features"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:i.features.map((L,D)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:L})]},D))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Property Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Property Type:"}),e.jsx("span",{className:"font-medium",children:i.type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Lot Size:"}),e.jsx("span",{className:"font-medium",children:i.lot_size?`${T(i.lot_size)} sqft`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Property Tax:"}),e.jsxs("span",{className:"font-medium",children:[F(i.property_tax??0),"/year"]})]}),i.hoa_fees!=null&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"HOA Fees:"}),e.jsxs("span",{className:"font-medium",children:[F(i.hoa_fees),"/month"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Listing Agent"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-medium",children:(((B=(W=i.listing_agent_contact)==null?void 0:W.name)==null?void 0:B.charAt(0))??((M=i.listing_agent)==null?void 0:M.charAt(0))??"A").toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:((A=i.listing_agent_contact)==null?void 0:A.name)||i.listing_agent}),e.jsx("p",{className:"text-sm text-gray-600",children:"Listing Agent"})]})]}),i.listing_agent_contact&&e.jsxs("div",{className:"space-y-2",children:[i.listing_agent_contact.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:i.listing_agent_contact.email})]}),i.listing_agent_contact.phone&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:i.listing_agent_contact.phone})]})]})]})]})]})]}),p==="inquiries"&&e.jsx("div",{className:"space-y-4",children:o.length>0?o.map(L=>{var D,I;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"h-8 w-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:((I=(D=L.lead_name)==null?void 0:D.charAt(0))==null?void 0:I.toUpperCase())??"L"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:L.lead_name}),e.jsx("p",{className:"text-sm text-gray-600",children:L.lead_email})]})]}),e.jsx("p",{className:"text-gray-700 mb-2",children:L.message}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(L.inquiry_date).toLocaleString()})]}),e.jsx("div",{className:"ml-4",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:L.status})})]})},L.id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ds,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No inquiries yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Inquiries will appear here when potential buyers show interest"})]})}),p==="analytics"&&e.jsx("div",{className:"space-y-6",children:g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.weekly_views??0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Weekly Views"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:g.monthly_views??0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Monthly Views"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:g.total_inquiries??0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Inquiries"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[g.conversion_rate??0,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Conversion Rate"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Performance Insights"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Average Time on Page:"}),e.jsxs("span",{className:"font-medium",children:[g.average_time_on_page??0," seconds"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"View-to-Inquiry Rate:"}),e.jsxs("span",{className:"font-medium",children:[g.conversion_rate??0,"%"]})]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Rs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Analytics data not available"})]})})]})]})]})},eb=()=>{const{user:s}=Hs(),[a,t]=l.useState([]),[r,i]=l.useState(!0),[n,o]=l.useState(""),[m,g]=l.useState("all"),[b,d]=l.useState("all"),[v,x]=l.useState("all"),[u,c]=l.useState("all"),[f,p]=l.useState(!1),[N,P]=l.useState(!1),[w,$]=l.useState({type:"task",title:"",description:"",priority:"medium",scheduled_at:"",lead_id:"",property_id:""}),[y,k]=l.useState("list");l.useEffect(()=>{R()},[n,m,b,v,u]);const R=async()=>{try{i(!0);const L={};if(n&&(L.search=n),m!=="all"&&(L.status=m),b!=="all"&&(L.type=b),v!=="all"&&(L.priority=v),u!=="all"){const I=new Date;switch(u){case"today":L.date=I.toISOString().split("T")[0];break;case"this_week":const H=new Date(I.setDate(I.getDate()-I.getDay()));L.date_from=H.toISOString().split("T")[0];break;case"overdue":L.overdue=!0;break}}const D=await si.getActivities(L);D.success&&t(D.data)}catch(L){console.error("Error fetching activities:",L)}finally{i(!1)}},F=async()=>{try{const L={...w,assigned_to:s==null?void 0:s.id,lead_id:w.lead_id||void 0,property_id:w.property_id||void 0};await si.createActivity(L),wt.success("Activity created successfully"),$({type:"task",title:"",description:"",priority:"medium",scheduled_at:"",lead_id:"",property_id:""}),p(!1),R()}catch(L){console.error("Error creating activity:",L),wt.error("Failed to create activity")}},T=async L=>{try{await si.updateActivity(L,{status:"completed",completed_at:new Date().toISOString()}),wt.success("Activity marked as completed"),R()}catch(D){console.error("Error completing activity:",D),wt.error("Failed to complete activity")}},j=async L=>{if(window.confirm("Are you sure you want to delete this activity?"))try{await si.deleteActivity(L),wt.success("Activity deleted successfully"),R()}catch(D){console.error("Error deleting activity:",D),wt.error("Failed to delete activity")}},E=L=>{switch(L==null?void 0:L.toLowerCase()){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},V=L=>{switch(L==null?void 0:L.toLowerCase()){case"high":return"text-red-600";case"medium":return"text-yellow-600";case"low":return"text-green-600";default:return"text-gray-600"}},W=L=>{switch(L==null?void 0:L.toLowerCase()){case"call":return e.jsx(Cs,{className:"h-4 w-4"});case"email":return e.jsx(Ds,{className:"h-4 w-4"});case"meeting":return e.jsx(Ns,{className:"h-4 w-4"});case"viewing":return e.jsx(Is,{className:"h-4 w-4"});case"follow_up":return e.jsx(ha,{className:"h-4 w-4"});case"note":return e.jsx(Bt,{className:"h-4 w-4"});default:return e.jsx(Ts,{className:"h-4 w-4"})}},B=L=>{var D;return new Date(L)<new Date&&!((D=a.find(I=>I.id===L))!=null&&D.completed_at)},M=()=>{const L=new Date,D=new Date(L);return D.setDate(D.getDate()+1),a.filter(I=>{const H=new Date(I.scheduled_at);return H>=L&&H<=D&&I.status!=="completed"})},A=()=>a.filter(L=>B(L.scheduled_at)&&L.status!=="completed");return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Activities"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Manage your tasks, meetings, and follow-ups"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(ss,{variant:y==="list"?"primary":"outline",size:"sm",onClick:()=>k("list"),className:"flex-1 sm:flex-none",children:"List"}),e.jsx(ss,{variant:y==="calendar"?"primary":"outline",size:"sm",onClick:()=>k("calendar"),className:"flex-1 sm:flex-none",children:"Calendar"})]}),e.jsxs(ss,{onClick:()=>p(!0),className:"flex items-center justify-center space-x-2 w-full sm:w-auto",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Add Activity"}),e.jsx("span",{className:"xs:hidden",children:"Add"})]})]})]}),A().length>0&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Xa,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:"text-red-800 font-medium text-sm sm:text-base",children:["You have ",A().length," overdue activities!"]})]})}),M().length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(ha,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:"text-blue-800 font-medium text-sm sm:text-base",children:["You have ",M().length," activities due today/tomorrow"]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 sm:p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Activity"}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>p(!1),className:"p-1",children:e.jsx(ns,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:w.type,onChange:L=>$({...w,type:L.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm sm:text-base",children:[e.jsx("option",{value:"task",children:"Task"}),e.jsx("option",{value:"call",children:"Phone Call"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"meeting",children:"Meeting"}),e.jsx("option",{value:"viewing",children:"Property Viewing"}),e.jsx("option",{value:"follow_up",children:"Follow-up"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:w.title,onChange:L=>$({...w,title:L.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm sm:text-base",placeholder:"Activity title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:w.description,onChange:L=>$({...w,description:L.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm sm:text-base resize-none",placeholder:"Activity description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:w.priority,onChange:L=>$({...w,priority:L.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm sm:text-base",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scheduled Date/Time"}),e.jsx("input",{type:"datetime-local",value:w.scheduled_at,onChange:L=>$({...w,scheduled_at:L.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm sm:text-base"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 pt-4",children:[e.jsx(ss,{onClick:F,disabled:!w.title||!w.description,className:"flex-1 order-1 sm:order-none",children:"Create Activity"}),e.jsx(ss,{variant:"outline",onClick:()=>p(!1),className:"flex-1 order-2 sm:order-none",children:"Cancel"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search activities...",value:n,onChange:L=>o(L.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base"})]}),e.jsx("div",{className:"sm:hidden",children:e.jsxs(ss,{variant:"outline",onClick:()=>P(!N),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Na,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters"})]}),e.jsx(ea,{className:`h-4 w-4 transition-transform ${N?"rotate-180":""}`})]})}),e.jsxs("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 ${N?"block":"hidden sm:grid"}`,children:[e.jsxs("select",{value:m,onChange:L=>g(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:b,onChange:L=>d(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"task",children:"Task"}),e.jsx("option",{value:"call",children:"Call"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"meeting",children:"Meeting"}),e.jsx("option",{value:"viewing",children:"Viewing"}),e.jsx("option",{value:"follow_up",children:"Follow-up"})]}),e.jsxs("select",{value:v,onChange:L=>x(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[e.jsx("option",{value:"all",children:"All Priorities"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:u,onChange:L=>c(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",children:[e.jsx("option",{value:"all",children:"All Dates"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"this_week",children:"This Week"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsx("div",{className:"divide-y divide-gray-200",children:a.length>0?a.map(L=>e.jsx("div",{className:"p-4 sm:p-6 hover:bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"flex items-start space-x-3 sm:space-x-4 flex-1",children:[e.jsx("div",{className:"mt-1 flex-shrink-0",children:W(L.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-start gap-2",children:[e.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 break-words",children:L.title}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full whitespace-nowrap ${E(L.status)}`,children:L.status||"Pending"}),L.priority&&e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full bg-gray-100 whitespace-nowrap ${V(L.priority)}`,children:L.priority.toUpperCase()}),B(L.scheduled_at)&&L.status!=="completed"&&e.jsx("span",{className:"text-xs font-medium text-red-600 bg-red-100 px-2 py-1 rounded whitespace-nowrap",children:"OVERDUE"})]})]}),e.jsx("p",{className:"text-gray-700 text-sm sm:text-base break-words",children:L.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-1 sm:space-y-0 text-xs sm:text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ls,{className:"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0"}),e.jsx("span",{className:"break-words",children:new Date(L.scheduled_at).toLocaleString()})]}),L.lead_name&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ns,{className:"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0"}),e.jsxs("span",{className:"break-words",children:["Lead: ",L.lead_name]})]}),L.property_title&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{className:"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0"}),e.jsxs("span",{className:"break-words",children:["Property: ",L.property_title]})]}),e.jsxs("span",{className:"break-words",children:["Created by ",L.created_by]})]})]})})]}),e.jsxs("div",{className:"flex flex-row sm:flex-col lg:flex-row items-center gap-2 sm:items-end lg:items-center flex-shrink-0",children:[L.status!=="completed"&&e.jsxs(ss,{variant:"outline",size:"sm",onClick:()=>T(L.id),className:"flex items-center space-x-1 text-xs sm:text-sm flex-1 sm:flex-none lg:flex-1 xl:flex-none min-w-0",children:[e.jsx(bs,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"hidden xs:inline truncate",children:"Complete"}),e.jsx("span",{className:"xs:hidden",children:"âœ“"})]}),e.jsxs(ss,{variant:"outline",size:"sm",className:"flex items-center space-x-1 text-xs sm:text-sm flex-1 sm:flex-none lg:flex-1 xl:flex-none min-w-0",children:[e.jsx(ft,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"hidden xs:inline truncate",children:"Edit"}),e.jsx("span",{className:"xs:hidden",children:"âœï¸"})]}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>j(L.id),className:"text-red-600 hover:text-red-800 flex items-center justify-center p-2 min-w-0",children:e.jsx(Es,{className:"h-3 w-3"})})]})]})},L.id)):e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx(Ts,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No activities found"}),e.jsx("p",{className:"text-gray-500 mb-4 text-sm sm:text-base",children:n||m!=="all"||b!=="all"?"Try adjusting your search criteria":"Get started by creating your first activity"}),e.jsxs(ss,{onClick:()=>p(!0),className:"flex items-center space-x-2",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:"Create First Activity"})]})]})})})]})})},Xd=!0,em={overview:{total_leads:245,total_properties:98,total_revenue:125e5,conversion_rate:14.7,leads_growth:23.5,properties_growth:10.2,revenue_growth:18.4,conversion_growth:2.1},leads_by_source:[{source:"MagicBricks",count:124,percentage:45.2},{source:"99acres",count:88,percentage:32.1},{source:"Housing.com",count:45,percentage:16.5},{source:"Direct/Referral",count:17,percentage:6.2}],leads_by_status:[{status:"New",count:98,percentage:40},{status:"Contacted",count:76,percentage:30},{status:"Closed",count:71,percentage:29}],properties_by_type:[{type:"Apartment",count:56,average_price:85e5},{type:"Villa",count:22,average_price:185e5},{type:"Plot",count:20,average_price:45e5}],monthly_performance:[{month:"Jan",leads:34,properties:12,revenue:12e5},{month:"Feb",leads:28,properties:9,revenue:9e5},{month:"Mar",leads:45,properties:14,revenue:14e5}],agent_performance:[{agent_name:"Amit Sharma",leads_count:45,properties_sold:10,revenue:45e5,conversion_rate:18.2},{agent_name:"Priya Mehta",leads_count:38,properties_sold:8,revenue:32e5,conversion_rate:16.7}],top_properties:[{id:"P1",title:"Skyline Towers",views:1247,inquiries:67,price:25e6},{id:"P2",title:"Green Valley Villa",views:892,inquiries:45,price:18e6}]},ii=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s),sb=s=>`${s>0?"+":""}${s.toFixed(1)}%`,tb=()=>{const{user:s}=(Hs==null?void 0:Hs())??{user:null},[a,t]=l.useState(em),[r,i]=l.useState(!Xd),[n,o]=l.useState("last_30_days"),[m,g]=l.useState("overview"),[b,d]=l.useState(!1),v=l.useCallback(async()=>{var k,R,F,T;i(!0),t(null);const y={period:n,sellerId:(s==null?void 0:s.id)??void 0};try{const j=await Xh.getAnalytics(y),E=j!=null&&j.success?j.data:j;t(E),i(!1);return}catch(j){if(console.warn("[Analytics] primary failed:",((k=j==null?void 0:j.response)==null?void 0:k.status)??(j==null?void 0:j.message)),((R=j==null?void 0:j.response)==null?void 0:R.status)===404)try{const V=await Ae.get("/dashboard/analytics",{params:y});t(V.data),i(!1);return}catch(V){console.error("[Analytics] fallback failed:",((F=V==null?void 0:V.response)==null?void 0:F.status)??(V==null?void 0:V.message))}const E=(T=j==null?void 0:j.response)==null?void 0:T.status;E===401?wt.error("Not authorized. Please login again."):E===403?wt.error("Access denied to analytics."):E===404?wt.error("Analytics endpoint not found (404). Check backend routes."):wt.error("Failed to load analytics data. Check server/network."),i(!1)}},[n,s]);l.useEffect(()=>{{i(!1);return}},[v]);const x=async()=>{{wt.success("Using mock data (no API calls).");return}},u=async()=>{d(!0),await x(),d(!1),wt.success("Analytics data refreshed")},c=async()=>{try{const y=a??em,k=[];k.push("Metric,Value"),k.push(`Total Leads,${y.overview.total_leads}`),k.push(`Total Properties,${y.overview.total_properties}`),k.push(`Total Revenue,${y.overview.total_revenue}`),k.push(`Conversion Rate,${y.overview.conversion_rate}`);const R=k.join(`
`),F=new Blob([R],{type:"text/csv"}),T=window.URL.createObjectURL(F),j=document.createElement("a");j.href=T,j.download=`analytics-mock-${n}-${new Date().toISOString().split("T")[0]}.csv`,j.click(),window.URL.revokeObjectURL(T),wt.success("Mock analytics exported")}catch(y){console.error("Export error",y),wt.error("Failed to export analytics")}};if(r)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})});if(!a)return e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Analytics Not Available"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load analytics data. Please try again later."}),e.jsxs("div",{className:"flex justify-center gap-2 sm:gap-3 flex-wrap",children:[e.jsx(ss,{onClick:x,className:"w-full sm:w-auto",children:"Retry"}),e.jsxs(ss,{variant:"outline",onClick:u,className:"w-full sm:w-auto",children:[e.jsx(na,{className:`h-4 w-4 ${b?"animate-spin":""}`}),e.jsx("span",{className:"ml-2",children:"Refresh"})]})]})]})});const f=a.overview,p=a.leads_by_source,N=a.leads_by_status,P=a.properties_by_type,w=a.top_properties,$=a.agent_performance;return e.jsxs("div",{className:"p-4 sm:p-6 space-y-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Analytics & Reports"}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:["Insights into your CRM performance and metrics ","(mock)"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row w-full sm:w-auto gap-2 sm:gap-3",children:[e.jsxs("select",{value:n,onChange:y=>o(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full sm:w-auto",children:[e.jsx("option",{value:"last_7_days",children:"Last 7 Days"}),e.jsx("option",{value:"last_30_days",children:"Last 30 Days"}),e.jsx("option",{value:"last_90_days",children:"Last 90 Days"}),e.jsx("option",{value:"last_year",children:"Last Year"})]}),e.jsxs(ss,{variant:"outline",onClick:u,disabled:b,className:"flex items-center justify-center gap-2 w-full sm:w-auto",children:[e.jsx(na,{className:`h-4 w-4 ${b?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]}),e.jsxs(ss,{variant:"outline",onClick:c,className:"flex items-center justify-center gap-2 w-full sm:w-auto",children:[e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(oi,{label:"Total Leads",value:f.total_leads.toLocaleString(),growth:f.leads_growth,icon:Ns,color:"bg-blue-500"}),e.jsx(oi,{label:"Total Properties",value:f.total_properties.toLocaleString(),growth:f.properties_growth,icon:Is,color:"bg-green-500"}),e.jsx(oi,{label:"Total Revenue",value:ii(f.total_revenue),growth:f.revenue_growth,icon:ka,color:"bg-purple-500"}),e.jsx(oi,{label:"Conversion Rate",value:`${f.conversion_rate.toFixed(1)}%`,growth:f.conversion_growth,icon:rt,color:"bg-orange-500"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("nav",{className:"flex gap-4 sm:gap-8 whitespace-nowrap px-4 sm:px-6","aria-label":"Tabs",children:[e.jsx("button",{onClick:()=>g("overview"),className:`py-3 sm:py-4 px-3 sm:px-1 border-b-2 font-medium text-sm shrink-0 ${m==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Overview"}),e.jsx("button",{onClick:()=>g("leads"),className:`py-3 sm:py-4 px-3 sm:px-1 border-b-2 font-medium text-sm shrink-0 ${m==="leads"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Leads Analysis"}),e.jsx("button",{onClick:()=>g("properties"),className:`py-3 sm:py-4 px-3 sm:px-1 border-b-2 font-medium text-sm shrink-0 ${m==="properties"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Properties Analysis"}),e.jsx("button",{onClick:()=>g("agents"),className:`py-3 sm:py-4 px-3 sm:px-1 border-b-2 font-medium text-sm shrink-0 ${m==="agents"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Agent Performance"})]})})}),e.jsxs("div",{className:"p-4 sm:p-6",children:[m==="overview"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Performance"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 sm:p-6 h-56 sm:h-64 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(dh,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"Performance chart would go here"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Integration with charting library needed"})]})})]})}),m==="leads"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(ci,{title:"Leads by Source",items:p.map(y=>({label:y.source,value:y.count,extra:`${y.percentage}%`}))}),e.jsx(ci,{title:"Leads by Status",items:N.map(y=>({label:y.status,value:y.count,extra:`${y.percentage}%`}))})]})}),m==="properties"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(ci,{title:"Properties by Type",items:P.map(y=>({label:y.type,value:y.count,extra:ii(y.average_price)}))}),e.jsx(ci,{title:"Top Performing Properties",items:w.map(y=>({label:y.title,value:`${y.views} views`,extra:ii(y.price)}))})]})}),m==="agents"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Agent Performance"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agent"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leads"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Properties Sold"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conversion Rate"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$.map((y,k)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:y.agent_name.charAt(0)}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.agent_name})})]})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.leads_count}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:y.properties_sold}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ii(y.revenue)}),e.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[y.conversion_rate.toFixed(1),"%"]})]},k))})]})})]})]})]})]})},oi=({label:s,value:a,growth:t,icon:r,color:i})=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-5 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:a})]}),e.jsx("div",{className:`h-10 w-10 sm:h-12 sm:w-12 ${i} rounded-full flex items-center justify-center`,children:e.jsx(r,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})})]}),e.jsxs("div",{className:`flex items-center mt-2 ${t>=0?"text-green-600":"text-red-600"}`,children:[t>=0?e.jsx(Rs,{className:"h-4 w-4"}):e.jsx(qc,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium ml-1",children:sb(t)}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 ml-1",children:"vs last period"})]})]}),ci=({title:s,items:a})=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s}),e.jsxs("div",{className:"space-y-3",children:[a.length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"No data"}),a.map((t,r)=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 break-words",children:t.label}),e.jsx("span",{className:"text-sm text-gray-900 sm:text-right",children:t.value}),e.jsx("span",{className:"text-xs text-gray-500 sm:text-right",children:t.extra})]},r))]})]}),ab=({visible:s,onClose:a,onSubmit:t,editingUser:r,newUser:i,setNewUser:n,formErrors:o,handleInputChange:m,handleGeneratePassword:g,showPassword:b,setShowPassword:d,masterLoading:v,masters:x,submitDisabled:u})=>{if(!s)return null;const c=x.role||[],f=x.designation||[],p=x.department||[],N=x["blood groups"]||[],P=x.salutation||x.salutation||[];l.useEffect(()=>{r||i.buyer_id||i.seller_id},[r,i.buyer_id,i.seller_id,i.role,i.salutation]);const w=!i.salutation||!i.email||!i.first_name||!i.last_name||!i.role||!i.dob||!r&&!i.password,$=y=>{m("role",y),y.toLowerCase()==="buyer"?n({...i,role:y,buyer_id:i.buyer_id??null,seller_id:null}):y.toLowerCase()==="seller"?n({...i,role:y,seller_id:i.seller_id??null,buyer_id:null}):n({...i,role:y,buyer_id:null,seller_id:null})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-3 sm:p-4",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-full sm:max-w-xl shadow-lg",children:[e.jsx("div",{className:"px-4 sm:px-6 pt-4 sm:pt-6",children:e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:r?"Edit User":"Add User"})}),e.jsx("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6 max-h-[70vh] sm:max-h-[80vh] overflow-y-auto overscroll-contain",children:v?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx(ia,{size:"sm"}),e.jsx("span",{className:"ml-2 text-base",children:"Loading form options..."})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Salutation ",e.jsx("span",{className:"text-red-500",children:"*"})]}),P.length>0?e.jsxs("select",{value:i.salutation||"",onChange:y=>m("salutation",y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 text-sm focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.salutation?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select"}),P.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]}):e.jsx("input",{type:"text",value:i.salutation||"",onChange:y=>m("salutation",y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 text-sm focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.salutation?"border-red-300":"border-gray-300"}`,placeholder:"Mr / Ms / Dr"}),o.salutation&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.salutation})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.first_name,onChange:y=>m("first_name",y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.first_name?"border-red-300":"border-gray-300"}`,placeholder:"First name"}),o.first_name&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.first_name})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.last_name,onChange:y=>m("last_name",y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.last_name?"border-red-300":"border-gray-300"}`,placeholder:"Last name"}),o.last_name&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.last_name})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.username||"",onChange:y=>m("username",y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.username?"border-red-300":"border-gray-300"}`,placeholder:"Username"}),o.username&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.username})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:i.email,onChange:y=>m("email",y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.email?"border-red-300":"border-gray-300"}`,placeholder:"Email"}),o.email&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.email})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date of Birth ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:i.dob||"",onChange:y=>m("dob",y.target.value),max:new Date().toISOString().split("T")[0],className:`w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.dob?"border-red-300":"border-gray-300"}`}),o.dob&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.dob})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:i.phone||"",onChange:y=>m("phone",y.target.value),className:"w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 border-gray-300",placeholder:"Phone"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:i.department||"",onChange:y=>m("department",y.target.value),className:"w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 border-gray-300",children:[e.jsx("option",{value:"",children:"Select Department"}),p.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:i.role||"",onChange:y=>$(y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.role?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select Role"}),c.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]}),o.role&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.role})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation"}),e.jsxs("select",{value:i.designation||"",onChange:y=>m("designation",y.target.value),className:"w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 border-gray-300",children:[e.jsx("option",{value:"",children:"Select Designation"}),f.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blood Group"}),e.jsxs("select",{value:i.blood_group||"",onChange:y=>m("blood_group",y.target.value),className:"w-full h-10 sm:h-9 border rounded px-2 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 border-gray-300",children:[e.jsx("option",{value:"",children:"Select Blood Group"}),N.map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",!r&&e.jsx("span",{className:"text-red-500",children:"*"}),r&&e.jsx("span",{className:"text-gray-400 text-sm",children:" (leave blank to keep current)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:b?"text":"password",value:i.password||"",onChange:y=>m("password",y.target.value),className:`w-full h-10 sm:h-9 border rounded px-2 pr-20 text-base focus:outline-blue-500 focus:ring-1 focus:ring-blue-500 ${o.password?"border-red-300":"border-gray-300"}`,placeholder:r?"New password (optional)":"Password (min 6 characters)"}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center space-x-1 pr-3",children:[e.jsx("button",{type:"button",onClick:()=>d(!b),className:"text-gray-400 hover:text-gray-600",children:b?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:g,className:"text-blue-600 hover:text-blue-700 text-xs font-medium",children:"Gen"})]})]}),o.password&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:o.password}),i.password&&!r&&e.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded",children:e.jsxs("p",{className:"text-xs text-blue-800 font-medium",children:["**Password: ",e.jsx("span",{className:"font-mono",children:i.password})]})}),r&&i.password&&e.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:e.jsxs("p",{className:"text-xs text-green-800 font-medium",children:["**New Password: ",e.jsx("span",{className:"font-mono",children:i.password})]})})]})]})})}),e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t bg-white sticky bottom-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2",children:[e.jsx(ss,{onClick:t,disabled:u??w,size:"sm",className:"w-full sm:w-auto",children:r?"Update":"Create"}),e.jsx(ss,{variant:"outline",onClick:()=>{a()},size:"sm",className:"w-full sm:w-auto",children:"Cancel"})]})})]})})},Ll=[{id:"all",name:"Team Members",roles:["admin","executive","manager","team leader","agent","sales team leader","presales team leader","sales manager","marketing executive","presales executive","sales executive"],showCreateButton:!1,createButtonText:""},{id:"buyers",name:"Buyers",roles:["buyer"],showCreateButton:!0,createButtonText:""},{id:"sellers",name:"Sellers",roles:["seller"],showCreateButton:!0,createButtonText:""},{id:"buyer-accounts",name:"Buyer Accounts",roles:["buyer"],showCreateButton:!0,createButtonText:""},{id:"seller-accounts",name:"Seller Accounts",roles:["seller"],showCreateButton:!0,createButtonText:"Create Seller Account"}],sm="users-management-active-tab",rb=({onEditUser:s,refreshTrigger:a,userPasswords:t={},getLabelFromValue:r,masters:i,masterLoading:n,onCreateUser:o})=>{Ca();const[m,g]=l.useState([]),[b,d]=l.useState([]),[v,x]=l.useState([]),[u,c]=l.useState(!0),[f,p]=l.useState(""),[N,P]=l.useState("all"),[w,$]=l.useState("all"),[y,k]=l.useState([]),[R,F]=l.useState(!1),[T,j]=l.useState(()=>{const xe=localStorage.getItem(sm);return xe&&Ll.find(Ee=>Ee.id===xe)?xe:"all"}),[E,V]=l.useState(!1),[W,B]=l.useState(null),[M,A]=l.useState(!1),[L,D]=l.useState("buyer"),[I,H]=l.useState(null),[h,Y]=l.useState(!1),K=xe=>{if(!xe)return null;if(typeof xe=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(xe))return xe;if(xe instanceof Date&&!isNaN(xe.getTime())){const Ee=xe.getFullYear(),Ke=String(xe.getMonth()+1).padStart(2,"0"),Xe=String(xe.getDate()).padStart(2,"0");return`${Ee}-${Ke}-${Xe}`}if(typeof xe=="string")try{const Ee=new Date(xe);if(!isNaN(Ee.getTime())){const Ke=Ee.getFullYear(),Xe=String(Ee.getMonth()+1).padStart(2,"0"),ye=String(Ee.getDate()).padStart(2,"0");return`${Ke}-${Xe}-${ye}`}}catch{const Ee=String(xe).match(/(\d{4})-(\d{2})-(\d{2})/);if(Ee)return`${Ee[1]}-${Ee[2]}-${Ee[3]}`}return null},q=xe=>xe?typeof xe=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(xe)?xe:K(xe)||"":"",ne=xe=>{if(!xe||typeof xe!="string")return{first_name:"",last_name:""};const Ee=xe.trim().split(/\s+/);return Ee.length===1?{first_name:Ee[0],last_name:""}:{first_name:Ee[0],last_name:Ee.slice(1).join(" ")}},le=(xe,Ee)=>{const Ke=ne(xe.name),Xe=xe.first_name&&String(xe.first_name).trim()||Ke.first_name||"",ye=xe.last_name&&String(xe.last_name).trim()||Ke.last_name||"";return{id:xe.id,username:xe.username,email:xe.email||"",salutation:xe.salutation||"",first_name:Xe,last_name:ye,role:Ee,phone:xe.phone||xe.mobile||"",avatar:xe.avatar,designation:xe.designation,department:xe.department,is_active:xe.is_active??!0,created_at:xe.created_at,last_login:xe.last_login,total_leads:xe.total_leads||0,total_properties:xe.total_properties||0,total_revenue:xe.total_revenue||0,dob:K(xe.dob),blood_group:xe.blood_group,buyer_id:xe.buyer_id??(Ee==="buyer"?xe.id:null),seller_id:xe.seller_id??(Ee==="seller"?xe.id:null)}},S=xe=>xe?Array.isArray(xe)?xe:Array.isArray(xe.data)?xe.data:[]:[],C=xe=>xe?xe.toLowerCase().trim().replace(/\s+/g," "):"",J=xe=>{j(xe),localStorage.setItem(sm,xe)},ue=xe=>xe==null?"":t[String(xe)]||"",Q=(xe,Ee)=>m.some(Ke=>Ee==="buyer"?String(Ke.buyer_id)===String(xe)&&C(Ke.role)==="buyer":String(Ke.seller_id)===String(xe)&&C(Ke.role)==="seller"),he=xe=>({salutation:xe.salutation,first_name:xe.first_name,last_name:xe.last_name,email:xe.email,phone:xe.phone,username:xe.username,dob:q(xe.dob),buyer_id:xe.buyer_id??(C(xe.role||"")==="buyer"?xe.id??null:null),seller_id:xe.seller_id??(C(xe.role||"")==="seller"?xe.id??null:null)});l.useEffect(()=>{(async()=>{try{const Ee=await Vt.getAll(),Xe=S(Ee).map(ye=>le(ye,"buyer"));d(Xe)}catch(Ee){Z.error("âŒ Error fetching buyers:",Ee)}try{const Ee=await st.getAll(),Xe=S(Ee).map(ye=>le(ye,"seller"));x(Xe)}catch(Ee){Z.error("âŒFailed to load sellers data",Ee)}})()},[a]),l.useEffect(()=>{n||se()},[n,a]);const se=async()=>{var xe,Ee;try{c(!0);const Ke=await Os.filterData({});if(Ke!=null&&Ke.success){const Xe=(Ke.data||[]).map(ye=>{const Ce=ne(ye.name),_=ye.first_name&&String(ye.first_name).trim()||Ce.first_name||"",ae=ye.last_name&&String(ye.last_name).trim()||Ce.last_name||"",ke=C(ye.role||"");return{id:ye.id,username:ye.username,email:ye.email,salutation:ye.salutation,first_name:_,last_name:ae,role:ke,phone:ye.phone,avatar:ye.avatar,designation:ye.designation,department:ye.department,is_active:!!ye.is_active,created_at:ye.created_at,last_login:ye.last_login,total_leads:ye.total_leads,total_properties:ye.total_properties,total_revenue:ye.total_revenue,dob:K(ye.dob),blood_group:ye.blood_group,buyer_id:ye.buyer_id??null,seller_id:ye.seller_id??null}});g(Xe)}else Z.error("Failed to load users")}catch(Ke){Z.error(((Ee=(xe=Ke==null?void 0:Ke.response)==null?void 0:xe.data)==null?void 0:Ee.message)||"Failed to load users")}finally{c(!1)}},ge=async(xe,Ee)=>{const Ke={...Ee,role:xe,buyer_id:(Ee==null?void 0:Ee.buyer_id)??(xe==="buyer"?(Ee==null?void 0:Ee.id)??null:null),seller_id:(Ee==null?void 0:Ee.seller_id)??(xe==="seller"?(Ee==null?void 0:Ee.id)??null:null)};if(o){try{await o({role:xe,prefill:Ke}),J(xe==="buyer"?"buyer-accounts":"seller-accounts"),se()}catch(Xe){console.error("âŒ onCreateUser handler failed",Xe)}return}D(xe),H(Ke),A(!0)},ee=async xe=>{var Ee,Ke,Xe,ye;try{Y(!0);const Ce=I||{},_=!(Ce.buyer_id||Ce.seller_id),ae=xe.buyer_id??Ce.buyer_id??null,ke=xe.seller_id??Ce.seller_id??null,Me={salutation:xe.salutation,first_name:xe.first_name,last_name:xe.last_name,email:xe.email,phone:xe.phone,username:xe.username||void 0,password:xe.password||void 0,role:L,is_active:xe.is_active!==void 0?xe.is_active:_,dob:K(xe.dob),buyer_id:ae===null?null:typeof ae=="string"&&/^\d+$/.test(ae)?Number(ae):ae,seller_id:ke===null?null:typeof ke=="string"&&/^\d+$/.test(ke)?Number(ke):ke},Ye=await Os.createUser(Me);if(!(Ye!=null&&Ye.success))throw new Error((Ye==null?void 0:Ye.message)||"Failed to create user");const ie=Ye.data;if(L==="buyer"&&!Me.buyer_id)try{const we=await Vt.create({salutation:xe.salutation,name:`${xe.first_name||""} ${xe.last_name||""}`.trim(),email:xe.email,phone:xe.phone,dob:K(xe.dob),user_id:ie.id});we!=null&&we.success&&((Ee=we.data)!=null&&Ee.id)&&(await Os.updateUser(String(ie.id),{buyer_id:we.data.id}),ie.buyer_id=we.data.id)}catch(we){console.warn("âš ï¸ Buyer creation failed (user created):",we)}else if(L==="seller"&&!Me.seller_id)try{const we=await st.create({salutation:xe.salutation,name:`${xe.first_name||""} ${xe.last_name||""}`.trim(),email:xe.email,phone:xe.phone,dob:K(xe.dob),user_id:ie.id});we!=null&&we.success&&((Ke=we.data)!=null&&Ke.id)&&(await Os.updateUser(String(ie.id),{seller_id:we.data.id}),ie.seller_id=we.data.id)}catch(we){console.warn("âš ï¸ Seller creation failed (user created):",we)}Z.success("Account created successfully"),g(we=>we.some(Ve=>String(Ve.id)===String(ie.id))?we.map(Ve=>String(Ve.id)===String(ie.id)?{...Ve,...ie}:Ve):[ie,...we]),J(L==="buyer"?"buyer-accounts":"seller-accounts"),A(!1),H(null),se()}catch(Ce){console.error("âŒ Error creating account (local):",Ce),Z.error(((ye=(Xe=Ce==null?void 0:Ce.response)==null?void 0:Xe.data)==null?void 0:ye.message)||Ce.message||"Failed to create account")}finally{Y(!1)}},de=xe=>{B(xe),V(!0)},U=()=>{if(!W)return;const xe=ue(W.id),Ee=encodeURIComponent(`Account details â€” ${W.first_name} ${W.last_name}`),Ke=encodeURIComponent(`Name: ${W.salutation?W.salutation+" ":""}${W.first_name} ${W.last_name}
Email: ${W.email}
Username: ${W.username||"N/A"}
Password: ${xe||"Not available"}`);window.open(`mailto:?subject=${Ee}&body=${Ke}`),V(!1)},X=()=>{if(!W)return;const xe=ue(W.id),Ee=encodeURIComponent(`Account details
Name: ${W.salutation?W.salutation+" ":""}${W.first_name} ${W.last_name}
Email: ${W.email}
Username: ${W.username||"N/A"}
Password: ${xe||"Not available"}`);window.open(`https://wa.me/?text=${Ee}`),V(!1)},re=()=>{if(!W)return;const xe=ue(W.id),Ee=encodeURIComponent(`Account details â€” ${W.salutation?W.salutation+" ":""}${W.first_name} ${W.last_name}
Email: ${W.email}
Username: ${W.username||"N/A"}
Password: ${xe||"Not available"}`);window.open(`sms:?body=${Ee}`),V(!1)},fe=()=>{if(!W)return;const xe=ue(W.id),Ee=`Account details â€” ${W.salutation?W.salutation+" ":""}${W.first_name} ${W.last_name}
Email: ${W.email}
Username: ${W.username||"N/A"}
Password: ${xe||"Not available"}`;navigator.clipboard.writeText(Ee).then(()=>{Z.success("Copied to clipboard"),V(!1)}).catch(()=>{Z.error("Failed to copy")})},G=()=>{const xe=Ll.find(Ke=>Ke.id===T)??Ll[0];let Ee=[];switch(T){case"buyers":Ee=b;break;case"sellers":Ee=v;break;case"buyer-accounts":Ee=m.filter(Ke=>C(Ke.role)==="buyer");break;case"seller-accounts":Ee=m.filter(Ke=>C(Ke.role)==="seller");break;default:Ee=m.filter(Ke=>xe.roles.some(Xe=>C(Ke.role)===C(Xe)))}if(f){const Ke=f.toLowerCase();Ee=Ee.filter(Xe=>`${Xe.first_name} ${Xe.last_name}`.toLowerCase().includes(Ke)||(Xe.email||"").toLowerCase().includes(Ke)||(Xe.username||"").toLowerCase().includes(Ke))}if(N!=="all"&&T==="all"&&(Ee=Ee.filter(Ke=>C(Ke.role)===C(N))),w!=="all"){const Ke=w==="active";Ee=Ee.filter(Xe=>!!Xe.is_active===Ke)}return Ee},me=()=>{const xe={};return Ll.forEach(Ee=>{switch(Ee.id){case"buyers":xe[Ee.id]=b.length;break;case"sellers":xe[Ee.id]=v.length;break;case"buyer-accounts":xe[Ee.id]=m.filter(Ke=>C(Ke.role)==="buyer").length;break;case"seller-accounts":xe[Ee.id]=m.filter(Ke=>C(Ke.role)==="seller").length;break;default:xe[Ee.id]=m.filter(Ke=>Ee.roles.some(Xe=>C(Ke.role)===C(Xe))).length}}),xe};l.useEffect(()=>{k([]),F(!1)},[T]);const oe=G(),Fe=me(),$e=xe=>{xe!=null&&k(Ee=>{const Ke=String(xe),ye=Ee.some(Ce=>String(Ce)===Ke)?Ee.filter(Ce=>String(Ce)!==Ke):[...Ee,xe];return F(ye.length>0),ye})},Le=()=>{const xe=oe.map(Ee=>Ee.id).filter(Boolean);y.length===xe.length?(k([]),F(!1)):(k(xe),F(!0))},je=async xe=>{if(!(xe==="delete"&&!window.confirm(`Delete ${y.length} users?`)))try{for(const Ee of y)xe==="delete"?await Os.deleteUser(String(Ee)):await Os.updateUser(String(Ee),{is_active:xe==="activate"});if(k([]),F(!1),se(),T==="buyers"||T==="buyer-accounts"){const Ee=await Vt.getAll(),Ke=S(Ee);d(Ke.map(Xe=>le(Xe,"buyer")))}if(T==="sellers"||T==="seller-accounts"){const Ee=await st.getAll(),Ke=S(Ee);x(Ke.map(Xe=>le(Xe,"seller")))}}catch(Ee){console.error(`âŒ Bulk ${xe} error:`,Ee),Z.error(`Bulk ${xe} failed`),se()}},_e=async(xe,Ee)=>{if(xe==null)return;const Ke=!Ee;try{if(await Os.updateUser(String(xe),{is_active:Ke}),Z.success(`User ${Ke?"activated":"deactivated"} successfully`),se(),T==="buyers"||T==="buyer-accounts"){const Xe=await Vt.getAll(),ye=S(Xe);d(ye.map(Ce=>le(Ce,"buyer")))}if(T==="sellers"||T==="seller-accounts"){const Xe=await st.getAll(),ye=S(Xe);x(ye.map(Ce=>le(Ce,"seller")))}}catch(Xe){console.error(`âŒ Error toggling user ${xe} status:`,Xe),Z.error("Failed to update user status")}},ve=async xe=>{if(xe!=null&&window.confirm("Are you sure you want to delete this user? This action cannot be undone."))try{if(await Os.deleteUser(String(xe)),Z.success("User deleted successfully"),se(),T==="buyers"||T==="buyer-accounts"){const Ee=await Vt.getAll(),Ke=S(Ee);d(Ke.map(Xe=>le(Xe,"buyer")))}if(T==="sellers"||T==="seller-accounts"){const Ee=await st.getAll(),Ke=S(Ee);x(Ke.map(Xe=>le(Xe,"seller")))}}catch(Ee){console.error(`âŒ Error deleting user ${xe}:`,Ee),Z.error("Failed to delete user")}},Pe=xe=>{switch(C(xe||"")){case"admin":return"bg-red-100 text-red-800";case"manager":return"bg-purple-100 text-purple-800";case"agent":return"bg-blue-100 text-blue-800";case"seller":return"bg-green-100 text-green-800";case"buyer":return"bg-orange-100 text-orange-800";case"executive":return"bg-indigo-100 text-indigo-800";case"team leader":return"bg-teal-100 text-teal-800";case"team-leader":return"bg-teal-100 text-teal-800";default:return"bg-gray-100 text-gray-800"}},We=xe=>xe==null?"":new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0}).format(xe),pe=xe=>{if(!xe)return"N/A";if(typeof xe=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(xe)){const[Ee,Ke,Xe]=xe.split("-");return new Date(Number(Ee),Number(Ke)-1,Number(Xe)).toLocaleDateString()}return"N/A"},O=i.role||[],Ie=T==="all"?O:[],ze=Ll.find(xe=>xe.id===T);return l.useEffect(()=>{m.length>0&&(console.log("Available roles in data:",[...new Set(m.map(xe=>xe.role))]),console.log("Team leader users:",m.filter(xe=>C(xe.role)==="team leader"||C(xe.role)==="team-leader")))},[m]),e.jsxs("div",{className:"space-y-6",children:[M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Create ",L==="buyer"?"Buyer":"Seller"," Account"]}),e.jsxs("form",{onSubmit:xe=>{xe.preventDefault();const Ee=new FormData(xe.target),Ke={salutation:Ee.get("salutation")||(I==null?void 0:I.salutation)||"",first_name:Ee.get("first_name")||(I==null?void 0:I.first_name)||"",last_name:Ee.get("last_name")||(I==null?void 0:I.last_name)||"",email:Ee.get("email")||(I==null?void 0:I.email)||"",phone:Ee.get("phone")||(I==null?void 0:I.phone)||"",username:Ee.get("username")||(I==null?void 0:I.username)||"",password:Ee.get("password"),dob:Ee.get("dob")||(I==null?void 0:I.dob)||"",buyer_id:(I==null?void 0:I.buyer_id)??null,seller_id:(I==null?void 0:I.seller_id)??null};ee(Ke)},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salutation"}),e.jsxs("select",{name:"salutation",defaultValue:(I==null?void 0:I.salutation)||"",className:"w-full px-3 py-2 border rounded",children:[e.jsx("option",{value:"",children:"-- Select --"}),e.jsx("option",{value:"Mr",children:"Mr"}),e.jsx("option",{value:"Mrs",children:"Mrs"}),e.jsx("option",{value:"Ms",children:"Ms"}),e.jsx("option",{value:"Dr",children:"Dr"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{name:"first_name",defaultValue:(I==null?void 0:I.first_name)||"",required:!0,className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{name:"last_name",defaultValue:(I==null?void 0:I.last_name)||"",required:!0,className:"w-full px-3 py-2 border rounded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",name:"email",defaultValue:(I==null?void 0:I.email)||"",required:!0,className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{name:"phone",defaultValue:(I==null?void 0:I.phone)||"",className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),e.jsx("input",{name:"username",defaultValue:(I==null?void 0:I.username)||"",className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"dob",defaultValue:(I==null?void 0:I.dob)||"",className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx("input",{name:"password",type:"password",required:!0,className:"w-full px-3 py-2 border rounded"})]}),(I==null?void 0:I.buyer_id)&&e.jsx("input",{type:"hidden",name:"buyer_id",value:String(I.buyer_id)}),(I==null?void 0:I.seller_id)&&e.jsx("input",{type:"hidden",name:"seller_id",value:String(I.seller_id)})]}),e.jsxs("div",{className:"flex justify-end space-x-1 mt-6 ",children:[e.jsx(ss,{type:"button",variant:"outline",onClick:()=>{A(!1),H(null)},children:"Cancel"}),e.jsx(ss,{type:"submit",disabled:h,children:h?"Creating...":"Create Account"})]})]})]})}),E&&W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Share User Details"}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-gray-900 text-sm mb-2",children:[W.salutation?W.salutation+" ":"",W.first_name," ",W.last_name]}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",W.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",W.username||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Password:"})," ",ue(W.id)||"Not available"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Role:"})," ",r("role",W.role)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsxs("button",{onClick:U,className:"flex items-center justify-center space-x-1 px-3 py-2 bg-blue-600 text-white rounded-lg text-xs",children:[e.jsx(Ds,{className:"h-3 w-3"}),e.jsx("span",{children:"Email"})]}),e.jsxs("button",{onClick:X,className:"flex items-center justify-center space-x-1 px-3 py-2 bg-green-600 text-white rounded-lg text-xs",children:[e.jsx(tt,{className:"h-3 w-3"}),e.jsx("span",{children:"WhatsApp"})]}),e.jsxs("button",{onClick:re,className:"flex items-center justify-center space-x-1 px-3 py-2 bg-purple-600 text-white rounded-lg text-xs",children:[e.jsx(Cs,{className:"h-3 w-3"}),e.jsx("span",{children:"SMS"})]}),e.jsxs("button",{onClick:fe,className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gray-600 text-white rounded-lg text-xs",children:[e.jsx(Xt,{className:"h-3 w-3"}),e.jsx("span",{children:"Copy"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>{V(!1),B(null)},children:"Close"})})]})}),e.jsx("nav",{className:"flex -mx-4 px-4 sm:mx-0 sm:px-0 overflow-x-auto scrollbar-hide","aria-label":"Tabs",children:e.jsx("div",{className:"flex gap-3 sm:gap-8 min-w-full sm:min-w-0",children:Ll.map(xe=>{const Ee=T===xe.id,Ke=Fe[xe.id]||0,Xe=xe.id==="all"?Ns:Wr;return e.jsxs("button",{onClick:()=>J(xe.id),"aria-current":Ee?"page":void 0,className:["shrink-0 flex items-center gap-2","py-2.5 sm:py-3 px-2 sm:px-1","border-b-2",Ee?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","font-medium text-sm","focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-400/50 rounded"].join(" "),children:[e.jsx(Xe,{className:"h-4 w-4 sm:h-4 sm:w-4"}),e.jsx("span",{className:"whitespace-nowrap",children:xe.name}),e.jsx("span",{className:["rounded-full px-2 py-0.5 text-[10px] sm:text-xs font-semibold",Ee?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"].join(" "),children:Ke})]},xe.id)})})}),R&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-blue-800 font-medium",children:[y.length," user(s) selected"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>je("activate"),children:"Activate"}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>je("deactivate"),children:"Deactivate"}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>je("delete"),className:"text-red-600",children:"Delete"}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>{k([]),F(!1)},children:"Cancel"})]})]})}),e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-1.5 lg:space-y-0 lg:space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(it,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3 w-3 text-gray-400"}),e.jsx("input",{value:f,onChange:xe=>p(xe.target.value),placeholder:"Search users by name, email, or username...",className:"w-full pl-7 pr-2 py-1 text-xs border border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"flex space-x-1.5",children:[T==="all"&&e.jsxs("select",{value:N,onChange:xe=>P(xe.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded-md",disabled:n,children:[e.jsx("option",{value:"all",children:"All Roles"}),Ie.map(xe=>e.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),e.jsxs("select",{value:w,onChange:xe=>$(xe.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded-md",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[T!=="buyers"&&T!=="sellers"&&e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:oe.length>0&&y.length===oe.map(xe=>xe.id).filter(Boolean).length,onChange:Le})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Performance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dates"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:oe.length>0?oe.map(xe=>{var Ke,Xe;const Ee=(T==="buyers"||T==="sellers")&&Q(xe.id,T==="buyers"?"buyer":"seller");return e.jsxs("tr",{className:"hover:bg-gray-50",children:[T!=="buyers"&&T!=="sellers"&&e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:y.some(ye=>String(ye)===String(xe.id)),onChange:()=>$e(xe.id)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[xe.avatar?e.jsx("img",{src:String(xe.avatar),alt:`${xe.first_name} avatar`,className:"h-10 w-10 rounded-full object-cover"}):e.jsx("div",{className:"h-10 w-10 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:((((Ke=xe.first_name)==null?void 0:Ke[0])||"")+(((Xe=xe.last_name)==null?void 0:Xe[0])||"")).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[xe.salutation?xe.salutation+" ":"",xe.first_name," ",xe.last_name]}),xe.username&&e.jsx("p",{className:"text-sm text-gray-500",children:xe.username}),xe.dob&&e.jsxs("p",{className:"text-xs text-gray-400",children:["DOB: ",pe(xe.dob)]}),(T==="buyers"||T==="sellers")&&e.jsx("p",{className:`text-xs ${Ee?"text-green-600":"text-orange-600"}`,children:Ee?"âœ“ Account Created":"â—‹ No Account"}),xe.username&&e.jsxs("p",{className:"text-sm text-gray-500",children:["id:",xe.id]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900",children:xe.email})]}),xe.phone&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900",children:xe.phone})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full capitalize ${Pe(xe.role)}`,children:r("role",xe.role)||xe.role}),xe.department&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Dept: ",e.jsxs("span",{className:"capitalize",children:[" ",xe.department," "]})]}),xe.designation&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Desig: ",xe.designation]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[xe.is_active?e.jsx(bs,{className:"h-4 w-4 text-green-500"}):e.jsx(Ta,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:`text-sm ${xe.is_active?"text-green-700":"text-red-700"}`,children:xe.is_active?"Active":"Inactive"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[e.jsxs("div",{children:[xe.total_leads||0," leads"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[xe.total_properties||0," properties"]}),xe.total_revenue!==void 0&&xe.total_revenue!==null?e.jsxs("div",{className:"text-xs text-gray-500",children:[We(xe.total_revenue)," revenue"]}):null]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-xs text-gray-900 space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{className:"h-3 w-3 text-gray-400"}),e.jsxs("span",{children:["Created: ",xe.created_at?new Date(xe.created_at).toLocaleDateString():"N/A"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(jt,{className:"h-3 w-3 text-gray-400"}),e.jsxs("span",{children:["Last Login: ",xe.last_login?new Date(xe.last_login).toLocaleDateString():"Never"]})]})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:T==="buyers"||T==="sellers"?e.jsx("div",{className:"flex items-center justify-end space-x-2",children:e.jsxs(ss,{onClick:()=>ge(T==="buyers"?"buyer":"seller",he(xe)),size:"sm",disabled:Ee,className:`${Ee?"bg-gray-300 text-gray-500 cursor-not-allowed hover:bg-gray-300":"bg-green-600 hover:bg-green-700 text-white"}`,children:[e.jsx(fs,{className:"h-3 w-3 mr-1"}),Ee?"Account Exists":"Create Account"]})}):e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsxs("div",{children:[e.jsx(ss,{variant:"outline",size:"sm",children:e.jsx(ks,{className:"h-3 w-3"})}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>s(xe),children:e.jsx(ft,{className:"h-3 w-3"})}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>de(xe),className:"text-blue-600",children:e.jsx(ja,{className:"h-3 w-3"})})]}),e.jsxs("div",{children:[e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>_e(xe.id,xe.is_active),className:xe.is_active?"text-red-600":"text-green-600",children:xe.is_active?"Deactivate":"Activate"}),e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>ve(xe.id),className:"text-red-600",children:e.jsx(Es,{className:"h-3 w-3"})})]})]})})]},String(xe.id))}):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Wr,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:T==="buyers"||T==="sellers"?`No ${T} data found`:"No users found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:f||N!=="all"||w!=="all"?"Try adjusting filters":"No data to display"}),(ze==null?void 0:ze.showCreateButton)&&e.jsxs(ss,{onClick:()=>ge(T.includes("buyer")?"buyer":"seller"),children:[e.jsx(fs,{className:"h-4 w-4"})," ",ze.createButtonText]})]})})})})]})})})]})},lb=()=>{const{user:s}=Hs(),[a,t]=l.useState(!1),[r,i]=l.useState(null),[n,o]=l.useState({username:"",email:"",first_name:"",last_name:"",salutation:"",password:"",role:"",phone:"",designation:"",department:"",dob:"",blood_group:"",buyer_id:null,seller_id:null}),[m,g]=l.useState({}),[b,d]=l.useState({}),[v,x]=l.useState(!0),[u,c]=l.useState(0),[f,p]=l.useState(""),[N,P]=l.useState(!1),w=M=>{if(M==null||M==="")return null;if(typeof M=="number")return Number.isNaN(M)?null:M;if(typeof M=="string"){const L=M.trim();if(/^-?\d+$/.test(L)){const D=Number(L);return Number.isNaN(D)?L:D}return L}const A=Number(M);return Number.isNaN(A)?null:A},$=async({role:M,prefill:A})=>{E(),o(L=>({...L,role:M,email:(A==null?void 0:A.email)??"",first_name:(A==null?void 0:A.first_name)??"",last_name:(A==null?void 0:A.last_name)??"",salutation:(A==null?void 0:A.salutation)??"",phone:(A==null?void 0:A.phone)??"",username:(A==null?void 0:A.username)??"",dob:(A==null?void 0:A.dob)??"",buyer_id:(A==null?void 0:A.buyer_id)??(M==="buyer"?(A==null?void 0:A.id)??null:null),seller_id:(A==null?void 0:A.seller_id)??(M==="seller"?(A==null?void 0:A.id)??null:null)})),i(null),t(!0)};l.useEffect(()=>{(async()=>{try{x(!0);const A=await Gt(["common"]);d(A)}catch(A){console.error("Error fetching master options:",A)}finally{x(!1)}})()},[]);const y=(M,A)=>{if(!A)return"";const D=(b[M]||[]).find(I=>I.value===A);return D?D.label:A},k=(M,A)=>{if(!A)return"";const D=(b[M]||[]).find(I=>I.label===A);return D?D.value:A||""},R=()=>{const A="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";let L="";for(let D=0,I=A.length;D<8;++D)L+=A.charAt(Math.floor(Math.random()*I));return L},F=(M=!1)=>{var L,D;const A={};if(n.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(A.email="Please enter a valid email address"):A.email="Email is required",!M&&!n.password?A.password="Password is required":n.password&&n.password.length<6&&(A.password="Password must be at least 6 characters long"),(L=n.first_name)!=null&&L.trim()||(A.first_name="First name is required"),(D=n.last_name)!=null&&D.trim()||(A.last_name="Last name is required"),n.role||(A.role="Role is required"),n.salutation||(A.salutation="Salutation is required"),n.username&&n.username.length<3&&(A.username="Username must be at least 3 characters long"),!n.dob)A.dob="Date of birth is required";else{const I=new Date(n.dob),H=new Date;if(I>H)A.dob="Date of birth cannot be in future";else{let h=H.getFullYear()-I.getFullYear();const Y=H.getMonth()-I.getMonth();(Y<0||Y===0&&H.getDate()<I.getDate())&&h--,h<18&&(A.dob="User must be at least 18 years old")}}return g(A),Object.keys(A).length===0},T=async()=>{var A,L;const M=!!r;if(F(M))try{const D={...n,username:n.username||null,phone:n.phone||null,salutation:n.salutation?y("salutation",n.salutation):null,designation:n.designation?y("designation",n.designation):null,department:n.department?y("department",n.department):null,role:n.role?y("role",n.role):n.role,blood_group:n.blood_group?y("blood groups",n.blood_group):null,dob:n.dob||null,buyer_id:w(n.buyer_id??null),seller_id:w(n.seller_id??null)};M&&!n.password&&delete D.password;let I;M?I=await Os.updateUser(r.id,D):I=await Os.createUser({...D,is_active:!0}),I.success?(Z.success(`User ${M?"updated":"created"} successfully`),n.password&&(p(n.password),P(!0)),E(),t(!1),c(H=>H+1)):Z.error(I.message||`Failed to ${M?"update":"create"} user`)}catch(D){if(console.error(`âŒ Error ${M?"updating":"creating"} user:`,D.message),(L=(A=D==null?void 0:D.response)==null?void 0:A.data)!=null&&L.message){const I=D.response.data.message;I.includes("email already exists")?g({email:"A user with this email already exists"}):I.includes("username already exists")?g({username:"A user with this username already exists"}):Z.error(I)}else Z.error(`Failed to ${M?"update":"create"} user. Please try again.`)}},j=M=>{i(M);let A="";if(M.dob){const L=new Date(M.dob);isNaN(L.getTime())||(A=L.toISOString().split("T")[0])}o({username:M.username||"",email:M.email,first_name:M.first_name,last_name:M.last_name,password:"",salutation:k("salutation",M.salutation||""),role:k("role",M.role),phone:M.phone||"",designation:k("designation",M.designation||""),department:k("department",M.department||""),dob:A,blood_group:k("blood groups",M.blood_group||""),buyer_id:M.buyer_id??null,seller_id:M.seller_id??null}),t(!0)},E=()=>{o({username:"",email:"",first_name:"",last_name:"",salutation:"",password:"",role:"",phone:"",designation:"",department:"",dob:"",blood_group:"",buyer_id:null,seller_id:null}),i(null),g({}),p(""),P(!1)},V=(M,A)=>{o(L=>({...L,[M]:A})),m[M]&&g(L=>({...L,[M]:""}))},W=()=>{const M=R();o(A=>({...A,password:M}))},B=async()=>{var M,A;try{const L=await Os.exportUsers(),D=new Blob([L.data],{type:"text/csv"}),I=window.URL.createObjectURL(D),H=document.createElement("a");H.href=I,H.download=`users-export-${new Date().toISOString().split("T")[0]}.csv`,H.click(),window.URL.revokeObjectURL(I),Z.success("Users exported successfully")}catch(L){console.error("Error exporting users:",L),Z.error(((A=(M=L==null?void 0:L.response)==null?void 0:M.data)==null?void 0:A.message)||"Failed to export users")}};return e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600 mt-1 text-xs sm:text-sm",children:"Manage users, roles, and permissions"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs(ss,{variant:"outline",onClick:B,className:"flex-1 sm:flex-none flex items-center justify-center space-x-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]}),e.jsxs(ss,{variant:"outline",className:"flex-1 sm:flex-none flex items-center justify-center space-x-2",children:[e.jsx(dt,{className:"h-4 w-4"}),e.jsx("span",{children:"Import"})]}),e.jsx(Bs,{to:"/dashboard/settings/roles-permissions",className:"flex-1 sm:flex-none",children:e.jsxs(ss,{variant:"outline",className:"w-full sm:w-auto flex items-center justify-center space-x-2",children:[e.jsx(at,{className:"h-4 w-4"}),e.jsx("span",{children:"Manage Roles"})]})}),e.jsxs(ss,{onClick:()=>{E(),t(!0)},className:"flex-1 sm:flex-none flex items-center justify-center space-x-2",disabled:v,children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:"Add User"})]})]})]}),e.jsx(rb,{onEditUser:j,refreshTrigger:u,getLabelFromValue:y,masters:b,masterLoading:v,onCreateUser:$}),e.jsx(ab,{visible:a,onClose:()=>{t(!1),E()},onSubmit:T,editingUser:r,newUser:n,setNewUser:M=>o(M),formErrors:m,handleInputChange:V,handleGeneratePassword:W,showPassword:!1,setShowPassword:()=>{},masterLoading:v,masters:b,submitDisabled:!1}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:r?"User Updated Successfully!":"User Created Successfully!"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r?"The new password for this user is:":"The password for this user is:"}),e.jsx("div",{className:"bg-gray-100 p-3 rounded border",children:e.jsx("code",{className:"text-lg font-mono text-gray-900",children:f})}),e.jsx("p",{className:"text-xs text-red-600 mt-2",children:"Please save this password securely. It will not be shown again."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ss,{onClick:()=>P(!1),size:"sm",children:"Got it"})})]})})]})},nb=s=>{if(!s)return"";const a=new Date(s);if(isNaN(a.getTime()))return"";const t=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),i=String(a.getDate()).padStart(2,"0");return`${t}-${r}-${i}`},tm=()=>{var L,D;const{user:s,updateUser:a}=Hs(),{systemSettings:t,loading:r,updateSystemSettings:i,saveSystemSettings:n}=ur(),[o,m]=l.useState(null),[g,b]=l.useState(!0),[d,v]=l.useState(!1),[x,u]=l.useState(!1),[c,f]=l.useState("profile"),[p,N]=l.useState({current_password:"",new_password:"",confirm_password:""}),[P,w]=l.useState({roles:[],departments:[]});l.useEffect(()=>{k(),y()},[]);const $=I=>{if(!I)return null;const H=new Date(I);if(isNaN(H.getTime()))return null;const h=H.getFullYear(),Y=String(H.getMonth()+1).padStart(2,"0"),K=String(H.getDate()).padStart(2,"0");return`${h}-${Y}-${K}`},y=async()=>{try{const I=await Nt.getAllMasterTypes("common"),H=await Promise.all(I.map(Y=>Nt.getMasterValues(Y.id))),h={};I.forEach((Y,K)=>{const ne=(H[K]||[]).map(le=>({value:String(le.id),label:le.value||le.name||"Unknown"}));h[(Y.name||"").toLowerCase()]=ne}),w({roles:h.role||[],departments:h.department||[]})}catch(I){console.error("Failed to load master data:",I),console.error("Failed to load dropdown options")}},k=async()=>{try{const I=await Os.getProfile();if(I!=null&&I.success){const H={...I.data,id:String(I.data.id??""),dob:nb(I.data.dob),email:I.data.email??"",first_name:I.data.first_name??"",last_name:I.data.last_name??"",phone:I.data.phone??"",avatar:I.data.avatar??void 0,designation:I.data.designation??"",department:I.data.department??"",role:I.data.role??"",timezone:I.data.timezone??"UTC",language:I.data.language??"en",email_notifications:!!I.data.email_notifications,sms_notifications:!!I.data.sms_notifications,push_notifications:!!I.data.push_notifications};m(H)}else I!=null&&I.data&&m(I.data)}catch(I){console.error("Error fetching user profile:",I),Z.error("Failed to load profile")}finally{b(!1)}},R=async()=>{if(o)try{v(!0);const I={...o};I.dob&&(I.dob=$(I.dob));const H=await Os.updateProfile(I);H!=null&&H.success?(Z.success("Profile updated successfully"),m({...o,...H.data}),a({first_name:H.data.first_name||(s==null?void 0:s.first_name),last_name:H.data.last_name||(s==null?void 0:s.last_name),role:H.data.role||(s==null?void 0:s.role),avatar:H.data.avatar||(s==null?void 0:s.avatar)})):Z.error((H==null?void 0:H.message)||"Failed to update profile")}catch(I){console.error("Error updating profile:",I),Z.error("Failed to update profile")}finally{v(!1)}},F=async I=>{var Y,K;if(!I)return;if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(I.type)){Z.error("Please upload a valid image file (JPG, PNG, GIF)");return}const h=5*1024*1024;if(I.size>h){Z.error("File size must be less than 5MB");return}try{u(!0);const q=new FormData;q.append("avatar",I);const ne=await Os.uploadAvatar(q);if(ne!=null&&ne.success){const le={...o,avatar:`${ne.data.avatar}?t=${Date.now()}`};m(le),a({avatar:le.avatar}),Z.success("Profile picture updated successfully")}else Z.error((ne==null?void 0:ne.message)||"Failed to upload profile picture")}catch(q){console.error("Error uploading avatar:",q),Z.error(((K=(Y=q==null?void 0:q.response)==null?void 0:Y.data)==null?void 0:K.message)||"Failed to upload profile picture")}finally{u(!1)}},T=async()=>{var I,H;if(o!=null&&o.avatar)try{u(!0);const h=await Os.removeAvatar();if(h!=null&&h.success){const Y={...o,avatar:void 0};m(Y),a({avatar:void 0}),Z.success("Profile picture removed successfully")}else Z.error((h==null?void 0:h.message)||"Failed to remove profile picture")}catch(h){console.error("Error removing avatar:",h),Z.error(((H=(I=h==null?void 0:h.response)==null?void 0:I.data)==null?void 0:H.message)||"Failed to remove profile picture")}finally{u(!1)}},j=async()=>{var I,H;if(p.new_password!==p.confirm_password){Z.error("Passwords do not match");return}try{v(!0);const h=await Os.changePassword({current_password:p.current_password,new_password:p.new_password});h!=null&&h.success?(Z.success("Password changed successfully"),N({current_password:"",new_password:"",confirm_password:""})):Z.error((h==null?void 0:h.message)||"Failed to change password")}catch(h){console.error("Error changing password:",h),Z.error(((H=(I=h==null?void 0:h.response)==null?void 0:I.data)==null?void 0:H.message)||"Failed to change password")}finally{v(!1)}},E=async()=>{if(t)try{v(!0),await n(),Z.success("System settings updated successfully")}catch(I){console.error("Error updating system settings:",I),Z.error("Failed to update system settings")}finally{v(!1)}},V=async(I,H)=>{if(t)try{const h=new FormData;h.append(H,I),Object.keys(t).forEach(K=>{if(K===H)return;const q=t[K];if(q!=null){if(typeof q=="object")return;h.append(K,String(q))}});const Y=await _r.saveSettings(h);if(Y!=null&&Y.success){i({[H]:`${Y.data[H]}?t=${Date.now()}`});let K="";switch(H){case"company_logo":K="Company logo updated successfully";break;case"company_favicon":K="Favicon updated successfully";break;case"footer_logo":K="Footer logo updated successfully";break}Z.success(K)}else Z.error((Y==null?void 0:Y.message)||"File upload failed")}catch(h){console.error("File upload error:",h),Z.error("Error uploading file")}},W=async I=>{try{const H=new FormData;let h="";switch(I){case"company_logo":h="remove_logo";break;case"company_favicon":h="remove_favicon";break;case"footer_logo":h="remove_footer_logo";break}H.append(h,"true");const Y=await _r.saveSettings(H);if(Y!=null&&Y.success){i({[I]:null});let K="";switch(I){case"company_logo":K="Company logo removed";break;case"company_favicon":K="Favicon removed";break;case"footer_logo":K="Footer logo removed";break}Z.info(K)}else Z.error((Y==null?void 0:Y.message)||"Failed to remove file")}catch(H){console.error("Error removing file:",H),Z.error("Error removing file")}};if(g||r)return e.jsx("div",{className:"min-h-screen flex justify-center items-center bg-gradient-to-br from-slate-50 to-slate-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ia,{size:"lg"}),e.jsx("p",{className:"mt-4 text-slate-600 font-medium",children:"Loading settings..."})]})});const B=[{title:"Master Data",description:"Manage system data and configurations",icon:Vr,color:"blue",href:"/dashboard/settings/master-data"},{title:"Import/Export",description:"Data import and export tools",icon:Ys,color:"green",href:"/dashboard/settings/import-export"},{title:"AI Settings",description:"Configure AI features and automation",icon:Ft,color:"purple",href:"/dashboard/settings/ai-settings"},{title:"User Management",description:"Manage users and their permissions",icon:Ns,color:"orange",href:"/dashboard/users"}],M={blue:"bg-gradient-to-r from-blue-500 to-blue-600",green:"bg-gradient-to-r from-green-500 to-green-600",purple:"bg-gradient-to-r from-purple-500 to-purple-600",orange:"bg-gradient-to-r from-orange-500 to-orange-600"},A=[{id:"profile",label:"Profile",icon:Ms},{id:"notifications",label:"Notifications",icon:ha},{id:"security",label:"Security",icon:Gr},...(s==null?void 0:s.role)==="admin"?[{id:"system",label:"System",icon:Yt}]:[]];return e.jsx("div",{className:"",children:e.jsxs("div",{className:"max-w-8xl mx-auto space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-600 rounded-2xl shadow-2xl p-6 border border-white/20",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsx("div",{className:"space-y-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-10 w-10 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center shadow-md",children:e.jsx(Yt,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white leading-tight",children:"Settings"}),e.jsx("p",{className:"text-xs text-white/90 font-medium",children:"Manage your account and system preferences"})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Bs,{to:"/dashboard/settings/roles-permissions",children:e.jsxs(ss,{variant:"outline",className:"flex items-center space-x-1 bg-white/20 hover:bg-white/30 text-sm text-white border-white/30 hover:border-white/50 transition-all duration-200 px-3 py-1.5 h-auto",children:[e.jsx(at,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Roles & Permissions"})]})}),e.jsx(Bs,{to:"/dashboard/settings/integrations",children:e.jsxs(ss,{variant:"outline",className:"flex items-center space-x-1 bg-white/20 hover:bg-white/30 text-sm text-white border-white/30 hover:border-white/50 transition-all duration-200 px-3 py-1.5 h-auto",children:[e.jsx(Ft,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Integrations"})]})})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:B.map((I,H)=>e.jsx(Bs,{to:I.href,className:"group bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg hover:shadow-2xl border border-white/20 p-3 sm:p-4 transition-all duration-300 hover:-translate-y-1",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`h-10 w-10 ${M[I.color]} rounded-lg flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-200`,children:e.jsx(I.icon,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-slate-900 group-hover:text-blue-600 transition-colors",children:I.title}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-600 line-clamp-2",children:I.description})]}),e.jsx(la,{className:"h-4 w-4 text-slate-400 opacity-0 group-hover:opacity-100 group-hover:text-blue-500 group-hover:translate-x-1 transition-all duration-200"})]})},H))}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b border-slate-200/50",children:e.jsx("nav",{className:"flex overflow-x-auto",children:A.map(I=>e.jsx("button",{onClick:()=>f(I.id),className:`flex-shrink-0 px-6 py-4 font-medium text-sm md:text-base transition-all duration-200 border-b-[3px] ${c===I.id?"border-blue-500 text-blue-600 bg-white shadow-sm":"border-transparent text-slate-600 hover:text-slate-900 hover:bg-white/40 rounded-t-md"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I.icon,{className:"h-4 w-4"}),e.jsx("span",{children:I.label})]})},I.id))})}),e.jsxs("div",{className:"p-8",children:[c==="profile"&&o&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-6 mb-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"h-28 w-28 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-lg overflow-hidden",children:[o.avatar?e.jsx("img",{src:o.avatar,alt:`${o.first_name||"User"}'s avatar`,className:"h-full w-full rounded-full object-cover"},o.avatar):e.jsx(Ms,{className:"h-12 w-12 text-white"}),x&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-full","aria-live":"polite",children:e.jsx(ia,{size:"sm"})})]}),e.jsxs("label",{className:"absolute -bottom-1 right-0 transform translate-y-1/2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white border border-slate-200 px-3 py-1.5 rounded-full shadow-sm text-sm hover:shadow-md transition",children:[e.jsx(Sa,{className:"h-4 w-4 text-slate-600"}),e.jsx("span",{className:"text-slate-700 font-medium",children:"Change"})]}),e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&F(H)},className:"sr-only",disabled:x})]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:"Profile Information"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Keep your personal details up to date so your account and notifications are correct."}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-4",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-50 hover:bg-blue-100 text-blue-600 px-3 py-2 rounded-lg text-sm font-medium transition-colors border border-blue-200 hover:border-blue-300",children:[e.jsx(dt,{className:"h-4 w-4"}),x?"Uploading...":"Upload Photo"]}),e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&F(H)},className:"hidden",disabled:x})]}),o.avatar&&e.jsxs("button",{onClick:T,disabled:x,className:"inline-flex items-center gap-2 bg-red-50 hover:bg-red-100 text-red-600 px-3 py-2 rounded-lg text-sm font-medium transition-colors border border-red-200 hover:border-red-300",children:[e.jsx(ns,{className:"h-4 w-4"}),"Remove"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Recommended: at least 200Ã—200 px. Max 5MB. Supported: JPG, PNG, GIF."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[[{label:"First name",value:o.first_name??"",key:"first_name",type:"text",placeholder:"John"},{label:"Last name",value:o.last_name??"",key:"last_name",type:"text",placeholder:"Doe"},{label:"Email",value:o.email??"",key:"email",type:"email",placeholder:"you@example.com",readOnly:!0},{label:"Phone",value:o.phone??"",key:"phone",type:"tel",placeholder:"+1 555 555 555"},{label:"Designation",value:o.designation??"",key:"designation",type:"text",placeholder:"Product Manager"}].map(I=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:I.label}),e.jsx("input",{type:I.type,value:I.value,readOnly:I.readOnly,placeholder:I.placeholder,onChange:H=>m({...o,[I.key]:H.target.value}),className:`w-full border border-slate-300 rounded-lg px-3 py-2 text-sm outline-blue-600 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/60 ${I.readOnly?"opacity-70 cursor-not-allowed":""}`,"aria-label":I.label})]},I.key)),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Department"}),e.jsxs("select",{value:((L=P.departments.find(I=>I.label===o.department))==null?void 0:L.value)||"",onChange:I=>{var H;return m({...o,department:((H=P.departments.find(h=>h.value===I.target.value))==null?void 0:H.label)||""})},className:"w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/60 appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Select Department"}),P.departments.map(I=>e.jsx("option",{value:I.value,children:I.label},I.value))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Date of Birth"}),e.jsx("input",{type:"date",value:(o==null?void 0:o.dob)??"",onChange:I=>m({...o,dob:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Role"}),e.jsxs("select",{value:((D=P.roles.find(I=>I.label===o.role))==null?void 0:D.value)||"",onChange:I=>{var H;return m({...o,role:((H=P.roles.find(h=>h.value===I.target.value))==null?void 0:H.label)||""})},className:"w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/60 appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"Select Role"}),P.roles.map(I=>e.jsx("option",{value:I.value,children:I.label},I.value))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Timezone"}),e.jsxs("select",{value:o.timezone,onChange:I=>m({...o,timezone:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/60 appearance-none cursor-pointer",children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"America/New_York",children:"Eastern Time"}),e.jsx("option",{value:"America/Chicago",children:"Central Time"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),e.jsx("option",{value:"Asia/Kolkata",children:"India Standard Time"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Language"}),e.jsxs("select",{value:o.language,onChange:I=>m({...o,language:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white/60 appearance-none cursor-pointer",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"hi",children:"Hindi"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 pt-6 border-t border-slate-200",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(ss,{onClick:R,disabled:d||x,className:"inline-flex items-center bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white shadow-lg hover:shadow-xl rounded-xl px-4 py-2 transition",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),d?"Saving...":"Save changes"]}),e.jsxs(ss,{variant:"outline",onClick:()=>{k(),y()},disabled:d||x,className:"inline-flex items-center border-slate-300 hover:border-slate-400 hover:bg-slate-50 rounded-xl px-4 py-2 transition",children:[e.jsx(pc,{className:"h-4 w-4 mr-2"}),"Reset"]})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Changes are saved to your account. Email is not editable here â€” contact admin to update email."})]})]}),c==="notifications"&&o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Notification Preferences"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Choose how you want to receive notifications"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{icon:Ds,title:"Email Notifications",description:"Receive notifications via email",checked:o.email_notifications,key:"email_notifications",color:"text-blue-500"},{icon:Ui,title:"SMS Notifications",description:"Receive notifications via SMS",checked:o.sms_notifications,key:"sms_notifications",color:"text-green-500"},{icon:ha,title:"Push Notifications",description:"Receive browser push notifications",checked:o.push_notifications,key:"push_notifications",color:"text-purple-500"}].map(I=>e.jsx("div",{className:"bg-white/50 rounded-lg p-4 border border-slate-200 hover:border-slate-300 transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-slate-100 flex items-center justify-center",children:e.jsx(I.icon,{className:`h-4 w-4 ${I.color}`})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-slate-900",children:I.title}),e.jsx("p",{className:"text-xs text-slate-600",children:I.description})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:I.checked,onChange:H=>m({...o,[I.key]:H.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-10 h-5 bg-slate-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]})},I.key))}),e.jsx("div",{className:"flex pt-4 border-t border-slate-200",children:e.jsxs(ss,{onClick:R,disabled:d,className:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white shadow-md hover:shadow-lg transition-all duration-200 text-xs px-3 py-2",children:[e.jsx(ut,{className:"h-3.5 w-3.5 mr-1"}),d?"Saving...":"Save Preferences"]})})]}),c==="security"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Security Settings"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Manage your password and security preferences"})]}),e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(at,{className:"h-5 w-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-800 text-sm",children:"Security Tip"}),e.jsx("p",{className:"text-amber-700 text-xs leading-snug",children:"Use a strong password with at least 8 characters, including uppercase, lowercase, numbers, and symbols."})]})]})}),e.jsxs("div",{className:"bg-white/50 rounded-lg p-4 border border-slate-200",children:[e.jsx("h4",{className:"text-base font-semibold text-slate-900 mb-4",children:"Change Password"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:p.current_password,onChange:I=>N({...p,current_password:I.target.value}),placeholder:"Enter current password",className:`w-full border border-slate-400 rounded-lg px-3 py-2 text-sm outline-blue-600\r
                       focus:border-blue-600 focus:ring-1 focus:ring-blue-600\r
                       transition-all bg-white/50`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:p.new_password,onChange:I=>N({...p,new_password:I.target.value}),placeholder:"Enter new password",className:`w-full border border-slate-400 rounded-lg px-3 py-2 text-sm outline-blue-600\r
                       focus:border-blue-600 focus:ring-1 focus:ring-blue-600\r
                       transition-all bg-white/50`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:p.confirm_password,onChange:I=>N({...p,confirm_password:I.target.value}),placeholder:"Confirm new password",className:`w-full border border-slate-400 rounded-lg px-3 py-2 text-sm outline-blue-600\r
                       focus:border-blue-600 focus:ring-1 focus:ring-blue-600\r
                       transition-all bg-white/50`})]})]})]}),e.jsx("div",{className:"flex pt-4 border-t border-slate-200",children:e.jsxs(ss,{onClick:j,disabled:d||!p.current_password||!p.new_password||!p.confirm_password,className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-md hover:shadow-lg transition-all text-xs px-3 py-2",children:[e.jsx(Gr,{className:"h-3.5 w-3.5 mr-1"}),d?"Changing...":"Change Password"]})})]}),c==="system"&&(s==null?void 0:s.role)==="admin"&&t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:"System Configuration"}),e.jsx("p",{className:"text-slate-700 text-xs",children:"Configure global system settings and preferences"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/50 rounded-lg p-4 border border-slate-200 space-y-4 hover:outline hover:outline-1 hover:outline-blue-300 transition-all duration-150",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-900 flex items-center gap-1",children:[e.jsx(Is,{className:"h-4 w-4 text-blue-500"}),"Company Settings"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:t.company_name||"",onChange:I=>i({company_name:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-xs focus:ring-1 focus:ring-blue-400 focus:outline-none bg-white/50 text-slate-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Currency"}),e.jsxs("select",{value:t.currency||"USD",onChange:I=>i({currency:I.target.value}),className:"w-full border border-slate-300 rounded-lg  px-2 py-1.5 text-xs bg-white/50 cursor-pointer text-slate-900 focus:ring-1 focus:ring-blue-400",children:[e.jsx("option",{value:"INR",children:"INR - Indian Rupee"}),e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"}),e.jsx("option",{value:"CAD",children:"CAD - Canadian Dollar"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Date Format"}),e.jsxs("select",{value:t.date_format||"YYYY-MM-DD",onChange:I=>i({date_format:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-xs bg-white/50 cursor-pointer text-slate-900 focus:ring-1 focus:ring-blue-400",children:[e.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Time Format"}),e.jsxs("select",{value:t.time_format||"24h",onChange:I=>i({time_format:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-xs bg-white/50 cursor-pointer text-slate-900 focus:ring-1 focus:ring-blue-400",children:[e.jsx("option",{value:"12h",children:"12 Hour"}),e.jsx("option",{value:"24h",children:"24 Hour"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Default Language"}),e.jsxs("select",{value:t.default_language||"en",onChange:I=>i({default_language:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-xs bg-white/50 cursor-pointer text-slate-900 focus:ring-1 focus:ring-blue-400",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"hi",children:"Hindi"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Max File Size (MB)"}),e.jsx("input",{type:"number",value:Math.round((t.max_file_size||2097152)/1048576),onChange:I=>i({max_file_size:(parseInt(I.target.value,10)||2)*1048576}),min:1,max:100,className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-xs bg-white/50 text-slate-900 focus:ring-1 focus:ring-blue-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Backup Frequency"}),e.jsxs("select",{value:t.backup_frequency||"daily",onChange:I=>i({backup_frequency:I.target.value}),className:"w-full border border-slate-300 rounded-lg px-2 py-1.5 text-xs bg-white/50 cursor-pointer text-slate-900 focus:ring-1 focus:ring-blue-400",children:[e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white/50 rounded-lg p-4 border border-slate-200 space-y-4 hover:outline hover:outline-1 hover:outline-blue-300 transition-all duration-150",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-900 flex items-center gap-1 focus:ring-1 focus:ring-blue-400",children:[e.jsx(Vc,{className:"h-4 w-4 text-purple-500"}),"Appearance & Branding"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Primary Color"}),e.jsxs("div",{className:"flex items-center gap-2 rounded-md border border-slate-300 px-3 py-1 focus-within:ring-1 focus-within:ring-blue-400 transition",children:[e.jsx("input",{type:"color",value:t.primary_color||"#3B82F6",onChange:I=>i({primary_color:I.target.value}),className:"w-10 h-8 rounded-sm border-none p-0 m-0 appearance-none cursor-pointer","aria-label":"Primary color"}),e.jsx("input",{type:"text",value:t.primary_color||"#3B82F6",onChange:I=>i({primary_color:I.target.value}),className:"flex-1 border-none px-2 py-1 text-xs bg-transparent text-slate-900 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Secondary Color"}),e.jsxs("div",{className:"flex items-center gap-2 rounded-md border border-slate-300 px-3 py-1 focus-within:ring-1 focus-within:ring-blue-400 transition",children:[e.jsx("input",{type:"color",value:t.secondary_color||"#10B981",onChange:I=>i({secondary_color:I.target.value}),className:"w-10 h-8 rounded-sm border-none p-0 m-0 appearance-none cursor-pointer","aria-label":"Secondary color"}),e.jsx("input",{type:"text",value:t.secondary_color||"#10B981",onChange:I=>i({secondary_color:I.target.value}),className:"flex-1 border-none px-2 py-1 text-xs bg-transparent text-slate-900 focus:outline-none"})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-2/3 max-w-sm",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1 text-center",children:"Favicon"}),e.jsx("div",{tabIndex:0,className:"border-2 border-dashed border-slate-300 rounded-md p-3 text-center hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-colors",children:t.company_favicon?e.jsxs("div",{className:"space-y-2",children:[e.jsx("img",{src:t.company_favicon,alt:"Favicon",className:"h-6 w-6 mx-auto object-contain"}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("input",{id:"favicon-upload",type:"file",accept:"image/*",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&V(H,"company_favicon")},className:"hidden"}),e.jsx("label",{htmlFor:"favicon-upload",className:"cursor-pointer bg-blue-50 text-blue-600 px-2 py-1 rounded-md text-xs transition-colors hover:bg-blue-100 hover:text-blue-700",children:"Change"}),e.jsx("button",{onClick:()=>W("company_favicon"),className:"bg-red-50 text-red-600 px-2 py-1 rounded-md text-xs transition-colors hover:bg-red-100 hover:text-red-700",children:"Remove"})]})]}):e.jsxs("div",{className:"space-y-2 text-slate-900",children:[e.jsx(dt,{className:"h-5 w-5 text-slate-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("input",{id:"favicon-upload-empty",type:"file",accept:"image/*",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&V(H,"company_favicon")},className:"hidden"}),e.jsx("label",{htmlFor:"favicon-upload-empty",className:"cursor-pointer bg-blue-50 text-blue-600 px-2 py-1 rounded-md text-xs inline-block transition-colors hover:bg-blue-100 hover:text-blue-700",children:"Upload Favicon"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"16x16 or 32x32 px"})]})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Company Logo"}),e.jsx("div",{tabIndex:0,className:"border-2 border-dashed border-slate-300 rounded-md p-3 text-center hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-colors",children:t.company_logo?e.jsxs("div",{className:"space-y-2",children:[e.jsx("img",{src:t.company_logo,alt:"Company Logo",className:"h-10 w-auto mx-auto object-contain"}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("input",{id:"logo-upload",type:"file",accept:"image/*",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&V(H,"company_logo")},className:"hidden"}),e.jsx("label",{htmlFor:"logo-upload",className:"cursor-pointer bg-blue-50 text-blue-600 px-2 py-1 rounded-md text-xs transition-colors hover:bg-blue-100 hover:text-blue-700",children:"Change"}),e.jsx("button",{onClick:()=>W("company_logo"),className:"bg-red-50 text-red-600 px-2 py-1 rounded-md text-xs transition-colors hover:bg-red-100 hover:text-red-700",children:"Remove"})]})]}):e.jsxs("div",{className:"space-y-2 text-slate-900",children:[e.jsx(dt,{className:"h-5 w-5 text-slate-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("input",{id:"logo-upload-empty",type:"file",accept:"image/*",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&V(H,"company_logo")},className:"hidden"}),e.jsx("label",{htmlFor:"logo-upload-empty",className:"cursor-pointer bg-blue-50 text-blue-600 px-2 py-1 rounded-md text-xs inline-block transition-colors hover:bg-blue-100 hover:text-blue-700",children:"Upload Logo"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"PNG/JPG up to 2MB"})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-900 mb-1",children:"Footer Logo"}),e.jsx("div",{tabIndex:0,className:"border-2 border-dashed border-slate-300 rounded-md p-3 text-center hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-colors",children:t.footer_logo?e.jsxs("div",{className:"space-y-2",children:[e.jsx("img",{src:t.footer_logo,alt:"Footer Logo",className:"h-10 w-auto mx-auto object-contain"}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("input",{id:"footer-logo-upload",type:"file",accept:"image/*",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&V(H,"footer_logo")},className:"hidden"}),e.jsx("label",{htmlFor:"footer-logo-upload",className:"cursor-pointer bg-blue-50 text-blue-600 px-2 py-1 rounded-md text-xs transition-colors hover:bg-blue-100 hover:text-blue-700",children:"Change"}),e.jsx("button",{onClick:()=>W("footer_logo"),className:"bg-red-50 text-red-600 px-2 py-1 rounded-md text-xs transition-colors hover:bg-red-100 hover:text-red-700",children:"Remove"})]})]}):e.jsxs("div",{className:"space-y-2 text-slate-900",children:[e.jsx(dt,{className:"h-5 w-5 text-slate-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("input",{id:"footer-logo-upload-empty",type:"file",accept:"image/*",onChange:I=>{var h;const H=(h=I.target.files)==null?void 0:h[0];H&&V(H,"footer_logo")},className:"hidden"}),e.jsx("label",{htmlFor:"footer-logo-upload-empty",className:"cursor-pointer bg-blue-50 text-blue-600 px-2 py-1 rounded-md text-xs inline-block transition-colors hover:bg-blue-100 hover:text-blue-700",children:"Upload Logo"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"PNG/JPG up to 2MB"})]})]})})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white/50 rounded-lg p-4 border border-slate-200 space-y-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-900 flex items-center gap-1",children:[e.jsx(Ft,{className:"h-4 w-4 text-yellow-500"}),"System Features"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[{title:"Auto Assign Leads",description:"Automatically assign new leads to agents",checked:!!t.auto_assign_leads,key:"auto_assign_leads",icon:Ns,color:"text-blue-500"},{title:"Lead Scoring",description:"Enable AI-powered lead scoring",checked:!!t.lead_scoring_enabled,key:"lead_scoring_enabled",icon:Xs,color:"text-yellow-500"},{title:"Property Auto Approval",description:"Automatically approve property listings",checked:!!t.property_auto_approval,key:"property_auto_approval",icon:bs,color:"text-green-500"}].map(I=>e.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-slate-200 hover:border-slate-300 transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-md bg-slate-100 flex items-center justify-center",children:e.jsx(I.icon,{className:`h-4 w-4 ${I.color}`})}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:I.checked,onChange:H=>i({[I.key]:H.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-9 h-5 bg-slate-200 rounded-full peer-checked:bg-blue-600 relative after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:after:translate-x-full"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-slate-900 text-xs",children:I.title}),e.jsx("p",{className:"text-xs text-slate-600",children:I.description})]})]},I.key))})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-slate-200",children:[e.jsxs(ss,{onClick:E,disabled:d,className:"px-3 py-1.5 text-xs bg-gradient-to-r from-green-500 to-green-600 text-white",children:[e.jsx(ut,{className:"h-3 w-3 mr-1"}),d?"Saving...":"Save"]}),e.jsxs(ss,{variant:"outline",onClick:()=>{window.location.reload(),Z.info("System settings refreshed")},disabled:d,className:"px-3 py-1.5 text-xs border-slate-300 hover:bg-slate-50",children:[e.jsx(pc,{className:"h-3 w-3 mr-1"}),"Refresh"]})]})]})]})]})]})})},di={total_users:0,active_users:0,total_properties:0,total_leads:0,system_health:"unknown",recent_activities:0},ib=()=>{const{user:s}=Hs(),[a,t]=l.useState(di),[r,i]=l.useState(!0),[n,o]=l.useState([]);return l.useEffect(()=>{let m=!0,g=!1;const b=u=>{g||(wt.error(u),g=!0)},d=u=>!u||typeof u!="object"?null:(u==null?void 0:u.data)!==void 0?u.data:u,v=u=>{var f;if(!u)return;const c=d(u);if(typeof(c==null?void 0:c.count)=="number")return c.count;if(typeof(c==null?void 0:c.total)=="number")return c.total;if(typeof(c==null?void 0:c.total_count)=="number")return c.total_count;if(typeof((f=c==null?void 0:c.meta)==null?void 0:f.total)=="number")return c.meta.total;if(Array.isArray(c)||typeof(c==null?void 0:c.length)=="number")return c.length};return s?(async()=>{var u,c,f;m&&i(!0);try{const[p,N,P]=await Promise.all([(u=Os.getAllUsers)==null?void 0:u.call(Os,{limit:1}).catch(R=>(console.warn("usersAPI.getAllUsers error",R),null)),(c=Nl.getLeads)==null?void 0:c.call(Nl,{limit:1}).catch(R=>(console.warn("leadsAPI.getLeads error",R),null)),(f=As.getProperties)==null?void 0:f.call(As,{limit:1}).catch(R=>(console.warn("propertiesAPI.getProperties error",R),null))]),w=v(p)??di.total_users,$=v(N)??di.total_leads,y=v(P)??di.total_properties,k=[];w===0&&$>0&&k.push({message:"No users found but leads exist. Check user import/config."}),y===0&&$>0&&k.push({message:"You have leads but no properties yet. Consider adding listings."}),m&&(t(R=>({...R,total_users:w,total_leads:$,total_properties:y,active_users:R.active_users??0,recent_activities:R.recent_activities??0})),o(k))}catch(p){console.warn("Failed to load admin dashboard data:",p),b("Failed to load admin dashboard data")}finally{m&&i(!1)}})().catch(u=>{console.error("fetchAdminData top-level error:",u),m&&(i(!1),b("Failed to load admin dashboard data"))}):i(!1),()=>{m=!1}},[s]),r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx("p",{className:"text-sm md:text-base text-gray-600 mt-1",children:"System overview and management controls"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3 w-full md:w-auto",children:[e.jsx(Bs,{to:"/dashboard/settings/roles-permissions",className:"w-full",children:e.jsxs(ss,{className:"flex items-center justify-center space-x-2 w-full",children:[e.jsx(at,{className:"h-4 w-4"}),e.jsx("span",{children:"Manage Roles"})]})}),e.jsx(Bs,{to:"/dashboard/settings",className:"w-full",children:e.jsxs(ss,{variant:"outline",className:"flex items-center justify-center space-x-2 w-full",children:[e.jsx(Yt,{className:"h-4 w-4"}),e.jsx("span",{children:"System Settings"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.total_users??0})]}),e.jsx("div",{className:"h-8 w-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(Ns,{className:"h-4 w-4 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.active_users??0," active users"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Properties"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.total_properties??0})]}),e.jsx("div",{className:"h-8 w-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(Is,{className:"h-4 w-4 text-white"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total listings"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Leads"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.total_leads??0})]}),e.jsx("div",{className:"h-8 w-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(Rs,{className:"h-4 w-4 text-white"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All time leads"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activities"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.recent_activities??0})]}),e.jsx("div",{className:"h-8 w-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(jt,{className:"h-4 w-4 text-white"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recent activities"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(La,{className:"h-5 w-5 mr-2 text-blue-500"}),"User Management"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage users, roles, and permissions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Bs,{to:"/dashboard/users",children:e.jsx(ss,{variant:"outline",className:"w-full justify-start",children:"View All Users"})}),e.jsx(Bs,{to:"/dashboard/settings/roles-permissions",children:e.jsx(ss,{variant:"outline",className:"w-full justify-start",children:"Manage Roles & Permissions"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Vr,{className:"h-5 w-5 mr-2 text-green-500"}),"Data Management"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Manage system data and imports"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Bs,{to:"/dashboard/settings/master-data",children:e.jsx(ss,{variant:"outline",className:"w-full justify-start",children:"Master Data"})}),e.jsx(Bs,{to:"/dashboard/settings/import-export",children:e.jsx(ss,{variant:"outline",className:"w-full justify-start",children:"Import/Export"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ot,{className:"h-5 w-5 mr-2 text-purple-500"}),"Analytics & Reports"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"View system analytics and reports"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Bs,{to:"/dashboard/analytics",children:e.jsx(ss,{variant:"outline",className:"w-full justify-start",children:"View Analytics"})}),e.jsx(Bs,{to:"/dashboard/settings/integrations",children:e.jsx(ss,{variant:"outline",className:"w-full justify-start",children:"Integrations"})})]})]})]}),n.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ct,{className:"h-5 w-5 mr-2 text-red-500"}),"System Alerts"]}),e.jsx("div",{className:"space-y-3",children:n.map((m,g)=>e.jsxs("div",{className:"flex items-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx(ct,{className:"h-4 w-4 text-yellow-600 mr-3"}),e.jsx("span",{className:"text-yellow-800",children:(m==null?void 0:m.message)??(m==null?void 0:m.text)??JSON.stringify(m)})]},g))})]})]})},ob=100,cb=()=>{var T,j,E,V,W,B,M,A,L;const{user:s}=Hs(),[a,t]=l.useState(null),[r,i]=l.useState([]),[n,o]=l.useState([]),[m,g]=l.useState(!0),[b,d]=l.useState(!1);l.useEffect(()=>{y()},[]);const v=D=>D?typeof D=="object"&&"success"in D&&"data"in D?D.success?D.data:null:(D==null?void 0:D.data)!==void 0?D.data:D:null,x=D=>D?Array.isArray(D)?D:Array.isArray(D==null?void 0:D.data)?D.data:Array.isArray(D==null?void 0:D.items)?D.items:[]:[],u=D=>typeof D=="string"?D:"",c=D=>D===!0||D===1||D==="1"||typeof D=="string"&&D.toLowerCase()==="true",f=D=>{var H;return((H=u(D==null?void 0:D.status))==null?void 0:H.toLowerCase())==="active"||c(D==null?void 0:D.active)||c(D==null?void 0:D.is_active)},p=()=>{const D=new Date;return`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}-${String(D.getDate()).padStart(2,"0")}`},N=(D,I)=>{if(!D)return!1;const H=new Date(D);return isNaN(H.getTime())?!1:`${H.getFullYear()}-${String(H.getMonth()+1).padStart(2,"0")}-${String(H.getDate()).padStart(2,"0")}`===I},P=D=>{if(!D)return!1;const I=new Date(D);if(isNaN(I.getTime()))return!1;const H=new Date;return I.getFullYear()===H.getFullYear()&&I.getMonth()===H.getMonth()},w=D=>{var H;const I=(H=u(D==null?void 0:D.status))==null?void 0:H.toLowerCase().replace(/\s+/g,"_");return["converted","won","closed_won","sale","booked","successful"].includes(I)},$=D=>(D==null?void 0:D.assigned_to_id)??(D==null?void 0:D.assigned_to)??(D==null?void 0:D.executive_id)??(D==null?void 0:D.agent_id)??(D==null?void 0:D.owner_id)??(D==null?void 0:D.user_id)??null,y=async()=>{var D,I;try{d(X=>!m||X),g(!0);const H=await Promise.allSettled([(D=Os.getAllUsers)==null?void 0:D.call(Os,{role:["agent","executive"],limit:500}),(I=Nl.getLeads)==null?void 0:I.call(Nl,{limit:500,sort:"created_at:desc"})]),h=X=>X.status==="fulfilled"?X.value:null,Y=v(h(H[0])),K=v(h(H[1])),q=x(Y),ne=x(K);i(q.slice(0,10)),o(ne.slice(0,10));const le=q.length,S=q.reduce((X,re)=>X+(f(re)?1:0),0),C=ne.reduce((X,re)=>X+(w(re)?1:0),0),J=ne.length>0?Math.round(C/ne.length*100):0,Q=ne.filter(X=>P((X==null?void 0:X.created_at)??(X==null?void 0:X.createdAt))).length,he=p(),se=ne.reduce((X,re)=>{const fe=(re==null?void 0:re.last_activity_at)??(re==null?void 0:re.last_contacted_at)??(re==null?void 0:re.updated_at)??(re==null?void 0:re.updatedAt);return X+(N(fe,he)?1:0)},0),ge=ne.reduce((X,re)=>{const fe=u(re==null?void 0:re.status).toLowerCase().replace(/\s+/g,"_"),G=["converted","won","closed_won","sale","successful","closed_lost","lost","dead"].includes(fe);return X+(G?0:1)},0),ee={};for(const X of ne){const re=String($(X)??"");re&&(ee[re]=(ee[re]||0)+1)}let de;if(Object.keys(ee).length>0){const[X]=Object.entries(ee).sort((fe,G)=>G[1]-fe[1])[0],re=q.find(fe=>String((fe==null?void 0:fe.id)??(fe==null?void 0:fe._id)??(fe==null?void 0:fe.user_id)??(fe==null?void 0:fe.value)??"")===String(X));if(re){const fe=u(re==null?void 0:re.first_name)||u(re==null?void 0:re.firstName),G=u(re==null?void 0:re.last_name)||u(re==null?void 0:re.lastName);de=`${fe||"Agent"} ${G}`.trim()}else de="Top Agent"}const U={team_performance:{total_agents:le,active_agents:S,top_performer:de,team_conversion_rate:J},monthly_targets:{leads_target:ob,leads_achieved:Q},team_activities:{total_activities:ne.length,pending_activities:ge,completed_today:se}};t(U),q.length===0&&ne.length===0&&wt.error("No data available for manager dashboard")}catch(H){console.error("Unexpected error fetching manager data:",H),wt.error("Failed to load manager dashboard data"),t(null),i([]),o([])}finally{g(!1),d(!1)}},k=(D,I)=>I>0?Math.min(D/I*100,100):0,R=D=>{if(!D)return"";const I=new Date(D);return isNaN(I.getTime())?"":I.toLocaleDateString()},F=(D,I)=>{var Y,K;const H=(((Y=D==null?void 0:D.trim())==null?void 0:Y[0])||"").toUpperCase(),h=(((K=I==null?void 0:I.trim())==null?void 0:K[0])||"").toUpperCase();return H+h||"U"};return m?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Manager Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Team performance and management overview"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[e.jsx(Bs,{to:"/dashboard/users",className:"w-full sm:w-auto",children:e.jsxs(ss,{className:"flex items-center justify-center space-x-2 w-full sm:w-auto",children:[e.jsx(Wr,{className:"h-4 w-4"}),e.jsx("span",{children:"Manage Team"})]})}),e.jsx(Bs,{to:"/dashboard/analytics",className:"w-full sm:w-auto",children:e.jsxs(ss,{variant:"outline",className:"flex items-center justify-center space-x-2 w-full sm:w-auto",children:[e.jsx(Ot,{className:"h-4 w-4"}),e.jsx("span",{children:"Team Analytics"})]})}),e.jsxs(ss,{variant:"ghost",onClick:y,className:"flex items-center justify-center space-x-2 w-full sm:w-auto",disabled:b,"aria-busy":b,children:[e.jsx("svg",{className:`h-4 w-4 ${b?"animate-spin":""}`,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M21 12a9 9 0 11-3.2-6.6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})}),e.jsx("span",{children:b?"Refreshing...":"Retry"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Team Size"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((T=a==null?void 0:a.team_performance)==null?void 0:T.total_agents)??0})]}),e.jsx("div",{className:"h-8 w-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(Ns,{className:"h-4 w-4 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[((j=a==null?void 0:a.team_performance)==null?void 0:j.active_agents)??0," active agents"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversion Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((E=a==null?void 0:a.team_performance)==null?void 0:E.team_conversion_rate)??0,"%"]})]}),e.jsx("div",{className:"h-8 w-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(rt,{className:"h-4 w-4 text-white"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Team average"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Monthly Leads"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((V=a==null?void 0:a.monthly_targets)==null?void 0:V.leads_achieved)??0})]}),e.jsx("div",{className:"h-8 w-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(Rs,{className:"h-4 w-4 text-white"})})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${k(((W=a==null?void 0:a.monthly_targets)==null?void 0:W.leads_achieved)??0,((B=a==null?void 0:a.monthly_targets)==null?void 0:B.leads_target)??1)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Target: ",((M=a==null?void 0:a.monthly_targets)==null?void 0:M.leads_target)??0]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activities"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((A=a==null?void 0:a.team_activities)==null?void 0:A.completed_today)??0})]}),e.jsx("div",{className:"h-8 w-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(Ts,{className:"h-4 w-4 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[((L=a==null?void 0:a.team_activities)==null?void 0:L.pending_activities)??0," pending"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(Bs,{to:"/dashboard/leads",children:e.jsxs(ss,{className:"w-full justify-start",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Review Team Leads"]})}),e.jsx(Bs,{to:"/dashboard/properties",children:e.jsxs(ss,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),"Manage Properties"]})}),e.jsx(Bs,{to:"/dashboard/activities",children:e.jsxs(ss,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Schedule Activities"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(Ct,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Top Performers"]}),e.jsx(Bs,{to:"/dashboard/users",className:"text-blue-600 hover:text-blue-800",children:e.jsx(la,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-3",children:r.length>0?r.slice(0,10).map((D,I)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-8 w-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:F(D.first_name??D.firstName,D.last_name??D.lastName)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:(D.first_name??D.firstName??"Unknown")+" "+(D.last_name??D.lastName??"")}),e.jsx("p",{className:"text-sm text-gray-500",children:D.email??"â€”"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["#",I+1]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Rank"})]})]},D.id||D._id||D.user_id||I)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No agents found"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Team Leads"}),e.jsx(Bs,{to:"/dashboard/leads",className:"text-blue-600 hover:text-blue-800",children:e.jsx(la,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-3",children:n.length>0?n.slice(0,10).map((D,I)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border-l-4 border-blue-500 bg-blue-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:(D.first_name??"Unknown")+" "+(D.last_name??"")}),e.jsx("p",{className:"text-sm text-gray-600",children:D.email??"â€”"}),e.jsx("p",{className:"text-xs text-gray-500",children:R(D.created_at??D.createdAt)})]}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:D.status||"New"})]},D.id||D._id||I)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent leads"})})]})]})]})},db={my_leads:{total_leads:0,new_leads:0,hot_leads:0,converted_leads:0,conversion_rate:0},my_properties:{total_listings:0,active_listings:0,sold_this_month:0},monthly_targets:{leads_target:0,leads_achieved:0,sales_target:0,sales_achieved:0},upcoming_activities:0,today_followups:0},Ka=(s,a)=>Math.floor(Math.random()*(a-s+1))+s,mi=s=>s[Ka(0,s.length-1)],mb=["Aarav","Vihaan","Aditya","Ishaan","Kabir","Riya","Anaya","Diya","Aanya","Sara"],xb=["Sharma","Verma","Patel","Agarwal","Gupta","Kulkarni","Iyer","Reddy","Singh","Khan"],ub=["New","Hot","Warm","Cold","Qualified","Converted"],gb=["Call","Meeting","Visit","Task"];function To(s){const a=new Date;return a.setDate(a.getDate()+s),a.toISOString()}function hb(){const s=Ka(12,40),a=Array.from({length:s}).map((m,g)=>{const b=mi(mb),d=mi(xb),v=-Ka(0,45),x=mi(ub);return{id:g+1,first_name:b,last_name:d,email:`${b.toLowerCase()}.${d.toLowerCase()}@example.com`,phone:`9${Ka(1e8,999999999)}`,status:x,created_at:To(v)}}),t=Ka(3,12),r=Array.from({length:t}).map((m,g)=>{const d=Math.random()>.4?Ka(0,10):-Ka(0,10),v=To(d),x=mi(gb);return{id:g+1,title:`${x} with client`,description:`${x} regarding property options`,type:x,scheduled_at:v,created_at:To(-Ka(0,15))}}),i=Ka(0,12),n=Math.min(i,Ka(0,i)),o=Ka(0,Math.max(0,i-n));return{leads:a,activities:r,properties:{totalListings:i,activeListings:n,soldThisMonth:o}}}const pb=()=>{var u,c,f,p,N,P,w,$,y,k,R,F,T,j,E;const{user:s}=Hs(),[a,t]=l.useState(db),[r,i]=l.useState([]),[n,o]=l.useState([]),[m,g]=l.useState(!0);l.useEffect(()=>{let V=!0;const W=()=>{const{leads:B,activities:M,properties:A}=hb(),L=[...B].sort((J,ue)=>new Date(ue.created_at).getTime()-new Date(J.created_at).getTime()),D=M.filter(J=>J.scheduled_at&&new Date(J.scheduled_at).getTime()>=Date.now()).sort((J,ue)=>new Date(J.scheduled_at).getTime()-new Date(ue.scheduled_at).getTime()),I=new Date,H=new Date(I);H.setDate(I.getDate()-7);const h=B.filter(J=>new Date(J.created_at).getTime()>=H.getTime()).length,Y=B.filter(J=>(J.status||"").toLowerCase()==="hot").length,K=B.filter(J=>{const ue=(J.status||"").toLowerCase();return ue==="converted"||ue==="qualified"}).length,q=B.length?Math.round(K/B.length*100):0,ne=B.filter(J=>{const ue=new Date(J.created_at);return ue.getMonth()===I.getMonth()&&ue.getFullYear()===I.getFullYear()}).length,le=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}-${String(I.getDate()).padStart(2,"0")}`,S=M.filter(J=>{if(!J.scheduled_at)return!1;const ue=new Date(J.scheduled_at);return`${ue.getFullYear()}-${String(ue.getMonth()+1).padStart(2,"0")}-${String(ue.getDate()).padStart(2,"0")}`===le}).length,C={my_leads:{total_leads:B.length,new_leads:h,hot_leads:Y,converted_leads:K,conversion_rate:q},my_properties:{total_listings:A.totalListings,active_listings:A.activeListings,sold_this_month:A.soldThisMonth},monthly_targets:{leads_target:100,leads_achieved:ne,sales_target:5,sales_achieved:Math.min(5,Math.floor(K/4))},upcoming_activities:D.length,today_followups:S};V&&(t(C),i(L.slice(0,5)),o(D.slice(0,5)))};if(s){g(!0);try{W()}catch(B){console.error("Mock compute failed:",B),wt.error("Failed to load agent dashboard")}finally{V&&g(!1)}}else g(!1);return()=>{V=!1}},[s]);const b=(V=0,W=0)=>W>0?Math.min(V/W*100,100):0,d=()=>{const V=new Date().getHours();return V<12?"Good morning":V<18?"Good afternoon":"Good evening"},v=V=>{switch((V||"").toLowerCase()){case"hot":case"hot lead":return"bg-red-100 text-red-800";case"warm":return"bg-orange-100 text-orange-800";case"cold":return"bg-blue-100 text-blue-800";case"qualified":case"converted":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},x=V=>{if(!V)return"-";const W=new Date(V);return isNaN(W.getTime())?"-":W.toLocaleDateString()};return m?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 md:gap-0",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:[d(),", ",(s==null?void 0:s.first_name)??"Agent","!"]}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Here's your daily performance overview"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3",children:[e.jsx(Bs,{to:"/dashboard/leads",children:e.jsxs(ss,{className:"flex items-center space-x-2 w-full",children:[e.jsx(fs,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Lead"})]})}),e.jsx(Bs,{to:"/dashboard/activities",children:e.jsxs(ss,{variant:"outline",className:"flex items-center space-x-2 w-full",children:[e.jsx(Ts,{className:"h-4 w-4"}),e.jsx("span",{children:"Schedule Activity"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"My Leads"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((u=a==null?void 0:a.my_leads)==null?void 0:u.total_leads)??0})]}),e.jsx("div",{className:"h-8 w-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(Ns,{className:"h-4 w-4 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[((c=a==null?void 0:a.my_leads)==null?void 0:c.new_leads)??0," new this week"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Conversion Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((f=a==null?void 0:a.my_leads)==null?void 0:f.conversion_rate)??0,"%"]})]}),e.jsx("div",{className:"h-8 w-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(rt,{className:"h-4 w-4 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[((p=a==null?void 0:a.my_leads)==null?void 0:p.converted_leads)??0," converted"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Hot Leads"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((N=a==null?void 0:a.my_leads)==null?void 0:N.hot_leads)??0})]}),e.jsx("div",{className:"h-8 w-8 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx(Rs,{className:"h-4 w-4 text-white"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Require immediate attention"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Properties"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((P=a==null?void 0:a.my_properties)==null?void 0:P.active_listings)??0})]}),e.jsx("div",{className:"h-8 w-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(Is,{className:"h-4 w-4 text-white"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[((w=a==null?void 0:a.my_properties)==null?void 0:w.sold_this_month)??0," sold this month"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Targets"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Leads Target"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[(($=a==null?void 0:a.monthly_targets)==null?void 0:$.leads_achieved)??0," /"," ",((y=a==null?void 0:a.monthly_targets)==null?void 0:y.leads_target)??0]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full",style:{width:`${b(((k=a==null?void 0:a.monthly_targets)==null?void 0:k.leads_achieved)??0,((R=a==null?void 0:a.monthly_targets)==null?void 0:R.leads_target)??1)}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Sales Target"}),e.jsxs("span",{className:"text-sm text-gray-900",children:["â‚¹",((F=a==null?void 0:a.monthly_targets)==null?void 0:F.sales_achieved)??0," / â‚¹",((T=a==null?void 0:a.monthly_targets)==null?void 0:T.sales_target)??0]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-green-600 h-3 rounded-full",style:{width:`${b(((j=a==null?void 0:a.monthly_targets)==null?void 0:j.sales_achieved)??0,((E=a==null?void 0:a.monthly_targets)==null?void 0:E.sales_target)??1)}%`}})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(Bs,{to:"/dashboard/leads",children:e.jsxs(ss,{className:"w-full justify-start",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Add New Lead"]})}),e.jsx(Bs,{to:"/dashboard/properties",children:e.jsxs(ss,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),"Add Property"]})}),e.jsx(Bs,{to:"/dashboard/activities",children:e.jsxs(ss,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Schedule Follow-up"]})}),e.jsx(Bs,{to:"/dashboard/communication",children:e.jsxs(ss,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Send Message"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("section",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"My Recent Leads"}),e.jsx(Bs,{to:"/dashboard/leads","aria-label":"Go to Leads",className:"inline-flex items-center justify-center rounded-md text-blue-600 hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:e.jsx(la,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-3",children:r.length>0?r.map(V=>{var W,B;return e.jsx("div",{className:"p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start sm:items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 sm:h-11 sm:w-11 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium shrink-0",children:((((W=V.first_name)==null?void 0:W[0])||"")+(((B=V.last_name)==null?void 0:B[0])||"")).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:(V.first_name??"")+" "+(V.last_name??"")}),e.jsxs("div",{className:"mt-0.5 space-y-0.5",children:[e.jsxs("p",{className:"text-sm text-gray-600 flex items-center min-w-0",children:[e.jsx(Ds,{className:"h-3 w-3 mr-1 shrink-0"}),e.jsx("span",{className:"truncate",children:V.email??"-"})]}),V.phone&&e.jsxs("p",{className:"text-sm text-gray-600 flex items-center min-w-0",children:[e.jsx(Cs,{className:"h-3 w-3 mr-1 shrink-0"}),e.jsx("span",{className:"truncate",children:V.phone})]})]})]})]})}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("span",{className:`inline-block px-2 py-1 text-[10px] sm:text-xs font-medium rounded-full ${v(V.status)}`,children:V.status??"New"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mt-1",children:x(V.created_at)})]})]})},V.id??`${V.first_name}-${V.last_name}-${V.created_at??""}`)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ns,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-3 sm:mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No recent leads"}),e.jsx(Bs,{to:"/dashboard/leads",children:e.jsxs(ss,{className:"mt-3",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Add Your First Lead"]})})]})})]}),e.jsxs("section",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Upcoming Activities"}),e.jsx(Bs,{to:"/dashboard/activities","aria-label":"Go to Activities",className:"inline-flex items-center justify-center rounded-md text-blue-600 hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:e.jsx(la,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-3",children:n.length>0?n.map(V=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"h-2 w-2 bg-blue-500 rounded-full shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:V.title??V.description??"Untitled"}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(V.scheduled_at??V.created_at??Date.now()).toLocaleString()})]})]}),e.jsx("div",{className:"sm:ml-auto",children:e.jsx("span",{className:"inline-block px-2 py-1 text-[10px] sm:text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:V.type??"Task"})})]},V.id??JSON.stringify(V))):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ts,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-3 sm:mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No upcoming activities"}),e.jsx(Bs,{to:"/dashboard/activities",children:e.jsxs(ss,{className:"mt-3",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Schedule Activity"]})})]})})]})]})]})},am={getPermissions:async()=>(await Ae.get("/rbac/permissions")).data||[],getRoles:async()=>(await Ae.get("/rbac/roles")).data||[],getRolePermissions:async s=>{const a=await Ae.get(`/rbac/roles/${s}/permissions`);return console.log("RBAC getRolePermissions response:",a.data),a.data||[]},updateRolePermissions:async(s,a)=>(await Ae.put(`/rbac/roles/${s}/permissions`,{permissions:a})).data},bb=()=>{const{user:s}=Hs(),[a,t]=l.useState([]),[r,i]=l.useState([]),[n,o]=l.useState(!0),[m,g]=l.useState("roles"),[b,d]=l.useState(null);l.useEffect(()=>{console.log("CURRENT USER ===>",s)},[s]),l.useEffect(()=>{v(),x()},[]);const v=async()=>{o(!0);try{const P=(await Nt.getAllMasterTypes("common")).find(y=>(y.name||"").toLowerCase()==="role"||(y.name||"").toLowerCase()==="roles");if(!P){console.warn("Role master type not found â€” roles will be empty"),t([]);return}const w=await Nt.getMasterValues(P.id);if(!Array.isArray(w)){console.warn("Master roles response is not an array â€” roles will be empty"),t([]);return}const $=w.map(y=>{var F;const k=y.value||y.name||`Role ${y.id}`;return{id:String(k).toLowerCase().trim(),name:k,description:y.description||((F=y.meta)==null?void 0:F.description)||"",permissions:Array.isArray(y.permissions)?y.permissions.map(T=>typeof T=="string"?T:`${T.resource}.${T.action}`):[],user_count:typeof y.user_count=="number"?y.user_count:0,is_system:!!y.is_system,created_at:y.created_at||new Date().toISOString()}});try{const y=await Promise.all($.map(async k=>{try{const R=await am.getRolePermissions(k.id);return Array.isArray(R)&&R.length>0?{...k,permissions:R}:k}catch(R){return console.warn("Failed to load role permissions for role",k.id,R),k}}));t(y)}catch(y){console.warn("Failed to merge DB role permissions, using master only",y),t($)}}catch(N){console.error("Failed to load roles from master API:",N),t([])}finally{o(!1)}},x=async()=>{try{i([{id:"1",name:"Create Users",resource:"user",action:"create",description:"Create new user accounts"},{id:"2",name:"View Users",resource:"user",action:"read",description:"View user information and profiles"},{id:"3",name:"Update Users",resource:"user",action:"update",description:"Edit user information and settings"},{id:"4",name:"Delete Users",resource:"user",action:"delete",description:"Remove user accounts"},{id:"5",name:"Create Leads",resource:"lead",action:"create",description:"Add new leads to the system"},{id:"6",name:"View Leads",resource:"lead",action:"read",description:"Access lead information"},{id:"7",name:"Update Leads",resource:"lead",action:"update",description:"Edit lead details and status"},{id:"8",name:"Delete Leads",resource:"lead",action:"delete",description:"Remove leads from system"},{id:"35",name:"Assign Leads",resource:"lead",action:"assign",description:"Assign leads to team members"},{id:"36",name:"Bulk Delete Leads",resource:"lead",action:"bulk_delete",description:"Delete multiple leads at once"},{id:"46",name:"Create Followups",resource:"followup",action:"create",description:"Add followup entries to leads"},{id:"47",name:"View Followups",resource:"followup",action:"read",description:"View existing followup entries"},{id:"48",name:"Update Followups",resource:"followup",action:"update",description:"Edit existing followup entries"},{id:"49",name:"Delete Followups",resource:"followup",action:"delete",description:"Remove followup entries from leads"},{id:"9",name:"Create Properties",resource:"property",action:"create",description:"Add new property listings"},{id:"10",name:"View Properties",resource:"property",action:"read",description:"Access property information"},{id:"11",name:"Update Properties",resource:"property",action:"update",description:"Edit property details"},{id:"12",name:"Delete Properties",resource:"property",action:"delete",description:"Remove property listings"},{id:"37",name:"Assign Properties",resource:"property",action:"assign",description:"Assign properties to agents"},{id:"38",name:"Bulk Delete Properties",resource:"property",action:"bulk_delete",description:"Delete multiple properties at once"},{id:"21",name:"Create Buyers",resource:"buyer",action:"create",description:"Add new buyer records"},{id:"22",name:"View Buyers",resource:"buyer",action:"read",description:"View buyer details"},{id:"23",name:"Update Buyers",resource:"buyer",action:"update",description:"Edit buyer records"},{id:"24",name:"Delete Buyers",resource:"buyer",action:"delete",description:"Delete buyer records"},{id:"39",name:"Assign Buyers",resource:"buyer",action:"assign",description:"Assign buyers to agents"},{id:"40",name:"Bulk Delete Buyers",resource:"buyer",action:"bulk_delete",description:"Delete multiple buyers at once"},{id:"25",name:"Create Sellers",resource:"seller",action:"create",description:"Add new seller records"},{id:"26",name:"View Sellers",resource:"seller",action:"read",description:"View seller details"},{id:"27",name:"Update Sellers",resource:"seller",action:"update",description:"Edit seller records"},{id:"28",name:"Delete Sellers",resource:"seller",action:"delete",description:"Delete seller records"},{id:"41",name:"Assign Sellers",resource:"seller",action:"assign",description:"Assign sellers to agents"},{id:"42",name:"Bulk Delete Sellers",resource:"seller",action:"bulk_delete",description:"Delete multiple sellers at once"},{id:"29",name:"Create Blogs",resource:"blog",action:"create",description:"Add new blog posts"},{id:"30",name:"View Blogs",resource:"blog",action:"read",description:"View blog posts"},{id:"31",name:"Update Blogs",resource:"blog",action:"update",description:"Edit existing blog posts"},{id:"32",name:"Delete Blogs",resource:"blog",action:"delete",description:"Delete blog posts"},{id:"43",name:"Bulk Delete Blogs",resource:"blog",action:"bulk_delete",description:"Delete multiple blog posts at once"},{id:"13",name:"Create Activities",resource:"activity",action:"create",description:"Schedule new activities and tasks"},{id:"14",name:"View Activities",resource:"activity",action:"read",description:"Access activity information"},{id:"15",name:"Update Activities",resource:"activity",action:"update",description:"Edit activity details"},{id:"16",name:"Delete Activities",resource:"activity",action:"delete",description:"Remove activities and tasks"},{id:"44",name:"Assign Activities",resource:"activity",action:"assign",description:"Assign activities to team members"},{id:"45",name:"Bulk Delete Activities",resource:"activity",action:"bulk_delete",description:"Delete multiple activities at once"},{id:"17",name:"System Management",resource:"system",action:"manage",description:"Access system settings and configuration"},{id:"18",name:"View Reports",resource:"report",action:"read",description:"Access analytics and reports"},{id:"19",name:"Export Data",resource:"data",action:"export",description:"Export system data"},{id:"20",name:"Import Data",resource:"data",action:"import",description:"Import data into system"}])}catch(N){console.error("Error loading static permissions:",N),Z.error("Failed to load permissions")}},u=async N=>{try{await am.updateRolePermissions(N.id,N.permissions),t(P=>P.map(w=>w.id===N.id?N:w)),d(null),Z.success("Role permissions updated successfully")}catch(P){console.error("Error updating role:",P),Z.error((P==null?void 0:P.message)||"Failed to update role permissions")}},c=(N,P)=>{const w=r.find(y=>y.id===N);if(!w)return P;const $=`${w.resource}.${w.action}`;return P.includes($)?P.filter(y=>y!==$):[...P,$]},f=(N,P)=>{const w=r.find(y=>y.id===N);if(!w)return!1;const $=`${w.resource}.${w.action}`;return P.includes($)},p=()=>{const N={};return r.forEach(P=>{N[P.resource]||(N[P.resource]=[]),N[P.resource].push(P)}),N};return n?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 gap-3 sm:gap-0",children:[e.jsx(Bs,{to:"/dashboard/settings",className:"w-full sm:w-auto",children:e.jsxs(ss,{variant:"outline",className:"w-full sm:w-auto flex items-center justify-center sm:justify-start",children:[e.jsx(ga,{className:"h-4 w-4 mr-2"}),"Back to Settings"]})}),e.jsxs("div",{className:"mb-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Roles & Permissions"}),e.jsx("p",{className:"text-gray-600 text-xs",children:"Manage user roles and their access permissions"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8","aria-label":"Tabs",children:[e.jsx("button",{onClick:()=>g("roles"),className:`py-4 px-1 border-b-2 font-medium text-sm ${m==="roles"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(at,{className:"h-4 w-4"}),e.jsxs("span",{children:["Roles (",a.length,")"]})]})}),e.jsx("button",{onClick:()=>g("permissions"),className:`py-4 px-1 border-b-2 font-medium text-sm ${m==="permissions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Gr,{className:"h-4 w-4"}),e.jsxs("span",{children:["Permissions (",r.length,")"]})]})})]})}),e.jsxs("div",{className:"p-6",children:[m==="roles"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(N=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:N.name}),N.is_system&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded",children:"System"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N.description})]}),e.jsx("div",{className:"flex space-x-1",children:e.jsx(ss,{variant:"outline",size:"sm",onClick:()=>d(N),disabled:N.is_system,children:e.jsx(ft,{className:"h-3 w-3"})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Users:"}),e.jsx("span",{className:"font-medium",children:N.user_count})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Permissions:"}),e.jsx("span",{className:"font-medium",children:N.permissions.length})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(N.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Key Permissions:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[N.permissions.filter(P=>P.includes("lead.")||P.includes("followup.")||P.includes("property.")).slice(0,4).map((P,w)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:P.split(".")[1]},w)),N.permissions.length>4&&e.jsxs("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-500 rounded",children:["+",N.permissions.length-4," more"]})]})]})]},N.id))})}),m==="permissions"&&e.jsx("div",{className:"space-y-6",children:Object.entries(p()).map(([N,P])=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 capitalize",children:[N," Permissions"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(w=>e.jsxs("div",{className:"bg-white rounded border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Gr,{className:"h-4 w-4 text-gray-400"}),e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:w.name})]}),e.jsx("p",{className:"text-xs text-gray-600",children:w.description}),e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded",children:[w.resource,".",w.action]})})]},w.id))})]},N))})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:["Edit Permissions - ",b.name]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-4",children:["Permissions (",b.permissions.length," selected)"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(p()).map(([N,P])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-900 mb-3 capitalize",children:[N," Permissions"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:P.map(w=>{const $=f(w.id,b.permissions);return e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:$,onChange:()=>{const y=c(w.id,b.permissions);d({...b,permissions:y})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:b.is_system}),e.jsx("span",{className:"text-sm text-gray-700",children:w.name})]},w.id)})})]},N))})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(ss,{onClick:()=>u(b),disabled:!b.name||b.is_system,children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"Update Permissions"]}),e.jsx(ss,{variant:"outline",onClick:()=>d(null),children:"Cancel"})]}),b.is_system&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(at,{className:"h-5 w-5 text-yellow-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"System Role"}),e.jsx("div",{className:"mt-1 text-sm text-yellow-700",children:e.jsx("p",{children:"This is a system role. Some permissions cannot be modified for system roles."})})]})]})})]})]})})]})},fb=({isOpen:s,onClose:a,onSave:t,integration:r})=>{const[i,n]=l.useState(!1),[o,m]=l.useState({provider:"",apiKey:"",token:"",smsNumber:"+13159152581",smsFrom:""}),g=["Select Provider","Twilio","AWS SNS","Vonage","TextMagic","MessageBird","Plivo"];l.useEffect(()=>{var x,u,c,f;r&&m({provider:(((x=r==null?void 0:r.config)==null?void 0:x.sms_provider)||"").toUpperCase(),apiKey:(r==null?void 0:r.api_key)||"",token:((u=r==null?void 0:r.config)==null?void 0:u.token)||"",smsNumber:((c=r==null?void 0:r.config)==null?void 0:c.from_number)||"+13159152581",smsFrom:((f=r==null?void 0:r.config)==null?void 0:f.sender_name)||""})},[r]);const b=(x,u)=>{m(c=>({...c,[x]:u}))},d=()=>{const u=["provider","apiKey","token","smsNumber","smsFrom"].filter(c=>!o[c]);if(u.length>0){Z.error(`Please fill all required fields: ${u.join(", ")}`);return}t(o)},v=()=>{a()};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-fadeIn",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 px-6 py-4 text-white flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Bt,{className:"h-6 w-6"}),e.jsx("h2",{className:"text-xl font-semibold",children:"SMS API Configuration"})]}),e.jsx("button",{onClick:v,className:"text-white hover:text-gray-200 transition",children:e.jsx(ns,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["API Provider ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:o.provider,onChange:x=>b("provider",x.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",children:g.map((x,u)=>e.jsx("option",{value:u===0?"":x.toUpperCase(),disabled:u===0,children:u===0?"-- Select Provider --":x},u))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["ID / KEY ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute left-3 top-3 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",value:o.apiKey,onChange:x=>b("apiKey",x.target.value),placeholder:"API KEY or SID",className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 transition"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["TOKEN / SECRET ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Jn,{className:"absolute left-3 top-3 text-gray-400 h-4 w-4"}),e.jsx("input",{type:i?"text":"password",value:o.token,onChange:x=>b("token",x.target.value),placeholder:"API Secret or Token",className:"w-full pl-10 pr-10 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 transition"}),e.jsx("button",{type:"button",onClick:()=>n(!i),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:i?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["SMS NUMBER ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.smsNumber,onChange:x=>b("smsNumber",x.target.value),placeholder:"+13159152581",className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 transition"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["SMS FROM ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.smsFrom,onChange:x=>b("smsFrom",x.target.value),placeholder:"Sender name or number",className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 transition"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Bt,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Configuration Notes"}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Use the correct API credentials from your SMS provider."})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3 border-t",children:[e.jsx("button",{onClick:v,className:"px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{onClick:d,className:"px-6 py-2.5 rounded-lg text-white bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 shadow-lg transition",children:"Save SMS API"})]})]})}):null},yb=({isOpen:s,onClose:a,onSave:t,integration:r})=>{const[i,n]=l.useState(""),[o,m]=l.useState(""),[g,b]=l.useState(""),[d,v]=l.useState(""),[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState(!1),[P,w]=l.useState({}),[$,y]=l.useState(!1);if(l.useEffect(()=>{if(r&&s){const E=(r==null?void 0:r.config)??{};n((E==null?void 0:E.key_id)??(r==null?void 0:r.api_key)??""),m((E==null?void 0:E.key_secret)??""),b((E==null?void 0:E.webhook_secret)??""),v((E==null?void 0:E.webhook_url)??""),w({}),y(!1)}},[r,s]),!s)return null;const k=E=>{if(!E||!E.trim())return!1;try{const V=new URL(E.trim());return V.protocol==="https:"||V.protocol==="http:"}catch{return!1}},R=()=>{const E={};return!i||!i.trim()?E.keyId="Razorpay Key ID is required.":/^rzp_/.test(i.trim())||(E.keyId="Key ID usually starts with 'rzp_'. Please enter a valid Key ID."),(!o||!o.trim())&&(E.keySecret="Key Secret is required. Store this securely on your server."),(!g||!g.trim())&&(E.webhookSecret="Webhook Secret is required for verifying webhook payloads."),!d||!d.trim()?E.webhookUrl="Webhook URL is required.":k(d)||(E.webhookUrl="Please enter a valid Webhook URL (http or https)."),w(E),Object.keys(E).length===0},F=()=>({provider:"Razorpay",key_id:i.trim(),key_secret:o.trim()||null,webhook_secret:g.trim()||null,webhook_url:d.trim()||null}),T=async()=>{var V;if(!R())return;const E=F();u(!0),w({});try{const W=await t({keyId:E.key_id,keySecret:E.key_secret,webhookSecret:E.webhook_secret,webhookUrl:E.webhook_url});y(!0)}catch(W){console.error("âŒ Error from onSave:",W);const B=(V=W==null?void 0:W.response)==null?void 0:V.data;if(B&&(B.errors||B.message)){const M={};B.errors&&typeof B.errors=="object"&&(B.errors.key_id&&(M.keyId=Array.isArray(B.errors.key_id)?B.errors.key_id.join(" "):String(B.errors.key_id)),B.errors.key_secret&&(M.keySecret=Array.isArray(B.errors.key_secret)?B.errors.key_secret.join(" "):String(B.errors.key_secret)),B.errors.webhook_secret&&(M.webhookSecret=Array.isArray(B.errors.webhook_secret)?B.errors.webhook_secret.join(" "):String(B.errors.webhook_secret)),B.errors.webhook_url&&(M.webhookUrl=Array.isArray(B.errors.webhook_url)?B.errors.webhook_url.join(" "):String(B.errors.webhook_url))),!Object.keys(M).length&&B.message&&(M.general=String(B.message)),w(M);return}w({general:(W==null?void 0:W.message)??"Something went wrong"})}finally{u(!1)}},j=()=>{a()};return e.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Razorpay Configuration",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-fadeIn",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 px-6 py-4 text-white flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(at,{className:"h-6 w-6"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold leading-tight",children:"Razorpay Configuration"}),e.jsx("p",{className:"text-xs text-white/90",children:"Configure your Razorpay keys & webhooks"})]})]}),e.jsx("button",{onClick:j,className:"p-2 rounded-md hover:bg-white/10 transition","aria-label":"Close modal",children:e.jsx(ns,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-start",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"razorpay-keyid",className:"block text-sm font-medium text-gray-700 mb-2",children:["Razorpay Key ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute left-3 top-3 text-gray-400 h-4 w-4"}),e.jsx("input",{id:"razorpay-keyid",type:"text",value:i,onChange:E=>n(E.target.value),placeholder:"rzp_test_xxxxx",className:`w-full pl-10 pr-3 py-2.5 rounded-lg border ${P.keyId?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-purple-500 transition`,autoComplete:"off"})]}),P.keyId&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.keyId}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Provide Key ID to the frontend. Keep secrets on the server."})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"razorpay-keysecret",className:"block text-sm font-medium text-gray-700 mb-2",children:["Key Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"razorpay-keysecret",type:c?"text":"password",value:o,onChange:E=>m(E.target.value),placeholder:"(required â€” store on server)",className:`w-full px-3 py-2.5 rounded-lg border ${P.keySecret?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-purple-500 transition pr-10`,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>f(E=>!E),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600","aria-label":c?"Hide key secret":"Show key secret",children:c?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})})]}),P.keySecret&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.keySecret}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Keep your Key Secret safe on the backend."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"razorpay-webhooksecret",className:"block text-sm font-medium text-gray-700 mb-2",children:["Webhook Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"razorpay-webhooksecret",type:p?"text":"password",value:g,onChange:E=>b(E.target.value),placeholder:"Webhook secret for verifying payloads",className:`w-full px-3 py-2.5 rounded-lg border ${P.webhookSecret?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-purple-500 transition pr-10`,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>N(E=>!E),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600","aria-label":p?"Hide webhook secret":"Show webhook secret",children:p?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})})]}),P.webhookSecret&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.webhookSecret}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Used to verify webhook payloads on your server."})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"razorpay-webhookurl",className:"block text-sm font-medium text-gray-700 mb-2",children:["Webhook URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(za,{className:"absolute left-3 top-3 text-gray-400 h-4 w-4"}),e.jsx("input",{id:"razorpay-webhookurl",type:"url",value:d,onChange:E=>v(E.target.value),placeholder:"https://example.com/webhooks/razorpay",className:`w-full pl-10 pr-3 py-2.5 rounded-lg border ${P.webhookUrl?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-purple-500 transition`,autoComplete:"off"})]}),P.webhookUrl&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.webhookUrl}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"The server endpoint where Razorpay will post webhook events. Use HTTPS in production."})]})]}),P.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-xs text-red-700",children:P.general})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(at,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Configuration Notes"}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Provide only Key ID to the frontend. Store Key Secret & Webhook Secret securely on the server and never expose them in client-side logs. Webhook URL is required to receive events â€” prefer HTTPS endpoints."})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex items-center justify-between gap-3 border-t",children:[e.jsx("div",{className:"flex items-center gap-4",children:$&&e.jsx("span",{className:"text-sm text-green-600",children:"Saved"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:j,className:"px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-60",type:"button",disabled:x,children:"Cancel"}),e.jsx("button",{onClick:T,className:"px-6 py-2.5 rounded-lg text-white bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 shadow-lg transition disabled:opacity-60",type:"button",disabled:x,children:x?"Saving...":"Save Razorpay"})]})]})]})})},jb=({isOpen:s,onClose:a,onSave:t,integration:r})=>{const[i,n]=l.useState(""),[o,m]=l.useState(""),[g,b]=l.useState(""),[d,v]=l.useState(""),[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState(!1),[P,w]=l.useState({}),[$,y]=l.useState(!1);if(l.useEffect(()=>{if(r&&s){const j=(r==null?void 0:r.config)??{};n((j==null?void 0:j.publishable_key)??(r==null?void 0:r.api_key)??""),m((j==null?void 0:j.secret_key)??""),b((j==null?void 0:j.webhook_secret)??""),v((j==null?void 0:j.webhook_url)??""),w({}),y(!1)}else s&&(n(""),m(""),b(""),v(""),w({}),y(!1))},[r,s]),!s)return null;const k=j=>{if(!j||!j.trim())return!1;try{const E=new URL(j.trim());return E.protocol==="https:"||E.protocol==="http:"}catch{return!1}},R=()=>{const j={};if(!i||!i.trim())j.publishableKey="Stripe publishable key is required.";else{const E=i.trim();!/^pk_(test|live)?_/.test(E)&&!/^rk_/.test(E)&&(j.publishableKey="Publishable key usually starts with 'pk_test_' or 'pk_live_'.")}if(!o||!o.trim())j.secretKey="Secret key is required. Store securely on server.";else{const E=o.trim();!/^sk_(test|live)?_/.test(E)&&!/^rk_/.test(E)&&!/^s_/.test(E)&&(j.secretKey="Secret key usually starts with 'sk_test_' or 'sk_live_'. Please confirm.")}if((!g||!g.trim())&&(j.webhookSecret="Webhook signing secret (whsec_...) is recommended for Stripe."),!d||!d.trim())j.webhookUrl="Webhook URL is required.";else if(!k(d))j.webhookUrl="Please enter a valid Webhook URL (http or https).";else try{new URL(d.trim()).protocol!=="https:"&&(j.webhookUrl="HTTPS is recommended for webhooks in production.")}catch{}return w(j),Object.keys(j).length===0},F=()=>({publishable_key:i.trim(),secret_key:o.trim()||null,webhook_secret:g.trim()||null,webhook_url:d.trim()||null}),T=async()=>{var E;if(!R())return;const j=F();u(!0),w({});try{const V=await t({publishableKey:j.publishable_key,secretKey:j.secret_key,webhookSecret:j.webhook_secret,webhookUrl:j.webhook_url});y(!0)}catch(V){console.error("âŒ Error from onSave (Stripe):",V);const W=(E=V==null?void 0:V.response)==null?void 0:E.data;if(W&&(W.errors||W.message)){const B={};W.errors&&typeof W.errors=="object"&&(W.errors.publishable_key&&(B.publishableKey=Array.isArray(W.errors.publishable_key)?W.errors.publishable_key.join(" "):String(W.errors.publishable_key)),W.errors.secret_key&&(B.secretKey=Array.isArray(W.errors.secret_key)?W.errors.secret_key.join(" "):String(W.errors.secret_key)),W.errors.webhook_secret&&(B.webhookSecret=Array.isArray(W.errors.webhook_secret)?W.errors.webhook_secret.join(" "):String(W.errors.webhook_secret)),W.errors.webhook_url&&(B.webhookUrl=Array.isArray(W.errors.webhook_url)?W.errors.webhook_url.join(" "):String(W.errors.webhook_url))),!Object.keys(B).length&&W.message&&(B.general=String(W.message)),w(B);return}w({general:(V==null?void 0:V.message)??"Something went wrong"})}finally{u(!1)}};return e.jsx("div",{role:"dialog","aria-modal":"true","aria-label":"Stripe Configuration",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-fadeIn",children:[e.jsxs("div",{className:"bg-gradient-to-r from-sky-600 to-indigo-600 px-6 py-4 text-white flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(at,{className:"h-6 w-6"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold leading-tight",children:"Stripe Configuration"}),e.jsx("p",{className:"text-xs text-white/90",children:"Configure publishable & secret keys, webhooks for Stripe"})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-md hover:bg-white/10 transition","aria-label":"Close modal",children:e.jsx(ns,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-start",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Publishable Key (pk_...) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute left-3 top-3 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",value:i,onChange:j=>n(j.target.value),placeholder:"pk_test_xxxxx",className:`w-full pl-10 pr-3 py-2.5 rounded-lg border ${P.publishableKey?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-sky-500 transition`,autoComplete:"off"})]}),P.publishableKey&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.publishableKey}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Publishable key safe for client-side usage."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Secret Key (sk_...) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",value:o,onChange:j=>m(j.target.value),placeholder:"sk_test_...",className:`w-full px-3 py-2.5 rounded-lg border ${P.secretKey?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-sky-500 transition pr-10`,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>f(j=>!j),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:c?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})})]}),P.secretKey&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.secretKey}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Store secret key on backend only."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Webhook Signing Secret ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",value:g,onChange:j=>b(j.target.value),placeholder:"whsec_...",className:`w-full px-3 py-2.5 rounded-lg border ${P.webhookSecret?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-sky-500 transition pr-10`,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>N(j=>!j),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:p?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})})]}),P.webhookSecret&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.webhookSecret}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Used by server to verify Stripe webhook signatures (whsec_...)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Webhook URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(za,{className:"absolute left-3 top-3 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"url",value:d,onChange:j=>v(j.target.value),placeholder:"https://example.com/webhooks/stripe",className:`w-full pl-10 pr-3 py-2.5 rounded-lg border ${P.webhookUrl?"border-red-400":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-sky-500 transition`,autoComplete:"off"})]}),P.webhookUrl&&e.jsx("p",{className:"text-xs text-red-600 mt-2",children:P.webhookUrl}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Server endpoint that receives Stripe events â€” use HTTPS in production."})]})]}),P.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-xs text-red-700",children:P.general})}),e.jsx("div",{className:"bg-sky-50 border border-sky-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(at,{className:"h-5 w-5 text-sky-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-sky-900",children:"Configuration Notes"}),e.jsx("p",{className:"text-xs text-sky-700 mt-1",children:"Publishable key goes to frontend, secret keys & webhook secrets must stay on server. Use Stripe CLI to test webhooks locally."})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex items-center justify-between gap-3 border-t",children:[e.jsx("div",{className:"flex items-center gap-4",children:$&&e.jsx("span",{className:"text-sm text-green-600",children:"Saved"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:a,className:"px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition disabled:opacity-60",type:"button",disabled:x,children:"Cancel"}),e.jsx("button",{onClick:T,className:"px-6 py-2.5 rounded-lg text-white bg-gradient-to-r from-sky-600 to-indigo-600 hover:from-sky-700 hover:to-indigo-700 shadow-lg transition disabled:opacity-60",type:"button",disabled:x,children:x?"Saving...":"Save Stripe"})]})]})]})})},vb=["Select","Mailtrap","Gmail","Amazon SES","Zoho Mail","Outlook / Office 365","SendGrid (SMTP)","Mailgun (SMTP)","Postmark (SMTP)","SparkPost (SMTP)","Custom"],Nb=["SMTP","SENDMAIL","MAILGUN"],wb={MAILTRAP:{host:"smtp.mailtrap.io",port:"2525",security:"NONE",usernameHint:"Mailtrap Username"},GMAIL:{host:"smtp.gmail.com",port:"587",security:"STARTTLS",usernameHint:"your@gmail.com (App Password)"},"AMAZON SES":{host:"email-smtp.<region>.amazonaws.com",port:"587",security:"STARTTLS",usernameHint:"SES SMTP Username"},"ZOHO MAIL":{host:"smtp.zoho.com",port:"587",security:"STARTTLS",usernameHint:"you@yourdomain.com"},"OUTLOOK / OFFICE 365":{host:"smtp.office365.com",port:"587",security:"STARTTLS",usernameHint:"you@yourdomain.com"},"SENDGRID (SMTP)":{host:"smtp.sendgrid.net",port:"587",security:"STARTTLS",usernameHint:"apikey (literal)"},"MAILGUN (SMTP)":{host:"smtp.mailgun.org",port:"587",security:"STARTTLS",usernameHint:"postmaster@yourdomain"},"POSTMARK (SMTP)":{host:"smtp.postmarkapp.com",port:"587",security:"STARTTLS",usernameHint:"Server Token"},"SPARKPOST (SMTP)":{host:"smtp.sparkpostmail.com",port:"587",security:"STARTTLS",usernameHint:"SMTP Username"},CUSTOM:{host:"",port:"",security:"STARTTLS"}},_b={SMTP:{},SENDMAIL:{host:"",port:"",security:"NONE",username:"",password:""},MAILGUN:{host:"smtp.mailgun.org",port:"587",security:"STARTTLS"}},Sb=({isOpen:s,onClose:a,onSave:t,integration:r})=>{const[i,n]=l.useState(!1),[o,m]=l.useState({smtpProvider:"",driver:"SMTP",providerName:"",host:"",port:"2525",security:"NONE",username:"",password:"",emailFromAddress:"",emailFromName:""}),g=o.driver!=="SENDMAIL";l.useEffect(()=>{if(!r)return;const f=(r==null?void 0:r.config)||{},p=((f==null?void 0:f.driver)||"SMTP").toUpperCase(),N=p==="SENDMAIL"?"SENDMAIL":p==="MAILGUN"?"MAILGUN":"SMTP";m({smtpProvider:((f==null?void 0:f.smtp_provider)||"").toUpperCase(),driver:N,providerName:(f==null?void 0:f.provider_name)||"",host:(f==null?void 0:f.host)||(N==="MAILGUN"?"smtp.mailgun.org":""),port:String((f==null?void 0:f.port)||(N==="MAILGUN"?"587":"")),security:(f==null?void 0:f.security)||(N==="MAILGUN"?"STARTTLS":"NONE"),username:(f==null?void 0:f.username)||(r==null?void 0:r.api_key)||"",password:(f==null?void 0:f.password)||(r==null?void 0:r.api_secret)||"",emailFromAddress:(f==null?void 0:f.from_address)||"",emailFromName:(f==null?void 0:f.from_name)||""})},[r]);const b=f=>{if(!g)return;const p=wb[f];p&&m(N=>({...N,host:N.host||p.host,port:N.port||p.port,security:N.security||p.security}))},d=f=>{const p=_b[f];m(N=>({...N,driver:f,host:p.host!==void 0?p.host:N.host,port:p.port!==void 0?String(p.port):N.port,security:p.security??N.security,username:f==="SENDMAIL"?"":N.username,password:f==="SENDMAIL"?"":N.password}))},v=(f,p)=>{m(N=>({...N,[f]:p}))},x=()=>{const f=["driver","providerName","emailFromAddress"],p=["smtpProvider","host","port","security","username","password"],P=(g?[...f,...p]:f).filter($=>!String(o[$]??"").trim()),w=[];return o.emailFromAddress&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.emailFromAddress)&&w.push("Email From Address is invalid"),g&&o.port&&!/^\d+$/.test(o.port)&&w.push("Port must be numeric"),{missing:P,mistakes:w}},u=()=>{const{missing:f,mistakes:p}=x();if(f.length||p.length){const P=[];f.length&&P.push(`Missing: ${f.join(", ")}`),p.length&&P.push(`Errors: ${p.join(", ")}`),Z.error(P.join(" | "));return}const N={driver:o.driver,api_key:o.username,api_secret:o.password,config:{smtp_provider:o.smtpProvider,driver:o.driver,provider_name:o.providerName,host:g?o.host:"",port:g?Number(o.port):void 0,security:g?o.security:"NONE",username:g?o.username:"",password:g?o.password:"",from_address:o.emailFromAddress,from_name:o.emailFromName}};t(N)},c=()=>a();return s?e.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-2xl shadow-2xl overflow-hidden animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 text-white bg-gradient-to-r from-blue-600 to-indigo-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ds,{className:"h-6 w-6"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold",children:"Email API Configuration"})]}),e.jsx("button",{onClick:c,className:"hover:text-gray-200",children:e.jsx(ns,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["SMTP Provider",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:o.smtpProvider,onChange:f=>{const p=(f.target.value||"").toUpperCase();v("smtpProvider",p),b(p)},className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",disabled:!g,children:vb.map((f,p)=>e.jsx("option",{value:p===0?"":f.toUpperCase(),disabled:p===0,children:p===0?"Select":f},f))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Driver",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:o.driver,onChange:f=>d(f.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:Nb.map(f=>e.jsx("option",{value:f,children:f},f))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Provider Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.providerName,onChange:f=>v("providerName",f.target.value),placeholder:"Provider Title",className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Host",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(mh,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:o.host,onChange:f=>v("host",f.target.value),placeholder:o.driver==="MAILGUN"?"smtp.mailgun.org":"smtp.mailtrap.io",className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Port",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.port,onChange:f=>v("port",f.target.value.replace(/[^\d]/g,"")),placeholder:o.driver==="MAILGUN"?"587":"2525",className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"}),e.jsx("p",{className:"text-[11px] text-gray-500",children:"2525, 25, 587, 465"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Security"}),e.jsxs("div",{className:"relative",children:[e.jsx(at,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsxs("select",{value:o.security,onChange:f=>v("security",f.target.value),className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"NONE",children:"No Encryption"}),e.jsx("option",{value:"STARTTLS",children:"STARTTLS"}),e.jsx("option",{value:"SSL_TLS",children:"SSL/TLS"})]})]})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Username",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xh,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:o.username,onChange:f=>v("username",f.target.value),placeholder:o.driver==="MAILGUN"?"postmaster@yourdomain":"username / SMTP user",className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Password",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:i?"text":"password",value:o.password,onChange:f=>v("password",f.target.value),placeholder:"password / app password",className:"w-full pl-10 pr-10 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"}),e.jsx("button",{type:"button",onClick:()=>n(f=>!f),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:i?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Email From Address",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(uh,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"email",value:o.emailFromAddress,onChange:f=>v("emailFromAddress",f.target.value),placeholder:"example@gmail.com",className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Email From Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.emailFromName,onChange:f=>v("emailFromName",f.target.value),placeholder:"Resale Expert",className:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-3 md:col-span-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Jn,{className:"h-4 w-4 text-blue-600 mt-0.5"}),e.jsxs("p",{className:"text-xs text-blue-800",children:["Driver ",e.jsx("b",{children:"SENDMAIL"})," server ke local MTA (postfix/exim) ko use karta haiâ€”SMTP fields ki zarurat nahi.",e.jsx("br",{}),e.jsx("b",{children:"MAILGUN"})," choose karoge to SMTP presets auto fill ho jayenge."]})]})})]})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex flex-col sm:flex-row gap-3 sm:justify-end border-t",children:[e.jsx("button",{onClick:c,className:"px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{onClick:u,className:"px-6 py-2.5 rounded-lg text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow",children:"Save Email API"})]})]})}):null},rm={getIntegration:async()=>(await Ae.get("/sms-integration")).data,saveIntegration:async s=>(await Ae.post("/sms-integration",s)).data,toggleIntegration:async s=>(await Ae.post("/sms-integration/toggle",s)).data,syncIntegration:async s=>(await Ae.post("/sms-integration/sync",s)).data},bn={getIntegration:async()=>{try{return await Ae.get("/razorpay-integration/get")}catch(s){throw console.error("âŒ [Razorpay] Get Integration Error:",s),s}},saveIntegration:async s=>{try{return await Ae.post("/razorpay-integration/save",s)}catch(a){throw console.error("âŒ [Razorpay] Save Integration Error:",a),a}},toggleIntegration:async s=>{try{return await Ae.post("/razorpay-integration/toggle",s)}catch(a){throw console.error("âŒ [Razorpay] Toggle Integration Error:",a),a}},createOrder:async s=>{try{return await Ae.post("/razorpay-integration/create-order",s)}catch(a){throw console.error("âŒ [Razorpay] Create Order Error:",a),a}}},$r={getIntegration:async()=>{try{return await Ae.get("/stripe-integration/get")}catch(s){throw console.error("âŒ [Stripe] Get Integration Error:",s),s}},saveIntegration:async s=>{try{return await Ae.post("/stripe-integration/save",s)}catch(a){throw console.error("âŒ [Stripe] Save Integration Error:",a),a}},toggleIntegration:async s=>{try{return await Ae.post("/stripe-integration/toggle",s)}catch(a){throw console.error("âŒ [Stripe] Toggle Integration Error:",a),a}},createPaymentIntent:async s=>{try{return await Ae.post("/stripe-integration/create-payment-intent",s)}catch(a){throw console.error("âŒ [Stripe] Create PaymentIntent Error:",a),a}},createCheckoutSession:async s=>{try{return await Ae.post("/stripe-integration/create-checkout-session",s)}catch(a){throw console.error("âŒ [Stripe] Create Checkout Session Error:",a),a}},createRefund:async s=>{try{return await Ae.post("/stripe-integration/refund",s)}catch(a){throw console.error("âŒ [Stripe] Create Refund Error:",a),a}},verifyWebhookTest:async s=>{try{return await Ae.post("/stripe-integration/verify-webhook-test",s)}catch(a){throw console.error("âŒ [Stripe] Verify Webhook Test Error:",a),a}}},fn={getIntegration:async()=>(await Ae.get("/email-integration")).data,saveIntegration:async s=>(await Ae.post("/email-integration",s)).data,toggleIntegration:async s=>(await Ae.post("/email-integration/toggle",s)).data,syncIntegration:async s=>(await Ae.post("/email-integration/sync",s)).data},kb=({isOpen:s,onClose:a,onSave:t,integration:r})=>{const[i,n]=l.useState(""),[o,m]=l.useState(!1);if(l.useEffect(()=>{var d,v;const b=(r==null?void 0:r.api_key)||((d=r==null?void 0:r.config)==null?void 0:d.api_key)||((v=r==null?void 0:r.config)==null?void 0:v.token)||"";n(b??"")},[r]),!s)return null;const g=async()=>{const b=i.trim();if(!b){Z.error("Please enter your ChatGPT (OpenAI) API key.");return}try{m(!0),t({provider:"OpenAI",api_key:b,is_active:!0})}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-2xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 text-white bg-gradient-to-r from-blue-600 to-indigo-600",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold",children:"ChatGPT Setup"}),e.jsx("button",{onClick:a,className:"hover:text-gray-200",children:e.jsx(ns,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ChatGPT API Key"}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:b=>n(b.target.value),placeholder:"sk-********************************",className:"w-full pl-10 pr-3 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Enter your OpenAI API key. We recommend storing secrets on the server and using a proxy."})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex gap-3 justify-end border-t",children:[e.jsx("button",{onClick:a,className:"px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:o,className:"px-6 py-2.5 rounded-lg text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow disabled:opacity-70",children:o?"Updating...":"Update"})]})]})})},Cb=({isOpen:s,onClose:a,onSave:t,integration:r})=>{const[i,n]=l.useState(!1),[o,m]=l.useState({phoneNumberId:"",wabaId:"",accessToken:"",webhookUrl:"",isActive:!1});l.useEffect(()=>{const x=(r==null?void 0:r.config)||{};m({phoneNumberId:(x==null?void 0:x.phone_number_id)||"",wabaId:(x==null?void 0:x.waba_id)||"",accessToken:(x==null?void 0:x.access_token)||"",webhookUrl:(x==null?void 0:x.webhook_url)||"",isActive:!!(r!=null&&r.is_enabled)})},[r]);const g=(x,u)=>{m(c=>({...c,[x]:u}))},b=()=>{const x=[],u=[];return o.phoneNumberId.trim()||x.push("Phone Number ID"),o.wabaId.trim()||x.push("WABA ID"),o.accessToken.trim()||x.push("Access Token"),o.webhookUrl.trim()&&(/^(http|https):\/\/[^ "]+$/.test(o.webhookUrl.trim())||u.push("Webhook URL is invalid")),{missing:x,errors:u}},d=()=>{const{missing:x,errors:u}=b();if(x.length||u.length){const c=[];x.length&&c.push(`Missing: ${x.join(", ")}`),u.length&&c.push(`Errors: ${u.join(", ")}`),Z.error(c.join(" | "));return}t({provider:"Meta",phone_number_id:o.phoneNumberId.trim(),waba_id:o.wabaId.trim(),access_token:o.accessToken.trim(),webhook_url:o.webhookUrl.trim()||null,is_active:o.isActive})},v=()=>a();return s?e.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-2xl shadow-2xl overflow-hidden animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 text-white bg-gradient-to-r from-emerald-600 to-teal-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Cs,{className:"h-6 w-6"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold",children:"WhatsApp Business (Meta) Configuration"})]}),e.jsx("button",{onClick:v,className:"hover:text-gray-200",children:e.jsx(ns,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Phone Number ID",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Cs,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:o.phoneNumberId,onChange:x=>g("phoneNumberId",x.target.value),placeholder:"e.g. 123456789012345",className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["WABA ID (WhatsApp Business Account ID)",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(at,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",value:o.wabaId,onChange:x=>g("wabaId",x.target.value),placeholder:"e.g. 987654321098765",className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-emerald-500"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Access Token",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(mn,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:i?"text":"password",value:o.accessToken,onChange:x=>g("accessToken",x.target.value),placeholder:"Paste your permanent access token",className:"w-full pl-10 pr-10 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-emerald-500"}),e.jsx("button",{type:"button",onClick:()=>n(x=>!x),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:i?e.jsx(dr,{className:"h-4 w-4"}):e.jsx(ks,{className:"h-4 w-4"})})]}),e.jsxs("p",{className:"text-[11px] text-gray-500 mt-1",children:["Security tip: Token ko kabhi frontend storage me mat rakho. Server par environment variable (e.g. ",e.jsx("code",{children:"WA_ACCESS_TOKEN"}),") me store karein."]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Webhook URL (optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(za,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"url",value:o.webhookUrl,onChange:x=>g("webhookUrl",x.target.value),placeholder:"https://your-domain.com/webhooks/whatsapp",className:"w-full pl-10 pr-3 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block",children:"Enable Integration"}),e.jsxs("div",{className:"flex items-center gap-2 h-[44px]",children:[e.jsx("input",{id:"wa-active",type:"checkbox",checked:o.isActive,onChange:x=>g("isActive",x.target.checked)}),e.jsx("label",{htmlFor:"wa-active",className:"text-sm text-gray-700",children:"Active"})]})]}),e.jsx("div",{className:"rounded-lg border border-emerald-200 bg-gradient-to-r from-emerald-50 to-teal-50 p-3 md:col-span-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Jn,{className:"h-4 w-4 text-emerald-600 mt-0.5"}),e.jsxs("p",{className:"text-xs text-emerald-800",children:[e.jsx("b",{children:"Meta WhatsApp Cloud API"})," ke liye aapko"," ",e.jsx("b",{children:"Phone Number ID"}),", ",e.jsx("b",{children:"WABA ID"})," aur"," ",e.jsx("b",{children:"Permanent Access Token"})," chahiye hota hai. Webhook URL aapke backend ka endpoint hoga, jahan Meta message events post karta hai (verification ke saath)."]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3 flex items-start gap-2",children:[e.jsx(_t,{className:"h-4 w-4 text-gray-500 mt-0.5"}),e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("b",{children:"Phone Number ID"})," & ",e.jsx("b",{children:"WABA ID"})," Meta Business settings me milte hain."]})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3 flex items-start gap-2",children:[e.jsx(gh,{className:"h-4 w-4 text-gray-500 mt-0.5"}),e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("b",{children:"Webhook"})," verify karne ke liye hub challenge/verify-token logic aapke backend me implement hona chahiye."]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex flex-col sm:flex-row gap-3 sm:justify-end border-t",children:[e.jsx("button",{onClick:v,className:"px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition",children:"Cancel"}),e.jsx("button",{onClick:d,className:"px-6 py-2.5 rounded-lg text-white bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 shadow",children:"Save WhatsApp API"})]})]})}):null},Ab=()=>{var he,se,ge,ee,de,U,X,re,fe,G;const{user:s}=Hs(),[a,t]=l.useState([]),[r,i]=l.useState(!0),[n,o]=l.useState("all"),[m,g]=l.useState({}),[b,d]=l.useState(!1),[v,x]=l.useState(null),[u,c]=l.useState(!1),[f,p]=l.useState(null),[N,P]=l.useState(!1),[w,$]=l.useState(null),[y,k]=l.useState(!1),[R,F]=l.useState(null),[T,j]=l.useState(!1),[E,V]=l.useState(null),[W,B]=l.useState(!1),[M,A]=l.useState(null);l.useEffect(()=>{D()},[]);const L=me=>{if(!me)return null;const oe=me==null?void 0:me.data;return oe!=null&&oe.success&&(oe!=null&&oe.data)||oe!=null&&oe.data?oe.data:oe||(me!=null&&me.success&&(me!=null&&me.data)?me.data:me)},D=async()=>{var me,oe,Fe,$e,Le,je,_e,ve,Pe,We,pe,O,Ie,ze,xe,Ee;try{i(!0);let Ke=null;try{const we=await rm.getIntegration();Ke=L(we)}catch(we){((me=we==null?void 0:we.response)==null?void 0:me.status)!==404&&console.error("SMS fetch error",we)}let Xe=null;try{const we=await bn.getIntegration(),Be=L(we);Xe=Be!=null&&Be.success&&(Be!=null&&Be.data)?Be.data:Be}catch(we){((oe=we==null?void 0:we.response)==null?void 0:oe.status)!==404&&console.error("Razorpay fetch error",we)}let ye=null;try{if($r!=null&&$r.getIntegration){const we=await $r.getIntegration();ye=L(we)}}catch(we){console.info("Stripe fetch skipped/failed",we)}let Ce=null;try{const we=await fn.getIntegration();Ce=L(we)}catch(we){((Fe=we==null?void 0:we.response)==null?void 0:Fe.status)!==404&&console.error("Email fetch error",we)}const _={id:String((Ce==null?void 0:Ce.id)??"email-smtp"),name:((Ce==null?void 0:Ce.provider)||(($e=Ce==null?void 0:Ce.config)==null?void 0:$e.smtp_provider)||"SMTP").toString().toUpperCase(),description:"Send and receive emails via SMTP (Gmail/Zoho/SES/Mailgun).",category:"email",provider:(Ce==null?void 0:Ce.provider)&&(Ce==null?void 0:Ce.provider.toString())||"SMTP",is_enabled:(Ce==null?void 0:Ce.is_active)===1||(Ce==null?void 0:Ce.is_active)===!0,is_connected:!!((Ce!=null&&Ce.username||(Le=Ce==null?void 0:Ce.config)!=null&&Le.username)&&(Ce!=null&&Ce.password||(je=Ce==null?void 0:Ce.config)!=null&&je.password)&&(Ce!=null&&Ce.host||(_e=Ce==null?void 0:Ce.config)!=null&&_e.host)&&(Ce!=null&&Ce.port||(ve=Ce==null?void 0:Ce.config)!=null&&ve.port)),config:{driver:(Ce==null?void 0:Ce.driver)??"SMTP",smtp_provider:(((Pe=Ce==null?void 0:Ce.config)==null?void 0:Pe.smtp_provider)||(Ce==null?void 0:Ce.provider)||"SMTP").toString().toUpperCase(),host:((We=Ce==null?void 0:Ce.config)==null?void 0:We.host)??(Ce==null?void 0:Ce.host)??"",port:((pe=Ce==null?void 0:Ce.config)==null?void 0:pe.port)??(Ce==null?void 0:Ce.port)??"",security:((O=Ce==null?void 0:Ce.config)==null?void 0:O.security)??(Ce==null?void 0:Ce.security)??"STARTTLS",username:((Ie=Ce==null?void 0:Ce.config)==null?void 0:Ie.username)??(Ce==null?void 0:Ce.username)??"",password:((ze=Ce==null?void 0:Ce.config)==null?void 0:ze.password)??(Ce==null?void 0:Ce.password)??"",from_address:((xe=Ce==null?void 0:Ce.config)==null?void 0:xe.from_address)??(Ce==null?void 0:Ce.from_address)??"",from_name:((Ee=Ce==null?void 0:Ce.config)==null?void 0:Ee.from_name)??(Ce==null?void 0:Ce.from_name)??""},last_sync:(Ce==null?void 0:Ce.updated_at)??null,sync_status:Ce?"success":"never",instructions:Ce?"SMTP configured. You can update From name/address.":"Save SMTP settings to enable email sending."},ae={id:"sms-default",name:"SMS Integration",description:"Send SMS messages through your configured provider.",category:"communication",provider:(Ke==null?void 0:Ke.provider)||"SMS",is_enabled:(Ke==null?void 0:Ke.is_active)===1||(Ke==null?void 0:Ke.is_active)===!0,is_connected:!!(Ke!=null&&Ke.token),config:{sms_provider:(Ke==null?void 0:Ke.provider)||null,from_number:(Ke==null?void 0:Ke.sms_number)||null,sender_name:(Ke==null?void 0:Ke.sms_from)||null,token:(Ke==null?void 0:Ke.token)??null},last_sync:(Ke==null?void 0:Ke.updated_at)??null,sync_status:Ke!=null&&Ke.token?"success":"never",api_key:(Ke==null?void 0:Ke.api_key)??null,instructions:"Configure your SMS provider to send notifications and alerts.",webhook_url:(Ke==null?void 0:Ke.webhook_url)??null},ke={id:"whatsapp-business",name:"WhatsApp Business",description:"WhatsApp messaging for customer communication.",category:"communication",provider:"Meta",is_enabled:!1,is_connected:!1,config:{},last_sync:null,sync_status:"never",webhook_url:null,instructions:"Connect Meta WhatsApp Cloud API to enable WhatsApp messaging."},Me={id:"razorpay",name:"Razorpay",description:"Razorpay payment gateway for India â€” payments, subscriptions and webhooks.",category:"payment",provider:"Razorpay",is_enabled:(Xe==null?void 0:Xe.is_active)===1||(Xe==null?void 0:Xe.is_active)===!0,is_connected:!!(Xe!=null&&Xe.key_id),config:{currency:(Xe==null?void 0:Xe.currency)||"INR",mode:(Xe==null?void 0:Xe.mode)||"test",key_id:Xe!=null&&Xe.key_id?String(Xe.key_id):"",key_secret:(Xe==null?void 0:Xe.key_secret)??null,webhook_secret:(Xe==null?void 0:Xe.webhook_secret)??null,webhook_url:(Xe==null?void 0:Xe.webhook_url)??null},last_sync:(Xe==null?void 0:Xe.updated_at)??null,sync_status:Xe!=null&&Xe.key_id?"success":"never",api_key:(Xe==null?void 0:Xe.key_id)??null,webhook_url:(Xe==null?void 0:Xe.webhook_url)??null,instructions:"Set Key ID/Secret & Webhook secret on server. Use backend to create orders and verify signatures."},Ye={id:"stripe",name:"Stripe",description:"Stripe payment gateway â€” global payments, billing & webhooks.",category:"payment",provider:"Stripe",is_enabled:(ye==null?void 0:ye.is_active)===1||(ye==null?void 0:ye.is_active)===!0,is_connected:!!(ye!=null&&ye.publishable_key),config:{currency:(ye==null?void 0:ye.currency)||"INR",mode:(ye==null?void 0:ye.mode)||"test",publishable_key:(ye==null?void 0:ye.publishable_key)??"",secret_key:(ye==null?void 0:ye.secret_key)??null,webhook_secret:(ye==null?void 0:ye.webhook_secret)??null,webhook_url:(ye==null?void 0:ye.webhook_url)??null},last_sync:(ye==null?void 0:ye.updated_at)??null,sync_status:ye!=null&&ye.publishable_key?"success":"never",api_key:(ye==null?void 0:ye.publishable_key)??null,webhook_url:(ye==null?void 0:ye.webhook_url)??null,instructions:"Provide publishable & secret keys. Verify webhooks on the server."};t([_,ae,ke,Me,Ye,...[{id:"email-outlook",name:"Outlook",description:"Microsoft Outlook email integration (SMTP).",category:"email",provider:"Microsoft",is_enabled:!1,is_connected:!1,config:{},sync_status:"never",instructions:"Add your Outlook SMTP to use this."},{id:"ga",name:"Google Analytics",description:"Website analytics and tracking.",category:"analytics",provider:"Google",is_enabled:!1,is_connected:!1,config:{},sync_status:"never",instructions:"Connect Google Analytics to track website performance."},{id:"calendly",name:"Calendly",description:"Schedule meetings and appointments.",category:"scheduling",provider:"Calendly",is_enabled:!1,is_connected:!1,config:{},sync_status:"never",webhook_url:"https://your-domain.com/webhooks/calendly",instructions:"Integrate Calendly for automated appointment scheduling."},{id:"zapier",name:"Zapier",description:"Connect with 5000+ apps through Zapier.",category:"automation",provider:"Zapier",is_enabled:!1,is_connected:!1,config:{},sync_status:"never",webhook_url:"https://your-domain.com/webhooks/zapier",instructions:"Use Zapier to connect with third-party applications."},{id:"chatgpt",name:"ChatGPT",description:"Use OpenAI to generate text and automate workflows.",category:"ai",provider:"OpenAI",is_enabled:!1,is_connected:!1,config:{model:"gpt-4o-mini",system_prompt:"You are a helpful assistant for customer support.",max_tokens:1024,temperature:.7,token:null},last_sync:null,sync_status:"never",api_key:null,webhook_url:"https://your-domain.com/webhooks/chatgpt",instructions:"Add your OpenAI API key on the server (do NOT store keys in the frontend)."}]])}catch(Ke){console.error("Error fetching integrations:",Ke),Z.error("Failed to load integrations")}finally{i(!1)}},I=async(me,oe)=>{var Fe,$e,Le,je,_e,ve;t(Pe=>Pe.map(We=>We.id===me?{...We,is_enabled:oe}:We));try{const Pe=a.find(pe=>pe.id===me);if(!Pe)throw new Error("Integration not found");let We=null;Pe.id==="razorpay"||Pe.provider==="Razorpay"?We=await((Fe=bn.toggleIntegration)==null?void 0:Fe.call(bn,{active:oe})):Pe.id==="stripe"||Pe.provider==="Stripe"?We=await(($e=$r.toggleIntegration)==null?void 0:$e.call($r,{active:oe})):Pe.category==="email"?We=await((Le=fn.toggleIntegration)==null?void 0:Le.call(fn,{id:me,enabled:oe})):Pe.category==="communication"||Pe.id==="sms-default"||Pe.id==="whatsapp-business"||(Pe.id==="chatgpt"||Pe.category==="ai"||Pe.provider==="OpenAI"?Z.success(`ChatGPT ${oe?"enabled":"disabled"}`):Z.info("Toggle saved locally. Wire up a backend API for this provider.")),Z.success(`Integration ${oe?"enabled":"disabled"} successfully`)}catch(Pe){t(We=>We.map(pe=>pe.id===me?{...pe,is_enabled:!oe}:pe)),console.error("Toggle error:",((je=Pe==null?void 0:Pe.response)==null?void 0:je.data)||Pe),Z.error(((ve=(_e=Pe==null?void 0:Pe.response)==null?void 0:_e.data)==null?void 0:ve.message)||"Failed to update integration")}},H=me=>{const oe=a.find(Fe=>Fe.id===me);if(oe){if(oe.category==="communication"&&(oe.id==="sms-default"||oe.name.includes("SMS"))){x(oe),d(!0);return}if(oe.id==="razorpay"||oe.provider==="Razorpay"){p(oe),c(!0);return}if(oe.id==="stripe"||oe.provider==="Stripe"){$(oe),P(!0);return}if(oe.category==="email"){F(oe),k(!0);return}if(oe.id==="whatsapp-business"||oe.provider==="Meta"){A(oe),B(!0);return}if(oe.id==="chatgpt"||oe.category==="ai"||oe.provider==="OpenAI"){V(oe),j(!0);return}Z.info("No configuration UI for this integration yet.")}},h=async me=>{var oe,Fe,$e;try{const Le={provider:me.provider,apiKey:me.apiKey,token:me.token,smsNumber:me.smsNumber,smsFrom:me.smsFrom,createdBy:(s==null?void 0:s.id)||1},je=await rm.saveIntegration(Le);await D(),Z.success("SMS configuration saved successfully"),d(!1),x(null)}catch(Le){console.error("SMS save error",((oe=Le==null?void 0:Le.response)==null?void 0:oe.data)||Le),Z.error((($e=(Fe=Le==null?void 0:Le.response)==null?void 0:Fe.data)==null?void 0:$e.message)||"Failed to save SMS configuration")}},Y=async me=>{var oe,Fe,$e;try{const Le={provider:"Razorpay",key_id:me.keyId,key_secret:me.keySecret??null,webhook_secret:me.webhookSecret??null,webhook_url:me.webhookUrl??null,is_active:me.isActive?1:0,updatedBy:(s==null?void 0:s.id)||1},je=await bn.saveIntegration(Le);await D(),Z.success("Razorpay configuration saved successfully"),c(!1),p(null)}catch(Le){console.error("Razorpay save error",((oe=Le==null?void 0:Le.response)==null?void 0:oe.data)||Le),Z.error((($e=(Fe=Le==null?void 0:Le.response)==null?void 0:Fe.data)==null?void 0:$e.message)||"Failed to save Razorpay configuration")}},K=async me=>{var oe,Fe,$e;try{const Le={provider:"Stripe",publishable_key:me.publishableKey,secret_key:me.secretKey??null,webhook_secret:me.webhookSecret??null,webhook_url:me.webhookUrl??null,is_active:me.isActive?1:0,updatedBy:(s==null?void 0:s.id)||1},je=await $r.saveIntegration(Le);await D(),Z.success("Stripe configuration saved successfully"),P(!1),$(null)}catch(Le){console.error("Stripe save error",((oe=Le==null?void 0:Le.response)==null?void 0:oe.data)||Le),Z.error((($e=(Fe=Le==null?void 0:Le.response)==null?void 0:Fe.data)==null?void 0:$e.message)||"Failed to save Stripe configuration")}},q=async me=>{var oe,Fe,$e;try{const Le=await fn.saveIntegration(me);await D(),Z.success("Email configuration saved successfully"),k(!1),F(null)}catch(Le){console.error("Email save error",((oe=Le==null?void 0:Le.response)==null?void 0:oe.data)||Le),Z.error((($e=(Fe=Le==null?void 0:Le.response)==null?void 0:Fe.data)==null?void 0:$e.message)||"Failed to save Email configuration")}},ne=async me=>{var oe,Fe,$e;try{Z.success("ChatGPT API key updated âœ…"),await D(),j(!1),V(null)}catch(Le){console.error("ChatGPT save error",((oe=Le==null?void 0:Le.response)==null?void 0:oe.data)||Le),Z.error((($e=(Fe=Le==null?void 0:Le.response)==null?void 0:Fe.data)==null?void 0:$e.message)||"Failed to save ChatGPT configuration")}},le=async me=>{var oe,Fe,$e;try{Z.success("WhatsApp Business configuration saved successfully"),await D(),B(!1),A(null)}catch(Le){console.error("WhatsApp save error",((oe=Le==null?void 0:Le.response)==null?void 0:oe.data)||Le),Z.error((($e=(Fe=Le==null?void 0:Le.response)==null?void 0:Fe.data)==null?void 0:$e.message)||"Failed to save WhatsApp configuration")}},S=me=>{switch(me){case"success":return"text-green-600";case"error":return"text-red-600";case"pending":return"text-yellow-600";default:return"text-gray-600"}},C=me=>{switch(me){case"success":return e.jsx(bs,{className:"h-4 w-4"});case"error":return e.jsx(Ta,{className:"h-4 w-4"});case"pending":return e.jsx(na,{className:"h-4 w-4 animate-spin"});default:return e.jsx(Ta,{className:"h-4 w-4"})}},J=me=>{switch(me){case"email":return e.jsx(Ds,{className:"h-5 w-5"});case"communication":return e.jsx(Bt,{className:"h-5 w-5"});case"payment":return e.jsx(ka,{className:"h-5 w-5"});case"analytics":return e.jsx(Ot,{className:"h-5 w-5"});case"scheduling":return e.jsx(Ts,{className:"h-5 w-5"});case"automation":return e.jsx(Ft,{className:"h-5 w-5"});default:return e.jsx(_t,{className:"h-5 w-5"})}},ue=n==="all"?a:a.filter(me=>me.category===n),Q=["all",...Array.from(new Set(a.map(me=>me.category)))];return r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-2 sm:space-y-0",children:[e.jsx(Bs,{to:"/dashboard/settings",children:e.jsxs(ss,{variant:"outline",className:"flex items-center",children:[e.jsx(ga,{className:"h-4 w-4 mr-2"}),"Back to Settings"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Integrations"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Connect with third-party services and tools"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("div",{className:"flex space-x-4 overflow-x-auto",children:Q.map(me=>e.jsx("button",{onClick:()=>o(me),className:`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap ${n===me?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:me==="all"?"All Integrations":me.charAt(0).toUpperCase()+me.slice(1)},me))})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6",children:ue.map(me=>{var oe;return e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center",children:J(me.category)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:me.name}),e.jsx("p",{className:"text-sm text-gray-600",children:me.provider})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`flex items-center space-x-1 ${S(me.sync_status)}`,children:C(me.sync_status)}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:me.is_enabled,onChange:Fe=>I(me.id,Fe.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:me.description}),me.instructions&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-xs text-blue-700",children:me.instructions})}),me.is_enabled&&Object.keys(me.config||{}).length>0&&e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Configuration:"}),Object.entries(me.config).filter(([Fe,$e])=>$e!=null&&$e!==""&&Fe!=="password"&&Fe!=="token").map(([Fe,$e])=>e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-600 capitalize",children:[Fe.replace(/_/g," "),":"]}),e.jsx("span",{className:"text-gray-900",children:String($e)})]},Fe))]}),me.api_key&&me.is_enabled&&e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-xs text-gray-600 block mb-1",children:"API Key:"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs text-gray-900 font-mono bg-gray-100 p-2 pr-10 rounded border break-all",children:me.api_key}),e.jsx("button",{onClick:()=>{var Fe;(Fe=navigator.clipboard)==null||Fe.writeText(me.api_key||""),Z.success("API Key copied to clipboard")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-blue-600 hover:text-blue-800",children:e.jsx(Xt,{className:"h-4 w-4"})})]})]}),((oe=me.config)==null?void 0:oe.token)&&me.is_enabled&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Token:"}),e.jsx("button",{onClick:()=>g(Fe=>({...Fe,[`${me.id}_token`]:!Fe[`${me.id}_token`]})),className:"text-xs text-blue-600 hover:text-blue-800",children:m[`${me.id}_token`]?e.jsxs(e.Fragment,{children:[e.jsx(dr,{className:"h-3 w-3 inline mr-1"}),"Hide"]}):e.jsxs(e.Fragment,{children:[e.jsx(ks,{className:"h-3 w-3 inline mr-1"}),"Show"]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs text-gray-900 font-mono bg-gray-100 p-2 pr-10 rounded border",children:m[`${me.id}_token`]?me.config.token:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("button",{onClick:()=>{var Fe;(Fe=navigator.clipboard)==null||Fe.writeText(me.config.token||""),Z.success("Token copied to clipboard")},className:"absolute right-2 top-1/2 -translate-y-1/2 text-blue-600 hover:text-blue-800",children:e.jsx(Xt,{className:"h-4 w-4"})})]})]}),me.webhook_url&&me.is_enabled&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(za,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Webhook URL:"})]}),e.jsx("div",{className:"text-xs text-gray-900 font-mono bg-gray-100 p-2 rounded break-all",children:me.webhook_url})]}),e.jsxs("div",{className:"space-y-3",children:[me.last_sync&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Last sync"," ",(()=>{try{return new Date(me.last_sync).toLocaleString()}catch{return me.last_sync}})()]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(ss,{variant:"outline",size:"sm",onClick:()=>H(me.id),children:[e.jsx(Yt,{className:"h-3 w-3 mr-1"}),"Configure"]})})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Status:"}),e.jsx("div",{className:"flex items-center space-x-1",children:me.is_enabled&&me.is_connected?e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"h-3 w-3 text-green-600"}),e.jsx("span",{className:"text-xs text-green-600",children:"Connected"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ta,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:"text-xs text-red-600",children:"Not Connected"})]})})]})})]},me.id)})}),e.jsx(fb,{isOpen:b,onClose:()=>{d(!1),x(null)},onSave:h,integration:v}),e.jsx(yb,{isOpen:u,onClose:()=>{c(!1),p(null)},onSave:Y,integration:f?{id:f.id,api_key:f.api_key??null,config:f.config??null,is_enabled:f.is_enabled??!1}:null}),e.jsx(jb,{isOpen:N,onClose:()=>{P(!1),$(null)},onSave:K,integration:w?{id:w.id,api_key:w.api_key??null,config:w.config??null,is_enabled:w.is_enabled??!1}:null}),e.jsx(Sb,{isOpen:y,onClose:()=>{k(!1),F(null)},onSave:q,integration:R?{id:R.id,api_secret:((he=R.config)==null?void 0:he.password)??"",api_key:((se=R.config)==null?void 0:se.username)??"",config:{smtp_provider:(((ge=R.config)==null?void 0:ge.smtp_provider)||R.name||"SMTP").toUpperCase(),driver:"SMTP",provider_name:R.name,host:((ee=R.config)==null?void 0:ee.host)||"",port:((de=R.config)==null?void 0:de.port)||"",security:((U=R.config)==null?void 0:U.security)||"NONE",username:((X=R.config)==null?void 0:X.username)||"",password:((re=R.config)==null?void 0:re.password)||"",from_address:((fe=R.config)==null?void 0:fe.from_address)||"",from_name:((G=R.config)==null?void 0:G.from_name)||""},is_enabled:R.is_enabled??!1}:null}),e.jsx(kb,{isOpen:T,onClose:()=>{j(!1),V(null)},onSave:ne,integration:E?{id:E.id,is_enabled:E.is_enabled??!1,api_key:E.api_key??null,config:E.config??null}:null}),e.jsx(Cb,{isOpen:W,onClose:()=>{B(!1),A(null)},onSave:le,integration:M?{id:M.id,config:M.config??null,is_enabled:M.is_enabled??!1}:null})]})},Pb=()=>{const{user:s}=Hs(),[a,t]=l.useState(null),[r,i]=l.useState(!0),[n,o]=l.useState(!1),[m,g]=l.useState("scoring"),b=[{key:"scoring",label:"Lead Scoring",icon:e.jsx(rt,{className:"h-4 w-4"})},{key:"recommendations",label:"Recommendations",icon:e.jsx(Is,{className:"h-4 w-4"})},{key:"chatbot",label:"Chatbot",icon:e.jsx(Bt,{className:"h-4 w-4"})},{key:"communications",label:"Auto Communications",icon:e.jsx(Ds,{className:"h-4 w-4"})},{key:"analytics",label:"Predictive Analytics",icon:e.jsx(Rs,{className:"h-4 w-4"})}];l.useEffect(()=>{d()},[]);const d=async()=>{try{i(!0),t({lead_scoring:{enabled:!0,model:"advanced",confidence_threshold:.75,auto_update_scores:!0,factors:{email_engagement:25,website_activity:20,demographic_data:15,interaction_frequency:25,budget_qualification:15}},property_recommendations:{enabled:!0,algorithm:"collaborative_filtering",max_recommendations:10,update_frequency:"daily",consider_budget:!0,consider_location:!0,consider_preferences:!0},chatbot:{enabled:!1,personality:"professional",response_tone:"helpful",auto_escalate:!0,escalation_triggers:["pricing","technical_support","complaints"],business_hours_only:!0,languages:["en","es"]},automated_communications:{enabled:!0,welcome_emails:!0,follow_up_reminders:!0,property_alerts:!0,appointment_confirmations:!0,lead_nurturing:!1,personalization_level:"medium"},predictive_analytics:{enabled:!0,sales_forecasting:!0,market_trend_analysis:!1,customer_lifetime_value:!0,churn_prediction:!1,price_optimization:!1}})}catch(c){console.error("Error fetching AI settings:",c),wt.error("Failed to load AI settings")}finally{i(!1)}},v=async()=>{if(a)try{o(!0),await new Promise(c=>setTimeout(c,1e3)),wt.success("AI settings saved successfully")}catch(c){console.error("Error saving AI settings:",c),wt.error("Failed to save AI settings")}finally{o(!1)}},x=(c,f,p)=>{a&&t({...a,[c]:{...a[c],[f]:p}})},u=(c,f,p,N)=>{a&&t({...a,[c]:{...a[c],[f]:{...a[c][f],[p]:N}}})};return r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ia,{size:"lg"})}):a?e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 space-y-2 sm:space-y-0",children:[e.jsx(Bs,{to:"/dashboard/settings",children:e.jsxs(ss,{variant:"outline",className:"flex items-center",children:[e.jsx(ga,{className:"h-4 w-4 mr-2"}),"Back to Settings"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"AI Settings"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Configure AI features and automation"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3 justify-end",children:[e.jsxs(ss,{variant:"outline",onClick:d,className:"flex items-center justify-center w-full sm:w-auto",children:[e.jsx(pc,{className:"h-4 w-4 mr-2"}),"Reset"]}),e.jsxs(ss,{onClick:v,disabled:n,className:"flex items-center justify-center w-full sm:w-auto",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),n?"Saving...":"Save Settings"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(Va,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"AI-Powered CRM"}),e.jsx("p",{className:"text-gray-600",children:"Enhance your CRM with artificial intelligence and automation"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(rt,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Lead Scoring"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Automatically score leads based on behavior and demographics"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Is,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Smart Recommendations"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered property recommendations for buyers"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Rs,{className:"h-5 w-5 text-orange-600"}),e.jsx("span",{className:"font-medium",children:"Predictive Analytics"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Forecast sales trends and market opportunities"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-4 overflow-x-auto no-scrollbar px-4 py-2","aria-label":"Tabs",children:b.map(({key:c,label:f,icon:p})=>e.jsxs("button",{onClick:()=>g(c),className:`flex items-center space-x-2 py-2 px-3 border-b-2 font-medium text-sm flex-shrink-0 transition-colors ${m===c?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[p,e.jsx("span",{children:f})]},c))})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[m==="scoring"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Lead Scoring Configuration"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.lead_scoring.enabled,onChange:c=>x("lead_scoring","enabled",c.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-blue-600 relative after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:h-5 after:w-5 after:bg-white after:border after:border-gray-300 after:rounded-full after:transition-all peer-checked:after:translate-x-full"})]})]}),a.lead_scoring.enabled&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scoring Model"}),e.jsxs("select",{value:a.lead_scoring.model,onChange:c=>x("lead_scoring","model",c.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"basic",children:"Basic Model"}),e.jsx("option",{value:"advanced",children:"Advanced Model"}),e.jsx("option",{value:"custom",children:"Custom Model"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Confidence Threshold (",(a.lead_scoring.confidence_threshold*100).toFixed(0),"%)"]}),e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:a.lead_scoring.confidence_threshold,onChange:c=>x("lead_scoring","confidence_threshold",parseFloat(c.target.value)),className:"w-full"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsx("input",{type:"checkbox",checked:a.lead_scoring.auto_update_scores,onChange:c=>x("lead_scoring","auto_update_scores",c.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Auto-update scores when new data is available"})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-4",children:["Scoring Factors (Total:"," ",Object.values(a.lead_scoring.factors).reduce((c,f)=>c+f,0),"%)"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(a.lead_scoring.factors).map(([c,f])=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("label",{className:"text-sm text-gray-700 capitalize",children:c.replace("_"," ")}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"range",min:"0",max:"50",value:f,onChange:p=>u("lead_scoring","factors",c,parseInt(p.target.value)),className:"w-full sm:w-32"}),e.jsxs("span",{className:"text-sm text-gray-900 w-8",children:[f,"%"]})]})]},c))})]})]})]}),m==="recommendations"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Recommendations"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.property_recommendations.enabled,onChange:c=>x("property_recommendations","enabled",c.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.property_recommendations.enabled&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Algorithm"}),e.jsxs("select",{value:a.property_recommendations.algorithm,onChange:c=>x("property_recommendations","algorithm",c.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"collaborative_filtering",children:"Collaborative Filtering"}),e.jsx("option",{value:"content_based",children:"Content-Based"}),e.jsx("option",{value:"hybrid",children:"Hybrid Approach"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Recommendations"}),e.jsx("input",{type:"number",min:"1",max:"20",value:a.property_recommendations.max_recommendations,onChange:c=>x("property_recommendations","max_recommendations",parseInt(c.target.value)),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Update Frequency"}),e.jsxs("select",{value:a.property_recommendations.update_frequency,onChange:c=>x("property_recommendations","update_frequency",c.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"realtime",children:"Real-time"}),e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Recommendation Factors"}),e.jsx("div",{className:"space-y-3",children:[{key:"consider_budget",label:"Consider budget constraints"},{key:"consider_location",label:"Consider location preferences"},{key:"consider_preferences",label:"Consider property type preferences"}].map(({key:c,label:f})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.property_recommendations[c],onChange:p=>x("property_recommendations",c,p.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{className:"text-sm text-gray-700",children:f})]},c))})]})]})]}),m==="chatbot"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Chatbot"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.chatbot.enabled,onChange:c=>x("chatbot","enabled",c.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.chatbot.enabled&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Personality"}),e.jsxs("select",{value:a.chatbot.personality,onChange:c=>x("chatbot","personality",c.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"friendly",children:"Friendly"}),e.jsx("option",{value:"casual",children:"Casual"}),e.jsx("option",{value:"formal",children:"Formal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Response Tone"}),e.jsxs("select",{value:a.chatbot.response_tone,onChange:c=>x("chatbot","response_tone",c.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"helpful",children:"Helpful"}),e.jsx("option",{value:"informative",children:"Informative"}),e.jsx("option",{value:"empathetic",children:"Empathetic"}),e.jsx("option",{value:"direct",children:"Direct"})]})]})]}),e.jsx("div",{className:"space-y-3",children:[{key:"auto_escalate",label:"Auto-escalate complex queries to human agents"},{key:"business_hours_only",label:"Only operate during business hours"}].map(({key:c,label:f})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:a.chatbot[c],onChange:p=>x("chatbot",c,p.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{className:"text-sm text-gray-700",children:f})]},c))})]})]}),m==="communications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Automated Communications"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.automated_communications.enabled,onChange:c=>x("automated_communications","enabled",c.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.automated_communications.enabled&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Personalization Level"}),e.jsxs("select",{value:a.automated_communications.personalization_level,onChange:c=>x("automated_communications","personalization_level",c.target.value),className:"w-full md:w-1/2 border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"advanced",children:"Advanced"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Automated Messages"}),e.jsx("div",{className:"space-y-3",children:[{key:"welcome_emails",label:"Welcome emails for new leads",icon:e.jsx(Ds,{className:"h-4 w-4"})},{key:"follow_up_reminders",label:"Follow-up reminders for agents",icon:e.jsx(Ts,{className:"h-4 w-4"})},{key:"property_alerts",label:"Property match alerts for buyers",icon:e.jsx(Is,{className:"h-4 w-4"})},{key:"appointment_confirmations",label:"Appointment confirmations",icon:e.jsx(bs,{className:"h-4 w-4"})},{key:"lead_nurturing",label:"Lead nurturing campaigns",icon:e.jsx(Rs,{className:"h-4 w-4"})}].map(({key:c,label:f,icon:p})=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",checked:a.automated_communications[c],onChange:N=>x("automated_communications",c,N.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("div",{className:"text-blue-600",children:p}),e.jsx("label",{className:"text-sm text-gray-700 flex-1",children:f})]},c))})]})]})]}),m==="analytics"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Predictive Analytics"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.predictive_analytics.enabled,onChange:c=>x("predictive_analytics","enabled",c.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.predictive_analytics.enabled&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Xa,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Premium Feature"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Predictive analytics requires advanced AI models and significant computational resources. Some features may require additional subscription tiers."})]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Available Analytics"}),e.jsx("div",{className:"space-y-3",children:[{key:"sales_forecasting",label:"Sales forecasting and pipeline prediction"},{key:"market_trend_analysis",label:"Market trend analysis and insights"},{key:"customer_lifetime_value",label:"Customer lifetime value calculation"},{key:"churn_prediction",label:"Churn prediction and risk assessment"},{key:"price_optimization",label:"Property price optimization suggestions"}].map(({key:c,label:f})=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsx("label",{className:"text-sm text-gray-700 flex-1",children:f}),e.jsx("input",{type:"checkbox",checked:a.predictive_analytics[c],onChange:p=>x("predictive_analytics",c,p.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]},c))})]})]})]})]})]})]}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"AI Settings Not Available"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load AI settings. Please try again later."}),e.jsx(ss,{onClick:d,children:"Retry"})]})})};function Tb({isOpen:s,onClose:a,onImport:t,title:r}){const[i,n]=l.useState(!1),[o,m]=l.useState(null),g=v=>{var u;const x=(u=v.target.files)==null?void 0:u[0];x&&m(x)},b=async()=>{if(o){n(!0);try{await t(o),a()}finally{n(!1),m(null)}}},d=()=>{let v="";r.toLowerCase().includes("master type")?v=`name,status
Example Name,Active`:v=`value,status
Example Value,Active`;const x=new Blob([v],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");u.href=URL.createObjectURL(x),u.setAttribute("download",`${r.replace(/\s+/g,"_")}_Template.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u)};return e.jsx(ma,{isOpen:s,onClose:a,title:`Import ${r}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex border-b items-center justify-between",children:[e.jsx("h3",{className:"px-4 py-2 text-sm font-medium text-blue-600",children:"File Upload"}),e.jsxs("button",{onClick:d,className:"flex items-center gap-1 px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:[e.jsx(Ys,{size:16})," Download Template"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Select File (CSV or Excel)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"cursor-pointer bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded flex items-center gap-2",children:[e.jsx(dt,{size:16})," Choose File",e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:g,className:"hidden"})]}),e.jsx("span",{className:"text-sm",children:o?o.name:"No file selected"})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Supported formats: CSV, Excel (.xlsx, .xls)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm border rounded hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:b,disabled:i||!o,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:i?"Importing...":"Import"})]})]})})}const Ib=({onClose:s,onSubmit:a,initialData:t})=>{const[r,i]=l.useState({tabId:"",type1:"",value1:"",type2:"",value2:"",remarks:[""],status:"Active"}),[n,o]=l.useState(!1),[m,g]=l.useState(!1),[b,d]=l.useState(null),[v,x]=l.useState(!1),[u,c]=l.useState({tabOptions:[{value:"property",label:"Property"},{value:"buyer",label:"Buyer"},{value:"seller",label:"Seller"},{value:"lead",label:"Lead"}],typeOptions:[],valueOptions:[],type2Options:[],value2Options:[],statusOptions:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}]}),f=R=>typeof R=="string"?R:R.note||R.text||R.remark||"",p=async R=>{try{if(!R){c(j=>({...j,typeOptions:[],type2Options:[],valueOptions:[],value2Options:[]}));return}o(!0),d(null);const T=(await Nt.getAllMasterTypes(R)||[]).map(j=>({value:String(j.id),label:String(j.name??j.label??j.id)}));c(j=>({...j,typeOptions:T,type2Options:T}))}catch(F){console.error("Failed to load master types:",F),d(`Failed to load dropdown options: ${F instanceof Error?F.message:String(F)}`)}finally{o(!1)}},N=async(R,F=!1)=>{try{if(!R){c(E=>F?{...E,value2Options:[]}:{...E,valueOptions:[]});return}o(!0);const j=(await Nt.getMasterValues(R)||[]).map(E=>({value:String(E.id),label:String(E.value??E.name??E.label??E.id)}));c(E=>F?{...E,value2Options:j}:{...E,valueOptions:j})}catch(T){console.error("Failed to load master values:",T),d(`Failed to load dropdown options: ${T instanceof Error?T.message:String(T)}`)}finally{o(!1)}};l.useEffect(()=>{(async()=>{if(t){const F=t.tabId??t.tab_id??"",T=t.type1??"",j=t.type2??"",E=t.value1??"",V=t.value2??"",W=Array.isArray(t.remarks)?t.remarks.map(f):[""],B={tabId:F,type1:T,value1:E,type2:j,value2:V,remarks:W.length>0?W:[""],status:t.status??"Active"};i(B),B.tabId&&(await p(B.tabId),B.type1&&await N(B.type1,!1),B.type2&&await N(B.type2,!0)),x(!0)}else i({tabId:"",type1:"",value1:"",type2:"",value2:"",remarks:[""],status:"Active"}),x(!0)})()},[t]),l.useEffect(()=>{if(!v)return;const R=t&&(t.tabId??t.tab_id??"")||"";r.tabId&&r.tabId!==R&&(p(r.tabId),i(F=>({...F,type1:"",value1:"",type2:"",value2:""})))},[r.tabId,v]),l.useEffect(()=>{if(!v)return;const R=(t==null?void 0:t.type1)??"";r.type1&&(N(r.type1,!1),r.type1!==R&&i(F=>({...F,value1:""})))},[r.type1,v]),l.useEffect(()=>{if(!v)return;const R=(t==null?void 0:t.type2)??"";r.type2&&(N(r.type2,!0),r.type2!==R&&i(F=>({...F,value2:""})))},[r.type2,v]);const P=R=>{const F=R.target.name,T=R.target.value;i(j=>({...j,[F]:T}))},w=(R,F)=>{i(T=>{const j=[...T.remarks];return j[R]=F,{...T,remarks:j}})},$=()=>{i(R=>({...R,remarks:[...R.remarks,""]}))},y=R=>{i(F=>{if(F.remarks.length<=1)return F;const T=[...F.remarks];return T.splice(R,1),{...F,remarks:T}})},k=async R=>{var W,B,M,A;R.preventDefault();const F=((W=u.typeOptions.find(L=>L.value===r.type1))==null?void 0:W.label)||"",T=((B=u.type2Options.find(L=>L.value===r.type2))==null?void 0:B.label)||"",j=((M=u.valueOptions.find(L=>L.value===r.value1))==null?void 0:M.label)||"",E=((A=u.value2Options.find(L=>L.value===r.value2))==null?void 0:A.label)||"",V={...r,id:t&&t.id||`cr-${Date.now()}`,type1Name:F,type2Name:T,value1Name:j,value2Name:E,createdAt:t&&t.createdAt||new Date().toISOString()};try{g(!0),d(null),a(V)}catch(L){console.error("Submit Error:",L),d(`Failed to ${t?"update":"create"} connected remark: ${L instanceof Error?L.message:String(L)}`)}finally{g(!1)}};return v?e.jsx("div",{className:"max-w-3xl mx-auto text-xs",children:e.jsxs("form",{onSubmit:k,className:"bg-white p-4 rounded shadow-md ring-1 ring-gray-200 space-y-3",children:[n&&e.jsxs("div",{className:"text-center py-2",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2",children:"Loading options..."})]}),m&&e.jsxs("div",{className:"text-center py-2",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-green-500"}),e.jsx("span",{className:"ml-2",children:t?"Updating...":"Creating..."})]}),b&&e.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-2 mb-2 text-xs",children:[e.jsx("p",{children:b}),e.jsx("button",{type:"button",onClick:()=>r.tabId&&p(r.tabId),className:"mt-1 text-xs text-red-600 hover:text-red-800 font-medium",children:"Retry Loading Data"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Select Master Tab"}),e.jsxs("select",{name:"tabId",value:r.tabId,onChange:P,required:!0,className:"w-full p-1 border rounded text-xs",children:[e.jsx("option",{value:"",children:"Select Tab"}),u.tabOptions.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Select Status"}),e.jsx("select",{name:"status",value:r.status,onChange:P,className:"w-full p-1 border rounded text-xs",children:u.statusOptions.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Select Master Type 1"}),e.jsxs("select",{name:"type1",value:r.type1,onChange:P,required:!0,className:"w-full p-1 border rounded text-xs",disabled:!r.tabId,children:[e.jsx("option",{value:"",children:"Select Master Type 1"}),u.typeOptions.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Select Master Value 1"}),e.jsxs("select",{name:"value1",value:r.value1,onChange:P,required:!0,disabled:!r.type1,className:"w-full p-1 border rounded text-xs disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select Master Value 1"}),u.valueOptions.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Select Master Type 2"}),e.jsxs("select",{name:"type2",value:r.type2,onChange:P,required:!0,className:"w-full p-1 border rounded text-xs",disabled:!r.tabId,children:[e.jsx("option",{value:"",children:"Select Master Type 2"}),u.type2Options.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Select Master Value 2"}),e.jsxs("select",{name:"value2",value:r.value2,onChange:P,required:!0,disabled:!r.type2,className:"w-full p-1 border rounded text-xs disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select Master Value 2"}),u.value2Options.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Remarks"}),e.jsx("div",{className:"space-y-2",children:r.remarks.map((R,F)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("span",{className:"bg-gray-100 text-gray-600 px-2 py-1 rounded text-xs font-medium min-w-[24px] text-center",children:F+1}),e.jsx("input",{type:"text",value:R,onChange:T=>w(F,T.target.value),required:!0,className:"flex-1 p-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-600 focus:border-blue-600",placeholder:`Enter remark ${F+1}...`}),r.remarks.length>1&&e.jsx("button",{type:"button",onClick:()=>y(F),className:"text-red-500 px-2 py-1 rounded text-xs transition-colors",children:"âœ•"})]},F))}),e.jsx("button",{type:"button",onClick:$,className:"mt-2 border border-blue-600 text-blue-600 px-3 py-1 rounded text-xs hover:bg-blue-50 focus:outline-none focus:ring-1 focus:ring-blue-600 transition-colors",children:"+ Add Another Remark"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{type:"button",onClick:s,disabled:m,className:"border border-gray-300 text-gray-700 py-1 px-3 rounded text-xs hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:m||n,className:"bg-blue-600 text-white py-1 px-3 rounded text-xs hover:bg-blue-700 disabled:bg-blue-300 transition-colors",children:[t?"Update":"Create"," Connected Remark"]})]})]})}):e.jsx("div",{className:"max-w-3xl mx-auto text-xs",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2",children:"Loading form..."})]})})};function $b(){var ze,xe,Ee,Ke,Xe;const[s]=l.useState([{id:"property",title:"Property Master"},{id:"buyer",title:"Buyer Master"},{id:"seller",title:"Seller Master"},{id:"lead",title:"Lead Master"},{id:"common",title:"Common Master"},{id:"connectedRemark",title:"Connected Remark"}]),[a,t]=l.useState(()=>{const ye=typeof window<"u"?localStorage.getItem("masterDataActiveTab"):null;return ye&&s.some(Ce=>Ce.id===ye)?ye:s[0].id}),r=s.find(ye=>ye.id===a)??s[0],[i,n]=l.useState({property:[],buyer:[],seller:[],lead:[],common:[],connectedRemark:[]}),[o,m]=l.useState(!1),[g,b]=l.useState(!1),[d,v]=l.useState("list"),[x,u]=l.useState(null),[c,f]=l.useState(""),[p,N]=l.useState(!1),[P,w]=l.useState("master"),[$,y]=l.useState(!1),[k,R]=l.useState(!1),[F,T]=l.useState(null),[j,E]=l.useState(""),[V,W]=l.useState("Active"),[B,M]=l.useState(!1),[A,L]=l.useState(""),[D,I]=l.useState("Active"),[H,h]=l.useState(null),Y=a==="connectedRemark",[K,q]=l.useState([]),ne=((ze=x==null?void 0:x.values)==null?void 0:ze.length)>0&&K.length===(((xe=x.values)==null?void 0:xe.length)??0),[le,S]=l.useState([]),[C,J]=l.useState(null);l.useEffect(()=>{typeof window<"u"&&localStorage.setItem("masterDataActiveTab",a)},[a]),l.useEffect(()=>{Y?ue():se()},[a]);const ue=async()=>{try{m(!0);const ye=await yl.getAllRemarks();S(Array.isArray(ye)?ye:[])}catch(ye){console.error("Error loading connected remarks:",ye),Z.error("Error loading connected remarks âŒ")}finally{m(!1)}},Q=async ye=>{try{if(k&&C){const Ce=await yl.updateRemark(C.id,ye);S(_=>_.map(ae=>ae.id===C.id?{...ae,...Ce}:ae)),Z.success("Connected remark updated successfully âœï¸")}else{const Ce=await yl.createRemark(ye);S(_=>[..._,Ce]),Z.success("Connected remark added successfully âœ…")}await ue(),me()}catch(Ce){console.error("Error saving connected remark:",Ce),Z.error("Error saving connected remark âŒ Please try again.")}},he=async ye=>{Z.info(Ce=>{const _=Ce.closeToast;return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-2",children:"Are you sure you want to delete this connected remark?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{await yl.deleteRemark(ye),S(ae=>ae.filter(ke=>ke.id!==ye)),Z.success("Connected remark deleted successfully ðŸ—‘ï¸")}catch(ae){console.error("Error deleting connected remark:",ae),Z.error("Error deleting connected remark âŒ Please try again.")}finally{_==null||_()}},className:"px-3 py-1 bg-red-600 text-white rounded text-xs",children:"Yes"}),e.jsx("button",{onClick:()=>_==null?void 0:_(),className:"px-3 py-1 bg-gray-300 rounded text-xs",children:"No"})]})]})},{autoClose:!1,closeOnClick:!1,draggable:!1,position:"top-center"})},se=async()=>{try{m(!0);const ye=await Nt.getAllMasterTypes(a),Ce=await Promise.all((ye||[]).map(async _=>{try{const ae=await Nt.getMasterValues(_.id);return{..._,values:Array.isArray(ae)?ae:[],valueCount:ae&&ae.length||0}}catch(ae){return console.error(`Error loading values for ${_.id}:`,ae),{..._,values:[],valueCount:0}}}));n(_=>({..._,[a]:Ce}))}catch(ye){console.error("Error loading master types:",ye),Z.error("Error loading master types âŒ")}finally{m(!1)}},ge=async ye=>{try{b(!0);const Ce=await Nt.getMasterValues(ye);u(_=>_?{..._,values:Array.isArray(Ce)?Ce:[]}:null),n(_=>({..._,[a]:_[a].map(ae=>ae.id===ye?{...ae,values:Array.isArray(Ce)?Ce:[],valueCount:Ce&&Ce.length||0}:ae)}))}catch(Ce){console.error("Error loading master values:",Ce),Z.error("Error loading master values âŒ")}finally{b(!1)}},ee=()=>{q(ne?[]:(x==null?void 0:x.values.map(ye=>ye.id))||[])},de=ye=>{q(Ce=>Ce.includes(ye)?Ce.filter(_=>_!==ye):[...Ce,ye])},U=async()=>{!x||K.length===0||Y||Z.info(ye=>{const Ce=ye.closeToast;return e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm mb-2",children:["Are you sure you want to delete ",K.length," selected values?"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{await Promise.all(K.map(ae=>Nt.deleteMasterValue(ae)));const _=x.values.filter(ae=>!K.includes(ae.id));n(ae=>({...ae,[a]:ae[a].map(ke=>ke.id===x.id?{...ke,values:_,valueCount:_.length}:ke)})),u(ae=>ae?{...ae,values:_}:null),q([]),Z.success("Selected values deleted successfully ðŸ—‘ï¸")}catch(_){console.error("Error deleting values:",_),Z.error("Error deleting selected values âŒ Please try again.")}finally{Ce==null||Ce()}},className:"px-3 py-1 bg-red-600 text-white rounded text-xs",children:"Yes"}),e.jsx("button",{onClick:()=>Ce==null?void 0:Ce(),className:"px-3 py-1 bg-gray-300 rounded text-xs",children:"No"})]})]})},{autoClose:!1,closeOnClick:!1,draggable:!1,position:"top-center"})},X=async ye=>{ye.preventDefault();try{if(k&&F){const Ce=await Nt.updateMasterType(F.id,{name:j,status:V}),_={...F,name:j,status:V,...Ce};n(ae=>({...ae,[a]:ae[a].map(ke=>ke.id===F.id?_:ke)})),(x==null?void 0:x.id)===F.id&&u(ae=>ae?{...ae,name:j,status:V}:null),Z.success("Master type updated successfully âœ…")}else{const Ce=await Nt.createMasterType({tabId:a,name:j,status:V});if(!(Ce!=null&&Ce.id)){await se(),Z.success("Master type created successfully âœ…"),me();return}const _={id:Ce.id,name:j,status:V,values:[],valueCount:0,...Ce};n(ae=>({...ae,[a]:[...ae[a],_]})),Z.success("Master type created successfully âœ…")}me()}catch(Ce){console.error("Error saving master type:",Ce),Z.error("Error saving master type âŒ Please try again.")}},re=ye=>{T(ye),E(ye.name),W(ye.status),R(!0),y(!0)},fe=ye=>{J(ye),R(!0),y(!0)},G=async ye=>{Z.info(Ce=>{const _=Ce.closeToast;return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-2",children:"Are you sure you want to delete this master type?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{await Nt.deleteMasterType(ye),n(ae=>({...ae,[a]:ae[a].filter(ke=>ke.id!==ye)})),(x==null?void 0:x.id)===ye&&(v("list"),u(null),q([])),Z.success("Master type deleted successfully ðŸ—‘ï¸")}catch(ae){console.error("Error deleting master type:",ae),Z.error("Error deleting master type âŒ Please try again.")}finally{_==null||_()}},className:"px-3 py-1 bg-red-600 text-white rounded text-xs",children:"Yes"}),e.jsx("button",{onClick:()=>_==null?void 0:_(),className:"px-3 py-1 bg-gray-300 rounded text-xs",children:"No"})]})]})},{autoClose:!1,closeOnClick:!1,draggable:!1,position:"top-center"})},me=()=>{E(""),W("Active"),y(!1),R(!1),T(null),J(null)},oe=async ye=>{Y||(u(ye),v("values"),f(""),q([]),await ge(ye.id))},Fe=()=>{v("list"),u(null),f(""),q([])},$e=async ye=>{if(ye.preventDefault(),!(x!=null&&x.id)){Z.error("Invalid master. Please refresh or select a valid master before adding values âŒ");return}try{if(H){const Ce=await Nt.updateMasterValue(H.id,{value:A,status:D}),_={id:Ce.id||H.id,value:Ce.value||A,status:Ce.status||D,...Ce};n(ae=>({...ae,[a]:ae[a].map(ke=>ke.id===x.id?{...ke,values:ke.values.map(Me=>Me.id===H.id?_:Me)}:ke)})),u(ae=>ae&&{...ae,values:ae.values.map(ke=>ke.id===H.id?_:ke)}),Z.success("Value updated successfully âœ…")}else{const Ce=await Nt.createMasterValue(x.id,{value:A,status:D});if(!(Ce!=null&&Ce.id)){await ge(x.id),Z.success("Value created successfully âœ…"),_e();return}const _={id:Ce.id,value:Ce.value||A,status:Ce.status||D,...Ce};n(ae=>({...ae,[a]:ae[a].map(ke=>ke.id===x.id?{...ke,values:[...ke.values,_],valueCount:ke.valueCount+1}:ke)})),u(ae=>ae&&{...ae,values:[...ae.values,_]}),Z.success("Value created successfully âœ…")}_e()}catch(Ce){console.error("Error saving value:",Ce),Z.error("Error saving value âŒ Please try again.")}},Le=ye=>{L(ye.value),I(ye.status),h(ye),M(!0)},je=async ye=>{x&&Z.info(Ce=>{const _=Ce.closeToast;return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm mb-2",children:"Are you sure you want to delete this value?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{try{await Nt.deleteMasterValue(ye);const ae=x.values.filter(ke=>ke.id!==ye);n(ke=>({...ke,[a]:ke[a].map(Me=>Me.id===x.id?{...Me,values:ae,valueCount:ae.length}:Me)})),u(ke=>ke&&{...ke,values:ae}),q(ke=>ke.filter(Me=>Me!==ye)),Z.success("Value deleted successfully ðŸ—‘ï¸")}catch(ae){console.error("Error deleting value:",ae),Z.error("Error deleting value âŒ Please try again.")}finally{_==null||_()}},className:"px-3 py-1 bg-red-600 text-white rounded text-xs",children:"Yes"}),e.jsx("button",{onClick:()=>_==null?void 0:_(),className:"px-3 py-1 bg-gray-300 rounded text-xs",children:"No"})]})]})},{autoClose:!1,closeOnClick:!1,draggable:!1,position:"top-center"})},_e=()=>{L(""),I("Active"),M(!1),h(null)},ve=async()=>{if(!(!x||Y))try{const ye=await Nt.exportMasterValues(x.id),Ce=window.URL.createObjectURL(ye),_=document.createElement("a");_.href=Ce,_.download=`${x.name}_values.csv`,document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(Ce),Z.success(`Values exported successfully for "${x.name}" âœ…`)}catch(ye){console.error("Error exporting values:",ye),Z.error("Error exporting values âŒ Please try again.")}},Pe=async ye=>{try{if(P==="master")await Nt.importMasterTypes(a,ye),Y?await ue():await se(),Z.success("Master types imported successfully âœ…");else{if(!x){Z.error("Please select a master first âŒ");return}await Nt.importMasterValues(x.id,ye),await ge(x.id),Z.success(`Values imported successfully for "${x.name}" âœ…`)}}catch(Ce){console.error(`Error importing ${P}:`,Ce),Z.error(`Failed to import ${P} âŒ Please try again.`)}},We=async()=>{if(!Y)try{const ye=await Nt.exportMasterTypes(a),Ce=window.URL.createObjectURL(ye),_=document.createElement("a");_.href=Ce,_.download=`${r.title}_master_types.csv`,document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(Ce)}catch(ye){console.error("Error exporting master types:",ye),Z.error("Error exporting master types âŒ Please try again.")}},pe=((Ee=x==null?void 0:x.values)==null?void 0:Ee.filter(ye=>ye.value.toLowerCase().includes(c.toLowerCase())).sort((ye,Ce)=>{const _=parseInt(ye.value),ae=parseInt(Ce.value);return _-ae}))||[],O=i[a].filter(ye=>ye.name.toLowerCase().includes(c.toLowerCase())),Ie=le.filter(ye=>{var ke,Me,Ye,ie;const Ce=c.toLowerCase(),ae=(we=>we?Array.isArray(we)?we.map(Be=>typeof Be=="object"&&Be!==null?Be.note||Be.text||Be.remark||"":String(Be||"")).join(" "):typeof we=="object"&&we!==null?we.note||we.text||we.remark||"":String(we):"")(ye.remarks);return(((ke=ye.type1Name)==null?void 0:ke.toLowerCase())||"").includes(Ce)||(((Me=ye.value1Name)==null?void 0:Me.toLowerCase())||"").includes(Ce)||(((Ye=ye.type2Name)==null?void 0:Ye.toLowerCase())||"").includes(Ce)||(((ie=ye.value2Name)==null?void 0:ie.toLowerCase())||"").includes(Ce)||ae.toLowerCase().includes(Ce)});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"p-4 border-b bg-white shadow-sm",children:e.jsx("h1",{className:"text-xl font-semibold",children:"Master Data Management"})}),e.jsx("nav",{className:"bg-white border-b",children:e.jsx("div",{className:"px-3 py-2 flex gap-2 overflow-x-auto overflow-y-hidden no-scrollbar",children:s.map(ye=>e.jsx("button",{onClick:()=>{t(ye.id),v("list"),u(null),q([]),f("")},className:`flex-shrink-0 px-3 py-1 rounded-lg text-xs whitespace-nowrap transition-colors duration-200 ${ye.id===a?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:ye.title},ye.id))})}),e.jsx("main",{className:"p-3 sm:p-4",children:d==="list"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4 md:flex-row md:items-center md:justify-between mb-4 sm:mb-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold truncate",children:r.title}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-2 md:gap-3 md:flex-wrap",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:c,onChange:ye=>f(ye.target.value),className:"w-full sm:w-56 md:w-64 border border-gray-300 rounded px-3 py-2 text-xs focus:outline-none focus:ring-2 focus:ring-blue-500"}),!Y&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>{w("master"),N(!0)},className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-1 text-xs",children:[e.jsx(dt,{size:14}),e.jsxs("span",{className:"whitespace-nowrap",children:["Import ",r.title]})]})}),e.jsxs("button",{onClick:We,disabled:!O.length,className:"w-full sm:w-auto bg-orange-600 hover:bg-orange-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-1 disabled:opacity-50 text-xs",children:[e.jsx(Ys,{size:14}),e.jsx("span",{className:"whitespace-nowrap",children:"Export"})]})]}),e.jsxs("button",{onClick:()=>y(!0),className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-2 text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{className:"whitespace-nowrap",children:Y?"Add Connected Remark":`Create ${r.title} types`})]})]})]}),o?e.jsxs("div",{className:"text-center py-10 sm:py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500 text-sm",children:"Loading..."})]}):Y?e.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:Ie.length===0?e.jsxs("div",{className:"text-center py-10 sm:py-12 text-gray-500",children:[e.jsx(fs,{size:40,className:"mx-auto mb-3 opacity-50"}),c.trim()!==""?e.jsx("p",{children:"No results found"}):e.jsx("p",{children:"No connected remarks created yet"})]}):e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"min-w-[800px] w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"#"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Master Tab Id"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Master Type 1"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Master Value 1"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Master Type 2"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Master Value 2"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Remarks"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Actions"})]})}),e.jsx("tbody",{children:Ie.map((ye,Ce)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-600 text-xs",children:Ce+1}),e.jsx("td",{className:"p-3 font-medium text-xs",children:ye.tab_id||ye.tabId||"N/A"}),e.jsx("td",{className:"p-3 font-medium text-xs",children:ye.type1Name||"N/A"}),e.jsx("td",{className:"p-3 font-medium text-xs",children:ye.value1Name||"N/A"}),e.jsx("td",{className:"p-3 font-medium text-xs",children:ye.type2Name||"N/A"}),e.jsx("td",{className:"p-3 font-medium text-xs",children:ye.value2Name||"N/A"}),e.jsx("td",{className:"p-3 font-medium text-xs max-w-xs",children:(()=>{if(!ye.remarks||Array.isArray(ye.remarks)&&ye.remarks.length===0)return e.jsx("span",{className:"text-gray-400",children:"No remarks"});if(Array.isArray(ye.remarks))return e.jsx("ol",{className:"list-decimal list-inside space-y-1",children:ye.remarks.map((_,ae)=>{const ke=typeof _=="object"&&_!==null?_.note||_.text||_.remark||"Empty remark":String(_||"Empty remark");return e.jsx("li",{className:"text-[11px] sm:text-xs text-gray-700 break-words",children:ke},ae)})});if(typeof ye.remarks=="object"&&ye.remarks!==null){const _=ye.remarks,ae=_.note||_.text||_.remark||"Empty remark";return e.jsx("span",{className:"text-[11px] sm:text-xs text-gray-700",children:ae})}return e.jsx("span",{className:"text-[11px] sm:text-xs text-gray-700",children:String(ye.remarks??"Empty remark")})})()}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-[11px] sm:text-xs font-medium ${ye.status==="Active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ye.status})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>fe(ye),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(Ei,{size:14})}),e.jsx("button",{onClick:()=>he(ye.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:e.jsx(Es,{size:14})})]})})]},ye.id))})]})})}):e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 sm:gap-4",children:O.length===0?e.jsxs("div",{className:"col-span-full text-center py-10 sm:py-12 text-gray-500",children:[e.jsx(fs,{size:40,className:"mx-auto mb-3 opacity-50"}),c.trim()!==""?e.jsx("p",{children:"No results found"}):e.jsxs("p",{children:["No ",r.title," types created yet"]})]}):O.map(ye=>e.jsxs("div",{className:"bg-white p-2 sm:p-3 rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer",onClick:()=>oe(ye),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h3",{className:"font-semibold text-sm sm:text-[15px]",children:ye.name}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),re(ye)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:e.jsx(Ei,{size:14})}),e.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),G(ye.id)},className:"p-1 text-red-600 hover:bg-red-50 rounded",children:e.jsx(Es,{size:14})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-[11px] sm:text-xs font-medium ${ye.status==="Active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[ye.status==="Active"?e.jsx(bs,{size:12}):e.jsx(Ta,{size:12}),ye.status]}),e.jsxs("span",{className:"text-[11px] sm:text-xs text-gray-500",children:[ye.valueCount," values"]})]})]},ye.id))})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsxs("button",{onClick:Fe,className:"flex items-center gap-2 text-blue-600 hover:text-blue-800 mb-3 sm:mb-4",children:[e.jsx(ga,{size:18,className:"sm:size-5"}),e.jsxs("span",{className:"text-sm sm:text-base",children:["Back to ",r.title]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 sm:p-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between mb-4 sm:mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm sm:text-base font-semibold",children:x==null?void 0:x.name}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-[11px] sm:text-xs font-medium mt-2 ${(x==null?void 0:x.status)==="Active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[(x==null?void 0:x.status)==="Active"?e.jsx(bs,{size:12}):e.jsx(Ta,{size:12}),x==null?void 0:x.status]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-2 md:gap-3 md:flex-wrap",children:[!Y&&K.length>0&&e.jsxs("button",{onClick:U,className:"w-full sm:w-auto bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-1 text-xs",children:[e.jsx(Es,{size:14}),e.jsxs("span",{className:"whitespace-nowrap",children:["Delete Selected (",K.length,")"]})]}),e.jsx("input",{type:"text",placeholder:"Search...",value:c,onChange:ye=>f(ye.target.value),className:"w-full sm:w-56 md:w-64 border border-gray-300 rounded px-3 py-2 text-xs focus:outline-none focus:ring-2 focus:ring-blue-500"}),!Y&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{w("values"),N(!0)},disabled:!x,className:`w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-1 text-xs ${x?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx(dt,{size:14}),e.jsxs("span",{className:"whitespace-nowrap",children:["Import ",r.title," Values"]})]}),e.jsxs("button",{onClick:ve,disabled:!((Ke=x==null?void 0:x.values)!=null&&Ke.length),className:"w-full sm:w-auto bg-orange-600 hover:bg-orange-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-1 disabled:opacity-50 text-xs",children:[e.jsx(Ys,{size:14}),e.jsx("span",{className:"whitespace-nowrap",children:"Export"})]})]}),!Y&&e.jsxs("button",{onClick:()=>M(!0),className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg flex items-center justify-center gap-1 text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{className:"whitespace-nowrap",children:"Add Value"})]})]})]}),g?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500 text-sm",children:"Loading values..."})]}):pe.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:((Xe=x==null?void 0:x.values)==null?void 0:Xe.length)===0?e.jsxs(e.Fragment,{children:[e.jsx(fs,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No values added yet"})]}):e.jsxs("p",{children:["No values found matching"," ",e.jsxs("span",{className:"font-medium",children:['"',c,'"']})]})}):e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"min-w-[600px] w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:ne,onChange:ee,className:"h-4 w-4"}),e.jsx("span",{children:"#"})]})}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Value"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Status"}),e.jsx("th",{className:"text-left p-3 font-medium text-[11px] sm:text-xs",children:"Actions"})]})}),e.jsx("tbody",{children:pe.map((ye,Ce)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-600 text-xs",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:K.includes(ye.id),onChange:()=>de(ye.id),className:"h-4 w-4"}),Ce+1]})}),e.jsx("td",{className:"p-3 font-medium text-xs",children:ye.value}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-[11px] sm:text-xs font-medium ${ye.status==="Active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ye.status})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Le(ye),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(Ei,{size:14})}),e.jsx("button",{onClick:()=>je(ye.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:e.jsx(Es,{size:14})})]})})]},ye.id))})]})})]})]})})}),e.jsx(ma,{isOpen:$,onClose:me,title:Y?k?"Edit Connected Remark":"Add Connected Remark":`${k?"Edit":"Create"} Master Type`,children:Y?e.jsx(Ib,{onClose:me,onSubmit:Q,initialData:k&&C?C:null}):e.jsx("form",{onSubmit:X,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-xs",children:"Name"}),e.jsx("input",{type:"text",value:j,onChange:ye=>E(ye.target.value),required:!0,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-xs",children:"Status"}),e.jsxs("select",{value:V,onChange:ye=>W(ye.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-xs",children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:me,className:"px-3 py-1 rounded border border-gray-300 hover:bg-gray-100 text-xs",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",children:k?"Update":"Create"})]})]})})}),e.jsx(ma,{isOpen:B,onClose:_e,title:`${H?"Edit":"Add"} Value`,children:e.jsx("form",{onSubmit:$e,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-xs",children:"Value"}),e.jsx("input",{type:"text",value:A,onChange:ye=>L(ye.target.value),required:!0,className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-xs",children:"Status"}),e.jsxs("select",{value:D,onChange:ye=>I(ye.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-xs",children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:_e,className:"px-3 py-1 rounded border border-gray-300 hover:bg-gray-100 text-xs",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",children:H?"Update":"Create"})]})]})})}),e.jsx(Tb,{isOpen:p,onClose:()=>N(!1),onImport:Pe,title:`Import ${P==="master"?r.title:((x==null?void 0:x.name)??"")+" Values"}`,type:P})]})}const rr=Ps.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:$a("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a}));rr.displayName="Card";const lr=Ps.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:$a("flex flex-col space-y-1.5 p-6",s),...a}));lr.displayName="CardHeader";const nr=Ps.forwardRef(({className:s,...a},t)=>e.jsx("h3",{ref:t,className:$a("text-2xl font-semibold leading-none tracking-tight",s),...a}));nr.displayName="CardTitle";const sn=Ps.forwardRef(({className:s,...a},t)=>e.jsx("p",{ref:t,className:$a("text-sm text-muted-foreground",s),...a}));sn.displayName="CardDescription";const ir=Ps.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:$a("p-6 pt-0",s),...a}));ir.displayName="CardContent";const Eb=Ps.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:$a("flex items-center p-6 pt-0",s),...a}));Eb.displayName="CardFooter";const zi=Ps.forwardRef(({className:s,...a},t)=>e.jsx("label",{ref:t,className:$a("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",s),...a}));zi.displayName="Label";const Qn=Ps.createContext({open:!1,setOpen:()=>{}}),lm=({value:s,onValueChange:a,defaultValue:t,children:r})=>{const[i,n]=Ps.useState(t||""),[o,m]=Ps.useState(!1),g=s!==void 0?s:i,b=d=>{s===void 0&&n(d),a==null||a(d),m(!1)};return e.jsx(Qn.Provider,{value:{value:g,onValueChange:b,open:o,setOpen:m},children:e.jsx("div",{className:"relative",children:r})})},nm=({className:s,children:a})=>{const{open:t,setOpen:r}=Ps.useContext(Qn);return e.jsxs("button",{type:"button",className:$a("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),onClick:()=>r(!t),children:[a,e.jsx(ea,{className:"h-4 w-4 opacity-50"})]})},im=({placeholder:s,className:a})=>{const{value:t}=Ps.useContext(Qn);return e.jsx("span",{className:$a("block truncate",a),children:t||s})},om=({className:s,children:a})=>{const{open:t}=Ps.useContext(Qn);return t?e.jsx("div",{className:$a("absolute top-full z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md",s),children:a}):null},Er=({value:s,className:a,children:t})=>{const{onValueChange:r}=Ps.useContext(Qn);return e.jsx("div",{className:$a("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",a),onClick:()=>r==null?void 0:r(s),children:t})},Wu=Ps.forwardRef(({className:s,value:a=0,max:t=100,...r},i)=>{const n=Math.min(Math.max(a/t*100,0),100);return e.jsx("div",{ref:i,className:$a("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:e.jsx("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-n}%)`}})})});Wu.displayName="Progress";const Mb=Oh("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function cm({className:s,variant:a,...t}){return e.jsx("div",{className:$a(Mb({variant:a}),s),...t})}const Lb=()=>{const[s,a]=l.useState(0),[t,r]=l.useState(!1),i=[{id:1,filename:"leads_2025_q1.csv",type:"Leads",status:"completed",records:1250,date:"2025-01-15 14:30",errors:0},{id:2,filename:"properties_update.xlsx",type:"Properties",status:"completed",records:890,date:"2025-01-14 09:45",errors:3},{id:3,filename:"contacts_import.csv",type:"Contacts",status:"processing",records:456,date:"2025-01-15 16:20",errors:0},{id:4,filename:"user_data.json",type:"Users",status:"failed",records:0,date:"2025-01-13 11:15",errors:15}],n=[{id:1,name:"Leads Export",description:"All lead data with contact information",type:"leads"},{id:2,name:"Properties Export",description:"Property listings with full details",type:"properties"},{id:3,name:"Users Export",description:"User accounts and role information",type:"users"},{id:4,name:"Activities Export",description:"Activity logs and interaction history",type:"activities"}],o=b=>{var v;if((v=b.target.files)==null?void 0:v[0]){r(!0),a(0);const x=setInterval(()=>{a(u=>u>=100?(clearInterval(x),r(!1),100):u+10)},200)}},m=b=>{switch(b){case"completed":return e.jsx(bs,{className:"h-4 w-4 text-green-500 shrink-0"});case"processing":return e.jsx(Ls,{className:"h-4 w-4 text-blue-500 shrink-0"});case"failed":return e.jsx(ct,{className:"h-4 w-4 text-red-500 shrink-0"});default:return e.jsx(ws,{className:"h-4 w-4 text-gray-500 shrink-0"})}},g=b=>{const d={completed:"default",processing:"secondary",failed:"destructive"};return e.jsx(cm,{variant:d[b]||"secondary",children:b})};return e.jsxs("div",{className:"space-y-6 px-3 sm:px-4 md:px-6 max-w-7xl mx-auto",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Import & Export"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Import data from external sources or export your data for backup and analysis"})]}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 md:grid-cols-2",children:[e.jsxs(rr,{children:[e.jsxs(lr,{children:[e.jsxs(nr,{className:"flex items-center gap-2 text-lg sm:text-xl",children:[e.jsx(dt,{className:"h-5 w-5 sm:h-6 sm:w-6"}),"Import Data"]}),e.jsx(sn,{children:"Upload CSV, Excel, or JSON files to import data into the system"})]}),e.jsxs(ir,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(zi,{htmlFor:"import-type",children:"Data Type"}),e.jsxs(lm,{children:[e.jsx(nm,{className:"w-full",children:e.jsx(im,{placeholder:"Select data type to import"})}),e.jsxs(om,{children:[e.jsx(Er,{value:"leads",children:"Leads"}),e.jsx(Er,{value:"properties",children:"Properties"}),e.jsx(Er,{value:"contacts",children:"Contacts"}),e.jsx(Er,{value:"users",children:"Users"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(zi,{htmlFor:"file-upload",children:"Choose File"}),e.jsx(wr,{id:"file-upload",type:"file",accept:".csv,.xlsx,.xls,.json",onChange:o,disabled:t,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported formats: CSV, Excel (.xlsx, .xls), JSON"})]}),t&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[s,"%"]})]}),e.jsx(Wu,{value:s,className:"w-full"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(ss,{disabled:t,className:"w-full sm:w-auto",children:[e.jsx(dt,{className:"mr-2 h-4 w-4"}),"Import Data"]}),e.jsxs(ss,{variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(ws,{className:"mr-2 h-4 w-4"}),"Download Template"]})]})]})]}),e.jsxs(rr,{children:[e.jsxs(lr,{children:[e.jsxs(nr,{className:"flex items-center gap-2 text-lg sm:text-xl",children:[e.jsx(Ys,{className:"h-5 w-5 sm:h-6 sm:w-6"}),"Export Data"]}),e.jsx(sn,{children:"Export your data in various formats for backup or external analysis"})]}),e.jsxs(ir,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:n.map(b=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 p-3 border rounded-lg",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-sm sm:text-base truncate",children:b.name}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:b.description})]}),e.jsxs(ss,{variant:"outline",size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Ys,{className:"mr-2 h-3 w-3"}),"Export"]})]},b.id))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(zi,{htmlFor:"export-format",children:"Export Format"}),e.jsxs(lm,{children:[e.jsx(nm,{className:"w-full",children:e.jsx(im,{placeholder:"Select export format"})}),e.jsxs(om,{children:[e.jsx(Er,{value:"csv",children:"CSV"}),e.jsx(Er,{value:"xlsx",children:"Excel (.xlsx)"}),e.jsx(Er,{value:"json",children:"JSON"}),e.jsx(Er,{value:"pdf",children:"PDF Report"})]})]})]})]})]})]}),e.jsxs(rr,{children:[e.jsxs(lr,{children:[e.jsx(nr,{className:"text-lg sm:text-xl",children:"Recent Imports"}),e.jsx(sn,{children:"History of recent data import operations"})]}),e.jsx(ir,{children:e.jsx("div",{className:"space-y-3",children:i.map(b=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start sm:items-center gap-3 min-w-0",children:[m(b.status),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-sm sm:text-base break-words sm:truncate",children:b.filename}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1 text-xs sm:text-sm text-muted-foreground",children:[e.jsx("span",{className:"whitespace-nowrap",children:b.type}),e.jsx("span",{className:"hidden sm:inline",children:"â€¢"}),e.jsxs("span",{className:"whitespace-nowrap",children:[b.records," records"]}),e.jsx("span",{className:"hidden sm:inline",children:"â€¢"}),e.jsx("span",{className:"whitespace-nowrap",children:b.date})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[b.errors>0&&e.jsxs(cm,{variant:"destructive",children:[b.errors," errors"]}),g(b.status)]})]},b.id))})})]})]})},Db=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Communication Hub"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage all communications with leads and clients"})]}),e.jsxs(ss,{children:[e.jsx(Dt,{className:"mr-2 h-4 w-4"}),"New Message"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(rr,{children:[e.jsxs(lr,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(nr,{className:"text-sm font-medium",children:"Email Campaigns"}),e.jsx(Ds,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ir,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"24"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+2 from last month"})]})]}),e.jsxs(rr,{children:[e.jsxs(lr,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(nr,{className:"text-sm font-medium",children:"Phone Calls"}),e.jsx(Cs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ir,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"148"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+12% from last week"})]})]}),e.jsxs(rr,{children:[e.jsxs(lr,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(nr,{className:"text-sm font-medium",children:"Messages"}),e.jsx(Bt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ir,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"573"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+8% from last week"})]})]}),e.jsxs(rr,{children:[e.jsxs(lr,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(nr,{className:"text-sm font-medium",children:"Meetings"}),e.jsx(Ts,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ir,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"89"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+5 scheduled today"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(rr,{children:[e.jsxs(lr,{children:[e.jsx(nr,{children:"Recent Communications"}),e.jsx(sn,{children:"Latest interactions with leads and clients"})]}),e.jsx(ir,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-blue-100",children:e.jsx(Ds,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium",children:"Email to John Smith"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Property inquiry follow-up"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"2h ago"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-green-100",children:e.jsx(Cs,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium",children:"Call with Sarah Johnson"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Property viewing scheduled"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"4h ago"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-purple-100",children:e.jsx(Bt,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium",children:"Message from Mike Wilson"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Contract negotiation update"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"6h ago"})]})]})})]}),e.jsxs(rr,{children:[e.jsxs(lr,{children:[e.jsx(nr,{children:"Communication Tools"}),e.jsx(sn,{children:"Quick access to communication features"})]}),e.jsx(ir,{children:e.jsxs("div",{className:"grid gap-3",children:[e.jsxs(ss,{variant:"outline",className:"justify-start",children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Email Templates"]}),e.jsxs(ss,{variant:"outline",className:"justify-start",children:[e.jsx(Bt,{className:"mr-2 h-4 w-4"}),"SMS Campaigns"]}),e.jsxs(ss,{variant:"outline",className:"justify-start",children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(ss,{variant:"outline",className:"justify-start",children:[e.jsx(Ns,{className:"mr-2 h-4 w-4"}),"Group Messages"]})]})})]})]})]}),Rb=s=>{if(s==null||Number.isNaN(s)||s===0)return"";const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],t=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],r=d=>d<20?a[d]:d<100?t[Math.floor(d/10)]+(d%10?" "+a[d%10]:""):d<1e3?a[Math.floor(d/100)]+" Hundred"+(d%100?" "+r(d%100):""):"";let i="";const n=Math.floor(s/1e7),o=Math.floor(s/1e5%100),m=Math.floor(s/1e3%100),g=Math.floor(s/100%10),b=s%100;return n&&(i+=r(n)+" Crore "),o&&(i+=r(o)+" Lakh "),m&&(i+=r(m)+" Thousand "),g&&(i+=r(g)+" Hundred "),b&&(i+=r(b)),i.trim()},zb=s=>{if(!s)return"";const a=Number(s);return isNaN(a)?s:a.toLocaleString("en-IN",{maximumFractionDigits:2})},dm=({value:s,onChange:a,error:t=null,onFocus:r})=>{const[i,n]=l.useState(""),o=g=>{const d=g.target.value.replace(/\D+/g,"");a(d);const v=d?Number(d):NaN;n(!Number.isNaN(v)&&v>0?Rb(v):"")},m=s?zb(s):"";return e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Budget (INR)"}),e.jsx("input",{type:"text",placeholder:"e.g., 50,00,000",value:m,onChange:o,onFocus:()=>r==null?void 0:r(),className:`w-full px-3 py-2 border rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent ${t?"border-red-500":"border-gray-300"}`,required:!0}),t&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t}),i&&e.jsxs("p",{className:"text-xs text-green-600 mt-2",children:[i," Rupees"]})]})},Dl=s=>String(s).padStart(2,"0"),vc=({value:s,onChange:a,label:t="Date of Birth",required:r,placeholder:i="Select your date of birth",size:n="md",min:o,max:m,showAge:g=!0})=>{var M;const[b,d]=l.useState(!1),[v,x]=l.useState(1),[u,c]=l.useState(null),[f,p]=l.useState(null),N=[{name:"January",value:0,short:"Jan"},{name:"February",value:1,short:"Feb"},{name:"March",value:2,short:"Mar"},{name:"April",value:3,short:"Apr"},{name:"May",value:4,short:"May"},{name:"June",value:5,short:"Jun"},{name:"July",value:6,short:"Jul"},{name:"August",value:7,short:"Aug"},{name:"September",value:8,short:"Sep"},{name:"October",value:9,short:"Oct"},{name:"November",value:10,short:"Nov"},{name:"December",value:11,short:"Dec"}],{years:P,minYear:w,maxYear:$}=l.useMemo(()=>{const A=new Date,L=o?new Date(o):new Date(A.getFullYear()-100,0,1),D=m?new Date(m):A,I=L.getFullYear(),H=D.getFullYear(),h=[];for(let Y=H;Y>=I;Y--)h.push(Y);return{years:h,minYear:I,maxYear:H}},[o,m]),y=()=>{if(u==null||f==null)return[];const A=new Date(u,f+1,0).getDate();return Array.from({length:A},(L,D)=>D+1)},k=()=>u==null||f==null?0:new Date(u,f,1).getDay(),R=A=>{c(A),x(2)},F=A=>{p(A),x(3)},T=(A,L,D)=>{const I=`${A}-${Dl(L+1)}-${Dl(D)}`,H=new Date(I);return(!o||H>=new Date(o))&&(!m||H<=new Date(m))},j=A=>{const L=u??$,D=f??0;if(!T(L,D,A))return;const I=`${L}-${Dl(D+1)}-${Dl(A)}`;a(I),d(!1),x(1),c(null),p(null)},E=()=>{v===2?(c(null),x(1)):v===3&&(p(null),x(2))},V=()=>{if(!s)return null;const A=new Date,L=new Date(s);let D=A.getFullYear()-L.getFullYear(),I=A.getMonth()-L.getMonth(),H=A.getDate()-L.getDate();return H<0&&(I-=1,H+=new Date(A.getFullYear(),A.getMonth(),0).getDate()),I<0&&(D-=1,I+=12),{years:D,months:I}},W=A=>{if(!A)return"";const L=new Date(A),D=Dl(L.getDate()),I=Dl(L.getMonth()+1),H=L.getFullYear();return`${D}/${I}/${H}`},B=n==="sm"?"w-full px-3 py-2 border rounded-md bg-white text-left flex items-center justify-between text-xs":"w-full px-4 py-3 border-2 rounded-lg bg-white text-left flex items-center justify-between";return e.jsxs("div",{children:[t&&e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.jsx(Ms,{className:"inline w-3.5 h-3.5 mr-1"}),t," ",r&&"*"]}),e.jsxs("button",{type:"button",onClick:()=>{x(1),c(null),p(null),d(!0)},className:`${B} border-gray-300 hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors`,children:[e.jsx("span",{className:s?"text-gray-900":"text-gray-400",children:s?W(s):i}),e.jsx(Ts,{className:"w-4 h-4 text-gray-400"})]}),g&&!!s&&e.jsxs("div",{className:"mt-1 flex items-center text-[11px] text-green-600",children:[e.jsx(hu,{className:"w-3.5 h-3.5 mr-1"}),(()=>{const A=V();return A?`Age: ${A.years} years ${A.months} months`:""})()]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[1000]",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-xs",children:[e.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[v>1&&e.jsx("button",{onClick:E,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Wa,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("h3",{className:"text-sm font-semibold text-gray-800",children:[v===1&&"Select Year",v===2&&`Select Month${u?` â€” ${u}`:""}`,v===3&&`Select Date â€” ${(M=N[f??0])==null?void 0:M.short} ${u??""}`]})]}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600 text-lg font-semibold",children:"Ã—"})]}),e.jsxs("div",{className:"p-3 max-h-72 overflow-y-auto",children:[v===1&&e.jsx("div",{className:"grid grid-cols-3 gap-2",children:P.map(A=>e.jsx("button",{onClick:()=>R(A),className:"p-2 text-xs border border-gray-300 rounded-md hover:bg-blue-50 hover:border-blue-400 transition-colors text-center",children:A},A))}),v===2&&e.jsx("div",{className:"grid grid-cols-4 gap-2",children:N.map(A=>e.jsx("button",{onClick:()=>F(A.value),className:"p-2 text-xs border border-gray-300 rounded-md hover:bg-blue-50 hover:border-blue-400 transition-colors text-center",children:e.jsx("div",{className:"font-medium",children:A.short})},A.value))}),v===3&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(A=>e.jsx("div",{className:"text-center text-[10px] font-medium text-gray-600",children:A},A))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:k()},(A,L)=>e.jsx("div",{className:"h-7"},`empty-${L}`)),y().map(A=>{const I=!T(u??$,f??0,A);return e.jsx("button",{onClick:()=>j(A),disabled:I,className:`h-7 w-7 text-[11px] rounded-md border transition-colors ${I?"border-gray-200 text-gray-300 cursor-not-allowed":"border-gray-300 hover:bg-blue-50 hover:border-blue-400"}`,children:A},A)})]})]})]})]})})]})},Nc=s=>{if(!s)return null;if(typeof s=="string")try{return JSON.parse(s)}catch{return null}return s},mm=s=>{var r,i;const a=Nc(s==null?void 0:s.requirements)||(s==null?void 0:s.requirements)||{propertyType:"",unitTypes:[],preferredLocations:[],amenities:[],furnishing:"",possession:"",facing:"",floor:"",specialRequirements:""},t=Nc(s==null?void 0:s.financials)||(s==null?void 0:s.financials)||{loanRequired:!1,loanAmount:"",downPayment:"",monthlyIncome:"",bankPreference:"",loanStatus:"",creditScore:""};return{salutation:(s==null?void 0:s.salutation)??"Mr.",name:(s==null?void 0:s.name)??"",phone:(s==null?void 0:s.phone)??"",dob:(s==null?void 0:s.dob)??(s==null?void 0:s.buyer_dob)??wc,whatsapp_number:(s==null?void 0:s.whatsapp_number)??(s==null?void 0:s.whatsapp)??"",email:(s==null?void 0:s.email)??"",state:(s==null?void 0:s.state)??"",city:(s==null?void 0:s.city)??"",location:(s==null?void 0:s.location)??"",buyer_lead_priority:(s==null?void 0:s.buyer_lead_priority)??(s==null?void 0:s.priority)??"",buyer_lead_source:(s==null?void 0:s.buyer_lead_source)??(s==null?void 0:s.source)??"",buyer_lead_stage:(s==null?void 0:s.buyer_lead_stage)??(s==null?void 0:s.stage)??"",buyer_lead_status:(s==null?void 0:s.buyer_lead_status)??(s==null?void 0:s.status)??"",budget_min:(s==null?void 0:s.budget_min)??((r=s==null?void 0:s.budget)==null?void 0:r.min)??"",budget_max:(s==null?void 0:s.budget_max)??((i=s==null?void 0:s.budget)==null?void 0:i.max)??"",requirements:{propertyType:(a==null?void 0:a.propertyType)??"",unitTypes:Array.isArray(a==null?void 0:a.unitTypes)?a.unitTypes:[],preferredLocations:Array.isArray(a==null?void 0:a.preferredLocations)?a.preferredLocations:[],amenities:Array.isArray(a==null?void 0:a.amenities)?a.amenities:[],furnishing:(a==null?void 0:a.furnishing)??"",possession:(a==null?void 0:a.possession)??"",facing:(a==null?void 0:a.facing)??"",floor:(a==null?void 0:a.floor)??"",specialRequirements:(a==null?void 0:a.specialRequirements)??""},financials:{loanRequired:!!(t!=null&&t.loanRequired),loanAmount:(t==null?void 0:t.loanAmount)??"",downPayment:(t==null?void 0:t.downPayment)??"",monthlyIncome:(t==null?void 0:t.monthlyIncome)??"",bankPreference:(t==null?void 0:t.bankPreference)??"",loanStatus:(t==null?void 0:t.loanStatus)??"",creditScore:(t==null?void 0:t.creditScore)??""}}},Fb=(s=[])=>Array.from(new Map(s.map(a=>[a==null?void 0:a.value,a])).values()),Ja=(s=[],a)=>{if(a==null)return"";const t=String(a).trim();if(!t)return"";const r=s.find(n=>String(n.value).toLowerCase()===t.toLowerCase());if(r)return r.value;const i=s.find(n=>String(n.label).toLowerCase()===t.toLowerCase());return i?i.value:t},Io=(s=[],a=[])=>(Array.isArray(a)?a:[]).map(t=>Ja(s,t)).filter(Boolean),$o=({label:s,options:a,selectedValues:t=[],onToggle:r,placeholder:i,withSearch:n=!1})=>{const[o,m]=l.useState(!1),[g,b]=l.useState(""),d=l.useRef(null),v=l.useRef(null),x=Array.isArray(a)?a:[],u=l.useMemo(()=>{if(!n||!g)return x;const f=g.toLowerCase();return x.filter(p=>{var N;return(N=p==null?void 0:p.label)==null?void 0:N.toLowerCase().includes(f)})},[n,g,x]);l.useEffect(()=>{const f=N=>{d.current&&!d.current.contains(N.target)&&(m(!1),b(""))},p=N=>{N.key==="Escape"&&(m(!1),b("")),N.key==="Tab"&&o&&(m(!1),b(""))};return document.addEventListener("mousedown",f),document.addEventListener("keydown",p),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",p)}},[o]),l.useEffect(()=>{o&&n&&v.current&&setTimeout(()=>{var f;(f=v.current)==null||f.focus()},100)},[o,n]);const c=f=>{r(f)};return e.jsxs("div",{className:"relative",ref:d,children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:s}),e.jsxs("button",{type:"button",className:"border border-gray-300 rounded w-full h-8 px-3 text-left text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent flex items-center justify-between hover:border-gray-400 transition-colors",onClick:()=>{m(f=>!f),b("")},onBlur:f=>{var p;(p=d.current)!=null&&p.contains(f.relatedTarget)||setTimeout(()=>{var N;(N=d.current)!=null&&N.contains(document.activeElement)||(m(!1),b(""))},200)},children:[e.jsx("span",{className:"text-gray-500 truncate",children:t.length>0?t.slice(0,2).join(", ")+(t.length>2?` +${t.length-2} more`:""):i}),e.jsx(ea,{size:14,className:`transition-transform duration-200 ${o?"rotate-180":""}`})]}),o&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded shadow-lg max-h-48 overflow-hidden",onMouseDown:f=>f.preventDefault(),children:[n&&e.jsx("div",{className:"p-2 border-b border-gray-200 sticky top-0 bg-white z-10",children:e.jsxs("div",{className:"relative",children:[e.jsx(it,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{ref:v,type:"text",placeholder:"Search...",value:g,onChange:f=>b(f.target.value),onKeyDown:f=>{f.key==="Escape"&&(m(!1),b(""))},className:"w-full pl-7 pr-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"overflow-y-auto max-h-32",children:[u.map(f=>e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-100 cursor-pointer gap-2 transition-colors",onMouseDown:p=>p.preventDefault(),children:[e.jsx("input",{type:"checkbox",checked:t.includes(f.value),onChange:()=>c(f.value),className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:f.label})]},f.value)),u.length===0&&e.jsx("div",{className:"p-2 text-xs text-gray-500 text-center",children:"No options found"})]})]})]})},Eo=new Date,xm=s=>String(s).padStart(2,"0"),Bb=s=>`${s.getFullYear()}-${xm(s.getMonth()+1)}-${xm(s.getDate())}`,Ob=new Date(Eo.getFullYear()-18,Eo.getMonth(),Eo.getDate()),wc=Bb(Ob),um=({isOpen:s,onClose:a,buyer:t,onSave:r})=>{var I,H;const[i,n]=l.useState(!1),[o,m]=l.useState(!0),[g,b]=l.useState({}),[d,v]=l.useState({minBudget:!1,maxBudget:!1}),[x,u]=l.useState(!1),[c,f]=l.useState(()=>mm(t||{})),p=l.useRef(null),{user:N}=Hs();l.useEffect(()=>{const h=K=>{p.current&&!p.current.contains(K.target)&&a()},Y=K=>{K.key==="Escape"&&a()};return s&&(document.addEventListener("mousedown",h),document.addEventListener("keydown",Y),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("keydown",Y),document.body.style.overflow="auto"}},[s,a]);const P=h=>{if(!h)return 0;const Y=new Date(h),K=new Date;let q=K.getFullYear()-Y.getFullYear();const ne=K.getMonth()-Y.getMonth();return(ne<0||ne===0&&K.getDate()<Y.getDate())&&q--,q},w=l.useMemo(()=>P(c.dob),[c.dob]),$=c.dob&&w<18?"Buyer must be at least 18 years old":"";l.useEffect(()=>{s&&(async()=>{try{m(!0);const h=await Gt(["common","buyer","property","lead"]);b(h||{})}catch(h){console.error("Error fetching master options:",h)}finally{m(!1)}})()},[s]),l.useEffect(()=>{if(s){const h=mm(t||{});if(!(t!=null&&t.id)){const Y=((N==null?void 0:N.department)||"").toLowerCase(),K=((N==null?void 0:N.role)||"").toLowerCase();(Y.includes("presale")||Y.includes("sales"))&&K.includes("executive")&&(h.assigned_executive=String(N.id))}f(h)}},[s,t,N]);const y=h=>Fb((g==null?void 0:g[h])||[]);if(l.useEffect(()=>{if(!s||o)return;const h=Nc(t==null?void 0:t.requirements)||(t==null?void 0:t.requirements)||{};f(Y=>{var se,ge,ee,de,U,X,re,fe;const K=y("property type"),q=y("unit type"),ne=y("location"),le=y("amenities"),S=y("furnishing"),C=y("possession"),J=y("facing"),ue=y("floor preference"),Q=y("salutation");return{...Y,salutation:Ja(Q,Y.salutation??(t==null?void 0:t.salutation)),buyer_lead_source:Ja(y("buyer lead source"),Y.buyer_lead_source??(t==null?void 0:t.buyer_lead_source)??(t==null?void 0:t.source)),buyer_lead_priority:Ja(y("lead priority"),Y.buyer_lead_priority??(t==null?void 0:t.buyer_lead_priority)??(t==null?void 0:t.priority)),buyer_lead_stage:Ja(y("buyer lead stage"),Y.buyer_lead_stage??(t==null?void 0:t.buyer_lead_stage)??(t==null?void 0:t.stage)),buyer_lead_status:Ja(y("buyer lead status"),Y.buyer_lead_status??(t==null?void 0:t.buyer_lead_status)??(t==null?void 0:t.status)),requirements:{...Y.requirements,propertyType:Ja(K,((se=Y.requirements)==null?void 0:se.propertyType)??(h==null?void 0:h.propertyType)??""),unitTypes:Io(q,((ge=Y.requirements)==null?void 0:ge.unitTypes)??(h==null?void 0:h.unitTypes)??[]),preferredLocations:Io(ne,((ee=Y.requirements)==null?void 0:ee.preferredLocations)??(h==null?void 0:h.preferredLocations)??[]),amenities:Io(le,((de=Y.requirements)==null?void 0:de.amenities)??(h==null?void 0:h.amenities)??[]),furnishing:Ja(S,((U=Y.requirements)==null?void 0:U.furnishing)??(h==null?void 0:h.furnishing)??""),possession:Ja(C,((X=Y.requirements)==null?void 0:X.possession)??(h==null?void 0:h.possession)??""),facing:Ja(J,((re=Y.requirements)==null?void 0:re.facing)??(h==null?void 0:h.facing)??""),floor:Ja(ue,((fe=Y.requirements)==null?void 0:fe.floor)??(h==null?void 0:h.floor)??"")}}})},[s,o,t,g]),!s)return null;const k=["HDFC Bank","ICICI Bank","SBI","Axis Bank","Kotak Bank","PNB","BOB"],R=["not_applied","applied","pre_approved","approved","rejected"],F=h=>{f(Y=>{const K={...Y,phone:h};if(i){const ne=String(h).replace(/\D/g,"").slice(-10);K.whatsapp_number=ne}return K})},T=h=>{if(n(h),h){const K=String(c.phone).replace(/\D/g,"").slice(-10);f(q=>({...q,whatsapp_number:K}))}},j=h=>f(Y=>({...Y,requirements:{...Y.requirements,...h}})),E=h=>f(Y=>({...Y,financials:{...Y.financials,...h}})),V=h=>v(Y=>({...Y,[h]:!0})),W=(h,Y)=>{v(K=>({...K,[h==="budget_min"?"minBudget":"maxBudget"]:!0})),f(K=>({...K,[h]:Y}))},B=h=>{const K=c.requirements.amenities.includes(h)?c.requirements.amenities.filter(q=>q!==h):[...c.requirements.amenities,h];j({amenities:K})},M=h=>{const K=c.requirements.preferredLocations.includes(h)?c.requirements.preferredLocations.filter(q=>q!==h):[...c.requirements.preferredLocations,h];j({preferredLocations:K})},A=h=>j({preferredLocations:c.requirements.preferredLocations.filter(Y=>Y!==h)}),L=async()=>{var h,Y,K,q;if(x){console.log("âš ï¸ Already submitting, ignoring duplicate call");return}if(console.log("ðŸŸ¢ handleSave called, isSubmitting:",x),!c.name.trim()){Z.error("Name is required");return}if(!c.phone.trim()){Z.error("Phone number is required");return}if($){Z.error($);return}u(!0);try{const ne={...c,assigned_executive:c.assigned_executive??((h=N==null?void 0:N.role)!=null&&h.toLowerCase().includes("executive")?N.id:null),budget_min:c.budget_min,budget_max:c.budget_max,requirements:JSON.stringify(c.requirements||{}),financials:JSON.stringify(c.financials||{}),created_at:(t==null?void 0:t.created_at)||new Date().toISOString(),updated_at:new Date().toISOString()};console.log("ðŸ“¤ Sending payload to API:",{name:ne.name,phone:ne.phone,email:ne.email,budget:`${ne.budget_min}-${ne.budget_max}`});let le;t!=null&&t.id?(console.log(`ðŸ”„ Updating buyer ID: ${t.id}`),le=await Vt.update(t.id,ne),console.log("âœ… Update response:",le)):(console.log("ðŸ†• Creating new buyer"),le=await Vt.create(ne),console.log("âœ… Create response:",le)),r&&typeof r=="function"?(console.log("ðŸ“ž Calling onSave callback"),r(le)):console.warn("âš ï¸ onSave callback not available or not a function"),a==null||a()}catch(ne){console.error("âŒ API Error:",ne),console.error("âŒ Error response:",(Y=ne.response)==null?void 0:Y.data);const le=((q=(K=ne==null?void 0:ne.response)==null?void 0:K.data)==null?void 0:q.message)||(ne==null?void 0:ne.message)||"Unknown error";Z.error(`Failed to save buyer: ${le}`)}finally{console.log("ðŸŸ¢ Setting isSubmitting to false"),u(!1)}},D=(h,Y)=>{var K;return((K=y(h).find(q=>q.value===Y))==null?void 0:K.label)??Y};return o?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading master data..."})]})})}):e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:a,children:e.jsxs("div",{ref:p,className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden",onClick:h=>h.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-2 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t?"Edit Buyer":"Add New Buyer"}),e.jsx("p",{className:"text-gray-600 mt-1 text-xs",children:"Enter buyer information and requirements"})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"px-6 py-2 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-end",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Salutation ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:c.salutation,onChange:h=>f(Y=>({...Y,salutation:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-1 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select"}),y("salutation").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{className:"md:col-span-9",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.name,onChange:h=>f(Y=>({...Y,name:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name",required:!0})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Cs,{className:"mr-2",size:20}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(qn,{country:"in",value:c.phone,onChange:F,inputClass:"!w-full !h-8 !rounded !border-gray-300 !text-xs focus:!ring-1 focus:!ring-blue-500 focus:!border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1 flex items-center gap-2",children:[e.jsx(Ia,{className:"text-green-500"})," WhatsApp Number",e.jsx("div",{className:"ml-auto flex items-center",children:e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:h=>T(h.target.checked),className:"sr-only"}),e.jsx("span",{className:`w-8 h-4 rounded-full relative transition-colors duration-200 ease-in-out ${i?"bg-blue-500":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 bg-white w-3 h-3 rounded-full transition-transform duration-200 ease-in-out ${i?"translate-x-4":"translate-x-0"}`})}),e.jsx("span",{className:"ml-2 text-xs text-gray-600",children:i?"Same as phone":"Different"})]})})]}),e.jsx("input",{type:"tel",value:c.whatsapp_number,onChange:h=>f(Y=>({...Y,whatsapp_number:h.target.value})),onBlur:h=>h.target.blur(),placeholder:"WhatsApp number (without country code)",className:`border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent ${i?"bg-gray-100":""}`,disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:c.email,onChange:h=>f(Y=>({...Y,email:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email address"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx(vc,{value:c.dob||wc,onChange:h=>f(Y=>({...Y,dob:h})),label:"Date of Birth",placeholder:"Select date of birth",size:"sm",max:wc}),$&&e.jsx("p",{className:"mt-1 text-[11px] text-red-600",children:$})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Qs,{className:"mr-2",size:20}),"Location Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:c.state,onChange:h=>f(Y=>({...Y,state:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter state"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:c.city,onChange:h=>f(Y=>({...Y,city:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter city"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Location/Area"}),e.jsx("input",{type:"text",value:c.location,onChange:h=>f(Y=>({...Y,location:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter location/area"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Xs,{className:"mr-2",size:20}),"Business Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Source"}),e.jsxs("select",{value:c.buyer_lead_source,onChange:h=>f(Y=>({...Y,buyer_lead_source:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Source"}),y("buyer lead source").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:c.buyer_lead_priority,onChange:h=>f(Y=>({...Y,buyer_lead_priority:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Priority"}),y("lead priority").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Stage"}),e.jsxs("select",{value:c.buyer_lead_stage,onChange:h=>f(Y=>({...Y,buyer_lead_stage:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Stage"}),y("buyer lead stage").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:c.buyer_lead_status,onChange:h=>f(Y=>({...Y,buyer_lead_status:h.target.value})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Status"}),y("buyer lead status").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(cn,{className:"mr-2",size:20}),"Budget Information (Min-Max)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(dm,{value:c.budget_min,onChange:h=>W("budget_min",h),onFocus:()=>V("minBudget"),error:d.minBudget&&!c.budget_min?"Minimum budget is required":""}),e.jsx(dm,{value:c.budget_max,onChange:h=>W("budget_max",h),onFocus:()=>V("maxBudget"),error:d.maxBudget&&!c.budget_max?"Maximum budget is required":""})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(yt,{className:"mr-2",size:20}),"Property Requirements"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsxs("select",{value:((I=c==null?void 0:c.requirements)==null?void 0:I.propertyType)||"",onChange:h=>f(Y=>({...Y,requirements:{...Y.requirements,propertyType:h.target.value}})),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Property Type"}),y("property type").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx($o,{label:"Unit Type",options:y("unit type"),selectedValues:c.requirements.unitTypes||[],onToggle:h=>{const Y=c.requirements.unitTypes||[],K=Y.includes(h)?Y.filter(q=>q!==h):[...Y,h];j({unitTypes:K})},placeholder:"Select unit types"}),((H=c.requirements.unitTypes)==null?void 0:H.length)>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:c.requirements.unitTypes.map(h=>e.jsxs("span",{className:"flex items-center bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs",children:[D("unit type",h),e.jsx("button",{type:"button",onClick:()=>j({unitTypes:(c.requirements.unitTypes||[]).filter(Y=>Y!==h)}),className:"ml-1 text-green-500 hover:text-green-700",children:"Ã—"})]},h))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Furnishing"}),e.jsxs("select",{value:c.requirements.furnishing,onChange:h=>j({furnishing:h.target.value}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Any"}),y("furnishing").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Possession"}),e.jsxs("select",{value:c.requirements.possession,onChange:h=>j({possession:h.target.value}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Any"}),y("possession").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Facing"}),e.jsxs("select",{value:c.requirements.facing,onChange:h=>j({facing:h.target.value}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Any Facing"}),y("facing").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Floor Preference"}),e.jsxs("select",{value:c.requirements.floor,onChange:h=>j({floor:h.target.value}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Any Floor"}),y("floor preference").map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]})]}),e.jsxs("div",{children:[e.jsx($o,{label:"Preferred Locations",options:y("location"),selectedValues:c.requirements.preferredLocations,onToggle:M,placeholder:"Select preferred locations",withSearch:!0}),c.requirements.preferredLocations.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.requirements.preferredLocations.map(h=>e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs",children:[e.jsx("span",{children:D("location",h)}),e.jsx("button",{onClick:()=>A(h),className:"text-purple-600 hover:text-purple-800",children:e.jsx(ns,{size:10})})]},h))})]}),e.jsxs("div",{children:[e.jsx($o,{label:"Required Amenities",options:y("amenities"),selectedValues:c.requirements.amenities,onToggle:B,placeholder:"Select required amenities",withSearch:!0}),c.requirements.amenities.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.requirements.amenities.map(h=>e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:[e.jsx("span",{children:D("amenities",h)}),e.jsx("button",{onClick:()=>B(h),className:"text-blue-600 hover:text-blue-800",children:e.jsx(ns,{size:10})})]},h))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Special Requirements & Additional Notes"}),e.jsx("textarea",{value:c.requirements.specialRequirements,onChange:h=>j({specialRequirements:h.target.value}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full px-3 py-2 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Any specific requirements or additional notes...",rows:3})]})]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:20}),"Financial Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.financials.loanRequired,onChange:h=>E({loanRequired:h.target.checked}),className:"sr-only"}),e.jsx("span",{className:`w-8 h-4 rounded-full relative transition-colors duration-200 ease-in-out ${c.financials.loanRequired?"bg-blue-500":"bg-gray-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 bg-white w-3 h-3 rounded-full transition-transform duration-200 ease-in-out ${c.financials.loanRequired?"translate-x-4":"translate-x-0"}`})}),e.jsx("span",{className:"ml-2 text-xs font-medium text-gray-700",children:"Loan Required"})]})}),c.financials.loanRequired&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Loan Amount (â‚¹)"}),e.jsx("input",{type:"number",value:c.financials.loanAmount,onChange:h=>E({loanAmount:parseFloat(h.target.value)||0}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter loan amount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Down Payment (â‚¹)"}),e.jsx("input",{type:"number",value:c.financials.downPayment,onChange:h=>E({downPayment:parseFloat(h.target.value)||0}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter down payment"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Monthly Income (â‚¹)"}),e.jsx("input",{type:"number",value:c.financials.monthlyIncome,onChange:h=>E({monthlyIncome:parseFloat(h.target.value)||0}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter monthly income"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bank Preference"}),e.jsxs("select",{value:c.financials.bankPreference,onChange:h=>E({bankPreference:h.target.value}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Bank"}),k.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Loan Status"}),e.jsxs("select",{value:c.financials.loanStatus,onChange:h=>E({loanStatus:h.target.value}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Loan Status"}),R.map(h=>e.jsx("option",{value:h,children:h.split("_").map(Y=>Y[0].toUpperCase()+Y.slice(1)).join(" ")},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Credit Score"}),e.jsx("input",{type:"number",value:c.financials.creditScore,onChange:h=>E({creditScore:Math.max(0,parseInt(h.target.value,10)||0)}),onBlur:h=>h.target.blur(),className:"border border-gray-300 rounded w-full h-8 px-3 text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter credit score",min:300,max:900})]})]})]})]})]}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ct,{size:16,className:"text-gray-400 mr-2"}),e.jsx("span",{className:"text-xs text-gray-500",children:"All fields marked with * are required"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{onClick:L,disabled:x,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ut,{size:16,className:"mr-2"}),t?"Update Buyer":"Create Buyer"]})})]})]})})]})})},Hu=({isOpen:s,onClose:a,activity:t=null,onSave:r})=>{const[i,n]=l.useState({type:(t==null?void 0:t.type)||"call",description:(t==null?void 0:t.description)||"",date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],time:(t==null?void 0:t.time)||"10:00",duration:(t==null?void 0:t.duration)||"30 minutes",stage:(t==null?void 0:t.stage)||"initial_contact",outcome:(t==null?void 0:t.outcome)||"",nextAction:(t==null?void 0:t.nextAction)||"",executedBy:(t==null?void 0:t.executedBy)||"Admin User",remarks:(t==null?void 0:t.remarks)||"",propertyDiscussed:(t==null?void 0:t.propertyDiscussed)||"",followupRequired:(t==null?void 0:t.followupRequired)||!1,followupDate:(t==null?void 0:t.followupDate)||"",rating:(t==null?void 0:t.rating)??3}),[o,m]=l.useState(!1);l.useEffect(()=>{n(t?{type:t.type??"call",description:t.description??"",date:t.date??new Date().toISOString().split("T")[0],time:t.time??"10:00",duration:t.duration??"30 minutes",stage:t.stage??"initial_contact",outcome:t.outcome??"",nextAction:t.nextAction??"",executedBy:t.executedBy??"Admin User",remarks:t.remarks??"",propertyDiscussed:t.propertyDiscussed??"",followupRequired:!!t.followupRequired,followupDate:t.followupDate??"",rating:t.rating??3}:{type:"call",description:"",date:new Date().toISOString().split("T")[0],time:"10:00",duration:"30 minutes",stage:"initial_contact",outcome:"",nextAction:"",executedBy:"Admin User",remarks:"",propertyDiscussed:"",followupRequired:!1,followupDate:"",rating:3})},[t,s]);const g=[{value:"call",label:"Phone Call",icon:Cs,color:"blue"},{value:"visit",label:"Property Visit",icon:ks,color:"green"},{value:"meeting",label:"Meeting",icon:Ns,color:"purple"},{value:"email",label:"Email",icon:Ds,color:"orange"},{value:"whatsapp",label:"WhatsApp",icon:tt,color:"green"},{value:"presentation",label:"Presentation",icon:Is,color:"indigo"}],b=[{value:"initial_contact",label:"Initial Contact"},{value:"requirement_gathering",label:"Requirement Gathering"},{value:"property_hunting",label:"Property Hunting"},{value:"loan_processing",label:"Loan Processing"},{value:"property_finalization",label:"Property Finalization"},{value:"deal_closure",label:"Deal Closure"}],d=["15 minutes","30 minutes","45 minutes","1 hour","1.5 hours","2 hours","3 hours","Half day","Full day"],v=["Admin User","Manager User","Executive User","Sales Team"],x=(f,p)=>{n(N=>({...N,[f]:p}))},u=async()=>{if(!i.description||!String(i.description).trim()){alert("Please enter activity description");return}if(!i.outcome||!String(i.outcome).trim()){alert("Please enter activity outcome");return}m(!0);try{const f={...i,id:(t==null?void 0:t.id)??Date.now(),created_at:(t==null?void 0:t.created_at)??new Date().toISOString(),updated_at:new Date().toISOString()};await Promise.resolve(r(f))}catch(f){console.error("Error saving activity:",f)}finally{m(!1)}};if(!s)return null;const c=(f,p)=>{const N={blue:p?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-600",green:p?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-gray-300 text-gray-600",purple:p?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 hover:border-gray-300 text-gray-600",orange:p?"border-orange-500 bg-orange-50 text-orange-700":"border-gray-200 hover:border-gray-300 text-gray-600",indigo:p?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"};return N[f]||N.blue};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-4 py-2 md:p-6 md:py-2 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-900",children:t?"Edit Activity":"Add New Activity"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Record buyer interaction and outcomes"})]}),e.jsx("button",{onClick:a,className:"p-1 md:p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:16,className:"text-xs"})})]})}),e.jsxs("div",{className:"p-4 md:p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Activity Type"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:g.map(f=>{const p=f.icon,N=i.type===f.value,P=c(f.color,N);return e.jsxs("button",{type:"button",onClick:()=>x("type",f.value),className:`flex items-center space-x-1 p-2 rounded-lg border-2 transition-all text-xs ${P}`,children:[e.jsx(p,{size:14}),e.jsx("span",{className:"font-medium",children:f.label})]},f.value)})})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.description||"",onChange:f=>x("description",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of the activity",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Stage"}),e.jsx("select",{value:i.stage,onChange:f=>x("stage",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:b.map(f=>e.jsx("option",{value:f.value,children:f.label},f.value))})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:i.date,onChange:f=>x("date",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Time"}),e.jsx("input",{type:"time",value:i.time,onChange:f=>x("time",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duration"}),e.jsx("select",{value:i.duration,onChange:f=>x("duration",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:d.map(f=>e.jsx("option",{value:f,children:f},f))})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Outcome ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:i.outcome||"",onChange:f=>x("outcome",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2,placeholder:"What was achieved in this activity?",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Next Action"}),e.jsx("textarea",{value:i.nextAction||"",onChange:f=>x("nextAction",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2,placeholder:"What should be done next?"})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Executed By"}),e.jsx("select",{value:i.executedBy,onChange:f=>x("executedBy",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:v.map(f=>e.jsx("option",{value:f,children:f},f))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Discussed"}),e.jsx("input",{type:"text",value:i.propertyDiscussed||"",onChange:f=>x("propertyDiscussed",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Property name or ID"})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Activity Rating"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(f=>e.jsx("button",{type:"button",onClick:()=>x("rating",f),className:`p-1 rounded ${f<=(i.rating??3)?"text-yellow-500":"text-gray-300"}`,children:e.jsx(Ct,{size:16,className:f<=(i.rating??3)?"fill-current":""})},f)),e.jsx("span",{className:"text-xs text-gray-600 ml-2",children:i.rating===5?"Excellent":i.rating===4?"Good":i.rating===3?"Average":i.rating===2?"Poor":"Very Poor"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!!i.followupRequired,onChange:f=>x("followupRequired",f.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"Follow-up required"})]}),i.followupRequired&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Follow-up Date"}),e.jsx("input",{type:"date",value:i.followupDate||"",onChange:f=>x("followupDate",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Detailed Remarks"}),e.jsx("textarea",{value:i.remarks||"",onChange:f=>x("remarks",f.target.value),className:"w-full px-3 py-2 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4,placeholder:"Detailed notes about the activity, buyer response, concerns, etc."})]})]}),e.jsx("div",{className:"p-4 py-2 md:p-6 md:py-2 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Activity will be added to buyer timeline"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:a,className:"px-3 py-1 text-xs text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:u,disabled:o||!String(i.description||"").trim()||!String(i.outcome||"").trim(),className:"flex items-center space-x-1 px-4 py-1 text-xs bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:o?"Saving...":t?"Update":"Save"})]})]})]})})]})})};function Ub(s){const a=!!(s.visit_date&&s.visit_time),t=!!s.visit_datetime;if(!a&&!t)throw new Error("(visit_date + visit_time) OR visit_datetime is required")}function qb(s){const a=!!(s.revisit_date&&s.revisit_time),t=!!s.revisit_datetime;if(!a&&!t)throw new Error("(revisit_date + revisit_time) OR revisit_datetime is required")}function gm(s){return s.assigned_to!=null&&s.executive_id==null&&(s.executive_id=s.assigned_to),s}function Vb(s={}){const a=new URLSearchParams;return Object.entries(s).forEach(([t,r])=>{r!=null&&`${r}`.length&&a.set(t,String(r))}),a.toString()}const or={async createVisit(s){if(!(s!=null&&s.buyer_id))throw new Error("buyer_id is required");if(!(s!=null&&s.property_id))throw new Error("property_id is required");Ub(s);const a=gm({...s});return(await Ae.post("/visits/create",a,{headers:{"Content-Type":"application/json"}})).data},async getAllVisits(s={}){const a=Vb(s);return(await Ae.get(`/visits/get-all${a?`?${a}`:""}`)).data},async getVisitById(s){if(!s)throw new Error("visitId is required");return(await Ae.get(`/visits/getbyid/${s}`)).data},async updateVisit(s,a){if(!s)throw new Error("visitId is required");const t=gm({...a});return(await Ae.patch(`/visits/update/${s}`,t,{headers:{"Content-Type":"application/json"}})).data},async deleteVisit(s){if(!s)throw new Error("visitId is required");return(await Ae.delete(`/visits/delete/${s}`)).data},async createRevisit(s,a){if(!s)throw new Error("visitId is required");return qb(a),(await Ae.post(`/visits/create-revisit/${s}/revisits`,a,{headers:{"Content-Type":"application/json"}})).data},async getRevisitsByVisit(s){if(!s)throw new Error("visitId is required");return(await Ae.get(`/visits/revisit/${s}/revisits`)).data},async updateRevisit(s,a){if(!s)throw new Error("revisitId is required");return(await Ae.patch(`/revisits/${s}`,a,{headers:{"Content-Type":"application/json"}})).data},async deleteRevisit(s){if(!s)throw new Error("revisitId is required");return(await Ae.delete(`/revisits/${s}`)).data}},Wb=[{value:"site_visit",label:"Site Visit",description:"Visit the property in person"},{value:"virtual_tour",label:"Virtual Tour",description:"Video / photos walkthrough"},{value:"inspection",label:"Inspection",description:"Detailed inspection visit"}],Hb=["30 minutes","45 minutes","60 minutes","90 minutes","120 minutes"],Yb=["scheduled","confirmed","completed","cancelled"],Js=s=>s==null?"":String(s).trim(),Gb=s=>Js(s).toUpperCase(),_c=s=>s.replace(/\D/g,""),Kb=s=>{const a=(s==null?void 0:s.id)??(s==null?void 0:s.user_id)??(s==null?void 0:s._id)??null;return a!=null?Number(a):null},Jb=s=>Js((s==null?void 0:s.name)||(s==null?void 0:s.fullName)||(s==null?void 0:s.username)||""),Qb=s=>Js((s==null?void 0:s.email)||(s==null?void 0:s.mail)||""),Zb=s=>{if(s===!0||s===1)return!0;if(s===!1||s===0||s==null)return!1;const a=String(s).toLowerCase();return a==="1"||a==="true"||a==="public"||a==="yes"},hm=s=>{const a=String(s??"");return a?`REX00${a.padStart(3,"0")}`:""},Xb=s=>{const a=Js(s.property_type_name||s.property_type),t=Gb(s.unit_type),r=Js(s.property_subtype_name||s.property_subtype||s.subtype),i=Js(s.society_name||s.society),n=[a,t,r].filter(Boolean).join(" ");return(i?`${n} (${i})`:n)||Js(s.title)||"Property"},ef=s=>Js(s.address)||[Js(s.location),Js(s.area)].filter(Boolean).join(", "),sf=s=>s.seller_id??s.owner_id??s.contact_id??void 0,tf=s=>Js(s.seller_name||s.owner_name||s.contact_name),af=s=>Js(s.seller_phone||s.owner_phone||s.contact_phone||s.phone),rf=s=>Js(s.seller_email||s.owner_email||s.contact_email),lf=s=>Js(s.seller_salutation),Yu=s=>{if(!s)return 60;const a=s.match(/\d+/);return a?Math.max(1,parseInt(a[0],10)):60},Ln=s=>{if(!s)return"";const a=String(s).match(/(\d{1,2}):(\d{2})/);if(!a)return"";const t=String(Math.min(23,Math.max(0,Number(a[1])))).padStart(2,"0"),r=String(Math.min(59,Math.max(0,Number(a[2])))).padStart(2,"0");return`${t}:${r}`},Fi=s=>{const a=Ln(s);return a?`${a}:00`:""},nf=(s,a)=>{const t=Fi(a||"10:00");return`${s} ${t}`},Sc=s=>{if(!s)return{date:"",time:""};const a=String(s).trim();if(a.includes("T")){const o=new Date(a);if(!isNaN(+o)){const m=u=>String(u).padStart(2,"0"),g=o.getFullYear(),b=m(o.getMonth()+1),d=m(o.getDate()),v=m(o.getHours()),x=m(o.getMinutes());return{date:`${g}-${b}-${d}`,time:`${v}:${x}`}}}const t=a.match(/^(\d{4})-(\d{2})-(\d{2})(?:\s+(\d{2}):(\d{2})(?::(\d{2}))?)?$/);if(t){const[,o,m,g,b="00",d="00"]=t;return{date:`${o}-${m}-${g}`,time:`${b}:${d}`}}const[r,i]=a.split(" "),n=(i||"").slice(0,5);return{date:Js(r),time:Js(n)}},of=s=>{const a=Number(s);return Number.isFinite(a)&&a>0?`${a} minutes`:"60 minutes"},cf=(s,a)=>{if(!s)return"Select date";try{const[t,r,i]=s.split("-").map(Number),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let o=10,m=0;if(a&&a.trim()){const P=a.trim().split(":");P.length>=2&&(o=parseInt(P[0],10)||10,m=parseInt(P[1],10)||0)}o=Math.max(0,Math.min(23,o)),m=Math.max(0,Math.min(59,m));const g=o>=12?"PM":"AM",b=o%12||12,d=m<10?`0${m}`:`${m}`,v=`${n[r-1]} ${i}, ${t}, ${b}:${d} ${g}`,x=new Date(t,r-1,i,o,m),u=new Date,c=x.getTime()-u.getTime(),f=Math.floor(c/6e4);let p="";if(Math.abs(f)<1)p="Just now";else if(f<0){const N=Math.abs(f);N<60?p=`${N} min ago`:N<1440?p=`${Math.round(N/60)}h ago`:p=`${Math.round(N/1440)}d ago`}else f<60?p=`In ${f} min`:f<1440?p=`In ${Math.round(f/60)}h`:p=`In ${Math.round(f/1440)}d`;return`${v} Â· ${p}`}catch(t){return console.error("Error formatting selected time:",t),"Invalid date/time"}},Gu=s=>{if(!s)return new Date(NaN);const a=String(s);if(a.endsWith("Z")){const r=new Date(a),i=5.5*60*60*1e3;return new Date(r.getTime()+i)}if(/[tT]|\+/.test(a))return new Date(a);const t=a.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2}):(\d{2})$/);if(t){const[,r,i,n,o,m,g]=t;return new Date(Date.UTC(+r,+i-1,+n,+o,+m,+g))}return new Date(a)},df=s=>{if(Number.isNaN(s.getTime()))return"Unknown time";const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()],r=s.getDate(),i=s.getFullYear();let n=s.getHours();const o=s.getMinutes(),m=n>=12?"PM":"AM";n=n%12||12;const g=o<10?`0${o}`:`${o}`;return`${t} ${r}, ${i}, ${n}:${g} ${m}`},mf=s=>{const a=Gu(s??"");if(Number.isNaN(a.getTime()))return"Unknown time";const t=Math.floor((Date.now()-a.getTime())/6e4);if(t<1)return"Just now";if(t<60)return`${t} min ago`;const r=Math.round(t/60);return r<24?`${r}h ago`:`${Math.round(r/24)}d ago`},Mo=s=>{const a=Gu(s??"");return`${df(a)} Â· ${mf(s??"")}`},xf=(s,a,t)=>({buyer_id:Number(s.buyerId),buyer_name:s.buyerName||"",seller_id:s.sellerId!=null?Number(s.sellerId):t??null,property_id:Number(s.propertyId),property_title:s.property||"",executive_id:a??null,visit_datetime:nf(s.date,s.time),duration_minutes:Yu(s.duration),visit_type:s.visitType||"site_visit",seller_present:s.sellerPresent?1:0,seller_name:s.sellerName||null,seller_phone:s.sellerPhone?_c(s.sellerPhone):null,accompanied_by:Array.isArray(s.accompaniedBy)?s.accompaniedBy:[],feedback:s.feedback||null,rating:typeof s.rating=="number"?s.rating:3,outcome:s.outcome||null,next_action:s.nextAction||null,concerns:s.concerns||null,positives:s.positives||null,remarks:s.remarks||null,status:s.status||"scheduled",meta:{seller_email:s.sellerEmail||null,seller_salutation:s.sellerSalutation||null,created_from_ui:"VisitModal"}}),uf=(s,a)=>s?(r=>{var g,b;const i=r.visit_datetime||r.datetime,n=Sc(i),o=Js(r.revisitDate??r.revisit_date),m=Js(r.revisitTime??r.revisit_time)||(r.revisit_datetime?Sc(r.revisit_datetime).time:"");return{id:r.id??r.visit_id??r._id,property:Js(r.property||r.property_title),propertyId:String(r.propertyId??r.property_id??""),date:Js(r.date)||n.date||new Date().toISOString().slice(0,10),time:Js(r.time)||n.time||"10:00",duration:Js(r.duration)||of(r.duration_minutes),visitType:Js(r.visitType||r.visit_type||"site_visit"),accompaniedBy:Array.isArray(r.accompaniedBy??r.accompanied_by)?r.accompaniedBy??r.accompanied_by:[],sellerPresent:typeof r.sellerPresent=="boolean"?r.sellerPresent:Number(r.seller_present)===1,sellerName:Js(r.sellerName??r.seller_name),sellerPhone:Js(r.sellerPhone??r.seller_phone??"-"),feedback:Js(r.feedback),rating:typeof r.rating=="number"?r.rating:Number(r.rating)||3,outcome:Js(r.outcome),nextAction:Js(r.nextAction??r.next_action),concerns:Js(r.concerns),positives:Js(r.positives),revisitRequired:typeof r.revisitRequired=="boolean"?r.revisitRequired:!!(r.revisit_date||r.revisit_datetime),revisitDate:o,revisitTime:m||"15:00",remarks:Js(r.remarks),status:Js(r.status)||"scheduled",buyerId:r.buyerId??r.buyer_id??a.id,buyerName:Js(r.buyerName??r.buyer_name)||a.name,created_at:r.created_at,updated_at:r.updated_at,sellerId:r.sellerId??r.seller_id,sellerEmail:Js(r.sellerEmail??r.seller_email??((g=r==null?void 0:r.meta)==null?void 0:g.seller_email)),sellerSalutation:Js(r.sellerSalutation??((b=r==null?void 0:r.meta)==null?void 0:b.seller_salutation))}})(s):{id:void 0,property:"",propertyId:"",date:new Date().toISOString().slice(0,10),time:"10:00",duration:"60 minutes",visitType:"site_visit",accompaniedBy:[],sellerPresent:!1,sellerName:"",sellerPhone:"-",feedback:"",rating:3,outcome:"",nextAction:"",concerns:"",positives:"",revisitRequired:!1,revisitDate:"",revisitTime:"15:00",remarks:"",status:"scheduled",buyerId:a.id,buyerName:a.name,created_at:void 0,updated_at:void 0,sellerId:void 0,sellerEmail:"",sellerSalutation:""},gf=({options:s,value:a,onChange:t,placeholder:r="Select property",loading:i=!1,error:n=null})=>{const[o,m]=l.useState(!1),[g,b]=l.useState(""),d=l.useRef(null),v=s.find(c=>c.id===a),x=l.useMemo(()=>{if(!g.trim())return s;const c=g.toLowerCase().trim();return s.filter(f=>`${f.code} ${f.title} ${f.address} ${f.seller}`.toLowerCase().includes(c))},[s,g]);l.useEffect(()=>{const c=f=>{d.current&&!d.current.contains(f.target)&&(m(!1),b(""))};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]);const u=c=>{t(c),m(!1),b("")};return e.jsxs("div",{className:"relative w-full",ref:d,children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>{m(!o),o||b("")},disabled:i||!!n,className:`
            w-full px-2 py-1.5 text-xs border rounded-md text-left transition-colors
            ${o?"border-green-500 ring-1 ring-green-500":"border-gray-300 hover:border-gray-400"}
            ${i||n?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${!v&&!o?"text-gray-500":"text-gray-900"}
          `,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2 truncate",children:i?e.jsx("span",{className:"text-gray-500",children:"Loading properties..."}):n?e.jsx("span",{className:"text-red-600",children:"Failed to load"}):v?e.jsxs("div",{className:"flex items-center gap-2",children:[v.code&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-green-100 text-green-800 rounded",children:v.code}),e.jsx("span",{className:"truncate",children:v.title})]}):e.jsx("span",{children:r})}),e.jsx(ea,{size:14,className:`transition-transform ${o?"rotate-180":""}`})]})}),o&&e.jsxs("div",{className:"absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg",children:[e.jsxs("div",{className:"p-2 border-b",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{size:14,className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:g,onChange:c=>b(c.target.value),placeholder:"Search by code, title, address, or seller...",className:"w-full pl-8 pr-2 py-1.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-green-500 focus:border-green-500 outline-none",autoFocus:!0})]}),e.jsxs("div",{className:"mt-1 text-[10px] text-gray-500",children:[x.length," of ",s.length," properties"]})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:x.length===0?e.jsxs("div",{className:"p-3 text-center text-xs text-gray-500",children:['No properties found for "',g,'"']}):x.map(c=>e.jsx("button",{type:"button",onClick:()=>u(c.id),className:`
                      w-full text-left p-2 hover:bg-green-50 transition-colors border-b border-gray-100 last:border-b-0
                      ${c.id===a?"bg-green-50":"bg-white"}
                    `,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.code&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-green-100 text-green-800 rounded whitespace-nowrap",children:c.code}),e.jsx("span",{className:"text-xs font-medium text-gray-900 truncate",children:c.title})]}),e.jsx("div",{className:"text-[11px] text-gray-600 truncate",children:c.address}),c.seller&&e.jsxs("div",{className:"text-[11px] text-gray-500 mt-0.5",children:["Seller: ",c.seller,c.sellerPhone&&` Â· ${c.sellerPhone}`]})]}),c.id===a&&e.jsx(_a,{size:14,className:"text-green-600 ml-2 flex-shrink-0"})]})},c.id))})]})]}),n&&e.jsx("p",{className:"text-[11px] text-red-600 mt-1",children:n})]})},od=({isOpen:s,onClose:a,visit:t,onSave:r,buyer:i})=>{const{user:n}=Hs(),o=Kb(n),m=Jb(n),g=Qb(n),b=l.useMemo(()=>uf(t,i),[t,i]),[d,v]=l.useState(b),[x,u]=l.useState([]),[c,f]=l.useState(!1),[p,N]=l.useState(null);l.useEffect(()=>{s&&(v(b),V.current=!1)},[s,b]);const[P,w]=l.useState(""),[$,y]=l.useState(!1),[k,R]=l.useState([]),[F,T]=l.useState(!1),[j,E]=l.useState(null),V=l.useRef(!1);l.useEffect(()=>{if(!s)return;let S=!0;return(async()=>{T(!0),E(null);try{const C=await As.getProperties(),ue=((Array.isArray(C==null?void 0:C.data)?C.data:Array.isArray(C)?C:[])??[]).filter(Q=>Zb(Q.is_public??Q.visibility??Q.isPublic));S&&R(ue)}catch(C){console.error("Error fetching properties:",C),S&&E("Could not load properties")}finally{S&&T(!1)}})(),()=>{S=!1}},[s]),l.useEffect(()=>{const S=(t==null?void 0:t.id)??(t==null?void 0:t.visit_id)??(t==null?void 0:t._id);if(!s||!S)return;let C=!0;return(async()=>{try{f(!0),N(null);const J=await or.getRevisitsByVisit(S),ue=Array.isArray(J==null?void 0:J.data)?J.data:Array.isArray(J)?J:[];if(!C)return;if(u(ue),ue.length){const Q=ue.map(se=>{const{date:ge,time:ee}=Sc(se.revisit_datetime||`${se.revisit_date??""} ${se.revisit_time??""}`);return{raw:se,key:`${ge} ${Fi(ee)}`.trim(),date:ge,time:ee}}).filter(se=>se.date);Q.sort((se,ge)=>se.key.localeCompare(ge.key));const he=Q[Q.length-1];he!=null&&he.date&&v(se=>({...se,revisitRequired:!0,revisitDate:he.date,revisitTime:he.time||"15:00"}))}}catch(J){console.error("Failed to load revisits",J),C&&N("Failed to load revisits")}finally{C&&f(!1)}})(),()=>{C=!1}},[s,t]);const W=l.useMemo(()=>k.map(S=>{const C=String(S.id??""),J=C?hm(C):"",ue=Xb(S),Q=ef(S),he=sf(S),se=tf(S),ge=af(S),ee=rf(S),de=lf(S);return{id:C,code:J,title:ue,address:Q,sellerId:he,seller:se,sellerPhone:ge,sellerEmail:ee,sellerSalutation:de}}),[k]);l.useEffect(()=>{if(V.current||!W.length)return;const S=String(d.propertyId||"");if(!S)return;const C=W.find(he=>he.id===S);if(!C)return;const J=Js(d.property),ue=!Js(d.sellerName)||!Js(d.sellerPhone)||d.sellerId==null||!Js(d.sellerEmail)||!Js(d.sellerSalutation),Q=C.code?`[${C.code}] ${C.title}`:C.title;v(he=>({...he,property:J||Q,propertyId:C.id,sellerName:ue?C.seller||Js(he.sellerName||""):he.sellerName,sellerPhone:ue?C.sellerPhone||Js(he.sellerPhone||""):he.sellerPhone,sellerId:ue?C.sellerId??he.sellerId:he.sellerId,sellerEmail:ue?C.sellerEmail||Js(he.sellerEmail||""):he.sellerEmail,sellerSalutation:ue?C.sellerSalutation||Js(he.sellerSalutation||""):he.sellerSalutation})),V.current=!0},[W,d.propertyId]);const B=(S,C)=>{(S==="time"||S==="revisitTime")&&(C=Ln(String(C||""))),v(J=>({...J,[S]:C}))},M=S=>{const C=W.find(ue=>ue.id===S);if(!C){v(ue=>({...ue,property:"",propertyId:"",sellerName:"",sellerPhone:"",sellerId:void 0,sellerEmail:"",sellerSalutation:""}));return}const J=C.code?`[${C.code}] ${C.title}`:C.title;v(ue=>({...ue,property:J,propertyId:C.id,sellerName:C.seller||Js(ue.sellerName||""),sellerPhone:C.sellerPhone||Js(ue.sellerPhone||""),sellerId:C.sellerId??ue.sellerId,sellerEmail:C.sellerEmail||Js(ue.sellerEmail||""),sellerSalutation:C.sellerSalutation||Js(ue.sellerSalutation||"")}))},A=()=>{const S=P.trim(),C=d.accompaniedBy||[];S&&!C.includes(S)&&(v(J=>({...J,accompaniedBy:[...C,S]})),w(""))},L=S=>{const C=d.accompaniedBy||[];v(J=>({...J,accompaniedBy:C.filter(ue=>ue!==S)}))},D=()=>{const S=(t==null?void 0:t.id)??(t==null?void 0:t.visit_id)??(t==null?void 0:t._id)??d.id??Date.now();return{property:d.property||"",propertyId:d.propertyId||"",date:d.date||new Date().toISOString().split("T")[0],time:Ln(d.time)||"10:00",duration:d.duration||"60 minutes",visitType:d.visitType||"site_visit",accompaniedBy:d.accompaniedBy||[],sellerPresent:d.sellerPresent??!1,sellerName:d.sellerName||"",sellerPhone:d.sellerPhone||"-",feedback:d.feedback||"",rating:d.rating??3,outcome:d.outcome||"",nextAction:d.nextAction||"",concerns:d.concerns||"",positives:d.positives||"",revisitRequired:d.revisitRequired??!1,revisitDate:d.revisitDate||"",revisitTime:Ln(d.revisitTime)||"15:00",remarks:d.remarks||"",status:d.status||"scheduled",id:S,buyerId:d.buyerId??i.id,buyerName:d.buyerName??i.name,sellerId:d.sellerId,sellerEmail:d.sellerEmail,sellerSalutation:d.sellerSalutation,created_at:(t==null?void 0:t.created_at)??d.created_at??new Date().toISOString(),updated_at:new Date().toISOString()}},I=(S,C)=>{var J,ue,Q;return(S==null?void 0:S.id)??(S==null?void 0:S.visit_id)??((J=S==null?void 0:S.data)==null?void 0:J.id)??((ue=S==null?void 0:S.data)==null?void 0:ue.visit_id)??(S==null?void 0:S.insertId)??((Q=S==null?void 0:S.data)==null?void 0:Q.insertId)??C??null},H=async(S,C)=>{if(!C.revisitRequired||!C.revisitDate&&!C.revisitTime)return;const J={revisit_date:C.revisitDate||void 0,revisit_time:Fi(C.revisitTime)||void 0,duration_minutes:Yu(C.duration),accompanied_by:Array.isArray(C.accompaniedBy)?C.accompaniedBy:[],status:"scheduled",remarks:C.remarks||null,executive_id:o??null,meta:{created_from_ui:"VisitModal.revisit",buyer_id:C.buyerId??null,property_id:C.propertyId??null}};await or.createRevisit(S,J);try{const ue=await or.getRevisitsByVisit(S),Q=Array.isArray(ue==null?void 0:ue.data)?ue.data:Array.isArray(ue)?ue:[];u(Q)}catch{}},h=async()=>{if(!d.propertyId||!String(d.propertyId).trim()){alert("Please select a property");return}if(!d.date){alert("Please select visit date");return}y(!0);try{const S=D(),C=xf(S,o,S.sellerId!=null?Number(S.sellerId):null);let J=(t==null?void 0:t.id)??(t==null?void 0:t.visit_id)??(t==null?void 0:t._id)??null;if(J)await or.updateVisit(J,C);else{const ue=await or.createVisit(C);J=I(ue)}await H(J,S),await Promise.resolve(r(S)),a()}catch(S){console.error("Error saving visit:",S),alert("Failed to save visit. Please try again.")}finally{y(!1)}};if(!s)return null;const Y=Js(d.sellerSalutation),K=(Y?`${Y} `:"")+Js(d.sellerName),q=d.created_at?Mo(d.created_at):null,ne=d.updated_at?Mo(d.updated_at):null,le=cf(String(d.date||""),String(d.time||""));return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[100vh] overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:b.id?"Edit Visit":"Schedule Visit"}),e.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["For ",i.name,m?e.jsxs("span",{className:"ml-1 text-gray-500",children:["â€¢ Scheduled by ",m,g?` (${g})`:""]}):null]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[q&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-700",children:[e.jsx(Ls,{size:11})," Created: ",q]}),ne&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-700",children:[e.jsx(Ls,{size:11})," Updated: ",ne]})]})]}),e.jsx("button",{onClick:a,className:"p-1 rounded-lg bg-white hover:bg-gray-50 transition-colors shadow-sm",title:"Close",children:e.jsx(ns,{size:16})})]})}),e.jsx("div",{className:"p-3 max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xs font-semibold text-gray-900 mb-2 flex items-center",children:[e.jsx(Is,{className:"mr-1",size:14}),"Property Selection"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Select Property ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(gf,{options:W,value:String(d.propertyId||""),onChange:M,placeholder:"Search or select property...",loading:F,error:j})]}),d.property&&e.jsxs("div",{className:"p-2 text-xs bg-green-50 border border-green-200 rounded-md",children:[e.jsxs("div",{className:"font-medium text-green-900 flex items-center gap-2",children:[d.propertyId?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded bg-green-600 text-white text-[11px]",children:hm(String(d.propertyId))}):null,e.jsx("span",{children:d.property})]}),!!K.trim()&&e.jsxs("div",{className:"text-green-700",children:["Seller: ",K,d.sellerId?e.jsxs("span",{className:"ml-1 text-green-800/70",children:["[ID: ",String(d.sellerId),"]"]}):null]}),!!d.sellerPhone&&e.jsxs("div",{className:"text-green-700",children:["Contact: ",d.sellerPhone]}),!!d.sellerEmail&&e.jsxs("div",{className:"text-green-700",children:["Email: ",d.sellerEmail]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-2",children:"Visit Type"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:Wb.map(S=>{const C=d.visitType===S.value;return e.jsxs("button",{type:"button",onClick:()=>B("visitType",S.value),className:`p-2 text-xs rounded-md border transition-all text-left ${C?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:S.label}),e.jsx("div",{className:"text-gray-600",children:S.description})]},S.value)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-2",children:"Accompanied By"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("input",{type:"text",value:P,onChange:S=>w(S.target.value),className:"flex-1 px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",placeholder:"Add person (e.g., Wife, Father, Friend)",onKeyDown:S=>S.key==="Enter"&&A()}),e.jsx("button",{onClick:A,className:"px-2 py-1 text-xs bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(d.accompaniedBy||[]).map((S,C)=>e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded-full",children:[e.jsx("span",{children:S}),e.jsx("button",{onClick:()=>L(S),className:"text-green-600 hover:text-green-800",children:e.jsx(ns,{size:10})})]},`${S}-${C}`))})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xs font-semibold text-gray-900 mb-2 flex items-center",children:[e.jsx(Ts,{className:"mr-1",size:14}),"Schedule Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:String(d.date||""),onChange:S=>B("date",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Time"}),e.jsx("input",{type:"time",value:String(d.time||""),onChange:S=>B("time",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duration"}),e.jsx("select",{value:String(d.duration||""),onChange:S=>B("duration",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",children:Hb.map(S=>e.jsx("option",{value:S,children:S},S))})]})]}),d.date?e.jsxs("div",{className:"mt-2 text-[11px] text-gray-600 inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100",children:[e.jsx(Ls,{size:11}),"Planned: ",le]}):null]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xs font-semibold text-gray-900 mb-2 flex items-center",children:[e.jsx(Ms,{className:"mr-1",size:14}),"Seller Information"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!!d.sellerPresent,onChange:S=>B("sellerPresent",S.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"Seller will be present"})]}),d.sellerPresent&&e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2",children:e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Seller Name"}),e.jsx("input",{type:"text",value:String(d.sellerName||""),onChange:S=>B("sellerName",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",placeholder:"Seller name"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Seller Phone"}),e.jsx("input",{type:"tel",value:String(d.sellerPhone||""),onChange:S=>B("sellerPhone",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",placeholder:"+91 98765 43210"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Seller Email"}),e.jsx("input",{type:"email",value:String(d.sellerEmail||""),onChange:S=>B("sellerEmail",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",placeholder:"name@example.com"})]})]}),!!d.sellerId&&e.jsxs("div",{className:"text-[11px] text-gray-600",children:["Seller ID: ",e.jsx("span",{className:"font-medium",children:String(d.sellerId)})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsxs("a",{href:d.sellerPhone?`tel:${_c(String(d.sellerPhone))}`:"#",className:"flex items-center space-x-1 px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[e.jsx(Cs,{size:12}),e.jsx("span",{children:"Call"})]}),e.jsxs("button",{type:"button",onClick:()=>{const S=`${d.date} at ${d.time||"10:00"}`,C=`Hi ${K||"there"}, ${i.name} would like to visit your property ${d.property||""} on ${S}. Please confirm availability. â€” ${m||"Executive"}${g?` (${g})`:""}`,J=_c(String(d.sellerPhone||""));J&&window.open(`https://wa.me/${J}?text=${encodeURIComponent(C)}`,"_blank")},className:"flex items-center space-x-1 px-2 py-1 text-xs bg-green-100 text-green-700 rounded-md hover:bg-green-200 transition-colors",children:[e.jsx(tt,{size:12}),e.jsx("span",{children:"WhatsApp"})]})]})]})]})]}),d.status==="completed"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-2",children:"Visit Feedback"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Overall Rating"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(S=>e.jsx("button",{type:"button",onClick:()=>B("rating",S),className:`p-0.5 rounded ${S<=(d.rating||0)?"text-yellow-500":"text-gray-300"}`,children:e.jsx(Xs,{size:16,className:S<=(d.rating||0)?"fill-current":""})},S)),e.jsx("span",{className:"text-xs text-gray-600 ml-1",children:d.rating===5?"Excellent":d.rating===4?"Good":d.rating===3?"Average":d.rating===2?"Poor":"Very Poor"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Feedback"}),e.jsx("textarea",{value:String(d.feedback||""),onChange:S=>B("feedback",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",rows:2,placeholder:"Overall feedback about the property visit..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"What they liked"}),e.jsx("textarea",{value:String(d.positives||""),onChange:S=>B("positives",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",rows:1,placeholder:"Positive aspects they mentioned..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Concerns/Issues"}),e.jsx("textarea",{value:String(d.concerns||""),onChange:S=>B("concerns",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",rows:1,placeholder:"Any concerns or issues they raised..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Outcome"}),e.jsx("textarea",{value:String(d.outcome||""),onChange:S=>B("outcome",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",rows:1,placeholder:"Final outcome of the visit..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Next Action"}),e.jsx("textarea",{value:String(d.nextAction||""),onChange:S=>B("nextAction",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",rows:1,placeholder:"What should be done next..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"flex items-center space-x-2",children:e.jsx("input",{type:"checkbox",checked:!!d.revisitRequired,onChange:S=>B("revisitRequired",S.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"})}),d.revisitRequired&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Revisit Date"}),e.jsx("input",{type:"date",value:String(d.revisitDate||""),onChange:S=>B("revisitDate",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Revisit Time"}),e.jsx("input",{type:"time",value:String(Ln(d.revisitTime||"15:00")),onChange:S=>B("revisitTime",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500"})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Visit Status"}),e.jsx("select",{value:String(d.status||""),onChange:S=>B("status",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",children:Yb.map(S=>e.jsx("option",{value:S,children:S.charAt(0).toUpperCase()+S.slice(1)},S))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Additional Remarks"}),e.jsx("textarea",{value:String(d.remarks||""),onChange:S=>B("remarks",S.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 focus:border-green-500",rows:2,placeholder:"Any additional notes about the visit..."})]}),((t==null?void 0:t.id)||(t==null?void 0:t.visit_id)||(t==null?void 0:t._id))&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("h3",{className:"text-xs font-semibold text-gray-900 flex items-center",children:[e.jsx(na,{className:"mr-1",size:14}),"Revisits"]}),e.jsx("button",{type:"button",onClick:async()=>{try{f(!0);const S=(t==null?void 0:t.id)??(t==null?void 0:t.visit_id)??(t==null?void 0:t._id),C=await or.getRevisitsByVisit(S),J=Array.isArray(C==null?void 0:C.data)?C.data:Array.isArray(C)?C:[];u(J)}catch{N("Failed to refresh")}finally{f(!1)}},className:"text[11px] px-2 py-0.5 rounded border border-gray-300 hover:bg-gray-50",children:"Refresh"})]}),e.jsx("div",{className:"border border-gray-200 rounded-md p-2 bg-white",children:c?e.jsxs("div",{className:"text-[11px] text-gray-500 flex items-center",children:[e.jsx(Ls,{className:"mr-1",size:12}),"Loading revisitsâ€¦"]}):p?e.jsx("div",{className:"text-[11px] text-red-600",children:p}):x.length===0?e.jsx("div",{className:"text-[11px] text-gray-500",children:"No revisits yet."}):e.jsx("ul",{className:"space-y-1",children:x.map(S=>{const C=S.revisit_datetime||(S.revisit_date?`${S.revisit_date} ${Fi(S.revisit_time||"15:00")}`:""),J=Mo(C),ue=Js(S.status||"scheduled");return e.jsxs("li",{className:"text-[11px] text-gray-700 flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 text-gray-700",children:[e.jsx(Ls,{size:11})," ",J]}),e.jsx("span",{className:"px-1 rounded bg-gray-100 text-gray-700",children:ue}),S.remarks?e.jsxs("span",{className:"text-gray-500",children:["â€” ",S.remarks]}):null]},S.id??S.revisit_id??C)})})})]})]})]})}),e.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Visit will be added to buyer activity timeline"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:a,className:"px-3 py-1 text-xs text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:h,disabled:$||!d.propertyId||!d.date,className:"flex items-center space-x-1 px-3 py-1 text-xs bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:12}),e.jsx("span",{children:$?"Saving...":b.id?"Update":"Schedule"})]})]})]})})]})})};function cd(s={}){const{autoLog:a=!0,publicOnly:t=!1}=s,[r,i]=l.useState([]),[n,o]=l.useState(!1),[m,g]=l.useState(null),b=S=>Array.isArray(S)?S.filter(Boolean):S?[S]:[],d=S=>String(S??"").toLowerCase().trim(),v=(S,C)=>C.some(J=>S.some(ue=>ue.includes(J))),x=S=>{if(typeof S=="boolean")return S;if(S==null)return!1;const C=d(S);return C==="1"||C==="true"||C==="yes"||C==="y"},u=S=>{const C=Number(S);return!C||isNaN(C)?"â‚¹â€”":C>=1e7?`â‚¹${(C/1e7).toFixed(1)}Cr`:C>=1e5?`â‚¹${(C/1e5).toFixed(1)}L`:`â‚¹${C.toLocaleString("en-IN")}`},c=S=>({Available:"bg-emerald-100 text-emerald-700",Sold:"bg-red-100 text-red-700","Under Negotiation":"bg-amber-100 text-amber-700"})[S]||"bg-gray-100 text-gray-700",f=S=>d((S==null?void 0:S.unit_type)||(S==null?void 0:S.bhk)||(S==null?void 0:S.configuration)||(S==null?void 0:S.bhk_label)||(S==null?void 0:S.unit_types)),p=S=>[d(S==null?void 0:S.locality_name),d(S==null?void 0:S.location_name),d(S==null?void 0:S.address),d((S==null?void 0:S.city_name)||(S==null?void 0:S.city))].filter(Boolean),N=S=>(Array.isArray(S==null?void 0:S.amenities)?S.amenities:[]).map(d),P=S=>d((S==null?void 0:S.furnishing)||(S==null?void 0:S.furnished_status)),w=S=>d((S==null?void 0:S.property_subtype_name)||(S==null?void 0:S.property_sub_type)||(S==null?void 0:S.property_subtype)||(S==null?void 0:S.subtype)||(S==null?void 0:S.property_type_name)||(S==null?void 0:S.property_type)||(S==null?void 0:S.type)||""),$=S=>d((S==null?void 0:S.description)||(S==null?void 0:S.title)||""),y=S=>{const C=String((S==null?void 0:S.property_type_name)||(S==null?void 0:S.property_type)||(S==null?void 0:S.type)||(S==null?void 0:S.category)||(S==null?void 0:S.type_name)||"").trim(),J=String((S==null?void 0:S.unit_type)||(S==null?void 0:S.bhk)||(S==null?void 0:S.configuration)||(S==null?void 0:S.bhk_label)||(S==null?void 0:S.unit_types)||"").trim(),ue=String((S==null?void 0:S.property_subtype_name)||(S==null?void 0:S.property_sub_type)||(S==null?void 0:S.property_subtype)||(S==null?void 0:S.subtype)||"").trim(),Q=String((S==null?void 0:S.society_name)||(S==null?void 0:S.project_name)||(S==null?void 0:S.society)||(S==null?void 0:S.societyName)||(S==null?void 0:S.location_name)||"").trim(),he=[C,J,ue].filter(Boolean);return[he.length?he.join(" + "):(S==null?void 0:S.title)||"Property",Q].filter(Boolean).join(" â€” ")},k=S=>(S==null?void 0:S.address)||[(S==null?void 0:S.location_name)||(S==null?void 0:S.locality_name),(S==null?void 0:S.city_name)||(S==null?void 0:S.city)].filter(Boolean).join(", "),R=S=>Number((S==null?void 0:S.budget)??(S==null?void 0:S.price)??(S==null?void 0:S.expected_price)??0),F=S=>{const C=Number((S==null?void 0:S.min_price)??(S==null?void 0:S.budget_min)??(S==null?void 0:S.minBudget)??0),J=Number((S==null?void 0:S.max_price)??(S==null?void 0:S.budget_max)??(S==null?void 0:S.maxBudget)??0);return{min:C,max:J}},T=S=>{const C=(S==null?void 0:S.unit_type)||(S==null?void 0:S.bhk_label)||(S==null?void 0:S.unit_types)||"",J=Number((S==null?void 0:S.carpet_area)??(S==null?void 0:S.area)??(S==null?void 0:S.super_builtup_area)??0),ue=J?`${Number(J).toLocaleString("en-IN")} sq ft`:"";return[C,ue].filter(Boolean).join(" â€¢ ")},j=S=>{const C=(S==null?void 0:S.floor)??(S==null?void 0:S.floor_no)??(S==null?void 0:S.floor_number),J=(S==null?void 0:S.total_floors)??(S==null?void 0:S.totalFloors),ue=C===0||String(C).toLowerCase().includes("ground")?"Ground":(C??"").toString();return[ue&&`Floor ${ue}`,J?`of ${J}`:""].filter(Boolean).join(" ")},E=S=>(S==null?void 0:S.facing)||(S==null?void 0:S.facing_name)||(S==null?void 0:S.facing_type)||(S==null?void 0:S.direction)||(S==null?void 0:S.direction_name)||(S==null?void 0:S.orientation)||(S==null?void 0:S.property_facing)||(S==null?void 0:S.property_facing_name)||"â€”",V=S=>{const C=S!=null&&S.parking_qty?String(S.parking_qty):"",J=(S==null?void 0:S.parking_type)||"";return[C,J].filter(Boolean).join(" ")},W=S=>{const C=Number(S==null?void 0:S.possession_year),J=Number(S==null?void 0:S.possession_month);if(C&&J){const ue=new Date(C,J-1,1);return ue<=new Date?"Ready to Move":ue.toLocaleString("en-IN",{month:"short",year:"numeric"})}return(S==null?void 0:S.status)==="Available"?"Ready to Move":(S==null?void 0:S.status)||"â€”"},B=S=>(S==null?void 0:S.seller_name)||(S==null?void 0:S.owner_name)||(S==null?void 0:S.contact_name)||"â€”",M=S=>(S==null?void 0:S.seller_phone)||(S==null?void 0:S.owner_phone)||(S==null?void 0:S.contact_phone)||(S==null?void 0:S.phone)||"",A=S=>{const C=Array.isArray(S==null?void 0:S.photos)&&S.photos.length?S.photos[0]:"",J=typeof C=="string"?C:(C==null?void 0:C.url)||"";return(S==null?void 0:S.image)||(S==null?void 0:S.photo)||J||""},L=(S,C)=>{var Pe,We;const J=[],ue=R(S),Q=Number(((Pe=C==null?void 0:C.budget)==null?void 0:Pe.min)??(C==null?void 0:C.budgetMin)??0),he=Number(((We=C==null?void 0:C.budget)==null?void 0:We.max)??(C==null?void 0:C.budgetMax)??0);ue&&(Q||he)&&((!Q||ue>=Q)&&(!he||ue<=he)?J.push("ðŸ’° Perfect budget match"):Q&&he&&ue>=Q*.9&&ue<=he*1.1&&J.push("ðŸ’¸ Near your budget"));const se=(C==null?void 0:C.requirements)||{},ge=b(se.unitTypes).map(d),ee=b(se.preferredLocations).map(d),de=b(se.amenities).map(d),U=d(se.facing),X=d(se.furnishing),re=d(se.possession),fe=d(se.propertyType),G=d(se.floor),me=d(se.specialRequirements||"").split(/\s+/).filter(Boolean),oe=f(S);ge.length&&oe&&ge.includes(oe)&&J.push(`ðŸ›ï¸ ${oe.toUpperCase()} as preferred`),ee.length&&v(p(S),ee)&&J.push("ðŸ“ Preferred location");const Fe=N(S);if(de.length&&Fe.length){const pe=de.filter(O=>Fe.includes(O));pe.length&&J.push(`ðŸ—ï¸ Amenities matched (${pe.slice(0,50).join(", ")})`)}const $e=d(E(S));U&&$e&&U===$e&&J.push(`ðŸ§­ ${U} facing`);const Le=P(S);X&&Le&&X===Le&&J.push(`ðŸ›‹ï¸ ${X}`);const je=d(W(S));re&&je&&je.includes(re)&&J.push(`ðŸ—“ï¸ ${re}`);const _e=w(S);fe&&_e&&_e.includes(fe)&&J.push(`ðŸ¢ ${fe} type`);const ve=d((S==null?void 0:S.floor)||"");if(G&&(G.includes("ground")&&(ve.includes("ground")||ve==="0")&&J.push("ðŸ  Ground floor"),G.includes("higher")&&/\d+/.test(ve)&&Number(ve)>=7&&J.push("â¬†ï¸ Higher floor"),G.includes("lower")&&/\d+/.test(ve)&&Number(ve)<=3&&J.push("â¬‡ï¸ Lower floor")),me.length){const pe=$(S)+" "+N(S).join(" "),O=me.filter(Ie=>pe.includes(Ie)).slice(0,50);O.length&&J.push(`âœ¨ Matches: ${O.join(", ")}`)}return J},D=(S,C)=>{var oe,Fe;let J=0;const ue=R(S),Q=Number(((oe=C==null?void 0:C.budget)==null?void 0:oe.min)??(C==null?void 0:C.budgetMin)??0),he=Number(((Fe=C==null?void 0:C.budget)==null?void 0:Fe.max)??(C==null?void 0:C.budgetMax)??0);ue&&(Q||he)&&((!Q||ue>=Q)&&(!he||ue<=he)?J+=25:Q&&he&&ue>=Q*.9&&ue<=he*1.1?J+=15:J+=5);const se=(C==null?void 0:C.requirements)||{},ge=b(se.preferredLocations).map(d),ee=b(se.unitTypes).map(d),de=b(se.amenities).map(d),U=d(se.facing),X=d(se.furnishing),re=d(se.possession),fe=d(se.propertyType),G=d(se.floor);if(ge.length&&v(p(S),ge)&&(J+=20),ee.length&&ee.includes(f(S))&&(J+=15),de.length){const $e=de.filter(Le=>N(S).includes(Le)).length;$e>=3?J+=15:$e===2?J+=10:$e===1&&(J+=6)}U&&d(E(S))===U&&(J+=8),X&&P(S)===X&&(J+=6),re&&d(W(S)).includes(re)&&(J+=6),fe&&w(S).includes(fe)&&(J+=3);const me=d((S==null?void 0:S.floor)||"");return G&&(G.includes("ground")&&(me.includes("ground")||me==="0")||G.includes("higher")&&/\d+/.test(me)&&Number(me)>=7||G.includes("lower")&&/\d+/.test(me)&&Number(me)<=3)&&(J+=2),Math.max(0,Math.min(100,Math.round(J)))},I=(S,C)=>{var J;return{id:String((S==null?void 0:S.id)??(S==null?void 0:S.property_id)??Math.random()),title:y(S),address:k(S),price:R(S),size:T(S),floorLine:j(S),facing:E(S),parking:V(S),possession:W(S),amenities:(S==null?void 0:S.amenities)||[],seller:B(S),sellerPhone:M(S),statusText:(S==null?void 0:S.status)||"Available",matchScore:D(S,C),photo:A(S),_raw:S,reasons:L(S,C),unitType:(J=f(S))==null?void 0:J.toUpperCase()}},H=(S,C)=>{var U,X;const J=Number(((U=C==null?void 0:C.budget)==null?void 0:U.min)??(C==null?void 0:C.budgetMin)??0),ue=Number(((X=C==null?void 0:C.budget)==null?void 0:X.max)??(C==null?void 0:C.budgetMax)??0),Q=!!J,he=!!ue;if(!Q&&!he)return!0;const{min:se,max:ge}=F(S);if(!!se&&!!ge&&ge>=se){const re=Q?J:Number.NEGATIVE_INFINITY,fe=he?ue:Number.POSITIVE_INFINITY;return Math.max(se,re)<=Math.min(ge,fe)}const de=R(S);return!(!de||Q&&de<J||he&&de>ue)},h=(S,C,J)=>{const ue=d(J.location||""),Q=Number(J.minPrice||0),he=Number(J.maxPrice||0),se=d(J.propertyType||""),ge=b(J.unitTypes).map(d),ee=d(J.furnishing||""),de=d(J.possession||"");return S.filter(U=>{if(t&&!x((U==null?void 0:U.is_public)??(U==null?void 0:U.isPublic)??(U==null?void 0:U.public))||!H(U,C)||ue&&!v(p(U),[ue]))return!1;const{min:X,max:re}=F(U),fe=R(U),G=!!X&&!!re&&re>=X;if(Q||he){if(G){const me=Q||Number.NEGATIVE_INFINITY,oe=he||Number.POSITIVE_INFINITY;if(Math.max(X,me)>Math.min(re,oe))return!1}else if(fe&&(Q&&fe<Q||he&&fe>he))return!1}if(se&&!w(U).includes(se))return!1;if(ge.length){const me=f(U);if(!me||!ge.includes(me))return!1}return!(ee&&P(U)!==ee||de&&!d(W(U)).includes(de))})},Y=l.useCallback(S=>t?S.filter(C=>x((C==null?void 0:C.is_public)??(C==null?void 0:C.isPublic)??(C==null?void 0:C.public))):S,[t]),K=l.useCallback(async()=>{o(!0),g(null);try{const S=await As.getProperties();console.log("res",S);const C=Array.isArray(S==null?void 0:S.data)?S.data:Array.isArray(S)?S:[],J=Y(C);return i(J),J}catch(S){return console.error("âŒ Could not load properties:",S),g("Could not load properties"),i([]),[]}finally{o(!1)}},[Y]),q=l.useCallback(async S=>{o(!0),g(null);try{const C=await As.searchProperties(S),J=Array.isArray(C==null?void 0:C.data)?C.data:Array.isArray(C==null?void 0:C.properties)?C.properties:Array.isArray(C)?C:[],ue=Y(J);return i(ue),ue}catch(C){return console.error("âŒ Search failed:",C),g("Search failed"),i([]),[]}finally{o(!1)}},[Y]);return l.useEffect(()=>{K()},[K]),l.useEffect(()=>{if(!a)return;const S=r.length;if(console.log(`ðŸ¡ properties updated: ${S}`),S){const C=r.slice(0,3).map(J=>({id:(J==null?void 0:J.id)??(J==null?void 0:J.property_id),title:(J==null?void 0:J.title)||y(J),public:x((J==null?void 0:J.is_public)??(J==null?void 0:J.isPublic)??(J==null?void 0:J.public))}));console.table(C)}},[r,a]),l.useEffect(()=>{a&&console.log(n?"â³ loading propertiesâ€¦":"âœ… properties loading complete")},[n,a]),l.useEffect(()=>{a&&m&&console.warn("âš ï¸ propsError:",m)},[m,a]),{properties:r,loadingProps:n,propsError:m,fetchProperties:K,searchProperties:q,logProperties:()=>{const S=r.map(C=>({id:(C==null?void 0:C.id)??(C==null?void 0:C.property_id),title:(C==null?void 0:C.title)||y(C),budget:u(R(C)),public:x((C==null?void 0:C.is_public)??(C==null?void 0:C.isPublic)??(C==null?void 0:C.public)),seller_id:(C==null?void 0:C.seller_id)??(C==null?void 0:C.sellerId)??(C==null?void 0:C.owner_seller_id)??"",city:(C==null?void 0:C.city_name)||(C==null?void 0:C.city)||""}));console.table(S)},utils:{toArr:b,norm:d,hasAny:v,formatCurrency:u,getAvailabilityBadgeClass:c,unitTypeFrom:f,locTokensFrom:p,amenitiesFrom:N,furnishingFrom:P,propTypeFrom:w,descriptionFrom:$,titleFrom:y,addressFrom:k,priceFrom:R,priceRangeFrom:F,sizeFrom:T,floorLine:j,facingFrom:E,parkingFrom:V,possessionFrom:W,sellerFrom:B,sellerPhoneFrom:M,photoFrom:A,computeReasons:L,computeMatchScore:D,makeItem:I,isWithinBuyerBudget:H,filterProperties:h}}}const hf=s=>s==null?"":String(s),pf=s=>hf(s).replace(/\D/g,""),Rn=(s,a=0)=>{const t=typeof s=="string"?parseFloat(s):Number(s);return Number.isFinite(t)?t:a},xl=s=>{if(Array.isArray(s))return s.map(String).filter(Boolean);if(typeof s=="string"){const a=s.trim();if(!a)return[];if(a.startsWith("[")&&a.endsWith("]"))try{const t=JSON.parse(a);return Array.isArray(t)?t.map(String).filter(Boolean):[]}catch{return[]}return a.split(",").map(t=>t.trim()).filter(Boolean)}return[]},Lo=s=>(s??"").toString().replace(/\s+/g," ").trim().replace(/\b(bhk)\b/gi,"BHK").replace(/\b\w/g,a=>a.toUpperCase()),bf=s=>s.map(a=>(a??"").toString().trim()).filter(Boolean).join(" "),yn=s=>Number.isFinite(s)?s>=1e7?`â‚¹${(s/1e7).toFixed(1)}Cr`:s>=1e5?`â‚¹${(s/1e5).toFixed(1)}L`:`â‚¹${s.toLocaleString("en-IN")}`:"â‚¹0",ff=s=>s>=90?"text-green-600 bg-green-100 border-green-200":s>=80?"text-blue-600 bg-blue-100 border-blue-200":s>=70?"text-orange-600 bg-orange-100 border-orange-200":"text-red-600 bg-red-100 border-red-200",yf=s=>{const a={very_high:{bg:"bg-green-100",text:"text-green-700",label:"Very High",icon:"ðŸš€"},high:{bg:"bg-blue-100",text:"text-blue-700",label:"High",icon:"ðŸ“ˆ"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium",icon:"ðŸ“Š"},low:{bg:"bg-gray-100",text:"text-gray-700",label:"Low",icon:"ðŸ“‰"}},t=a[s]??a.medium;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs ${t.bg} ${t.text}`,children:[t.icon," ",t.label]})},jf=s=>{if(Array.isArray(s))return s;if(typeof s=="string"){const a=s.trim();if(!a)return[];if(a.startsWith("[")&&a.endsWith("]"))try{return JSON.parse(a)}catch{return[]}return a.split(",").map(t=>t.trim()).filter(Boolean)}return[]},kc=(s,a,t)=>s>=a&&s<=t,vf=s=>s!=null?`REX00${String(s)}`:"REX00â€”",Nf=s=>{if(!s)return"";const a=String(s).replace(/\D/g,"");return a?a.startsWith("91")?a:a.length===10?`91${a}`:a:""},pm=s=>{const a=(s==null?void 0:s.is_public)??(s==null?void 0:s.public)??(s==null?void 0:s.status)??(s==null?void 0:s.visibility);if(typeof a=="boolean")return a;if(typeof a=="number")return a===1;const t=String(a??"").trim().toLowerCase();return["1","true","public","published","yes","active","available"].includes(t)};function wf(s){const a=(s==null?void 0:s.is_sold)??(s==null?void 0:s.sold)??(s==null?void 0:s.isSold);if(typeof a=="boolean")return a?"sold":"available";if(typeof a=="number")return a===1?"sold":"available";const t=(s==null?void 0:s.available)??(s==null?void 0:s.is_available)??(s==null?void 0:s.isAvailable);if(typeof t=="boolean")return t?"available":"sold";if(typeof t=="number")return t===1?"available":"sold";const r=(s==null?void 0:s.availability_status)??(s==null?void 0:s.listing_status)??(s==null?void 0:s.status)??(s==null?void 0:s.availability)??(s==null?void 0:s.property_status),i=String(r??"").trim().toLowerCase();return["sold","booked","unavailable","not available","closed"].includes(i)?"sold":(["available","active","listed","open","public"].includes(i),"available")}function _f({status:s}){const a=s==="available",t=a?"bg-green-100 text-green-700 ring-1 ring-green-200":"bg-red-100 text-red-700 ring-1 ring-red-200",r=a?bs:Ta;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] ${t}`,children:[e.jsx(r,{size:10}),a?"Available":"Sold"]})}const Sf=s=>{var m,g;if(!s)return null;const a=typeof s.requirements=="string"?(()=>{try{return JSON.parse(s.requirements)}catch{return{}}})():s.requirements||{},t=xl(a.preferredLocations).length?xl(a.preferredLocations):xl(a.preferredlocations),r=a.unitType!==void 0&&a.unitType!==null?a.unitType:xl(a.unitTypes).length?xl(a.unitTypes):void 0,i=a.city||s.city?String(a.city||s.city):void 0,n=Rn(((m=s==null?void 0:s.budget)==null?void 0:m.min)??(s==null?void 0:s.budget_min)??0),o=Rn(((g=s==null?void 0:s.budget)==null?void 0:g.max)??(s==null?void 0:s.budget_max)??0);return{name:String(s.name||"Buyer"),leadScore:Rn(s.leadScore??s.buyer_lead_score??s.lead_score??70),budget:{min:n,max:o},requirements:{unitType:r,preferredLocations:t,city:i},city:i}};function Do(s){const a=String(s||"").replace(/\s+/g," ").toLowerCase().match(/(\d+)\s*(bhk|bed|bedroom)?/i);return a?a[1]:""}function kf(s,a){var P,w,$;const t=s.price||s.budget||0;if(!kc(t,a.budget.min,a.budget.max))return 0;const i=55,n=25,o=15,m=5;let g=0;const b=(a.budget.min+a.budget.max)/2,d=Math.max(1,(a.budget.max-a.budget.min)/2),v=Math.abs(t-b),x=Math.max(0,1-v/d);g+=Math.round(i*x);let u=0;if((P=a.requirements.preferredLocations)!=null&&P.length){const y=(s.location||s.address||"").toLowerCase();u=a.requirements.preferredLocations.some(R=>y.includes(String(R||"").toLowerCase()))?n:0}else u=Math.round(n*.5);g+=u;let c=0;if(a.requirements.unitType){const y=Array.isArray(a.requirements.unitType)?a.requirements.unitType.map(Do):[Do(String(a.requirements.unitType))],k=Do(String(s.unitType||"")),R=y.some(T=>T&&T===k),F=!R&&y.some(T=>T&&(s.unitType||"").toLowerCase().includes(T));c=R?o:F?Math.round(o*.6):0}else c=Math.round(o*.5);g+=c;const f=(((w=s.photos)==null?void 0:w.length)||s.photo)>0,p=((($=s.amenities)==null?void 0:$.length)||0)>0,N=(Number(f)+Number(p))/2;return g+=Math.round(m*N),Math.max(0,Math.min(100,g))}function Ku(s){const a=s.price||s.budget||0;return a>=25e6?"very_high":a>=18e6?"high":a>=12e6?"medium":"low"}function Cf(s){switch(Ku(s)){case"very_high":return"2.8%";case"high":return"3.2%";case"medium":return"4.1%";default:return"3.5%"}}const Af=({tag:s})=>{const a=Ea(s),t=typeof a.emoji=="string",r=!t&&a.emoji?a.emoji:null;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] ring-1 ${a.bg} ${a.text} ${a.ring}`,title:s,children:[r?e.jsx(r,{size:10}):t?e.jsx("span",{children:a.emoji}):null,e.jsx("span",{className:"capitalize",children:s})]})};function Pf(s,a){var i;const t=(a==null?void 0:a.website)||(a==null?void 0:a.url)||s.website||s.url;if(t&&/^https?:\/\//i.test(String(t)))return String(t);const r=typeof window<"u"&&((i=window.location)!=null&&i.origin)?window.location.origin:"https://investordeal.in";if(s!=null&&s.slug){const n=String(s.slug).replace(/^\//,"");return`${r}/properties/${n}`}return`${r}/properties/${s==null?void 0:s.id}`}const Ju=({isOpen:s,onClose:a,buyer:t})=>{const r=l.useMemo(()=>Sf(t),[t]),[i,n]=l.useState(""),[o,m]=l.useState([]),[g,b]=l.useState("all"),[d,v]=l.useState(null),[x,u]=l.useState({}),[c,f]=l.useState(!1),[p,N]=l.useState(null),{properties:P,loadingProps:w,propsError:$,fetchProperties:y,utils:k}=cd({autoLog:!1}),{makeItem:R,norm:F,toArr:T}=k;l.useEffect(()=>{if(!s)return;y();let C=!1;return(async()=>{try{f(!0),N(null);const J=await Qt.getAll();if(C)return;const ue={};for(const Q of J)ue[String(Q.property_id)]=Array.isArray(Q==null?void 0:Q.tags)?Q.tags:[];u(ue)}catch(J){N((J==null?void 0:J.message)||"Failed to load tags")}finally{C||f(!1)}})(),()=>{C=!0}},[s,y]);const j=l.useMemo(()=>Array.isArray(P)?P.filter(pm).map(C=>{const J=(()=>{const re=jf((C==null?void 0:C.photos)??(C==null?void 0:C.images)??(C==null?void 0:C.media));return re.length&&typeof re[0]=="object"?re.map(fe=>(fe==null?void 0:fe.url)??(fe==null?void 0:fe.src)??"").filter(Boolean):re})(),ue=C.property_type_name||C.property_type||"",Q=C.unit_type||C.bhk_label||C.configuration||"",he=C.property_subtype_name||C.property_subtype||"",se=xl(he),ge=se.length>0?se:he?[String(he)]:[],ee=C.title||C.project_name||C.name||C.property_name||C.society_name,de=(()=>{const re=Array.isArray(ge)?ge.filter(Boolean).join(" / "):ge,fe=[Lo(ue),Lo(Q),Lo(re)];return bf(fe).trim()||(ee?String(ee):"Untitled Property")})(),U=C.assignedTo||(C.executive_name||C.executive_email||C.executive_phone?{name:C.executive_name||null,email:C.executive_email||null,phone:C.executive_phone||null}:null),X=wf(C);return{id:(C==null?void 0:C.property_id)??(C==null?void 0:C.id)??(C==null?void 0:C._id)??(C==null?void 0:C.uuid)??(C==null?void 0:C.slug)??`temp-${Math.random()}`,title:de,propertyType:ue?String(ue):void 0,unitType:Q?String(Q):void 0,propertySubtype:ge,slug:C.slug,photos:J,city:C.city_name||C.city||C.cityNormalized,location:C.location_name||C.location||C.locationNormalized||C.locality,address:C.address||C.full_address,budget:Rn(C.budget??C.final_price??C.price??C.expected_price??0),carpet_area:Rn(C.carpet_area??C.carpetArea??C.area??0),amenities:Array.isArray(C.amenities)?C.amenities:xl(C.amenities),website:C.website||C.url,url:C.url,assignedTo:U,is_public:pm(C),status:X,raw:C}}):[],[P]),E=l.useMemo(()=>r?j.map(C=>{var X,re,fe;const J=kf(C,r),ue=Ku(C),Q=Cf(C),he=C.carpet_area&&C.carpet_area>0?Math.max(0,Math.round((C.budget||0)/C.carpet_area)):0,se=[{name:`${C.location||C.city||"Local"} Metro`,distance:"0.8 km",type:"transport"},{name:"Mall / High Street",distance:"1.5 km",type:"shopping"},{name:"Hospital",distance:"2.0 km",type:"healthcare"}],ge=[];if(C.budget&&r&&kc(C.budget,r.budget.min,r.budget.max)&&ge.push("Perfect budget match within your range"),C.location&&((X=r.requirements.preferredLocations)!=null&&X.some(G=>(C.location||"").toLowerCase().includes(String(G).toLowerCase())))&&ge.push("Located in your preferred area"),C.unitType&&r.requirements.unitType){const G=r.requirements.unitType;(Array.isArray(G)?G.some(oe=>String(C.unitType).toLowerCase().includes(String(oe).toLowerCase())):String(C.unitType).toLowerCase().includes(String(G).toLowerCase()))&&ge.push("Matches your preferred configuration")}(re=C.amenities)!=null&&re.length&&ge.push("Has your required amenities");const ee=((fe=C.photos)==null?void 0:fe[0])||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800",de=Pf(C,C.raw),U=Array.isArray(C.propertySubtype)?C.propertySubtype.join(" / "):C.propertySubtype||"";return{id:String(C.id),propertyCode:vf(C.id),title:C.title,propertyType:C.propertyType||"",unitType:C.unitType||"",propertySubtype:U,address:(C.address||`${C.location||""}${C.city?", "+C.city:""}`||"").trim(),price:C.budget||0,area:C.carpet_area||0,perSqft:he,matchScore:J,aiReasons:ge,highlights:["Good connectivity","Growth potential","Amenities"],rating:4.7,images:[ee],amenities:C.amenities||[],nearbyPlaces:se,priceHistory:{trend:"up",change:"+3.5%",period:"6 months"},investmentPotential:ue,rentalYield:Q,appreciationRate:ue==="very_high"?"10-15%":ue==="high"?"8-12%":"6-9%",raw:C,tags:x[String(C.id)]||[],assignedTo:C.assignedTo||null,publicUrl:de,slug:C.slug,propertyId:C.id,shareImage:ee,status:C.status}}):[],[j,r,x]),V=l.useMemo(()=>{if(!r)return[];const C=he=>kc(he.price||0,r.budget.min,r.budget.max),J=E.filter(C),ue=(()=>{switch(g){case"budget_match":return J;case"high_match":return J.filter(he=>he.matchScore>=85);case"investment":return J.filter(he=>he.investmentPotential==="high"||he.investmentPotential==="very_high");case"all":default:return J}})();return(i?ue.filter(he=>{var ge,ee,de,U,X,re;const se=i.toLowerCase();return((ge=he.title)==null?void 0:ge.toLowerCase().includes(se))||((ee=he.address)==null?void 0:ee.toLowerCase().includes(se))||((de=he.propertyType)==null?void 0:de.toLowerCase().includes(se))||((U=he.unitType)==null?void 0:U.toLowerCase().includes(se))||((X=he.tags)==null?void 0:X.some(fe=>fe.toLowerCase().includes(se)))||((re=he.status)==null?void 0:re.toLowerCase().includes(se))}):ue).sort((he,se)=>se.matchScore-he.matchScore||(he.price||0)-(se.price||0))},[E,g,r,i]),W=C=>{m(J=>J.includes(C)?J.filter(ue=>ue!==C):[...J,C])},B=C=>{alert(`Visit scheduled for ${C.title}. You will receive confirmation shortly.`)},M=C=>{alert(`${C.title} added to your shortlist!`)},A=C=>{alert(`More information requested for ${C.title}. Executive will be notified.`)},L=C=>{var he,se;const J=((he=C.assignedTo)==null?void 0:he.phone)||"",ue=Nf(J);if(!ue)return alert("Executive phone not available.");const Q=`Hi ${((se=C.assignedTo)==null?void 0:se.name)||"there"}, I'm interested in "${C.title}". My budget is ${yn((r==null?void 0:r.budget.min)??0)} - ${yn((r==null?void 0:r.budget.max)??0)}. Can we schedule a visit?`;typeof window<"u"&&window.open(`https://wa.me/${ue}?text=${encodeURIComponent(Q)}`,"_blank","noopener,noreferrer")},D=C=>{var Q;const J=((Q=C.assignedTo)==null?void 0:Q.phone)||"",ue=pf(J);if(!ue)return alert("Executive phone not available.");window.open(`tel:${ue}`,"_self")},I=C=>{window.open(C.publicUrl,"_blank","noopener,noreferrer")},H=C=>{v({title:C.title,description:C.address||"",image:C.shareImage,url:C.publicUrl,slug:C.slug,propertyId:C.propertyId})},h=()=>{if(!o.length){alert("Please select properties to send to buyer");return}V.filter(C=>o.includes(String(C.id))),alert(`${o.length} properties sent to ${(r==null?void 0:r.name)||"buyer"}.`),m([])};if(!s||!r)return null;const Y=r.name||"Buyer",K=r.budget.min,q=r.budget.max,ne=Array.isArray(r.requirements.unitType)?r.requirements.unitType.join(", "):r.requirements.unitType||"Any",le=r.requirements.preferredLocations.length?r.requirements.preferredLocations.join(", "):r.requirements.city||r.city||"Any",S=r.leadScore??70;return e.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden text-xs",children:[e.jsx("div",{className:"p-4 border-b bg-[#E6761D]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg",children:e.jsx(rt,{className:"text-[#0b3856]",size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Property Matching"}),e.jsxs("p",{className:"text-white text-xs",children:["Find perfect properties for ",Y]})]})]}),e.jsx("button",{onClick:a,className:"p-1.5 rounded-lg bg-white hover:bg-gray-50 shadow","aria-label":"Close",children:e.jsx(ns,{size:18})})]})}),e.jsxs("div",{className:"p-4 max-h-[calc(90vh-120px)] overflow-y-auto",children:[e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 mb-4",children:[e.jsx("h3",{className:"font-semibold text-purple-900 mb-2 text-xs",children:"BUYER REQUIREMENTS"}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Budget:"}),e.jsxs("span",{className:"font-bold text-purple-900 ml-1",children:[yn(K)," - ",yn(q)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Unit Types:"}),e.jsx("span",{className:"font-bold text-purple-900 ml-1",children:ne})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Locations:"}),e.jsx("span",{className:"font-bold text-purple-900 ml-1",children:le})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Lead Score:"}),e.jsxs("span",{className:"font-bold text-purple-900 ml-1",children:[S,"/100"]})]})]})]}),e.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search by property name, location, type or status...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",value:i,onChange:C=>n(C.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-1",children:[e.jsx("span",{className:"font-medium text-gray-700 text-xs",children:"Filter:"}),[{id:"all",label:"All"},{id:"budget_match",label:"Budget Match"},{id:"high_match",label:"High Match"},{id:"investment",label:"Best Investment"}].map(C=>e.jsx("button",{onClick:()=>b(C.id),className:`px-2 py-1 rounded-full font-medium transition-colors text-xs ${g===C.id?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:C.label},C.id))]})]}),(w||c)&&e.jsxs("div",{className:"text-center py-8 text-xs text-gray-600",children:["Loading properties",c?" & tags":"","â€¦"]}),$&&!w&&e.jsx("div",{className:"text-center py-8 text-xs text-red-600",children:$}),p&&!c&&e.jsx("div",{className:"text-center py-4 text-xs text-amber-700",children:p}),!w&&!$&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[V.map(C=>{var J,ue,Q,he,se,ge;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:o.includes(C.id),onChange:()=>W(C.id),className:"mt-1 rounded border-gray-300 text-purple-600 focus:ring-purple-500","aria-label":`Select ${C.title}`}),e.jsx("img",{src:C.images[0],alt:C.title,className:"w-24 h-20 object-cover rounded-lg flex-shrink-0",onError:ee=>{ee.currentTarget.style.visibility="hidden"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h4",{className:"font-bold text-gray-900 truncate",children:C.title}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 ring-1 ring-gray-200 text-[10px]",children:[e.jsx(Jn,{size:10}),C.propertyCode]}),e.jsx(_f,{status:C.status})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mt-0.5",children:[e.jsx(Qs,{size:12}),e.jsx("span",{className:"truncate",children:C.address||"â€”"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1 flex-wrap gap-1",children:[e.jsxs("div",{className:`px-2 py-0.5 rounded-full border ${ff(C.matchScore)}`,children:[C.matchScore,"% Match"]}),yf(C.investmentPotential),e.jsxs("div",{className:"flex items-center space-x-0.5",children:[Array.from({length:5},(ee,de)=>{const U=de<Math.round(Math.min(5,Math.max(0,C.rating)));return e.jsx(Xs,{size:10,className:U?"text-yellow-400 fill-current":"text-gray-300"},de)}),e.jsxs("span",{className:"text-gray-600 ml-0.5",children:["(",C.rating,")"]})]})]}),!!((J=C.tags)!=null&&J.length)&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:C.tags.map((ee,de)=>e.jsx(Af,{tag:ee},`${ee}-${de}`))})]}),e.jsxs("div",{className:"text-right flex-shrink-0 pl-2",children:[e.jsx("div",{className:"font-bold text-green-600",children:yn(C.price)}),e.jsxs("div",{className:"text-gray-500",children:[C.area||0," sq ft"]}),e.jsx("div",{className:"text-gray-500 mt-0.5",children:C.perSqft>0?`â‚¹${C.perSqft.toLocaleString()}/sq ft`:"â€”"})]})]}),((ue=C.aiReasons)==null?void 0:ue.length)>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h5",{className:"font-medium text-gray-900 mb-1 flex items-center",children:[e.jsx(Mt,{className:"mr-1 text-blue-600",size:12}),"Why AI recommends:"]}),e.jsxs("div",{className:"space-y-0.5",children:[C.aiReasons.slice(0,2).map((ee,de)=>e.jsxs("div",{className:"flex items-start space-x-1",children:[e.jsx(bs,{className:"text-green-500 mt-0.5 flex-shrink-0",size:10}),e.jsx("span",{className:"text-gray-700",children:ee})]},de)),C.aiReasons.length>2&&e.jsxs("div",{className:"text-blue-600 cursor-pointer hover:underline",children:["+",C.aiReasons.length-2," more reasons"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-green-50 rounded p-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Rs,{className:"text-green-600",size:10}),e.jsx("span",{className:"font-medium text-green-800",children:"Price Trend"})]}),e.jsx("div",{className:"font-bold text-green-900",children:C.priceHistory.change}),e.jsx("div",{className:"text-green-700",children:C.priceHistory.period})]}),e.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(lo,{className:"text-blue-600",size:10}),e.jsx("span",{className:"font-medium text-blue-800",children:"Rental Yield"})]}),e.jsx("div",{className:"font-bold text-blue-900",children:C.rentalYield}),e.jsx("div",{className:"text-blue-700",children:"per annum"})]}),e.jsxs("div",{className:"bg-purple-50 rounded p-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ct,{className:"text-purple-600",size:10}),e.jsx("span",{className:"font-medium text-purple-800",children:"Appreciation"})]}),e.jsx("div",{className:"font-bold text-purple-900",children:C.appreciationRate}),e.jsx("div",{className:"text-purple-700",children:"expected"})]})]}),C.assignedTo&&e.jsx("div",{className:"mb-3 p-2 bg-gray-50 rounded",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"font-medium text-gray-900 truncate",children:["Executive: ",((Q=C.assignedTo)==null?void 0:Q.name)||"â€”"]}),e.jsx("div",{className:"text-gray-600 truncate",children:((he=C.assignedTo)==null?void 0:he.email)||"â€”"}),e.jsx("div",{className:"text-gray-600",children:((se=C.assignedTo)==null?void 0:se.phone)||"â€”"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:((ge=C.assignedTo)==null?void 0:ge.phone)&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>L(C),className:"flex items-center space-x-1 px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors text-xs",children:[e.jsx(tt,{size:10}),e.jsx("span",{children:"WhatsApp"})]}),e.jsxs("button",{onClick:()=>D(C),className:"flex items-center space-x-1 px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors text-xs",children:[e.jsx(Cs,{size:10}),e.jsx("span",{children:"Call"})]})]})})]})}),e.jsxs("div",{className:"flex items-center space-x-1 flex-wrap gap-1",children:[e.jsxs("button",{onClick:()=>B(C),className:"flex items-center space-x-1 px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs",disabled:C.status==="sold",title:C.status==="sold"?"This property is sold":"Schedule a visit",children:[e.jsx(Ts,{size:12}),e.jsx("span",{children:"Visit"})]}),e.jsxs("button",{onClick:()=>M(C),className:"flex items-center space-x-1 px-2 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors text-xs",disabled:C.status==="sold",title:C.status==="sold"?"This property is sold":"Add to shortlist",children:[e.jsx(Ra,{size:12}),e.jsx("span",{children:"Shortlist"})]}),e.jsxs("button",{onClick:()=>A(C),className:"flex items-center space-x-1 px-2 py-1 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs",children:[e.jsx(ja,{size:12}),e.jsx("span",{children:"Info"})]}),e.jsxs("a",{href:C.publicUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors text-xs",onClick:ee=>{ee.preventDefault(),I(C)},children:[e.jsx(Kn,{size:12}),e.jsx("span",{children:"Website"})]}),e.jsxs("button",{onClick:()=>H(C),className:"flex items-center space-x-1 px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors text-xs",children:[e.jsx(ja,{size:12}),e.jsx("span",{children:"Share"})]})]})]})]})})},C.id)}),V.length===0&&!w&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Is,{className:"mx-auto text-gray-300 mb-3",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"No matching properties found"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Adjust the search or filters to see more results."})]})]}),V.length>0&&e.jsxs("div",{className:"mt-6 bg-blue-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-blue-900 mb-2 flex items-center",children:[e.jsx(Mt,{className:"mr-1",size:16}),"AI Insights"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Market Recommendation"}),e.jsx("p",{className:"text-gray-700 text-xs",children:"Top localities in your preferences show healthy demand with stable pricing."})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Timing Advice"}),e.jsx("p",{className:"text-gray-700 text-xs",children:"Conditions are favorable for buyersâ€”shortlist and schedule site visits soon."})]})]})]})]})]}),e.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[V.length," properties found â€¢ ",o.length," selected"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:a,className:"px-3 py-1.5 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 text-xs",children:"Close"}),o.length>0&&e.jsxs("button",{onClick:h,className:"flex items-center gap-1 px-4 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-xs",children:[e.jsx(ja,{size:14}),e.jsx("span",{children:"Send to Buyer"})]})]})]})})]}),d&&e.jsx(xn,{onClose:()=>v(null),propertyId:d.propertyId,slug:String(d.slug||""),title:d.title,description:d.description,image:d.image,url:d.url,trackingToken:void 0,absoluteBase:void 0})]})},zn=(s,a=0)=>{const t=typeof s=="string"?parseFloat(s):Number(s);return Number.isFinite(t)?t:a},ul=s=>{if(Array.isArray(s))return s.map(String).filter(Boolean);if(typeof s=="string"){const a=s.trim();if(!a)return[];if(a.startsWith("[")&&a.endsWith("]"))try{const t=JSON.parse(a);return Array.isArray(t)?t.map(String).filter(Boolean):[]}catch{return[]}return a.split(",").map(t=>t.trim()).filter(Boolean)}return[]},Ro=s=>(s??"").toString().replace(/\s+/g," ").trim().replace(/\b(bhk)\b/gi,"BHK").replace(/\b\w/g,a=>a.toUpperCase()),Tf=s=>s.map(a=>(a??"").toString().trim()).filter(Boolean).join(" "),el=s=>Number.isFinite(s)?s>=1e7?`â‚¹${(s/1e7).toFixed(1)}Cr`:s>=1e5?`â‚¹${(s/1e5).toFixed(1)}L`:`â‚¹${s.toLocaleString("en-IN")}`:"â‚¹0",If=s=>s>=90?"text-green-600 bg-green-100 border-green-200":s>=80?"text-blue-600 bg-blue-100 border-blue-200":s>=70?"text-orange-600 bg-orange-100 border-orange-200":"text-red-600 bg-red-100 border-red-200",$f=s=>{const a={very_high:{bg:"bg-green-100",text:"text-green-700",label:"Very High",icon:"ðŸš€"},high:{bg:"bg-blue-100",text:"text-blue-700",label:"High",icon:"ðŸ“ˆ"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium",icon:"ðŸ“Š"},low:{bg:"bg-gray-100",text:"text-gray-700",label:"Low",icon:"ðŸ“‰"}},t=a[s]??a.medium;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs ${t.bg} ${t.text}`,children:[t.icon," ",t.label]})},Ef=s=>{if(Array.isArray(s))return s;if(typeof s=="string"){const a=s.trim();if(!a)return[];if(a.startsWith("[")&&a.endsWith("]"))try{return JSON.parse(a)}catch{return[]}return a.split(",").map(t=>t.trim()).filter(Boolean)}return[]},Mf=s=>(s==null?void 0:s.property_id)??(s==null?void 0:s.id)??(s==null?void 0:s._id)??(s==null?void 0:s.uuid)??(s==null?void 0:s.slug)??null,Lf=(s,a)=>{const t=(a==null?void 0:a.website)||(a==null?void 0:a.url)||s.website||s.url;if(t&&/^https?:\/\//i.test(String(t)))return String(t);const i=typeof window<"u"?window.location.origin:"https://investordeal.in";return s.slug?`${i}/properties/${String(s.slug).replace(/^\//,"")}`:`${i}/properties/${s.id}`},Df=s=>{if(!s)return"";const a=String(s).replace(/\D/g,"");return a?a.startsWith("91")?a:a.length===10?`91${a}`:a:""},Cc=(s,a,t)=>s>=a&&s<=t,Rf=s=>s!=null?`REX00${String(s)}`:"REX00â€”";function zf(s){const a=(s==null?void 0:s.is_sold)??(s==null?void 0:s.sold)??(s==null?void 0:s.isSold);if(typeof a=="boolean")return a?"sold":"available";if(typeof a=="number")return a===1?"sold":"available";const t=(s==null?void 0:s.available)??(s==null?void 0:s.is_available)??(s==null?void 0:s.isAvailable);if(typeof t=="boolean")return t?"available":"sold";if(typeof t=="number")return t===1?"available":"sold";const r=(s==null?void 0:s.availability_status)??(s==null?void 0:s.listing_status)??(s==null?void 0:s.status)??(s==null?void 0:s.availability)??(s==null?void 0:s.property_status),i=String(r??"").trim().toLowerCase();return["sold","booked","unavailable","not available","closed"].includes(i)?"sold":(["available","active","listed","open","public"].includes(i),"available")}const Ff=({status:s})=>{const a=s==="available",t=a?"bg-green-100 text-green-700 ring-1 ring-green-200":"bg-red-100 text-red-700 ring-1 ring-red-200",r=a?bs:Ta;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] ${t}`,children:[e.jsx(r,{size:10}),a?"Available":"Sold"]})},Bf=s=>{var m,g;if(!s)return null;const a=typeof s.requirements=="string"?(()=>{try{return JSON.parse(s.requirements)}catch{return{}}})():s.requirements||{},t=ul(a.preferredLocations).length?ul(a.preferredLocations):ul(a.preferredlocations),r=a.unitType!==void 0&&a.unitType!==null?a.unitType:ul(a.unitTypes).length?ul(a.unitTypes):void 0,i=a.city||s.city?String(a.city||s.city):void 0,n=zn(((m=s==null?void 0:s.budget)==null?void 0:m.min)??(s==null?void 0:s.budget_min)??0),o=zn(((g=s==null?void 0:s.budget)==null?void 0:g.max)??(s==null?void 0:s.budget_max)??0);return{name:String(s.name||"Buyer"),leadScore:zn(s.leadScore??s.buyer_lead_score??s.lead_score??70),budget:{min:n,max:o},requirements:{unitType:r,preferredLocations:t,city:i},city:i}};function zo(s){const a=String(s||"").replace(/\s+/g," ").toLowerCase().match(/(\d+)\s*(bhk|bed|bedroom)?/i);return a?a[1]:""}function Of(s,a){var P,w,$;const t=s.budget??0;if(!Cc(t,a.budget.min,a.budget.max))return 0;const i=55,n=25,o=15,m=5;let g=0;const b=(a.budget.min+a.budget.max)/2,d=Math.max(1,(a.budget.max-a.budget.min)/2),v=Math.abs(t-b),x=Math.max(0,1-v/d);g+=Math.round(i*x);let u=0;if((P=a.requirements.preferredLocations)!=null&&P.length){const y=(s.location||"").toLowerCase();u=a.requirements.preferredLocations.some(R=>y.includes(String(R||"").toLowerCase()))?n:0}else u=Math.round(n*.5);g+=u;let c=0;if(a.requirements.unitType){const y=Array.isArray(a.requirements.unitType)?a.requirements.unitType.map(zo):[zo(String(a.requirements.unitType))],k=zo(String(s.unitType||"")),R=y.some(T=>T&&T===k),F=!R&&y.some(T=>T&&(s.unitType||"").toLowerCase().includes(T));c=R?o:F?Math.round(o*.6):0}else c=Math.round(o*.5);g+=c;const f=(((w=s.photos)==null?void 0:w.length)||0)>0,p=((($=s.amenities)==null?void 0:$.length)||0)>0,N=(Number(f)+Number(p))/2;return g+=Math.round(m*N),Math.max(0,Math.min(100,g))}function Qu(s){const a=s.budget??0;return a>=25e6?"very_high":a>=18e6?"high":a>=12e6?"medium":"low"}function Uf(s){switch(Qu(s)){case"very_high":return"2.8%";case"high":return"3.2%";case"medium":return"4.1%";default:return"3.5%"}}const qf=({tag:s})=>{const a=Ea(s),t=typeof a.emoji=="string",r=!t&&a.emoji?a.emoji:null;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] ring-1 ${a.bg} ${a.text} ${a.ring}`,title:s,children:[r?e.jsx(r,{size:10}):t?e.jsx("span",{children:a.emoji}):null,e.jsx("span",{className:"capitalize",children:s})]})},Vf=s=>{const{propertyType:a,unitType:t,propertySubtype:r,fallback:i}=s,n=Array.isArray(r)?r.filter(Boolean).join(" / "):r,o=[Ro(a),Ro(t),Ro(n)];return Tf(o).trim()||(i?String(i):"Untitled Property")},Zu=({isOpen:s,onClose:a,buyer:t,searchParams:r})=>{const i=l.useMemo(()=>Bf(t),[t]),[n,o]=l.useState(!1),[m,g]=l.useState(null),[b,d]=l.useState([]),[v,x]=l.useState([]),[u,c]=l.useState("all"),[f,p]=l.useState({}),[N,P]=l.useState(!1),[w,$]=l.useState(null),y=l.useRef(null);l.useEffect(()=>{if(!s||!i||typeof document>"u")return;y.current=document.title;const H=el(i.budget.min),h=el(i.budget.max),Y=Array.isArray(i.requirements.unitType)?i.requirements.unitType.join(", "):i.requirements.unitType||"Any",K=i.requirements.preferredLocations.length?i.requirements.preferredLocations.join(", "):i.requirements.city||i.city||"Any",q=["AI Property Suggestions",Y?String(Y):"",K?`in ${K}`:"",`â€” ${H}â€“${h}`,"| Resale Expert"].filter(Boolean).join(" ");return document.title=q,()=>{y.current!==null&&(document.title=y.current)}},[s,i]),l.useEffect(()=>{if(!s||!i)return;let H=!0;(async()=>{var Y,K,q;o(!0),g(null);try{let ne=[];try{if(r){const J=await As.searchProperties({...r});ne=Array.isArray(J==null?void 0:J.data)?J.data:Array.isArray(J)?J:[]}else{const J=await((Y=As.getProperties)==null?void 0:Y.call(As,{limit:200}));ne=Array.isArray(J==null?void 0:J.data)?J.data:Array.isArray(J)?J:[]}}catch{const J=await((K=As.PublicgetProperties)==null?void 0:K.call(As,{limit:200}));ne=Array.isArray(J==null?void 0:J.data)?J.data:Array.isArray(J)?J:[]}const S=((ne||[]).filter(J=>{const ue=J==null?void 0:J.is_public;return ue===1||ue==="1"||ue===!0})||[]).map(J=>{const ue=Mf(J);if(ue==null)return null;const Q=(()=>{const G=Ef((J==null?void 0:J.photos)??(J==null?void 0:J.images)??(J==null?void 0:J.media));return G.length&&typeof G[0]=="object"?G.map(me=>(me==null?void 0:me.url)??(me==null?void 0:me.src)??"").filter(Boolean):G})(),he=J.property_type_name||J.property_type||"",se=J.unit_type||J.bhk_label||J.configuration||"",ge=J.property_subtype_name||J.property_subtype||"",ee=ul(ge),de=ee.length>0?ee:ge?[String(ge)]:[],U=J.title||J.project_name||J.name||J.property_name||J.society_name,X=Vf({propertyType:he?String(he):void 0,unitType:se?String(se):void 0,propertySubtype:de,fallback:U}),re=J.assignedTo||(J.executive_name||J.executive_email||J.executive_phone?{name:J.executive_name||null,email:J.executive_email||null,phone:J.executive_phone||null}:null),fe=zf(J);return{id:ue,title:X,propertyType:he?String(he):void 0,unitType:se?String(se):void 0,propertySubtype:de,slug:J.slug,photos:Q,city:J.city_name||J.city||J.cityNormalized,location:J.location_name||J.location||J.locationNormalized||J.locality,address:J.address||J.full_address,budget:zn(J.budget??J.final_price??J.price??J.expected_price??0),carpet_area:zn(J.carpet_area??J.carpetArea??J.area??0),amenities:Array.isArray(J.amenities)?J.amenities:ul(J.amenities),website:J.website||J.url,url:J.url,assignedTo:re,is_public:J.is_public,status:fe}}).filter(Boolean);let C={};try{const J=await((q=Qt.getAll)==null?void 0:q.call(Qt));C=(Array.isArray(J)?J:[]).reduce((ue,Q)=>{const he=String(Q.property_id??Q.id??"");if(!he)return ue;const se=Array.isArray(Q.tags)?Q.tags:typeof Q.tags=="string"?Q.tags.split(",").map(ge=>ge.trim()).filter(Boolean):[];return se.length&&(ue[he]=se),ue},{})}catch{const J=Array.from(new Set(S.map(Q=>String(Q.id))));C=(await Promise.allSettled(J.map(async Q=>{var he;try{const se=await((he=Qt.getById)==null?void 0:he.call(Qt,Q)),ge=Array.isArray(se==null?void 0:se.tags)?se.tags:typeof(se==null?void 0:se.tags)=="string"?se.tags.split(",").map(ee=>ee.trim()).filter(Boolean):[];return{id:Q,tags:ge}}catch{return{id:Q,tags:[]}}}))).reduce((Q,he)=>(he.status==="fulfilled"&&he.value&&(Q[he.value.id]=he.value.tags||[]),Q),{})}H&&(d(S),p(C))}catch(ne){g((ne==null?void 0:ne.message)||"Failed to load suggestions")}finally{o(!1)}})()},[s,i,JSON.stringify(r??null)]);const k=l.useMemo(()=>i?b.map(H=>{var Q,he,se;const h=Of(H,i),Y=Qu(H),K=Uf(H),q=H.carpet_area&&H.carpet_area>0?Math.max(0,Math.round((H.budget||0)/H.carpet_area)):0,ne=[{name:`${H.location||H.city||"Local"} Metro`,distance:"0.8 km",type:"transport"},{name:"Mall / High Street",distance:"1.5 km",type:"shopping"},{name:"Hospital",distance:"2.0 km",type:"healthcare"}],le=[];if(H.budget&&i&&Cc(H.budget,i.budget.min,i.budget.max)&&le.push("Perfect budget match within your range"),H.location&&((Q=i.requirements.preferredLocations)!=null&&Q.some(ge=>(H.location||"").toLowerCase().includes(String(ge).toLowerCase())))&&le.push("Located in your preferred area"),H.unitType&&i.requirements.unitType){const ge=i.requirements.unitType;(Array.isArray(ge)?ge.some(de=>String(H.unitType).toLowerCase().includes(String(de).toLowerCase())):String(H.unitType).toLowerCase().includes(String(ge).toLowerCase()))&&le.push("Matches your preferred configuration")}(he=H.amenities)!=null&&he.length&&le.push("Has your required amenities");const S=((se=H.photos)==null?void 0:se[0])||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800",C=H.raw||H,J=Lf(H,C),ue=Array.isArray(H.propertySubtype)?H.propertySubtype.join(" / "):H.propertySubtype||"";return{id:String(H.id),propertyCode:Rf(H.id),title:H.title,propertyType:H.propertyType||"",unitType:H.unitType||"",propertySubtype:ue,address:(H.address||`${H.location||""}${H.city?", "+H.city:""}`||"").trim(),price:H.budget||0,area:H.carpet_area||0,perSqft:q,matchScore:h,aiReasons:le,highlights:["Good connectivity","Growth potential","Amenities"],rating:4.7,images:[S],amenities:H.amenities||[],nearbyPlaces:ne,priceHistory:{trend:"up",change:"+3.5%",period:"6 months"},investmentPotential:Y,rentalYield:K,appreciationRate:Y==="very_high"?"10-15%":Y==="high"?"8-12%":"6-9%",raw:H,tags:f[String(H.id)]||[],assignedTo:H.assignedTo||null,publicUrl:J,slug:H.slug,propertyId:H.id,shareImage:S,status:H.status}}):[],[b,i,f]),R=l.useMemo(()=>{if(!i)return[];const H=K=>Cc(K.price||0,i.budget.min,i.budget.max),h=k.filter(H);return(()=>{switch(u){case"budget_match":return h;case"high_match":return h.filter(K=>K.matchScore>=85);case"investment":return h.filter(K=>K.investmentPotential==="high"||K.investmentPotential==="very_high");case"all":default:return h}})().sort((K,q)=>q.matchScore-K.matchScore||(K.price||0)-(q.price||0))},[k,u,i]),F=H=>{x(h=>h.includes(H)?h.filter(Y=>Y!==H):[...h,H])},T=H=>{alert(`Visit scheduled for ${H.title}. You will receive confirmation shortly.`)},j=H=>{alert(`${H.title} added to your shortlist!`)},E=H=>{alert(`More information requested for ${H.title}. Executive will be notified.`)},V=H=>{var q,ne;const h=((q=H.assignedTo)==null?void 0:q.phone)||"",Y=Df(h);if(!Y)return alert("Executive phone not available.");const K=`Hi ${((ne=H.assignedTo)==null?void 0:ne.name)||"there"}, I'm interested in "${H.title}". My budget is ${el((i==null?void 0:i.budget.min)??0)} - ${el((i==null?void 0:i.budget.max)??0)}. Can we schedule a visit?`;typeof window<"u"&&window.open(`https://wa.me/${Y}?text=${encodeURIComponent(K)}`,"_blank","noopener,noreferrer")},W=H=>{$({title:H.title,description:H.address||"",image:H.shareImage,url:H.publicUrl,slug:H.slug,propertyId:H.propertyId}),P(!0)};if(!s||!i)return null;const B=i.name||"Buyer",M=i.budget.min,A=i.budget.max,L=Array.isArray(i.requirements.unitType)?i.requirements.unitType.join(", "):i.requirements.unitType||"Any",D=i.requirements.preferredLocations.length?i.requirements.preferredLocations.join(", "):i.requirements.city||i.city||"Any",I=i.leadScore??70;return e.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[95vh] overflow-hidden text-xs",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(rt,{className:"text-purple-600",size:18})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-gray-900",children:"AI Property Suggestions"}),e.jsxs("p",{className:"text-gray-600 mt-0.5",children:["Personalized recommendations for ",B]})]})]}),e.jsx("button",{onClick:a,className:"p-1.5 rounded-lg bg-white hover:bg-gray-50 transition-colors shadow-md","aria-label":"Close",children:e.jsx(ns,{size:16})})]})}),e.jsxs("div",{className:"p-4 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-purple-900",children:"Buyer Profile"}),e.jsxs("div",{className:"text-xs text-purple-800",children:["Lead Score: ",e.jsxs("span",{className:"font-bold",children:[I,"/100"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Budget:"}),e.jsxs("span",{className:"font-bold text-purple-900 ml-1",children:[el(M)," - ",el(A)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"Preferred Units:"}),e.jsx("span",{className:"font-bold text-purple-900 ml-1",children:L})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1",children:[e.jsx("span",{className:"text-purple-600",children:"Preferred Areas:"}),e.jsx("span",{className:"font-bold text-purple-900 ml-1 truncate inline-block max-w-[12rem]",title:D,children:D})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-600",children:"City:"}),e.jsx("span",{className:"font-bold text-purple-900 ml-1",children:i.requirements.city||i.city||"Any"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4 flex-wrap gap-1",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Filter by:"}),[{id:"all",label:"All"},{id:"budget_match",label:"Budget Match"},{id:"high_match",label:"High Match"},{id:"investment",label:"Best Investment"}].map(H=>e.jsx("button",{onClick:()=>c(H.id),className:`px-2 py-1 rounded-full font-medium transition-colors ${u===H.id?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:H.label},H.id))]}),n&&e.jsx("div",{className:"text-center text-gray-600 py-6",children:"Loading suggestionsâ€¦"}),m&&!n&&e.jsx("div",{className:"text-center text-red-600 py-6",children:m}),!n&&!m&&e.jsxs("div",{className:"space-y-4",children:[R.map(H=>{var h,Y,K,q,ne,le;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-all",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:v.includes(H.id),onChange:()=>F(H.id),className:"mt-1 rounded border-gray-300 text-purple-600 focus:ring-purple-500","aria-label":`Select ${H.title}`}),e.jsx("img",{src:H.images[0],alt:H.title,className:"w-24 h-20 object-cover rounded-lg flex-shrink-0",onError:S=>{S.currentTarget.style.visibility="hidden"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h4",{className:"font-bold text-gray-900 truncate",children:H.title}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 ring-1 ring-gray-200 text-[10px]",children:[e.jsx(Jn,{size:10}),H.propertyCode]}),e.jsx(Ff,{status:H.status})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mt-0.5",children:[e.jsx(Qs,{size:12}),e.jsx("span",{className:"truncate",children:H.address||"â€”"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1 flex-wrap gap-1",children:[e.jsxs("div",{className:`px-2 py-0.5 rounded-full border ${If(H.matchScore)}`,children:[H.matchScore,"% Match"]}),$f(H.investmentPotential),e.jsxs("div",{className:"flex items-center space-x-0.5",children:[Array.from({length:5},(S,C)=>{const J=C<Math.round(Math.min(5,Math.max(0,H.rating)));return e.jsx(Xs,{size:10,className:J?"text-yellow-400 fill-current":"text-gray-300"},C)}),e.jsxs("span",{className:"text-gray-600 ml-0.5",children:["(",H.rating,")"]})]})]}),!!((h=H.tags)!=null&&h.length)&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:H.tags.map((S,C)=>e.jsx(qf,{tag:S},`${S}-${C}`))})]}),e.jsxs("div",{className:"text-right flex-shrink-0 pl-2",children:[e.jsx("div",{className:"font-bold text-green-600",children:el(H.price)}),e.jsxs("div",{className:"text-gray-500",children:[H.area||0," sq ft"]}),e.jsx("div",{className:"text-gray-500 mt-0.5",children:H.perSqft>0?`â‚¹${H.perSqft.toLocaleString()}/sq ft`:"â€”"})]})]}),((Y=H.aiReasons)==null?void 0:Y.length)>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h5",{className:"font-medium text-gray-900 mb-1 flex items-center",children:[e.jsx(Mt,{className:"mr-1 text-blue-600",size:12}),"Why AI recommends:"]}),e.jsxs("div",{className:"space-y-0.5",children:[H.aiReasons.slice(0,2).map((S,C)=>e.jsxs("div",{className:"flex items-start space-x-1",children:[e.jsx(bs,{className:"text-green-500 mt-0.5 flex-shrink-0",size:10}),e.jsx("span",{className:"text-gray-700",children:S})]},C)),H.aiReasons.length>2&&e.jsxs("div",{className:"text-blue-600 cursor-pointer hover:underline",children:["+",H.aiReasons.length-2," more reasons"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-green-50 rounded p-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Rs,{className:"text-green-600",size:10}),e.jsx("span",{className:"font-medium text-green-800",children:"Price Trend"})]}),e.jsx("div",{className:"font-bold text-green-900",children:H.priceHistory.change}),e.jsx("div",{className:"text-green-700",children:H.priceHistory.period})]}),e.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(lo,{className:"text-blue-600",size:10}),e.jsx("span",{className:"font-medium text-blue-800",children:"Rental Yield"})]}),e.jsx("div",{className:"font-bold text-blue-900",children:H.rentalYield}),e.jsx("div",{className:"text-blue-700",children:"per annum"})]}),e.jsxs("div",{className:"bg-purple-50 rounded p-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ct,{className:"text-purple-600",size:10}),e.jsx("span",{className:"font-medium text-purple-800",children:"Appreciation"})]}),e.jsx("div",{className:"font-bold text-purple-900",children:H.appreciationRate}),e.jsx("div",{className:"text-purple-700",children:"expected"})]})]}),e.jsx("div",{className:"mb-3 p-2 bg-gray-50 rounded",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"font-medium text-gray-900 truncate",children:["Executive: ",((K=H==null?void 0:H.assignedTo)==null?void 0:K.name)||"â€”"]}),e.jsx("div",{className:"text-gray-600 truncate",children:((q=H==null?void 0:H.assignedTo)==null?void 0:q.email)||"â€”"}),e.jsx("div",{className:"text-gray-600",children:((ne=H==null?void 0:H.assignedTo)==null?void 0:ne.phone)||"â€”"})]}),e.jsxs("div",{className:"flex items-center space-x-0.5",children:[e.jsx(Xs,{className:"text-yellow-400 fill-current",size:10}),e.jsx("span",{className:"font-medium",children:H.rating})]})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"font-medium text-gray-700 mb-1",children:"Nearby Places"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:H.nearbyPlaces.slice(0,3).map((S,C)=>e.jsxs("div",{className:"bg-gray-50 p-1 rounded",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:S.name}),e.jsxs("div",{className:"text-gray-600",children:[S.distance," â€¢ ",S.type]})]},C))})]}),e.jsxs("div",{className:"flex items-center space-x-1 flex-wrap gap-1",children:[e.jsxs("button",{onClick:()=>T(H),className:"flex items-center space-x-1 px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",disabled:H.status==="sold",title:H.status==="sold"?"This property is sold":"Schedule a visit",children:[e.jsx(Ts,{size:12}),e.jsx("span",{children:"Visit"})]}),e.jsxs("button",{onClick:()=>j(H),className:"flex items-center space-x-1 px-2 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",disabled:H.status==="sold",title:H.status==="sold"?"This property is sold":"Add to shortlist",children:[e.jsx(Ra,{size:12}),e.jsx("span",{children:"Shortlist"})]}),e.jsxs("button",{onClick:()=>E(H),className:"flex items-center space-x-1 px-2 py-1 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors",children:[e.jsx(Wt,{size:12}),e.jsx("span",{children:"Info"})]}),((le=H==null?void 0:H.assignedTo)==null?void 0:le.phone)&&e.jsxs("button",{onClick:()=>V(H),className:"flex items-center space-x-1 px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:[e.jsx(tt,{size:12}),e.jsx("span",{children:"WhatsApp"})]}),e.jsxs("a",{href:H.publicUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[e.jsx(Kn,{size:12}),e.jsx("span",{children:"Visit Website"})]}),e.jsxs("button",{onClick:()=>W(H),className:"flex items-center space-x-1 px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:[e.jsx(Wt,{size:12}),e.jsx("span",{children:"Share"})]})]})]})]})})},H.id)}),!R.length&&e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No suggestions match your budget and filters."})]}),!n&&!m&&e.jsxs("div",{className:"mt-6 bg-blue-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-blue-900 mb-2 flex items-center",children:[e.jsx(Mt,{className:"mr-1",size:16}),"AI Insights"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Market Recommendation"}),e.jsx("p",{className:"text-gray-700",children:"Top localities in your preferences show healthy demand with stable pricing."})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Timing Advice"}),e.jsx("p",{className:"text-gray-700",children:"Conditions are favorable for buyersâ€”shortlist and schedule site visits soon."})]})]})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-gray-500",children:[R.length," properties â€¢ ",v.length," selected"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:a,className:"px-3 py-1 text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition-colors",children:"Close"}),v.length>0&&e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:[e.jsx(Ra,{size:14}),e.jsxs("span",{children:["Save ",v.length]})]})]})]})})]}),N&&w&&e.jsx(xn,{onClose:()=>P(!1),url:w.url,propertyId:w.propertyId,slug:String(w.slug||""),trackingToken:void 0,absoluteBase:void 0,title:w.title,description:w.description,image:w.image})]})},Xu=({isOpen:s,onClose:a,buyer:t,onUpdateBuyer:r})=>{var R,F,T,j;const[i,n]=l.useState(1),[o,m]=l.useState({applicantName:t.name,applicantPhone:t.phone,applicantEmail:t.email,dateOfBirth:"",panNumber:"",aadharNumber:"",maritalStatus:"single",hasCoApplicant:!1,coApplicantName:"",coApplicantPhone:"",coApplicantEmail:"",coApplicantDOB:"",coApplicantPAN:"",coApplicantRelation:"spouse",employmentType:"salaried",companyName:"",designation:"",workExperience:"",monthlyIncome:((R=t.financials)==null?void 0:R.monthlyIncome)||0,otherIncome:0,coApplicantEmploymentType:"salaried",coApplicantCompany:"",coApplicantIncome:0,loanAmount:((F=t.financials)==null?void 0:F.loanAmount)||0,loanTenure:240,propertyValue:t.budget.max,downPayment:((T=t.financials)==null?void 0:T.downPayment)||0,loanPurpose:"home_purchase",preferredBank:((j=t.financials)==null?void 0:j.bankPreference)||"HDFC Bank",propertyType:t.requirements.propertyType,propertyLocation:t.requirements.preferredLocations[0]||t.location,propertyStatus:t.requirements.possession,existingLoans:[],creditCards:[],investments:[],documents:{salarySlips:!1,bankStatements:!1,itr:!1,formSixteen:!1,panCard:!1,aadharCard:!1,propertyDocuments:!1}}),[g,b]=l.useState(!1);if(!s)return null;const d=[{id:1,label:"Personal Info",icon:Ms},{id:2,label:"Employment",icon:Is},{id:3,label:"Loan Details",icon:Ut},{id:4,label:"Documents",icon:ws},{id:5,label:"Review",icon:bs}],v=[{name:"HDFC Bank",rate:8.5,processing:.5,features:["Quick approval","Digital process","Flexible tenure"]},{name:"ICICI Bank",rate:8.7,processing:.5,features:["Pre-approved offers","Online tracking","Doorstep service"]},{name:"SBI",rate:8.4,processing:.25,features:["Lowest rates","Government backing","Wide network"]},{name:"Axis Bank",rate:8.8,processing:.5,features:["Quick disbursal","Flexible EMI","Premium service"]},{name:"Kotak Bank",rate:8.6,processing:.5,features:["Digital experience","Quick approval","Relationship benefits"]}],x=[{value:"salaried",label:"Salaried"},{value:"self_employed",label:"Self Employed"},{value:"business",label:"Business Owner"},{value:"professional",label:"Professional"}],u=[{value:"single",label:"Single"},{value:"married",label:"Married"},{value:"divorced",label:"Divorced"},{value:"widowed",label:"Widowed"}],c=[{value:"spouse",label:"Spouse"},{value:"father",label:"Father"},{value:"mother",label:"Mother"},{value:"son",label:"Son"},{value:"daughter",label:"Daughter"},{value:"brother",label:"Brother"},{value:"sister",label:"Sister"}],f=(E,V,W)=>{const B=V/1200,M=E*B*Math.pow(1+B,W)/(Math.pow(1+B,W)-1);return Math.round(M)},N=(()=>{const V=(o.monthlyIncome+(o.hasCoApplicant?o.coApplicantIncome:0))*.6,W=v.find(L=>L.name===o.preferredBank),B=(W==null?void 0:W.rate)||8.5,M=B/1200,A=V*(Math.pow(1+M,o.loanTenure)-1)/(M*Math.pow(1+M,o.loanTenure));return{maxLoanAmount:Math.round(A),maxEMI:Math.round(V),currentEMI:f(o.loanAmount,B,o.loanTenure),eligibilityRatio:o.loanAmount/A*100}})(),P=(E,V)=>{if(E.includes(".")){const[W,B]=E.split(".");m(M=>({...M,[W]:{...M[W],[B]:V}}))}else m(W=>({...W,[E]:V}))},w=()=>{n(E=>Math.min(E+1,d.length))},$=()=>{n(E=>Math.max(E-1,1))},y=async()=>{b(!0);try{await new Promise(V=>setTimeout(V,2e3));const E={...t,financials:{...t.financials,loanRequired:!0,loanAmount:o.loanAmount,downPayment:o.downPayment,monthlyIncome:o.monthlyIncome,bankPreference:o.preferredBank,loanStatus:"applied",applicationDate:new Date().toISOString(),applicationId:`LA${Date.now()}`,eligibilityAmount:N.maxLoanAmount}};r(E),alert("Loan application submitted successfully! You will receive updates on your registered email and phone."),a()}catch(E){console.error("Error submitting loan application:",E),alert("Failed to submit loan application. Please try again.")}finally{b(!1)}},k=E=>E>=1e7?`â‚¹${(E/1e7).toFixed(1)}Cr`:E>=1e5?`â‚¹${(E/1e5).toFixed(1)}L`:`â‚¹${E.toLocaleString("en-IN")}`;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[95vh] overflow-hidden text-xs",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Ut,{className:"text-green-600",size:18})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xs font-bold text-gray-900",children:"Home Loan Application"}),e.jsx("p",{className:"text-gray-600 mt-0.5",children:"Apply for home loan with best rates"})]})]}),e.jsx("button",{onClick:a,className:"p-1.5 rounded-lg bg-white hover:bg-gray-50 transition-colors shadow-md",children:e.jsx(ns,{size:16})})]})}),e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex items-center justify-between",children:d.map((E,V)=>{const W=E.icon,B=i===E.id,M=i>E.id;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1.5 rounded-md ${B?"bg-blue-100 text-blue-700":M?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:[e.jsx("div",{className:`p-1 rounded-md ${B?"bg-blue-200":M?"bg-green-200":"bg-gray-200"}`,children:e.jsx(W,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:E.label}),e.jsxs("div",{className:"text-[10px]",children:["Step ",E.id]})]}),M&&e.jsx(bs,{className:"text-green-600",size:14})]}),V<d.length-1&&e.jsx("div",{className:`w-6 h-0.5 mx-1 ${M?"bg-green-300":"bg-gray-300"}`})]},E.id)})})}),e.jsxs("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:[i===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:o.applicantName,onChange:E=>P("applicantName",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",value:o.dateOfBirth,onChange:E=>P("dateOfBirth",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:o.applicantPhone,onChange:E=>P("applicantPhone",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:o.applicantEmail,onChange:E=>P("applicantEmail",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PAN Number"}),e.jsx("input",{type:"text",value:o.panNumber,onChange:E=>P("panNumber",E.target.value.toUpperCase()),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",placeholder:"ABCDE1234F"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Aadhar Number"}),e.jsx("input",{type:"text",value:o.aadharNumber,onChange:E=>P("aadharNumber",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",placeholder:"1234 5678 9012"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Marital Status"}),e.jsx("select",{value:o.maritalStatus,onChange:E=>P("maritalStatus",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",children:u.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("input",{type:"checkbox",checked:o.hasCoApplicant,onChange:E=>P("hasCoApplicant",E.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Add Co-applicant (Spouse/Family member)"})]}),o.hasCoApplicant&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Co-applicant Name"}),e.jsx("input",{type:"text",value:o.coApplicantName,onChange:E=>P("coApplicantName",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Relation"}),e.jsx("select",{value:o.coApplicantRelation,onChange:E=>P("coApplicantRelation",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",children:c.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:o.coApplicantPhone,onChange:E=>P("coApplicantPhone",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PAN Number"}),e.jsx("input",{type:"text",value:o.coApplicantPAN,onChange:E=>P("coApplicantPAN",E.target.value.toUpperCase()),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",placeholder:"ABCDE1234F"})]})]})]})]}),i===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900",children:"Employment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsx("select",{value:o.employmentType,onChange:E=>P("employmentType",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",children:x.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:o.companyName,onChange:E=>P("companyName",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Designation"}),e.jsx("input",{type:"text",value:o.designation,onChange:E=>P("designation",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Work Experience (Years)"}),e.jsx("input",{type:"number",value:o.workExperience,onChange:E=>P("workExperience",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Monthly Income (â‚¹)"}),e.jsx("input",{type:"number",value:o.monthlyIncome,onChange:E=>P("monthlyIncome",Number(E.target.value)),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Other Income (â‚¹)"}),e.jsx("input",{type:"number",value:o.otherIncome,onChange:E=>P("otherIncome",Number(E.target.value)),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",placeholder:"Rental, investments, etc."})]})]}),o.hasCoApplicant&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Co-applicant Employment"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsx("select",{value:o.coApplicantEmploymentType,onChange:E=>P("coApplicantEmploymentType",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",children:x.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:o.coApplicantCompany,onChange:E=>P("coApplicantCompany",E.target.value),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Monthly Income (â‚¹)"}),e.jsx("input",{type:"number",value:o.coApplicantIncome,onChange:E=>P("coApplicantIncome",Number(E.target.value)),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]})]})]})]}),i===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900",children:"Loan Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Value (â‚¹)"}),e.jsx("input",{type:"number",value:o.propertyValue,onChange:E=>P("propertyValue",Number(E.target.value)),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Loan Amount (â‚¹)"}),e.jsx("input",{type:"number",value:o.loanAmount,onChange:E=>P("loanAmount",Number(E.target.value)),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Down Payment (â‚¹)"}),e.jsx("input",{type:"number",value:o.downPayment,onChange:E=>P("downPayment",Number(E.target.value)),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Loan Tenure (Years)"}),e.jsx("select",{value:o.loanTenure/12,onChange:E=>P("loanTenure",Number(E.target.value)*12),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-1 focus:ring-green-500 text-xs",children:[10,15,20,25,30].map(E=>e.jsxs("option",{value:E,children:[E," years"]},E))})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-md p-3",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Loan Eligibility"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Total Income:"}),e.jsx("span",{className:"font-bold",children:k(o.monthlyIncome+(o.hasCoApplicant?o.coApplicantIncome:0))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Max Eligible:"}),e.jsx("span",{className:"font-bold text-green-600",children:k(N.maxLoanAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Requested:"}),e.jsx("span",{className:"font-bold",children:k(o.loanAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"EMI:"}),e.jsx("span",{className:"font-bold",children:k(N.currentEMI)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:`h-1.5 rounded-full ${N.eligibilityRatio<=100?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.min(N.eligibilityRatio,100)}%`}})}),e.jsx("div",{className:"text-xs text-blue-700",children:N.eligibilityRatio<=100?"You are eligible for this loan amount":"Loan amount exceeds eligibility. Consider reducing amount or adding co-applicant."})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Select Bank"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:v.slice(0,4).map(E=>e.jsxs("div",{onClick:()=>P("preferredBank",E.name),className:`border rounded-md p-3 cursor-pointer transition-all ${o.preferredBank===E.name?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:E.name}),e.jsxs("span",{className:"text-green-600 font-bold",children:[E.rate,"%"]})]}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsxs("div",{children:["Processing: ",E.processing,"%"]}),e.jsxs("div",{children:["EMI: ",k(f(o.loanAmount,E.rate,o.loanTenure))]})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:E.features.map((V,W)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded-full text-[10px]",children:V},W))})]},E.name))})]})]}),i===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900",children:"Required Documents"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Income Documents"}),e.jsx("div",{className:"space-y-2",children:[{key:"salarySlips",label:"Last 3 Salary Slips"},{key:"bankStatements",label:"Bank Statements (6 months)"},{key:"itr",label:"ITR (Last 2 years)"},{key:"formSixteen",label:"Form 16"}].map(E=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:o.documents[E.key],onChange:V=>P(`documents.${E.key}`,V.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:E.label})]},E.key))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Identity Documents"}),e.jsx("div",{className:"space-y-2",children:[{key:"panCard",label:"PAN Card"},{key:"aadharCard",label:"Aadhar Card"},{key:"propertyDocuments",label:"Property Documents"}].map(E=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:o.documents[E.key],onChange:V=>P(`documents.${E.key}`,V.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:E.label})]},E.key))})]})]}),e.jsx("div",{className:"bg-yellow-50 rounded-md p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(ct,{className:"text-yellow-600 mt-0.5",size:14}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:"Document Requirements"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-0.5",children:"Please ensure all documents are clear, legible, and not older than 3 months. Digital copies are acceptable for initial application."})]})]})})]}),i===5&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900",children:"Review Application"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Application Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Personal Details"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Name:"}),e.jsx("span",{className:"font-medium",children:o.applicantName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:o.applicantPhone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Email:"}),e.jsx("span",{className:"font-medium",children:o.applicantEmail})]}),o.hasCoApplicant&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Co-applicant:"}),e.jsx("span",{className:"font-medium",children:o.coApplicantName})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-700 mb-2",children:"Loan Details"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Loan Amount:"}),e.jsx("span",{className:"font-medium",children:k(o.loanAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Tenure:"}),e.jsxs("span",{className:"font-medium",children:[o.loanTenure/12," years"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Bank:"}),e.jsx("span",{className:"font-medium",children:o.preferredBank})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Monthly EMI:"}),e.jsx("span",{className:"font-medium text-blue-600",children:k(N.currentEMI)})]})]})]})]})]}),e.jsxs("div",{className:`rounded-lg p-4 ${N.eligibilityRatio<=100?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[N.eligibilityRatio<=100?e.jsx(bs,{className:"text-green-600",size:18}):e.jsx(ct,{className:"text-red-600",size:18}),e.jsx("h4",{className:`font-semibold ${N.eligibilityRatio<=100?"text-green-900":"text-red-900"}`,children:N.eligibilityRatio<=100?"Loan Eligible":"Eligibility Exceeded"})]}),e.jsx("p",{className:`text-xs ${N.eligibilityRatio<=100?"text-green-700":"text-red-700"}`,children:N.eligibilityRatio<=100?`Your application meets the eligibility criteria. Maximum eligible amount: ${k(N.maxLoanAmount)}`:`Your requested loan amount exceeds eligibility by ${k(o.loanAmount-N.maxLoanAmount)}. Consider reducing the loan amount.`})]}),e.jsx("div",{className:"border rounded-lg p-3",children:e.jsxs("label",{className:"flex items-start space-x-2",children:[e.jsx("input",{type:"checkbox",className:"mt-0.5 rounded border-gray-300 text-green-600 focus:ring-green-500",required:!0}),e.jsx("span",{className:"text-xs text-gray-700",children:"I hereby declare that all the information provided is true and correct to the best of my knowledge. I agree to the terms and conditions and authorize the bank to verify my details."})]})})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:$,disabled:i===1,className:`px-4 py-2 rounded-md text-xs font-medium ${i===1?"text-gray-400 bg-gray-100 cursor-not-allowed":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:"Previous"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 text-xs font-medium",children:"Cancel"}),i<d.length?e.jsxs("button",{onClick:w,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-xs font-medium flex items-center space-x-1",children:[e.jsx("span",{children:"Next"}),e.jsx(Rs,{size:14})]}):e.jsx("button",{onClick:y,disabled:g||N.eligibilityRatio>100,className:`px-4 py-2 rounded-md text-xs font-medium flex items-center space-x-1 ${g||N.eligibilityRatio>100?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:g?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{size:14}),e.jsx("span",{children:"Submitting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ut,{size:14}),e.jsx("span",{children:"Submit Application"})]})})]})]})})]})})},Rl=s=>{var a;throw s.response?(console.error("API Error Response:",s.response.data),new Error(((a=s.response.data)==null?void 0:a.message)||"Server Error")):s.request?(console.error("API No Response:",s.request),new Error("No response from server. Please try again later.")):(console.error("API Error:",s.message),new Error(s.message||"Unexpected error"))},gl={create:async s=>{try{return(await Ae.post("/buyer-followups/create",s)).data}catch(a){Rl(a)}},getAll:async s=>{try{return(await Ae.get("/buyer-followups/getall",{params:s})).data}catch(a){throw Rl(a),a}},getById:async s=>{try{return(await Ae.get(`/buyer-followups/getbyid/${s}`)).data}catch(a){Rl(a)}},update:async(s,a)=>{try{return(await Ae.put(`/buyer-followups/update/${s}`,a)).data}catch(t){Rl(t)}},remove:async s=>{try{return(await Ae.delete(`/buyer-followups/remove/${s}`)).data}catch(a){Rl(a)}},getCount:async s=>{try{return(await Ae.get("/buyer-followups/count",{params:s})).data}catch(a){throw Rl(a),a}}},jn=[{value:"Phone Call",Icon:Cs,color:"blue"},{value:"WhatsApp",Icon:Ia,color:"green"},{value:"Email",Icon:Ds,color:"indigo"},{value:"Site Visit",Icon:Qs,color:"orange"},{value:"Meeting",Icon:Ns,color:"purple"},{value:"Other",Icon:Bt,color:"gray"}],aa=s=>s==null?"":String(s),bm=s=>aa(s).toLowerCase().replace(/\s+/g,""),wl=(s,a)=>bm(s).includes(bm(a)),Wf=s=>{const a=b=>{for(const d of b)if(s&&typeof s[d]<"u")return s[d]},t=a(["type1Name","type1_name","type1","masterType1","master_type_1","master_type1","masterType1Name"])??a(["masterType1","master_type_1","master_type1"])??a(["master_type_1","master_type_1_name"])??a(["master_type_1"]),r=a(["value1Name","value1_name","value1","masterValue1","master_value_1","master_value1"])??a(["master_value_1"]),i=a(["type2Name","type2_name","type2","masterType2","master_type_2","master_type2"])??a(["master_type_2"]),n=a(["value2Name","value2_name","value2","masterValue2","master_value_2","master_value2"])??a(["master_value_2"]),o=a(["masterTabId","master_tab_id","master_tab","tabId","tab_id"])??a(["mastertabid","master_tab"]);let m=a(["remarks","remark","remarks_list","masterRemarks","master_remarks"])??void 0,g=[];return Array.isArray(m)?g=m.map(b=>aa(b).trim()).filter(Boolean):typeof m=="string"&&m.trim()&&(g=m.split(/\r?\n|,/).map(b=>aa(b).trim()).filter(Boolean)),{id:a(["id","_id","master_id","masterId"]),tabId:o?aa(o).trim():void 0,type1Name:t?aa(t).trim():void 0,value1Name:r?aa(r).trim():void 0,type2Name:i?aa(i).trim():void 0,value2Name:n?aa(n).trim():void 0,remarks:g,raw:s}},dd=s=>Array.from(new Set(s.map(a=>(a||"").trim()).filter(Boolean))),Gi=s=>!!s&&(wl(s,"leadstage")||wl(s,"stage")||wl(s,"lead stage")),Ki=s=>!!s&&(wl(s,"leadstatus")||wl(s,"status")),fm=s=>!!s&&(wl(s,"remark")||wl(s,"remarks")),Hf=s=>{const a=[];return s.forEach(t=>{Gi(t.type1Name)&&a.push(t.value1Name||""),Gi(t.type2Name)&&a.push(t.value2Name||"")}),dd(a)},ym=(s,a)=>{const t=[];return s.forEach(r=>{const i=Gi(r.type1Name),n=Gi(r.type2Name),o=Ki(r.type1Name),m=Ki(r.type2Name);i&&aa(r.value1Name).trim()===aa(a).trim()&&m&&t.push(r.value2Name||""),n&&aa(r.value2Name).trim()===aa(a).trim()&&o&&t.push(r.value1Name||"")}),dd(t)},jm=(s,a)=>{const t=[];return s.forEach(r=>{const i=Ki(r.type1Name),n=Ki(r.type2Name),o=fm(r.type1Name),m=fm(r.type2Name);i&&aa(r.value1Name).trim()===aa(a).trim()&&Array.isArray(r.remarks)&&r.remarks.length&&t.push(...r.remarks),n&&aa(r.value2Name).trim()===aa(a).trim()&&Array.isArray(r.remarks)&&r.remarks.length&&t.push(...r.remarks),i&&aa(r.value1Name).trim()===aa(a).trim()&&m&&t.push(r.value2Name||""),n&&aa(r.value2Name).trim()===aa(a).trim()&&o&&t.push(r.value1Name||"")}),dd(t)},vm={blue:"text-blue-600",green:"text-green-600",indigo:"text-indigo-600",orange:"text-orange-600",purple:"text-purple-600",gray:"text-gray-600"},eg=({options:s,value:a,onChange:t,disabled:r})=>{const[i,n]=l.useState(!1),o=l.useRef(null);l.useEffect(()=>{const d=v=>{o.current&&!o.current.contains(v.target)&&n(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const m=s.find(d=>d.value===a)??s[0],g=m.Icon,b=vm[m.color]||"text-gray-600";return e.jsxs("div",{className:"relative",ref:o,children:[e.jsxs("button",{type:"button",disabled:r,onClick:()=>n(d=>!d),className:`mt-1 w-full border border-gray-300 rounded-md px-3 py-2 text-left flex items-center gap-2
                    focus:outline-none focus:ring-2 focus:ring-blue-500 ${r?"opacity-60":""}`,"aria-haspopup":"listbox","aria-expanded":i,children:[e.jsx(g,{size:18,className:b}),e.jsx("span",{className:"flex-1",children:m.value}),e.jsx("svg",{viewBox:"0 0 20 20",className:"w-4 h-4",children:e.jsx("path",{d:"M5.5 7.5L10 12l4.5-4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round"})})]}),i&&!r&&e.jsx("div",{role:"listbox",className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:s.map(d=>{const v=d.Icon,x=vm[d.color]||"text-gray-600",u=d.value===a;return e.jsxs("button",{type:"button",role:"option","aria-selected":u,onClick:()=>{t(d.value),n(!1)},className:`w-full px-3 py-2 text-left flex items-center gap-2 hover:bg-gray-50
                            ${u?"bg-indigo-50":""}`,children:[e.jsx(v,{size:18,className:x}),e.jsx("span",{children:d.value})]},d.value)})})]})};eg.displayName="ColoredFollowupTypeSelect";const Yf=({isOpen:s,onClose:a,onSave:t,tabId:r,buyerId:i,initialForm:n})=>{if(console.debug("BuyerFollowupModal open:",s,"prop buyerId:",i),!s)return null;n!=null&&n.id;const[o,m]=l.useState([]),[g,b]=l.useState([]),[d,v]=l.useState(!1),[x,u]=l.useState(null),[c,f]=l.useState([]),[p,N]=l.useState([]),[P,w]=l.useState([]),{user:$}=Hs(),y=$==null?void 0:$.id,[k,R]=l.useState({followupType:jn[0].value,buyerLeadStage:"",buyerLeadStatus:"",remark:"",customRemark:"",nextAction:"",scheduleDate:"",scheduleTime:"",priority:"Medium",buyer_id:i?String(i):""});l.useEffect(()=>{i!=null&&(R(A=>({...A,buyer_id:String(i)})),console.debug("Synced buyerId into form:",i))},[i]),l.useEffect(()=>{s&&(async()=>{try{const A=await Gt(["lead"]);A&&A["lead priority"]&&m(A["lead priority"])}catch(A){console.error("Error fetching priorities",A)}})()},[s]);const F=(A,L)=>{if(n)return n[A]??n[L]};l.useEffect(()=>{(async()=>{if(s){v(!0),u(null);try{const L=await yl.getRemarksByTabId(r);let D=[];Array.isArray(L)?D=L:L&&Array.isArray(L.data)?D=L.data:L&&Array.isArray(L.rows)?D=L.rows:L&&L.result&&Array.isArray(L.result)?D=L.result:L&&typeof L=="object"&&(D=Object.values(L).flatMap(q=>Array.isArray(q)?q:[])),!D.length&&L&&typeof L=="object"&&Object.keys(L).length&&(D=Array.isArray(L)?L:[L]);const I=D.map(q=>Wf(q||{})),H=(r||"").toString().trim().toLowerCase(),h=H?I.filter(q=>(q.tabId||"").toString().trim().toLowerCase()===H):I,Y=h.length?h:I;b(Y);const K=Hf(Y);if(f(K),n){R(ne=>({...ne,followupType:F("followupType","followup_type")??ne.followupType,buyerLeadStage:F("buyerLeadStage","buyer_lead_stage")??ne.buyerLeadStage,buyerLeadStatus:F("buyerLeadStatus","buyer_lead_status")??ne.buyerLeadStatus,remark:F("remark","remark")??ne.remark,customRemark:F("customRemark","custom_remark")??ne.customRemark,nextAction:F("nextAction","next_action")??ne.nextAction,scheduleDate:F("scheduleDate","schedule_date")??ne.scheduleDate,scheduleTime:F("scheduleTime","schedule_time")??ne.scheduleTime,priority:F("priority","priority")??ne.priority,buyer_id:F("buyer_id","buyer_id")?String(F("buyer_id","buyer_id")):ne.buyer_id}));const q=F("buyerLeadStage","buyer_lead_stage")??"";if(q){const ne=ym(Y,q);N(ne);const le=F("buyerLeadStatus","buyer_lead_status")??"";if(le){const S=jm(Y,le);w(S)}else w([])}else N([]),w([])}else N([]),w([]),R(q=>({...q,followupType:jn[0].value,priority:"Medium"}))}catch(L){console.error("Failed to load connected remarks:",L),u("Failed to load follow-up options"),b([]),f([]),N([]),w([])}finally{v(!1)}}})()},[s,r]);const T=A=>L=>R(D=>({...D,[A]:L.target.value})),j=A=>{const L=A.target.value,D=L?ym(g,L):[];N(D),w([]),R(I=>({...I,buyerLeadStage:L,buyerLeadStatus:"",remark:"",customRemark:""}))},E=A=>{const L=A.target.value,D=L?jm(g,L):[];w(D),R(I=>({...I,buyerLeadStatus:L,remark:"",customRemark:""}))},V=A=>{const L=A.target.value;R(D=>({...D,remark:L,customRemark:L?`${L} â€“ `:""}))},W=async A=>{if(A.preventDefault(),!k.buyerLeadStage){alert("Please select a Buyer Lead Stage.");return}if(!k.buyerLeadStatus){alert("Please select a Buyer Lead Status.");return}const L=k.buyer_id??(i!=null?String(i):"");if(console.debug("Submitting follow-up. prop buyerId:",i,"form.buyer_id:",k.buyer_id,"resolvedBuyerId:",L),!L){alert("Missing buyer id. Cannot save follow-up without buyer reference."),console.error("Missing buyer id when submitting follow-up. form:",k,"prop buyerId:",i);return}v(!0),u(null);try{const D=new Date().toISOString(),I=F("created_by","created_by")??F("createdBy","created_by"),H=F("created_at","created_at")??F("createdAt","created_at"),h=n!=null&&n.id?I??void 0:y||void 0,Y=n!=null&&n.id?H??void 0:D,K=y||void 0,q=D,ne=Number(L),S={buyer_id:Number.isFinite(ne)&&ne!==0?ne:L,followup_type:k.followupType,buyer_lead_stage:k.buyerLeadStage,buyer_lead_status:k.buyerLeadStatus,remark:k.remark,custom_remark:k.customRemark,next_action:k.nextAction,priority:k.priority,schedule_date:k.scheduleDate,schedule_time:k.scheduleTime,...h?{created_by:h}:{},...Y?{created_at:Y}:{},...K?{updated_by:K}:{},...q?{updated_at:q}:{}};n!=null&&n.id&&(S.id=n.id);let C=null;n!=null&&n.id?C=await gl.update(String(n.id),S):C=await gl.create(S),t&&t(C),a()}catch(D){console.error("Save follow-up failed:",D),u((D==null?void 0:D.message)??"Failed to save follow-up. Please try again.")}finally{v(!1)}},B=jn.find(A=>A.value===k.followupType)||jn[0],M=B.color==="blue"?"focus:ring-blue-500":B.color==="green"?"focus:ring-green-500":B.color==="indigo"?"focus:ring-indigo-500":B.color==="orange"?"focus:ring-orange-500":B.color==="purple"?"focus:ring-purple-500":"focus:ring-gray-500";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-xl p-5 m-4 max-h-[90vh] overflow-y-auto border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-transparent bg-clip-text",children:n!=null&&n.id?"Edit Buyer Follow-up":"Add Buyer New Follow-up"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl leading-none","aria-label":"Close",children:"Ã—"})]}),x&&e.jsx("div",{className:"mb-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:x}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Followup Type"}),e.jsx(eg,{options:jn,value:k.followupType,onChange:A=>R(L=>({...L,followupType:A})),disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lead Priority"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",value:k.priority,onChange:T("priority"),children:[e.jsx("option",{value:"",children:"Select Priority"}),o.map(A=>e.jsx("option",{value:A.value,children:A.label},A.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Buyer Lead Stage"}),e.jsxs("select",{className:`mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none ${M}`,value:k.buyerLeadStage,onChange:j,disabled:d||c.length===0,children:[e.jsx("option",{value:"",children:d?"Loading...":"Select stageâ€¦"}),c.map(A=>e.jsx("option",{value:A,children:A},A))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Buyer Lead Status"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:k.buyerLeadStatus,onChange:E,disabled:d||!k.buyerLeadStage||p.length===0,children:[e.jsx("option",{value:"",children:k.buyerLeadStage?"Select statusâ€¦":"Select stage first"}),p.map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",value:k.remark,onChange:V,disabled:d||!k.buyerLeadStatus||P.length===0,children:[e.jsx("option",{value:"",children:k.buyerLeadStatus?"Select remarkâ€¦":"Select status first"}),P.map(A=>e.jsx("option",{value:A,children:A},A))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Custom Remark"}),e.jsx("textarea",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 min-h-[90px] focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Select a remark above or type your own detailsâ€¦",value:k.customRemark,onChange:T("customRemark")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Next Action"}),e.jsx("input",{type:"text",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter next action...",value:k.nextAction,onChange:T("nextAction")})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Schedule Date"}),(()=>{const A=new Date;A.setDate(A.getDate()+1);const L=A.toISOString().split("T")[0];return e.jsx("input",{type:"date",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500",value:k.scheduleDate,onChange:T("scheduleDate"),min:L})})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Schedule Time"}),e.jsx("input",{type:"time",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500",value:k.scheduleTime,onChange:T("scheduleTime")})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md text-white bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 hover:brightness-110 transition-colors",disabled:d,children:n!=null&&n.id?d?"Updating...":"Update Follow-up":d?"Saving...":"Save Follow-up"})]})]})]})]})},Gf=({buyer:s})=>{const a=[{id:"financial",label:"Financial Documents",count:3,color:"green"},{id:"identity",label:"Identity Documents",count:2,color:"blue"},{id:"property",label:"Property Documents",count:1,color:"purple"},{id:"loan",label:"Loan Documents",count:2,color:"orange"}],t=[{id:1,name:"Salary Slips (Last 3 months)",category:"financial",status:"verified",date:"2025-01-10",size:"2.3 MB"},{id:2,name:"Bank Statements",category:"financial",status:"pending",date:"2025-01-12",size:"5.1 MB"},{id:3,name:"PAN Card",category:"identity",status:"verified",date:"2025-01-08",size:"0.8 MB"},{id:4,name:"Aadhar Card",category:"identity",status:"verified",date:"2025-01-08",size:"1.2 MB"},{id:5,name:"Property Shortlist",category:"property",status:"updated",date:"2025-01-13",size:"0.5 MB"},{id:6,name:"Loan Pre-approval Letter",category:"loan",status:"received",date:"2025-01-12",size:"1.8 MB"}],r=i=>{const n={verified:{bg:"bg-green-100",text:"text-green-700",label:"Verified",icon:"âœ…"},pending:{bg:"bg-orange-100",text:"text-orange-700",label:"Pending",icon:"â³"},received:{bg:"bg-blue-100",text:"text-blue-700",label:"Received",icon:"ðŸ“„"},updated:{bg:"bg-purple-100",text:"text-purple-700",label:"Updated",icon:"ðŸ”„"},rejected:{bg:"bg-red-100",text:"text-red-700",label:"Rejected",icon:"âŒ"}},o=n[i]||n.pending;return e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${o.bg} ${o.text}`,children:[o.icon," ",o.label]})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900",children:"Document Management"}),e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1 bg-blue-600 text-white text-xs rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{size:12}),e.jsx("span",{children:"Upload"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:a.map(i=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-xs text-gray-900",children:i.label}),e.jsxs("p",{className:"text-xs text-gray-600",children:[i.count," docs"]})]}),e.jsx("div",{className:`w-2.5 h-2.5 bg-${i.color}-500 rounded-full`})]})},i.id))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsx("h4",{className:"font-semibold text-xs text-gray-900",children:"All Documents"})}),e.jsx("div",{className:"divide-y divide-gray-200",children:t.map(i=>e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(ws,{className:"text-blue-600",size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-xs text-gray-900",children:i.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:[i.category," â€¢ ",i.size," â€¢ ",i.date]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[r(i.status),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(ks,{size:12})}),e.jsx("button",{className:"p-1 text-green-600 hover:bg-green-100 rounded",children:e.jsx(Ys,{size:12})}),e.jsx("button",{className:"p-1 text-purple-600 hover:bg-purple-100 rounded",children:e.jsx(Wt,{size:12})})]})]})]})},i.id))})]})]})},Kf=({buyer:s,onShowLoanApplication:a})=>{var i,n,o,m;const t=g=>g>=1e7?`â‚¹${(g/1e7).toFixed(1)}Cr`:g>=1e5?`â‚¹${(g/1e5).toFixed(1)}L`:`â‚¹${g.toLocaleString("en-IN")}`,r=g=>{const b={not_applied:{bg:"bg-gray-100",text:"text-gray-700",label:"Not Applied",icon:"âšª"},applied:{bg:"bg-blue-100",text:"text-blue-700",label:"Applied",icon:"ðŸ“‹"},pre_approved:{bg:"bg-green-100",text:"text-green-700",label:"Pre-approved",icon:"âœ…"},approved:{bg:"bg-emerald-100",text:"text-emerald-700",label:"Approved",icon:"ðŸŽ‰"},rejected:{bg:"bg-red-100",text:"text-red-700",label:"Rejected",icon:"âŒ"}},d=b[g]||b.not_applied;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${d.bg} ${d.text}`,children:[d.icon," ",d.label]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"Budget Range"}),e.jsxs("p",{className:"text-xs font-bold",children:[t(s.budget.min)," - ",t(s.budget.max)]})]}),e.jsx(ka,{size:20,className:"text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Monthly Income"}),e.jsx("p",{className:"text-xs font-bold",children:t(((i=s.financials)==null?void 0:i.monthlyIncome)||0)})]}),e.jsx(Rs,{size:20,className:"text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-xs",children:"Credit Score"}),e.jsx("p",{className:"text-xs font-bold",children:((n=s.financials)==null?void 0:n.creditScore)||"N/A"})]}),e.jsx(Ct,{size:20,className:"text-purple-200"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-900 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:16}),"Loan Information"]}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-2 px-3 py-1 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Apply for Loan"})]})]}),(o=s.financials)!=null&&o.loanRequired?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Loan Required:"}),e.jsx("span",{className:"font-medium ml-2 text-green-600",children:"Yes"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Loan Amount:"}),e.jsx("span",{className:"font-medium ml-2",children:t(s.financials.loanAmount)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Down Payment:"}),e.jsx("span",{className:"font-medium ml-2",children:t(s.financials.downPayment)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Bank Preference:"}),e.jsx("span",{className:"font-medium ml-2",children:s.financials.bankPreference})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Loan Status:"}),e.jsx("span",{className:"ml-2",children:r(s.financials.loanStatus)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Credit Score:"}),e.jsx("span",{className:"font-medium ml-2",children:s.financials.creditScore})]})]}),s.financials.applicationId&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-xs",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Loan Application Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-600",children:"Application ID:"}),e.jsx("span",{className:"font-medium ml-2",children:s.financials.applicationId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-600",children:"Applied Date:"}),e.jsx("span",{className:"font-medium ml-2",children:new Date(s.financials.applicationDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-600",children:"Eligible Amount:"}),e.jsx("span",{className:"font-medium ml-2",children:t(s.financials.eligibilityAmount)})]})]})]})]}):e.jsxs("div",{className:"text-center py-6 text-xs",children:[e.jsx(Ut,{className:"mx-auto text-gray-300 mb-3",size:36}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"No Loan Required"}),e.jsx("p",{className:"text-gray-500 mb-3",children:"This buyer doesn't require a loan for property purchase"}),e.jsx("button",{onClick:a,className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Apply for Loan"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-900 mb-3",children:"Financial Health Score"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg text-xs",children:[e.jsx("div",{className:"font-bold text-green-600",children:((m=s.financials)==null?void 0:m.creditScore)||750}),e.jsx("div",{className:"text-green-700",children:"Credit Score"}),e.jsx("div",{className:"text-gray-500 mt-1",children:"Excellent"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg text-xs",children:[e.jsxs("div",{className:"font-bold text-blue-600",children:[s.dealPotential==="high"?"85":s.dealPotential==="medium"?"70":"55","%"]}),e.jsx("div",{className:"text-blue-700",children:"Deal Potential"}),e.jsx("div",{className:"text-gray-500 mt-1",children:s.dealPotential})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg text-xs",children:[e.jsxs("div",{className:"font-bold text-purple-600",children:[s.responseRate||80,"%"]}),e.jsx("div",{className:"text-purple-700",children:"Response Rate"}),e.jsx("div",{className:"text-gray-500 mt-1",children:"Very Good"})]})]})]})]})},Jf=({buyer:s,onAddActivity:a,onEditActivity:t})=>{var n;const r=o=>{switch(o){case"call":return e.jsx(Cs,{className:"text-blue-600",size:16});case"visit":return e.jsx(ks,{className:"text-green-600",size:16});case"meeting":return e.jsx(Ns,{className:"text-purple-600",size:16});case"email":return e.jsx(Ds,{className:"text-orange-600",size:16});case"whatsapp":return e.jsx(tt,{className:"text-green-600",size:16});default:return e.jsx(jt,{className:"text-gray-600",size:16})}},i=o=>({call:"Phone Call",visit:"Property Visit",meeting:"Meeting",email:"Email",whatsapp:"WhatsApp",presentation:"Presentation"})[o]||o;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap items-center justify-between",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-1 md:mb-0",children:"Activity Timeline"}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-1 px-2 py-1 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Activity"})]})]}),((n=s.activities)==null?void 0:n.length)>0?e.jsx("div",{className:"space-y-2",children:s.activities.map((o,m)=>e.jsxs("div",{className:"relative",children:[m<s.activities.length-1&&e.jsx("div",{className:"absolute left-5 top-10 w-0.5 h-12 bg-gray-200"}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 bg-white border border-gray-200 rounded-full",children:r(o.type)}),e.jsxs("div",{className:"flex-1 bg-white border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-xs",children:o.description}),e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded-full text-[10px] font-medium",children:i(o.type)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("span",{className:"text-[10px] text-gray-500",children:[o.date," â€¢ ",o.time]}),e.jsx("button",{onClick:()=>t(o),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(ft,{size:12})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2 text-[11px]",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Duration:"}),e.jsx("span",{className:"font-medium ml-1",children:o.duration})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Stage:"}),e.jsx("span",{className:"font-medium ml-1",children:o.stage.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Executed by:"}),e.jsx("span",{className:"font-medium ml-1",children:o.executedBy})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Rating:"}),e.jsx("div",{className:"flex items-center space-x-0.5 ml-1",children:Array.from({length:5},(g,b)=>e.jsx(Xs,{size:10,className:b<o.rating?"text-yellow-400 fill-current":"text-gray-300"},b))})]})]}),e.jsxs("div",{className:"space-y-1 text-[11px]",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Outcome:"}),e.jsx("p",{className:"text-gray-700",children:o.outcome})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Next Action:"}),e.jsx("p",{className:"text-gray-700",children:o.nextAction})]}),o.remarks&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Remarks:"}),e.jsx("p",{className:"text-gray-700",children:o.remarks})]})]})]})]})]},o.id))}):e.jsxs("div",{className:"bg-white rounded border border-gray-200 p-6 text-center",children:[e.jsx(jt,{className:"mx-auto text-gray-300 mb-3",size:40}),e.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-1",children:"No Activities Yet"}),e.jsx("p",{className:"text-[11px] text-gray-500 mb-3",children:"Start tracking buyer interactions and activities"}),e.jsx("button",{onClick:a,className:"px-3 py-1.5 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 transition-colors",children:"Add First Activity"})]})]})},Qf=({isOpen:s,onClose:a,selectedProperties:t,buyer:r})=>{const[i,n]=l.useState(""),[o,m]=l.useState(!1),[g,b]=l.useState({});if(!s)return null;l.useEffect(()=>{const M=A=>A.key==="Escape"&&a();return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[a]);function d(){if(typeof window>"u")return{};const M=localStorage.getItem("employee"),A=localStorage.getItem("employeeRole"),L=localStorage.getItem("user");let D=null,I=null,H;try{D=M?JSON.parse(M):null}catch{}try{I=L?JSON.parse(L):null}catch{}try{if(A){const q=JSON.parse(A);H=(q==null?void 0:q.name)||(q==null?void 0:q.role)||(q==null?void 0:q._id)}}catch{H=A||void 0}const h=(D==null?void 0:D.name)||(D==null?void 0:D.employeeName)||[I==null?void 0:I.first_name,I==null?void 0:I.last_name].filter(Boolean).join(" ").trim()||(I==null?void 0:I.username),Y=(D==null?void 0:D.email)||(I==null?void 0:I.email),K=(D==null?void 0:D.phone)||(D==null?void 0:D.mobile)||(D==null?void 0:D.whatsapp)||(I==null?void 0:I.phone)||(I==null?void 0:I.mobile)||(I==null?void 0:I.whatsapp);return{name:h,email:Y,phone:K,role:H}}l.useEffect(()=>{b(d())},[]);const v=M=>{const A=Number(M||0);return A?A>=1e7?`â‚¹${(A/1e7).toFixed(1)}Cr`:A>=1e5?`â‚¹${(A/1e5).toFixed(1)}L`:`â‚¹${A.toLocaleString("en-IN")}`:"â€”"},x=(M,A)=>(M==null?void 0:M.title)||[(M==null?void 0:M.unit_type)||(M==null?void 0:M.bhk),(M==null?void 0:M.property_subtype_name)||(M==null?void 0:M.property_type_name),M==null?void 0:M.society_name].filter(Boolean).join(" ").trim()||`Property #${A+1}`,u=M=>(M==null?void 0:M.address)||[(M==null?void 0:M.location_name)||(M==null?void 0:M.locality_name),(M==null?void 0:M.city_name)||(M==null?void 0:M.city)].filter(Boolean).join(", "),c=M=>{var A;return Array.isArray(M==null?void 0:M.photos)&&M.photos.length?typeof M.photos[0]=="string"?M.photos[0]:(A=M.photos[0])==null?void 0:A.url:""},f=M=>(M==null?void 0:M.budget)??(M==null?void 0:M.price)??(M==null?void 0:M.expected_price),p=M=>(M==null?void 0:M.seller_name)||(M==null?void 0:M.owner_name)||(M==null?void 0:M.contact_name)||(M==null?void 0:M.seller)||(M==null?void 0:M.owner)||"â€”",N=M=>(M==null?void 0:M.seller_phone)||(M==null?void 0:M.owner_phone)||(M==null?void 0:M.contact_phone)||(M==null?void 0:M.phone)||"",P=M=>(M==null?void 0:M.seller_email)||(M==null?void 0:M.owner_email)||(M==null?void 0:M.contact_email)||(M==null?void 0:M.email)||"",w=M=>{const A="https://resaleexpert.com/property",L=(M==null?void 0:M.id)??(M==null?void 0:M.property_id)??"",D=x(M,0),I=String(D).toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");return`${A}/${L}/${I}`},$=M=>{if(!M)return"";const A=String(M).replace(/\D/g,"");return A.length===10?`91${A}`:A},y=l.useMemo(()=>{if(!Array.isArray(t)||t.length===0)return"No properties selected.";const M=(g==null?void 0:g.name)||"â€”",A=(g==null?void 0:g.phone)||"â€”",L=(g==null?void 0:g.email)||"â€”";return`${t.map((I,H)=>{const h=x(I,H),Y=u(I)||"â€”",K=I!=null&&I.carpet_area||I!=null&&I.area||I!=null&&I.super_builtup_area?`${Number((I==null?void 0:I.carpet_area)??(I==null?void 0:I.area)??(I==null?void 0:I.super_builtup_area)).toLocaleString("en-IN")} sq ft`:"â€”",q=f(I)?v(f(I)):"â€”",ne=I!=null&&I.floor&&(I!=null&&I.total_floors)?`${I.floor} of ${I.total_floors}`:(I==null?void 0:I.floor)||"â€”",le=I!=null&&I.parking_qty||I!=null&&I.parking_type?[I==null?void 0:I.parking_qty,I==null?void 0:I.parking_type].filter(Boolean).join(" "):"â€”",S=(I==null?void 0:I.furnishing)||(I==null?void 0:I.furnished_status)||"â€”",C=Array.isArray(I==null?void 0:I.amenities)?I.amenities.slice(0,5):[],J=C.length?C.map(Q=>`â€¢ ${Q}`).join(`
`):"â€¢ Premium amenities available",ue=w(I);return`ðŸ  *${h}*
ðŸ“ *Location:* ${Y}
ðŸ¢ *Type:* ${((I==null?void 0:I.unit_type)||(I==null?void 0:I.bhk)||"â€”").toString().toUpperCase()} â€¢ ${K}
ðŸ’° *Price:* ${q}
ðŸ—ï¸ *Floor:* ${ne}
ðŸš— *Parking:* ${le}
ðŸ›‹ï¸ *Furnishing:* ${S}

âœ¨ *Amenities:*
${J}

ðŸ”— ${ue}
ðŸ‘¤ *Agent:* ${M}
ðŸ“ž *Contact:* ${A}
ðŸ“§ *Email:* ${L}`}).join(`

---

`)}

*Interested? Contact us for a site visit!*`},[t,g==null?void 0:g.name,g==null?void 0:g.phone,g==null?void 0:g.email]),k=l.useMemo(()=>{const M=(r==null?void 0:r.name)||(r==null?void 0:r.buyer_name)||(r==null?void 0:r.client_name);return!M||String(M).trim()===""?y:`Hi ${M},

${y}`},[r,y]),R=i||k;l.useMemo(()=>{const M=Array.isArray(t)?t.map(L=>({id:(L==null?void 0:L.id)??(L==null?void 0:L.property_id)??Math.random(),sellerName:p(L),phone:N(L),email:P(L),link:w(L),title:x(L,0)})):[],A=new Set;return M.filter(L=>{const D=`${L.phone}|${L.email}`;return A.has(D)?!1:(A.add(D),!0)})},[t]);const F=async M=>{try{await navigator.clipboard.writeText(M),alert("Copied!")}catch(A){console.error(A)}},T=()=>{const M=$(r==null?void 0:r.phone),L=`${M?`https://wa.me/${M}`:"https://wa.me/"}?text=${encodeURIComponent(R)}`;window.open(L,"_blank")},j=()=>{const M=`Property List (${(t==null?void 0:t.length)||0} item${((t==null?void 0:t.length)||0)===1?"":"s"})`,L=`mailto:${r!=null&&r.email?encodeURIComponent(r.email):""}?subject=${encodeURIComponent(M)}&body=${encodeURIComponent(R)}`;window.open(L,"_blank")},E=()=>{const M=(t||[]).map(w).join(`
`);F(M)},V=()=>{const M=(t||[]).map(L=>{const D=w(L),I=x(L,0);return`
          <div style="display:flex;gap:16px;align-items:center;margin:16px 0;">
            <img src="${`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(D)}`}" alt="QR" width="120" height="120" />
            <div>
              <div style="font-weight:600;font-size:16px;">${I}</div>
              <div style="font-size:12px;color:#555;">${D}</div>
            </div>
          </div>
        `}).join(""),A=window.open("","_blank");A&&(A.document.write(`
        <html>
          <head><title>Property QR Codes</title></head>
          <body style="font-family:Arial, sans-serif;padding:24px;">
            <h2 style="margin-top:0;">Property QR Codes</h2>
            ${M||"<div>No properties selected.</div>"}
          </body>
        </html>
      `),A.document.close())},W=()=>(r==null?void 0:r.name)||(r==null?void 0:r.buyer_name)||(r==null?void 0:r.client_name),B=e.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a,"aria-hidden":"true"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-5xl rounded-2xl bg-white shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Share ",(t==null?void 0:t.length)||0," Property",((t==null?void 0:t.length)||0)===1?"":"ies"]}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[g.role&&e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 border",children:["Role: ",e.jsx("b",{className:"ml-1",children:g.role})]}),g.name&&e.jsx("span",{className:"px-2 py-0.5 rounded-md bg-purple-50 text-purple-700 border border-purple-100",children:g.name}),g.phone&&e.jsx("a",{href:`tel:${g.phone}`,className:"px-2 py-0.5 rounded-md bg-gray-50 text-gray-700 border",children:g.phone}),g.email&&e.jsx("a",{href:`mailto:${g.email}`,className:"px-2 py-0.5 rounded-md bg-gray-50 text-gray-700 border",children:g.email})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100","aria-label":"Close",children:e.jsx(ns,{size:18})})]}),e.jsxs("div",{className:"p-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:"px-2 py-1 bg-purple-50 text-purple-700 rounded-md border border-purple-100",children:["Sending to buyer",W()?`: ${W()}`:""]}),(r==null?void 0:r.phone)&&e.jsx("a",{href:`tel:${r.phone}`,className:"px-2 py-1 bg-gray-50 rounded-md border text-gray-700",children:r.phone}),(r==null?void 0:r.email)&&e.jsx("a",{href:`mailto:${r.email}`,className:"px-2 py-1 bg-gray-50 rounded-md border text-gray-700",children:r.email})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Selected Properties"}),!t||t.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"No properties selected."}):e.jsx("div",{className:"space-y-3",children:t.map((M,A)=>{const L=c(M),D=x(M,A),I=u(M),H=f(M);return e.jsx("div",{className:"border rounded-xl p-3",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-24 h-20 bg-gray-100 rounded-lg overflow-hidden flex-none",children:L?e.jsx("img",{src:L,alt:D,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs",children:"No Image"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:D}),e.jsx("div",{className:"text-xs text-gray-600",children:I||"â€”"})]}),e.jsx("div",{className:"text-right text-sm font-semibold text-emerald-700",children:v(H)})]}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-600 flex flex-wrap gap-x-3 gap-y-1",children:[M!=null&&M.carpet_area||M!=null&&M.area||M!=null&&M.super_builtup_area?e.jsxs("span",{children:["Area:"," ",e.jsxs("b",{children:[Number((M==null?void 0:M.carpet_area)??(M==null?void 0:M.area)??(M==null?void 0:M.super_builtup_area)).toLocaleString("en-IN")," ","sq ft"]})]}):null,M!=null&&M.floor?e.jsxs("span",{children:["Floor: ",e.jsxs("b",{children:[M.floor,M!=null&&M.total_floors?` of ${M.total_floors}`:""]})]}):null,M!=null&&M.facing?e.jsxs("span",{children:["Facing: ",e.jsx("b",{children:M.facing})]}):null]}),e.jsx("div",{className:"mt-2 text-[11px]",children:e.jsx("a",{href:w(M),target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"View public page"})})]})]})},((M==null?void 0:M.id)??(M==null?void 0:M.property_id)??A).toString())})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Message Preview"}),e.jsx("textarea",{className:"w-full h-[340px] border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",value:R,onChange:M=>n(M.target.value)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>n(k),className:"px-3 py-1.5 text-xs rounded-lg bg-blue-50 text-blue-700 hover:bg-blue-100",children:"Use Default"}),e.jsx("button",{onClick:()=>n(""),className:"px-3 py-1.5 text-xs rounded-lg bg-gray-50 text-gray-700 hover:bg-gray-100",children:"Clear"}),e.jsxs("button",{onClick:()=>F(R),className:"ml-auto px-3 py-1.5 text-xs rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 inline-flex items-center gap-2",children:[e.jsx(Xt,{size:14})," Copy"]})]})]})]})]}),e.jsxs("div",{className:"p-4 border-t flex items-center justify-end gap-2 relative",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>m(M=>!M),className:"px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 inline-flex items-center gap-2",children:[e.jsx(ja,{size:16}),"Share",e.jsx(ea,{size:16})]}),o&&e.jsxs("div",{className:"absolute top-[-200px] right-0 mt-2 w-56 bg-white border border-gray-200 rounded-xl shadow-xl z-10",onMouseLeave:()=>m(!1),children:[e.jsxs("button",{onClick:()=>{m(!1),T()},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 text-sm",title:r!=null&&r.phone?`Send to ${r.phone}`:"Open WhatsApp composer",children:[e.jsx(tt,{size:16,className:"text-green-600"}),"WhatsApp ",r!=null&&r.phone?"(Buyer)":""]}),e.jsxs("button",{onClick:()=>{m(!1),j()},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 text-sm",title:r!=null&&r.email?`Send to ${r.email}`:"Open email composer",children:[e.jsx(Ds,{size:16,className:"text-blue-600"}),"Email ",r!=null&&r.email?"(Buyer)":""]}),e.jsxs("button",{onClick:()=>{m(!1),F(R)},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 text-sm",children:[e.jsx(Xt,{size:16}),"Copy Message"]}),e.jsxs("button",{onClick:()=>{m(!1),E()},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 text-sm",children:[e.jsx(za,{size:16}),"Copy All Links"]}),e.jsxs("button",{onClick:()=>{m(!1),V()},className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-50 text-sm",children:[e.jsx(an,{size:16}),"Open QR Page"]})]})]}),e.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200",children:"Close"})]})]})})]});return hh.createPortal(B,document.body)},Zf=({buyer:s,onShowPropertyMatch:a,onShowPropertySuggestions:t,onScheduleVisit:r,onVisitClick:i,onDetailsClick:n})=>{const[o,m]=l.useState([]),[g,b]=l.useState(!1),[d,v]=l.useState(null),[x,u]=l.useState(new Set),[c,f]=l.useState(new Set),[p,N]=l.useState(!1),[P,w]=l.useState({}),[$,y]=l.useState(null),[k,R]=l.useState(!1),F=_=>Array.isArray(_)?_.filter(Boolean):_?[_]:[],T=_=>String(_||"").toLowerCase().trim(),j=(_,ae)=>ae.some(ke=>_.some(Me=>Me.includes(ke))),E=(s==null?void 0:s.requirements)||{},V=F(E.unitTypes).map(T),W=F(E.preferredLocations).map(T),B=F(E.amenities).map(T),M=T(E.facing),A=T(E.floor),L=T(E.furnishing),D=T(E.possession),I=T(E.propertyType),H=T(E.specialRequirements||"").split(/\s+/).filter(Boolean),Y=(()=>{var ke,Me;const _=Number(((ke=s==null?void 0:s.budget)==null?void 0:ke.min)??(s==null?void 0:s.budgetMin)??(s==null?void 0:s.minBudget)??0),ae=Number(((Me=s==null?void 0:s.budget)==null?void 0:Me.max)??(s==null?void 0:s.budgetMax)??(s==null?void 0:s.maxBudget)??0);return{min:_,max:ae}})(),K=V.length>0||W.length>0||B.length>0||!!M||!!A||!!L||!!D||!!I||H.length>0||Y.min>0||Y.max>0;l.useEffect(()=>{let _=!0;return(async()=>{var ae,ke;b(!0),v(null);try{const Me=await As.getProperties(),ie=(((Array.isArray(Me==null?void 0:Me.data)?Me==null?void 0:Me.data:null)??(Array.isArray(Me)?Me:null)??(Array.isArray((ae=Me==null?void 0:Me.data)==null?void 0:ae.rows)?(ke=Me==null?void 0:Me.data)==null?void 0:ke.rows:[]))||[]).filter(we=>!!((we==null?void 0:we.is_public)===!0||(we==null?void 0:we.is_public)===1||(we==null?void 0:we.isPublic)===!0||(we==null?void 0:we.public)===!0||(we==null?void 0:we.visibility)==="public"));_&&m(ie??[])}catch(Me){console.error(Me),Z.error("Could not load properties"),_&&(m([]),v("Could not load properties"))}finally{_&&b(!1)}})(),()=>{_=!1}},[]),l.useEffect(()=>{let _=!0;return(async()=>{R(!0),y(null);try{const ae=await Qt.getAll();if(!_)return;const ke={};for(const Me of ae){const Ye=String(Me.property_id);ke[Ye]=Array.isArray(Me.tags)?Me.tags.filter(Boolean):[]}w(ke)}catch(ae){console.error("Tags load error:",ae),y("Could not load property tags")}finally{_&&R(!1)}})(),()=>{_=!1}},[]);const q=_=>{const ae=Number(_);return!ae||Number.isNaN(ae)?"â‚¹â€”":ae>=1e7?`â‚¹${(ae/1e7).toFixed(1)}Cr`:ae>=1e5?`â‚¹${(ae/1e5).toFixed(1)}L`:`â‚¹${ae.toLocaleString("en-IN")}`},ne=_=>T((_==null?void 0:_.unit_type)||(_==null?void 0:_.bhk)||(_==null?void 0:_.configuration)),le=_=>[T(_==null?void 0:_.locality_name),T(_==null?void 0:_.location_name),T(_==null?void 0:_.address),T((_==null?void 0:_.city_name)||(_==null?void 0:_.city))].filter(Boolean),S=_=>(Array.isArray(_==null?void 0:_.amenities)?_.amenities:[]).map(T),C=_=>T((_==null?void 0:_.furnishing)||(_==null?void 0:_.furnished_status)),J=_=>T((_==null?void 0:_.property_subtype_name)||(_==null?void 0:_.property_type_name)||""),ue=_=>T((_==null?void 0:_.description)||(_==null?void 0:_.title)||""),Q=_=>_>=90?"text-green-700 bg-green-100":_>=80?"text-blue-700 bg-blue-100":_>=70?"text-orange-700 bg-orange-100":"text-red-700 bg-red-100",he=_=>{const ke={Available:"bg-emerald-100 text-emerald-700",Sold:"bg-red-100 text-red-700","Under Negotiation":"bg-amber-100 text-amber-700"}[_]||"bg-gray-100 text-gray-700";return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-medium ${ke}`,children:_||"Available"})},se=_=>{const ae=_!=null&&_.unit_type?String(_.unit_type).toUpperCase():"",ke=(_==null?void 0:_.society_name)||(_==null?void 0:_.location_name)||"",Me=(_==null?void 0:_.property_subtype_name)||(_==null?void 0:_.property_type_name)||"";return[[ae,Me].filter(Boolean).join(" ")||(_==null?void 0:_.title)||"Property",ke].filter(Boolean).join(" - ")},ge=_=>(_==null?void 0:_.address)||[(_==null?void 0:_.location_name)||(_==null?void 0:_.locality_name),(_==null?void 0:_.city_name)||(_==null?void 0:_.city)].filter(Boolean).join(", "),ee=_=>Number((_==null?void 0:_.budget)??(_==null?void 0:_.price)??(_==null?void 0:_.expected_price)??0),de=_=>{const ae=Number((_==null?void 0:_.min_price)??(_==null?void 0:_.budget_min)??(_==null?void 0:_.minBudget)??0),ke=Number((_==null?void 0:_.max_price)??(_==null?void 0:_.budget_max)??(_==null?void 0:_.maxBudget)??0);return{min:ae,max:ke}},U=_=>String((_==null?void 0:_.id)??(_==null?void 0:_.property_id)??""),X=_=>{const{min:ae,max:ke}=Y;if(ae===0&&ke===0)return!1;const{min:Me,max:Ye}=de(_),ie=Me>0&&Ye>0&&Ye>=Me,we=Number(ee(_))||0,Be=we>0;if(!ie&&!Be)return!1;const Ve=ae>0?ae:0,Je=ke>0?ke:Number.MAX_SAFE_INTEGER;return ie?Math.max(Me,Ve)<=Math.min(Ye,Je):Be?(Ve===0||we>=Ve)&&(Je===Number.MAX_SAFE_INTEGER||we<=Je):!1},re=_=>(_==null?void 0:_.seller_name)||(_==null?void 0:_.owner_name)||(_==null?void 0:_.contact_name)||"â€”",fe=_=>(_==null?void 0:_.seller_phone)||(_==null?void 0:_.owner_phone)||(_==null?void 0:_.contact_phone)||(_==null?void 0:_.phone)||"",G=_=>{const ae=(_==null?void 0:_.unit_type)||"",ke=Number((_==null?void 0:_.carpet_area)??(_==null?void 0:_.area)??(_==null?void 0:_.super_builtup_area)??0),Me=ke?`${Number(ke).toLocaleString("en-IN")} sq ft`:"";return[ae,Me].filter(Boolean).join(" â€¢ ")},me=_=>{const ae=(_==null?void 0:_.floor)||"",ke=_!=null&&_.total_floors?`of ${_.total_floors}`:"";return[ae&&`Floor ${ae}`,ke].filter(Boolean).join(" ")},oe=_=>(_==null?void 0:_.facing)||(_==null?void 0:_.facing_name)||(_==null?void 0:_.facing_type)||(_==null?void 0:_.direction)||(_==null?void 0:_.direction_name)||(_==null?void 0:_.orientation)||(_==null?void 0:_.property_facing)||(_==null?void 0:_.property_facing_name)||"â€”",Fe=_=>{const ae=_!=null&&_.parking_qty?String(_.parking_qty):"",ke=(_==null?void 0:_.parking_type)||"";return[ae,ke].filter(Boolean).join(" ")},$e=_=>{const ae=Number(_==null?void 0:_.possession_year),ke=Number(_==null?void 0:_.possession_month);if(ae&&ke){const Me=new Date(ae,ke-1,1);return Me<=new Date?"Ready to Move":Me.toLocaleString("en-IN",{month:"short",year:"numeric"})}return(_==null?void 0:_.status)==="Available"?"Ready to Move":(_==null?void 0:_.status)||"â€”"},Le=_=>{const ae=[],ke=ee(_),Me=Y.min,Ye=Y.max;ke&&(Me||Ye)&&((!Me||ke>=Me)&&(!Ye||ke<=Ye)?ae.push("ðŸ’° Perfect budget match"):Me&&Ye&&ke>=Me*.9&&ke<=Ye*1.1&&ae.push("ðŸ’¸ Near your budget"));const ie=ne(_);V.length&&ie&&V.includes(ie)&&ae.push(`ðŸ›ï¸ ${ie.toUpperCase()} as preferred`),(W.length?j(le(_),W):!1)&&ae.push("ðŸ“ Preferred location");const Be=S(_);if(B.length&&Be.length){const ms=B.filter(cs=>Be.includes(cs));ms.length&&ae.push(`ðŸ—ï¸ Amenities matched (${ms.slice(0,3).join(", ")})`)}const Ve=T(oe(_));M&&Ve&&Ve===M&&ae.push(`ðŸ§­ ${M} facing`);const Je=C(_);L&&Je&&Je===L&&ae.push(`ðŸ›‹ï¸ ${L}`);const Ue=T($e(_));D&&Ue&&Ue.includes(D)&&ae.push(`ðŸ—“ï¸ ${D}`);const Oe=J(_);I&&Oe&&Oe.includes(I)&&ae.push(`ðŸ¢ ${I} type`);const rs=T((_==null?void 0:_.floor)||"");if(A&&(A.includes("ground")&&(rs.includes("ground")||rs==="0")&&ae.push("ðŸ  Ground floor"),A.includes("higher")&&/\d+/.test(rs)&&Number(rs)>=7&&ae.push("â¬†ï¸ Higher floor"),A.includes("lower")&&/\d+/.test(rs)&&Number(rs)<=3&&ae.push("â¬‡ï¸ Lower floor")),H.length){const ms=ue(_)+" "+S(_).join(" "),cs=H.filter(gs=>ms.includes(gs)).slice(0,3);cs.length&&ae.push(`âœ¨ Matches: ${cs.join(", ")}`)}return ae},je=_=>{if(!K)return 0;let ae=0;const ke=ee(_),Me=Y.min,Ye=Y.max;if(ke&&(Me||Ye)&&((!Me||ke>=Me)&&(!Ye||ke<=Ye)?ae+=25:Me&&Ye&&ke>=Me*.9&&ke<=Ye*1.1?ae+=15:ae+=5),W.length&&j(le(_),W)&&(ae+=20),V.length&&V.includes(ne(_))&&(ae+=15),B.length){const we=B.filter(Be=>S(_).includes(Be)).length;we>=3?ae+=15:we===2?ae+=10:we===1&&(ae+=6)}M&&T(oe(_))===M&&(ae+=8),L&&C(_)===L&&(ae+=6),D&&T($e(_)).includes(D)&&(ae+=6),I&&J(_).includes(I)&&(ae+=3);const ie=T((_==null?void 0:_.floor)||"");if(A&&(A.includes("ground")&&(ie.includes("ground")||ie==="0")||A.includes("higher")&&/\d+/.test(ie)&&Number(ie)>=7||A.includes("lower")&&/\d+/.test(ie)&&Number(ie)<=3)&&(ae+=2),H.length){const we=ue(_)+" "+S(_).join(" "),Be=H.filter(Ve=>we.includes(Ve)).length;ae+=Math.min(5,Be*2)}return Math.max(0,Math.min(100,Math.round(ae)))},_e=_=>{const ae=Array.isArray(_==null?void 0:_.photos)&&_.photos.length?_.photos[0]:"";return typeof ae=="string"?ae:(ae==null?void 0:ae.url)||""},ve=_=>{const ae=U(_);return ae?P[ae]??[]:[]},Pe=l.useMemo(()=>K?o.filter(X).map(ae=>{const ke=je(ae),Me=Le(ae);return{id:U(ae)||String(Math.random()),title:se(ae),address:ge(ae),price:ee(ae),size:G(ae),floorLine:me(ae),facing:oe(ae),parking:Fe(ae),possession:$e(ae),amenities:(ae==null?void 0:ae.amenities)||[],seller:re(ae),sellerPhone:fe(ae),statusText:(ae==null?void 0:ae.status)||"Available",matchScore:ke,photo:_e(ae),tags:ve(ae),_raw:ae,reasons:Me}}).filter(ae=>ae.matchScore>0):[],[o,Y.min,Y.max,K,P]),We=o.length>0,pe=Pe.length>0,O=!g&&!d&&We&&!pe,Ie=!g&&!d&&pe,ze=!g&&!d&&!We,xe=l.useMemo(()=>Pe.filter(_=>c.has(_.id)),[Pe,c]),Ee=l.useMemo(()=>xe.map(_=>_._raw),[xe]),Ke=_=>{u(ae=>{const ke=new Set(ae);return ke.has(_)?ke.delete(_):ke.add(_),ke})},Xe=_=>{f(ae=>{const ke=new Set(ae);return ke.has(_)?ke.delete(_):ke.add(_),ke})},ye=(_,ae,ke)=>{const Me=(ae||"").replace(/\D/g,"");if(!Me)return;const Ye=`Hi ${_||"there"}, I'd like to discuss your property: ${ke}.`;window.open(`https://wa.me/${Me}?text=${encodeURIComponent(Ye)}`,"_blank")},Ce=({label:_})=>{const ae=Ea(_),ke=typeof ae.emoji=="function"?ae.emoji:null,Me=typeof ae.emoji=="string"?ae.emoji:null;return e.jsxs("span",{className:["inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[10px] leading-none ring-1",ae.bg,ae.text,ae.ring].join(" "),title:_,children:[Me?e.jsx("span",{children:Me}):null,ke?e.jsx(ke,{size:12}):null,e.jsx("span",{className:"font-medium",children:_})]})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[e.jsxs("button",{onClick:a,className:"flex items-center space-x-1.5 px-3 py-1.5 md:px-4 md:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(rt,{size:14}),e.jsx("span",{children:"Find Matching Properties"})]}),c.size>0&&e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 md:px-4 md:py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-xs",children:["Share (",c.size,")"]})]}),(g||k)&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center text-sm text-gray-600",children:["Loading ",g?"properties":"tags","â€¦"]}),d&&!g&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-red-200 p-6 text-center text-sm text-red-600",children:d}),$&&!k&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-amber-200 p-6 text-center text-sm text-amber-700",children:$}),!g&&!d&&We&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:Ie?`Showing ${Pe.length} public ${Pe.length===1?"property":"properties"} matching your criteria`:`Showing ${o.length} public ${o.length===1?"property":"properties"}`}),e.jsx("span",{className:"text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:"ðŸ”“ Public listings only"})]})}),Ie&&e.jsx("div",{className:"space-y-3",children:Pe.map(_=>{var ae;return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",className:"mt-2 accent-blue-600",checked:c.has(_.id),onChange:()=>Xe(_.id)}),e.jsx("div",{className:"w-28 h-20 rounded-lg overflow-hidden bg-gray-100 flex-none",children:_.photo?e.jsx("img",{src:_.photo,alt:_.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs",children:"No Image"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:_.title}),Array.isArray(_.tags)&&_.tags.length>0&&e.jsxs("div",{className:"mt-1 flex flex-wrap gap-1",children:[_.tags.slice(0,6).map((ke,Me)=>e.jsx(Ce,{label:ke},`${_.id}-tag-${Me}-${ke}`)),_.tags.length>6&&e.jsxs("span",{className:"px-2 py-0.5 rounded-full text-[10px] bg-gray-100 text-gray-600",children:["+",_.tags.length-6," more"]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mt-1 text-xs",children:[e.jsx(Qs,{size:12}),e.jsx("span",{children:_.address||"â€”"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[11px] font-semibold ${Q(_.matchScore)}`,children:[_.matchScore,"% Match"]}),he(_.statusText),x.has(_.id)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-medium bg-purple-100 text-purple-700",children:"â­ Shortlisted"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-medium bg-green-100 text-green-700",children:"ðŸ”“ Public"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-base font-bold text-green-600",children:q(_.price)}),e.jsx("div",{className:"text-[11px] text-gray-500",children:_.size})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-1 mt-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Floor:"})," ",e.jsx("span",{className:"font-semibold",children:_.floorLine||"â€”"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Facing:"})," ",e.jsx("span",{className:"font-semibold",children:_.facing})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Parking:"})," ",e.jsx("span",{className:"font-semibold",children:_.parking||"â€”"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Possession:"})," ",e.jsx("span",{className:"font-semibold",children:_.possession})]})]}),((ae=_.reasons)==null?void 0:ae.length)>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Why it matches:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:_.reasons.slice(0,4).map((ke,Me)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-medium bg-blue-50 text-blue-600",children:ke},`${ke}-${Me}`))})]}),Array.isArray(_.amenities)&&_.amenities.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Amenities:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[_.amenities.slice(0,6).map((ke,Me)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] bg-gray-100 text-gray-700",children:ke},`${ke}-${Me}`)),_.amenities.length>6&&e.jsxs("span",{className:"px-2 py-0.5 rounded-full text-[11px] bg-gray-100 text-gray-500",children:["+",_.amenities.length-6," more"]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-700",children:[e.jsx("span",{className:"text-gray-500",children:"Seller: "}),e.jsx("span",{className:"font-medium",children:_.seller}),e.jsx("span",{className:"mx-2 text-gray-400",children:"|"}),e.jsx("span",{className:"text-gray-500",children:"Contact: "}),e.jsx("span",{className:"font-medium",children:_.sellerPhone||"â€”"})]}),_.sellerPhone&&e.jsxs("button",{className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg bg-emerald-50 text-emerald-700 text-xs hover:bg-emerald-100",onClick:()=>ye(_.seller,_.sellerPhone,_.title),children:[e.jsx(tt,{size:14})," Contact"]})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",onClick:()=>i==null?void 0:i(_),children:[e.jsx(Ts,{size:14}),e.jsx("span",{children:"Visit"})]}),e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-xs",onClick:()=>Ke(_.id),children:[e.jsx(Ra,{size:12}),e.jsx("span",{children:x.has(_.id)?"Shortlisted":"Shortlist"})]}),e.jsx("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-gray-200 text-gray-700 rounded-lg text-xs",onClick:()=>n==null?void 0:n(_),disabled:!n,title:n?"Details":"Wire a details handler to enable",children:"Details"}),_.sellerPhone&&e.jsxs("a",{href:`tel:${_.sellerPhone}`,className:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition-colors text-xs",children:[e.jsx(Cs,{size:14}),e.jsx("span",{children:"Call"})]})]})]})]})},_.id)})}),ze&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(Is,{className:"mx-auto text-gray-300 mb-3",size:48}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"No Public Properties Found"}),e.jsx("p",{className:"text-gray-500 text-xs mb-4",children:"We don't have any public listings right now. Try again later or view private matches."}),e.jsx("div",{className:"flex items-center justify-center space-x-2",children:e.jsxs("button",{onClick:a,className:"flex items-center space-x-1.5 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(rt,{size:14}),e.jsx("span",{children:"Find Properties"})]})})]}),O&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-amber-200 p-8 text-center",children:[e.jsx(Is,{className:"mx-auto text-amber-300 mb-3",size:48}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"No Properties Matched Your Criteria"}),e.jsxs("p",{className:"text-gray-500 text-xs mb-4",children:["We found ",o.length," public ",o.length===1?"property":"properties",", but none match your budget or requirements. Try adding a budget or broadening your filters."]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:a,className:"flex items-center space-x-1.5 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(rt,{size:14}),e.jsx("span",{children:"Find Matching Properties"})]}),e.jsx("button",{onClick:t,className:"flex items-center space-x-1.5 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-xs",children:e.jsx("span",{children:"Show Suggestions"})})]})]})]}),p&&e.jsx(Qf,{isOpen:p,onClose:()=>N(!1),selectedProperties:Ee,buyer:s})]})},Xf=({buyer:s,onUpdateBuyer:a,setActiveTab:t})=>{var i,n,o,m,g,b,d,v,x,u;const r=c=>c>=1e7?`â‚¹${(c/1e7).toFixed(1)}Cr`:c>=1e5?`â‚¹${(c/1e5).toFixed(1)}L`:`â‚¹${c.toLocaleString("en-IN")}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-xs",children:"Lead Score"}),e.jsx("p",{className:"text-xs font-bold",children:s.leadScore})]}),e.jsx(Xs,{size:24,className:"text-purple-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"Properties Matched"}),e.jsx("p",{className:"text-xs font-bold",children:((i=s.matchedProperties)==null?void 0:i.length)||0})]}),e.jsx(Is,{size:24,className:"text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Total Visits"}),e.jsx("p",{className:"text-xs font-bold",children:s.visits||0})]}),e.jsx(ks,{size:24,className:"text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-xs",children:"Response Rate"}),e.jsxs("p",{className:"text-xs font-bold",children:[s.responseRate||80,"%"]})]}),e.jsx(Rs,{size:24,className:"text-orange-200"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ms,{className:"mr-2 text-gray-500",size:16}),"Contact Information"]}),e.jsxs("div",{className:"space-y-2 text-xs grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{className:"text-gray-400",size:14}),e.jsx("span",{className:"font-medium",children:s.phone}),e.jsx("button",{onClick:()=>window.open(`tel:${s.phone}`),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(Cs,{size:12})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Nm,{className:"text-gray-400",size:14}),e.jsx("span",{className:"font-medium",children:s.whatsapp||s.phone}),e.jsx("button",{onClick:()=>{const c=`Hi ${s.name}, this is regarding your property requirements.`;window.open(`https://wa.me/${s.phone.replace(/\D/g,"")}?text=${encodeURIComponent(c)}`,"_blank")},className:"p-1 text-green-600 hover:bg-green-100 rounded",children:e.jsx(Nm,{size:12})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"text-gray-400",size:14}),e.jsx("span",{className:"font-medium",children:s.email}),e.jsx("button",{onClick:()=>window.open(`mailto:${s.email}`),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(Ds,{size:12})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qs,{className:"text-gray-400",size:14}),e.jsxs("span",{className:"text-gray-700",children:[s.location,", ",s.city,", ",s.state]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(ka,{className:"mr-2 text-gray-500",size:16}),"Budget & Requirements"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Budget Range:"}),e.jsxs("div",{className:"font-bold text-green-600 text-sm mt-1",children:[r(s.budget.min)," - ",r(s.budget.max)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Possession:"}),e.jsx("div",{className:"font-medium mt-1",children:((n=s.requirements)==null?void 0:n.possession)||"â€”"}),e.jsx("div",{className:"text-gray-500 mt-2",children:"Furnishing:"}),e.jsx("div",{className:"font-medium mt-1",children:((o=s.requirements)==null?void 0:o.furnishing)||"â€”"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Preferred Units"}),e.jsx("div",{className:"font-medium mt-1",children:Array.isArray((m=s.requirements)==null?void 0:m.unitTypes)?s.requirements.unitTypes.join(", "):((g=s.requirements)==null?void 0:g.unitTypes)||"â€”"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Preferred Locations:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Array.isArray((b=s.requirements)==null?void 0:b.preferredLocations)&&s.requirements.preferredLocations.length>0?s.requirements.preferredLocations.map((c,f)=>e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full text-[10px] font-medium",children:c},f)):e.jsx("span",{className:"font-medium",children:"â€”"})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Buyer Journey Progress"}),e.jsxs("div",{className:"space-y-3 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Overall Progress"}),e.jsxs("span",{className:"font-bold text-purple-600",children:[s.stageProgress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-500",style:{width:`${s.stageProgress||0}%`}})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mt-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-bold text-blue-600",children:((d=s.activities)==null?void 0:d.length)||0}),e.jsx("div",{className:"text-[10px] text-gray-600",children:"Activities"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-bold text-green-600",children:s.visits||0}),e.jsx("div",{className:"text-[10px] text-gray-600",children:"Property Visits"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-bold text-purple-600",children:((v=s.matchedProperties)==null?void 0:v.length)||0}),e.jsx("div",{className:"text-[10px] text-gray-600",children:"Matched Properties"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm font-bold text-orange-600",children:[s.responseRate||80,"%"]}),e.jsx("div",{className:"text-[10px] text-gray-600",children:"Response Rate"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Recent Activities"}),e.jsx("button",{onClick:()=>t==null?void 0:t("activities"),className:"text-purple-600 hover:text-purple-800 text-xs font-medium",children:"View All"})]}),((x=s.activities)==null?void 0:x.length)>0?e.jsx("div",{className:"space-y-2",children:s.activities.slice(0,3).map(c=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(jt,{className:"text-blue-600",size:14})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-800 text-xs",children:c.description}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:[c.date," â€¢ ",c.time]})]}),e.jsx("div",{className:"text-[10px] text-gray-400",children:c.duration})]},c.id))}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(jt,{className:"mx-auto text-gray-300 mb-3",size:36}),e.jsx("p",{className:"text-gray-500 text-xs",children:"No activities recorded yet"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Upcoming Follow-ups"}),e.jsx("button",{onClick:()=>t==null?void 0:t("followups"),className:"text-purple-600 hover:text-purple-800 text-xs font-medium",children:"View All"})]}),((u=s.followups)==null?void 0:u.filter(c=>c.status==="pending").length)>0?e.jsx("div",{className:"space-y-2",children:s.followups.filter(c=>c.status==="pending").slice(0,3).map(c=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{className:"text-yellow-600",size:14}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 text-xs",children:c.description}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:[c.date," â€¢ ",c.time]})]})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium ${c.priority==="high"?"bg-red-100 text-red-700":c.priority==="medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:c.priority})]},c.id))}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Ts,{className:"mx-auto text-gray-300 mb-3",size:36}),e.jsx("p",{className:"text-gray-500 text-xs",children:"No pending follow-ups"})]})]})]})},Nm=({className:s,size:a})=>e.jsx("svg",{width:a||16,height:a||16,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:e.jsx("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),Dn=s=>{const a=(s==null?void 0:s.visit_datetime)??(s==null?void 0:s.revisit_datetime)??(s==null?void 0:s.date);if(a){const i=new Date(a);if(!isNaN(+i))return i}const t=(s==null?void 0:s.visit_date)??(s==null?void 0:s.revisit_date),r=(s==null?void 0:s.visit_time)??(s==null?void 0:s.time)??(s==null?void 0:s.revisit_time);if(t){const i=new Date(t);if(!isNaN(+i)){if(r){const[n="00",o="00",m="00"]=String(r).split(":");i.setHours(Number(n),Number(o),Number(m)||0,0)}return i}}return null},wm=s=>s?s.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"-",_m=s=>s?s.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}):"-",xi=s=>{if(!s)return"-";const a=new Date(s);return isNaN(+a)?"-":`${a.toLocaleDateString("en-IN",{day:"2-digit",month:"short"})}, ${a.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0})}`},Fo=s=>{const a=new Date,t=Dn(s);if((s==null?void 0:s.status)==="cancelled")return"cancelled";if(["completed","done"].includes(s==null?void 0:s.status))return"completed";if(t){if(t.getTime()<a.getTime())return"completed";if(t.toDateString()===a.toDateString())return"today"}return"scheduled"},Sm=({status:s})=>{const a={scheduled:"bg-blue-50 text-blue-700 border-blue-200",today:"bg-green-50 text-green-700 border-green-200",completed:"bg-gray-50 text-gray-600 border-gray-200",cancelled:"bg-red-50 text-red-700 border-red-200"},t={scheduled:"Scheduled",today:"Today",completed:"Completed",cancelled:"Cancelled"};return e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-[10px] font-medium border ${a[s]||a.scheduled}`,children:t[s]||"Scheduled"})},ey=({items:s})=>{let a=[];if(Array.isArray(s))a=s.map(String);else if(s&&typeof s=="string")try{const t=JSON.parse(s);a=Array.isArray(t)?t:[s]}catch{a=[s]}return a.length?e.jsx("div",{className:"flex flex-wrap gap-1",children:a.map((t,r)=>e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-purple-50 text-purple-700 border border-purple-100",children:t},r))}):null},km=s=>{if(s!=null){if(typeof s=="boolean")return s;if(typeof s=="number")return s===1;if(typeof s=="string")return s==="1"||s.toLowerCase()==="true"}},Bo=s=>s?s.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"",Cm=(s,a)=>{const t=(s==null?void 0:s.executive_full_name)||(s==null?void 0:s.executive_name)||(s==null?void 0:s.assigned_to_name)||(s==null?void 0:s.executive);if(t)return String(t);const r=(s==null?void 0:s.executive_id)??(s==null?void 0:s.assigned_to);return r==null?"":(a==null?void 0:a(r))||`Executive #${r}`},Am=s=>({name:(s==null?void 0:s.buyer_full_name)??(s==null?void 0:s.buyer_name)??(s==null?void 0:s.buyer),email:s==null?void 0:s.buyer_email,phone:(s==null?void 0:s.buyer_phone)??(s==null?void 0:s.buyer_mobile)??(s==null?void 0:s.buyer_contact)}),Pm=s=>({name:(s==null?void 0:s.seller_full_name)??(s==null?void 0:s.seller_name),email:s==null?void 0:s.seller_email,phone:s==null?void 0:s.seller_phone}),Tm=s=>({name:(s==null?void 0:s.executive_full_name)??(s==null?void 0:s.executive_name),email:s==null?void 0:s.executive_email,phone:s==null?void 0:s.executive_phone}),zl=({tone:s,title:a,name:t,phone:r,email:i,extra:n})=>{const o={blue:{bg:"bg-blue-50",border:"border-blue-100",text:"text-blue-600",icon:"text-blue-600"},green:{bg:"bg-green-50",border:"border-green-100",text:"text-green-600",icon:"text-green-600"},violet:{bg:"bg-violet-50",border:"border-violet-100",text:"text-violet-600",icon:"text-violet-600"}}[s];return!t&&!r&&!i&&!n?null:e.jsxs("div",{className:`flex items-start gap-2 p-2 rounded-lg border ${o.bg} ${o.border}`,children:[e.jsx(Ms,{size:16,className:`${o.icon} mt-0.5`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-[10px] font-medium mb-0.5 ${o.text}`,children:a}),t&&e.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:t}),(r||i)&&e.jsxs("div",{className:"mt-0.5 flex items-center gap-2 text-[12px] text-gray-600 flex-wrap",children:[r&&e.jsxs("a",{href:`tel:${r}`,className:"inline-flex items-center gap-1 hover:underline",children:[e.jsx(Cs,{size:12}),e.jsx("span",{className:"truncate",children:r})]}),i&&e.jsxs("a",{href:`mailto:${i}`,className:"inline-flex items-center gap-1 hover:underline",children:[e.jsx(Ds,{size:12}),e.jsx("span",{className:"truncate",children:i})]})]}),n]})]})},sy=({buyer:s,onAddVisit:a,onEditVisit:t,onDeleteVisit:r,resolveExecutiveName:i})=>{const[n,o]=l.useState("visits"),m=(s==null?void 0:s.buyer_id)??(s==null?void 0:s.id),[g,b]=l.useState([]),[d,v]=l.useState(!1),[x,u]=l.useState(null),[c,f]=l.useState([]),[p,N]=l.useState(!1),P=async()=>{if(m){v(!0),u(null);try{const y=await or.getAllVisits({buyer_id:m,page:1,limit:50}),k=(y==null?void 0:y.data)??(y==null?void 0:y.rows)??[];b(k)}catch(y){u((y==null?void 0:y.message)||"Failed to load visits")}finally{v(!1)}}},w=async()=>{if(!g.length){f([]);return}N(!0);try{const y=[];await Promise.all(g.map(async k=>{try{const R=await or.getRevisitsByVisit(k.id),F=(R==null?void 0:R.data)??(R==null?void 0:R.rows)??[];F.forEach(T=>{T.property_title=T.property_title||k.property_title,T.visit_id=T.visit_id||k.id,T.seller_full_name=T.seller_full_name||k.seller_full_name||k.seller_name,T.seller_phone=T.seller_phone||k.seller_phone,T.executive_full_name=T.executive_full_name||k.executive_full_name||k.executive_name,T.executive_phone=T.executive_phone||k.executive_phone,T.buyer_full_name=T.buyer_full_name||k.buyer_full_name||k.buyer_name,T.buyer_phone=T.buyer_phone||k.buyer_phone}),y.push(...F)}catch{}})),f(y.sort((k,R)=>{var F,T;return(((F=Dn(R))==null?void 0:F.getTime())??0)-(((T=Dn(k))==null?void 0:T.getTime())??0)}))}catch(y){console.error(y)}finally{N(!1)}};l.useEffect(()=>{m?P():(b([]),f([]))},[m]),l.useEffect(()=>{w()},[g]);const $=l.useMemo(()=>{const y={total:g.length,completed:0,upcoming:0,today:0};return g.forEach(k=>{const R=Fo(k);R==="completed"?y.completed++:R==="today"?y.today++:y.upcoming++}),y},[g]);return m?e.jsx("div",{className:"",children:e.jsxs("div",{className:"space-y-4 mb-10 px-6",children:[e.jsxs("div",{className:"flex items-center justify-between ",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Visit Schedule"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Manage property visits & follow-ups"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:P,className:"px-3 py-1.5 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-all flex items-center gap-1.5 text-gray-700 text-sm",children:[e.jsx(na,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),e.jsxs("button",{onClick:a,className:"px-3 py-1.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all flex items-center gap-1.5 text-sm",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Schedule"})]})]})]}),g.length>0&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700 leading-none",children:$.total}),e.jsx("div",{className:"text-xs text-blue-700 mt-0.5",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700 leading-none",children:$.completed}),e.jsx("div",{className:"text-xs text-green-700 mt-0.5",children:"Completed"})]}),e.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg border border-orange-200",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-700 leading-none",children:$.today}),e.jsx("div",{className:"text-xs text-orange-700 mt-0.5",children:"Today"})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-700 leading-none",children:$.upcoming}),e.jsx("div",{className:"text-xs text-purple-700 mt-0.5",children:"Upcoming"})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex gap-6",children:[e.jsxs("button",{onClick:()=>o("visits"),className:`pb-2 px-1 border-b-2 font-medium text-sm transition-colors ${n==="visits"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Visits (",$.total,")"]}),e.jsxs("button",{onClick:()=>o("revisits"),className:`pb-2 px-1 border-b-2 font-medium text-sm transition-colors ${n==="revisits"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Revisits (",c.length,")"]})]})}),n==="visits"&&e.jsxs("div",{className:"space-y-3",children:[d&&e.jsx("div",{className:"text-center py-6 text-gray-600 text-sm",children:"Loading visits..."}),x&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:x}),!d&&!g.length?e.jsxs("div",{className:"text-center py-10 bg-white rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx(Ts,{size:40,className:"mx-auto text-gray-300 mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"No Visits Scheduled"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-md mx-auto",children:"Start by scheduling your first property visit."}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:"Schedule First Visit"})]}):g.map(y=>{var B,M;const k=Fo(y),R=Dn(y),F=y.property_title||"Untitled Property",T=km(y.seller_present),j=Am(y),E=Pm(y),V=Tm(y),W=Cm({executive_full_name:V.name,executive_id:y.executive_id},i);return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 hover:shadow-md transition-all duration-150",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 truncate",children:F}),e.jsx(Sm,{status:k}),y.revisit_count>0&&e.jsxs("span",{className:"px-1.5 py-0.5 bg-purple-100 text-purple-700 rounded-full text-[10px] font-medium inline-flex items-center gap-1",children:[e.jsx(Rs,{size:12}),y.revisit_count," Revisit",y.revisit_count>1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] text-gray-500 mt-0.5 flex-wrap",children:[e.jsxs("span",{children:["Visit #",y.id]}),y.visit_type&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:Bo(y.visit_type)})]}),y.status&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:Bo(y.status)})]})]})]}),e.jsxs("div",{className:"flex gap-1.5 shrink-0",children:[e.jsx("button",{onClick:()=>t(y),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:"Edit visit",children:e.jsx(ft,{size:16})}),e.jsx("button",{onClick:()=>r(y.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete visit",children:e.jsx(Es,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(Ts,{size:16,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"Date"}),e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:wm(R)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(Ls,{size:16,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"Time"}),e.jsxs("div",{className:"font-medium text-gray-900 text-sm",children:[_m(R),y.duration_minutes&&e.jsxs("span",{className:"text-[11px] text-gray-500 ml-1",children:["(",y.duration_minutes,"m)"]})]})]})]}),(y.meet_point||y.location)&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-md",children:[e.jsx(Qs,{size:16,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"Meet Point"}),e.jsx("div",{className:"font-medium text-gray-900 text-sm truncate max-w-[220px]",children:y.meet_point||y.location})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[e.jsx(zl,{tone:"violet",title:"BUYER",name:j.name,phone:j.phone,email:j.email}),e.jsx(zl,{tone:"blue",title:"SELLER",name:E.name,phone:E.phone,email:E.email,extra:km(y.seller_present)!==void 0&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[T?e.jsx($l,{size:12,className:"text-green-600"}):e.jsx(Ta,{size:12,className:"text-red-600"}),e.jsx("span",{className:"text-[11px] text-gray-600",children:T?"Will be present":"Not present"})]})}),e.jsx(zl,{tone:"green",title:"EXECUTIVE",name:W,phone:V.phone,email:V.email})]}),(((B=y.accompanied_by)==null?void 0:B.length)>0||y.rating||y.feedback||y.remarks)&&e.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-100",children:[((M=y.accompanied_by)==null?void 0:M.length)>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500 mb-1",children:"ACCOMPANIED BY"}),e.jsx(ey,{items:y.accompanied_by})]}),y.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xs,{size:14,className:"text-yellow-500 fill-yellow-500"}),e.jsxs("span",{className:"font-medium text-gray-900 text-sm",children:[y.rating,"/5"]})]}),y.feedback&&e.jsxs("div",{className:"p-2 bg-gray-50 rounded-md",children:[e.jsx("div",{className:"text-[10px] text-gray-500 mb-0.5",children:"FEEDBACK"}),e.jsx("p",{className:"text-sm text-gray-700",children:y.feedback})]}),y.remarks&&e.jsxs("div",{className:"p-2 bg-gray-50 rounded-md",children:[e.jsx("div",{className:"text-[10px] text-gray-500 mb-0.5",children:"REMARKS"}),e.jsx("p",{className:"text-sm text-gray-700",children:y.remarks})]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100 flex flex-wrap items-center gap-x-3 gap-y-1 text-[11px] text-gray-500",children:[e.jsxs("span",{children:["Created: ",e.jsx("span",{className:"text-gray-700",children:xi(y.created_at)})]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Updated: ",e.jsx("span",{className:"text-gray-700",children:xi(y.updated_at)})]})]})]},y.id)})]}),n==="revisits"&&e.jsxs("div",{className:"space-y-3",children:[p&&e.jsx("div",{className:"text-center py-6 text-gray-600 text-sm",children:"Loading revisits..."}),!p&&!c.length?e.jsxs("div",{className:"text-center py-10 bg-white rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx(Rs,{size:40,className:"mx-auto text-gray-300 mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"No Revisits Scheduled"}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto",children:"Revisits will appear here when scheduled from the visits tab."})]}):c.map(y=>{const k=Dn(y),R=Fo({status:y.status,visit_datetime:k==null?void 0:k.toISOString()}),F=Am(y),T=Pm(y),j=Tm(y),E=Cm({executive_full_name:j.name,executive_id:y.executive_id},i);return e.jsxs("div",{className:"bg-white border border-purple-200 rounded-lg p-3 hover:shadow-md transition-all duration-150",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 truncate",children:y.property_title||"Untitled"}),e.jsx(Sm,{status:R}),e.jsx("span",{className:"px-1.5 py-0.5 bg-purple-100 text-purple-700 rounded-full text-[10px] font-medium",children:"Revisit"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[11px] text-gray-500 mt-0.5 flex-wrap",children:[e.jsxs("span",{children:["Revisit #",y.id]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Original Visit #",y.visit_id]}),y.status&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:Bo(y.status)})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-purple-50 rounded-md",children:[e.jsx(Ts,{size:16,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-purple-600",children:"Date"}),e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:wm(k)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-purple-50 rounded-md",children:[e.jsx(Ls,{size:16,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-purple-600",children:"Time"}),e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:_m(k)})]})]}),(y.meet_point||y.location)&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-purple-50 rounded-md",children:[e.jsx(Qs,{size:16,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-purple-600",children:"Meet Point"}),e.jsx("div",{className:"font-medium text-gray-900 text-sm truncate max-w-[220px]",children:y.meet_point||y.location})]})]})]}),(F.name||T.name||E)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mt-2",children:[e.jsx(zl,{tone:"violet",title:"BUYER",name:F.name,phone:F.phone,email:F.email}),e.jsx(zl,{tone:"blue",title:"SELLER",name:T.name,phone:T.phone,email:T.email}),e.jsx(zl,{tone:"green",title:"EXECUTIVE",name:E,phone:j.phone,email:j.email})]}),y.remarks&&e.jsxs("div",{className:"mt-2 p-2 bg-gray-50 rounded-md",children:[e.jsx("div",{className:"text-[10px] text-gray-500 mb-0.5",children:"REMARKS"}),e.jsx("p",{className:"text-sm text-gray-700",children:y.remarks})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-purple-100 flex flex-wrap items-center gap-x-3 gap-y-1 text-[11px] text-gray-500",children:[e.jsxs("span",{children:["Created: ",e.jsx("span",{className:"text-gray-700",children:xi(y.created_at)})]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Updated: ",e.jsx("span",{className:"text-gray-700",children:xi(y.updated_at)})]})]})]},`revisit-${y.id}`)})]})]})}):e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm",children:e.jsx("p",{className:"text-red-700",children:"âš ï¸ Cannot load visits: buyer ID is missing."})})},ty=({buyer:s,onBack:a,onEdit:t,onAccount:r,onNext:i,onPrevious:n,currentIndex:o,totalBuyers:m,onUpdateBuyer:g})=>{const[b,d]=l.useState("overview"),[v,x]=l.useState(!1),[u,c]=l.useState(!1),[f,p]=l.useState(!1),[N,P]=l.useState(!1),[w,$]=l.useState(!1),[y,k]=l.useState(!1),[R,F]=l.useState(null),[T,j]=l.useState(null),[E,V]=l.useState(null),[W,B]=l.useState(!1),M=[{id:"overview",label:"Overview",icon:Ms},{id:"properties",label:"Matched Properties",icon:Is},{id:"visit-schedule",label:"Visit Schedule",icon:Ts},{id:"activities",label:"Activities",icon:jt},{id:"followups",label:"Follow-ups",icon:Ts},{id:"documents",label:"Documents",icon:ws},{id:"financial",label:"Financial",icon:Ut}],{user:A}=Hs();Ws(A,"followup.read");const L=Ws(A,"followup.create"),D=Ws(A,"followup.update");Ws(A,"followup.delete");const I=Ws(A,"buyer.update"),H=U=>U>=1e7?`â‚¹${(U/1e7).toFixed(1)}Cr`:U>=1e5?`â‚¹${(U/1e5).toFixed(1)}L`:`â‚¹${U.toLocaleString("en-IN")}`;l.useEffect(()=>{},[s]);const h=(U,X="text-xs")=>{const re={active:{bg:"bg-emerald-100",text:"text-emerald-700",label:"Active",icon:"ðŸŸ¢"},inactive:{bg:"bg-gray-100",text:"text-gray-600",label:"Inactive",icon:"âš«"},blocked:{bg:"bg-red-100",text:"text-red-700",label:"Blocked",icon:"ðŸ”´"}},fe=re[U]||re.active;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full ${X} ${fe.bg} ${fe.text}`,children:[fe.icon," ",fe.label]})},Y=U=>{const X={initial_contact:{bg:"bg-blue-100",text:"text-blue-700",label:"Initial Contact",icon:"ðŸ“ž"},requirement_gathering:{bg:"bg-purple-100",text:"text-purple-700",label:"Requirement Gathering",icon:"ðŸ“‹"},property_hunting:{bg:"bg-orange-100",text:"text-orange-700",label:"Property Hunting",icon:"ðŸ”"},loan_processing:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Loan Processing",icon:"ðŸ¦"},property_finalization:{bg:"bg-green-100",text:"text-green-700",label:"Property Finalization",icon:"âœ…"},deal_closure:{bg:"bg-indigo-100",text:"text-indigo-700",label:"Deal Closure",icon:"ðŸ¤"},completed:{bg:"bg-emerald-100",text:"text-emerald-700",label:"Completed",icon:"ðŸŽ‰"}},re=X[U]||X.initial_contact;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${re.bg} ${re.text}`,children:[re.icon," ",re.label]})},K=U=>{const X={high:{bg:"bg-red-100",text:"text-red-700",label:"High Priority",icon:"ðŸ”¥"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium Priority",icon:"âš¡"},low:{bg:"bg-green-100",text:"text-green-700",label:"Low Priority",icon:"ðŸŒ±"}},re=(U||"").toLowerCase().trim(),fe=X[re];return fe?e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${fe.bg} ${fe.text}`,children:[fe.icon," ",fe.label]}):e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:"âšª No Priority"})},q=U=>{const X=U>=80?"text-green-600":U>=60?"text-yellow-600":"text-red-600",re=U>=80?"bg-green-100":U>=60?"bg-yellow-100":"bg-red-100";return e.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full ${re} ${X} text-xs font-bold`,children:[e.jsx(Xs,{size:14,className:"mr-1"}),e.jsx("span",{children:U})]})},ne=()=>{F(null),x(!0)},le=U=>{F(U),x(!0)},S=U=>{const X={...s,activities:R?s.activities.map(re=>re.id===R.id?U:re):[...s.activities||[],U]};g(X),x(!1),F(null)},C=()=>{if(!L){Z.error("You do not have permission to create follow-ups");return}j(null),c(!0)},J=U=>{if(!D){Z.error("You do not have permission to edit follow-ups");return}j(U),c(!0)},ue=U=>{const X={...s,followups:T?(s.followups||[]).map(re=>re.id===T.id?U:re):[...s.followups||[],U]};g(X),c(!1),j(null)},Q=()=>{V(null),p(!0)},he=U=>{V(U),p(!0)},se=U=>{const X={id:Date.now()+1,type:"visit",description:`Property visit to ${U.property}`,date:U.date,time:U.time,duration:U.duration,stage:"property_hunting",outcome:U.outcome||"Property visit completed",nextAction:U.nextAction||"Follow up on feedback",executedBy:"Admin User",remarks:U.remarks,rating:U.rating||3},re={...s,activities:[...s.activities||[],X],visits:(s.visits||0)+1,lastActivity:U.date};g(re),p(!1),V(null)},ge=U=>{if(window.confirm("Are you sure you want to delete this visit?")){const X={...s,visits:s.visits.filter(re=>re.id!==U)};g(X),Z.success("Visit deleted successfully")}},ee=()=>{var fe,G,me,oe;const U=Array.isArray((fe=s.requirements)==null?void 0:fe.unitTypes)?s.requirements.unitTypes.join(", "):((G=s.requirements)==null?void 0:G.unitTypes)||"â€”",X=Array.isArray((me=s.requirements)==null?void 0:me.preferredLocations)?s.requirements.preferredLocations.join(", "):((oe=s.requirements)==null?void 0:oe.preferredLocations)||"â€”",re=`Hi ${s.name}, I have some property updates for you.
Your budget: ${H(s.budget.min)} - ${H(s.budget.max)}.
Preferred Units ${U} 
in ${X}.
Let me know when you're free to discuss.`;window.open(`https://wa.me/${(s.phone??"").replace(/\D/g,"")}?text=${encodeURIComponent(re)}`,"_blank")},de=()=>{var G,me,oe,Fe;const U=Array.isArray((G=s.requirements)==null?void 0:G.unitTypes)?s.requirements.unitTypes.join(", "):((me=s.requirements)==null?void 0:me.unitTypes)||"â€”",X=Array.isArray((oe=s.requirements)==null?void 0:oe.preferredLocations)?s.requirements.preferredLocations.join(", "):((Fe=s.requirements)==null?void 0:Fe.preferredLocations)||"â€”",re=`Property Updates for ${s.name}`,fe=`Dear ${s.name},

I hope this email finds you well.

I have some exciting property updates that match your requirements:

Budget: ${H(s.budget.min)} - ${H(s.budget.max)}
Preferred Units ${U}
Preferred locations: ${X}

Would you like to schedule a call to discuss these opportunities?

Best regards,
ResaleExpert Team`;window.open(`mailto:${s.email}?subject=${encodeURIComponent(re)}&body=${encodeURIComponent(fe)}`)};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 md:px-6 py-3 md:py-4 sticky top-0 z-50 text-xs",children:[e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap items-center space-x-2 md:space-x-4 mb-2 md:mb-0",children:[e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(ga,{size:20})}),e.jsxs("div",{className:"flex items-center space-x-2 md:space-x-4",children:[e.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 bg-gradient-to-r from-purple-500 to-pink-600 rounded-full flex items-center justify-center text-white text-lg md:text-xl font-bold",children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-base md:text-xl font-bold text-gray-900",children:[s.salutation," ",s.name]}),e.jsxs("div",{className:"flex text-xs flex-wrap items-center space-x-1 md:space-x-3 mt-1",children:[h(s.status),Y(s.stage),K(s.priority),q(s.leadScore)]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap md:flex-nowrap items-center space-x-1 md:space-x-3",children:[e.jsxs("div",{className:"text-[8px] text-gray-500 mb-1 md:mb-0",children:[o+1," of ",m]}),e.jsx("button",{onClick:n,disabled:o===0,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Wa,{size:16})}),e.jsx("button",{onClick:i,disabled:o===m-1,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:16})}),e.jsxs("button",{onClick:()=>r(s),className:"flex items-center space-x-1 md:space-x-2 px-3 md:px-4 py-1 md:py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(La,{size:16}),e.jsx("span",{children:"Buyer Account"})]}),e.jsxs("button",{onClick:()=>{if(!I){Z.error("You do not have permission to edit buyer");return}t(s)},className:"flex items-center space-x-1 md:space-x-2 px-3 md:px-4 py-1 md:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ft,{size:16}),e.jsx("span",{children:"Edit"})]})]})]}),e.jsx("div",{className:"mt-3 md:mt-4",children:e.jsx("nav",{className:"flex space-x-1 overflow-x-auto pb-1",children:M.map(U=>{const X=U.icon;return e.jsxs("button",{onClick:()=>d(U.id),className:`flex items-center space-x-1 md:space-x-2 px-3 py-1 md:px-4 md:py-2 rounded-lg transition-colors whitespace-nowrap text-xs ${b===U.id?"bg-purple-100 text-purple-700 border border-purple-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(X,{size:16}),e.jsx("span",{className:"font-medium",children:U.label})]},U.id)})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-6 pt-2 ",children:[b==="overview"&&e.jsx(Xf,{buyer:s,onUpdateBuyer:g}),b==="properties"&&e.jsx(Zf,{buyer:s,onShowPropertyMatch:()=>P(!0),onShowPropertySuggestions:()=>$(!0),onScheduleVisit:Q}),b==="activities"&&e.jsx(Jf,{buyer:s,onAddActivity:ne,onEditActivity:le}),b==="followups"&&e.jsx(ny,{buyer:s,onAddFollowup:C,onEditFollowup:J}),b==="documents"&&e.jsx(Gf,{buyer:s}),b==="financial"&&e.jsx(Kf,{buyer:s,onShowLoanApplication:()=>k(!0)})]}),e.jsx("div",{className:`\r
  bg-white border-t border-gray-200 \r
  px-2 sm:px-3 md:px-3 lg:px-4 \r
  py-2 sm:py-2.5 md:py-3 lg:py-4 \r
  fixed bottom-0 left-0 \r
  w-full \r
  lg:w-[calc(100%-335px)] lg:ml-[288px] \r
  z-50 shadow-lg\r
`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 text-[8px] sm:text-[10px] md:text-[10px] lg:text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 lg:gap-3 flex-wrap md:flex-wrap lg:flex-nowrap overflow-x-auto md:overflow-x-auto lg:overflow-visible whitespace-nowrap [-ms-overflow-style:none] [scrollbar-width:none]",children:[e.jsx("style",{children:".quickbar::-webkit-scrollbar{display:none}"}),e.jsxs("button",{onClick:ee,className:"flex items-center gap-1 px-2 md:px-2.5 lg:px-3 py-1.5 md:py-1.5 lg:py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(tt,{size:14,className:"md:size-[15px] lg:size-[16px]"}),e.jsx("span",{children:"WhatsApp"})]}),e.jsxs("button",{onClick:de,className:"flex items-center gap-1 px-2 md:px-2.5 lg:px-3 py-1.5 md:py-1.5 lg:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ds,{size:14,className:"md:size-[15px] lg:size-[16px]"}),e.jsx("span",{children:"Email"})]}),e.jsxs("button",{onClick:()=>window.open(`tel:${s.phone}`),className:"flex items-center gap-1 px-2 md:px-2.5 lg:px-3 py-1.5 md:py-1.5 lg:py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[e.jsx(Cs,{size:14,className:"md:size-[15px] lg:size-[16px]"}),e.jsx("span",{children:"Call"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 lg:gap-3 flex-wrap md:flex-wrap lg:flex-nowrap overflow-x-auto md:overflow-x-auto lg:overflow-visible whitespace-nowrap [-ms-overflow-style:none] [scrollbar-width:none]",children:[e.jsxs("button",{onClick:Q,className:"flex items-center gap-1 px-2 md:px-2.5 lg:px-3 py-1.5 md:py-1.5 lg:py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Ts,{size:14,className:"md:size-[15px] lg:size-[16px]"}),e.jsx("span",{children:"Schedule Visit"})]}),e.jsxs("button",{onClick:ne,className:"flex items-center gap-1 px-2 md:px-2.5 lg:px-3 py-1.5 md:py-1.5 lg:py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[e.jsx(fs,{size:14,className:"md:size-[15px] lg:size-[16px]"}),e.jsx("span",{children:"Add Activity"})]}),e.jsxs("button",{onClick:C,className:"flex items-center gap-1 px-2 md:px-2.5 lg:px-3 py-1.5 md:py-1.5 lg:py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(Ts,{size:14,className:"md:size-[15px] lg:size-[16px]"}),e.jsx("span",{children:"Schedule Follow-up"})]}),e.jsxs("button",{onClick:()=>$(!0),className:"flex items-center gap-1 px-2 md:px-2.5 lg:px-3 py-1.5 md:py-1.5 lg:py-2 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-lg hover:from-pink-600 hover:to-purple-700 transition-all",children:[e.jsx(Mt,{size:14,className:"md:size-[15px] lg:size-[16px]"}),e.jsx("span",{children:"AI Suggestions"})]})]})]})}),v&&e.jsx(Hu,{isOpen:v,onClose:()=>{x(!1),F(null)},activity:R,onSave:S}),u&&e.jsx(Yf,{isOpen:u,onClose:()=>{c(!1),j(null)},onSave:ue,tabId:"buyer",buyerId:(s==null?void 0:s.id)??(s==null?void 0:s.buyerId)??"",initialForm:T??void 0}),f&&e.jsx(od,{isOpen:f,onClose:()=>{p(!1),V(null)},visit:E,buyer:s,onSave:se}),N&&e.jsx(Ju,{isOpen:N,onClose:()=>P(!1),buyer:s}),w&&e.jsx(Zu,{isOpen:w,onClose:()=>$(!1),buyer:s}),y&&e.jsx(Xu,{isOpen:y,onClose:()=>k(!1),buyer:s,onUpdateBuyer:g}),b==="visit-schedule"&&e.jsx(sy,{buyer:s,onAddVisit:Q,onEditVisit:he,onDeleteVisit:ge})]})},ay=()=>({pending:{bg:"bg-orange-100",text:"text-orange-700",label:"Pending",icon:"â³"},scheduled:{bg:"bg-blue-100",text:"text-blue-700",label:"Scheduled",icon:"ðŸ“…"},completed:{bg:"bg-green-100",text:"text-green-700",label:"Completed",icon:"âœ…"},cancelled:{bg:"bg-red-100",text:"text-red-700",label:"Cancelled",icon:"âŒ"},inProgress:{bg:"bg-indigo-100",text:"text-indigo-700",label:"In Progress",icon:"ðŸ”„"},onHold:{bg:"bg-yellow-100",text:"text-yellow-700",label:"On Hold",icon:"â¸ï¸"},followUp:{bg:"bg-purple-100",text:"text-purple-700",label:"Follow Up",icon:"ðŸ“ž"},interested:{bg:"bg-green-100",text:"text-green-700",label:"Interested",icon:"ðŸ‘"},notInterested:{bg:"bg-gray-100",text:"text-gray-700",label:"Not Interested",icon:"ðŸ‘Ž"},contacted:{bg:"bg-teal-100",text:"text-teal-700",label:"Contacted",icon:"ðŸ“§"},meeting:{bg:"bg-pink-100",text:"text-pink-700",label:"Meeting",icon:"ðŸ¤"},proposal:{bg:"bg-amber-100",text:"text-amber-700",label:"Proposal",icon:"ðŸ“‹"},negotiation:{bg:"bg-violet-100",text:"text-violet-700",label:"Negotiation",icon:"ðŸ’¼"},closed:{bg:"bg-slate-100",text:"text-slate-700",label:"Closed",icon:"ðŸ”"}}),ry=()=>({urgent:{border:"border-l-red-600",bg:"bg-red-50",text:"text-red-700",badge:"bg-red-100"},high:{border:"border-l-red-500",bg:"bg-red-50",text:"text-red-700",badge:"bg-red-100"},medium:{border:"border-l-yellow-500",bg:"bg-yellow-50",text:"text-yellow-700",badge:"bg-yellow-100"},normal:{border:"border-l-blue-500",bg:"bg-blue-50",text:"text-blue-700",badge:"bg-blue-100"},low:{border:"border-l-green-500",bg:"bg-green-50",text:"text-green-700",badge:"bg-green-100"},minimal:{border:"border-l-gray-400",bg:"bg-gray-50",text:"text-gray-700",badge:"bg-gray-100"}}),ly=()=>({buyerLeadStage:{label:"Lead Stage",icon:fu,color:"bg-indigo-100 text-indigo-700",priority:1},buyerLeadStatus:{label:"Lead Status",icon:Rs,color:"bg-blue-100 text-blue-700",priority:2},followupType:{label:"Follow-up Type",icon:mr,color:"bg-purple-100 text-purple-700",priority:3},nextAction:{label:"Next Action",icon:_l,color:"bg-yellow-100 text-yellow-700",priority:4},customRemark:{label:"Remarks",icon:ct,color:"bg-pink-100 text-pink-700",priority:5},scheduleDate:{label:"Scheduled",icon:Ts,color:"bg-green-100 text-green-700",priority:6},transferredAt:{label:"Transferred",icon:$l,color:"bg-orange-100 text-orange-700",priority:7},assignedTo:{label:"Assigned To",icon:Ms,color:"bg-teal-100 text-teal-700",priority:8},type:{label:"Type",icon:Ls,color:"bg-gray-100 text-gray-700",priority:9},priority:{label:"Priority",icon:bu,color:"bg-gray-100 text-gray-700",priority:11},createdAt:{label:"Created",icon:Ts,color:"bg-gray-50 text-gray-700",priority:90},updatedAt:{label:"Updated",icon:Ts,color:"bg-gray-50 text-gray-700",priority:91},createdBy:{label:"Created By",icon:Ms,color:"bg-gray-50 text-gray-700",priority:92},updatedBy:{label:"Updated By",icon:Ms,color:"bg-gray-50 text-gray-700",priority:93}}),Ac=s=>String(s).padStart(2,"0");function Fl(s){if(!s)return"";let a=new Date(s);if(isNaN(a.getTime())){const n=String(s).match(/^(\d{4})-(\d{1,2})-(\d{1,2})/);if(n){const o=Number(n[1]),m=Number(n[2])-1,g=Number(n[3]);a=new Date(o,m,g)}else return""}const t=Ac(a.getDate()),r=Ac(a.getMonth()+1),i=a.getFullYear();return`${t}/${r}/${i}`}function pr(s){if(!s)return"";const a=String(s);let t=null;if(a.includes("T")||a.endsWith("Z")){const o=new Date(a);isNaN(o.getTime())||(t=o)}else{const o=a.match(/^(\d{1,2}):(\d{2})(?::(\d{2}))?$/);if(o){const m=Number(o[1]),g=Number(o[2]),b=Number(o[3]??0),d=new Date;d.setHours(m,g,b,0),t=d}else{const m=new Date(a);isNaN(m.getTime())||(t=m)}}if(!t)return"";let r=t.getHours();const i=t.getMinutes(),n=r>=12?"PM":"AM";return r=r%12,r===0&&(r=12),`${r}:${Ac(i)} ${n}`}const ny=({buyer:s,onAddFollowup:a,onEditFollowup:t})=>{const[r,i]=l.useState((s==null?void 0:s.followups)??[]),[n,o]=l.useState(!1),[m,g]=l.useState(null),[b,d]=l.useState("sales"),v=ay(),x=ry(),u=ly(),c=k=>{if(!k)return null;const R=k.toString().toLowerCase().replace(/[^a-z]/g,"");let F=v[R];if(!F){const j=Object.keys(v).find(E=>R.includes(E)||E.includes(R));F=j?v[j]:null}return F||(F={bg:"bg-gray-100",text:"text-gray-700",label:k,icon:"â„¹ï¸"}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${F.bg} ${F.text}`,children:[e.jsx("span",{className:"mr-1",children:F.icon}),F.label]})},f=k=>{if(!k)return"border-l-gray-500 bg-gray-50";const R=k.toString().toLowerCase(),F=x[R]||x.normal;return`${F.border} ${F.bg}`},p=k=>{if(!k)return null;const R=k.toString().toLowerCase(),F=x[R]||x.normal,T=`${(k||"").toString().charAt(0).toUpperCase()+(k||"").toString().slice(1)}`;return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium ${F.badge} ${F.text}`,children:T})},N=k=>{const R=[{key:"buyerLeadStage",value:k.buyerLeadStage},{key:"buyerLeadStatus",value:k.buyerLeadStatus??c(k.status)},{key:"priority",value:k.priority?p(k.priority):null},{key:"followupType",value:k.followupType??k.type},{key:"assignedTo",value:k.assignedTo},{key:"scheduleDate",value:k.scheduleDate?`${Fl(k.scheduleDate)}${k.scheduleTime||k.time?` â€¢ ${pr(k.scheduleTime||k.time)}`:""}`:k.date?`${Fl(k.date)}${k.time?` â€¢ ${pr(k.time)}`:""}`:null},...k.transferredAt?[{key:"transferredAt",value:`${Fl(k.transferredAt)}${k.transferredAt?` â€¢ ${pr(k.transferredAt)}`:""}`}]:[]].filter(j=>j.value!==null&&j.value!==void 0&&j.value!==""),F=[{key:"nextAction",value:k.nextAction},{key:"customRemark",value:k.customRemark??k.remark}].filter(j=>j.value!==null&&j.value!==void 0&&j.value!=="");if(k.category==="sales"){const j=k.createdAt?`${Fl(k.createdAt)}${pr(k.createdAt)?` â€¢ ${pr(k.createdAt)}`:""}`:null,E=k.updatedAt?`${Fl(k.updatedAt)}${pr(k.updatedAt)?` â€¢ ${pr(k.updatedAt)}`:""}`:null;j&&F.push({key:"createdAt",value:j}),k.createdBy&&F.push({key:"createdBy",value:k.createdBy}),E&&F.push({key:"updatedAt",value:E}),k.updatedBy&&F.push({key:"updatedBy",value:k.updatedBy})}R.sort((j,E)=>{var B,M;const V=((B=u[j.key])==null?void 0:B.priority)??99,W=((M=u[E.key])==null?void 0:M.priority)??99;return V-W});const T=(j,E)=>{const V=u[j.key],W=V==null?void 0:V.icon,B=j.key==="type"?16:14,M=W?Ps.createElement(W,{size:B,className:"inline-block"}):null,A="flex items-start space-x-2";if(!V)return e.jsxs("div",{className:A,children:[e.jsxs("span",{className:"text-gray-500 w-32",children:[j.key,":"]}),e.jsx("span",{className:"font-medium flex-1 break-words",children:j.value})]},j.key);if(j.key==="type")return e.jsxs("div",{className:A,children:[e.jsxs("div",{className:"w-32 flex items-center text-xs text-gray-500",children:[e.jsx("span",{className:`inline-flex items-center justify-center w-7 h-7 rounded-full mr-2 ${V.color}`,children:M}),e.jsxs("span",{className:"text-xs",children:[V.label,":"]})]}),e.jsx("div",{className:"font-semibold text-sm flex-1 break-words",children:j.value})]},j.key);const L=Ps.isValidElement(j.value);return e.jsxs("div",{className:A,children:[e.jsxs("div",{className:"w-32 flex items-center text-xs text-gray-500",children:[e.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full mr-2 ${V.color}`,children:M}),e.jsxs("span",{children:[V.label,":"]})]}),e.jsx("div",{className:"font-medium text-xs flex-1 break-words",children:L?j.value:e.jsx("span",{className:"break-words",children:j.value})})]},j.key)};return e.jsxs(e.Fragment,{children:[R.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-xs",children:R.map(j=>T(j))}),F.length>0&&e.jsxs("div",{className:"mt-2 space-y-2 text-xs",children:[F.filter(j=>!["createdAt","createdBy","updatedAt","updatedBy"].includes(j.key)).map(j=>{const E=u[j.key],V=E==null?void 0:E.icon,W=V?Ps.createElement(V,{size:14,className:"inline-block"}):null;return e.jsx("div",{className:"flex items-start space-x-2",children:E?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-32 flex items-center text-xs text-gray-500",children:[e.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full mr-2 ${E.color}`,children:W}),e.jsxs("span",{children:[E.label,":"]})]}),e.jsx("div",{className:"font-medium text-xs flex-1 break-words whitespace-pre-wrap",children:j.value})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-500 w-32",children:[j.key,":"]}),e.jsx("span",{className:"font-medium flex-1 break-words whitespace-pre-wrap",children:j.value})]})},j.key)}),k.category==="sales"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:["createdAt","createdBy","updatedAt","updatedBy"].map(j=>{const E=F.find(M=>M.key===j);if(!E)return null;const V=u[j],W=V==null?void 0:V.icon,B=W?Ps.createElement(W,{size:14,className:"inline-block"}):null;return e.jsx("div",{className:"flex items-start space-x-2",children:V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-28 flex items-center text-xs text-gray-500",children:[e.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full mr-1 ${V.color}`,children:B}),e.jsxs("span",{children:[V.label,":"]})]}),e.jsx("div",{className:"font-medium text-xs flex-1 break-words whitespace-pre-wrap",children:E.value})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-500 w-28",children:[E.key,":"]}),e.jsx("span",{className:"font-medium flex-1 break-words whitespace-pre-wrap",children:E.value})]})},E.key)})})]})]})},P=k=>(k||[]).map(R=>{var M,A,L,D,I,H,h,Y,K,q;const F=R.transferredFromLead===!0||R.transferredFromLead===1||R.transferredFromLead==="1"||R.transferred_from_lead===1||R.transferred_from_lead==="1"||R.transferred_from_lead===!0,T=R.transferredByName??R.transferred_by_name??R.createdByName??R.created_by_name??R.updatedByName??R.updated_by_name??R.assignedTo??R.assignee??(R.createdBy||R.created_by)??null;let j=R.transferredAt??R.transferred_at??((I=(D=(L=(A=(M=R.transfers)==null?void 0:M.map)==null?void 0:A.call(M,ne=>ne.date||ne.transferredAt||ne.transferred_at))==null?void 0:L.filter(Boolean))==null?void 0:D.sort())==null?void 0:I[0])??((q=(K=(Y=(h=(H=R.transfer_history)==null?void 0:H.map)==null?void 0:h.call(H,ne=>ne.date||ne.transferredAt||ne.transferred_at))==null?void 0:Y.filter(Boolean))==null?void 0:K.sort())==null?void 0:q[0])??null;if(!j&&Array.isArray(R.transfers)&&R.transfers.length>0){const ne=R.transfers.map(le=>new Date(le.date||le.transferredAt||le.transferred_at)).filter(le=>!isNaN(le.getTime()));ne.length>0&&(j=ne.sort((le,S)=>le.getTime()-S.getTime())[0].toISOString())}if(!j&&Array.isArray(R.transfer_history)&&R.transfer_history.length>0){const ne=R.transfer_history.map(le=>new Date(le.date||le.transferredAt||le.transferred_at)).filter(le=>!isNaN(le.getTime()));ne.length>0&&(j=ne.sort((le,S)=>le.getTime()-S.getTime())[0].toISOString())}const E=R.createdAt??R.created_at??R.created_at_iso??R.createdOn??R.created_on??null,V=R.updatedAt??R.updated_at??R.updated_at_iso??R.updatedOn??R.updated_on??null,W=R.createdByName??R.created_by_name??R.createdBy??R.created_by??R.creator_name??R.creator??null,B=R.updatedByName??R.updated_by_name??R.updatedBy??R.updated_by??R.updater_name??R.updater??null;return{id:R.id??R.followupId??R._id??`${R.buyerId??"b"}-${Math.random().toString(36).slice(2,8)}`,description:R.description??R.remark??R.customRemark??R.title??"Follow-up",status:R.status??R.buyerLeadStatus??R.leadStatus??null,date:R.date??R.scheduleDate??R.createdAt??null,time:R.time??R.scheduleTime??null,transferredAt:j??null,priority:R.priority??null,assignedTo:T,type:R.type??R.followupType??null,remark:R.remark??R.customRemark??null,reminder:!!(R.reminder??!1),raw:R,category:F?"presales":"sales",transferredFromLead:F,buyerLeadStage:R.buyerLeadStage??R.buyer_lead_stage??null,buyerLeadStatus:R.buyerLeadStatus??R.buyer_lead_status??null,customRemark:R.customRemark??R.custom_remark??null,followupType:R.followupType??R.followup_type??null,nextAction:R.nextAction??R.next_action??null,scheduleDate:R.scheduleDate??R.schedule_date??null,scheduleTime:R.scheduleTime??R.schedule_time??null,createdAt:E??null,updatedAt:V??null,createdBy:W??null,updatedBy:B??null}});l.useEffect(()=>{let k=!1;const R=(s==null?void 0:s.id)??(s==null?void 0:s.buyerId)??null;return(async()=>{var T,j;if(!R){i(P((s==null?void 0:s.followups)??[]));return}o(!0),g(null);try{const E=await(((T=gl==null?void 0:gl.getAll)==null?void 0:T.call(gl,{buyerId:R,page:1,limit:200}))??Promise.resolve({data:(s==null?void 0:s.followups)??[]})),V=(E==null?void 0:E.data)??E??((j=E==null?void 0:E.data)!=null&&j.data?E.data.data:void 0),W=Array.isArray(V)?V:Array.isArray(V==null?void 0:V.data)?V.data:V??[];k||i(P(W))}catch(E){Z.warn("Error fetching followups by buyerId:",E),k||(g((E==null?void 0:E.message)??String(E)),i(P((s==null?void 0:s.followups)??[])))}finally{k||o(!1)}})(),()=>{k=!0}},[s==null?void 0:s.id,s==null?void 0:s.buyerId,s==null?void 0:s.followups]);const w=r.filter(k=>b==="sales"?k.category==="sales":k.category==="presales"),$=r.filter(k=>k.category==="sales").length,y=r.filter(k=>k.category==="presales").length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-2 text-xs",children:[e.jsxs("button",{onClick:()=>d("sales"),className:`px-3 py-1 rounded-lg font-medium transition-all duration-200 ${b==="sales"?"bg-purple-600 text-white shadow-md transform scale-105":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Sales Follow-ups ",$>0&&`(${$})`]}),e.jsxs("button",{onClick:()=>d("presales"),className:`px-3 py-1 rounded-lg font-medium transition-all duration-200 ${b==="presales"?"bg-purple-600 text-white shadow-md transform scale-105":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Pre-Sales Follow-ups ",y>0&&`(${y})`]}),e.jsxs("button",{onClick:a,className:"ml-auto flex items-center space-x-1 px-3 py-1 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all duration-200 hover:shadow-md transform hover:scale-105",children:[e.jsx(fs,{size:12}),e.jsx("span",{children:"Schedule"})]})]}),b==="presales"&&e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Presales History"}),b==="sales"&&e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Sales History"}),n?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-purple-600 border-t-transparent"}),e.jsx("p",{className:"text-xs text-gray-500 ml-2",children:"Loading followups..."})]}):m?e.jsxs("div",{className:"bg-red-50 border border-red-200 p-3 rounded-lg text-xs text-red-700 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âš ï¸"}),"Failed to load followups: ",m]}):w.length>0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map((k,R)=>{const F=k.id??`${R}-${(k.description??"followup").slice(0,20)}`,T=N(k);return e.jsxs("div",{className:`border-l-4 rounded-lg p-4 transition-all duration-200 hover:shadow-md ${f(k.priority)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-[11px]",children:[k.category==="presales"&&e.jsxs("span",{className:"px-2 py-0.5 text-[10px] rounded-full bg-indigo-100 text-indigo-700 font-medium flex items-center",children:["ðŸ“‹ ",e.jsx("span",{className:"ml-1",children:"Pre-Sales"})]}),k.category==="sales"&&e.jsxs("span",{className:"px-2 py-0.5 text-[10px] rounded-full bg-amber-100 text-amber-700 font-medium flex items-center",children:["ðŸ’¼ ",e.jsx("span",{className:"ml-1",children:"Sales"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[e.jsx("span",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:k.transferredAt&&e.jsxs("span",{className:"text-gray-500",children:["Transferred Date:"," ",e.jsxs("span",{className:"font-medium text-gray-700",children:[Fl(k.transferredAt),pr(k.transferredAt)?` â€¢ ${pr(k.transferredAt)}`:""]})]})}),k.category!=="presales"&&e.jsx("button",{onClick:()=>{k.transferredFromLead||t(k.raw??k)},disabled:!!k.transferredFromLead,className:`p-1.5 rounded-md transition-all duration-200 ${k.transferredFromLead?"text-gray-400 cursor-not-allowed":"text-purple-600 hover:bg-purple-100 hover:scale-110"}`,title:k.transferredFromLead?"This follow-up was transferred (pre-sales) and cannot be edited.":"Edit follow-up",children:e.jsx(ft,{size:14})})]})]}),T,k.reminder&&e.jsxs("div",{className:"mt-3 flex items-center space-x-1 text-[11px] bg-purple-50 rounded-md px-2 py-1",children:[e.jsx(ha,{className:"text-purple-600",size:12}),e.jsx("span",{className:"text-purple-700 font-medium",children:"ðŸ”” Reminder set"})]})]},F)})})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(Ts,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:["No ",b==="sales"?"Sales":"Pre-Sales"," Follow-ups Scheduled"]}),e.jsx("p",{className:"text-gray-500 text-xs mb-6",children:b==="sales"?"Schedule follow-ups to maintain buyer engagement and close deals":"Track pre-sales activities and lead nurturing efforts"}),e.jsx("button",{onClick:a,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all duration-200 text-sm font-medium hover:shadow-md transform hover:scale-105",children:"Schedule First Follow-up"})]})]})},Oa=ad,iy=s=>{var t,r,i,n;const a=(s==null?void 0:s.role)||(s==null?void 0:s.roles)||((t=s==null?void 0:s.raw)==null?void 0:t.role)||((r=s==null?void 0:s.raw)==null?void 0:r.roles)||((i=s==null?void 0:s.user)==null?void 0:i.role)||((n=s==null?void 0:s.user)==null?void 0:n.roles)||"";return Array.isArray(a)?a.join(",").toLowerCase():String(a||"").toLowerCase()},oy=s=>{const a=iy(s);return!!a&&/executive/.test(a)&&!/admin|manager|super/.test(a)},Oo=s=>{if(s==null||String(s).trim()==="")return{display:"",key:""};let a=String(s).trim();if(/e\+\d+$/i.test(a)){const r=Number(a);isNaN(r)||(a=Math.round(r).toString())}a=a.replace(/[^\d+]/g,""),a=a.replace(/^0+/,"");const t=a.replace(/[^\d]/g,"");if(/^\+?91\d{10}$/.test(a)||/^91\d{10}$/.test(a)||/^\d{10}$/.test(t)){const r=t.slice(-10);return{display:`+91${r}`,key:r}}return{display:a.startsWith("+")?a:`+${a}`,key:t}},Im=s=>{if(s==null||s==="")return;if(typeof s=="object")return s;let a=String(s).trim();(a.startsWith("'")&&a.endsWith("'")||a.startsWith('"')&&a.endsWith('"'))&&(a=a.slice(1,-1).trim()),a=a.replace(/\\"/g,'"').replace(/\\'/g,"'");try{return JSON.parse(a)}catch{return a.includes(",")&&!a.includes("{")&&!a.includes("[")?a.split(",").map(t=>t.trim()).filter(Boolean):a}},sl=s=>{if(s==null||s==="")return;const a=String(s).replace(/[^\d.-]/g,""),t=Number(a);return Number.isFinite(t)&&!isNaN(t)?t:void 0},cy=s=>{if(s==null||s==="")return;const a=String(s).toLowerCase().trim();if(a==="true"||a==="yes"||a==="1")return!0;if(a==="false"||a==="no"||a==="0")return!1},Mr=s=>s==null?[]:Array.isArray(s)?s.map(a=>String(a).trim()).filter(Boolean):typeof s=="string"?s.split(/[|,]/).map(a=>a.trim()).filter(Boolean):[String(s).trim()],Tt=s=>{if(!(s==null||s===""))return String(s).trim()},Uo=s=>{if(s==null||s==="")return"";if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return String(s);if(Array.isArray(s))return s.length?s.join(", "):"";if(typeof s=="object")try{return JSON.stringify(s)}catch{return"[object]"}try{return String(s)}catch{return""}};function dy({isOpen:s,onClose:a,title:t="Import Summary",duplicates:r,skippedRows:i,updatedRows:n}){if(!s)return null;const o=new Set;[...r.map(g=>g.data),...i.map(g=>g.data),...n.map(g=>g.data)].forEach(g=>{Object.entries(g||{}).forEach(([b,d])=>{d!=null&&String(d).trim()!==""&&o.add(b)})});const m=Array.from(o);return e.jsx(ma,{isOpen:s,onClose:a,title:t,width:"max-w-6xl",children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"text-sm text-gray-700 flex flex-wrap gap-4",children:[e.jsxs("span",{children:["Duplicates: ",e.jsx("span",{className:"font-semibold",children:r.length})]}),e.jsxs("span",{children:["Skipped: ",e.jsx("span",{className:"font-semibold",children:i.length})]}),n.length>0&&e.jsxs("span",{children:["Updated: ",e.jsx("span",{className:"font-semibold",children:n.length})]})]}),r.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-700 mb-2",children:"Duplicates (in file or CRM)"}),e.jsx("div",{className:"max-h-[260px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-purple-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"Duplicate Fields"}),e.jsx("th",{className:"border px-2 py-1",children:"Existing ID"}),e.jsx("th",{className:"border px-2 py-1",children:"Reason"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:r.map((g,b)=>e.jsxs("tr",{className:"hover:bg-purple-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row??"-"}),e.jsx("td",{className:"border px-2 py-1",children:g.duplicateFields&&g.duplicateFields.length>0?g.duplicateFields.join(", "):"-"}),e.jsx("td",{className:"border px-2 py-1 text-center",children:g.existingId??"-"}),e.jsx("td",{className:"border px-2 py-1 text-purple-700",children:g.reason}),m.map(d=>{var v;return e.jsx("td",{className:"border px-2 py-1",children:Uo((v=g.data)==null?void 0:v[d])},d)})]},b))})]})})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-red-700 mb-2",children:"Skipped (non-duplicate issues)"}),e.jsx("div",{className:"max-h-[240px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-red-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"Reason"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:i.map((g,b)=>e.jsxs("tr",{className:"hover:bg-red-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row}),e.jsx("td",{className:"border px-2 py-1 text-red-600",children:g.reason}),m.map(d=>{var v;return e.jsx("td",{className:"border px-2 py-1",children:Uo((v=g.data)==null?void 0:v[d])},d)})]},b))})]})})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:"Updated (existing in CRM)"}),e.jsx("div",{className:"max-h-[240px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-green-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"ID"}),e.jsx("th",{className:"border px-2 py-1",children:"Note"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:n.map((g,b)=>e.jsxs("tr",{className:"hover:bg-green-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row??"-"}),e.jsx("td",{className:"border px-2 py-1 text-center",children:g.id??"-"}),e.jsx("td",{className:"border px-2 py-1 text-green-700",children:g.note||"Updated"}),m.map(d=>{var v;return e.jsx("td",{className:"border px-2 py-1",children:Uo((v=g.data)==null?void 0:v[d])},d)})]},b))})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ss,{variant:"outline",onClick:a,children:"Close"})})]})})}const my=s=>{if(s==null||s==="")return;if(typeof s=="number"&&Number.isFinite(s)){const n=new Date(Date.UTC(1899,11,30)),o=s*864e5,m=new Date(n.getTime()+o);if(!isNaN(m.getTime())){const g=m.getUTCFullYear(),b=String(m.getUTCMonth()+1).padStart(2,"0"),d=String(m.getUTCDate()).padStart(2,"0");return`${g}-${b}-${d}`}}const a=String(s).trim();if(!a)return;const t=a.replace(/\./g,"/").replace(/-/g,"/");let r=t.match(/^(\d{4})[\/](\d{1,2})[\/](\d{1,2})$/);if(r){const n=Number(r[1]),o=Number(r[2]),m=Number(r[3]);if(o>=1&&o<=12&&m>=1&&m<=31)return`${n}-${String(o).padStart(2,"0")}-${String(m).padStart(2,"0")}`}if(r=t.match(/^(\d{1,2})[\/](\d{1,2})[\/](\d{4})$/),r){const n=Number(r[1]),o=Number(r[2]),m=Number(r[3]);if(o>=1&&o<=12&&n>=1&&n<=31)return`${m}-${String(o).padStart(2,"0")}-${String(n).padStart(2,"0")}`}const i=new Date(a);if(!isNaN(i.getTime())){const n=i.getFullYear(),o=String(i.getMonth()+1).padStart(2,"0"),m=String(i.getDate()).padStart(2,"0");return`${n}-${o}-${m}`}},xy=()=>{const s=[["Salutation","Name","Phone","Email","DOB","Whatsapp_Number","State","City","Location","Buyer_Lead_Source","Buyer_Lead_Priority","Buyer_Lead_Stage","Buyer_Lead_Status","BudgetMin","BudgetMax","PropertyType","UnitTypes","PreferredLocations","Furnishing","Possession","Facing","Floor"],["Mr","Rahul Sharma","9876543210","rahul.sharma@gmail.com","1990-05-20","9876543210","Maharashtra","Mumbai","Bandra","Website","Medium","New","Active","20000000","25000000","Residential","2BHK,3BHK","Bandra,Andheri","Semi Furnished","Ready to Move","East","5"]],a=Oa.utils.aoa_to_sheet(s);[0,1,2].forEach(i=>{const n=Oa.utils.encode_cell({r:0,c:i});a[n]&&(a[n].s={font:{color:{rgb:"FF0000"},bold:!0},alignment:{horizontal:"center",vertical:"center"}})});for(let i=3;i<s[0].length;i++){const n=Oa.utils.encode_cell({r:0,c:i});a[n]&&(a[n].s={font:{bold:!0},alignment:{horizontal:"center",vertical:"center"}})}for(let i=1;i<s.length;i++)for(let n=0;n<s[i].length;n++){const o=Oa.utils.encode_cell({r:i,c:n});a[o]&&(a[o].s={alignment:{horizontal:"left",vertical:"center"}})}a["!cols"]=[12,16,15,24,14,16,12,12,16,16,16,16,16,12,12,16,16,16,16,16,12,12].map(i=>({width:i}));const r=Oa.utils.book_new();Oa.utils.book_append_sheet(r,a,"Buyers Template"),Oa.writeFile(r,"Buyers_Import_Template.xlsx")};function $m({isOpen:s,onClose:a}){const{user:t}=Hs(),[r,i]=l.useState(null),[n,o]=l.useState(""),[m,g]=l.useState(!1),[b,d]=l.useState(!1),[v,x]=l.useState([]),[u,c]=l.useState([]),[f,p]=l.useState([]),[N,P]=l.useState([]),[w,$]=l.useState(!1),[y,k]=l.useState(!1),[R,F]=l.useState([]),[T,j]=l.useState(!1),[E,V]=l.useState(""),[W,B]=l.useState(new Set),[M,A]=l.useState("none"),L=oy(t),D=l.useRef(null),I=l.useRef(null);l.useEffect(()=>{function G(me){I.current&&!I.current.contains(me.target)&&j(!1)}return T&&document.addEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[T]);const H=()=>{var G;return(t==null?void 0:t.id)||(t==null?void 0:t.userId)||(t==null?void 0:t._id)||((G=t==null?void 0:t.raw)==null?void 0:G.id)};l.useEffect(()=>{s&&(async()=>{var G;try{k(!0);const me=_e=>{const ve=_e!=null&&_e.salutation?`${_e.salutation} `:"",Pe=(_e==null?void 0:_e.first_name)||"",We=(_e==null?void 0:_e.last_name)||"",pe=(_e==null?void 0:_e.username)||(_e==null?void 0:_e.email)||"Executive";return`${ve}${Pe} ${We}`.trim()||pe};if(L){const _e=(t==null?void 0:t.id)||(t==null?void 0:t.userId)||(t==null?void 0:t._id)||(t==null?void 0:t.uuid)||((G=t==null?void 0:t.raw)==null?void 0:G.id)||String((t==null?void 0:t.email)||(t==null?void 0:t.username)||"me"),ve=me(t),Pe={id:_e,name:ve,email:t==null?void 0:t.email,username:t==null?void 0:t.username};F([Pe]),B(new Set([_e])),A("selected");return}const oe=async _e=>{var ve;return(ve=Os.getByDeptRole)==null?void 0:ve.call(Os,{department:_e,role:"executive",is_active:1,limit:100})};let Fe;try{Fe=await oe("presales")}catch{Fe=await oe("pre-sales")}const $e=((Fe==null?void 0:Fe.items)??(Fe==null?void 0:Fe.data)??Fe??[]).map(_e=>({..._e,id:_e.id??_e.userId??_e._id??_e.uuid??String(_e.email||_e.username||Math.random()),name:me(_e)})),je=(Da(t,$e)||[]).map(_e=>{var ve;return{id:_e.id,name:_e.name,email:_e.email,username:((ve=_e.raw)==null?void 0:ve.username)||_e.username}});F(je)}catch(me){console.error(me),Z.error("Could not fetch executives")}finally{k(!1)}})()},[s,t,L]);const h=l.useMemo(()=>{if(!E.trim())return R;const G=E.toLowerCase();return R.filter(me=>String(me.name||"").toLowerCase().includes(G)||String(me.email||"").toLowerCase().includes(G)||String(me.username||"").toLowerCase().includes(G))},[E,R]),Y=G=>{B(me=>{const oe=new Set(me);return oe.has(G)?oe.delete(G):oe.add(G),oe})},K=()=>B(new Set(R.map(G=>G.id))),q=()=>B(new Set),ne=(G,me)=>{const oe=[],Fe=(G||"").toLowerCase();return Fe.includes("phone")&&oe.push("phone"),Fe.includes("email")&&oe.push("email"),oe.length===0&&((me["Phone*"]||me.phone||me.Phone)&&oe.push("phone"),(me.Email||me.email)&&oe.push("email")),Array.from(new Set(oe))},le=(G,me)=>{const oe={};Object.keys(G||{}).forEach(O=>{G[O]!==void 0&&G[O]!==null&&G[O]!==""&&(oe[String(O).trim().toLowerCase()]=G[O])});const Fe=["budgetmin","budget_min","budget min","budget_minimum","minbudget","budgetmin_inr","min_budget"],$e=["budgetmax","budget_max","budget max","budget_maximum","maxbudget","budgetmax_inr","max_budget"];let Le,je;for(const O of Fe)if(oe[O]!==void 0){Le=sl(oe[O]);break}for(const O of $e)if(oe[O]!==void 0){je=sl(oe[O]);break}if(Le===void 0&&je===void 0){const O=Object.keys(oe).filter(Ie=>/budget|amount/i.test(Ie));for(const Ie of O){const ze=sl(oe[Ie]);ze!==void 0&&(Le===void 0?Le=ze:je===void 0&&(je=ze))}}Le!==void 0&&je!==void 0&&Le>je&&([Le,je]=[je,Le]);const _e=Im(oe.requirements??oe.requirement??oe.propertyrequirements),ve=Im(oe.financials??oe.finance??oe.financial),Pe={salutation:Tt(oe.salutation),name:Tt(oe.name??oe["full name"]??oe.fullname),phone:Tt(oe.phone??oe.mobile??oe.contact??oe["contact number"]),whatsapp_number:Tt(oe.whatsapp_number??oe.whatsapp??oe["whatsapp no"]),dob:my(oe.dob??oe.date_of_birth??oe["date of birth"]),email:Tt(oe.email??oe["email address"]),state:Tt(oe.state),city:Tt(oe.city),location:Tt(oe.location??oe.area??oe["preferred location"]),buyer_lead_priority:Tt(oe.buyer_lead_priority??oe.priority??oe.lead_priority),buyer_lead_source:Tt(oe.buyer_lead_source??oe.source??oe.lead_source),buyer_lead_stage:Tt(oe.buyer_lead_stage??oe.stage??oe.lead_stage),buyer_lead_status:Tt(oe.buyer_lead_status??oe.status??oe.lead_status),budget_min:Le,budget_max:je,requirements:_e&&typeof _e=="object"?{propertyType:_e.propertyType||Tt(oe.propertytype??oe.property_type??oe["property type"]),property_subtype:_e.property_subtype||Tt(oe.propertysubtype??oe.property_subtype??oe["property subtype"]),unitTypes:Array.isArray(_e.unitTypes)?_e.unitTypes:Mr(oe.unittype??oe.unit_type??oe.unittypes??oe["unit types"]),preferredLocations:Array.isArray(_e.preferredLocations)?_e.preferredLocations:Mr(oe.preferredlocations??oe.preferred_locations??oe["preferred locations"]),furnishing:_e.furnishing||Tt(oe.furnishing),possession:_e.possession||Tt(oe.possession),facing:_e.facing||Tt(oe.facing),floor:_e.floor||Tt(oe.floor),amenities:Array.isArray(_e.amenities)?_e.amenities:Mr(oe.amenities),nearbylocations:Array.isArray(_e.nearbylocations)?_e.nearbylocations:Mr(oe.nearbylocations??oe.nearby_locations),specialRequirements:_e.specialRequirements||Tt(oe.specialrequirements??oe.special_requirements)}:{propertyType:Tt(oe.propertytype??oe.property_type??oe["property type"]),property_subtype:Tt(oe.propertysubtype??oe.property_subtype??oe["property subtype"]),unitTypes:Mr(oe.unittype??oe.unit_type??oe.unittypes??oe["unit types"]),preferredLocations:Mr(oe.preferredlocations??oe.preferred_locations??oe["preferred locations"]),furnishing:Tt(oe.furnishing??oe.furnishing_type),possession:Tt(oe.possession??oe.possession_type),facing:Tt(oe.facing),floor:Tt(oe.floor),amenities:Mr(oe.amenities??oe.amenity),nearbylocations:Mr(oe.nearbylocations??oe.nearby_locations),specialRequirements:Tt(oe.specialrequirements??oe.special_requirements)},financials:(()=>{if(ve&&typeof ve=="object")return ve;const O={};return oe.loanamount!==void 0&&(O.loanAmount=sl(oe.loanamount)),(oe.loan_status!==void 0||oe.loanstatus!==void 0)&&(O.loanStatus=Tt(oe.loan_status??oe.loanstatus)),oe.creditscore!==void 0&&(O.creditScore=sl(oe.creditscore)),oe.downpayment!==void 0&&(O.downPayment=sl(oe.downpayment)),oe.loanrequired!==void 0&&(O.loanRequired=cy(oe.loanrequired)),oe.monthlyincome!==void 0&&(O.monthlyIncome=sl(oe.monthlyincome)),oe.bankpreference!==void 0&&(O.bankPreference=Tt(oe.bankpreference)),Object.keys(O).length>0?O:void 0})()};Pe.requirements&&(Pe.requirements=Object.keys(Pe.requirements).reduce((O,Ie)=>{const ze=Pe.requirements[Ie];return ze!=null&&ze!==""&&!(Array.isArray(ze)&&ze.length===0)&&(O[Ie]=ze),O},{}),Object.keys(Pe.requirements).length===0&&delete Pe.requirements);const We=Object.keys(Pe).reduce((O,Ie)=>(Pe[Ie]!==void 0&&Pe[Ie]!==null&&Pe[Ie]!==""&&!(Array.isArray(Pe[Ie])&&Pe[Ie].length===0)&&(O[Ie]=Pe[Ie]),O),{}),pe=[];if(We.name||pe.push("Missing name"),We.phone||pe.push("Missing phone"),We.phone){const O=Oo(We.phone);We.phone=O.display}if(We.whatsapp_number){const O=Oo(We.whatsapp_number);We.whatsapp_number=O.display}return{buyer:We,rowErrors:pe}},S=G=>{const me=new Set,oe=new Set,Fe=[],$e=[],Le=[];return G.forEach((je,_e)=>{const ve=_e+2,{buyer:Pe,rowErrors:We}=le(je);if(We.length>0){$e.push({row:ve,reason:`Validation failed: ${We.join(", ")}`,data:je,errors:We});return}const O=Oo(Pe.phone).key,Ie=(Pe.email?String(Pe.email):"").toLowerCase();if(O&&me.has(O)){Le.push({row:ve,reason:"Duplicate in file (phone)",data:je,duplicateFields:["phone"]});return}if(Ie&&oe.has(Ie)){Le.push({row:ve,reason:"Duplicate in file (email)",data:je,duplicateFields:["email"]});return}const ze=Pe.phone.replace(/[^\d+]/g,"");if(!(/^\+91\d{10}$/.test(ze)||/^\+\d{10,15}$/.test(ze)||/^\d{10}$/.test(ze))){$e.push({row:ve,reason:`Invalid phone format (${Pe.phone})`,data:je});return}if(Ie&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Ie)){$e.push({row:ve,reason:"Invalid email format",data:je});return}Fe.push(Pe),me.add(O),Ie&&oe.add(Ie)}),{validData:Fe,nonDuplicateSkipped:$e,localDuplicates:Le}},C=G=>{var je;const me=H(),oe=new Date;`${oe.getFullYear()}${String(oe.getMonth()+1).padStart(2,"0")}${String(oe.getDate()).padStart(2,"0")}${String(oe.getHours()).padStart(2,"0")}${String(oe.getMinutes()).padStart(2,"0")}${String(oe.getSeconds()).padStart(2,"0")}`;const Fe=_e=>({..._e,created_by:me});if(L){const _e=(t==null?void 0:t.id)||(t==null?void 0:t.userId)||(t==null?void 0:t._id)||(t==null?void 0:t.uuid)||((je=t==null?void 0:t.raw)==null?void 0:je.id)||String((t==null?void 0:t.email)||(t==null?void 0:t.username)||"me");return G.map(ve=>Fe({...ve,assigned_executive:_e}))}if(M==="none")return G.map(_e=>Fe({..._e,assigned_executive:""}));const $e=Array.from(W);if($e.length===0)return G.map(_e=>Fe({..._e,assigned_executive:""}));const Le=$e.length;return G.map((_e,ve)=>Fe({..._e,assigned_executive:$e[ve%Le]}))},J=!0,ue=async G=>{console.log("[Import Buyers] Payload rows:",G);try{J&&console.log("[Import Buyers] Trying shape: raw array");const me=await Vt.importBuyers(G);return me.__payload_shape="array",me}catch(me){console.warn("[Import Buyers] Failed shape 'array':",me);try{J&&console.log("[Import Buyers] Trying shape: { buyers: [] }");const oe=await Vt.importBuyers({buyers:G});return oe.__payload_shape="buyers",oe}catch(oe){console.warn("[Import Buyers] Failed shape '{ buyers: [] }':",oe);try{J&&console.log("[Import Buyers] Trying shape: { data: [] }");const Fe=await Vt.importBuyers({data:G});return Fe.__payload_shape="data",Fe}catch(Fe){throw console.error("[Import Buyers] All payload shapes failed",{err1:me,err2:oe,err3:Fe}),Fe}}}},Q=async(G,me)=>{var Ee,Ke,Xe,ye,Ce,_,ae,ke;P([]),c([]),p([]),$(!1);const{validData:oe,nonDuplicateSkipped:Fe,localDuplicates:$e}=S(G);if(oe.length===0){c(Fe),P($e),p([]),$(!0),$e.length===0&&Z.error(`No valid buyers found in the ${me}`);return}const Le=C(oe);x(Le);let je;try{je=await ue(Le)}catch(Me){console.error(Me),Z.error((Me==null?void 0:Me.message)||`Import failed from ${me}`);return}if(!((je==null?void 0:je.success)===!0||(je==null?void 0:je.ok)===!0||typeof(je==null?void 0:je.status)=="number"&&je.status>=200&&je.status<300||typeof(je==null?void 0:je.inserted)<"u"||Array.isArray(je==null?void 0:je.insertedRows))){Z.error((je==null?void 0:je.message)||`Import failed from ${me}`);return}const ve=(je==null?void 0:je.insertedRows)??((Ee=je==null?void 0:je.data)==null?void 0:Ee.insertedRows)??((Ke=je==null?void 0:je.meta)==null?void 0:Ke.insertedRows)??[],Pe=(je==null?void 0:je.inserted)??((Xe=je==null?void 0:je.data)==null?void 0:Xe.inserted)??((ye=je==null?void 0:je.meta)==null?void 0:ye.inserted)??(Array.isArray(ve)?ve.length:void 0)??Le.length,We=(je==null?void 0:je.skippedRows)??((Ce=je==null?void 0:je.data)==null?void 0:Ce.skippedRows)??((_=je==null?void 0:je.meta)==null?void 0:_.skippedRows)??[],pe=(je==null?void 0:je.updatedRows)??((ae=je==null?void 0:je.data)==null?void 0:ae.updatedRows)??((ke=je==null?void 0:je.meta)==null?void 0:ke.updatedRows)??[],O=[],Ie=[];if(Array.isArray(We))for(const Me of We){const Ye=String((Me==null?void 0:Me.reason)||""),ie=(Me==null?void 0:Me.data)||Me||{};/duplicate/i.test(Ye)?O.push({row:Me==null?void 0:Me.row,reason:Ye||"Duplicate in CRM",data:ie,duplicateFields:ne(Ye,ie),existingId:(Me==null?void 0:Me.id)||(Me==null?void 0:Me.existingId)}):Ie.push({row:(Me==null?void 0:Me.row)??0,reason:Ye||"Skipped by server",data:ie})}const ze=[...$e,...O],xe=[...Fe,...Ie];if(P(ze),c(xe),p(pe||[]),(Pe??0)>0&&ze.length===0&&xe.length===0){if(Z.success(`Imported ${Pe} buyer(s) successfully.`),typeof Vt.getBuyers=="function")try{await Vt.getBuyers()}catch{}ge()}else{const Me=[];(Pe??0)>0&&Me.push(`${Pe} imported`),ze.length>0&&Me.push(`${ze.length} duplicate`),xe.length>0&&Me.push(`${xe.length} skipped`),Z.info(`Import summary: ${Me.join(" â€¢ ")}`),$(!0)}},he=async()=>{if(!r)return Z.error("Please select an Excel/CSV file");if(!L&&M==="selected"&&W.size===0)return Z.error("Please select at least one executive or choose None.");g(!0);try{const G=new FileReader;G.onload=async oe=>{var Fe;try{const $e=(Fe=oe.target)==null?void 0:Fe.result;if(!$e){Z.error("Failed to read file");return}let Le;if(r.name.toLowerCase().endsWith(".csv")){const Pe=typeof $e=="string"?$e:String($e);Le=Oa.read(Pe,{type:"string",raw:!0})}else{const Pe=$e;Le=Oa.read(Pe,{type:"array",raw:!0})}const _e=Le.Sheets[Le.SheetNames[0]];if(!_e){Z.error("No sheet found in file");return}const ve=Oa.utils.sheet_to_json(_e,{raw:!0,defval:""});if(!ve||ve.length===0){Z.error("File appears to be empty");return}await Q(ve,"file")}catch($e){console.error($e),Z.error("Error processing file. Please check the format.")}finally{g(!1)}},r.name.toLowerCase().endsWith(".csv")?G.readAsText(r):G.readAsArrayBuffer(r)}catch(G){console.error(G),Z.error("Error reading file"),g(!1)}},se=async()=>{if(!n.trim())return Z.error("Please enter a Google Sheet URL");if(!L&&M==="selected"&&W.size===0)return Z.error("Please select at least one executive or choose None.");g(!0);const G=new AbortController;try{const me=n.match(/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);if(!me){Z.error("Invalid Google Sheet URL"),g(!1);return}const oe=me[1],Fe=n.match(/[?&]gid=(\d+)/),$e=Fe?`&gid=${Fe[1]}`:"",Le=`https://docs.google.com/spreadsheets/d/${oe}/export?format=csv${$e}`,je=await fetch(Le,{signal:G.signal});if(!je.ok){Z.error(je.status===403?"Sheet is not publicly accessible. Make it 'Anyone with link can view'.":"Failed to access Google Sheet."),g(!1);return}const _e=await je.text();if(!_e.trim()){Z.error("Google Sheet appears to be empty"),g(!1);return}const ve=Oa.read(_e,{type:"string",raw:!0}),Pe=ve.Sheets[ve.SheetNames[0]];if(!Pe){Z.error("No sheet found in Google Sheet"),g(!1);return}const We=Oa.utils.sheet_to_json(Pe,{raw:!0,defval:""});if(!We||We.length===0){Z.error("No data found in Google Sheet"),g(!1);return}await Q(We,"Google Sheet")}catch(me){(me==null?void 0:me.name)!=="AbortError"&&(console.error(me),Z.error("Error processing Google Sheet"))}finally{g(!1),G.abort()}},ge=()=>{i(null),o(""),c([]),p([]),P([]),x([]),$(!1),g(!1),d(!1),a()},ee=()=>{if(m){Z.info("Please wait for import to complete");return}ge()},de=G=>{var Fe,$e;const me=((Fe=G.target.files)==null?void 0:Fe[0])??null;if(!me)return;const oe=(($e=me.name.split(".").pop())==null?void 0:$e.toLowerCase())??"";if(!["csv","xlsx","xls"].includes(oe)){Z.error("Please upload only Excel (.xlsx, .xls) or CSV files");return}i(me)},U=G=>{G.preventDefault(),G.stopPropagation(),(G.type==="dragenter"||G.type==="dragover")&&d(!0),G.type==="dragleave"&&d(!1)},X=G=>{var me;if(G.preventDefault(),G.stopPropagation(),d(!1),G.dataTransfer.files&&G.dataTransfer.files[0]){const oe=G.dataTransfer.files[0],Fe=((me=oe.name.split(".").pop())==null?void 0:me.toLowerCase())??"";["csv","xlsx","xls"].includes(Fe)?i(oe):Z.error("Please upload only Excel (.xlsx, .xls) or CSV files")}},re=()=>{if(!u.length){Z.info("No skipped rows to export");return}const G=["Row","Errors","Raw Data"],me=u.map(je=>{const _e=Array.isArray(je.errors)?je.errors.join(" | "):String(je.errors??je.reason??""),ve=JSON.stringify(je.data??{}).replace(/"/g,'""');return`"${je.row}","${_e}","${ve}"`}),oe=[G.join(","),...me].join(`
`),Fe=new Blob([`\uFEFF${oe}`],{type:"text/csv;charset=utf-8"}),$e=URL.createObjectURL(Fe),Le=document.createElement("a");Le.href=$e,Le.download=`buyers_import_errors_${new Date().toISOString().slice(0,19).replace(/[-:T]/g,"")}.csv`,document.body.appendChild(Le),Le.click(),document.body.removeChild(Le),URL.revokeObjectURL($e),Z.success("ðŸ“¤ Error report exported successfully")},fe=G=>G==null||isNaN(G)?"â€”":G>=1e7?`â‚¹${(G/1e7).toFixed(1)}Cr`:G>=1e5?`â‚¹${(G/1e5).toFixed(1)}L`:`â‚¹${Number(G).toLocaleString("en-IN")}`;return e.jsxs(e.Fragment,{children:[e.jsx(ma,{isOpen:s,onClose:ee,title:"Import Buyers",width:"max-w-5xl",children:e.jsxs("div",{className:"space-y-6 p-2",children:[e.jsx("div",{className:"border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Import Buyers"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Import buyers from Excel files or Google Sheets"})]})]}),e.jsx("button",{onClick:ee,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(ns,{className:"w-5 h-5 text-gray-400 hover:text-gray-600"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Upload File"})]}),e.jsx("input",{ref:D,type:"file",accept:".csv,.xlsx,.xls",onChange:de,className:"hidden"}),e.jsx("div",{role:"button",tabIndex:0,onClick:()=>{var G;return(G=D.current)==null?void 0:G.click()},onKeyDown:G=>{var me;return(G.key==="Enter"||G.key===" ")&&((me=D.current)==null?void 0:me.click())},className:`relative border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200 cursor-pointer ${b?"border-blue-400 bg-blue-50":r?"border-green-400 bg-green-50":"border-gray-300 hover:border-gray-400 bg-gray-50"}`,onDragEnter:U,onDragLeave:U,onDragOver:U,onDrop:X,children:r?e.jsxs("div",{className:"space-y-2 select-none",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-sm font-medium text-green-700 truncate",children:r.name}),e.jsx("p",{className:"text-xs text-green-600",children:"Click to change file"})]}):e.jsxs("div",{className:"space-y-2 select-none",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Drop file or click to upload"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Excel (.xlsx, .xls) or CSV files"})]})}),e.jsx(ss,{onClick:he,disabled:!r||m,className:"mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 text-sm rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):"Import from File"})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Google Sheets"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"https://docs.google.com/spreadsheets/... (supports gid=TAB_ID)",value:n,onChange:G=>o(G.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 mt-0.5 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-xs leading-5 text-blue-700",children:[e.jsx("p",{className:"font-medium mb-1",children:"Make sure your Google Sheet is:"}),e.jsxs("ul",{className:"space-y-0.5",children:[e.jsx("li",{children:"â€¢ Anyone with link can view"}),e.jsx("li",{children:"â€¢ Headers same as template"}),e.jsx("li",{children:"â€¢ Phone numbers are text"}),e.jsxs("li",{children:["â€¢ Optional: add ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"gid="})," in the URL to select a specific tab"]})]})]})]})})]}),e.jsx(ss,{onClick:se,disabled:!n.trim()||m,className:"mt-4 w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 text-sm rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Importing..."]}):"Import from Google Sheet"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Buyer Assignment"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${M==="none"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${L?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{type:"radio",className:"accent-blue-600",checked:M==="none",onChange:()=>!L&&A("none"),disabled:L}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"No Assignment"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Buyers will not be assigned to any executive"})]})]}),e.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${M==="selected"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${L?"border-blue-500 bg-blue-50":""}`,children:[e.jsx("input",{type:"radio",className:"accent-blue-600",checked:M==="selected"||L,onChange:()=>A("selected"),disabled:L}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:L?"Assigned to you":"Assign to selected executives"}),e.jsx("p",{className:"text-xs text-gray-500",children:L?"All imported buyers will be assigned to you automatically":"Buyers will be distributed evenly among selected executives"})]})]})]}),!L&&M==="selected"&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"relative",ref:I,children:[e.jsxs("button",{type:"button",onClick:()=>j(G=>!G),className:"w-full flex items-center justify-between rounded-md border border-gray-300 bg-white px-3 py-2 text-sm hover:border-gray-400 transition-colors",children:[e.jsx("span",{className:"truncate",children:W.size>0?`${W.size} executive(s) selected`:"Select executives"}),e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),T&&e.jsxs("div",{className:"absolute z-20 mt-1 w-full rounded-md border border-gray-300 bg-white shadow-lg",children:[e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{type:"text",value:E,onChange:G=>V(G.target.value),placeholder:"Search executive...",className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsx("div",{className:"max-h-56 overflow-auto",children:y?e.jsx("div",{className:"p-3 text-sm text-gray-500 text-center",children:"Loading executives..."}):h.length===0?e.jsx("div",{className:"p-3 text-sm text-gray-500 text-center",children:"No executives found"}):h.map(G=>e.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"accent-blue-600",checked:W.has(G.id),onChange:()=>Y(G.id)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:G.name}),G.email&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:G.email})]})]},G.id))}),h.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-2 border-t bg-gray-50",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ss,{variant:"outline",onClick:K,className:"px-2 py-1 text-xs h-auto",children:"Select All"}),e.jsx(ss,{variant:"outline",onClick:q,className:"px-2 py-1 text-xs h-auto",children:"Clear"})]}),e.jsx(ss,{variant:"outline",onClick:()=>j(!1),className:"px-2 py-1 text-xs h-auto",children:"Done"})]})]})]}),W.size>0&&e.jsxs("p",{className:"mt-2 text-xs text-gray-600",children:["Buyers will be distributed evenly among ",W.size," selected executive(s) in round-robin fashion."]})]})]}),e.jsx("div",{className:"p-4 border rounded-lg bg-amber-50 border-amber-200",children:e.jsxs("div",{className:"text-xs text-amber-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Required fields:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium",children:"Name*"}),e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium",children:"Phone*"})]}),e.jsx("p",{className:"mt-2",children:"Email, budgets, and requirements are optional."})]})})]})]}),v.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Preview"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"text-green-600",size:20}),e.jsxs("span",{className:"text-green-600 font-medium",children:[v.length," buyer",v.length>1?"s":""," ready to import"]})]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs("div",{className:"space-y-3",children:[v.slice(0,5).map((G,me)=>{var oe;return e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 text-sm",children:[e.jsx("div",{children:e.jsxs("span",{className:"font-medium",children:[G.salutation?`${G.salutation} `:"",G.name]})}),e.jsxs("div",{className:"text-gray-600",children:[G.phone||"â€”"," â€¢ ",G.email||"â€”"]}),e.jsxs("div",{className:"text-gray-600 truncate",children:[G.location||"â€”",G.city?`, ${G.city}`:""]}),e.jsxs("div",{className:"text-green-600 font-medium",children:[fe(G.budget_min)," - ",fe(G.budget_max)]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Pref: ",((oe=G.requirements)==null?void 0:oe.propertyType)||"â€”"," â€¢ Stage: ",G.buyer_lead_stage||"â€”"," â€¢ Priority: ",G.buyer_lead_priority||"â€”"]})]},me)}),v.length>5&&e.jsxs("div",{className:"text-center text-gray-500 text-sm",children:["â€¦ and ",v.length-5," more buyers"]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[e.jsx(ss,{onClick:xy,className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-medium py-3 rounded-lg transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Ys,{className:"w-5 h-5"}),"Download Template"]})}),u.length>0&&e.jsx(ss,{variant:"outline",onClick:re,className:"flex-1 sm:flex-none border-2 border-gray-300 hover:border-gray-400 text-gray-700 font-medium py-3 px-8 rounded-lg transition-colors",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(yu,{className:"w-5 h-5"}),"Export Skipped"]})}),e.jsx(ss,{variant:"outline",onClick:ee,className:"flex-1 sm:flex-none border-2 border-gray-300 hover:border-gray-400 text-gray-700 font-medium py-3 px-8 rounded-lg transition-colors",children:"Cancel"})]})]})}),e.jsx(dy,{isOpen:w,onClose:()=>$(!1),duplicates:N,skippedRows:u,updatedRows:f})]})}const uy=({isOpen:s,onClose:a,filters:t,setFilters:r,resetFilters:i,sources:n,stages:o,priorities:m,budgetRanges:g,propertyTypes:b,executives:d})=>{if(typeof window>"u")return null;l.useEffect(()=>{if(!s)return;const u=c=>{c.key==="Escape"&&a()};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[s,a]),l.useEffect(()=>{if(!s)return;const u=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=u}},[s]),l.useEffect(()=>{t!=null&&t.ignoreDate&&(t.dateFrom||t.dateTo)&&r(u=>({...u,dateFrom:"",dateTo:""}))},[t==null?void 0:t.ignoreDate,r]);const v=(u,c)=>r(f=>({...f,[u]:c})),x=()=>{a()};return Il.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:a,"aria-hidden":!s,className:`fixed inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-200 ${s?"opacity-100 pointer-events-auto z-40":"opacity-0 pointer-events-none"}`}),e.jsxs("aside",{role:"dialog","aria-modal":"true","aria-labelledby":"buyer-filter-title",className:`fixed top-0 right-0 h-full w-full sm:w-[380px] bg-gradient-to-b from-indigo-50 via-white to-purple-50 shadow-2xl transform transition-transform duration-300 ease-out z-50
          ${s?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-indigo-500 to-purple-500 text-white",children:[e.jsx("h3",{id:"buyer-filter-title",className:"text-sm font-semibold tracking-wide",children:"Filters"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{i()},className:"text-xs bg-white/20 px-2 py-1 rounded hover:bg-white/30",children:"Reset"}),e.jsx("button",{onClick:a,"aria-label":"Close filters",className:"p-1 rounded-full bg-white/20 hover:bg-white/30 transition",children:e.jsx(ns,{size:18})})]})]}),e.jsxs("div",{className:"p-4 overflow-y-auto h-[calc(100%-56px)] text-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Source"}),e.jsx("select",{value:t.source,onChange:u=>v("source",u.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:n.map(u=>e.jsx("option",{value:u,children:u==="all"?"All":u},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Stage"}),e.jsx("select",{value:t.stage,onChange:u=>v("stage",u.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:o.map(u=>e.jsx("option",{value:u,children:u==="all"?"All":u.replace("_"," ").replace(/\b\w/g,c=>c.toUpperCase())},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("select",{value:t.priority,onChange:u=>v("priority",u.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:m.map(u=>e.jsx("option",{value:u,children:u==="all"?"All":u.charAt(0).toUpperCase()+u.slice(1)},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Budget"}),e.jsx("select",{value:t.budgetRange,onChange:u=>v("budgetRange",u.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:g.map(u=>e.jsx("option",{value:u,children:u==="all"?"All":u},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsx("select",{value:t.propertyType,onChange:u=>v("propertyType",u.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:b.map(u=>e.jsx("option",{value:u,children:u==="all"?"All":u},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Executive"}),e.jsxs("select",{value:t.assigned_executive,onChange:u=>v("assigned_executive",u.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:[e.jsx("option",{value:"all",children:"All"}),d.map(u=>e.jsx("option",{value:String(u.id),children:u.name},u.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:t.dateFrom,onChange:u=>v("dateFrom",u.target.value),disabled:t.ignoreDate,className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:t.dateTo,onChange:u=>v("dateTo",u.target.value),disabled:t.ignoreDate,className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!t.ignoreDate,onChange:u=>v("ignoreDate",u.target.checked),className:"h-4 w-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Ignore Date"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{i()},className:"px-3 py-1 text-xs text-gray-600 hover:text-gray-800","aria-label":"Reset filters",children:"Reset"}),e.jsx("button",{onClick:x,className:"px-3 py-1 bg-purple-600 text-white rounded text-xs hover:bg-purple-700","aria-label":"Apply filters",children:"Apply"})]})]})]})]})]}),document.body)},gy={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"},md=({colSpan:s,message:a="Loading...",size:t="md",className:r})=>e.jsx("tr",{children:e.jsx("td",{colSpan:s,className:"px-3 py-16",children:e.jsxs("div",{className:$t("flex items-center justify-center space-x-3",r),children:[e.jsx("div",{className:$t("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",gy[t])}),e.jsx("span",{className:"text-sm text-gray-600",children:a})]})})}),hy=(s,a,t,r=!1)=>{if(!s||!Array.isArray(a)||a.length===0)return[];const i=(s.role||"").toLowerCase(),n=String(s.id||"");return i.includes("admin")||i.includes("manager")||i.includes("superadmin")||i.includes("owner")?a:i.includes("executive")?a.filter(g=>{const b=String(g.assigned_executive??"");return!!(b===n||r&&(!b||b==="null"))}):[]},py=()=>{var ba;const s=Ca(),{user:a}=Hs(),t=Ws(a,"buyer.read"),r=Ws(a,"buyer.create"),i=Ws(a,"buyer.update"),n=Ws(a,"buyer.delete"),o=Ws(a,"data.import"),m=Ws(a,"data.export"),g=Ws(a,"buyer.assign"),b=Ws(a,"buyer.bulk_delete"),d=i||n||g,v=t&&(d||!0),x=l.useMemo(()=>{const be=((a==null?void 0:a.role)||"").toLowerCase();return be.includes("admin")||be.includes("manager")||be.includes("superadmin")},[a]),u=l.useMemo(()=>((a==null?void 0:a.role)||"").toLowerCase().includes("executive"),[a]),c=be=>t,f=be=>i?x?!0:u?String(be.assigned_executive)===String(a==null?void 0:a.id):!1:!1,p=be=>n?x?!0:u?String(be.assigned_executive)===String(a==null?void 0:a.id):!1:!1;if(!t)return e.jsx("div",{className:"h-full flex flex-col bg-gray-50",children:e.jsx("div",{className:"flex-1 grid place-items-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("div",{className:"text-gray-600 text-sm",children:"You do not have permission to view buyers."})]})})});const[N,P]=l.useState("all"),[w,$]=l.useState(""),[y,k]=l.useState([]),[R,F]=l.useState(!1),[T,j]=l.useState(null),[E,V]=l.useState(null),[W,B]=l.useState(!1),[M,A]=l.useState(!1),[L,D]=l.useState(null),[I,H]=l.useState(0),[h,Y]=l.useState(1),[K,q]=l.useState(25),[ne,le]=l.useState("table"),[S,C]=l.useState(!1),[J,ue]=l.useState(!0),[Q,he]=l.useState([]),[se,ge]=l.useState(!1),[ee,de]=l.useState([{id:0,name:"Not assigned",email:"",phone:""}]),[U,X]=l.useState(!0),[re,fe]=l.useState(!1),[G,me]=l.useState(""),[oe,Fe]=l.useState(null),[$e,Le]=l.useState(!1),je=l.useRef(null),_e=l.useRef(null),[ve,Pe]=l.useState({dateFrom:"",dateTo:"",ignoreDate:!1,source:"all",stage:"all",priority:"all",assigned:"all",assigned_executive:"all",status:"all",budgetRange:"all",propertyType:"all"}),[We,pe]=l.useState([]),[O,Ie]=l.useState([]);l.useEffect(()=>{(async()=>{try{ge(!0);const es=await As.getProperties(),Ss=(Array.isArray(es==null?void 0:es.data)?es.data:Array.isArray(es)?es:[]).filter(qs=>qs.is_public===!0||qs.is_public===1||qs.isPublic===!0||qs.public===!0);he(Ss??[])}catch{he([])}finally{ge(!1)}})()},[]);const ze=be=>{var Vs,us;const es=Number(((Vs=be==null?void 0:be.budget)==null?void 0:Vs.min)??0),hs=Number(((us=be==null?void 0:be.budget)==null?void 0:us.max)??0),Ss=Number.isFinite(es)&&es>0?es:null,qs=Number.isFinite(hs)&&hs>0?hs:null;return{min:Ss,max:qs}},xe=be=>Number((be==null?void 0:be.budget)??(be==null?void 0:be.price)??(be==null?void 0:be.expected_price)??0),Ee=be=>{const es=Number((be==null?void 0:be.min_price)??(be==null?void 0:be.budget_min)??(be==null?void 0:be.minBudget)??0),hs=Number((be==null?void 0:be.max_price)??(be==null?void 0:be.budget_max)??(be==null?void 0:be.maxBudget)??0);return{min:es,max:hs}},Ke=(be,es)=>{const{min:hs,max:Ss}=ze(es),qs=hs!=null,Vs=Ss!=null;if(!qs&&!Vs)return!1;const{min:us,max:Zs}=Ee(be);if(!!us&&!!Zs&&Zs>=us){const Rt=qs?hs:Number.NEGATIVE_INFINITY,Ma=Vs?Ss:Number.POSITIVE_INFINITY;return Math.max(us,Rt)<=Math.min(Zs,Ma)}const xt=xe(be);return!(!xt||qs&&xt<hs||Vs&&xt>Ss)},Xe=be=>Q.length?Q.filter(hs=>Ke(hs,be)).length:0;l.useEffect(()=>{!Q.length||!We.length||pe(be=>be.map(es=>({...es,matchedPropertiesCount:Xe(es)})))},[Q]),l.useEffect(()=>{(async()=>{try{X(!0);const es=us=>{const Zs=us!=null&&us.salutation?`${us.salutation} `:"",mt=(us==null?void 0:us.first_name)||(us==null?void 0:us.firstName)||"",xt=(us==null?void 0:us.last_name)||(us==null?void 0:us.lastName)||"",Rt=`${Zs}${mt} ${xt}`.trim();return Rt||(us!=null&&us.name?us.name:us!=null&&us.full_name?us.full_name:us!=null&&us.username?us.username:us!=null&&us.email?us.email.split("@")[0]:"Sales Executive")};let hs=[];try{if(Os.getSalesExecutives){const us=await Os.getSalesExecutives();us&&(Array.isArray(us)||us.items||us.data)&&(hs=Array.isArray(us)?us:us.items||us.data||[])}}catch{}if(hs.length===0&&Os.getByDeptRole){const us=[{department:"Sales",role:"Sales Executive"},{department:"sales",role:"sales executive"},{department:"Sales",role:"Executive"},{department:"sales",role:"executive"}];for(const Zs of us)try{const mt=await Os.getByDeptRole({...Zs,is_active:1,limit:100});if(mt&&(Array.isArray(mt)||mt.items||mt.data)){const xt=Array.isArray(mt)?mt:mt.items||mt.data||[];if(xt.length>0){hs=xt;break}}}catch{continue}}if(hs.length===0&&Os.getAll)try{const us=await Os.getAll({is_active:!0}),Zs=Array.isArray(us)?us:(us==null?void 0:us.items)||(us==null?void 0:us.data)||[];Zs.length>0&&(hs=Zs.filter(mt=>{const xt=String(mt.department||"").toLowerCase(),Rt=String(mt.role||"").toLowerCase();return(xt.includes("sales")||Rt.includes("sales"))&&(Rt.includes("executive")||Rt.includes("sales"))}))}catch{}if(hs.length===0&&Os.getUsers)try{const us=await Os.getUsers(),Zs=Array.isArray(us)?us:(us==null?void 0:us.items)||(us==null?void 0:us.data)||[];Zs.length>0&&(hs=Zs.filter(mt=>{const xt=String(mt.department||"").toLowerCase(),Rt=String(mt.role||"").toLowerCase();return(xt.includes("sales")||Rt.includes("sales"))&&(Rt.includes("executive")||Rt.includes("sales"))}))}catch{}const qs=hs.map(us=>{const Zs=us.id||us.userId||us._id||us.uuid||`exec-${Date.now()}-${Math.random()}`;return{id:Number(Zs)||0,name:es(us),email:us.email||null,phone:us.phone||us.mobile||us.contact_number||null,username:us.username||null,department:us.department||"Sales",role:us.role||"Sales Executive"}}).filter((us,Zs,mt)=>Zs===mt.findIndex(xt=>String(xt.id)===String(us.id)&&xt.id!==0)),Vs=Da(a,qs);de(Vs),Vs.length<=1}catch{de([{id:0,name:"Not assigned",email:"",phone:""}]),["executive","sales"].includes(a==null?void 0:a.role)||Z.error("Failed to load sales executives")}finally{X(!1)}})()},[a]),l.useEffect(()=>{function be(es){_e.current&&!_e.current.contains(es.target)&&fe(!1)}return re&&document.addEventListener("mousedown",be),()=>document.removeEventListener("mousedown",be)},[re]);const ye=ee.filter(be=>G.trim()===""?!0:be.name.toLowerCase().includes(G.toLowerCase())||be.email&&be.email.toLowerCase().includes(G.toLowerCase())||be.phone&&be.phone.includes(G)||be.department&&be.department.toLowerCase().includes(G.toLowerCase())||be.role&&be.role.toLowerCase().includes(G.toLowerCase())),[Ce,_]=l.useState(!0),[ae,ke]=l.useState({}),Me=be=>String(be??"").trim().toLowerCase().replace(/[^\w]+/g,"_"),Ye=be=>{const es={};return Object.entries(be||{}).forEach(([hs,Ss])=>{es[Me(hs)]=Ss}),es},ie=(be,es)=>{for(const hs of es){const Ss=Me(hs);if(Array.isArray(be==null?void 0:be[Ss])&&be[Ss].length)return be[Ss]}return[]};l.useEffect(()=>{(async()=>{try{_(!0);const es=await Gt(["lead","buyer"]),hs=Ye(es);ke(hs)}catch{Z.error("Failed to load dropdown options")}finally{_(!1)}})()},[]);const we=be=>((be==null?void 0:be.label)??(be==null?void 0:be.name)??(be==null?void 0:be.title)??(be==null?void 0:be.value)??(be==null?void 0:be.key)??"").toString(),Be=be=>((be==null?void 0:be.value)??(be==null?void 0:be.key)??(be==null?void 0:be.code)??(be==null?void 0:be.name)??"").toString(),Ve=ie(ae,["buyer_lead_stage","buyer stage"]),Je=ie(ae,["lead_priority","lead priority"]),Ue=Ve.map(be=>({value:Be(be),label:we(be)})).filter(be=>be.value),Oe=Je.map(be=>({value:Be(be).toLowerCase(),label:we(be)})).filter(be=>be.value),rs=[{value:"initial_contact",label:"Initial Contact"},{value:"requirement_gathering",label:"Requirement Gathering"},{value:"property_hunting",label:"Property Hunting"},{value:"loan_processing",label:"Loan Processing"},{value:"property_finalization",label:"Property Finalization"},{value:"deal_closure",label:"Deal Closure"},{value:"completed",label:"Completed"}],ms=[{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}],cs=Ue!=null&&Ue.length?Ue:rs,gs=Oe!=null&&Oe.length?Oe:ms,Ne=["all",...cs.map(be=>be.value)],Ze=["all",...gs.map(be=>be.value)],ls=be=>{if(!be)return" - ";const es=new Date(be);return isNaN(es.getTime())?" - ":es.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"2-digit"})},$s=be=>{if(!be)return null;const es=new Date(be);if(isNaN(es.getTime()))return null;const hs=es.getFullYear(),Ss=String(es.getMonth()+1).padStart(2,"0"),qs=String(es.getDate()).padStart(2,"0");return`${hs}-${Ss}-${qs}`},Gs=be=>{if(!be)return" - ";const es=new Date(be);if(isNaN(es.getTime()))return" - ";const hs=String(es.getDate()).padStart(2,"0"),Ss=String(es.getMonth()+1).padStart(2,"0"),qs=es.getFullYear();return`${hs}/${Ss}/${qs}`},Se=be=>{if(!be)return null;if(typeof be=="string")try{return JSON.parse(be)}catch{return null}return typeof be=="object"?be:null},Ge=be=>{if(be==null||be==="")return null;const es=Number(be);return Number.isFinite(es)?es:null},z=be=>String(be??"").trim().toLowerCase(),te=be=>z(be).replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""),ce=be=>z(be),Re=l.useCallback(be=>{if(!be||be===0)return{name:"Not assigned",isCurrentUser:!1};if(String(be)===String(a==null?void 0:a.id))return{name:(a==null?void 0:a.name)||"You",isCurrentUser:!0};const hs=ee.find(Ss=>String(Ss.id)===String(be));return hs?{name:hs.name,isCurrentUser:!1}:{name:`Executive (ID: ${be})`,isCurrentUser:!1}},[a,ee]),Te=l.useCallback(be=>{var Ar;const es=Se(be.requirements)||be.requirements||{},hs=Se(be.financials)||be.financials||{},Ss=nt=>nt==null?null:String(nt),qs=Ge(be.budget_min??be.budgetMin),Vs=Ge(be.budget_max??be.budgetMax),us=$s(be.dob??null),Zs=$s(be.expected_close??be.expectedClose??null),mt=$s(be.created_at??null),xt=be.assigned_executive??be.assigned_to??null,{name:Rt,isCurrentUser:Ma}=Re(xt),hr=be.matchedPropertiesCount||(()=>{if(Q.length>0){const nt={id:be.id,budget:{min:qs,max:Vs}};return Xe(nt)}return 0})();return{id:be.id??`${be.name??"buyer"}-${Math.random().toString(36).slice(2)}`,salutation:be.salutation??null,name:be.name??null,phone:be.phone??be.mobile??null,whatsapp:be.whatsapp_number??be.whatsapp??null,email:be.email??null,dob:us,state:be.state??null,city:be.city??null,location:be.location??null,source:be.buyer_lead_source??be.source??null,priority:((Ar=be.buyer_lead_priority??be.priority??null)==null?void 0:Ar.toString().trim().toLowerCase())??null,is_active:be.is_active!==void 0?!!be.is_active:!0,stage:be.buyer_lead_stage??be.stage??null,status:be.buyer_lead_status??be.status??null,assigned:be.assigned_to??be.assigned??null,assigned_executive:xt,assigned_executive_name:Rt!=="Not assigned"?Rt:null,assigned_executive_email:null,assigned_executive_phone:null,leadScore:Ge(be.lead_score)??Ge(be.leadScore)??0,budget:{min:qs,max:Vs},expectedClose:Zs,requirements:{propertyType:Ss(es.propertyType??es.property_type??be.propertyType??be.property_type??null),unitTypes:Array.isArray(es.unitTypes??es.unit_types)?(es.unitTypes??es.unit_types).map(Ss):null,preferredLocations:Array.isArray(es.preferredLocations??es.preferred_locations)?(es.preferredLocations??es.preferred_locations).map(Ss):null,amenities:Array.isArray(es.amenities)?es.amenities.map(Ss):null,furnishing:Ss(es.furnishing),possession:Ss(es.possession),facing:Ss(es.facing),floor:Ss(es.floor),specialRequirements:es.specialRequirements??es.special_requirements??null},financials:{loanRequired:hs.loanRequired??hs.loan_required??null,loanAmount:Ge(hs.loanAmount??hs.loan_amount),downPayment:Ge(hs.downPayment??hs.down_payment),monthlyIncome:Ge(hs.monthlyIncome??hs.monthly_income),bankPreference:hs.bankPreference??hs.bank_preference??null,loanStatus:hs.loanStatus??hs.loan_status??null,creditScore:Ge(hs.creditScore??hs.credit_score)},matchedProperties:Array.isArray(be.matchedProperties)?be.matchedProperties:[],matchedPropertiesCount:hr,activities:Array.isArray(be.activities)?be.activities:[],followups:Array.isArray(be.followups)?be.followups:[],documents:Array.isArray(be.documents)?be.documents:[],visits:Ge(be.visits)??0,totalVisits:Ge(be.totalVisits)??0,lastActivity:be.lastActivity??be.updated_at??null,created_at:mt||new Date().toISOString(),notifications:Ge(be.notifications)??0,currentStage:be.currentStage??be.buyer_lead_stage??be.stage??null,stageProgress:Ge(be.stageProgress)??0,dealPotential:be.dealPotential??null,responseRate:Ge(be.responseRate)??0,avgResponseTime:be.avgResponseTime??null}},[Re,Q]),qe=l.useCallback(async()=>{try{ue(!0);const be=await Vt.getAll();if(!Array.isArray(be)){pe([]);return}const Ss=[...be.map(Te).reduce((qs,Vs)=>(qs.some(Zs=>!!(Zs.id===Vs.id||Zs.phone&&Vs.phone&&Zs.phone===Vs.phone||Zs.email&&Vs.email&&Zs.email.toLowerCase()===Vs.email.toLowerCase()))?console.warn("Duplicate buyer filtered:",{id:Vs.id,name:Vs.name,phone:Vs.phone}):qs.push(Vs),qs),[])].sort((qs,Vs)=>{const us=new Date(qs.created_at||0).getTime(),Zs=new Date(Vs.created_at||0).getTime();return us!==Zs?Zs-us:Number(Vs.id)-Number(qs.id)});pe(Ss)}catch{Z.error("Failed to fetch buyers"),pe([])}finally{ue(!1)}},[Te]);l.useEffect(()=>{qe()},[qe]),l.useEffect(()=>{if(We.length>0&&a){const be=hy(a,We,ee,$e);Ie(be)}else Ie([])},[We,a,ee,$e]),l.useEffect(()=>{(async()=>{if(We.length>0&&ee.length>0){const es=We.map(Ss=>{if(Ss.assigned_executive){const{name:qs}=Re(Ss.assigned_executive);if(qs!==Ss.assigned_executive_name)return{...Ss,assigned_executive_name:qs}}return Ss});es.some((Ss,qs)=>{var Vs;return Ss.assigned_executive_name!==((Vs=We[qs])==null?void 0:Vs.assigned_executive_name)})&&pe(es)}})()},[ee,We,Re]);const as=[{id:"all",label:"All",count:O.length,color:"blue"},{id:"hot_leads",label:"Hot Leads",count:O.filter(be=>ce(be.priority)==="high").length,color:"red"},{id:"active",label:"Active",count:O.filter(be=>be.is_active===!0).length,color:"green"},{id:"property_hunting",label:"Property Hunting",count:O.filter(be=>te(be.stage)==="property_hunting").length,color:"purple"},{id:"loan_processing",label:"Loan Processing",count:O.filter(be=>te(be.stage)==="loan_processing").length,color:"orange"},{id:"ready_to_buy",label:"Ready to Buy",count:O.filter(be=>te(be.stage)==="property_finalization").length,color:"indigo"}],xs=["all","Website","Referral","Social Media","Advertisement","Walk-in","Cold Call"],ps=["all","0-50L","50L-1Cr","1Cr-2Cr","2Cr-5Cr","5Cr+"],ys=["all","Residential","Commercial"],He=be=>be==null||be===""?" - ":String(be),vs=be=>be==null?" - ":be>=1e7?`â‚¹${(be/1e7).toFixed(1)}Cr`:be>=1e5?`â‚¹${(be/1e5).toFixed(1)}L`:`â‚¹${be.toLocaleString("en-IN")}`,et=[...O.filter(be=>{var Ma;const es=w.toLowerCase(),hs=(be.name??"").toLowerCase().includes(es)||(be.phone??"").includes(w)||(be.email??"").toLowerCase().includes(es)||(be.location??"").toLowerCase().includes(es)||(be.assigned_executive_name??"").toLowerCase().includes(es),Ss=te(be.stage),qs=ce(be.priority),Vs=N==="all"||N==="hot_leads"&&qs==="high"||N==="active"&&be.is_active===!0||N==="property_hunting"&&Ss==="property_hunting"||N==="loan_processing"&&Ss==="loan_processing"||N==="ready_to_buy"&&Ss==="property_finalization",us=(ve.source==="all"||z(be.source)===z(ve.source))&&(ve.stage==="all"||Ss===ve.stage)&&(ve.priority==="all"||qs===ve.priority)&&(ve.assigned==="all"||z(be.assigned)===z(ve.assigned))&&(ve.assigned_executive==="all"||z(be.assigned_executive)===z(ve.assigned_executive))&&(ve.status==="all"||z(be.status)===z(ve.status))&&(ve.propertyType==="all"||z((Ma=be.requirements)==null?void 0:Ma.propertyType)===z(ve.propertyType)),Zs=be.created_at?new Date(be.created_at):null,mt=!ve.dateFrom||Zs&&Zs>=new Date(ve.dateFrom),xt=!ve.dateTo||Zs&&Zs<=new Date(ve.dateTo),Rt=ve.ignoreDate||mt&&xt;return hs&&Vs&&us&&Rt})].sort((be,es)=>{const hs=new Date(be.created_at||0).getTime(),Ss=new Date(es.created_at||0).getTime();if(hs!==Ss)return Ss-hs;const qs=new Date(be.lastActivity||0).getTime();return new Date(es.lastActivity||0).getTime()-qs}),ts=Math.max(1,Math.ceil(et.length/K)),js=(h-1)*K,Fs=et.slice(js,js+K),ht=()=>{D(null),F(!0)},vt=be=>{if(!f(be)){Z.error("You do not have permission to edit this buyer");return}D(be),F(!0)},De=be=>{if(!c()){Z.error("You do not have permission to view this buyer");return}const es=et.findIndex(hs=>hs.id===be.id);H(es>=0?es:0),j(be)},is=be=>{if(!c()){Z.error("You do not have permission to view this buyer account");return}s(`/dashboard/buyers-account/${be.id}`)},Qe=()=>{j(null),H(0),F(!1)},ds=async be=>{const es=We.find(hs=>hs.id===be);if(es){if(!p(es)){Z.error("You do not have permission to delete this buyer");return}if(window.confirm("Are you sure you want to delete this buyer?"))try{await Vt.delete(String(be)),pe(hs=>hs.filter(Ss=>Ss.id!==be)),Z.success("Buyer deleted successfully")}catch{Z.error("Failed to delete buyer. Please try again.")}}},os=async be=>{try{if(!be)throw new Error("No response received from server");const es=Te({...be,assigned_executive:be.assigned_executive??(a==null?void 0:a.id)??null});L?(pe(hs=>hs.map(Ss=>Ss.id===L.id?es:Ss)),Z.success("Buyer updated successfully")):(pe(hs=>[es,...hs]),Z.success("Buyer created successfully")),F(!1),D(null),Y(1),setTimeout(()=>{je.current&&je.current.scrollTo({top:0,behavior:"smooth"})},100)}catch(es){console.error("Error in handleSaveBuyer:",es),Z.error(es.message||"Failed to save buyer"),qe()}},zs=be=>{if(!O.find(hs=>hs.id===be)||!c()){Z.error("You do not have permission to select this buyer");return}k(hs=>hs.includes(be)?hs.filter(Ss=>Ss!==be):[...hs,be])},Us=()=>{const be=Fs.filter(es=>x?!0:u?String(es.assigned_executive)===String(a==null?void 0:a.id):!1);y.length===be.length&&be.length>0?k([]):k(be.map(es=>es.id))},pt=()=>{if(I<et.length-1){const be=I+1;H(be),j(et[be])}},Ht=()=>{if(I>0){const be=I-1;H(be),j(et[be])}},qt=async be=>{var es,hs,Ss;if(y.length===0){Z.info("Please select buyers to assign executive");return}if(!g){Z.error("You do not have permission to assign executives");return}if((es=a==null?void 0:a.role)!=null&&es.toLowerCase().includes("executive")&&be!==0&&String(be)!==String(a.id)){Z.error("You can only assign buyers to yourself");return}try{const qs=y.map(Zs=>String(Zs)),Vs=be===0?null:be,us=await Vt.bulkAssignExecutive(qs,Vs,!1);if(us.success){const Zs=ee.find(xt=>xt.id==be),mt=Zs?Zs.name:"Not assigned";pe(xt=>xt.map(Rt=>y.includes(Rt.id)?{...Rt,assigned_executive:Vs,assigned_executive_name:mt!=="Not assigned"?mt:null}:Rt)),k([]),Fe(null),fe(!1),Z.success(`Executive assigned to ${y.length} buyer(s) successfully`)}else Z.error(us.message||"Failed to assign executive")}catch(qs){Z.error(((Ss=(hs=qs.response)==null?void 0:hs.data)==null?void 0:Ss.message)||"Failed to assign executive")}},lt=()=>{if(y.length===0){Z.info("âš ï¸ No buyers selected for deletion.",{position:"top-center"});return}const es=We.filter(Ss=>y.includes(Ss.id)).filter(Ss=>!p(Ss));if(es.length>0){Z.error(`You do not have permission to delete ${es.length} buyer(s)`);return}const hs=y.map(Ss=>String(Ss));Z(({closeToast:Ss})=>e.jsxs("div",{className:"flex flex-col items-center text-center space-y-3 p-3",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Do you want to delete ",e.jsx("b",{children:hs.length})," selected buyer(s)?"]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{className:"px-4 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700",onClick:async()=>{const qs=We;try{C(!0),pe(Vs=>Vs.filter(us=>!hs.includes(String(us.id)))),k([]),await Vt.bulkDelete(hs,!1),Z.success(`ðŸ—‘ï¸ ${hs.length} buyer(s) deleted successfully.`)}catch{pe(qs),Z.error("âŒ Failed to delete buyers. Try again.")}finally{C(!1),Ss==null||Ss()}},children:"âœ… Yes, Delete"}),e.jsx("button",{className:"px-4 py-1 bg-gray-300 text-gray-800 rounded text-xs hover:bg-gray-400",onClick:Ss,children:"âŒ Cancel"})]})]}),{autoClose:!1,closeOnClick:!1,draggable:!1,position:"top-center"})},xa=async(be,es,hs=!1)=>{if(y.length===0){Z.info("Please select buyers to update");return}if(!i){Z.error("You do not have permission to update buyers");return}const qs=We.filter(Vs=>y.includes(Vs.id)).filter(Vs=>!f(Vs));if(qs.length>0){Z.error(`You do not have permission to update ${qs.length} buyer(s)`);return}try{const Vs=y.map(Zs=>String(Zs)),us=await Vt.bulkUpdateLeadField(Vs,be,es,hs);us.success?(pe(Zs=>Zs.map(mt=>{if(!y.includes(mt.id))return mt;const xt={...mt};switch(be){case"buyer_lead_stage":xt.stage=es,xt.currentStage=es;break;case"buyer_lead_status":xt.status=es;break;case"buyer_lead_priority":xt.priority=es;break;case"is_active":xt.is_active=!!Number(es);break}return xt})),k([]),Z.success("Field updated successfully")):Z.error(us.message||"Failed to update field")}catch{Z.error("Failed to update field")}},At=(be="filtered")=>{let es=[];if(be==="selected"){if(es=O.filter(nt=>y.includes(nt.id)),y.length===0){Z.info("No buyers selected to export.");return}}else if(be==="filtered"){if(es=et,!es||es.length===0){Z.info("No buyers found in current view to export.");return}}else if(es=O,!es||es.length===0){Z.info("No buyers available to export.");return}const hs=[{key:"id",label:"ID"},{key:"name",label:"Name"},{key:"phone",label:"Phone"},{key:"email",label:"Email"},{key:"city",label:"City"},{key:"state",label:"State"},{key:"location",label:"Location"},{key:"source",label:"Source"},{key:"priority",label:"Priority"},{key:"stage",label:"Stage"},{key:"assigned",label:"Assigned To"},{key:"assigned_executive_name",label:"Executive Name"},{key:"assigned_executive_email",label:"Executive Email"},{key:"assigned_executive_phone",label:"Executive Phone"},{key:"leadScore",label:"Lead Score"},{key:"budgetMin",label:"Budget Min"},{key:"budgetMax",label:"Budget Max"},{key:"matchedPropertiesCount",label:"Property Matches"},{key:"requirements",label:"Requirements"},{key:"created_at",label:"Created At"}],Ss=nt=>nt==null?"":`"${(typeof nt=="string"?nt:String(nt)).replace(/"/g,'""')}"`,qs=es.map(nt=>{var mo,un;const fa=nt.requirements??{},io=((mo=nt.budget)==null?void 0:mo.min)??"",oo=((un=nt.budget)==null?void 0:un.max)??"",Pr=[];fa.propertyType&&Pr.push(`Property:${fa.propertyType}`),Array.isArray(fa.unitTypes)&&fa.unitTypes.length&&Pr.push(`UnitTypes:${fa.unitTypes.join("|")}`),Array.isArray(fa.preferredLocations)&&fa.preferredLocations.length&&Pr.push(`Locations:${fa.preferredLocations.join("|")}`),fa.amenities&&Array.isArray(fa.amenities)&&Pr.push(`Amenities:${fa.amenities.join("|")}`);const co=Pr.join("; ");return{id:nt.id,name:nt.name,phone:nt.phone,email:nt.email,city:nt.city,state:nt.state,location:nt.location,source:nt.source,priority:nt.priority,stage:nt.stage,assigned:nt.assigned,assigned_executive_name:nt.assigned_executive_name,assigned_executive_email:nt.assigned_executive_email,assigned_executive_phone:nt.assigned_executive_phone,leadScore:nt.leadScore??"",budgetMin:io,budgetMax:oo,matchedPropertiesCount:nt.matchedPropertiesCount??0,requirements:co,created_at:nt.created_at?new Date(nt.created_at).toISOString():""}}),Vs=hs.map(nt=>Ss(nt.label)).join(","),us=qs.map(nt=>hs.map(fa=>Ss(nt[fa.key])).join(",")).join(`
`),mt="\uFEFF"+Vs+`
`+us,xt=new Blob([mt],{type:"text/csv;charset=utf-8;"}),Rt=URL.createObjectURL(xt),Ma=document.createElement("a");Ma.href=Rt;const hr=new Date,Ar=`${hr.getFullYear()}${String(hr.getMonth()+1).padStart(2,"0")}${String(hr.getDate()).padStart(2,"0")}_${String(hr.getHours()).padStart(2,"0")}${String(hr.getMinutes()).padStart(2,"0")}`;Ma.download=be==="selected"?`buyers_selected_${Ar}.csv`:be==="all"?`buyers_all_${Ar}.csv`:`buyers_filtered_${Ar}.csv`,document.body.appendChild(Ma),Ma.click(),Ma.remove(),URL.revokeObjectURL(Rt),Z.success("Exported CSV successfully")},gr=()=>{Pe({dateFrom:"",dateTo:"",ignoreDate:!1,source:"all",stage:"all",priority:"all",assigned:"all",assigned_executive:"all",status:"all",budgetRange:"all",propertyType:"all"})},St=()=>{let be=8;return(i||n||g||b)&&(be+=1),v&&(be+=1),be};return T?e.jsxs("div",{className:"buyers-page",children:[e.jsx(ty,{buyer:T,onBack:Qe,onEdit:vt,onAccount:is,onNext:pt,onPrevious:Ht,currentIndex:I,totalBuyers:et.length,onUpdateBuyer:be=>{pe(es=>es.map(Ss=>Ss.id===be.id?be:Ss).sort((Ss,qs)=>{const Vs=new Date(Ss.created_at||Ss.lastActivity||0).getTime();return new Date(qs.created_at||qs.lastActivity||0).getTime()-Vs})),j(be)}}),R&&e.jsx(um,{isOpen:R,buyer:L,onClose:()=>F(!1),onSave:os}),W&&e.jsx($m,{isOpen:W,onClose:()=>B(!1)})]}):e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 lg:px-6 py-3",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl",children:e.jsx(Ns,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"Buyer Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Complete buyer lifecycle from lead to property purchase"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o&&e.jsxs("button",{onClick:()=>B(!0),className:"flex items-center space-x-2 px-3 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all text-sm",children:[e.jsx(dt,{size:14}),e.jsx("span",{children:"Import"})]}),r&&e.jsxs("button",{onClick:ht,className:"flex items-center space-x-2 px-3 py-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all text-sm",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Buyer"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:as.map(be=>e.jsxs("button",{onClick:()=>{P(be.id),Y(1)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap text-sm font-medium ${N===be.id?`bg-${be.color}-100 text-${be.color}-700 border border-${be.color}-200`:"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{children:be.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${N===be.id?`bg-${be.color}-200`:"bg-gray-200"}`,children:be.count})]},be.id))})})]}),e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 lg:px-6 py-3",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 flex items-center space-x-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search buyers...",value:w,onChange:be=>{$(be.target.value),Y(1)},className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm"})]}),e.jsxs("button",{onClick:()=>A(!M),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[e.jsx(Na,{size:14}),e.jsx("span",{children:"Filters"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>le("table"),className:`p-2 rounded ${ne==="table"?"bg-purple-100 text-purple-600":"text-gray-400"}`,children:e.jsx(ws,{size:16})}),e.jsx("button",{onClick:()=>le("cards"),className:`p-2 rounded ${ne==="cards"?"bg-purple-100 text-purple-600":"text-gray-400"}`,children:e.jsx(Is,{size:16})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:K,onChange:be=>{q(Number(be.target.value)),Y(1)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),m&&e.jsxs("button",{onClick:()=>At("filtered"),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"Export"})]})]})]}),u&&e.jsxs("div",{className:"mt-3 bg-blue-50 border border-blue-100 rounded-lg px-4 py-2 text-xs text-blue-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2",children:e.jsx(La,{size:14,className:"text-blue-500"})}),e.jsxs("div",{children:[e.jsx("strong",{className:"font-semibold",children:"Visibility Note:"})," ","You are viewing ",O.length," buyer(s) -"," ",O.filter(be=>String(be.assigned_executive)===String(a==null?void 0:a.id)).length," assigned to you",$e&&O.filter(be=>!be.assigned_executive).length>0&&e.jsxs(e.Fragment,{children:[" + ",O.filter(be=>!be.assigned_executive).length," unassigned"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{className:"flex items-center text-[10px]",children:[e.jsx("input",{type:"checkbox",checked:$e,onChange:be=>Le(be.target.checked),className:"mr-1 h-3 w-3"}),"Show unassigned"]})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Quick:"}),["all",...cs.map(es=>es.value).slice(0,4)].map(es=>e.jsx("button",{onClick:()=>{Pe(es==="all"?hs=>({...hs,stage:"all",priority:"all"}):hs=>({...hs,stage:es})),Y(1)},className:`px-2 py-1 rounded-full text-xs font-medium transition-colors ${ve.stage===es?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:es==="all"?"All":es.replace(/_/g," ").replace(/\b\w/g,hs=>hs.toUpperCase())},es)),gs.map(be=>e.jsx("button",{onClick:()=>{Pe(es=>({...es,priority:be.value})),Y(1)},className:`px-2 py-1 rounded-full text-xs font-medium transition-colors ${ve.priority===be.value?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:be.label},be.value))]}),e.jsx(uy,{isOpen:M,onClose:()=>A(!1),filters:ve,setFilters:Pe,resetFilters:gr,sources:xs,stages:Ne,priorities:Ze,budgetRanges:ps,propertyTypes:ys,executives:ee.map(be=>({id:be.id,name:be.name}))})]}),y.length>0&&(i||g||b||m)&&e.jsx("div",{className:"bg-purple-50 border-b border-purple-200 px-4 lg:px-6 py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm font-medium text-purple-700",children:[y.length," selected"]}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[g&&e.jsxs("div",{className:"relative",ref:_e,children:[e.jsxs("button",{onClick:()=>fe(!re),className:"flex items-center space-x-2 px-3 py-1.5 bg-white border border-gray-300 rounded text-xs hover:bg-gray-50 transition-colors",children:[e.jsx(La,{size:12}),e.jsx("span",{children:"Assign Executive"}),oe&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded text-[10px]",children:((ba=ee.find(be=>be.id==oe))==null?void 0:ba.name)||"Selected"})]}),re&&e.jsxs("div",{className:"absolute top-10 left-0 z-50 w-64 bg-white border border-gray-200 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"p-3 border-b",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Assign Executive"}),e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search executives...",value:G,onChange:be=>me(be.target.value),className:"w-full pl-8 pr-3 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",autoFocus:!0})]})]}),e.jsx("div",{className:"max-h-64 overflow-auto",children:U?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Loading executives..."})]}):ye.length===0?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx(Ns,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:ee.length===0?"No executives available":"No matching executives"}),e.jsx("div",{className:"text-xs text-gray-500 mb-3",children:ee.length===0?"Create sales executives in User Management":"Try a different search term"}),ee.length===0&&i&&e.jsx("button",{onClick:()=>{s("/dashboard/users?role=Sales+Executive"),fe(!1)},className:"px-3 py-1.5 bg-purple-100 text-purple-700 rounded text-xs hover:bg-purple-200 transition-colors",children:"Go to User Management"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{qt(null),Fe(null),fe(!1),me("")},className:"w-full text-left px-3 py-2.5 text-sm text-gray-700 hover:bg-gray-50 border-b flex items-center transition-colors",children:[e.jsx(Mi,{size:14,className:"mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Unassign Executive"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Remove executive assignment"})]})]}),ye.filter(be=>be.id!==0).map(be=>e.jsx("button",{onClick:()=>{Fe(be.id),qt(be.id),fe(!1),me("")},className:`w-full text-left px-3 py-2.5 hover:bg-gray-50 border-b last:border-b-0 transition-colors ${oe==be.id?"bg-blue-50":""}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900 text-sm",children:[be.name,be.id===(a==null?void 0:a.id)&&e.jsx("span",{className:"ml-2 text-[10px] bg-green-100 text-green-700 px-1.5 py-0.5 rounded",children:"You"})]}),be.department||"Sales"," â€¢ ",be.role||"Sales Executive"]}),be.id!==0&&be.id===(a==null?void 0:a.id)&&e.jsx("span",{className:"text-[8px] bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded",children:"Current"})]})},be.id))]})})]})]}),i&&e.jsxs("select",{onChange:be=>{const es=be.target.value;es&&(xa("buyer_lead_stage",es),be.currentTarget.selectedIndex=0)},className:"px-3 py-1.5 border border-gray-300 rounded text-xs",children:[e.jsx("option",{value:"",children:"Update Stage"}),cs.map(be=>e.jsx("option",{value:be.value,children:be.label},be.value))]}),i&&e.jsxs("select",{onChange:be=>{const es=be.target.value;es&&(xa("buyer_lead_priority",es),be.currentTarget.selectedIndex=0)},className:"px-3 py-1.5 border border-gray-300 rounded text-xs",children:[e.jsx("option",{value:"",children:"Update Priority"}),gs.map(be=>e.jsx("option",{value:be.value,children:be.label},be.value))]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>xa("is_active",1),className:"px-3 py-1.5 bg-emerald-600 text-white rounded text-xs hover:bg-emerald-700 transition-colors",children:"Mark Active"}),e.jsx("button",{onClick:()=>xa("is_active",0),className:"px-3 py-1.5 bg-gray-600 text-white rounded text-xs hover:bg-gray-700 transition-colors",children:"Mark Inactive"})]}),m&&e.jsx("button",{onClick:()=>At("selected"),className:"px-3 py-1.5 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors",children:"Export"}),b&&e.jsx("button",{onClick:lt,disabled:S,className:"px-3 py-1.5 bg-red-600 text-white rounded text-xs hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:S?"Deleting...":"Delete"})]})]}),e.jsx("button",{onClick:()=>k([]),className:"text-purple-600 hover:text-purple-800 transition-colors",children:e.jsx(ns,{size:16})})]})}),e.jsx("div",{className:"flex-1 overflow-auto",ref:je,children:e.jsx("div",{className:"bg-white",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[(i||n||g||b)&&e.jsx("th",{className:"px-3 py-2 text-left w-8",children:e.jsx("input",{type:"checkbox",checked:y.length===Fs.length&&Fs.length>0,onChange:Us,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"})}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Buyer Details"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact & Location"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Business Info"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Assigned To"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Requirements & Budget"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Progress & Activity"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Performance"}),v&&e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:d?"Actions":"View"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100 ",children:J?e.jsx("tr",{children:e.jsx("td",{colSpan:St(),children:e.jsx("div",{className:"w-full flex items-center justify-center",children:e.jsx(md,{colSpan:St(),message:"Loading buyers...",size:"lg"})})})}):Fs.length>0?Fs.map(be=>{var Ss,qs,Vs;const{name:es,isCurrentUser:hs}=Re(be.assigned_executive);return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[(i||n||g||b)&&e.jsx("td",{className:"px-3 py-3",children:e.jsx("input",{type:"checkbox",checked:y.includes(be.id),onChange:()=>zs(be.id),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg",children:e.jsx(Ms,{className:"text-white",size:14})}),e.jsxs("div",{className:"text-[10px] text-[#0b3856] bg-[#0b3856]/10 px-2 py-0.5 rounded-md inline-block",children:["Id : ",be.id]})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>De(be),className:"font-semibold text-gray-900 text-sm hover:text-purple-600 text-left",children:[e.jsxs("div",{children:[He(be.salutation)," ",He(be.name)]}),be.dob&&e.jsx("div",{className:"text-gray-500 text-xs",children:Gs(be.dob)})]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[by(be.is_active),fy(be.leadScore)]})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(Cs,{size:10,className:"text-gray-400"}),e.jsx("span",{className:"font-medium",children:He(be.phone)})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(Ds,{size:10,className:"text-gray-400"}),e.jsx("span",{className:"truncate max-w-24",children:He(be.email)})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(Qs,{size:10,className:"text-gray-400"}),e.jsxs("span",{children:[He(be.location),be.city?`, ${be.city}`:""]})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Source:"})," ",e.jsx("span",{className:"font-medium text-blue-700",children:be.source||"Not specified"})]})}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("div",{className:"text-xs",children:jy(be.priority)})}),be.created_at&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",ls(be.created_at)]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"space-y-1",children:be.assigned_executive?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(La,{size:10,className:hs?"text-green-500":"text-blue-500"}),e.jsx("span",{className:`font-medium ${hs?"text-green-700":"text-blue-700"}`,children:es}),hs&&e.jsx("span",{className:"text-[8px] bg-green-100 text-green-700 px-1 rounded",children:"(You)"})]}),e.jsxs("div",{className:"text-[8px] text-gray-400",children:["ID: ",be.assigned_executive]})]}):e.jsx("span",{className:"text-xs text-gray-500",children:"Not assigned"})})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Property:"})," ",((Ss=be.requirements)==null?void 0:Ss.propertyType)||"â€”"]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Types:"})," ",He((qs=be.requirements)==null?void 0:qs.unitTypes)]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Budget:"}),e.jsxs("span",{className:"font-medium text-green-600 ml-1",children:[vs(be.budget.min)," - ",vs(be.budget.max)]})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-2",children:[yy(be.stage),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-1.5 rounded-full transition-all",style:{width:`${be.stageProgress||0}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last: ",ls(be.lastActivity)]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx(rt,{size:10,className:"text-green-500"}),e.jsxs("span",{className:`font-medium ${(be.matchedPropertiesCount||0)>0?"text-green-600":"text-gray-500"}`,children:[be.matchedPropertiesCount||0," matches"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx(jt,{size:10,className:"text-green-500"}),e.jsxs("span",{children:[((Vs=be.activities)==null?void 0:Vs.length)??0," activities"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx(ks,{size:10,className:"text-purple-500"}),e.jsxs("span",{children:[be.visits??0," visits"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx(Rs,{size:10,className:"text-orange-500"}),e.jsx("span",{children:be.responseRate?`${be.responseRate}% response`:" - "})]}),be.notifications>0&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(ha,{size:10,className:"text-red-500"}),e.jsx("span",{className:"text-red-600 font-medium",children:be.notifications})]})]})}),v&&e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>De(be),className:"p-1.5 text-purple-600 hover:bg-purple-100 rounded transition-colors",title:"View Details",children:e.jsx(ks,{size:14})}),e.jsx("button",{onClick:()=>is(be),className:"p-1.5 text-green-600 hover:bg-green-100 rounded transition-colors",title:"Buyer Account",children:e.jsx(La,{size:14})}),f(be)&&e.jsx("button",{onClick:()=>vt(be),className:"p-1.5 text-orange-600 hover:bg-orange-100 rounded transition-colors",title:"Edit",children:e.jsx(ft,{size:14})}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:e.jsx(xr,{size:14})}),e.jsx("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:e.jsxs("div",{className:"p-1",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(ju,{size:12}),e.jsx("span",{children:"Call"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(tt,{size:12}),e.jsx("span",{children:"WhatsApp"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(Dt,{size:12}),e.jsx("span",{children:"Email"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(yt,{size:12}),e.jsx("span",{children:"Send Properties"})]}),p(be)&&e.jsxs("button",{onClick:()=>ds(be.id),className:"flex items-center space-x-2 px-3 py-2 text-xs text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(Es,{size:12}),e.jsx("span",{children:"Delete"})]})]})})]})]})})]},be.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:St(),className:"px-3 py-8 text-center text-sm text-gray-500",children:O.length===0?u?e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(Ns,{className:"h-8 w-8 text-gray-300"}),e.jsx("div",{children:"No buyers assigned to you yet."}),e.jsx("div",{className:"text-xs text-gray-500",children:$e?"No buyers available (assigned or unassigned)":'Contact Admin to get assigned buyers or enable "Show unassigned" option.'}),!$e&&e.jsx("button",{onClick:()=>Le(!0),className:"mt-2 px-3 py-1 bg-blue-100 text-blue-600 rounded text-xs hover:bg-blue-200",children:"Show Unassigned Buyers"})]}):"No buyers found.":"No buyers match the current filters."})})})]})})}),e.jsx("div",{className:"bg-white border-t border-gray-200 px-4 lg:px-6 py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm text-gray-700",children:et.length>0?e.jsxs(e.Fragment,{children:["Showing ",js+1,"-",Math.min(js+K,et.length)," of ",et.length]}):"Showing 0-0 of 0"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Y(be=>Math.max(be-1,1)),disabled:h===1,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Wa,{size:14})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[Array.from({length:Math.min(5,ts)},(be,es)=>{const hs=es+1;return e.jsx("button",{onClick:()=>Y(hs),className:`px-2 py-1 rounded text-xs ${h===hs?"bg-purple-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:hs},hs)}),ts>5&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-1 text-xs",children:"..."}),e.jsx("button",{onClick:()=>Y(ts),className:`px-2 py-1 rounded text-xs ${h===ts?"bg-purple-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:ts})]})]}),e.jsx("button",{onClick:()=>Y(be=>Math.min(be+1,ts)),disabled:h===ts,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:14})})]})]})}),e.jsx(um,{isOpen:R,onClose:()=>{F(!1),D(null)},buyer:L,onSave:os}),e.jsx($m,{isOpen:W,onClose:()=>B(!1)})]})};function by(s){return s===!0?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700",children:"ðŸŸ¢ Active"}):s===!1?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"âš« Inactive"}):e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"â€“"})}function fy(s){const a=s>=80?"text-green-600":s>=60?"text-yellow-600":"text-red-600",t=s>=80?"bg-green-100":s>=60?"bg-yellow-100":"bg-red-100",r=s>0?s:" - ";return e.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded-full ${s>0?t:"bg-gray-100"} ${s>0?a:"text-gray-600"}`,children:[e.jsx(Xs,{size:12,className:"mr-1"}),e.jsx("span",{className:"text-xs font-bold",children:r})]})}function yy(s){const a=typeof s=="string"?s:(s==null?void 0:s.buyer_lead_stage)??(s==null?void 0:s.buyer_leadStage)??(s==null?void 0:s.stage)??"",t=String(a??"").trim(),r={initial_contact:{bg:"bg-blue-100",text:"text-blue-700",label:"Initial Contact",icon:"ðŸ“ž"},requirement_gathering:{bg:"bg-purple-100",text:"text-purple-700",label:"Requirement Gathering",icon:"ðŸ“‹"},property_hunting:{bg:"bg-orange-100",text:"text-orange-700",label:"Property Hunting",icon:"ðŸ”"},loan_processing:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Loan Processing",icon:"ðŸ¦"},property_finalization:{bg:"bg-green-100",text:"text-green-700",label:"Property Finalization",icon:"âœ…"},deal_closure:{bg:"bg-indigo-100",text:"text-indigo-700",label:"Deal Closure",icon:"ðŸ¤"},completed:{bg:"bg-emerald-100",text:"text-emerald-700",label:"Completed",icon:"ðŸŽ‰"}},i={"initial contact":"initial_contact","requirement gathering":"requirement_gathering","property hunting":"property_hunting","loan processing":"loan_processing","property finalization":"property_finalization","deal closure":"deal_closure",completed:"completed","property-hunting":"property_hunting",property_hunting:"property_hunting",propertyfinalization:"property_finalization"},n=t.toLowerCase();let o=i[n]??n.replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"");if(!r[o]){const g=Object.keys(r).find(b=>b.includes(o)||o.includes(b));g&&(o=g)}r[o]||(o="initial_contact");const m=r[o];return e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${m.bg} ${m.text}`,children:[e.jsx("span",{className:"mr-2",children:m.icon}),e.jsx("span",{className:"flex items-center space-x-2",children:e.jsx("span",{className:"text-[10px] font-normal",children:m.label})})]})}function jy(s){const a=(s??"").toString().trim().toLowerCase(),t={h:"high",urgent:"high",hot:"high",m:"medium",normal:"medium",l:"low",cold:"low"},r=(["high","medium","low"].includes(a)?a:t[a])??"",i={high:{bg:"bg-red-100",text:"text-red-700",label:"High",icon:"ðŸ”¥"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium",icon:"âš¡"},low:{bg:"bg-green-100",text:"text-green-700",label:"Low",icon:"ðŸŒ±"}},n=a?a.replace(/\b\w/g,m=>m.toUpperCase()):"-",o=i[r]??{bg:"bg-gray-100",text:"text-gray-700",label:n,icon:""};return e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${o.bg} ${o.text}`,children:[o.icon," ",o.label]})}const vy=({isOpen:s,onClose:a,property:t,stages:r,onStageUpdate:i})=>{var f,p;const[n,o]=l.useState(t.stage),[m,g]=l.useState(""),[b,d]=l.useState(!1);if(!s)return null;const v=r.findIndex(N=>N.id===t.stage);r.findIndex(N=>N.id===n);const x=r.find(N=>N.id===n),u=async()=>{if(!m.trim()){alert("Please provide remarks for stage update");return}d(!0);try{await i(n,m),a()}catch(N){console.error("Error updating stage:",N)}finally{d(!1)}},c=N=>N<=v+1;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Update Property Stage"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.title})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Current Stage"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:v+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:(f=r[v])==null?void 0:f.label}),e.jsx("div",{className:"text-sm text-blue-700",children:(p=r[v])==null?void 0:p.description})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select New Stage"}),e.jsx("div",{className:"space-y-3",children:r.map((N,P)=>{const w=P<v,$=P===v,y=n===N.id,k=c(P);return e.jsxs("button",{onClick:()=>k&&o(N.id),disabled:!k,className:`w-full flex items-center space-x-4 p-4 rounded-xl border-2 transition-all text-left ${y?"border-blue-500 bg-blue-50":k?"border-gray-200 hover:border-gray-300 hover:bg-gray-50":"border-gray-100 bg-gray-50 cursor-not-allowed opacity-50"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${w?"bg-green-500 text-white":$||y?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"}`,children:w?e.jsx(bs,{size:20}):P+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:N.label}),!k&&P>v+1&&e.jsx("span",{className:"text-xs text-red-600 bg-red-100 px-2 py-1 rounded",children:"Complete previous stages first"})]}),e.jsx("div",{className:"text-sm text-gray-600",children:N.description}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Progress: ",N.progress,"%"]})]}),e.jsx("div",{className:"text-right",children:y&&e.jsx(la,{className:"text-blue-600",size:20})})]},N.id)})})]}),x&&e.jsxs("div",{className:"bg-green-50 rounded-xl p-4 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-green-900 mb-3",children:["Tasks for ",x.label]}),e.jsx("div",{className:"space-y-2",children:x.tasks.map((N,P)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-600",size:14}),e.jsx("span",{className:"text-sm text-green-800",children:N})]},P))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Remarks ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:m,onChange:N=>g(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4,placeholder:"Provide details about the stage update, what was completed, next steps, etc.",required:!0})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Stage update will be recorded in property timeline"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:u,disabled:b||!m.trim()||n===t.stage,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:b?"Updating...":"Update Stage"})]})]})]})})]})})},Ny=({isOpen:s,onClose:a,property:t,onSave:r})=>{const[i,n]=l.useState({date:new Date().toISOString().split("T")[0],time:"10:00",purpose:"initial_inspection",inspector:"Admin User",duration:"2 hours",findings:"",photos:[],videos:[],rating:8,recommendations:"",nextSteps:"",visitType:"physical",accompaniedBy:[],weatherConditions:"clear",accessibilityNotes:"",safetyObservations:""}),[o,m]=l.useState(!1);if(!s)return null;const g=[{value:"initial_inspection",label:"Initial Inspection",description:"First property assessment"},{value:"detailed_inspection",label:"Detailed Inspection",description:"Comprehensive property evaluation"},{value:"buyer_visit",label:"Buyer Visit",description:"Showing property to potential buyer"},{value:"maintenance_check",label:"Maintenance Check",description:"Maintenance and repair assessment"},{value:"documentation",label:"Documentation",description:"Document verification visit"},{value:"photography",label:"Photography/Videography",description:"Media capture session"}],b=[{value:"physical",label:"Physical Visit"},{value:"virtual",label:"Virtual Tour"},{value:"drone",label:"Drone Survey"}],d=[{value:"clear",label:"Clear/Sunny"},{value:"cloudy",label:"Cloudy"},{value:"rainy",label:"Rainy"},{value:"foggy",label:"Foggy"}],v=["Admin User","Property Expert","Technical Inspector","Senior Manager"],x=(c,f)=>{n(p=>({...p,[c]:f}))},u=async()=>{if(!i.findings.trim()){alert("Please provide visit findings");return}m(!0);try{const c={...i,id:Date.now(),propertyId:t.propertyId,created_at:new Date().toISOString()};await r(c)}catch(c){console.error("Error saving visit:",c)}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Property Visit"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.title})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Visit Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:i.date,onChange:c=>x("date",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time"}),e.jsx("input",{type:"time",value:i.time,onChange:c=>x("time",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inspector"}),e.jsx("select",{value:i.inspector,onChange:c=>x("inspector",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:v.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),e.jsxs("select",{value:i.duration,onChange:c=>x("duration",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"1 hour",children:"1 hour"}),e.jsx("option",{value:"2 hours",children:"2 hours"}),e.jsx("option",{value:"3 hours",children:"3 hours"}),e.jsx("option",{value:"Half day",children:"Half day"}),e.jsx("option",{value:"Full day",children:"Full day"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Visit Purpose"}),e.jsx("div",{className:"space-y-3",children:g.map(c=>e.jsxs("button",{onClick:()=>x("purpose",c.value),className:`w-full p-3 rounded-lg border-2 transition-all text-left ${i.purpose===c.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:c.label}),e.jsx("div",{className:"text-sm text-gray-600",children:c.description})]},c.value))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Visit Type"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:b.map(c=>e.jsx("button",{onClick:()=>x("visitType",c.value),className:`p-3 rounded-lg border-2 transition-all ${i.visitType===c.value?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsx("span",{className:"font-medium text-gray-900",children:c.label})},c.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weather Conditions"}),e.jsx("select",{value:i.weatherConditions,onChange:c=>x("weatherConditions",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:d.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Rating (1-10)"}),e.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5,6,7,8,9,10].map(c=>e.jsx("button",{onClick:()=>x("rating",c),className:`w-8 h-8 rounded-full border-2 transition-all ${i.rating>=c?"border-blue-500 bg-blue-500 text-white":"border-gray-300 text-gray-500 hover:border-gray-400"}`,children:c},c))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i.rating>=8?"Excellent condition":i.rating>=6?"Good condition":i.rating>=4?"Fair condition":"Needs attention"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Visit Findings ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:i.findings,onChange:c=>x("findings",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Describe your observations, property condition, any issues found, etc.",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recommendations"}),e.jsx("textarea",{value:i.recommendations,onChange:c=>x("recommendations",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Recommendations for improvements, repairs, or next steps..."})]})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Visit will be recorded in property timeline"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:u,disabled:o||!i.findings.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:o?"Saving...":"Save Visit"})]})]})]})})]})})},Lr=()=>({rating:8,notes:"",issues:[]}),wy=s=>({date:new Date().toISOString().split("T")[0],inspector:(s!=null&&s.title,"Property Expert"),inspectionType:"comprehensive",overallRating:8,summary:"",structural:Lr(),electrical:Lr(),plumbing:Lr(),flooring:Lr(),painting:Lr(),fixtures:Lr(),ventilation:Lr(),security:Lr(),recommendations:[],urgentRepairs:[],estimatedRepairCost:0,marketReadiness:"ready",photos:[],videos:[]}),ui=[{key:"structural",label:"Structural",icon:"ðŸ—ï¸",description:"Foundation, walls, ceiling"},{key:"electrical",label:"Electrical",icon:"âš¡",description:"Wiring, switches, fixtures"},{key:"plumbing",label:"Plumbing",icon:"ðŸš°",description:"Water supply, drainage"},{key:"flooring",label:"Flooring",icon:"ðŸ ",description:"Tiles, marble, wood"},{key:"painting",label:"Painting",icon:"ðŸŽ¨",description:"Wall paint, exterior"},{key:"fixtures",label:"Fixtures",icon:"ðŸ”§",description:"Doors, windows, fittings"},{key:"ventilation",label:"Ventilation",icon:"ðŸ’¨",description:"Air circulation, fans"},{key:"security",label:"Security",icon:"ðŸ”’",description:"Locks, safety features"}],_y=[{value:"basic",label:"Basic Inspection",duration:"1 hour"},{value:"comprehensive",label:"Comprehensive Inspection",duration:"3 hours"},{value:"technical",label:"Technical Inspection",duration:"5 hours"},{value:"pre_sale",label:"Pre-Sale Inspection",duration:"4 hours"}],Sy=[{value:"ready",label:"Market Ready",color:"green"},{value:"minor_repairs",label:"Minor Repairs Needed",color:"yellow"},{value:"major_repairs",label:"Major Repairs Needed",color:"orange"},{value:"not_ready",label:"Not Market Ready",color:"red"}],ky={structural:["Cracks in walls","Water seepage","Foundation issues","Ceiling damage"],electrical:["Old wiring","Faulty switches","Inadequate points","Safety concerns"],plumbing:["Leaky pipes","Low water pressure","Drainage issues","Old fixtures"],flooring:["Broken tiles","Scratched flooring","Uneven surface","Stains"],painting:["Peeling paint","Discoloration","Damp patches","Exterior fading"],fixtures:["Broken handles","Warped doors","Window issues","Hardware problems"],ventilation:["Poor air flow","Blocked vents","Fan issues","Humidity problems"],security:["Faulty locks","Security gaps","Access control","Safety hazards"]},Cy=({isOpen:s,onClose:a,property:t,onSave:r})=>{const[i,n]=l.useState(wy(t??void 0)),[o,m]=l.useState("overview"),[g,b]=l.useState(!1);if(!s)return null;const d=(p,N)=>{n(P=>({...P,[p]:N}))},v=(p,N)=>{n(P=>({...P,[p]:{...P[p],rating:N}}))},x=(p,N)=>{n(P=>({...P,[p]:{...P[p],notes:N}}))},u=(p,N)=>{n(P=>{const w=P[p],y=w.issues.includes(N)?w.issues.filter(k=>k!==N):[...w.issues,N];return{...P,[p]:{...w,issues:y}}})},c=()=>{const p=ui.map(P=>i[P.key]),N=p.reduce((P,w)=>P+(w.rating||0),0);return Math.round(N/p.length)},f=async()=>{if(!i.summary.trim()){window.alert("Please provide inspection summary");return}b(!0);try{const p={...i,overallRating:c(),id:Date.now(),propertyId:(t==null?void 0:t.propertyId)??null,created_at:new Date().toISOString()};await r(p)}catch(p){console.error("Error saving inspection:",p)}finally{b(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Property Inspection"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[(t==null?void 0:t.title)??"Property"," - Comprehensive Analysis"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"flex h-[80vh]",children:[e.jsxs("div",{className:"w-80 border-r border-gray-200 bg-gray-50 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Inspection Areas"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>m("overview"),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors text-left ${o==="overview"?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ks,{size:16}),e.jsx("span",{children:"Overview"})]}),ui.map(p=>e.jsxs("button",{onClick:()=>m(p.key),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors text-left ${o===p.key?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"text-lg",children:p.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:p.label}),e.jsx("div",{className:"text-xs opacity-75",children:p.description})]}),e.jsx("div",{className:"ml-auto",children:e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${i[p.key].rating>=8?"bg-green-500 text-white":i[p.key].rating>=6?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:i[p.key].rating})})]},p.key))]})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-auto",children:[o==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Inspection Overview"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Inspection Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:_y.map(p=>e.jsxs("button",{onClick:()=>d("inspectionType",p.value),className:`p-3 rounded-lg border-2 transition-all text-left ${i.inspectionType===p.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:p.label}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Duration: ",p.duration]})]},p.value))})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-4",children:"Overall Property Rating"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl font-bold text-blue-600 mb-2",children:c()}),e.jsx("div",{className:"text-blue-700 font-medium",children:"out of 10"}),e.jsx("div",{className:"text-sm text-blue-600 mt-2",children:c()>=8?"Excellent Property":c()>=6?"Good Property":c()>=4?"Fair Property":"Needs Attention"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Market Readiness"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Sy.map(p=>e.jsx("button",{onClick:()=>d("marketReadiness",p.value),className:`p-3 rounded-lg border-2 transition-all text-left ${i.marketReadiness===p.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsx("span",{className:"font-medium text-gray-900",children:p.label})},p.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Inspection Summary ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:i.summary,onChange:p=>d("summary",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Provide overall inspection summary, key findings, and recommendations...",required:!0})]})]}),ui.map(p=>o===p.key&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-3xl",children:p.icon}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[p.label," Inspection"]}),e.jsx("p",{className:"text-gray-600",children:p.description})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[p.label," Rating (1-10)"]}),e.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5,6,7,8,9,10].map(N=>e.jsx("button",{onClick:()=>v(p.key,N),className:`w-10 h-10 rounded-full border-2 transition-all ${i[p.key].rating>=N?"border-blue-500 bg-blue-500 text-white":"border-gray-300 text-gray-500 hover:border-gray-400"}`,children:N},N))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Common Issues"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:ky[p.key].map(N=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:i[p.key].issues.includes(N),onChange:()=>u(p.key,N),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},N))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[p.label," Notes"]}),e.jsx("textarea",{value:i[p.key].notes,onChange:N=>x(p.key,N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:`Detailed notes about ${p.label.toLowerCase()} condition...`})]})]},p.key))]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Overall Rating: ",c(),"/10 â€¢ ",ui.length," areas inspected"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:f,disabled:g||!i.summary.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:g?"Generating Report...":"Generate Inspection Report"})]})]})]})})]})})},Ay=({isOpen:s,onClose:a,property:t,onSave:r})=>{const[i,n]=l.useState({inspectionDate:new Date().toISOString().split("T")[0],inspector:"Maintenance Expert",summary:"",suggestions:[],urgentRepairs:[],totalEstimatedCost:0,timelineWeeks:4,vendorRecommendations:[],priorityLevel:"medium"}),[o,m]=l.useState({category:"electrical",item:"",description:"",priority:"medium",estimatedCost:0,timeRequired:"1 week",vendor:""}),[g,b]=l.useState(!1);if(!s)return null;const d=[{value:"electrical",label:"Electrical",icon:"âš¡"},{value:"plumbing",label:"Plumbing",icon:"ðŸš°"},{value:"painting",label:"Painting",icon:"ðŸŽ¨"},{value:"flooring",label:"Flooring",icon:"ðŸ "},{value:"structural",label:"Structural",icon:"ðŸ—ï¸"},{value:"fixtures",label:"Fixtures",icon:"ðŸ”§"},{value:"cleaning",label:"Cleaning",icon:"ðŸ§¹"},{value:"landscaping",label:"Landscaping",icon:"ðŸŒ¿"}],v=[{value:"urgent",label:"Urgent",color:"red",description:"Immediate attention required"},{value:"high",label:"High",color:"orange",description:"Should be done soon"},{value:"medium",label:"Medium",color:"yellow",description:"Can be planned"},{value:"low",label:"Low",color:"green",description:"Nice to have"}],x=["1 day","3 days","1 week","2 weeks","1 month","2 months","3 months"],u=[{name:"Rajesh Plumbing Services",category:"plumbing",rating:4.8,contact:"+91 98765 43210"},{name:"Color Magic Painters",category:"painting",rating:4.7,contact:"+91 87654 32109"},{name:"Expert Electricians",category:"electrical",rating:4.9,contact:"+91 76543 21098"},{name:"Premium Tiles & Marble",category:"flooring",rating:4.8,contact:"+91 65432 10987"}],c=(w,$)=>{n(y=>({...y,[w]:$}))},f=()=>{if(!o.item.trim()||!o.description.trim()){alert("Please fill in item name and description");return}const w={...o,id:Date.now()};n($=>({...$,suggestions:[...$.suggestions,w],totalEstimatedCost:$.totalEstimatedCost+o.estimatedCost})),m({category:"electrical",item:"",description:"",priority:"medium",estimatedCost:0,timeRequired:"1 week",vendor:""})},p=w=>{const $=i.suggestions.find(y=>y.id===w);n(y=>({...y,suggestions:y.suggestions.filter(k=>k.id!==w),totalEstimatedCost:y.totalEstimatedCost-(($==null?void 0:$.estimatedCost)||0)}))},N=w=>{const $=v.find(y=>y.value===w);return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium bg-${$==null?void 0:$.color}-100 text-${$==null?void 0:$.color}-700`,children:$==null?void 0:$.label})},P=async()=>{if(!i.summary.trim()){alert("Please provide maintenance summary");return}if(i.suggestions.length===0){alert("Please add at least one maintenance suggestion");return}b(!0);try{const w={...i,id:Date.now(),propertyId:t.propertyId,created_at:new Date().toISOString()};await r(w)}catch(w){console.error("Error saving maintenance data:",w)}finally{b(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-orange-50 to-yellow-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Maintenance Suggestions"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.title," - Repair & Maintenance Analysis"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add Maintenance Item"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("select",{value:o.category,onChange:w=>m({...o,category:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",children:d.map(w=>e.jsxs("option",{value:w.value,children:[w.icon," ",w.label]},w.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item/Work"}),e.jsx("input",{type:"text",value:o.item,onChange:w=>m({...o,item:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",placeholder:"e.g., Fix bathroom leakage"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:o.description,onChange:w=>m({...o,description:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",rows:2,placeholder:"Detailed description of the work required..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("select",{value:o.priority,onChange:w=>m({...o,priority:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",children:v.map(w=>e.jsx("option",{value:w.value,children:w.label},w.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Required"}),e.jsx("select",{value:o.timeRequired,onChange:w=>m({...o,timeRequired:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",children:x.map(w=>e.jsx("option",{value:w,children:w},w))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Cost (â‚¹)"}),e.jsx("input",{type:"number",value:o.estimatedCost,onChange:w=>m({...o,estimatedCost:Number(w.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",placeholder:"5000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recommended Vendor"}),e.jsxs("select",{value:o.vendor,onChange:w=>m({...o,vendor:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select vendor"}),u.filter(w=>w.category===o.category).map(w=>e.jsxs("option",{value:w.name,children:[w.name," (",w.rating,"â­)"]},w.name))]})]})]}),e.jsxs("button",{onClick:f,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Suggestion"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Overall Summary ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:i.summary,onChange:w=>c("summary",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",rows:4,placeholder:"Overall maintenance assessment and recommendations...",required:!0})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Maintenance Suggestions"}),e.jsxs("div",{className:"bg-orange-50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Total Estimated Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:["â‚¹",i.totalEstimatedCost.toLocaleString("en-IN")]})]}),e.jsx(ka,{className:"text-orange-600",size:24})]}),e.jsxs("div",{className:"text-sm text-orange-700 mt-2",children:["Timeline: ",i.timelineWeeks," weeks"]})]}),e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[i.suggestions.map(w=>{var $;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:($=d.find(y=>y.value===w.category))==null?void 0:$.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:w.item}),e.jsx("div",{className:"text-sm text-gray-600",children:w.description})]})]}),e.jsx("button",{onClick:()=>p(w.id),className:"text-red-600 hover:text-red-800",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Cost:"}),e.jsxs("span",{className:"font-medium ml-2",children:["â‚¹",w.estimatedCost.toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Time:"}),e.jsx("span",{className:"font-medium ml-2",children:w.timeRequired})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[N(w.priority),w.vendor&&e.jsx("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded",children:w.vendor})]})]},w.id)}),i.suggestions.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(nn,{className:"mx-auto mb-2",size:32}),e.jsx("p",{children:"No maintenance suggestions added yet"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recommended Vendors"}),e.jsx("div",{className:"space-y-2",children:u.map((w,$)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:w.name}),e.jsx("div",{className:"text-sm text-gray-600 capitalize",children:w.category})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Xs,{className:"text-yellow-400 fill-current",size:12}),e.jsx("span",{className:"text-xs font-medium",children:w.rating})]}),e.jsx("button",{className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Contact"})]})]},$))})]})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[i.suggestions.length," suggestions â€¢ â‚¹",i.totalEstimatedCost.toLocaleString("en-IN")," total cost"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:P,disabled:g||!i.summary.trim()||i.suggestions.length===0,className:"flex items-center space-x-2 px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:g?"Saving...":"Save Maintenance Report"})]})]})]})})]})})},Py=({isOpen:s,onClose:a,property:t})=>{var N,P,w,$;const[r,i]=l.useState("comprehensive"),[n,o]=l.useState(!0),[m,g]=l.useState(!0),[b,d]=l.useState(!0),[v,x]=l.useState(!0);if(!s)return null;const u=[{value:"comprehensive",label:"Comprehensive Report",description:"Complete property analysis with all details",pages:"15-20 pages"},{value:"inspection",label:"Inspection Report",description:"Detailed inspection findings and recommendations",pages:"8-12 pages"},{value:"maintenance",label:"Maintenance Report",description:"Maintenance suggestions and cost estimates",pages:"5-8 pages"},{value:"market",label:"Market Analysis",description:"Market trends and pricing analysis",pages:"6-10 pages"},{value:"summary",label:"Executive Summary",description:"Brief overview for quick review",pages:"2-3 pages"}],c=()=>{new Date().toISOString();const y=document.createElement("a");y.href="data:application/pdf;base64,JVBERi0xLjQKJdPr6eEKMSAwIG9iago8PAovVGl0bGUgKFByb3BlcnR5IFJlcG9ydCkKL0NyZWF0b3IgKFJlc2FsZUV4cGVydCkKL1Byb2R1Y2VyIChSZXNhbGVFeHBlcnQpCj4+CmVuZG9iagoyIDAgb2JqCjw8Ci9UeXBlIC9DYXRhbG9nCi9QYWdlcyAzIDAgUgo+PgplbmRvYmoKMyAwIG9iago8PAovVHlwZSAvUGFnZXMKL0tpZHMgWzQgMCBSXQovQ291bnQgMQo+PgplbmRvYmoKNCAwIG9iago8PAovVHlwZSAvUGFnZQovUGFyZW50IDMgMCBSCi9NZWRpYUJveCBbMCAwIDYxMiA3OTJdCj4+CmVuZG9iagp4cmVmCjAgNQowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDAwMDkgMDAwMDAgbiAKMDAwMDAwMDA3NCAwMDAwMCBuIAowMDAwMDAwMTIxIDAwMDAwIG4gCjAwMDAwMDAxNzggMDAwMDAgbiAKdHJhaWxlcgo8PAovU2l6ZSA1Ci9Sb290IDIgMCBSCj4+CnN0YXJ0eHJlZgoyNzMKJSVFT0YK",y.download=`${t.title}-${r}-report.pdf`,y.click(),alert("Report generated and downloaded successfully!")},f=y=>{var F,T,j;const k=`https://resaleexpert.com/reports/${t.propertyId}/${r}`,R=`Property Report: ${t.title}

Comprehensive ${r} report is ready for review.

View Report: ${k}

Generated by ResaleExpert`;switch(y){case"whatsapp":window.open(`https://wa.me/${(T=(F=t.seller)==null?void 0:F.phone)==null?void 0:T.replace(/\D/g,"")}?text=${encodeURIComponent(R)}`,"_blank");break;case"email":const E=`Property Report - ${t.title}`;window.open(`mailto:${(j=t.seller)==null?void 0:j.email}?subject=${encodeURIComponent(E)}&body=${encodeURIComponent(R)}`,"_blank");break;default:navigator.clipboard.writeText(k),alert("Report link copied to clipboard!")}},p=y=>y>=1e7?`â‚¹${(y/1e7).toFixed(1)}Cr`:y>=1e5?`â‚¹${(y/1e5).toFixed(1)}L`:`â‚¹${y.toLocaleString("en-IN")}`;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Generate Property Report"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.title})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Property Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Property:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Location:"}),e.jsxs("span",{className:"font-semibold ml-2",children:[t.location,", ",t.city]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Type:"}),e.jsxs("span",{className:"font-semibold ml-2",children:[t.unitType," â€¢ ",t.carpetArea," sq ft"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Price:"}),e.jsx("span",{className:"font-semibold ml-2",children:p(t.budget)})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Report Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(y=>e.jsxs("button",{onClick:()=>i(y.value),className:`p-4 rounded-xl border-2 transition-all text-left ${r===y.value?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:y.label}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:y.description}),e.jsx("div",{className:"text-xs text-purple-600 mt-2",children:y.pages})]},y.value))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:y=>o(y.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Include Photos"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Property images and visual documentation"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:y=>g(y.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Include Inspection Data"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Detailed inspection findings and ratings"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:y=>d(y.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Include Maintenance Suggestions"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Repair recommendations and cost estimates"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:y=>x(y.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Include Market Analysis"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Market trends and pricing insights"})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Preview"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 h-64 overflow-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center border-b pb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:(N=u.find(y=>y.value===r))==null?void 0:N.label}),e.jsx("p",{className:"text-gray-600",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on ",new Date().toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:"Property Overview"}),e.jsxs("p",{className:"text-sm text-gray-700",children:[t.unitType," property located in ",t.location,", ",t.city," with ",t.carpetArea," sq ft area. Current asking price: ",p(t.budget),"."]})]}),m&&e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:"Inspection Summary"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Overall property rating: ",((P=t.inspectionReport)==null?void 0:P.overallRating)||8,"/10. Property is in good condition with minor maintenance requirements."]})]}),b&&e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:"Maintenance Recommendations"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Estimated maintenance cost: â‚¹",(((w=t.maintenanceReport)==null?void 0:w.totalEstimatedCost)||5e4).toLocaleString("en-IN"),". Timeline: ",(($=t.maintenanceReport)==null?void 0:$.timelineWeeks)||4," weeks."]})]}),v&&e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-gray-900",children:"Market Analysis"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Current market rate: â‚¹18,500/sq ft. Property is priced competitively with 5.2% above market average. Expected appreciation: 8-12% annually."})]})]})]})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Report will be generated in PDF format"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>f("whatsapp"),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(tt,{size:16}),e.jsx("span",{children:"Share via WhatsApp"})]}),e.jsxs("button",{onClick:()=>f("email"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ds,{size:16}),e.jsx("span",{children:"Share via Email"})]}),e.jsxs("button",{onClick:c,className:"flex items-center space-x-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Generate & Download"})]})]})]})})]})})},qo=[{key:"propertyType",label:"Property Type",description:"Property type, unit type, subtype",category:"basic"},{key:"location",label:"Location",description:"Full address and locality",category:"basic"},{key:"price",label:"Price",description:"Property price and price per sq ft",category:"basic"},{key:"carpetArea",label:"Carpet Area",description:"Total carpet area in sq ft",category:"basic"},{key:"mainImage",label:"Main Property Image",description:"Primary property photo",category:"basic"},{key:"bedrooms",label:"Bedrooms",description:"Number of bedrooms",category:"details"},{key:"bathrooms",label:"Bathrooms",description:"Number of bathrooms",category:"details"},{key:"parking",label:"Parking",description:"Parking spaces available",category:"details"},{key:"furnishing",label:"Furnishing Status",description:"Furnished/Semi/Unfurnished",category:"details"},{key:"possession",label:"Possession",description:"Possession date/status",category:"details"},{key:"facing",label:"Facing Direction",description:"Property facing direction",category:"details"},{key:"builtYear",label:"Built Year",description:"Year of construction",category:"details"},{key:"floor",label:"Floor Details",description:"Floor number and total floors",category:"details"},{key:"wing",label:"Wing/Tower",description:"Wing or tower name",category:"details"},{key:"unitNo",label:"Unit Number",description:"Specific unit number",category:"details"},{key:"description",label:"Property Description",description:"Detailed description",category:"features"},{key:"amenities",label:"Amenities",description:"All property amenities",category:"features"},{key:"furnishingItems",label:"Furnishing Items",description:"List of furnishing items",category:"features"},{key:"verified",label:"Verification Badge",description:"Verified property badge",category:"features"},{key:"featured",label:"Featured Badge",description:"Premium/Featured badge",category:"features"},{key:"nearbyPlaces",label:"Nearby Places",description:"Schools, hospitals, transport",category:"location"},{key:"locationMap",label:"Location Map",description:"Area map visualization",category:"location"},{key:"aiScore",label:"AI Property Score",description:"AI-based property rating",category:"investment"},{key:"priceGrowth",label:"Price Growth",description:"Expected price appreciation",category:"investment"},{key:"investmentGrade",label:"Investment Grade",description:"Investment rating",category:"investment"},{key:"roiPotential",label:"ROI Potential",description:"Return on investment",category:"investment"},{key:"marketPosition",label:"Market Position",description:"Position in locality",category:"investment"},{key:"assignedToInfo",label:"Assigned Executive",description:"Assigned person name & contact",category:"contact"},{key:"contactDetails",label:"Contact Phone",description:"Primary contact phone",category:"contact"}],Ty={basic:"Basic Information",details:"Property Details",features:"Features & Amenities",location:"Location & Connectivity",investment:"Investment Analytics",contact:"Contact Information"},Iy=[{value:"premium",label:"Premium Template",description:"Luxury design with elegant layout",preview:"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=300"},{value:"modern",label:"Modern Template",description:"Clean and contemporary design",preview:"https://images.pexels.com/photos/1396132/pexels-photo-1396132.jpeg?auto=compress&cs=tinysrgb&w=300"},{value:"classic",label:"Classic Template",description:"Traditional and professional",preview:"https://images.pexels.com/photos/1396125/pexels-photo-1396125.jpeg?auto=compress&cs=tinysrgb&w=300"},{value:"minimal",label:"Minimal Template",description:"Simple and focused design",preview:"https://images.pexels.com/photos/1396126/pexels-photo-1396126.jpeg?auto=compress&cs=tinysrgb&w=300"}],$y=[{value:"modern",label:"Modern Sans"},{value:"classic",label:"Classic Serif"},{value:"elegant",label:"Elegant Script"},{value:"bold",label:"Bold Impact"}],Ey=[{value:"standard",label:"Standard Layout"},{value:"magazine",label:"Magazine Style"},{value:"grid",label:"Grid Layout"},{value:"story",label:"Story Format"}],Em=()=>({primaryColor:"#E6761D",secondaryColor:"#0b3856",fontStyle:"modern",layout:"standard",watermark:!0,selectedContent:new Set(["propertyType","location","price","carpetArea","mainImage","bedrooms","bathrooms","description"])}),Pc=s=>{if(s==null||s==="")return 0;if(typeof s=="number")return s;const a=Number(String(s).replace(/[^\d.-]/g,""));return Number.isNaN(a)?0:a},sg=s=>{const a=Pc(s);if(a>=1e7)return`â‚¹${(a/1e7).toFixed(1)}Cr`;if(a>=1e5){const t=a/1e5;return t%1===0?`â‚¹${t.toFixed(0)}L`:`â‚¹${t.toFixed(1)}L`}return`â‚¹${a.toLocaleString("en-IN")}`},br=s=>s==null||typeof s=="string"&&s.trim()===""||typeof s=="number"&&!Number.isFinite(s)?"â€”":s,My=s=>{if(!s)return"";const a=typeof s=="string"?parseInt(s):s;return isNaN(a)||a<1||a>12?"":new Date(0,a-1).toLocaleString("en",{month:"long"})};function Ly(s){const a=l.useRef(null);return l.useEffect(()=>{function t(r){a.current&&!a.current.contains(r.target)&&s()}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[s]),a}const Dy=s=>/^data:/.test(s);async function Ry(s){try{const t=await(await fetch(s,{mode:"cors"})).blob();return await new Promise(r=>{const i=new FileReader;i.onloadend=()=>r(String(i.result||"")),i.readAsDataURL(t)})}catch{return null}}function zy(s){var m,g,b,d,v,x;if(!s)return null;const a=[s.assigned_to??null,s.assignedTo??null,s.executive??null].filter(Boolean),t={name:s.executive_name||((m=s.raw)==null?void 0:m.assigned_to_name)||((g=s.raw)==null?void 0:g.executive_name),email:s.executive_email||((b=s.raw)==null?void 0:b.assigned_to_email)||((d=s.raw)==null?void 0:d.executive_email),phone:s.executive_phone||((v=s.raw)==null?void 0:v.assigned_to_phone)||((x=s.raw)==null?void 0:x.executive_phone)},r={...a[0]||{}},i=r.name||t.name,n=r.email||t.email,o=r.phone||t.phone;return!i&&!n&&!o?null:{name:i,email:n,phone:o}}const Fy=({label:s})=>{const a=Ea(s,Wn),t=a.emoji,r=typeof t=="function"?t:null,i=typeof t=="string"?t:null;return e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded-full text-[10px] leading-tight ring-1 ${a.bg} ${a.text} ${a.ring}`,style:{backdropFilter:"saturate(1.2) blur(2px)"},title:s,children:[r?e.jsx(r,{size:12}):i?e.jsx("span",{children:i}):null,e.jsx("span",{className:"font-semibold",children:s})]})},By=({customizations:s,setCustomizations:a})=>{const[t,r]=l.useState(!1),i=Ly(()=>r(!1)),o=s.selectedContent.size,m=x=>{a(u=>{const c=new Set(u.selectedContent);return c.has(x)?c.delete(x):c.add(x),{...u,selectedContent:c}})},g=()=>{a(x=>({...x,selectedContent:new Set(qo.map(u=>u.key))}))},b=()=>{a(x=>({...x,selectedContent:new Set}))},d=x=>{const u=qo.filter(c=>c.category===x).map(c=>c.key);a(c=>{const f=new Set(c.selectedContent);return u.forEach(p=>f.add(p)),{...c,selectedContent:f}})},v=l.useMemo(()=>qo.reduce((x,u)=>{var c;return(x[c=u.category]||(x[c]=[])).push(u),x},{}),[]);return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>r(x=>!x),"aria-haspopup":"true","aria-expanded":t,className:"w-full justify-between inline-flex items-center gap-2 px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 focus:ring-2 focus:ring-purple-500 transition-all",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Select Content to Include"}),e.jsxs("span",{className:"text-xs px-2.5 py-1 rounded-full bg-purple-100 text-purple-700 font-semibold",children:[o," selected"]})]}),t&&e.jsxs("div",{ref:i,role:"menu","aria-label":"Content Options",className:"absolute z-10 mt-2 w-full min-w-[32rem] right-0 bg-white rounded-xl shadow-2xl border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Choose what to include in your brochure"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:g,type:"button",className:"text-xs px-3 py-1.5 rounded-md bg-purple-600 text-white hover:bg-purple-700 font-medium transition-colors",children:"Select All"}),e.jsx("button",{onClick:b,type:"button",className:"text-xs px-3 py-1.5 rounded-md bg-gray-100 hover:bg-gray-200 font-medium transition-colors",children:"Clear"})]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:Object.keys(v).map(x=>e.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-50 px-4 py-2 flex items-center justify-between z-10",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:Ty[x]}),e.jsx("button",{onClick:()=>d(x),type:"button",className:"text-xs px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 transition-colors",children:"Select All"})]}),e.jsx("div",{className:"p-2",children:v[x].map(u=>{const c=s.selectedContent.has(u.key);return e.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg cursor-pointer transition-all ${c?"bg-purple-50 border border-purple-200":"hover:bg-gray-50"}`,children:[e.jsx("input",{type:"checkbox",checked:c,onChange:()=>m(u.key),className:"mt-1 rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:u.label}),e.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:u.description})]})]},u.key)})})]},x))}),e.jsxs("div",{className:"p-3 border-t border-gray-100 bg-gray-50 flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-600",children:[s.selectedContent.size," items selected"]}),e.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-4 py-2 text-sm rounded-lg bg-purple-600 text-white hover:bg-purple-700 font-medium transition-colors",children:"Done"})]})]})]})},Oy=({property:s,customizations:a,tags:t})=>{var b,d,v,x,u,c,f,p,N,P,w;const r=a.selectedContent instanceof Set?a.selectedContent:new Set(a.selectedContent),n=((s==null?void 0:s.images)||(s==null?void 0:s.photos)||[])[0]||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=400",o=(s==null?void 0:s.price)||(s==null?void 0:s.budget),m=(s==null?void 0:s.square_feet)||(s==null?void 0:s.carpetArea),g=o&&m?Math.round(Pc(o)/Pc(m)):null;return e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 h-[500px] overflow-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(r.has("propertyType")||r.has("location")||r.has("verified")||r.has("featured"))&&e.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-pink-50 border-b border-gray-200",children:[r.has("propertyType")&&e.jsx("h1",{className:"text-xl font-bold mb-1",style:{color:a.primaryColor},children:[s==null?void 0:s.type,s==null?void 0:s.unitType,s==null?void 0:s.subtype].filter(Boolean).join("  ")||"Property Title"}),r.has("location")&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-2",children:[e.jsx(Qs,{size:14,className:"mr-1"}),(s==null?void 0:s.locationNormalized)||(s==null?void 0:s.location)||"Location",s!=null&&s.city?`, ${s.city}`:""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.has("featured")&&(s==null?void 0:s.featured)&&e.jsx("span",{className:"px-2 py-1 bg-gradient-to-r from-yellow-400 to-orange-500 text-white text-xs font-bold rounded-full",children:"FEATURED"}),r.has("verified")&&(s==null?void 0:s.verified)&&e.jsxs("span",{className:"px-2 py-1 bg-green-500 text-white text-xs font-bold rounded-full flex items-center gap-1",children:[e.jsx(bs,{size:12}),"VERIFIED"]})]})]}),r.has("mainImage")&&e.jsxs("div",{className:"relative w-full h-48",children:[e.jsx("img",{src:n,alt:"Property",className:"w-full h-48 object-cover",crossOrigin:"anonymous",referrerPolicy:"no-referrer"}),t.length>0&&e.jsx("div",{className:"absolute top-2 left-2 flex flex-wrap gap-1.5 max-w-[92%]",children:t.slice(0,5).map(($,y)=>e.jsx(Fy,{label:$},`${$}-${y}`))})]}),r.has("price")&&e.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Property Price"}),e.jsx("div",{className:"text-2xl font-bold",style:{color:a.secondaryColor},children:sg(o)})]}),g&&e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Per Sq Ft"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["â‚¹",g.toLocaleString("en-IN")]})]})]})}),(r.has("bedrooms")||r.has("bathrooms")||r.has("parking")||r.has("carpetArea"))&&e.jsxs("div",{className:"p-4 grid grid-cols-2 gap-3 border-b border-gray-200",children:[r.has("bedrooms")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oc,{size:16,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Bedrooms"}),e.jsx("div",{className:"font-semibold",children:br(s==null?void 0:s.bedrooms)})]})]}),r.has("bathrooms")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gn,{size:16,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Bathrooms"}),e.jsx("div",{className:"font-semibold",children:br(s==null?void 0:s.bathrooms)})]})]}),r.has("parking")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Sl,{size:16,className:"text-orange-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Parking"}),e.jsx("div",{className:"font-semibold",children:br(s==null?void 0:s.parking)})]})]}),r.has("carpetArea")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ph,{size:16,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Carpet Area"}),e.jsxs("div",{className:"font-semibold",children:[br((s==null?void 0:s.square_feet)||(s==null?void 0:s.carpetArea))," sq ft"]})]})]})]}),r.has("description")&&(s==null?void 0:s.description)&&e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"About Property"}),e.jsx("p",{className:"text-xs text-gray-700 line-clamp-3",children:s.description})]}),(r.has("furnishing")||r.has("possession")||r.has("facing")||r.has("builtYear")||r.has("floor")||r.has("wing")||r.has("unitNo"))&&e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-sm",children:"Property Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[r.has("furnishing")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Furnishing: "}),e.jsx("span",{className:"font-medium",children:br(s==null?void 0:s.furnishing)})]}),r.has("possession")&&((s==null?void 0:s.possessionMonth)||(s==null?void 0:s.possessionYear))&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Possession: "}),e.jsx("span",{className:"font-medium",children:[My(s==null?void 0:s.possessionMonth),s==null?void 0:s.possessionYear].filter(Boolean).join(" ")})]}),r.has("facing")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Facing: "}),e.jsx("span",{className:"font-medium",children:br(s==null?void 0:s.facing)})]}),r.has("builtYear")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Built Year: "}),e.jsx("span",{className:"font-medium",children:br((s==null?void 0:s.builtYear)||(s==null?void 0:s.possessionYear))})]}),r.has("floor")&&(((b=s==null?void 0:s.raw)==null?void 0:b.floor)||((d=s==null?void 0:s.raw)==null?void 0:d.totalFloors))&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Floor: "}),e.jsx("span",{className:"font-medium",children:(v=s==null?void 0:s.raw)!=null&&v.floor&&((x=s==null?void 0:s.raw)!=null&&x.totalFloors)?`${s.raw.floor} / ${s.raw.totalFloors}`:br((u=s==null?void 0:s.raw)==null?void 0:u.floor)})]}),r.has("wing")&&((c=s==null?void 0:s.raw)==null?void 0:c.wing)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Wing: "}),e.jsx("span",{className:"font-medium",children:s.raw.wing})]}),r.has("unitNo")&&((f=s==null?void 0:s.raw)==null?void 0:f.unitNo)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Unit No: "}),e.jsx("span",{className:"font-medium",children:s.raw.unitNo})]})]})]}),r.has("amenities")&&(s==null?void 0:s.amenities)&&s.amenities.length>0&&e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Amenities"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.amenities.slice(0,8).map(($,y)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:$},y))})]}),r.has("furnishingItems")&&(s==null?void 0:s.furnishingItems)&&s.furnishingItems.length>0&&e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Furnishing Items"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.furnishingItems.slice(0,6).map(($,y)=>e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs",children:$},y))})]}),r.has("nearbyPlaces")&&((p=s==null?void 0:s.raw)==null?void 0:p.nearby_places)&&s.raw.nearby_places.length>0&&e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm",children:"Nearby Places"}),e.jsx("div",{className:"space-y-1",children:s.raw.nearby_places.slice(0,4).map(($,y)=>e.jsxs("div",{className:"text-xs text-gray-700",children:["â€¢ ",$.name," ",$.distance&&`(${$.distance}${$.unit||""})`]},y))})]}),(r.has("aiScore")||r.has("priceGrowth")||r.has("investmentGrade")||r.has("roiPotential")||r.has("marketPosition"))&&e.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-blue-50 border-b border-gray-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 text-sm flex items-center gap-1",children:[e.jsx(zt,{size:14}),"AI Investment Analysis"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[r.has("aiScore")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"AI Score: "}),e.jsxs("span",{className:"font-bold text-purple-600",children:[(s==null?void 0:s.aiScore)??"94","/100"]})]}),r.has("priceGrowth")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Growth: "}),e.jsx("span",{className:"font-bold text-green-600",children:(s==null?void 0:s.priceGrowth)??"+12.5%"})]}),r.has("investmentGrade")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Investment: "}),e.jsx("span",{className:"font-bold text-blue-600",children:(s==null?void 0:s.investmentGrade)??"A+"})]}),r.has("roiPotential")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"ROI Potential: "}),e.jsx("span",{className:"font-bold text-orange-600",children:"18.2%"})]}),r.has("marketPosition")&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Market: "}),e.jsx("span",{className:"font-bold text-purple-600",children:"Top 10%"})]})]})]}),(r.has("assignedToInfo")||r.has("contactDetails"))&&e.jsxs("div",{className:"p-4 bg-gray-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-sm",children:"Contact Information"}),r.has("assignedToInfo")&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ms,{size:16,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Assigned Executive"}),e.jsx("div",{className:"font-medium text-sm",children:br((N=s==null?void 0:s.assigned_to)==null?void 0:N.name)}),(P=s==null?void 0:s.assigned_to)!=null&&P.email?e.jsx("div",{className:"text-xs text-gray-600",children:s.assigned_to.email}):null]})]}),r.has("contactDetails")&&((w=s==null?void 0:s.assigned_to)==null?void 0:w.phone)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Cs,{size:16,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Contact Number"}),e.jsx("div",{className:"font-medium text-sm",children:s.assigned_to.phone})]})]})]}),a.watermark&&e.jsx("div",{className:"p-3 text-center border-t border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Powered by ResaleExpert.in"})})]})})},Uy=({isOpen:s,onClose:a,property:t})=>{const[r,i]=l.useState("premium"),[n,o]=l.useState(Em()),[m,g]=l.useState(!1),[b,d]=l.useState([]),[v,x]=l.useState(null),u=l.useMemo(()=>{if(!t)return null;const p=zy(t);return{...t,assigned_to:p}},[t]);if(l.useEffect(()=>{let p=!1;async function N(){try{if(!(u!=null&&u.id)&&!(u!=null&&u.propertyId)){d([]);return}const P=(u==null?void 0:u.id)??(u==null?void 0:u.propertyId),w=await Qt.getById(P);p||d((w==null?void 0:w.tags)||[])}catch{p||d([])}}return s&&N(),()=>{p=!0}},[s,u==null?void 0:u.id,u==null?void 0:u.propertyId]),l.useEffect(()=>{let p=!1;async function N(){const w=((u==null?void 0:u.images)||(u==null?void 0:u.photos)||[])[0]||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=1200";if(Dy(w)){x(w);return}const $=await Ry(w);p||x($)}return s&&N(),()=>{p=!0}},[s,u==null?void 0:u.images,u==null?void 0:u.photos]),l.useEffect(()=>{s&&(i("premium"),o(Em()))},[s,u]),!s)return null;const c=async()=>{g(!0);const p=w=>(w||"property").replace(/[^\w\-]+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"").slice(0,80),N=(w,$)=>{const y=URL.createObjectURL(w),k=document.createElement("a");k.href=y,k.download=$.endsWith(".pdf")?$:`${$}.pdf`,document.body.appendChild(k),k.click(),k.remove(),setTimeout(()=>URL.revokeObjectURL(y),1500)},P=(w,$="application/pdf")=>{const y=w.replace(/-/g,"+").replace(/_/g,"/"),k=y.length%4===0?y:y+"=".repeat(4-y.length%4),R=atob(k),F=new Uint8Array(R.length);for(let T=0;T<R.length;T++)F[T]=R.charCodeAt(T);return new Blob([F],{type:$})};try{const w=n.selectedContent instanceof Set?Array.from(n.selectedContent):Array.isArray(n.selectedContent)?n.selectedContent:[],$={template:r,customizations:{...n,selectedContent:w},property:u,tags:b,assets:{mainImageDataUrl:v||null},generatedAt:new Date().toISOString()},y=await As.downloadBrochure((u==null?void 0:u.id)??(u==null?void 0:u.propertyId),$),k=`${p((u==null?void 0:u.title)??"property")}_brochure`;if(y instanceof Blob){N(y,k),Z.success("âœ… Brochure generated successfully!");return}if((y==null?void 0:y.data)instanceof Blob){N(y.data,k),Z.success("âœ… Brochure generated successfully!");return}const R=typeof y=="string"?y:typeof(y==null?void 0:y.base64)=="string"?y.base64:void 0;if(R){N(P(R,"application/pdf"),k),Z.success("âœ… Brochure generated successfully!");return}if(y!=null&&y.url){const T=document.createElement("a");T.href=y.url,T.download=`${k}.pdf`,document.body.appendChild(T),T.click(),T.remove(),Z.success("âœ… Brochure generated successfully!");return}N(P("JVBERi0xLjQKJdPr6eEKMSAwIG9iago8PAovVGl0bGUgKFByb3BlcnR5IEJyb2NodXJlKQo+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMyAwIFIKPj4KZW5kb2JqCjMgMCBvYmoKPDwKL1R5cGUgL1BhZ2VzCi9LaWRzIFs0IDAgUl0KL0NvdW50IDEKL01lZGlhQm94IFswIDAgNjEyIDc5Ml0KPj4KZW5kb2JqCjQgMCBvYmoKPDwKL1R5cGUgL1BhZ2UKL1BhcmVudCAzIDAgUgovQ29udGVudHMgNSAwIFIKPj4KZW5kb2JqCjUgMCBvYmoKPDwKL0xlZmd0aCA0NAo+PgpzdHJlYW0KQlQKL0YxIDI0IFRmCjEwMCA3MDAgVGQKKFByb3BlcnR5IEJyb2NodXJlKSBUagpFVAplbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCA2CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDAxNSAwMDAwMCBuIAowMDAwMDAwMDc0IDAwMDAwIG4gCjAwMDAwMDAxMjEgMDAwMDAgbiAKMDAwMDAwMDIwMCAwMDAwMCBuIAowMDAwMDAwMjY5IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNgovUm9vdCAyIDAgUgovSW5mbyAxIDAgUgo+PgpzdGFydHhyZWYKMzYyCiUlRU9G"),k),Z.success("âœ… Brochure generated (fallback).")}catch(w){console.error("Error generating brochure:",w),Z.error(`âŒ Failed to generate brochure${w!=null&&w.message?`: ${w.message}`:""}`)}finally{g(!1)}},f=(p="copy")=>{const N=`https://resaleexpert.in/brochure/${(u==null?void 0:u.propertyId)??(u==null?void 0:u.id)??""}`,P=sg((u==null?void 0:u.price)||(u==null?void 0:u.budget)),w=`ðŸ  ${(u==null?void 0:u.title)||[u==null?void 0:u.type,u==null?void 0:u.unitType].filter(Boolean).join(" ")}
ðŸ“ ${(u==null?void 0:u.locationNormalized)||(u==null?void 0:u.location)||""}${u!=null&&u.city?`, ${u.city}`:""}
ðŸ’° ${P}
ðŸ¢ ${(u==null?void 0:u.unitType)??""} ${u!=null&&u.carpetArea||u!=null&&u.square_feet?`â€¢ ${(u==null?void 0:u.carpetArea)||(u==null?void 0:u.square_feet)} sq ft`:""}

ðŸ“„ View detailed brochure: ${N}`;switch(p){case"whatsapp":window.open(`https://wa.me/?text=${encodeURIComponent(w)}`,"_blank","noopener,noreferrer");break;case"email":{const $=`Property Brochure - ${(u==null?void 0:u.title)||"Property Listing"}`;window.open(`mailto:?subject=${encodeURIComponent($)}&body=${encodeURIComponent(w)}`,"_blank","noopener,noreferrer");break}case"sms":window.open(`sms:?body=${encodeURIComponent(w)}`,"_blank","noopener,noreferrer");break;default:navigator.clipboard.writeText(N).then(()=>alert("âœ… Brochure link copied to clipboard!")).catch(()=>alert("âŒ Could not copy link"))}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Property Brochure"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[(u==null?void 0:u.title)||[u==null?void 0:u.type,u==null?void 0:u.unitType,u==null?void 0:u.subtype].filter(Boolean).join(" ")||"Property"," ","- Professional Marketing Material"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors","aria-label":"Close",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Choose Template"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Iy.map(p=>e.jsxs("button",{onClick:()=>i(p.value),className:`p-3 rounded-xl border-2 transition-all ${r===p.value?"border-purple-500 bg-purple-50 shadow-md":"border-gray-200 hover:border-gray-300"}`,type:"button",children:[e.jsx("img",{src:p.preview,alt:p.label,className:"w-full h-28 object-cover rounded-lg mb-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:p.label}),e.jsx("div",{className:"text-xs text-gray-600",children:p.description})]})]},p.value))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Design Customization"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Color"}),e.jsx("input",{type:"color",value:n.primaryColor,onChange:p=>o({...n,primaryColor:p.target.value}),className:"w-full h-12 rounded-lg border border-gray-300 cursor-pointer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secondary Color"}),e.jsx("input",{type:"color",value:n.secondaryColor,onChange:p=>o({...n,secondaryColor:p.target.value}),className:"w-full h-12 rounded-lg border border-gray-300 cursor-pointer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Style"}),e.jsx("select",{value:n.fontStyle,onChange:p=>o({...n,fontStyle:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500",children:$y.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Layout Style"}),e.jsx("select",{value:n.layout,onChange:p=>o({...n,layout:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500",children:Ey.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"watermark",checked:!!n.watermark,onChange:p=>o({...n,watermark:p.target.checked}),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("label",{htmlFor:"watermark",className:"text-sm font-medium text-gray-700",children:"Include ResaleExpert Watermark"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Selection"}),e.jsx(By,{customizations:n,setCustomizations:o})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Live Preview"}),e.jsx(Oy,{property:u,customizations:n,tags:b})]})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"ðŸ“„ Brochure will be generated in high-quality PDF format"}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[e.jsxs("button",{onClick:()=>f("email"),className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm",type:"button",children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"Email"})]}),e.jsxs("button",{onClick:()=>f("whatsapp"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",type:"button",children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"WhatsApp"})]}),e.jsx("button",{onClick:c,disabled:m,className:"flex items-center gap-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm font-semibold",type:"button",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Generating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Generate PDF"})]})})]})]})})]})})},qy=({isOpen:s,onClose:a,property:t})=>{var j,E,V;const[r,i]=l.useState([]),[n,o]=l.useState(""),[m,g]=l.useState([]),[b,d]=l.useState({name:"",contact:"",type:"phone"}),[v,x]=l.useState(!1),[u,c]=l.useState([]);if(!s||!t)return null;const f=W=>W>=1e7?`â‚¹${(W/1e7).toFixed(1)}Cr`:W>=1e5?`â‚¹${(W/1e5).toFixed(1)}L`:`â‚¹${W.toLocaleString("en-IN")}`,p=`ðŸ  *${t.title}*

ðŸ“ *Location:* ${t.location}, ${t.city}
ðŸ¢ *Type:* ${t.unitType} â€¢ ${t.carpetArea} sq ft
ðŸ’° *Price:* ${f(t.budget)}
ðŸ—ï¸ *Floor:* ${t.floor} of ${t.totalFloors}
ðŸš— *Parking:* ${t.parkingQty} ${t.parkingType}
ðŸ›‹ï¸ *Furnishing:* ${t.furnishing}

âœ¨ *Amenities:*
${((j=t.amenities)==null?void 0:j.slice(0,5).map(W=>`â€¢ ${W}`).join(`
`))||"â€¢ Premium amenities available"}

ðŸ“ž *Contact:* ${(E=t.seller)==null?void 0:E.phone}
ðŸ“§ *Email:* ${(V=t.seller)==null?void 0:V.email}

*Interested? Contact us for a site visit!*

---
Shared via ResaleExpert
ðŸŒ www.resaleexpert.com`,N=[{id:"whatsapp",label:"WhatsApp",icon:tt,color:"green",description:"Share via WhatsApp with rich formatting"},{id:"email",label:"Email",icon:Ds,color:"blue",description:"Send detailed email with property information"},{id:"sms",label:"SMS",icon:Cs,color:"purple",description:"Send SMS with property summary"},{id:"public_link",label:"Public Link",icon:_t,color:"indigo",description:"Generate shareable public link"},{id:"qr_code",label:"QR Code",icon:an,color:"gray",description:"Generate QR code for easy sharing"},{id:"social_media",label:"Social Media",icon:Wt,color:"pink",description:"Share on social media platforms"}],P=[{id:"facebook",label:"Facebook",icon:Sr,color:"blue"},{id:"twitter",label:"Twitter",icon:kr,color:"sky"},{id:"instagram",label:"Instagram",icon:El,color:"pink"},{id:"linkedin",label:"LinkedIn",icon:Cr,color:"blue"}],w=W=>{i(B=>B.includes(W)?B.filter(M=>M!==W):[...B,W])},$=()=>{b.name.trim()&&b.contact.trim()&&(g(W=>[...W,{...b,id:Date.now()}]),d({name:"",contact:"",type:"phone"}))},y=W=>{g(B=>B.filter(M=>M.id!==W))},k=()=>{const W=t.title.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");return`https://resaleexpert.com/property/${t.propertyId}/${W}`},R=()=>{const W=k();return`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(W)}`},F=async()=>{if(r.length===0){alert("Please select at least one sharing channel");return}x(!0),c([]);try{const W=[];for(const B of r)switch(await new Promise(M=>setTimeout(M,500)),B){case"whatsapp":if(m.length>0){for(const D of m)if(D.type==="phone"){const I=`https://wa.me/${D.contact.replace(/\D/g,"")}?text=${encodeURIComponent(n||p)}`;window.open(I,"_blank"),W.push({channel:"WhatsApp",recipient:D.name,status:"sent"})}}break;case"email":if(m.length>0){for(const D of m)if(D.type==="email"){const I=`Property Listing - ${t.title}`,H=n||p,h=`mailto:${D.contact}?subject=${encodeURIComponent(I)}&body=${encodeURIComponent(H)}`;window.open(h,"_blank"),W.push({channel:"Email",recipient:D.name,status:"sent"})}}break;case"public_link":const M=k();navigator.clipboard.writeText(M),W.push({channel:"Public Link",recipient:"Copied to clipboard",status:"generated"});break;case"qr_code":const A=R(),L=window.open("","_blank");L&&L.document.write(`
                <html>
                  <head><title>QR Code - ${t.title}</title></head>
                  <body style="text-align: center; padding: 20px; font-family: Arial, sans-serif;">
                    <h2>${t.title}</h2>
                    <img src="${A}" alt="QR Code" style="margin: 20px;">
                    <p>Scan to view property details</p>
                    <p style="font-size: 12px; color: #666;">${k()}</p>
                  </body>
                </html>
              `),W.push({channel:"QR Code",recipient:"Generated",status:"created"});break;default:W.push({channel:B,recipient:"Multiple",status:"sent"})}c(W),setTimeout(()=>{a()},3e3)}catch(W){console.error("Sharing failed:",W)}finally{x(!1)}},T=W=>{navigator.clipboard.writeText(W),alert("Copied to clipboard!")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(Wt,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Share Property"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.title})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Property Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Property:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Location:"}),e.jsxs("span",{className:"font-semibold ml-2",children:[t.location,", ",t.city]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Type:"}),e.jsxs("span",{className:"font-semibold ml-2",children:[t.unitType," â€¢ ",t.carpetArea," sq ft"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Price:"}),e.jsx("span",{className:"font-semibold ml-2",children:f(t.budget)})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select Sharing Channels"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(W=>{const B=W.icon,M=r.includes(W.id);return e.jsxs("button",{onClick:()=>w(W.id),className:`p-4 rounded-xl border-2 transition-all text-left ${M?`border-${W.color}-500 bg-${W.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(B,{size:20,className:M?`text-${W.color}-600`:"text-gray-400"}),e.jsx("span",{className:`font-medium ${M?`text-${W.color}-900`:"text-gray-600"}`,children:W.label}),M&&e.jsx(bs,{size:16,className:`text-${W.color}-600`})]}),e.jsx("p",{className:"text-xs text-gray-500",children:W.description})]},W.id)})})]}),r.includes("social_media")&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Social Media Platforms"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:P.map(W=>{const B=W.icon;return e.jsx("button",{className:`p-3 rounded-lg border border-gray-200 hover:bg-${W.color}-50 transition-colors`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:`text-${W.color}-600`,size:16}),e.jsx("span",{className:"text-sm font-medium",children:W.label})]})},W.id)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recipients"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx("input",{type:"text",value:b.name,onChange:W=>d({...b,name:W.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Recipient name"}),e.jsx("input",{type:"text",value:b.contact,onChange:W=>d({...b,contact:W.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Phone/Email"}),e.jsxs("select",{value:b.type,onChange:W=>d({...b,type:W.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"phone",children:"Phone"}),e.jsx("option",{value:"email",children:"Email"})]}),e.jsx("button",{onClick:$,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add"})]})}),e.jsxs("div",{className:"space-y-2",children:[m.map(W=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:W.type==="email"?e.jsx(Ds,{size:16,className:"text-blue-600"}):e.jsx(Cs,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:W.name}),e.jsx("div",{className:"text-sm text-gray-600",children:W.contact})]})]}),e.jsx("button",{onClick:()=>y(W.id),className:"text-red-600 hover:text-red-800",children:e.jsx(ns,{size:16})})]},W.id)),m.length===0&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No recipients added. Add recipients to send property details."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Message"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>o(p),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 transition-colors",children:"Use Default"}),e.jsxs("button",{onClick:()=>T(n||p),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:[e.jsx(Xt,{size:12,className:"inline mr-1"}),"Copy"]})]}),e.jsx("textarea",{value:n||p,onChange:W=>o(W.target.value),className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Enter your custom message..."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>T(k()),className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(za,{className:"text-blue-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Copy Public Link"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Share direct property link"})]})]}),e.jsxs("button",{onClick:()=>{const W=window.open("","_blank");W&&W.document.write(`
                      <html>
                        <head><title>QR Code - ${t.title}</title></head>
                        <body style="text-align: center; padding: 20px; font-family: Arial, sans-serif;">
                          <h2>${t.title}</h2>
                          <img src="${R()}" alt="QR Code" style="margin: 20px;">
                          <p>Scan to view property details</p>
                          <p style="font-size: 12px; color: #666;">${k()}</p>
                        </body>
                      </html>
                    `)},className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(an,{className:"text-gray-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Generate QR Code"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Create scannable QR code"})]})]})]})]}),u.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Sharing Results"}),e.jsx("div",{className:"space-y-2",children:u.map((W,B)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-600",size:16}),e.jsxs("span",{className:"text-sm font-medium text-green-800",children:[W.channel," - ",W.recipient]})]}),e.jsx("span",{className:"text-xs text-green-600 uppercase font-medium",children:W.status})]},B))})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," channel",r.length!==1?"s":""," selected â€¢ ",m.length," recipient",m.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:F,disabled:r.length===0||v,className:"flex items-center space-x-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{size:16,className:"animate-spin"}),e.jsx("span",{children:"Sharing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"Share Now"})]})})]})]})})]})})},Vo=[{id:"mandate_agreement",name:"Exclusive Mandate Agreement",description:"Exclusive selling rights agreement",category:"agency",template:"mandate_template",requiredFields:["seller_name","property_address","commission_rate","validity_period"],process:["Create document with property details","Send to seller for review","OTP verification","Digital signature with Aadhaar OTP","Document completion and filing"]},{id:"authorization_letter",name:"Selling Authorization Letter",description:"Authorization to sell property",category:"agency",template:"authorization_template",requiredFields:["seller_name","property_address","commission_rate"],process:["Generate authorization letter","Share with seller","Get signed copy","Verify and file"]},{id:"marketing_rights",name:"Marketing Rights Letter",description:"Rights to market the property",category:"agency",template:"marketing_template",requiredFields:["seller_name","property_address","validity_period"],process:["Create marketing rights document","Seller approval","Marketing authorization","Active marketing"]},{id:"brokerage_confirmation",name:"Brokerage Confirmation Letter",description:"Brokerage terms confirmation",category:"financial",template:"brokerage_template",requiredFields:["seller_name","commission_rate","property_address"],process:["Generate brokerage terms","Seller confirmation","Terms agreement","Commission structure finalized"]}],Mm=s=>{var a,t,r;return{seller_name:((a=s==null?void 0:s.seller)==null?void 0:a.name)??"",seller_phone:((t=s==null?void 0:s.seller)==null?void 0:t.phone)??"",seller_email:((r=s==null?void 0:s.seller)==null?void 0:r.email)??"",property_address:(s==null?void 0:s.address)??"",property_type:(s==null?void 0:s.unitType)??"",property_area:(s==null?void 0:s.carpetArea)??"",commission_rate:"2",validity_period:"6 months",agreement_date:new Date().toISOString().split("T")[0]}},Vy=({isOpen:s,onClose:a,property:t})=>{var u;const[r,i]=l.useState(""),[n,o]=l.useState(Mm(t??null)),[m,g]=l.useState(!1);if(l.useEffect(()=>{s&&(o(Mm(t??null)),i(""))},[s,t]),!s)return null;const b=c=>{i(c.id),o(f=>({...f,document_type:c.id,template_id:c.template}))},d=(c,f)=>{o(p=>({...p,[c]:f}))},v=async()=>{if(!r){window.alert("Please select a document type");return}const c=Vo.find(p=>p.id===r);if(!c)return;const f=c.requiredFields.filter(p=>!n[p]||typeof n[p]=="string"&&n[p].trim()==="");if(f.length>0){window.alert(`Please fill in required fields: ${f.join(", ")}`);return}g(!0);try{await new Promise(N=>setTimeout(N,1200));const p={id:Date.now(),title:`${c.name} - ${(t==null?void 0:t.title)??"Property"}`,template_name:c.name,template_id:c.template,data:n,status:"created",priority:"high",created_by:"Admin User",created_at:new Date().toISOString(),property_id:t==null?void 0:t.propertyId,tracking_history:[{action:"Document Created",timestamp:new Date().toISOString(),user:"Admin User",details:`${c.name} created for property ${(t==null?void 0:t.title)??""}`,stage:"created",icon:"FileText"}]};window.alert("Document created successfully in Document Center!"),x(p,c)}catch(p){console.error("Error creating document:",p),window.alert("Failed to create document")}finally{g(!1)}},x=(c,f)=>{const p=`Dear ${n.seller_name||"Seller"},

Your ${f.name} for property ${(t==null?void 0:t.title)??""} is ready for review.

Document ID: ${c.id}
Property: ${(t==null?void 0:t.title)??""}
Location: ${(t==null?void 0:t.location)??""}, ${(t==null?void 0:t.city)??""}

Please review and provide your approval.

For any queries, contact us at ${n.seller_phone||"N/A"}

Best regards,
ResaleExpert Team`;if(n.seller_phone){const N=n.seller_phone.replace(/\D/g,"");if(N){const P=`https://wa.me/${N}?text=${encodeURIComponent(p)}`;window.open(P,"_blank","noopener,noreferrer")}}if(n.seller_email){const N=`${f.name} - ${(t==null?void 0:t.title)??""}`,P=`mailto:${n.seller_email}?subject=${encodeURIComponent(N)}&body=${encodeURIComponent(p)}`;window.open(P,"_blank","noopener,noreferrer")}window.alert("Document shared with seller via available channels (WhatsApp / Email).")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Property Documents"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[(t==null?void 0:t.title)??"Property"," - Legal & Authorization Documents"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg","aria-label":"Close",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Document Type"}),Vo.map(c=>e.jsx("button",{onClick:()=>b(c),className:`w-full p-4 rounded-xl border-2 transition-all text-left ${r===c.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,type:"button",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ws,{className:"text-blue-600",size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:c.name}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:c.description}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs",children:c.category}),e.jsxs("span",{className:"text-xs text-gray-500",children:[c.process.length," steps"]})]})]})]})},c.id))]}),e.jsx("div",{className:"space-y-6",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document Process"}),e.jsx("div",{className:"space-y-3",children:(u=Vo.find(c=>c.id===r))==null?void 0:u.process.map((c,f)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-sm font-bold",children:f+1}),e.jsx("span",{className:"text-sm text-gray-700",children:c})]},f))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Name"}),e.jsx("input",{type:"text",value:n.seller_name,onChange:c=>d("seller_name",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Address"}),e.jsx("textarea",{value:n.property_address,onChange:c=>d("property_address",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Commission Rate (%)"}),e.jsx("input",{type:"number",value:n.commission_rate,onChange:c=>d("commission_rate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Validity Period"}),e.jsxs("select",{value:n.validity_period,onChange:c=>d("validity_period",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"3 months",children:"3 months"}),e.jsx("option",{value:"6 months",children:"6 months"}),e.jsx("option",{value:"1 year",children:"1 year"}),e.jsx("option",{value:"2 years",children:"2 years"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Agreement Date"}),e.jsx("input",{type:"date",value:n.agreement_date,onChange:c=>d("agreement_date",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-4",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"Document Features"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(at,{className:"text-green-600",size:14}),e.jsx("span",{className:"text-sm text-green-800",children:"Aadhaar OTP verification"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-600",size:14}),e.jsx("span",{className:"text-sm text-green-800",children:"Digital signature support"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Wt,{className:"text-green-600",size:14}),e.jsx("span",{className:"text-sm text-green-800",children:"Multi-channel sharing"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ks,{className:"text-green-600",size:14}),e.jsx("span",{className:"text-sm text-green-800",children:"Real-time tracking"})]})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ws,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Select Document Type"}),e.jsx("p",{className:"text-gray-500",children:"Choose the type of document you want to create"})]})})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:r?"Document will be created in Document Center":"Select document type to continue"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",type:"button",children:"Cancel"}),e.jsx("button",{onClick:v,disabled:!r||m,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",type:"button",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Creating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Create Document"})]})})]})]})})]})})},Wy=({isOpen:s,onClose:a,property:t})=>{const[r,i]=l.useState({buyerName:"",buyerPhone:"",buyerEmail:"",initialOffer:0,counterOffer:0,finalPrice:0,negotiationStage:"initial_offer",paymentTerms:"",possessionDate:"",conditions:"",brokerageTerms:"",remarks:""}),[n,o]=l.useState([{id:1,date:"2025-01-10",action:"Initial Offer",amount:23e6,party:"Buyer",remarks:"First offer submitted",status:"received"},{id:2,date:"2025-01-11",action:"Counter Offer",amount:245e5,party:"Seller",remarks:"Counter offer with minor adjustment",status:"sent"}]),[m,g]=l.useState(!1);if(!s)return null;const b=[{value:"initial_offer",label:"Initial Offer",description:"First offer from buyer"},{value:"counter_offer",label:"Counter Offer",description:"Seller counter proposal"},{value:"negotiation",label:"Active Negotiation",description:"Back and forth negotiation"},{value:"final_offer",label:"Final Offer",description:"Last and final offer"},{value:"accepted",label:"Offer Accepted",description:"Deal terms agreed"},{value:"rejected",label:"Offer Rejected",description:"Negotiation ended"}],d=["Immediate payment","10% token, 90% on registration","20% token, 80% on registration","30% token, 70% on registration","Custom payment plan"],v=(p,N)=>{i(P=>({...P,[p]:N}))},x=()=>{if(!r.buyerName.trim()||!r.initialOffer){alert("Please fill in buyer details and offer amount");return}const p={id:Date.now(),date:new Date().toISOString().split("T")[0],action:"New Negotiation",amount:r.initialOffer,party:"Buyer",remarks:r.remarks||"New negotiation started",status:"active"};o(N=>[...N,p]),alert("Negotiation entry added successfully!")},u=async()=>{if(!r.buyerName.trim()){alert("Please enter buyer name");return}g(!0);try{const p={...r,id:Date.now(),propertyId:t.propertyId,history:n,created_at:new Date().toISOString()};alert("Negotiation details saved successfully!"),a()}catch(p){console.error("Error saving negotiation:",p)}finally{g(!1)}},c=p=>p>=1e7?`â‚¹${(p/1e7).toFixed(1)}Cr`:p>=1e5?`â‚¹${(p/1e5).toFixed(1)}L`:`â‚¹${p.toLocaleString("en-IN")}`,f=p=>{const N=`Negotiation Update - ${t.title}

Dear ${r.buyerName},

Your offer: ${c(r.initialOffer)}
Counter offer: ${c(r.counterOffer)}

Property: ${t.title}
Location: ${t.location}, ${t.city}

Please review and respond.

Best regards,
ResaleExpert Team`;switch(p){case"whatsapp":window.open(`https://wa.me/${r.buyerPhone.replace(/\D/g,"")}?text=${encodeURIComponent(N)}`,"_blank");break;case"email":const P=`Negotiation Update - ${t.title}`;window.open(`mailto:${r.buyerEmail}?subject=${encodeURIComponent(P)}&body=${encodeURIComponent(N)}`,"_blank");break;case"sms":alert("SMS functionality would be integrated with SMS gateway");break}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Property Negotiation"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.title," - Price Negotiation Management"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Buyer Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Name"}),e.jsx("input",{type:"text",value:r.buyerName,onChange:p=>v("buyerName",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter buyer name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:r.buyerPhone,onChange:p=>v("buyerPhone",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+91 98765 43210"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:r.buyerEmail,onChange:p=>v("buyerEmail",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"buyer@email.com"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Negotiation Terms"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Initial Offer (â‚¹)"}),e.jsx("input",{type:"number",value:r.initialOffer,onChange:p=>v("initialOffer",Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"23000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Counter Offer (â‚¹)"}),e.jsx("input",{type:"number",value:r.counterOffer,onChange:p=>v("counterOffer",Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"24500000"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Negotiation Stage"}),e.jsx("select",{value:r.negotiationStage,onChange:p=>v("negotiationStage",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:b.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms"}),e.jsxs("select",{value:r.paymentTerms,onChange:p=>v("paymentTerms",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select payment terms"}),d.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Possession Date"}),e.jsx("input",{type:"date",value:r.possessionDate,onChange:p=>v("possessionDate",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Negotiation History"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:n.map(p=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[p.action.includes("Offer")?e.jsx(rt,{className:"text-blue-600",size:16}):e.jsx(tt,{className:"text-green-600",size:16}),e.jsx("span",{className:"font-medium text-gray-900",children:p.action})]}),e.jsx("span",{className:"text-sm text-gray-500",children:p.date})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:c(p.amount)}),e.jsxs("div",{className:"text-sm text-gray-600",children:["by ",p.party]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p.status==="accepted"?"bg-green-100 text-green-800":p.status==="rejected"?"bg-red-100 text-red-800":p.status==="active"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:p.status})})]}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:p.remarks})]},p.id))})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"Price Analysis"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Asking Price:"}),e.jsx("span",{className:"font-bold text-blue-900",children:c(t.budget)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Negotiable Price:"}),e.jsx("span",{className:"font-bold text-blue-900",children:c(t.negotiablePrice||t.budget*.95)})]}),r.initialOffer>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Buyer Offer:"}),e.jsx("span",{className:"font-bold text-green-600",children:c(r.initialOffer)})]}),r.counterOffer>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Counter Offer:"}),e.jsx("span",{className:"font-bold text-orange-600",children:c(r.counterOffer)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("button",{onClick:()=>f("whatsapp"),className:"flex items-center space-x-2 p-3 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(tt,{size:16}),e.jsx("span",{children:"Send WhatsApp Update"})]}),e.jsxs("button",{onClick:()=>f("email"),className:"flex items-center space-x-2 p-3 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(Ds,{size:16}),e.jsx("span",{children:"Send Email Update"})]}),e.jsxs("button",{onClick:()=>window.open(`tel:${r.buyerPhone}`),className:"flex items-center space-x-2 p-3 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors",children:[e.jsx(Cs,{size:16}),e.jsx("span",{children:"Call Buyer"})]})]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Terms & Conditions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Special Conditions"}),e.jsx("textarea",{value:r.conditions,onChange:p=>v("conditions",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Any special conditions or requirements..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brokerage Terms"}),e.jsx("textarea",{value:r.brokerageTerms,onChange:p=>v("brokerageTerms",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Brokerage payment terms and conditions..."})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Negotiation will be tracked in property timeline"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:x,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Add Entry"}),e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:u,disabled:m||!r.buyerName.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:m?"Saving...":"Save Negotiation"})]})]})]})})]})})},Hy=({isOpen:s,onClose:a,property:t,reminders:r,onUpdateReminders:i})=>{var y;const[n,o]=l.useState({type:"stage_progress",title:"",description:"",dueDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],dueTime:"10:00",priority:"medium",assignedTo:"Admin User",recurring:!1,recurringType:"weekly",notificationChannels:["email","whatsapp"]}),[m,g]=l.useState(!1);if(!s)return null;const b=[{value:"stage_progress",label:"Stage Progress",description:"Follow up on stage completion"},{value:"weekly_update",label:"Weekly Update",description:"Regular status update"},{value:"photo_video",label:"Photo/Video Shoot",description:"Schedule media capture"},{value:"portal_publish",label:"Portal Publishing",description:"Publish on property portals"},{value:"buyer_followup",label:"Buyer Follow-up",description:"Follow up with interested buyers"},{value:"document_signing",label:"Document Signing",description:"Complete document formalities"},{value:"price_review",label:"Price Review",description:"Review and adjust pricing"},{value:"maintenance",label:"Maintenance Check",description:"Property maintenance review"},{value:"marketing_review",label:"Marketing Review",description:"Review marketing performance"},{value:"custom",label:"Custom Reminder",description:"Custom task or reminder"}],d=[{value:"urgent",label:"Urgent",color:"red"},{value:"high",label:"High",color:"orange"},{value:"medium",label:"Medium",color:"yellow"},{value:"low",label:"Low",color:"green"}],v=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"}],x=["Admin User","Property Manager","Sales Executive","Marketing Team"],u=[{value:"email",label:"Email"},{value:"whatsapp",label:"WhatsApp"},{value:"sms",label:"SMS"},{value:"push",label:"Push Notification"}],c=(k,R)=>{o(F=>({...F,[k]:R}))},f=k=>{o(R=>({...R,notificationChannels:R.notificationChannels.includes(k)?R.notificationChannels.filter(F=>F!==k):[...R.notificationChannels,k]}))},p=()=>{if(!n.title.trim()){alert("Please enter reminder title");return}const k={...n,id:Date.now(),propertyId:t.propertyId,status:"pending",created_at:new Date().toISOString()};i([...r,k]),o({type:"stage_progress",title:"",description:"",dueDate:new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0],dueTime:"10:00",priority:"medium",assignedTo:"Admin User",recurring:!1,recurringType:"weekly",notificationChannels:["email","whatsapp"]})},N=k=>{i(r.filter(R=>R.id!==k))},P=k=>{i(r.map(R=>R.id===k?{...R,status:"completed",completedAt:new Date().toISOString()}:R))},w=k=>{const R=d.find(F=>F.value===k);return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium bg-${R==null?void 0:R.color}-100 text-${R==null?void 0:R.color}-700`,children:R==null?void 0:R.label})},$=k=>k==="completed"?e.jsx(bs,{className:"text-green-500",size:16}):e.jsx(Ls,{className:"text-orange-500",size:16});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-red-50 to-orange-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-xl",children:e.jsx(ha,{className:"text-red-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Property Reminders"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.title," - Task & Follow-up Management"]})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Reminder"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reminder Type"}),e.jsx("select",{value:n.type,onChange:k=>c("type",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",children:b.map(k=>e.jsx("option",{value:k.value,children:k.label},k.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(y=b.find(k=>k.value===n.type))==null?void 0:y.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:n.title,onChange:k=>c("title",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Enter reminder title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:k=>c("description",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",rows:2,placeholder:"Additional details..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:n.dueDate,onChange:k=>c("dueDate",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Time"}),e.jsx("input",{type:"time",value:n.dueTime,onChange:k=>c("dueTime",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("select",{value:n.priority,onChange:k=>c("priority",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",children:d.map(k=>e.jsx("option",{value:k.value,children:k.label},k.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),e.jsx("select",{value:n.assignedTo,onChange:k=>c("assignedTo",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",children:x.map(k=>e.jsx("option",{value:k,children:k},k))})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:n.recurring,onChange:k=>c("recurring",k.target.checked),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Recurring Reminder"})]}),n.recurring&&e.jsx("select",{value:n.recurringType,onChange:k=>c("recurringType",k.target.value),className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",children:v.map(k=>e.jsx("option",{value:k.value,children:k.label},k.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notification Channels"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:u.map(k=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:n.notificationChannels.includes(k.value),onChange:()=>f(k.value),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:k.label})]},k.value))})]}),e.jsxs("button",{onClick:p,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Reminder"})]})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Active Reminders"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-red-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:r.filter(k=>k.priority==="urgent"&&k.status==="pending").length}),e.jsx("div",{className:"text-xs text-red-700",children:"Urgent"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:r.filter(k=>k.status==="pending").length}),e.jsx("div",{className:"text-xs text-orange-700",children:"Pending"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:r.filter(k=>k.status==="completed").length}),e.jsx("div",{className:"text-xs text-green-700",children:"Completed"})]})]}),e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[r.map(k=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[$(k.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:k.title}),e.jsx("div",{className:"text-sm text-gray-600",children:k.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[k.status==="pending"&&e.jsx("button",{onClick:()=>P(k.id),className:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Mark Complete",children:e.jsx(bs,{size:14})}),e.jsx("button",{onClick:()=>N(k.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete",children:e.jsx(Es,{size:14})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Due:"}),e.jsxs("span",{className:"font-medium ml-2",children:[k.dueDate," ",k.dueTime]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Assigned:"}),e.jsx("span",{className:"font-medium ml-2",children:k.assignedTo})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[w(k.priority),e.jsx("div",{className:"flex items-center space-x-1",children:k.notificationChannels.map((R,F)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:R},F))})]}),k.recurring&&e.jsxs("div",{className:"mt-2 text-xs text-purple-600 bg-purple-100 px-2 py-1 rounded",children:["Recurring: ",k.recurringType]})]},k.id)),r.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ha,{className:"mx-auto mb-2",size:32}),e.jsx("p",{children:"No reminders set for this property"})]})]})]})})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[r.filter(k=>k.status==="pending").length," pending reminders â€¢",r.filter(k=>k.priority==="urgent").length," urgent tasks"]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})})]})})]})})},Yy=({isOpen:s,onClose:a,property:t,onUpdate:r})=>{var $;const[i,n]=l.useState("photos"),[o,m]=l.useState([]),[g,b]=l.useState(0),[d,v]=l.useState(!1);if(!s)return null;const x=[{id:"photos",label:"Photos",icon:Sa},{id:"videos",label:"Videos",icon:En},{id:"virtual_tour",label:"Virtual Tour",icon:Vn},{id:"drone",label:"Drone Footage",icon:En}],u=["Exterior","Living Room","Bedrooms","Kitchen","Bathrooms","Balcony","Amenities","Parking"],c=[{id:1,url:"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=400",category:"Exterior",title:"Building Front View"},{id:2,url:"https://images.pexels.com/photos/1396132/pexels-photo-1396132.jpeg?auto=compress&cs=tinysrgb&w=400",category:"Living Room",title:"Spacious Living Area"},{id:3,url:"https://images.pexels.com/photos/1396125/pexels-photo-1396125.jpeg?auto=compress&cs=tinysrgb&w=400",category:"Kitchen",title:"Modern Kitchen"},{id:4,url:"https://images.pexels.com/photos/1396126/pexels-photo-1396126.jpeg?auto=compress&cs=tinysrgb&w=400",category:"Bedrooms",title:"Master Bedroom"}],f=[{id:1,url:"#",thumbnail:c[0].url,title:"Property Walkthrough",duration:"3:45"},{id:2,url:"#",thumbnail:c[1].url,title:"Amenities Tour",duration:"2:30"}],p=async(y,k="general")=>{if(!(!y||y.length===0)){v(!0),b(0);try{for(let R=0;R<y.length;R++){const F=y[R];for(let E=0;E<=100;E+=10)b(E),await new Promise(V=>setTimeout(V,80));const T=F.type.startsWith("video/"),j=URL.createObjectURL(F);if(T){const E={id:Date.now()+R,url:j,thumbnail:j,title:F.name,uploadedAt:new Date().toISOString()},V={...t,videos:[...t.videos||[],E]};r(V)}else{const E={...t,photos:[...t.photos||[],j]};r(E)}}window.alert("Media uploaded successfully!")}catch(R){console.error("Upload error:",R),window.alert("Upload failed")}finally{v(!1),b(0)}}},N=y=>{m(k=>k.includes(y)?k.filter(R=>R!==y):[...k,y])},P=()=>{if(o.length===0){window.alert("Please select media to delete");return}if(!window.confirm(`Delete ${o.length} selected items?`))return;const y=(t.photos||[]).filter((F,T)=>!o.includes(`photo-${T}`)&&!o.includes(F)),k=(t.videos||[]).filter(F=>!o.includes(String(F.id))&&!o.includes(F.url)),R={...t,photos:y,videos:k};r(R),m([]),window.alert("Selected media deleted successfully!")},w=()=>{new Date(Date.now()+4320*60*1e3).toISOString().split("T")[0],window.alert("Professional photoshoot scheduled! Photographer will contact you within 24 hours.")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Property Media Management"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t==null?void 0:t.title," - Photos, Videos & Virtual Tours"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"border-b border-gray-200 px-6",children:e.jsx("nav",{className:"flex space-x-8",children:x.map(y=>{const k=y.icon;return e.jsxs("button",{onClick:()=>n(y.id),className:`flex items-center space-x-2 py-4 border-b-2 font-medium text-sm transition-colors ${i===y.id?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(k,{size:16}),e.jsx("span",{children:y.label})]},y.id)})})}),e.jsxs("div",{className:"p-6 max-h-[65vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Upload ",($=x.find(y=>y.id===i))==null?void 0:$.label]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[o.length>0&&e.jsxs("button",{onClick:P,className:"flex items-center space-x-2 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(Es,{size:16}),e.jsxs("span",{children:["Delete Selected (",o.length,")"]})]}),e.jsxs("button",{onClick:w,className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(Sa,{size:16}),e.jsx("span",{children:"Schedule Professional Shoot"})]})]})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-purple-400 transition-colors",children:[e.jsx("input",{type:"file",multiple:!0,accept:i==="videos"?"video/*":"image/*",onChange:y=>p(y.target.files,"general"),className:"hidden",id:"media-upload"}),e.jsx("label",{htmlFor:"media-upload",className:"cursor-pointer",children:e.jsxs("div",{className:"space-y-2",children:[i==="videos"?e.jsx(En,{className:"mx-auto text-gray-400",size:32}):e.jsx(Sa,{className:"mx-auto text-gray-400",size:32}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-600",children:["Drop ",i==="videos"?"videos":"photos"," here or click to browse"]}),e.jsx("p",{className:"text-sm text-gray-500",children:i==="videos"?"MP4, MOV, AVI up to 100MB":"JPG, PNG up to 10MB each"})]})]})}),d&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all",style:{width:`${g}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Uploading... ",g,"%"]})]})]})]}),i==="photos"&&e.jsx("div",{className:"space-y-4",children:u.map(y=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:y}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[c.filter(k=>k.category===y).map(k=>e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"checkbox",checked:o.includes(String(k.id)),onChange:()=>N(String(k.id)),className:"absolute top-2 left-2 z-10 rounded border-gray-300 text-purple-600"}),e.jsx("img",{src:k.url,alt:k.title,className:"w-full h-24 object-cover rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex space-x-2",children:[e.jsx("button",{className:"p-2 bg-white rounded-lg text-gray-700 hover:bg-gray-100",children:e.jsx(ks,{size:16})}),e.jsx("button",{className:"p-2 bg-white rounded-lg text-gray-700 hover:bg-gray-100",children:e.jsx(ft,{size:16})})]})}),e.jsx("div",{className:"mt-1 text-xs text-gray-600 text-center",children:k.title})]},k.id)),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg h-24 flex items-center justify-center hover:border-purple-400 transition-colors cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:k=>p(k.target.files,y),className:"hidden",id:`upload-${y}`}),e.jsx("label",{htmlFor:`upload-${y}`,className:"cursor-pointer",children:e.jsx(fs,{className:"text-gray-400",size:20})})]})]})]},y))}),i==="videos"&&e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.map(y=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:o.includes(String(y.id)),onChange:()=>N(String(y.id)),className:"absolute top-2 left-2 z-10 rounded border-gray-300 text-purple-600"}),e.jsx("img",{src:y.thumbnail,alt:y.title,className:"w-full h-32 object-cover rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 rounded-lg flex items-center justify-center",children:e.jsx(_l,{className:"text-white",size:32})}),e.jsx("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs",children:y.duration})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"font-medium text-gray-900",children:y.title}),e.jsx("div",{className:"flex items-center justify-between mt-2",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"p-1 bg-blue-100 text-blue-600 rounded",children:e.jsx(_l,{size:12})}),e.jsx("button",{className:"p-1 bg-green-100 text-green-600 rounded",children:e.jsx(Ys,{size:12})}),e.jsx("button",{className:"p-1 bg-purple-100 text-purple-600 rounded",children:e.jsx(ft,{size:12})})]})})]})]},y.id))})}),i==="virtual_tour"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Virtual Tour"}),e.jsx("div",{className:"bg-gray-100 rounded-lg h-64 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Vn,{className:"mx-auto text-gray-400 mb-2",size:48}),e.jsx("p",{className:"text-gray-500",children:"360Â° Virtual Tour will be displayed here"}),e.jsx("button",{className:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Create Virtual Tour"})]})})]})}),i==="drone"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Drone Footage"}),e.jsx("div",{className:"bg-gray-100 rounded-lg h-64 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(En,{className:"mx-auto text-gray-400 mb-2",size:48}),e.jsx("p",{className:"text-gray-500",children:"Aerial drone footage will be displayed here"}),e.jsx("button",{className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Schedule Drone Shoot"})]})})]})})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[o.length," items selected â€¢ Professional photography available"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),e.jsxs("button",{onClick:()=>window.alert("Media management saved!"),className:"flex items-center space-x-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:"Save Changes"})]})]})]})})]})})},Gy=({isOpen:s,onClose:a,property:t,onUpdate:r})=>{var P;const[i,n]=l.useState(["magicbricks","99acres"]),[o,m]=l.useState(["facebook","instagram"]),[g,b]=l.useState({includeContactInfo:!0,includePrice:!0,includeBrokerInfo:!0,autoRefresh:!0,featuredListing:!1,premiumPlacement:!1}),[d,v]=l.useState(!1);if(!s)return null;const x=[{id:"magicbricks",name:"MagicBricks",logo:"ðŸ ",reach:"2.5M users",cost:"Free",features:["High visibility","Lead generation","Analytics"]},{id:"99acres",name:"99acres",logo:"ðŸ¢",reach:"1.8M users",cost:"Free",features:["Premium listings","Verified leads","Market insights"]},{id:"housing",name:"Housing.com",logo:"ðŸ¡",reach:"1.2M users",cost:"Free",features:["Map-based search","Virtual tours","Instant connect"]},{id:"commonfloor",name:"CommonFloor",logo:"ðŸ˜ï¸",reach:"800K users",cost:"Free",features:["Society focus","Neighbor network","Local insights"]}],u=[{id:"facebook",name:"Facebook",icon:Sr,color:"blue",reach:"500M+ users",features:["Targeted ads","Local groups","Marketplace"]},{id:"instagram",name:"Instagram",icon:El,color:"pink",reach:"200M+ users",features:["Visual content","Stories","Reels"]},{id:"twitter",name:"Twitter",icon:kr,color:"sky",reach:"100M+ users",features:["Real-time updates","Hashtags","Trending"]},{id:"linkedin",name:"LinkedIn",icon:Cr,color:"blue",reach:"50M+ users",features:["Professional network","B2B reach","Industry groups"]}],c=w=>{n($=>$.includes(w)?$.filter(y=>y!==w):[...$,w])},f=w=>{m($=>$.includes(w)?$.filter(y=>y!==w):[...$,w])},p=async()=>{if(i.length===0&&o.length===0){alert("Please select at least one platform to publish");return}v(!0);try{await new Promise(y=>setTimeout(y,3e3));const w={portals:i,socialPlatforms:o,settings:g,publishedAt:new Date().toISOString(),status:"published"},$={...t,isPublic:!0,publishedPlatforms:[...i,...o],publishSettings:w,publicViews:(t.publicViews||0)+Math.floor(Math.random()*50),publicInquiries:(t.publicInquiries||0)+Math.floor(Math.random()*5)};r($),alert("Property published successfully on selected platforms!"),a()}catch(w){console.error("Publishing error:",w),alert("Failed to publish property")}finally{v(!1)}},N=w=>w>=1e7?`â‚¹${(w/1e7).toFixed(1)}Cr`:w>=1e5?`â‚¹${(w/1e5).toFixed(1)}L`:`â‚¹${w.toLocaleString("en-IN")}`;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Publish Property"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.title," - Multi-platform Publishing"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Property Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Property:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Location:"}),e.jsxs("span",{className:"font-semibold ml-2",children:[t.location,", ",t.city]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Type:"}),e.jsxs("span",{className:"font-semibold ml-2",children:[t.unitType," â€¢ ",t.carpetArea," sq ft"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Price:"}),e.jsx("span",{className:"font-semibold ml-2",children:N(t.budget)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Property Portals"}),e.jsx("div",{className:"space-y-3",children:x.map(w=>e.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${i.includes(w.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>c(w.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:w.logo}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:w.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[w.reach," â€¢ ",w.cost]})]})]}),i.includes(w.id)&&e.jsx(bs,{className:"text-blue-600",size:20})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:w.features.map(($,y)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:$},y))})]},w.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Social Media"}),e.jsx("div",{className:"space-y-3",children:u.map(w=>{const $=w.icon;return e.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all cursor-pointer ${o.includes(w.id)?`border-${w.color}-500 bg-${w.color}-50`:"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(w.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($,{className:`text-${w.color}-600`,size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:w.name}),e.jsx("div",{className:"text-sm text-gray-600",children:w.reach})]})]}),o.includes(w.id)&&e.jsx(bs,{className:`text-${w.color}-600`,size:20})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:w.features.map((y,k)=>e.jsx("span",{className:`px-2 py-1 bg-${w.color}-100 text-${w.color}-700 rounded-full text-xs`,children:y},k))})]},w.id)})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Publishing Settings"}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{key:"includeContactInfo",label:"Include Contact Information",description:"Show seller contact details"},{key:"includePrice",label:"Include Price",description:"Display property price"},{key:"includeBrokerInfo",label:"Include Broker Information",description:"Show ResaleExpert details"},{key:"autoRefresh",label:"Auto Refresh Listings",description:"Automatically refresh every 7 days"},{key:"featuredListing",label:"Featured Listing",description:"Highlight as featured property"},{key:"premiumPlacement",label:"Premium Placement",description:"Top placement in search results"}].map(w=>e.jsxs("label",{className:"flex items-start space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:g[w.key],onChange:$=>b({...g,[w.key]:$.target.checked}),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:w.label}),e.jsx("div",{className:"text-sm text-gray-600",children:w.description})]})]},w.key))})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Publishing Preview"}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4",children:e.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:((P=t.photos)==null?void 0:P[0])||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=200",alt:t.title,className:"w-24 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.location,", ",t.city]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:t.unitType}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.carpetArea," sq ft"]}),g.includePrice&&e.jsx("span",{className:"font-bold text-green-600",children:N(t.budget)})]}),g.includeBrokerInfo&&e.jsx("div",{className:"mt-2 text-xs text-blue-600",children:"Listed by ResaleExpert â€¢ Verified Property"})]})]})})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Publishing to ",i.length+o.length," platforms"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:p,disabled:d||i.length===0&&o.length===0,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Publishing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(_t,{size:16}),e.jsx("span",{children:"Publish Now"})]})})]})]})})]})})},Wo=s=>({status:(s==null?void 0:s.status)||"",remarks:"",updateReason:"",effectiveDate:new Date().toISOString().slice(0,16),updatedBy:"",notifyParties:!0,priceAdjustment:!1,newPrice:s!=null&&s.budget?Number(s.budget):0}),Ky=({isOpen:s,onClose:a,property:t,onStatusUpdate:r})=>{var V,W;const{user:i}=Hs(),[n,o]=l.useState(Wo(t??null)),[m,g]=l.useState(!1),[b,d]=l.useState(!1),[v,x]=l.useState(null),[u,c]=l.useState({propertyStatus:[],roles:[],updateReasons:[]}),[f,p]=l.useState(null),N=t??{id:"",title:"",status:"",budget:0},P=(B,M)=>{var D,I;if(!B)return"";const A=(D=M.find(H=>H.value===B))==null?void 0:D.label;return A||((I=M.find(H=>H.label===B))==null?void 0:I.label)||B},w=async()=>{try{d(!0),x(null);const[B,M]=await Promise.all([Nt.getAllMasterTypes("property"),Nt.getAllMasterTypes("common")]),A=[...B,...M],L=await Promise.all(A.map(I=>Nt.getMasterValues(I.id))),D={};A.forEach((I,H)=>{const h=L[H]||[];D[I.name.toLowerCase()]=h.map(Y=>({value:String(Y.id),label:Y.value||Y.name||"Unknown"}))}),c({propertyStatus:D["property status"]||[],roles:D.role||[],updateReasons:D["update reason"]||[]})}catch(B){console.error("Failed to load master data:",B),x(`Failed to load dropdown options: ${(B==null?void 0:B.message)||String(B)}`)}finally{d(!1)}};l.useEffect(()=>{s?(w().catch(()=>{}),o(B=>({...Wo(t??null),notifyParties:B.notifyParties??!0}))):(o(Wo(t??null)),x(null))},[s,t]),l.useEffect(()=>{s&&(u.roles.length>0||u.propertyStatus.length>0)&&o(B=>{var A,L;const M={...B};if(!B.updatedBy&&u.roles.length>0)M.updatedBy=u.roles[0].label;else if(B.updatedBy){const D=(A=u.roles.find(I=>I.value===B.updatedBy))==null?void 0:A.label;D&&(M.updatedBy=D)}if(B.status){const D=P(B.status,u.propertyStatus);D&&(M.status=D)}else u.propertyStatus.length>0&&(M.status=u.propertyStatus[0].label);if(B.updateReason){const D=(L=u.updateReasons.find(I=>I.value===B.updateReason))==null?void 0:L.label;D&&(M.updateReason=D)}return M})},[s,u]);const $=B=>({Available:{color:"emerald",description:"Ready for sale",icon:bs,bgClass:"bg-gradient-to-br from-emerald-50 to-green-50 border-emerald-200",selectedClass:"border-emerald-400 bg-gradient-to-br from-emerald-100 to-green-200 shadow-lg shadow-emerald-200",gradient:"from-emerald-400 to-green-500",text600:"text-emerald-600",text800:"text-emerald-800",ring:"ring-emerald-200"},"Under Negotiation":{color:"amber",description:"Active discussions",icon:tt,bgClass:"bg-gradient-to-br from-amber-50 to-orange-50 border-amber-200",selectedClass:"border-amber-400 bg-gradient-to-br from-amber-100 to-orange-200 shadow-lg shadow-amber-200",gradient:"from-amber-400 to-orange-500",text600:"text-amber-600",text800:"text-amber-800",ring:"ring-amber-200"},"On Hold":{color:"stone",description:"Temporarily paused",icon:Nu,bgClass:"bg-gradient-to-br from-stone-50 to-stone-100 border-stone-200",selectedClass:"border-stone-400 bg-gradient-to-br from-stone-100 to-stone-200 shadow-lg shadow-stone-200",gradient:"from-stone-300 to-stone-400",text600:"text-stone-600",text800:"text-stone-800",ring:"ring-stone-200"},Finalization:{color:"purple",description:"Deal closing",icon:rt,bgClass:"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200",selectedClass:"border-purple-400 bg-gradient-to-br from-purple-100 to-pink-200 shadow-lg shadow-purple-200",gradient:"from-purple-400 to-pink-500",text600:"text-purple-600",text800:"text-purple-800",ring:"ring-purple-200"},Sold:{color:"red",description:"Successfully sold",icon:Zl,bgClass:"bg-gradient-to-br from-red-50 to-rose-50 border-red-200",selectedClass:"border-red-400 bg-gradient-to-br from-red-100 to-rose-200 shadow-lg shadow-red-200",gradient:"from-red-400 to-rose-500",text600:"text-red-600",text800:"text-red-800",ring:"ring-red-200"}})[B]||{color:"gray",description:"Status",icon:ct,bgClass:"bg-gradient-to-br from-gray-50 to-gray-50 border-gray-200",selectedClass:"border-gray-400 bg-gradient-to-br from-gray-100 to-gray-200 shadow-lg shadow-gray-200",gradient:"from-gray-400 to-gray-500",text600:"text-gray-600",text800:"text-gray-800",ring:"ring-gray-200"},y=u.propertyStatus.map(B=>{const M=$(B.label);return{...B,...M}}),k=(B,M)=>{o(A=>({...A,[B]:M}))},R=B=>M=>{var L,D,I;let A=M;switch(B){case"status":A=((L=u.propertyStatus.find(H=>H.value===M))==null?void 0:L.label)||M;break;case"updatedBy":A=((D=u.roles.find(H=>H.value===M))==null?void 0:D.label)||M;break;case"updateReason":A=((I=u.updateReasons.find(H=>H.value===M))==null?void 0:I.label)||M;break}o(H=>({...H,[B]:A}))},F=async()=>{var B,M;if(!n.updateReason){Z.error("Please select update reason");return}if(!n.remarks.trim()){Z.error("Please provide remarks for status update");return}if(n.priceAdjustment&&(n.newPrice===""||Number(n.newPrice)<=0)){Z.error("Please enter a valid new price for price adjustment");return}g(!0);try{const A={status:n.status,remarks:n.remarks,updateReason:n.updateReason,updatedBy:n.updatedBy,effectiveDate:n.effectiveDate,notifyParties:n.notifyParties,priceAdjustment:n.priceAdjustment};n.priceAdjustment&&(A.newPrice=Number(n.newPrice));const L=await As.updateStatus(String(N.id),A);L!=null&&L.success?(r&&await r(n.status,n.remarks,n),Z.success("Property status updated successfully!"),a()):Z.error((L==null?void 0:L.message)||"Failed to update status")}catch(A){console.error("Status update error:",A),Z.error(((M=(B=A==null?void 0:A.response)==null?void 0:B.data)==null?void 0:M.error)||(A==null?void 0:A.message)||"Failed to update status")}finally{g(!1)}},T=B=>{if(B==null||B==="")return"â€”";const M=Number(typeof B=="string"?B.replace(/[,â‚¹\s]|(Cr|L)/gi,""):B);return Number.isNaN(M)?"â€”":M>=1e7?`â‚¹${(M/1e7).toFixed(1)}Cr`:M>=1e5?`â‚¹${(M/1e5).toFixed(1)}L`:`â‚¹${M.toLocaleString("en-IN")}`},j=$(N.status),E=j.icon;return s?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl flex flex-col max-h-[95vh]",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-slate-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Update Property Status"}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:N.title}),N.propertyId&&e.jsxs("p",{className:"text-xs text-gray-600",children:["Property ID: ",N.propertyId]}),v&&e.jsxs("p",{className:"text-red-500 text-xs mt-1",children:["âš ï¸ ",v]})]}),e.jsx("button",{onClick:a,className:"p-1.5 rounded-lg bg-white hover:bg-gray-50 transition-all shadow-sm border border-gray-100","aria-label":"Close",type:"button",children:e.jsx(ns,{size:18,className:"text-gray-500"})})]})}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-4 relative",style:{maxHeight:"calc(90vh - 120px)"},children:[b&&e.jsx("div",{className:"absolute inset-0 bg-white/75 flex items-center justify-center z-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),e.jsx("span",{className:"ml-2 text-gray-700 font-medium",children:"Loading master data..."})]})}),v&&e.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4",children:[e.jsx("p",{children:v}),e.jsx("button",{onClick:w,className:"mt-2 text-sm text-red-600 hover:text-red-800 font-medium",type:"button",children:"Retry Loading Data"})]}),!b&&!v&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg p-3 mb-4 border border-gray-100",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-xs uppercase tracking-wide",children:"Current Status"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${j.bgClass||"bg-gray-100"}`,children:e.jsx(E,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:N.status}),e.jsx("div",{className:"text-xs text-gray-600",children:j.description})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-[10px] sm:text-xs uppercase tracking-wide",children:"Select New Status"}),e.jsx("div",{className:"grid gap-2 sm:gap-3 grid-cols-[repeat(auto-fit,minmax(110px,1fr))]",children:y.length>0?y.map(B=>{const M=B.icon,A=n.status===B.value,L=f===B.value;return e.jsxs("button",{onClick:()=>R("status")(B.value),onMouseDown:()=>p(B.value),onMouseUp:()=>p(null),onMouseLeave:()=>p(null),type:"button",title:B.label,"aria-pressed":A,className:["relative overflow-hidden rounded-lg border text-left","transition-all duration-150 ease-out select-none","p-2 sm:p-2.5","min-h-[68px] sm:min-h-[76px]","touch-manipulation",A?`${B.selectedClass} scale-[1.02]`:`${B.bgClass} hover:shadow-md`,"hover:scale-[1.01] active:scale-95 active:translate-y-[1px]","focus:outline-none focus:ring-2",B.ring,L?"ring-2 ring-offset-1":""].join(" "),children:[e.jsx("div",{className:`pointer-events-none absolute inset-0 transition-opacity duration-150 ${L?"bg-white/30":"bg-transparent"}`}),e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${B.gradient} ${A?"opacity-20":"opacity-10"} transition-opacity duration-300`}),e.jsx("span",{className:`pointer-events-none absolute inset-0 rounded-lg ${L?"animate-ping bg-white/20":""}`}),e.jsxs("div",{className:"relative flex flex-col items-center gap-1",children:[e.jsx("div",{className:"p-1 rounded-md bg-white/80 shadow-sm",children:e.jsx(M,{size:12,className:`${B.text600} sm:w-4 sm:h-4`})}),e.jsxs("div",{className:"w-full text-center",children:[e.jsx("div",{className:`font-semibold truncate ${B.text800} text-[10px] sm:text-[11px] leading-4`,children:B.label}),e.jsx("div",{className:`truncate ${B.text600} text-[9px] sm:text-[10px] leading-3`,children:B.description})]})]})]},B.value)}):e.jsx("div",{className:"col-span-full text-center py-2 text-gray-500 text-xs",children:"No status options available"})}),e.jsx("style",{children:`
    @media (prefers-reduced-motion: reduce) {
      .hover\\:scale-\\[1\\.01\\], .scale-\\[1\\.02\\], .active\\:translate-y-\\[1px\\] { transform: none !important; }
      .animate-ping { animation: none !important; }
    }
  `})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Update Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:((V=u.updateReasons.find(B=>B.label===n.updateReason))==null?void 0:V.value)||"",onChange:B=>R("updateReason")(B.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-transparent bg-white transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Select reason"}),u.updateReasons.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.jsx(Ts,{className:"inline mr-1",size:14}),"Effective Date & Time"]}),e.jsx("input",{type:"datetime-local",value:n.effectiveDate,onChange:B=>k("effectiveDate",B.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-transparent transition-all"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Remarks ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:n.remarks,onChange:B=>k("remarks",B.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-transparent resize-none transition-all",rows:2,placeholder:"Provide detailed remarks...",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.jsx(Ms,{className:"inline mr-1",size:14}),"Updated By ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:((W=u.roles.find(B=>B.label===n.updatedBy))==null?void 0:W.value)||"",onChange:B=>R("updatedBy")(B.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-transparent bg-white transition-all",required:!0,children:[e.jsx("option",{value:"",children:"Select role"}),u.roles.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n.priceAdjustment,onChange:B=>k("priceAdjustment",B.target.checked),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-xs font-medium text-gray-700",children:[e.jsx(vu,{className:"inline mr-1 text-green-400",size:18}),"Adjust Price"]})]})})]}),n.priceAdjustment&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-2 border border-blue-100",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"New Price (â‚¹)"}),e.jsx("input",{type:"number",value:n.newPrice,onChange:B=>k("newPrice",B.target.value===""?"":Number(B.target.value)),className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded-lg focus:ring-1 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter new price"}),e.jsxs("div",{className:"mt-1 text-xs text-gray-600 bg-white rounded p-1",children:[e.jsx("strong",{children:"Current:"})," ",T(N.budget)," â†’ ",e.jsx("strong",{children:"New:"})," ",T(n.newPrice)]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-2 border border-gray-100",children:e.jsxs("label",{className:"flex items-start space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n.notifyParties,onChange:B=>k("notifyParties",B.target.checked),className:"w-4 h-4 mt-0.5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Notify all interested parties"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Seller, buyers, and team will be notified"})]})]})})]})]})]}),e.jsx("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50/80 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center space-x-1",children:[e.jsx(Ls,{size:12}),e.jsx("span",{children:"Recorded in timeline"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-all shadow-sm",type:"button",children:"Cancel"}),e.jsxs("button",{onClick:F,disabled:m||!n.updateReason||!n.remarks.trim()||!n.updatedBy||b,className:"flex items-center space-x-1 px-4 py-2 text-sm bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-blue-500/30",type:"button",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:m?"Updating...":"Update Status"})]})]})]})})]})}):null},tg=({isOpen:s,onClose:a,property:t})=>{const[r,i]=l.useState(""),[n,o]=l.useState([]),[m,g]=l.useState({budgetRange:10,locationRadius:5,propertyType:!0,amenities:!0});if(!s||!t)return null;const b=[{id:1,name:"Amit Patel",phone:"+91 98765 11111",email:"amit.patel@email.com",budget:{min:22e6,max:26e6},preferredLocation:["Andheri West","Bandra West","Juhu"],propertyType:"Apartment",unitType:"3BHK",requirements:["Ready to move","Good parking","Near metro"],matchScore:95,status:"hot_lead",lastContact:"2025-01-10",source:"Website",visitHistory:2,feedback:"Very interested, looking for immediate purchase"},{id:2,name:"Priya Shah",phone:"+91 98765 22222",email:"priya.shah@email.com",budget:{min:2e7,max:24e6},preferredLocation:["Andheri West","Versova","Oshiwara"],propertyType:"Apartment",unitType:"2BHK",requirements:["Good amenities","Security","Parking"],matchScore:87,status:"warm_lead",lastContact:"2025-01-08",source:"Referral",visitHistory:1,feedback:"Interested but needs family approval"},{id:3,name:"Rohit Gupta",phone:"+91 98765 33333",email:"rohit.gupta@email.com",budget:{min:24e6,max:28e6},preferredLocation:["Andheri West","Malad West","Goregaon West"],propertyType:"Apartment",unitType:"3BHK",requirements:["Investment purpose","Good rental yield","Branded builder"],matchScore:92,status:"hot_lead",lastContact:"2025-01-12",source:"Social Media",visitHistory:0,feedback:"Looking for investment property"},{id:4,name:"Neha Sharma",phone:"+91 98765 44444",email:"neha.sharma@email.com",budget:{min:18e6,max:22e6},preferredLocation:["Andheri East","Powai","Vikhroli"],propertyType:"Apartment",unitType:"2BHK",requirements:["First home","Good connectivity","Family-friendly"],matchScore:78,status:"warm_lead",lastContact:"2025-01-09",source:"Advertisement",visitHistory:1,feedback:"Budget constraints, looking for better deals"}],d=b.filter(w=>w.name.toLowerCase().includes(r.toLowerCase())||w.phone.includes(r)||w.email.toLowerCase().includes(r.toLowerCase())||w.requirements.some($=>$.toLowerCase().includes(r.toLowerCase()))).sort((w,$)=>$.matchScore-w.matchScore),v=w=>{o($=>$.includes(w)?$.filter(y=>y!==w):[...$,w])},x=()=>{n.length===d.length?o([]):o(d.map(w=>w.id))},u=()=>{if(n.length===0){alert("Please select buyers to send property details");return}b.filter(w=>n.includes(w.id)),alert(`Property details sent to ${n.length} buyers via WhatsApp and Email`),o([])},c=w=>w>=90?"text-green-600 bg-green-100":w>=80?"text-blue-600 bg-blue-100":w>=70?"text-orange-600 bg-orange-100":"text-red-600 bg-red-100",f=w=>{const $={hot_lead:{bg:"bg-red-100",text:"text-red-700",label:"Hot Lead",icon:"ðŸ”¥"},warm_lead:{bg:"bg-orange-100",text:"text-orange-700",label:"Warm Lead",icon:"âš¡"},cold_lead:{bg:"bg-blue-100",text:"text-blue-700",label:"Cold Lead",icon:"â„ï¸"}},y=$[w]||$.cold_lead;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${y.bg} ${y.text}`,children:[y.icon," ",y.label]})},p=w=>w>=1e7?`â‚¹${(w/1e7).toFixed(1)}Cr`:w>=1e5?`â‚¹${(w/1e5).toFixed(1)}L`:`â‚¹${w.toLocaleString("en-IN")}`,N=w=>{const $=`Hi ${w.name}, I have a perfect property match for you!

ðŸ  ${t.title}
ðŸ“ ${t.location}, ${t.city}
ðŸ’° ${p(t.budget)}
ðŸ¢ ${t.unitType} â€¢ ${t.carpetArea} sq ft

Would you like to schedule a visit?

Best regards,
ResaleExpert Team`,y=`https://wa.me/${w.phone.replace(/\D/g,"")}?text=${encodeURIComponent($)}`;window.open(y,"_blank")},P=w=>{var R;const $=`Perfect Property Match - ${t.title}`,y=`Dear ${w.name},

We have found a perfect property match based on your requirements:

Property: ${t.title}
Location: ${t.location}, ${t.city}
Price: ${p(t.budget)}
Type: ${t.unitType}
Area: ${t.carpetArea} sq ft

This property matches ${(R=b.find(F=>F.id===w.id))==null?void 0:R.matchScore}% of your requirements.

Would you like to schedule a visit?

Best regards,
ResaleExpert Team`,k=`mailto:${w.email}?subject=${encodeURIComponent($)}&body=${encodeURIComponent(y)}`;window.open(k,"_blank")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(rt,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Buyer Matching"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.title," - Find perfect buyers"]})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:[e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600",children:"Property"}),e.jsx("div",{className:"font-bold text-blue-900",children:t.title})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600",children:"Location"}),e.jsxs("div",{className:"font-bold text-blue-900",children:[t.location,", ",t.city]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600",children:"Type"}),e.jsxs("div",{className:"font-bold text-blue-900",children:[t.unitType," â€¢ ",t.carpetArea," sq ft"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600",children:"Price"}),e.jsx("div",{className:"font-bold text-blue-900",children:p(t.budget)})]})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search buyers...",value:r,onChange:w=>i(w.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(Na,{size:16}),e.jsx("span",{children:"Filters"})]})]}),n.length>0&&e.jsxs("button",{onClick:u,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Dt,{size:16}),e.jsxs("span",{children:["Send to ",n.length," Buyers"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-green-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Perfect Match"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:d.filter(w=>w.matchScore>=90).length})]}),e.jsx(rt,{className:"text-green-600",size:24})]})}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Good Match"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:d.filter(w=>w.matchScore>=80&&w.matchScore<90).length})]}),e.jsx(Xs,{className:"text-blue-600",size:24})]})}),e.jsx("div",{className:"bg-orange-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Potential Match"}),e.jsx("p",{className:"text-2xl font-bold text-orange-900",children:d.filter(w=>w.matchScore>=70&&w.matchScore<80).length})]}),e.jsx(Ns,{className:"text-orange-600",size:24})]})}),e.jsx("div",{className:"bg-purple-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Total Buyers"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:d.length})]}),e.jsx(Wr,{className:"text-purple-600",size:24})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Matched Buyers"}),e.jsx("button",{onClick:x,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:n.length===d.length?"Deselect All":"Select All"})]}),d.map(w=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("input",{type:"checkbox",checked:n.includes(w.id),onChange:()=>v(w.id),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-lg",children:w.name}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[f(w.status),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${c(w.matchScore)}`,children:[w.matchScore,"% Match"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>N(w),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"WhatsApp",children:e.jsx(tt,{size:16})}),e.jsx("button",{onClick:()=>P(w),className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",title:"Email",children:e.jsx(Ds,{size:16})}),e.jsx("button",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200 transition-colors",children:e.jsx(Cs,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Budget Range:"}),e.jsxs("span",{className:"font-medium ml-2 text-green-600",children:[p(w.budget.min)," - ",p(w.budget.max)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Preferred Units"}),e.jsxs("span",{className:"font-medium ml-2",children:[w.unitType," ",w.propertyType]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Contact:"}),e.jsx("span",{className:"font-medium ml-2",children:w.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Source:"}),e.jsx("span",{className:"font-medium ml-2",children:w.source})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Preferred Locations:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.preferredLocation.map(($,y)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:$},y))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Requirements:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.requirements.map(($,y)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs",children:$},y))})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Last Contact: ",w.lastContact]}),e.jsxs("span",{children:["Visits: ",w.visitHistory]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-medium text-gray-900",children:w.feedback})})]})]})]})},w.id))]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[d.length," buyers found â€¢ ",n.length," selected"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),n.length>0&&e.jsxs("button",{onClick:u,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Dt,{size:16}),e.jsxs("span",{children:["Send to ",n.length," Buyers"]})]})]})]})})]})})};function Jy({formData:s,setFormData:a,endpoint:t,defaults:r}){const[i,n]=l.useState(!1),[o,m]=l.useState(null),g=(r==null?void 0:r.tone)??"professional",b=(r==null?void 0:r.lang)??"English",d=Number.isFinite(r==null?void 0:r.words)?Number(r.words):120;async function v(){var x,u;if(!i){m(null),n(!0);try{const c={propertyType:s.propertyType||"",propertySubtype:s.propertySubtype||"",unitType:s.unitType||"",furnishing:s.furnishing||"",city:s.city||"",location:s.location||"",budget:s.budget||"",parkingType:s.parkingType||"",carpetArea:s.carpetArea||"",floor:s.floor||""};if(!c.propertyType||!c.city){m("Please select Property Type and City first.");return}let f="";if(t){const p=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formData:c,tone:g,lang:b,words:d})}),N=await p.text();if(!p.ok)try{const w=JSON.parse(N);throw new Error((w==null?void 0:w.error)||(w==null?void 0:w.message)||`Request failed (${p.status})`)}catch{throw new Error(N||`Request failed (${p.status})`)}let P;try{P=JSON.parse(N)}catch{throw new Error("Invalid JSON from server.")}f=((P==null?void 0:P.text)??(P==null?void 0:P.description)??"").toString()}else{const p=await As.generateDescription({formData:c,tone:g,lang:b,words:d});f=(p==null?void 0:p.text)??""}if(!f)throw new Error("Server did not return a description.");a(p=>({...p,description:f}))}catch(c){const f=((u=(x=c==null?void 0:c.response)==null?void 0:x.data)==null?void 0:u.error)||(c==null?void 0:c.message)||"AI description generate nahi ho paya. Please try again.";m(f)}finally{n(!1)}}}return e.jsxs("div",{className:"space-y-2 p-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Description/Notes"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:s.description||"",onChange:x=>a(u=>({...u,description:x.target.value})),className:"w-full px-3 py-3 pr-32 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[160px]",placeholder:"Additional property details, special features, etc."}),e.jsx("button",{type:"button",onClick:v,disabled:i,className:"absolute bottom-2 right-2 inline-flex items-center gap-2 rounded-md border border-gray-200 bg-white/90 px-3 py-1.5 text-sm font-medium shadow-sm hover:bg-white disabled:opacity-50",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Kr,{className:"h-4 w-4 animate-spin"}),"Generatingâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx(Al,{className:"h-4 w-4"}),"Generate"]})})]}),o&&e.jsx("p",{className:"text-xs text-red-600",children:o}),e.jsx("p",{className:"text-[11px] text-gray-500",children:"AI uses: Property Type, Subtype, Unit Type, Furnishing, City, Location, budget, Carpet Area, and Floor."})]})}const ag=1e7,Qy=1e5;function Ho(s){const a=(s||"").trim().toLowerCase();if(!a)return 0;const t=a.replace(/â‚¹/g,"").replace(/\s+/g,""),r=t.replace(/,/g,"");if(/^\d+$/.test(r))return parseInt(r,10)||0;const i=t.match(/^([\d,.]+)l$/);if(i)return Math.round(parseFloat(i[1].replace(/,/g,""))*Qy)||0;const n=t.match(/^([\d,.]+)(cr|c)$/);if(n)return Math.round(parseFloat(n[1].replace(/,/g,""))*ag)||0;const o=parseFloat(r);return Number.isNaN(o)?0:Math.round(o)}function Zy(s){return!s||s<=0?.01:s/ag}const Lm=({possessionMonth:s,possessionYear:a,onMonthChange:t,onYearChange:r,title:i})=>{const n=new Date,o=n.getFullYear(),m=n.getMonth()+1,g=l.useMemo(()=>["January","February","March","April","May","June","July","August","September","October","November","December"],[]),b=parseInt(a)||o,d=parseInt(s)||m;l.useEffect(()=>{b===o&&d>m&&t(m.toString())},[b,d,m,o,t]);const v=Array.from({length:40},(u,c)=>{const f=(o-c).toString();return{value:f,label:f}}),x=g.map((u,c)=>{const f=c+1,p=b===o&&f>m;return{value:f.toString(),label:u,disabled:p}});return e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:i}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Jt,{placeholder:"Year",options:v,value:a,onChange:r,className:"w-full"})}),e.jsx("div",{className:"flex-1",children:e.jsx(Jt,{placeholder:"Month",options:x.filter(u=>!u.disabled),value:s,onChange:t,className:"w-full"})})]}),s&&a&&e.jsxs("div",{className:"mt-1 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:["Selected: ",g[parseInt(s)-1]," ",a]})]})},Dm=({options:s,selectedValues:a,onToggle:t,label:r,placeholder:i="Select options..."})=>{const[n,o]=l.useState(!1),[m,g]=l.useState(""),b=l.useRef(null),d=l.useRef(null),v=l.useMemo(()=>s.filter(u=>u.label.toLowerCase().includes(m.toLowerCase())),[s,m]),x=l.useMemo(()=>{if(a.length===0)return i;if(a.length===1){const u=s.find(c=>c.value===a[0]);return(u==null?void 0:u.label)||a[0]}return`${a.length} items selected`},[a,s,i]);return l.useEffect(()=>{const u=c=>{d.current&&!d.current.contains(c.target)&&b.current&&!b.current.contains(c.target)&&(o(!1),g(""))};return n&&document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[n]),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:r}),e.jsxs("button",{ref:b,type:"button",onClick:()=>o(!n),className:"w-full border border-gray-300 p-2 rounded text-left bg-white flex justify-between items-center text-xs min-h-[38px]",children:[e.jsx("span",{className:a.length===0?"text-gray-500":"text-gray-900",children:x}),e.jsx("span",{className:"text-gray-500",children:"â–¼"})]}),n&&b.current&&e.jsxs("div",{ref:d,className:"bg-white border rounded shadow-lg max-h-64 overflow-hidden",style:{position:"fixed",zIndex:9999,top:b.current.getBoundingClientRect().bottom+window.scrollY+4,left:b.current.getBoundingClientRect().left+window.scrollX,width:b.current.getBoundingClientRect().width},children:[e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{type:"text",placeholder:"Search...",value:m,onChange:u=>g(u.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500",autoFocus:!0})}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:v.length===0?e.jsx("p",{className:"text-xs text-gray-500 p-2",children:"No options found"}):v.map(u=>e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.includes(u.value),onChange:()=>t(u.value),className:"mr-2 h-3 w-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:u.label})]},u.value))}),a.length>0&&e.jsxs("div",{className:"p-2 bg-gray-50 border-t text-xs text-blue-600",children:["Selected: ",a.length," item(s)"]})]})]})},Rm=({preview:s,onRemove:a,className:t=""})=>{var r,i,n;return e.jsx("div",{className:`relative group ${t}`,children:s.type==="image"?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.url,alt:s.name||((r=s.file)==null?void 0:r.name)||"Image",className:"w-full h-20 object-cover rounded-lg border border-gray-300"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-all rounded-lg flex items-center justify-center",children:e.jsx("button",{onClick:a,className:"opacity-0 group-hover:opacity-100 bg-red-500 text-white rounded-full p-1 transition-opacity hover:bg-red-600",title:"Remove",children:e.jsx(ns,{size:14})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 rounded-b-lg truncate",children:s.name||((i=s.file)==null?void 0:i.name)||"Image"})]}):e.jsxs("div",{className:"relative bg-gray-100 border border-gray-300 rounded-lg p-2 h-20 flex flex-col items-center justify-center",children:[e.jsx(ws,{className:"text-blue-500 mb-1",size:20}),e.jsx("span",{className:"text-[10px] text-gray-700 text-center truncate w-full",children:s.name||((n=s.file)==null?void 0:n.name)||"Document"}),e.jsx("button",{onClick:a,className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",title:"Remove",children:e.jsx(ns,{size:10})})]})})},Jt=s=>e.jsx(da,{...s}),no=({isOpen:s,onClose:a,onSubmit:t,mode:r="create",propertyId:i,initialData:n=null})=>{const o=new Date,m=o.getFullYear(),g=o.getMonth()+1,b=(U=[])=>[...U].sort((X,re)=>{const fe=parseInt(X.label||X.value||"0",10),G=parseInt(re.label||re.value||"0",10);return fe-G}),[d,v]=l.useState(()=>({seller:"",propertyType:"",propertySubtype:"",unitType:"",wing:"",unitNo:"",furnishing:"",parkingType:"",parkingQty:"",city:"",location:"",society:"",floor:"",totalFloors:"",carpetArea:"",builtupArea:"",budget:"",address:"",status:"",leadSource:"",possessionMonth:String(g),possessionYear:String(m),purchaseMonth:String(g),purchaseYear:String(m),sellingRights:"Standard",amenities:[],furnishingItems:[],description:"",nearby_places:[],ownershipDoc:null,photos:[],bedrooms:"",bathrooms:"",balcony:"",facing:"",priceType:"Fixed",finalPrice:""})),[x,u]=l.useState(null),[c,f]=l.useState([]),[p,N]=l.useState({name:"",distance:"",unit:"",type:""}),[P,w]=l.useState({}),[$,y]=l.useState(!1),[k,R]=l.useState(null),[F,T]=l.useState({}),j=(U=[],X)=>{if(!X||!U||!Array.isArray(U))return"";const re=U.find(me=>String(me.value)===String(X));if(re)return re.label||"";const fe=U.find(me=>String(me.value).toLowerCase()===String(X).toLowerCase());if(fe)return fe.label||"";const G=U.find(me=>String(me.label).toLowerCase()===String(X).toLowerCase());return G&&G.label||""},E=U=>{const X=URL.createObjectURL(U),re=U.type.startsWith("image/")?"image":"document";return{file:U,url:X,type:re,isExisting:!1}},V=(U,X)=>{const re=/\.(jpg|jpeg|png|gif|webp)$/i.test(U)?"image":"document";return{url:U,type:re,isExisting:!0,name:X}},W=U=>{!U.isExisting&&U.url&&URL.revokeObjectURL(U.url)},B=()=>{x&&!x.isExisting&&W(x),c.forEach(U=>{U.isExisting||W(U)})},M=async()=>{try{const U=await Gt(["lead","common","property"]);T(U)}catch(U){R(`Failed to load dropdown options: ${U instanceof Error?U.message:String(U)}`)}},A=async()=>{try{const U=As;if(typeof U.list=="function"){await U.list();return}if(typeof U.listProperties=="function"){await U.listProperties();return}if(typeof U.getAll=="function"){await U.getAll();return}}catch(U){console.warn("loadProperties: propertiesAPI listing call failed",U)}try{window.dispatchEvent(new CustomEvent("properties:reload"))}catch(U){console.warn("loadProperties: failed to dispatch properties:reload event",U)}};l.useEffect(()=>{if(s){if(R(null),w({}),M(),r==="edit"&&n){const U={seller:n.seller||"",propertyType:n.propertyType||"",propertySubtype:n.propertySubtype||"",unitType:n.unitType||"",wing:n.wing||"",unitNo:n.unitNo||"",furnishing:n.furnishing||"",parkingType:n.parkingType||"",parkingQty:n.parkingQty||"",city:n.city||"",location:n.location||"",society:n.society||"",floor:n.floor||"",totalFloors:n.totalFloors||"",carpetArea:n.carpetArea||"",builtupArea:n.builtupArea||"",budget:n.budget||"",address:n.address||"",status:n.status||"",leadSource:n.leadSource||"",possessionMonth:n.possessionMonth||String(g),possessionYear:n.possessionYear||String(m),purchaseMonth:n.purchaseMonth||String(g),purchaseYear:n.purchaseYear||String(m),sellingRights:n.sellingRights||"Standard",amenities:n.amenities||[],furnishingItems:n.furnishingItems||[],description:n.description||"",nearby_places:n.nearby_places||[],ownershipDoc:null,photos:[],ownershipDocUrl:n.existingOwnershipDocUrl,photoUrls:(n.existingPhotos||[]).map(re=>re.url),bedrooms:n.bedrooms||"",bathrooms:n.bathrooms||"",balcony:n.balcony||"",facing:n.facing||"",priceType:n.priceType||"Fixed",finalPrice:n.finalPrice||""};v(U),n.existingOwnershipDocUrl?u(V(n.existingOwnershipDocUrl,n.existingOwnershipDocName||"Ownership Document")):u(null);const X=(n.existingPhotos||[]).map(re=>V(re.url,re.name||"Photo"));f(X)}else v(U=>({...U,possessionMonth:String(g),possessionYear:String(m),purchaseMonth:String(g),purchaseYear:String(m),sellingRights:"Standard"})),u(null),f([]);return()=>{B(),u(null),f([])}}},[s,r,n]);const L=()=>{const U=[];if(d.wing.trim()&&U.push(`Wing ${d.wing.trim()}`),d.unitNo.trim()&&U.push(`Unit No ${d.unitNo.trim()}`),d.society&&F.society){const X=j(F.society,d.society);X&&U.push(X)}if(d.floor&&F.floor){const X=j(F.floor,d.floor);X&&U.push(X.toLowerCase().includes("floor")?X:`${X} Floor`)}if(d.location&&F.location){const X=j(F.location,d.location);X&&U.push(X)}if(d.city&&F.city){const X=j(F.city,d.city);X&&U.push(X)}return U.join(", ")};l.useEffect(()=>{if(!s||r!=="create"||Object.keys(F).length===0)return;const U=L();U&&v(X=>({...X,address:U}))},[s,r,d.wing,d.unitNo,d.society,d.floor,d.location,d.city,F]),l.useEffect(()=>{},[s,n,F]);const D=U=>X=>{v(re=>({...re,[U]:X})),P[U]&&w(re=>({...re,[U]:""}))},I=(U,X)=>{v(re=>({...re,[U]:X})),P[U]&&w(re=>({...re,[U]:""}))},H=U=>{v(X=>({...X,amenities:X.amenities.includes(U)?X.amenities.filter(re=>re!==U):[...X.amenities,U]}))},h=U=>{v(X=>({...X,furnishingItems:X.furnishingItems.includes(U)?X.furnishingItems.filter(re=>re!==U):[...X.furnishingItems,U]}))},Y=(U,X)=>{N(re=>({...re,[U]:X}))},K=()=>{const{name:U,distance:X,unit:re,type:fe}=p;if(!U||!X||!re||!fe)return;const G=j(F["place name"]||[],U)||U,me=j(F["place type"]||[],fe)||fe;v(oe=>({...oe,nearby_places:[...oe.nearby_places,{name:G,distance:X,unit:re,type:me}]})),N({name:"",distance:"",unit:"",type:""})},q=U=>{v(X=>({...X,nearby_places:X.nearby_places.filter((re,fe)=>fe!==U)}))},ne=U=>{if(x&&!x.isExisting&&W(x),U){const X=E(U);u(X),v(re=>({...re,ownershipDoc:U}))}else u(null),v(X=>({...X,ownershipDoc:null}))},le=U=>{const X=c.filter(fe=>fe.isExisting),re=U.map(E);f([...X,...re]),v(fe=>({...fe,photos:[...fe.photos||[],...U]}))},S=()=>{x&&!x.isExisting&&W(x),u(null),v(U=>({...U,ownershipDoc:null}))},C=U=>{const X=[...c],re=X.splice(U,1)[0];re&&!re.isExisting&&W(re),f(X);const fe=X.filter(G=>!G.isExisting&&G.file).map(G=>G.file);v(G=>({...G,photos:fe}))},J=()=>{const U={};return d.propertyType||(U.propertyType="Property type is required"),d.propertySubtype||(U.propertySubtype="Property subtype is required"),d.unitType||(U.unitType="Unit type is required"),d.city||(U.city="City is required"),d.location||(U.location="Location is required"),d.society||(U.society="Society is required"),d.carpetArea||(U.carpetArea="Carpet area is required"),d.budget||(U.budget="Budget is required"),w(U),Object.keys(U).length===0},ue=()=>{const U=new FormData;["seller","propertyType","propertySubtype","unitType","wing","unitNo","furnishing","parkingType","parkingQty","city","location","society","floor","totalFloors","carpetArea","builtupArea","budget","address","status","leadSource","possessionMonth","possessionYear","purchaseMonth","purchaseYear","sellingRights","description","bedrooms","bathrooms","facing","balcony","priceType","finalPrice"].forEach(me=>U.append(me,String(d[me]??"")));const re=F.society||[],G=j(re,d.society)||d.society||"";if(U.append("society_name",G),U.append("amenities",JSON.stringify(d.amenities||[])),U.append("furnishingItems",JSON.stringify(d.furnishingItems||[])),U.append("nearby_places",JSON.stringify(d.nearby_places||[])),r==="edit"){const me=c.filter(oe=>oe.isExisting).map(oe=>oe.url);U.append("existingPhotoUrls",JSON.stringify(me)),x!=null&&x.isExisting&&U.append("existingOwnershipDocUrl",x.url)}d.ownershipDoc&&U.append("ownershipDoc",d.ownershipDoc,d.ownershipDoc.name),(d.photos||[]).forEach(me=>me&&U.append("photos",me,me.name));for(let[me,oe]of U.entries());return U};function Q(U,X){var re,fe;return{seller:U.seller?{name:U.seller}:void 0,type:U.propertyType,subtype:U.propertySubtype,unitType:U.unitType,wing:U.wing,unitNo:U.unitNo,furnishing:U.furnishing,furnishingItems:U.furnishingItems,parkingType:U.parkingType,parkingQty:U.parkingQty,city:U.city,location:U.location,society:U.society,floor:U.floor,totalFloors:U.totalFloors,carpetArea:U.carpetArea,builtupArea:U.builtupArea,budget:U.budget,address:U.address,status:U.status,leadSource:U.leadSource,possessionMonth:U.possessionMonth,possessionYear:U.possessionYear,purchaseMonth:U.purchaseMonth,purchaseYear:U.purchaseYear,selling_rights:U.sellingRights,amenities:U.amenities,nearby_places:U.nearby_places,description:U.description,bedrooms:U.bedrooms,bathrooms:U.bathrooms,balcony:U.balcony,facing:U.facing,priceType:U.priceType,finalPrice:U.finalPrice,ownershipDocUrl:(re=X.ownership)==null?void 0:re.url,ownershipDocName:(fe=X.ownership)==null?void 0:fe.name,photos:X.photos.map(G=>G.url),updated_at:new Date().toISOString()}}const he=async()=>{var U,X;if(J())try{y(!0),R(null),console.log("=== FORM SUBMISSION DEBUG ==="),console.log("FORM DATA:",d),console.log("MODE:",r),console.log("PROPERTY ID:",i);const re=ue();console.log("=== FORM DATA PAYLOAD ===");for(let[me,oe]of re.entries())console.log(`${me}:`,oe);let fe;r==="edit"&&i?(console.log("ðŸ”„ UPDATE PROPERTY API CALL"),fe=await As.updateProperty(String(i),re),console.log("âœ… UPDATE RESPONSE:",fe)):(console.log("ðŸ†• CREATE PROPERTY API CALL"),fe=await As.createProperty(re),console.log("âœ… CREATE RESPONSE:",fe)),await A();const G=Q(d,{ownership:x,photos:c});t(G),window.dispatchEvent(new CustomEvent("overview:refresh",{detail:{id:i}})),Z.success(`Property ${r==="edit"?"updated":"created"} successfully!`),a==null||a()}catch(re){console.error("âŒ SUBMISSION ERROR:",re);const fe=((X=(U=re==null?void 0:re.response)==null?void 0:U.data)==null?void 0:X.message)||(re==null?void 0:re.message)||`Failed to ${r==="edit"?"update":"create"} property`;R(fe),Z.error(fe)}finally{y(!1)}},se=U=>F[U]||F[U.toLowerCase()]||[],ge=r==="edit"?"Edit Property":"Add New Property",ee=r==="edit"?"Update Property":"Add Property",de=r==="edit"?ft:fs;return e.jsx(ma,{isOpen:s,onClose:a,title:ge,width:"max-w-[95vw] md:max-w-4xl lg:max-w-5xl",children:e.jsxs("div",{className:"space-y-4 relative",style:{minHeight:"320px"},children:[$&&e.jsxs("div",{className:"absolute inset-0 bg-white/60 flex items-center justify-center z-10",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2",children:r==="edit"?"Updating...":"Saving..."})]}),k&&e.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-3",children:k}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Seller (optional)"}),e.jsx("input",{type:"text",placeholder:"Enter Seller",value:d.seller||"",onChange:U=>I("seller",U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Type*"}),e.jsx(Jt,{placeholder:"Select Property Type",options:se("property type"),value:d.propertyType,onChange:D("propertyType"),className:"w-full"}),P.propertyType&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.propertyType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Subtype*"}),e.jsx(Jt,{placeholder:"Select Property Subtype",options:se("property subtype"),value:d.propertySubtype,onChange:D("propertySubtype"),className:"w-full"}),P.propertySubtype&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.propertySubtype})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit Type*"}),e.jsx(Jt,{placeholder:"Select Unit Type",options:se("unit type"),value:d.unitType,onChange:D("unitType"),className:"w-full"}),P.unitType&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.unitType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Wing"}),e.jsx("input",{type:"text",placeholder:"Wing name/number",value:d.wing,onChange:U=>I("wing",U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit No"}),e.jsx("input",{type:"text",placeholder:"Unit/Flat no",value:d.unitNo,onChange:U=>I("unitNo",U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Furnishing"}),e.jsx(Jt,{placeholder:"Select Furnishing",options:se("furnishing"),value:d.furnishing,onChange:D("furnishing"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Parking Type"}),e.jsx(Jt,{placeholder:"Select Parking Type",options:se("parking type"),value:d.parkingType,onChange:D("parkingType"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bedrooms"}),e.jsx(Jt,{placeholder:"Select Bedrooms",options:se("bedrooms"),value:d.bedrooms,onChange:D("bedrooms"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bathrooms"}),e.jsx(Jt,{placeholder:"Select Bathrooms",options:se("bathrooms"),value:d.bathrooms,onChange:D("bathrooms"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Facing"}),e.jsx(Jt,{placeholder:"Select Facing",options:se("facing"),value:d.facing,onChange:D("facing"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Balcony"}),e.jsx(Jt,{placeholder:"Select Balcony",options:se("balcony"),value:d.balcony,onChange:D("balcony"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Parking Qty"}),e.jsx(Jt,{placeholder:"Select Parking Quantity",options:se("parking qty"),value:d.parkingQty,onChange:D("parkingQty"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"City*"}),e.jsx(Jt,{placeholder:"Select City",options:se("city"),value:d.city,onChange:D("city"),className:"w-full",searchable:!0}),P.city&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.city})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Location*"}),e.jsx(Jt,{placeholder:"Select Location",options:se("location"),value:d.location,onChange:D("location"),className:"w-full",searchable:!0}),P.location&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.location})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Society Name*"}),e.jsx(Jt,{placeholder:"Select Society",options:se("society"),value:d.society,onChange:D("society"),className:"w-full",searchable:!0}),P.society&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.society})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Total Floors"}),e.jsx(Jt,{placeholder:"Select Total Floors",options:b(se("total floors")),value:d.totalFloors,onChange:D("totalFloors"),className:"w-full",searchable:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Floor"}),e.jsx(Jt,{placeholder:"Select Floor",options:b(se("floor")),value:d.floor,onChange:D("floor"),className:"w-full",searchable:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Carpet Area (sq.ft)*"}),e.jsx("input",{type:"text",placeholder:"Enter carpet area",value:d.carpetArea,onChange:U=>{const X=U.target.value;(/^\d*\.?\d*$/.test(X)||X==="")&&I("carpetArea",X)},className:`w-full px-3 py-2 border rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent ${P.carpetArea?"border-red-500":"border-gray-300"}`}),P.carpetArea&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.carpetArea})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Builtup Area (sq.ft) (optional)"}),e.jsx("input",{type:"text",placeholder:"Enter builtup area",value:d.builtupArea,onChange:U=>{const X=U.target.value;(/^\d*\.?\d*$/.test(X)||X==="")&&I("builtupArea",X)},className:"w-full px-3 py-2 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Status"}),e.jsx(Jt,{placeholder:"Select Status",options:se("property status"),value:d.status,onChange:D("status"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Source"}),e.jsx(Jt,{placeholder:"Select Lead Source",options:se("lead source"),value:d.leadSource,onChange:D("leadSource"),className:"w-full"})]}),e.jsx("div",{children:e.jsx(Lm,{title:"Purchase Month & Year",possessionMonth:d.purchaseMonth,possessionYear:d.purchaseYear,onMonthChange:U=>I("purchaseMonth",U),onYearChange:U=>I("purchaseYear",U)})}),e.jsx("div",{children:e.jsx(Lm,{title:"Possession Month & Year",possessionMonth:d.possessionMonth,possessionYear:d.possessionYear,onMonthChange:U=>I("possessionMonth",U),onYearChange:U=>I("possessionYear",U)})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Selling Rights"}),e.jsx(Jt,{placeholder:"Select Selling Rights",options:se("selling rights"),value:d.sellingRights,onChange:D("sellingRights"),className:"w-full"})]}),e.jsxs("div",{className:"md:col-span-3 lg:col-span-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("label",{className:"block text-xs font-semibold text-gray-800 bt-8",children:"Sell Price (â‚¹)*"})}),e.jsx(ld,{initialMax:Zy(Ho(d.budget)),max:10,onChange:({max:U})=>{const X=Math.round(U*1e7);I("budget",String(X)),d.priceType==="Negotiable"&&I("finalPrice",String(X))},className:"p-0 mt-1"}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("label",{className:"inline-flex items-center gap-1.5 text-xs font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",name:"priceType",className:"h-3 w-3 text-orange-600 rounded focus:ring-orange-500",value:"Fixed",checked:(d.priceType||"Fixed")==="Fixed",onChange:()=>I("priceType","Fixed")}),"Fixed"]}),e.jsxs("label",{className:"inline-flex items-center gap=1.5 text-xs font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",name:"priceType",className:"h-3 w-3 text-orange-600 rounded focus:ring-orange-500",value:"Negotiable",checked:d.priceType==="Negotiable",onChange:()=>I("priceType","Negotiable")}),"Negotiable"]})]}),d.priceType==="Negotiable"&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Final Price (â‚¹)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",className:"w-40 md:w-48 border rounded px-2 py-1.5 text-sm outline-none",value:d.finalPrice||"",onChange:U=>{I("finalPrice",U.target.value)},onBlur:U=>{const X=Ho(U.target.value);I("finalPrice",String(X))},placeholder:"e.g. 45,00,000","aria-label":"Final negotiated price"}),e.jsx("span",{className:"text-[11px] text-green-800 whitespace-nowrap",children:(()=>{const U=Ho(d.finalPrice||"");return!U||U<=0?"":U<1e7?`${Math.round(U/1e5)}L`:`${(U/1e7).toFixed(U%1e7?2:0)}Cr`})()})]})]}),P.budget&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:P.budget})]}),e.jsxs("div",{children:[e.jsx(Dm,{label:"Amenities",options:se("amenities"),selectedValues:d.amenities,onToggle:H,placeholder:"Select amenities..."}),d.amenities.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:d.amenities.map(U=>{const X=se("amenities").find(re=>re.value===U);return e.jsxs("span",{className:"flex items-center bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-[10px]",children:[(X==null?void 0:X.label)||U,e.jsx("button",{type:"button",onClick:()=>H(U),className:"ml-1 text-purple-500 hover:text-purple-700",children:"Ã—"})]},U)})})]}),e.jsxs("div",{children:[e.jsx(Dm,{label:"Furnishing Items",options:se("furnishing items"),selectedValues:d.furnishingItems,onToggle:h,placeholder:"Select furnishing items..."}),d.furnishingItems.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:d.furnishingItems.map(U=>{const X=se("furnishing items").find(re=>re.value===U);return e.jsxs("span",{className:"flex items-center bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-[10px]",children:[(X==null?void 0:X.label)||U,e.jsx("button",{type:"button",onClick:()=>h(U),className:"ml-1 text-purple-500 hover:text-purple-700",children:"Ã—"})]},U)})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{placeholder:"Auto-filled based on selections (editable)",value:d.address,onChange:U=>I("address",U.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-transparent bg-gray-50"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Nearby Places"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 md:col-span-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Place Name"}),e.jsx(Jt,{placeholder:"Select Place",options:se("place name"),value:p.name,onChange:U=>Y("name",U),className:"w-full",searchable:!0})]}),e.jsxs("div",{className:"col-span-6 md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Distance"}),e.jsx("input",{type:"text",className:"w-full h-9 px-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",placeholder:"Enter distance",value:p.distance,onChange:U=>Y("distance",U.target.value)})]}),e.jsxs("div",{className:"col-span-6 md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit"}),e.jsxs("select",{className:"w-full h-9 px-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",value:p.unit,onChange:U=>Y("unit",U.target.value),children:[e.jsx("option",{value:"",children:"Select Unit"}),e.jsx("option",{value:"km",children:"km"}),e.jsx("option",{value:"m",children:"m"}),e.jsx("option",{value:"min",children:"min"})]})]}),e.jsxs("div",{className:"col-span-12 md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Place Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Jt,{placeholder:"Select",options:se("place type"),value:p.type,onChange:U=>Y("type",U),className:"flex-1",searchable:!0}),e.jsx("button",{type:"button",onClick:K,className:"h-9 px-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:!p.name||!p.distance||!p.unit||!p.type,title:"Add place",children:e.jsx(fs,{size:16})})]})]})]}),e.jsx("div",{className:"space-y-2",children:d.nearby_places.length===0?e.jsx("div",{className:"text-xs text-gray-500 italic p-2 bg-gray-50 rounded",children:"No nearby places added yet. Fill the form above and click + to add places."}):d.nearby_places.map((U,X)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"text-xs text-gray-700",children:[e.jsx("span",{className:"font-medium text-blue-600",children:U.name}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",U.distance," ",U.unit,")"]}),e.jsx("span",{className:"text-green-600 ml-2 capitalize",children:U.type})]}),e.jsx("button",{type:"button",onClick:()=>q(X),className:"text-red-600 hover:text-red-800 transition-colors",title:"Remove",children:e.jsx(Es,{size:14})})]},X))})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Ownership Doc (PDF/JPG/PNG)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-3 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:U=>{var X;return ne(((X=U.target.files)==null?void 0:X[0])||null)},className:"hidden",id:"ownership-doc"}),e.jsxs("label",{htmlFor:"ownership-doc",className:"cursor-pointer",children:[e.jsx(dt,{className:"h-4 w-4 text-gray-400 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Choose Document"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG up to 10MB"})]})]})]}),x&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Document Preview"}),e.jsx(Rm,{preview:x,onRemove:S})]})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Photos (JPG/PNG, Multiple)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-3 text-center hover:border-gray-400 transition-colors",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png",multiple:!0,onChange:U=>{const X=Array.from(U.target.files||[]);X.length>0&&le(X)},className:"hidden",id:"property-photos"}),e.jsxs("label",{htmlFor:"property-photos",className:"cursor-pointer",children:[e.jsx(dt,{className:"h-4 w-4 text-gray-400 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:c.length>0?"Add More Photos":"Choose Photos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG up to 5MB each"})]})]})]}),c.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Photos Preview (",c.length," files)"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-48 overflow-y-auto",children:c.map((U,X)=>e.jsx(Rm,{preview:U,onRemove:()=>C(X)},X))})]})]})})]}),e.jsx(Jy,{formData:d,setFormData:U=>v(X=>U(X)),endpoint:"/api/ai/generate-description"}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-8 pt-6 border-t border-gray-200",children:[e.jsx(ss,{variant:"outline",onClick:a,disabled:$,children:"Cancel"}),e.jsxs(ss,{onClick:he,disabled:$,children:[Ps.createElement(de,{className:"h-4 w-4 mr-2"}),ee]})]})]})})},Xy=({property:s,stages:a,onStageUpdate:t,onShowStageModal:r,statusHistory:i,loadingStatusHistory:n,onRefreshHistory:o})=>{var u;const[m,g]=l.useState("stage"),b=a.find(c=>c.id===s.stage)||a[0],d=a.findIndex(c=>c.id===s.stage),v=c=>{const f={Available:{bg:"bg-green-100",text:"text-green-700",icon:"ðŸŸ¢",label:"Available"},Sold:{bg:"bg-blue-100",text:"text-blue-700",icon:"ðŸ”µ",label:"Sold"},"Under Negotiation":{bg:"bg-orange-100",text:"text-orange-700",icon:"ðŸŸ¡",label:"Under Negotiation"},"On Hold":{bg:"bg-gray-100",text:"text-gray-700",icon:"âš«",label:"On Hold"},Finalization:{bg:"bg-purple-100",text:"text-purple-700",icon:"ðŸŸ£",label:"Finalization"}},p=f[c]||f.Available;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${p.bg} ${p.text}`,children:[p.icon," ",p.label]})},x=c=>{if(!c)return"Not set";const f=new Date(c);return f.toLocaleDateString()+" "+f.toLocaleTimeString()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>g("stage"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${m==="stage"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Stage Progress"}),e.jsx("button",{onClick:()=>g("status"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${m==="status"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Status Progress"})]}),e.jsxs("div",{className:"flex space-x-2",children:[m==="status"&&e.jsxs("button",{onClick:o,disabled:n,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 flex items-center space-x-1",children:[e.jsx(na,{size:14,className:n?"animate-spin":""}),e.jsx("span",{children:"Refresh"})]}),m==="stage"&&e.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Update Stage"})]})]}),m==="stage"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:b.label}),e.jsxs("span",{children:[b.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${b.progress}%`}})})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2",children:["Current Stage: ",b.label]}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:b.description}),e.jsx("div",{className:"space-y-2",children:b.tasks.map((c,f)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-blue-600",size:14}),e.jsx("span",{className:"text-sm text-blue-800",children:c})]},f))})]}),e.jsx("div",{className:"space-y-3",children:a.map((c,f)=>{const p=f<d,N=f===d;return e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${p?"bg-green-500 text-white":N?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"}`,children:p?e.jsx(bs,{size:16}):f+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium ${N?"text-blue-600":p?"text-green-600":"text-gray-500"}`,children:c.label}),e.jsx("div",{className:"text-sm text-gray-500",children:c.description})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[c.progress,"%"]})]},c.id)})})]}),m==="status"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg p-4 mb-6 border border-gray-100",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Current Property Status"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[v(s.status),e.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",s.lastStatusUpdate?new Date(s.lastStatusUpdate).toLocaleDateString():"Not updated yet"]})]}),e.jsx("button",{onClick:()=>{const c=new CustomEvent("openStatusUpdateModal",{detail:s});window.dispatchEvent(c)},className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Update Status"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Status History"}),n?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading status history..."})]}):i.length>0?e.jsx("div",{className:"space-y-3",children:i.map(c=>e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(jt,{className:"text-blue-600",size:16})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("h5",{className:"font-medium text-gray-900 truncate",children:['Status changed from "',c.previous_status||"Unknown",'" to "',c.status,'"']}),e.jsx("time",{className:"text-xs text-gray-500 flex-shrink-0",children:x(c.timestamp)})]}),c.remarks&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"Remarks:"})," ",c.remarks]}),c.update_reason&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"Reason:"})," ",c.update_reason]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["By: ",c.updated_by||"Unknown User"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c.price_adjustment&&e.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:["Price Updated: â‚¹",Number(c.new_price||0).toLocaleString("en-IN")]}),c.notify_parties&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:"Parties Notified"})]})]}),c.effective_date&&e.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded text-xs",children:e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Effective Date:"})," ",x(c.effective_date)]})})]})]},c.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:[e.jsx(jt,{className:"mx-auto mb-2",size:32}),e.jsx("p",{children:"No status updates recorded yet"}),e.jsx("p",{className:"text-sm",children:"Status changes will appear here when they occur"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activities"}),e.jsx("div",{className:"space-y-3",children:((u=s.activities)==null?void 0:u.slice(0,5).map(c=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(jt,{className:"text-blue-600",size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:c.description}),e.jsx("div",{className:"text-sm text-gray-600",children:c.remarks}),e.jsxs("div",{className:"text-xs text-gray-500",children:[c.date," â€¢ ",c.user]})]})]},c.id)))||e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(jt,{className:"mx-auto mb-2",size:32}),e.jsx("p",{children:"No activities recorded yet"})]})})]})]})},zm={scheduled:{bg:"bg-blue-50",text:"text-blue-700",dot:"bg-blue-500"},confirmed:{bg:"bg-indigo-50",text:"text-indigo-700",dot:"bg-indigo-500"},completed:{bg:"bg-green-50",text:"text-green-700",dot:"bg-green-500"},cancelled:{bg:"bg-red-50",text:"text-red-700",dot:"bg-red-500"}},ej=s=>s?new Date(s):null,sj=s=>{const a=ej(s);return!a||Number.isNaN(a.getTime())?s||"":a.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})},tj=s=>s&&/^\d{1,2}:\d{2}/.test(s)?s:"",aj=({value:s})=>{const a=Math.max(0,Math.min(5,Math.round(Number(s||0))));return e.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(t=>e.jsx(Xs,{size:14,className:t<=a?"fill-yellow-400 text-yellow-500":"text-gray-300"},t))})},rj=({property:s,onScheduleVisit:a,onStartInspection:t,onMaintenanceSuggestions:r,onGenerateReport:i})=>{var g;const n=l.useMemo(()=>(s==null?void 0:s.visitHistory)??[],[s]),o=(s==null?void 0:s.title)||[s==null?void 0:s.property_type_name,(g=s==null?void 0:s.unit_type)==null?void 0:g.toUpperCase(),s==null?void 0:s.society_name].filter(Boolean).join(" ")||"Property",m=(s==null?void 0:s.location)||(s==null?void 0:s.address)||"";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-700",children:[e.jsx(Is,{size:14}),e.jsx("span",{className:"truncate",children:o})]}),m?e.jsxs("div",{className:"text-[11px] text-gray-600 mt-0.5 flex items-center gap-1",children:[e.jsx(Qs,{size:12}),m]}):null]}),e.jsxs("div",{className:"text-[11px] text-gray-600",children:["ID: ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.id)??"-"})]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Property Visit & Inspection"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("button",{onClick:a,className:"flex flex-col items-center gap-2 p-3 border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(Ts,{className:"text-blue-600",size:22}),e.jsx("span",{className:"text-xs font-medium text-blue-700",children:"Schedule Visit"})]}),e.jsxs("button",{onClick:t,className:"flex flex-col items-center gap-2 p-3 border border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[e.jsx(ks,{className:"text-green-600",size:22}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Start Inspection"})]}),e.jsxs("button",{onClick:r,className:"flex flex-col items-center gap-2 p-3 border border-orange-200 rounded-lg hover:bg-orange-50 transition-colors",children:[e.jsx(nn,{className:"text-orange-600",size:22}),e.jsx("span",{className:"text-xs font-medium text-orange-700",children:"Maintenance"})]}),e.jsxs("button",{onClick:i,className:"flex flex-col items-center gap-2 p-3 border border-purple-200 rounded-lg hover:bg-purple-50 transition-colors",children:[e.jsx(ws,{className:"text-purple-600",size:22}),e.jsx("span",{className:"text-xs font-medium text-purple-700",children:"Generate Report"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Visit History"}),e.jsx("p",{className:"text-[11px] text-gray-600 mt-0.5",children:"Latest visits and inspections logged for this property."})]}),e.jsx("div",{className:"p-4 space-y-3 max-h-[60vh] overflow-y-auto",children:n.length>0?n.map((b,d)=>{const v=b.status||"scheduled",x=zm[v]||zm.scheduled,u=sj(b.date),c=tj(b.time),f=typeof b.rating=="number"&&b.rating>5;return e.jsxs("div",{className:"flex items-start justify-between p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg shrink-0",children:e.jsx(ks,{className:"text-green-700",size:16})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:b.purpose||"Visit"}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] ${x.bg} ${x.text}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${x.dot}`}),v.charAt(0).toUpperCase()+v.slice(1)]})]}),e.jsxs("div",{className:"text-xs text-gray-700 mt-0.5 flex items-center gap-3 flex-wrap",children:[(u||c)&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Ts,{size:12}),u,u&&c?" â€¢ ":"",c]}),b.duration&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Ls,{size:12}),b.duration]}),b.inspector&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Ms,{size:12}),b.inspector]}),b.addressLine&&e.jsxs("span",{className:"inline-flex items-center gap-1 truncate max-w-[28ch]",children:[e.jsx(Qs,{size:12}),b.addressLine]})]}),b.accomp&&b.accomp.length>0&&e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:b.accomp.map((p,N)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-green-100 text-green-800 text-[11px]",children:p},`${p}-${N}`))}),b.notes&&e.jsx("div",{className:"mt-1 text-[11px] text-gray-600 line-clamp-2",children:b.notes})]})]}),e.jsx("div",{className:"text-right shrink-0 pl-2",children:typeof b.rating=="number"&&e.jsxs("div",{className:"flex flex-col items-end",children:[f?e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[b.rating,"/10"]}):e.jsx(aj,{value:b.rating}),e.jsx("div",{className:"text-[11px] text-gray-500 mt-0.5",children:v==="completed"?"Rated":"Scheduled"})]})})]},b.id??d)}):e.jsxs("div",{className:"text-center py-10 text-gray-500",children:[e.jsx(Ts,{className:"mx-auto mb-2",size:32}),e.jsx("p",{className:"text-sm",children:"No visits recorded yet"}),e.jsxs("button",{onClick:a,className:"mt-3 inline-flex items-center gap-1 px-3 py-1.5 text-xs bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[e.jsx(Ts,{size:14}),"Schedule first visit"]})]})})]})]})},lj=({property:s,onCreateDocument:a})=>{const t=[{id:"ownership",label:"Ownership Documents",count:3,color:"blue"},{id:"legal",label:"Legal Documents",count:2,color:"green"},{id:"financial",label:"Financial Documents",count:1,color:"purple"},{id:"marketing",label:"Marketing Materials",count:4,color:"orange"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:t.map(r=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:r.label}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:r.count})]}),e.jsx(ws,{className:`text-${r.color}-600`,size:20})]})},r.id))}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create Documents"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:a,className:"flex items-center space-x-3 p-4 border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(ws,{className:"text-blue-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-blue-900",children:"Mandate Agreement"}),e.jsx("div",{className:"text-sm text-blue-700",children:"Exclusive selling rights"})]})]}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-3 p-4 border border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[e.jsx(ws,{className:"text-green-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-green-900",children:"Authorization Letter"}),e.jsx("div",{className:"text-sm text-green-700",children:"Selling authorization"})]})]}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-3 p-4 border border-purple-200 rounded-lg hover:bg-purple-50 transition-colors",children:[e.jsx(ws,{className:"text-purple-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-purple-900",children:"Marketing Rights"}),e.jsx("div",{className:"text-sm text-purple-700",children:"Marketing authorization"})]})]})]})]})]})},nj=({property:s,onMatchBuyers:a})=>{var r;const t=i=>{const n=Number(i);return!n&&n!==0?"-":n>=1e7?`â‚¹${(n/1e7).toFixed(1)}Cr`:n>=1e5?`â‚¹${(n/1e5).toFixed(1)}L`:`â‚¹${n.toLocaleString("en-IN")}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Buyer Matching"}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Find Matching Buyers"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.interestedBuyers||0}),e.jsx("div",{className:"text-sm text-green-700",children:"Interested Buyers"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.hotLeads||0}),e.jsx("div",{className:"text-sm text-red-700",children:"Hot Leads"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.visits||0}),e.jsx("div",{className:"text-sm text-blue-700",children:"Property Visits"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Matched Buyers"}),e.jsx("div",{className:"space-y-3",children:((r=s.matchedBuyers)==null?void 0:r.map((i,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ms,{className:"text-blue-600",size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:i.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Budget: ",t(i.budget)," â€¢ ",i.matchScore,"% match"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-green-600 hover:bg-green-100 rounded",children:e.jsx(tt,{size:16})}),e.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(Cs,{size:16})})]})]},n)))||e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ns,{className:"mx-auto mb-2",size:32}),e.jsx("p",{children:"No matched buyers yet"})]})})]})]})},ij=({property:s,onCreateBrochure:a,onShareProperty:t,onManageMedia:r,onPublishProperty:i})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Marketing Tools"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:a,className:"flex flex-col items-center space-y-2 p-4 border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(ws,{className:"text-blue-600",size:24}),e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Create Brochure"})]}),e.jsxs("button",{onClick:t,className:"flex flex-col items-center space-y-2 p-4 border border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[e.jsx(Wt,{className:"text-green-600",size:24}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Share Property"})]}),e.jsxs("button",{onClick:r,className:"flex flex-col items-center space-y-2 p-4 border border-purple-200 rounded-lg hover:bg-purple-50 transition-colors",children:[e.jsx(Sa,{className:"text-purple-600",size:24}),e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Manage Media"})]}),e.jsxs("button",{onClick:i,className:"flex flex-col items-center space-y-2 p-4 border border-orange-200 rounded-lg hover:bg-orange-50 transition-colors",children:[e.jsx(_t,{className:"text-orange-600",size:24}),e.jsx("span",{className:"text-sm font-medium text-orange-700",children:"Publish Online"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Marketing Performance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.publicViews||0}),e.jsx("div",{className:"text-sm text-blue-700",children:"Online Views"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.publicInquiries||0}),e.jsx("div",{className:"text-sm text-green-700",children:"Inquiries"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.socialShares||0}),e.jsx("div",{className:"text-sm text-purple-700",children:"Social Shares"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s.brochureDownloads||0}),e.jsx("div",{className:"text-sm text-orange-700",children:"Brochure Downloads"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Published Platforms"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{name:"MagicBricks",status:"published",views:1250,inquiries:15},{name:"99acres",status:"published",views:980,inquiries:12},{name:"Housing.com",status:"pending",views:0,inquiries:0}].map((n,o)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:n.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.status==="published"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:n.status})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Views: ",n.views," â€¢ Inquiries: ",n.inquiries]})]},o))})]})]}),oj=({property:s,onStartNegotiation:a})=>{var r;const t=i=>{const n=Number(i);return!n&&n!==0?"-":n>=1e7?`â‚¹${(n/1e7).toFixed(1)}Cr`:n>=1e5?`â‚¹${(n/1e5).toFixed(1)}L`:`â‚¹${n.toLocaleString("en-IN")}`};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Active Negotiations"}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Start New Negotiation"})]}),e.jsx("div",{className:"space-y-3",children:((r=s.negotiations)==null?void 0:r.map((i,n)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium text-gray-900",children:i.buyerName}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i.status==="active"?"bg-green-100 text-green-800":i.status==="pending"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:i.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Offered:"}),e.jsx("span",{className:"font-medium ml-2",children:t(i.offeredPrice)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Counter:"}),e.jsx("span",{className:"font-medium ml-2",children:t(i.counterPrice)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Last Update:"}),e.jsx("span",{className:"font-medium ml-2",children:i.lastUpdate})]})]})]},n)))||e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(rt,{className:"mx-auto mb-2",size:32}),e.jsx("p",{children:"No active negotiations"})]})})]})})},cj=({property:s})=>{const a=s.publicViews||0,t=s.visits||0,r=a?(t/a*100).toFixed(1):"0.0",i=n=>{if(!n)return 0;const o=new Date(n).getTime();return Number.isNaN(o)?0:Math.floor((Date.now()-o)/(1e3*60*60*24))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Engagement Metrics"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Views:"}),e.jsx("span",{className:"font-medium",children:a})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Inquiries:"}),e.jsx("span",{className:"font-medium",children:s.publicInquiries||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Site Visits:"}),e.jsx("span",{className:"font-medium",children:t})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Conversion Rate:"}),e.jsxs("span",{className:"font-medium",children:[r,"%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Market Position"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Price/sq ft:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",Math.round((Number(s.budget)||0)/(Number(s.carpetArea)||1)).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Market Average:"}),e.jsx("span",{className:"font-medium",children:"â‚¹18,500"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Price Variance:"}),e.jsx("span",{className:"font-medium text-green-600",children:"+5.2%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Days on Market:"}),e.jsx("span",{className:"font-medium",children:i(s.created_at)})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Market Insights"}),e.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ot,{className:"mx-auto text-gray-400 mb-2",size:48}),e.jsx("p",{className:"text-gray-500",children:"Market analysis charts will be displayed here"})]})})]})]})},gi=s=>{const a=Number(s);if(!Number.isFinite(a)||a<=0)return" - ";const t=1e7,r=1e5;if(a>=t){const i=a/t;return`â‚¹${parseFloat(i.toFixed(2))}Cr`}if(a>=r){const i=a/r;return`â‚¹${parseFloat(i.toFixed(0))}L`}return`â‚¹${a.toLocaleString("en-IN")}`},dj=({tags:s})=>{if(!s||s.length===0)return null;const a=s.slice(0,20);return e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[a.map((t,r)=>{const i=Ea(t),n=typeof i.emoji=="string"?()=>e.jsx("span",{className:"text-xs mr-1",children:i.emoji?typeof i.emoji=="string"?e.jsx("span",{className:"text-xs mr-1 uppercase","aria-hidden":"true",children:i.emoji}):Ps.createElement(i.emoji,{size:10,className:"mr-1 uppercase","aria-hidden":!0}):null}):i.emoji;return e.jsxs("span",{className:`
                inline-flex items-center px-2 py-1 rounded-full text-xs font-bold uppercase 
                ${i.bg} ${i.text} ring-1 ${i.ring}
                transition-all duration-200
              `,children:[i.emoji&&(typeof i.emoji=="string"?e.jsx(n,{}):e.jsx(n,{size:10,className:"mr-1"})),t]},r)}),s.length>10&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:["+",s.length-2]})]})},mj=s=>{var a,t;return{id:s.id,seller:((a=s.seller)==null?void 0:a.name)||"",propertyType:s.type||"",propertySubtype:s.subtype||"",unitType:s.unitType||"",wing:s.wing||"",unitNo:s.unitNo||"",furnishing:s.furnishing||"",facing:s.facing||"",balcony:s.balcony?String(s.balcony):"",bedrooms:s.bedrooms?String(s.bedrooms):"",bathrooms:s.bathrooms?String(s.bathrooms):"",priceType:s.priceType||"Fixed",finalPrice:s.finalPrice?String(s.finalPrice):"",parkingType:s.parkingType||"",parkingQty:String(s.parkingQty??""),city:s.city||"",location:s.location||"",society:s.society||"",floor:String(s.floor??""),totalFloors:String(s.totalFloors??""),carpetArea:String(s.carpetArea??""),builtupArea:String(s.builtupArea??""),budget:String(s.budget??""),address:s.address||"",status:s.status||"",leadSource:((t=s.seller)==null?void 0:t.leadSource)??s.leadSource??"",possessionMonth:String(s.possessionMonth??""),possessionYear:String(s.possessionYear??""),purchaseMonth:String(s.purchaseMonth??""),purchaseYear:String(s.purchaseYear??""),sellingRights:s.selling_rights||"Standard",amenities:Array.isArray(s.amenities)?s.amenities:[],furnishingItems:Array.isArray(s.furnishingItems)?s.furnishingItems:[],description:s.description||"",nearby_places:Array.isArray(s.nearby_places)?s.nearby_places:[],existingOwnershipDocUrl:s.ownershipDocUrl||"",existingOwnershipDocName:s.ownershipDocName||"",existingOwnershipDocId:s.ownershipDocId||"",existingPhotos:(s.photos||[]).map((r,i)=>({id:String(i+1),url:r,name:`photo-${i+1}.jpg`}))}},xj=({src:s,alt:a="image",className:t="",imgClassName:r=""})=>e.jsx("div",{className:`group relative overflow-hidden rounded-xl ${t}`,children:e.jsx("img",{src:s,alt:a,className:`block w-full h-full object-cover transition-transform duration-300 ease-out will-change-transform group-hover:scale-[1.06] ${r}`,loading:"eager",decoding:"async",style:{display:"block"}})}),Tc=s=>(s||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"").slice(0,120),uj=s=>{var r;const a=`fltcnt_${s}`;let t=localStorage.getItem(a);return t||(t=((r=crypto==null?void 0:crypto.randomUUID)==null?void 0:r.call(crypto))||Math.random().toString(36).slice(2),localStorage.setItem(a,t)),t},gj=s=>{const a=window.location.origin,t=(s==null?void 0:s.id)??(s==null?void 0:s.propertyId),r=s!=null&&s.slug?Tc(String(s.slug)):Tc([s==null?void 0:s.type,s==null?void 0:s.unitType,s==null?void 0:s.subtype,s==null?void 0:s.city,s==null?void 0:s.location].filter(Boolean).join(" ")),i=uj(t);return`${a}/properties/${t}-${r}?fltcnt=${encodeURIComponent(i)}`},Br=s=>{if(s===""||s==null)return;const a=Number(typeof s=="string"?s.replace(/[, ]/g,""):s);return Number.isFinite(a)?a:void 0},Fm=s=>s==null||s===""?null:Br(s)??null,hj=s=>({...s,bedrooms:Br(s.bedrooms),bathrooms:Br(s.bathrooms),parkingQty:Br(s.parkingQty),floor:Br(s.floor),totalFloors:Br(s.totalFloors),carpetArea:Br(s.carpetArea),builtupArea:Br(s.builtupArea),budget:Fm(s.budget),finalPrice:Fm(s.finalPrice)}),pj=({property:s,onBack:a,onEdit:t,onNext:r,onPrevious:i,currentIndex:n=0,totalProperties:o=1,onUpdateProperty:m,onBuyerMatching:g,onViewBuyers:b})=>{const{user:d}=Hs(),v=Ws(d,"property.update"),[x,u]=l.useState(()=>{const xe=new URLSearchParams(window.location.search).get("tab"),Ee=localStorage.getItem(`pv_tab_${String(s==null?void 0:s.id)}`);return xe||Ee||"overview"}),[c,f]=l.useState(!1),[p,N]=l.useState(!1),[P,w]=l.useState(!1),[$,y]=l.useState(!1),[k,R]=l.useState(!1),[F,T]=l.useState(!1),[j,E]=l.useState(!1),[V,W]=l.useState(!1),[B,M]=l.useState(!1),[A,L]=l.useState(!1),[D,I]=l.useState(!1),[H,h]=l.useState(!1),[Y,K]=l.useState(!1),[q,ne]=l.useState(!1),[le,S]=l.useState(!1),[C,J]=l.useState(s),[ue,Q]=l.useState([]),[he,se]=l.useState([]),[ge,ee]=l.useState([]),[de,U]=l.useState(!1);Ps.useRef(null),Ps.useRef(null);const[X,re]=l.useState(0);l.useRef(c),l.useEffect(()=>{console.log("ðŸ” Property Data:",s),console.log("ðŸ” Executive Details:",s.assignedTo)},[s]);const fe=async ze=>{try{const xe=await Qt.getById(ze);return(xe==null?void 0:xe.tags)||[]}catch(xe){return console.warn(`Could not load tags for property ${ze}:`,xe),[]}};l.useEffect(()=>{(async()=>{if(s!=null&&s.id){const xe=await fe(Number(s.id));J(Ee=>({...Ee,tags:xe}))}})()},[s==null?void 0:s.id]),l.useEffect(()=>{if(!s)return;const ze=s.id!==C.id,xe=s.updated_at!==C.updated_at;(ze||xe)&&(J(s),re(Ee=>Ee+1))},[s==null?void 0:s.id,s==null?void 0:s.updated_at]),l.useEffect(()=>{const ze=xe=>{re(Ee=>Ee+1),u("overview")};return window.addEventListener("overview:refresh",ze),()=>window.removeEventListener("overview:refresh",ze)},[C.id]),l.useEffect(()=>{J(s)},[s]),l.useEffect(()=>{const xe=new URLSearchParams(window.location.search).get("tab"),Ee=localStorage.getItem(`pv_tab_${String(s==null?void 0:s.id)}`),Ke=xe||Ee;Ke&&Ke!==x&&u(Ke)},[s==null?void 0:s.id]);const G=[{id:"initial_contact",label:"Initial Contact",progress:10,description:"First contact with seller",tasks:["Contact seller","Understand requirements","Schedule meeting"],nextStage:"property_collection"},{id:"property_collection",label:"Property Collection",progress:25,description:"Collect property details and documents",tasks:["Property visit","Document verification","Photo/video shoot"],nextStage:"mandate_discussion"},{id:"mandate_discussion",label:"Mandate Discussion",progress:40,description:"Discuss mandate and authorization",tasks:["Mandate discussion","Price negotiation","Terms agreement"],nextStage:"mandate_signed"},{id:"mandate_signed",label:"Mandate Signed",progress:55,description:"Mandate and documents signed",tasks:["Document signing","Authorization letters","Marketing rights"],nextStage:"marketing_active"},{id:"marketing_active",label:"Marketing Active",progress:70,description:"Property actively marketed",tasks:["Create brochure","Publish on portals","Buyer matching"],nextStage:"buyer_interested"},{id:"buyer_interested",label:"Buyer Interested",progress:80,description:"Buyers showing interest",tasks:["Buyer visits","Negotiations","Offer management"],nextStage:"deal_negotiation"},{id:"deal_negotiation",label:"Deal Negotiation",progress:90,description:"Active deal negotiations",tasks:["Price negotiation","Terms finalization","Agreement preparation"],nextStage:"deal_closure"},{id:"deal_closure",label:"Deal Closure",progress:100,description:"Deal successfully closed",tasks:["Final agreement","Payment completion","Handover"],nextStage:null}],me=[{id:"overview",label:"Overview",icon:yt},{id:"stages",label:"Stages & Progress",icon:Rs},{id:"visits",label:"Visits & Inspections",icon:ks},{id:"documents",label:"Documents",icon:ws},{id:"buyers",label:"Buyer Interest",icon:Ns},{id:"marketing",label:"Marketing",icon:_t},{id:"negotiations",label:"Negotiations",icon:rt},{id:"reports",label:"Reports & Analytics",icon:Ot}],oe=async()=>{U(!0);try{const ze=await As.getStatusHistory(String(C.id));ze.success&&ee(ze.data)}catch(ze){console.error("Failed to fetch status history:",ze),gt.error("Failed to load status history")}finally{U(!1)}};l.useEffect(()=>{const ze=G.find(xe=>xe.id===C.stage);if(ze){const xe=Fe(ze);Q(xe)}se(C.activities||[])},[C.stage]),l.useEffect(()=>{C.id&&oe()},[C.id]),l.useEffect(()=>{const ze=xe=>{xe.detail.id===C.id&&ne(!0)};return window.addEventListener("openStatusUpdateModal",ze),()=>{window.removeEventListener("openStatusUpdateModal",ze)}},[C.id]);const Fe=ze=>{const xe=[{id:1,type:"stage_progress",title:`Complete ${ze.label} tasks`,description:`${ze.tasks.join(", ")}`,dueDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],priority:"high",status:"pending"},{id:2,type:"weekly_update",title:"Weekly status update",description:"Update property status and progress",dueDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],priority:"medium",status:"pending"}];return ze.id==="property_collection"&&xe.push({id:3,type:"photo_video",title:"Property photo/video shoot",description:"Schedule professional photography and videography",dueDate:new Date(Date.now()+4320*60*1e3).toISOString().split("T")[0],priority:"high",status:"pending"}),ze.id==="marketing_active"&&xe.push({id:4,type:"portal_publish",title:"Publish on property portals",description:"List property on MagicBricks, 99acres, Housing.com",dueDate:new Date(Date.now()+2880*60*1e3).toISOString().split("T")[0],priority:"high",status:"pending"}),xe},$e=()=>{f(!0)};l.useEffect(()=>{localStorage.setItem(`pv_tab_${String(C.id)}`,x);const ze=new URLSearchParams(window.location.search);ze.set("tab",x),window.history.replaceState(null,"",`${window.location.pathname}?${ze.toString()}`)},[x,C.id]);const Le=ze=>{const xe={...C,...ze,updated_at:new Date().toISOString(),activities:[...he||[],{id:Date.now(),type:"property_update",description:"Property details updated",date:new Date().toISOString().split("T")[0],time:new Date().toLocaleTimeString(),user:"Admin User"}]};J(xe),m==null||m(xe),re(Ee=>Ee+1),window.dispatchEvent(new CustomEvent("overview:refresh",{detail:{id:xe.id}})),f(!1),gt.success("Property updated successfully!")},je=async(ze,xe)=>{var Ke,Xe;const Ee={...C,stage:ze,stageProgress:((Ke=G.find(ye=>ye.id===ze))==null?void 0:Ke.progress)||0,lastUpdated:new Date().toISOString(),activities:[...he||[],{id:Date.now(),type:"stage_update",description:`Stage updated to ${(Xe=G.find(ye=>ye.id===ze))==null?void 0:Xe.label}`,remarks:xe,date:new Date().toISOString().split("T")[0],time:new Date().toLocaleTimeString(),user:"Admin User"}]};J(Ee),m==null||m(Ee),gt.success("Stage updated successfully!")},_e=async ze=>{const xe={...C,visits:(C.visits||0)+1,lastVisit:ze.date,activities:[...he||[],{id:Date.now(),type:"property_visit",description:`Property visit completed - ${ze.purpose}`,remarks:ze.findings,date:ze.date,time:ze.time,user:ze.inspector,details:ze}]};J(xe),m==null||m(xe),gt.success("Property visit recorded!")},ve=async ze=>{const xe={...C,inspectionStatus:"completed",inspectionReport:ze,activities:[...he||[],{id:Date.now(),type:"inspection",description:`Property inspection completed - Overall rating: ${ze.overallRating}/10`,remarks:ze.summary,date:ze.date,time:new Date().toLocaleTimeString(),user:ze.inspector,details:ze}]};J(xe),m==null||m(xe),gt.success("Inspection report generated!")},Pe=async ze=>{const xe={...C,maintenanceReport:ze,activities:[...he||[],{id:Date.now(),type:"maintenance",description:`Maintenance suggestions provided - ${ze.suggestions.length} items`,remarks:ze.summary,date:new Date().toISOString().split("T")[0],time:new Date().toLocaleTimeString(),user:"Admin User",details:ze}]};J(xe),m==null||m(xe),gt.success("Maintenance suggestions saved!")},We=async(ze,xe,Ee)=>{const Ke={...C,status:ze,lastStatusUpdate:new Date().toISOString(),...Ee.priceAdjustment&&Ee.newPrice&&{budget:Ee.newPrice},activities:[...he||[],{id:Date.now(),type:"status_update",description:`Property status updated to ${ze}`,remarks:xe,date:new Date().toISOString().split("T")[0],time:new Date().toLocaleTimeString(),user:Ee.updatedBy||"Admin User",details:Ee}]};J(Ke),m==null||m(Ke),se(Ke.activities||[]),await oe(),gt.success("Property status updated!")},pe=ze=>{const xe={Available:{bg:"bg-green-100",text:"text-green-700",icon:"ðŸŸ¢",label:"Available"},Sold:{bg:"bg-blue-100",text:"text-blue-700",icon:"ðŸ”µ",label:"Sold"},"Under Negotiation":{bg:"bg-orange-100",text:"text-orange-700",icon:"ðŸŸ¡",label:"Under Negotiation"},"On Hold":{bg:"bg-gray-100",text:"text-gray-700",icon:"âš«",label:"On Hold"},Finalization:{bg:"bg-purple-100",text:"text-purple-700",icon:"ðŸŸ£",label:"Finalization"}},Ee=xe[ze]||xe.Available;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${Ee.bg} ${Ee.text}`,children:[Ee.icon," ",Ee.label]})},O=ze=>{const xe=G.find(Ee=>Ee.id===ze);return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-700",children:["ðŸ“ ",(xe==null?void 0:xe.label)||"Unknown Stage"]})},Ie=()=>ue.filter(ze=>ze.status==="pending").length;return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(ga,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:" font-bold text-gray-900 text-lg",children:[C.type&&C.type!==" - "&&e.jsx("span",{className:"mr-2",children:C.type}),C.unitType&&C.unitType!==" - "&&e.jsx("span",{className:"mr-2",children:C.unitType}),C.subtype&&C.subtype!==" - "&&e.jsx("span",{className:"mr-2",children:C.subtype})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[pe(C.status),O(C.stage),e.jsxs("span",{className:"text-sm text-gray-500",children:["ID: ",C.propertyId]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[r&&i&&e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:i,disabled:n===0,className:"p-1.5 rounded bg-white shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Wa,{size:16})}),e.jsxs("span",{className:"px-2 text-sm font-medium text-gray-600",children:[n+1," of ",o]}),e.jsx("button",{onClick:r,disabled:n===o-1,className:"p-1.5 rounded bg-white shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:16})})]}),e.jsx("div",{className:"relative",children:e.jsxs("button",{onClick:()=>I(!0),className:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-200 transition-colors relative",children:[e.jsx(ha,{size:18}),Ie()>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:Ie()})]})}),e.jsx("button",{onClick:()=>ne(!0),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Update Status"}),e.jsx("button",{onClick:()=>N(!0),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Update Stage"}),v&&e.jsx("button",{onClick:$e,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(ft,{size:18})})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("nav",{className:"flex space-x-1 overflow-x-auto pb-1",children:me.map(ze=>{const xe=ze.icon;return e.jsxs("button",{onClick:()=>u(ze.id),className:`flex items-center space-x-2 px-3 py-1.5 rounded-lg transition-colors whitespace-nowrap text-sm ${x===ze.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(xe,{size:14}),e.jsx("span",{children:ze.label})]},ze.id)})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[x==="overview"&&e.jsx(bj,{property:C,onUpdate:J},`ov-${C.id}-${X}`),x==="stages"&&e.jsx(Xy,{property:C,stages:G,onStageUpdate:je,onShowStageModal:()=>N(!0),statusHistory:ge,loadingStatusHistory:de,onRefreshHistory:oe}),x==="visits"&&e.jsx(rj,{property:C,onScheduleVisit:()=>w(!0),onStartInspection:()=>y(!0),onMaintenanceSuggestions:()=>R(!0),onGenerateReport:()=>T(!0)}),x==="documents"&&e.jsx(lj,{property:C,onCreateDocument:()=>M(!0)}),x==="buyers"&&e.jsx(nj,{property:C,onMatchBuyers:()=>S(!0)}),x==="marketing"&&e.jsx(ij,{property:C,onCreateBrochure:()=>E(!0),onShareProperty:()=>W(!0),onManageMedia:()=>h(!0),onPublishProperty:()=>K(!0)}),x==="negotiations"&&e.jsx(oj,{property:C,onStartNegotiation:()=>L(!0)}),x==="reports"&&e.jsx(cj,{property:C})]}),c&&e.jsx(no,{isOpen:c,onClose:()=>f(!1),mode:"edit",propertyId:C.id,initialData:mj(C),onSubmit:Le}),p&&e.jsx(vy,{isOpen:p,onClose:()=>N(!1),property:C,stages:G,onStageUpdate:je}),P&&e.jsx(Ny,{isOpen:P,onClose:()=>w(!1),property:C,onSave:_e}),$&&e.jsx(Cy,{isOpen:$,onClose:()=>y(!1),property:C,onSave:ve}),k&&e.jsx(Ay,{isOpen:k,onClose:()=>R(!1),property:C,onSave:Pe}),F&&e.jsx(Py,{isOpen:F,onClose:()=>T(!1),property:C}),j&&e.jsx(Uy,{isOpen:j,onClose:()=>E(!1),property:hj(C)}),V&&e.jsx(qy,{isOpen:V,onClose:()=>W(!1),property:C}),B&&e.jsx(Vy,{isOpen:B,onClose:()=>M(!1),property:C}),A&&e.jsx(Wy,{isOpen:A,onClose:()=>L(!1),property:C}),D&&e.jsx(Hy,{isOpen:D,onClose:()=>I(!1),property:C,reminders:ue,onUpdateReminders:Q}),H&&e.jsx(Yy,{isOpen:H,onClose:()=>h(!1),property:C,onUpdate:J}),Y&&e.jsx(Gy,{isOpen:Y,onClose:()=>K(!1),property:C,onUpdate:J}),q&&e.jsx(Ky,{isOpen:q,onClose:()=>ne(!1),property:C,onStatusUpdate:We}),le&&e.jsx(tg,{isOpen:le,onClose:()=>S(!1),property:C})]})},bj=({property:s,onUpdate:a})=>{var c,f,p,N,P,w,$,y,k,R;const[t,r]=l.useState(!1),[i,n]=l.useState(s.budget||0),[o,m]=l.useState(s.negotiablePrice||s.budget*.95),g=Ps.useRef(null),b=Ps.useRef(null),[d,v]=l.useState(!1);l.useEffect(()=>{n(s.budget||0),m(s.negotiablePrice??(s.budget?s.budget*.95:0))},[s.budget,s.negotiablePrice,s.updated_at]);const x=F=>{if(!F)return"";const T=typeof F=="string"?parseInt(F):F;return isNaN(T)||T<1||T>12?"":new Date(0,T-1).toLocaleString("en",{month:"long"})},u=()=>{const F={...s,budget:i,negotiablePrice:o,priceHistory:[...s.priceHistory||[],{date:new Date().toISOString().split("T")[0],quotePrice:i,negotiablePrice:o,updatedBy:"Admin User"}]};a(F),r(!1),gt.success("Pricing updated successfully!")};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4 min-w-0",children:[e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"relative",children:[e.jsxs(bh,{modules:[Uh],onBeforeInit:F=>{F.params.navigation.prevEl=g.current,F.params.navigation.nextEl=b.current},navigation:{prevEl:g.current,nextEl:b.current},className:"mySwiper w-full",children:[((c=s.photos)!=null&&c.length?s.photos:["https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800"]).map((F,T)=>e.jsx(fh,{children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(xj,{src:F,alt:`${s.title||"Property"} - ${T+1}`,className:"w-full h-[200px] sm:h-[250px] md:h-[300px] lg:h-[350px] xl:h-[400px] 2xl:h-[450px]",imgClassName:"rounded-xl"}),e.jsxs("div",{className:"absolute top-3 right-3 flex items-start flex-wrap justify-end gap-2 z-20 text-right",children:[e.jsx("div",{className:"flex flex-wrap justify-end gap-1.5",children:e.jsx(dj,{tags:s.tags||[]})}),(s.aiScore??0)>=90&&e.jsxs("span",{className:"flex-none whitespace-nowrap bg-purple-600 text-white px-2 py-1 rounded-full text-[8px] sm:text-xs font-bold leading-none flex items-center shadow-sm",children:[e.jsx(Mt,{size:12,className:"mr-1"}),"AI ",Math.round(s.aiScore??0)]})]})]})},T)),e.jsx("button",{ref:g,className:`absolute left-3 top-1/2 -translate-y-1/2 z-20 grid place-items-center\r
                  w-9 h-9 rounded-full bg-black/40 text-white backdrop-blur-sm\r
                  hover:bg-black/60 transition`,"aria-label":"Previous slide",type:"button",children:"â€¹"}),e.jsx("button",{ref:b,className:`absolute right-3 top-1/2 -translate-y-1/2 z-20 grid place-items-center\r
                  w-9 h-9 rounded-full bg-black/40 text-white backdrop-blur-sm\r
                  hover:bg-black/60 transition`,"aria-label":"Next slide",type:"button",children:"â€º"})]}),e.jsxs("div",{className:"absolute top-4 left-4 flex flex-wrap gap-2 z-20",children:[s.isPublic?e.jsx("span",{className:"px-2 py-1 rounded-full text-[11px] font-semibold bg-green-50 text-green-700 ring-1 ring-green-200 shadow-sm",children:"PUBLIC"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-[11px] font-semibold bg-red-50 text-red-700 ring-1 ring-red-200 shadow-sm",children:"PRIVATE"}),s.hotLeads>2&&e.jsx("span",{className:"px-3 py-1 bg-red-500 text-white rounded-full text-xs md:text-sm font-bold",children:"HOT PROPERTY"}),s.verified&&e.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white rounded-full text-xs md:text-sm font-bold flex items-center gap-1",children:[e.jsx(at,{size:12}),e.jsx("span",{children:"VERIFIED"})]})]}),e.jsx("div",{className:"absolute bottom-4 right-4 z-20",children:e.jsx("button",{className:"p-2 bg-black/60 text-white rounded-lg hover:bg-black/70 transition",children:e.jsx(Sa,{size:16})})})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Quick Info"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-2 2xl:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Quote Price"}),e.jsx("div",{className:"flex items-center gap-2",children:t?e.jsx("input",{type:"number",value:i,onChange:F=>n(Number(F.target.value)),className:"text-lg font-bold text-green-600 border-b border-green-300 bg-transparent w-28 focus:outline-none",onBlur:u,onKeyDown:F=>F.key==="Enter"&&u(),autoFocus:!0}):e.jsx("p",{className:"text-lg font-bold text-green-600 cursor-pointer hover:text-green-700",onClick:()=>r(!0),children:gi(i)})})]}),e.jsx(cn,{className:"text-green-600",size:20})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Negotiable Price"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:gi(s==null?void 0:s.finalPrice)})]}),e.jsx(lo,{className:"text-orange-600",size:20})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Visits"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:s.visits||0})]}),e.jsx(ks,{className:"text-blue-600",size:20})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Interested Buyers"}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:s.interestedBuyers||0})]}),e.jsx(Ns,{className:"text-purple-600",size:20})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Property Details"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-4 xl:grid-cols-2 2xl:grid-cols-5 gap-2 text-[13px] leading-tight",children:[e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Seller"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900 truncate",children:((f=s.seller)==null?void 0:f.name)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Property Type"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900 truncate",children:(s==null?void 0:s.type)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Unit Type"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900 truncate",children:(s==null?void 0:s.unitType)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Subtype"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900 truncate",children:(s==null?void 0:s.subtype)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-indigo-50/50 ring-1 ring-indigo-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-indigo-600/80",children:"Society"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-indigo-900 truncate",children:(s==null?void 0:s.society)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-indigo-50/50 ring-1 ring-indigo-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-indigo-600/80",children:"Wing"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-indigo-900 truncate",children:(s==null?void 0:s.wing)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-indigo-50/50 ring-1 ring-indigo-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-indigo-600/80",children:"Unit No"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-indigo-900 truncate",children:(s==null?void 0:s.unitNo)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-emerald-50/60 ring-1 ring-emerald-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-emerald-600/90",children:"Facing"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-emerald-900",children:(s==null?void 0:s.facing)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-emerald-50/60 ring-1 ring-emerald-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-emerald-600/90",children:"Bedrooms"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-emerald-900",children:(s==null?void 0:s.bedrooms)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-emerald-50/60 ring-1 ring-emerald-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-emerald-600/90",children:"Bathrooms"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-emerald-900",children:(s==null?void 0:s.bathrooms)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-emerald-50/60 ring-1 ring-emerald-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-emerald-600/90",children:"Balcony"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-emerald-900",children:(s==null?void 0:s.balcony)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Floor"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900",children:(s==null?void 0:s.floor)??"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Total Floors"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900",children:(s==null?void 0:s.totalFloors)??(s==null?void 0:s.total_floors)??"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-sky-50/60 ring-1 ring-sky-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-sky-600/90",children:"City"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-sky-900 truncate",children:(s==null?void 0:s.city)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-sky-50/60 ring-1 ring-sky-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-sky-600/90",children:"Location"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-sky-900 truncate",children:(s==null?void 0:s.location)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-fuchsia-50/50 ring-1 ring-fuchsia-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-fuchsia-600/80",children:"Built-up Area"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-fuchsia-900",children:s!=null&&s.builtupArea?`${s.builtupArea} Sq.ft.`:"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-fuchsia-50/50 ring-1 ring-fuchsia-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-fuchsia-600/80",children:"Carpet Area"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-fuchsia-900",children:s!=null&&s.carpetArea?`${s.carpetArea} Sq.ft.`:"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-green-50 ring-1 ring-green-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-green-700",children:"Sell Price"}),e.jsx("div",{className:"mt-0 inline-flex items-center px-1.5 py-0.5 rounded bg-green-100 text-green-800 ring-1 ring-green-200 text-[12px] font-semibold",children:s!=null&&s.budget?gi(s==null?void 0:s.budget):"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-amber-50 ring-1 ring-amber-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-amber-700",children:"Final Price"}),e.jsx("div",{className:"mt-0 inline-flex items-center px-1.5 py-0.5 rounded bg-amber-100 text-amber-800 ring-1 ring-amber-200 text-[12px] font-semibold",children:s!=null&&s.finalPrice?gi(s==null?void 0:s.finalPrice):"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Price Type"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900",children:(s==null?void 0:s.priceType)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-zinc-50 ring-1 ring-zinc-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-zinc-500",children:"Parking Qty"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-zinc-900",children:(s==null?void 0:s.parkingQty)??(s==null?void 0:s.parking_qty)??"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-zinc-50 ring-1 ring-zinc-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-zinc-500",children:"Parking Type"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-zinc-900",children:(s==null?void 0:s.parkingType)??(s==null?void 0:s.parking_type)??"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-violet-50/50 ring-1 ring-violet-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-violet-600/80",children:"Furnishing"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-violet-900",children:(s==null?void 0:s.furnishing)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-violet-50/50 ring-1 ring-violet-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-violet-600/80",children:"Possession Year"}),e.jsxs("div",{className:"mt-0 text-[12px] font-semibold text-violet-900",children:[x(s==null?void 0:s.possessionMonth)," ",(s==null?void 0:s.possessionYear)||"-"]})]}),e.jsxs("div",{className:"p-2 rounded-md bg-rose-50/60 ring-1 ring-rose-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-rose-600/90",children:"Purchase Date"}),e.jsxs("div",{className:"mt-0 text-[12px] font-semibold text-rose-900",children:[x(s==null?void 0:s.purchaseMonth)," ",(s==null?void 0:s.purchaseYear)||"-"]})]}),e.jsxs("div",{className:"p-2 rounded-md bg-rose-50/60 ring-1 ring-rose-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-rose-600/90",children:"Selling Rights"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-rose-900",children:(s==null?void 0:s.selling_rights)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Lead Source"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900",children:(s==null?void 0:s.leadSource)||"-"})]}),e.jsxs("div",{className:"p-2 rounded-md bg-blue-50/60 ring-1 ring-blue-100/60",children:[e.jsx("div",{className:"text-[10px] font-medium text-blue-600/90",children:"Status"}),e.jsx("div",{className:"mt-0",children:s!=null&&s.status?e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded bg-blue-100 text-blue-800 ring-1 ring-blue-200 text-[12px] font-semibold",children:s.status}):e.jsx("span",{className:"text-[12px] font-semibold text-blue-900/80",children:"-"})})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Publication Date"}),e.jsx("div",{className:"mt-0 text-[12px] font-semibold text-slate-900",children:s.created_at?new Date(s.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"Not Available"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:col-span-2 lg:col-span-4 xl:col-span-1 2xl:col-span-6",children:[e.jsxs("div",{className:"flex-1 p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Nearby"}),e.jsx("div",{className:"mt-0.5 text-[12px] text-slate-800",children:(p=s.nearby_places)!=null&&p.length?e.jsx("div",{className:"flex flex-wrap gap-1",children:s.nearby_places.map((F,T)=>e.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-slate-700",children:e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(la,{className:"w-3.5 h-3.5 text-slate-700"}),F.type||""," ",F.distance?` â€“ ${F.distance} ${F.unit||""}`:"","  ",F.name||""]})},T))}):e.jsx("span",{className:"text-[12px] font-semibold text-slate-800/80",children:"Not Available"})})]}),e.jsxs("div",{className:"flex-1 p-2 rounded-md bg-slate-50 ring-1 ring-slate-100",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Address"}),e.jsx("div",{className:"mt-0.5 text-[12px] text-slate-800 whitespace-pre-line",children:(s==null?void 0:s.address)||"Not Available"})]})]}),e.jsxs("div",{className:"p-2 rounded-md bg-slate-50 ring-1 ring-slate-100 sm:col-span-2 lg:col-span-2 xl:col-span-2 2xl:col-span-6",children:[e.jsx("div",{className:"text-[10px] font-medium text-slate-500",children:"Description"}),e.jsx("div",{className:"mt-0.5 text-[12px] text-slate-800 whitespace-pre-line",children:(s==null?void 0:s.description)||"Not Available"})]})]})]})]}),e.jsxs("div",{className:"w-full xl:w-80 2xl:w-96 shrink-0 flex flex-col gap-4 xl:sticky xl:top-0 xl:h-fit xl:max-h-screen xl:overflow-y-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Seller Information"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"text-gray-400",size:16}),e.jsx("span",{className:"font-medium",children:((N=s.seller)==null?void 0:N.name)||"Not Available"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"text-gray-400",size:16}),(P=s.seller)!=null&&P.phone?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"truncate",children:s.seller.phone}),e.jsx("button",{onClick:()=>window.open(`tel:${s.seller.phone}`),className:"ml-auto p-1 text-blue-600 hover:bg-blue-100 rounded","aria-label":"Call seller"})]}):e.jsx("span",{className:"text-gray-500",children:"Not Available"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"text-gray-400",size:16}),(w=s.seller)!=null&&w.email?e.jsx("span",{className:"truncate",children:s.seller.email}):e.jsx("span",{className:"text-gray-500",children:"Not Available"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"text-gray-400",size:16}),e.jsx("span",{className:"truncate",children:s!=null&&s.location&&(s!=null&&s.city)?`${s.location}, ${s.city}`:"Not Available"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Executive Information"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ms,{className:"text-gray-400",size:16}),e.jsx("span",{className:"font-medium",children:(($=s.assignedTo)==null?void 0:$.name)||"Not Available"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"text-gray-400",size:16}),(y=s.assignedTo)!=null&&y.phone?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"truncate",children:s.assignedTo.phone}),e.jsx("button",{onClick:()=>window.open(`tel:${s.assignedTo.phone}`),className:"ml-auto p-1 text-blue-600 hover:bg-blue-100 rounded","aria-label":"Call seller"})]}):e.jsx("span",{className:"text-gray-500",children:"Not Available"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"text-gray-400",size:16}),(k=s.assignedTo)!=null&&k.email?e.jsx("span",{className:"truncate",children:s.assignedTo.email}):e.jsx("span",{className:"text-gray-500",children:"Not Available"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-3 py-2 border border-blue-200 rounded-lg text-blue-600 hover:bg-blue-50 transition",children:[e.jsx(ja,{size:16}),"Share"]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 border border-green-200 rounded-lg text-green-600 hover:bg-green-50 transition",children:[e.jsx(tt,{size:16}),"Message"]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 border border-purple-200 rounded-lg text-purple-600 hover:bg-purple-50 transition",children:[e.jsx(Ts,{size:16}),"Schedule"]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 border border-red-200 rounded-lg text-red-600 hover:bg-red-50 transition",children:[e.jsx(wu,{size:16}),"Mark Hot"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Key Dates"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Purchase"}),e.jsxs("span",{className:"font-medium",children:[x(s==null?void 0:s.purchaseMonth)," ",(s==null?void 0:s.purchaseYear)||"-"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Possession"}),e.jsxs("span",{className:"font-medium",children:[x(s==null?void 0:s.possessionMonth)," ",(s==null?void 0:s.possessionYear)||"-"]})]})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Amenities"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-2 2xl:grid-cols-3 gap-2",children:(()=>{const F=Array.isArray(s.amenities)?s.amenities:(s.amenities??"").split(",").map(T=>T.trim()).filter(Boolean);return F.length?F.map((T,j)=>e.jsx(zu,{name:T},j)):e.jsx("span",{className:"text-sm text-gray-500",children:"No amenities listed"})})()})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Furnishing Items"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-2 2xl:grid-cols-3 gap-2",children:(R=s.furnishingItems)!=null&&R.length?s.furnishingItems.map((F,T)=>e.jsx(Ru,{name:F},T)):e.jsx("span",{className:"text-sm text-gray-500",children:"No furnishing items listed"})})]})]}),d&&(()=>{var B,M,A,L;const T=[(s==null?void 0:s.type)??"",(s==null?void 0:s.unitType)??"",(s==null?void 0:s.subtype)??""].map(D=>(D||"").toString().trim()).filter(Boolean),j=T.length?T.join(" "):(s==null?void 0:s.title)||"Property Listing",E=s!=null&&s.description&&s.description!==""?s.description:((B=s==null?void 0:s.raw)==null?void 0:B.description)??((M=s==null?void 0:s.raw)==null?void 0:M.short_description)??"",V=Array.isArray(s==null?void 0:s.images)&&s.images[0]||Array.isArray(s==null?void 0:s.photos)&&s.photos[0]||((A=s==null?void 0:s.raw)==null?void 0:A.image)||((L=s==null?void 0:s.raw)==null?void 0:L.photo)||"",W=gj(s);return e.jsx(xn,{url:W,title:j,description:E,image:V,propertyId:s.id,slug:`${s.id}-${Tc(s.slug||j)}`,onClose:()=>v(!1)})})()]})},fj=s=>{if(s==null||s==="")return 0;if(typeof s=="number")return s;const a=Number(String(s).replace(/[^\d.-]/g,""));return Number.isNaN(a)?0:a},Yo=s=>{const a=fj(s);return a>=1e7?`â‚¹${(a/1e7).toFixed(1)}Cr`:a>=1e5?`â‚¹${(a/1e5).toFixed(1)}L`:`â‚¹${a.toLocaleString("en-IN")}`},yj=[{id:1,name:"Amit Sharma",phone:"+91 98765 43210",email:"amit.sharma@email.com",budget:25e5,requirements:["3BHK","Andheri West","Furnished"],status:"hot",rating:5,lastVisit:"2025-01-10",feedback:"Very interested, wants to visit again with family",nextFollowup:"2025-01-15",leadSource:"Website",visitCount:3},{id:2,name:"Priya Patel",phone:"+91 87654 32109",email:"priya.patel@email.com",budget:22e5,requirements:["2BHK","Mumbai","Semi-Furnished"],status:"warm",rating:4,lastVisit:"2025-01-08",feedback:"Liked the property but concerned about price",nextFollowup:"2025-01-14",leadSource:"Referral",visitCount:2},{id:3,name:"Rajesh Kumar",phone:"+91 76543 21098",email:"rajesh.kumar@email.com",budget:28e5,requirements:["3BHK","Good Location","Parking"],status:"cold",rating:3,lastVisit:"2025-01-05",feedback:"Still exploring options",nextFollowup:"2025-01-20",leadSource:"Social Media",visitCount:1}],jj=({isOpen:s,onClose:a,property:t})=>{const[r,i]=l.useState(""),[n,o]=l.useState("all"),[m]=l.useState(yj);l.useEffect(()=>{s&&(i(""),o("all"))},[s]);const g=l.useMemo(()=>m.filter(c=>{const f=r.trim().toLowerCase(),p=!f||c.name.toLowerCase().includes(f)||c.phone.replace(/\D/g,"").includes(f.replace(/\D/g,""))||c.email.toLowerCase().includes(f),N=n==="all"||c.status===n;return p&&N}),[m,r,n]),b=c=>{const f={hot:{bg:"bg-red-100",text:"text-red-700",label:"Hot Lead",icon:"ðŸ”¥"},warm:{bg:"bg-orange-100",text:"text-orange-700",label:"Warm Lead",icon:"ðŸŸ¡"},cold:{bg:"bg-blue-100",text:"text-blue-700",label:"Cold Lead",icon:"ðŸ”µ"}},p=f[c]??f.cold;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p.bg} ${p.text}`,children:[e.jsx("span",{className:"mr-1",children:p.icon}),p.label]})},d=c=>{const f=c.phone.replace(/[^0-9]/g,""),p=`Hi ${c.name}, I have a property that matches your requirements. Property: ${(t==null?void 0:t.title)??""} at ${(t==null?void 0:t.location)??""}. Budget: ${Yo(t==null?void 0:t.budget)}. Would you like to schedule a visit?`,N=`https://wa.me/${f}?text=${encodeURIComponent(p)}`;window.open(N,"_blank","noopener,noreferrer")},v=c=>{const f=`Property Match - ${(t==null?void 0:t.title)??""}`,p=`Dear ${c.name},

I hope this email finds you well.

I have a property that matches your requirements:

Property: ${(t==null?void 0:t.title)??""}
Location: ${(t==null?void 0:t.location)??""}
Budget: ${Yo(t==null?void 0:t.budget)}
Type: ${(t==null?void 0:t.unitType)??""}

Would you like to schedule a visit?

Best regards,
Resale Expert Team`,N=`mailto:${c.email}?subject=${encodeURIComponent(f)}&body=${encodeURIComponent(p)}`;window.open(N,"_blank","noopener,noreferrer")},x=c=>{window.alert(`Visit scheduled for ${c.name}. They will be notified.`)},u=c=>Array.from({length:5}).map((f,p)=>e.jsx(Xs,{size:12,className:p<c?"text-yellow-400":"text-gray-300"},p));return s?e.jsx(ma,{isOpen:s,onClose:a,title:"Interested Buyers",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search buyers...",value:r,onChange:c=>i(c.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("select",{value:n,onChange:c=>o(c.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"hot",children:"Hot Leads"}),e.jsx("option",{value:"warm",children:"Warm Leads"}),e.jsx("option",{value:"cold",children:"Cold Leads"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:m.filter(c=>c.status==="hot").length}),e.jsx("div",{className:"text-sm text-red-700",children:"Hot Leads"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.filter(c=>c.status==="warm").length}),e.jsx("div",{className:"text-sm text-orange-700",children:"Warm Leads"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.filter(c=>c.status==="cold").length}),e.jsx("div",{className:"text-sm text-blue-700",children:"Cold Leads"})]})]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:g.map(c=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:c.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:c.name}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Cs,{size:12}),e.jsx("span",{children:c.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Ds,{size:12}),e.jsx("span",{children:c.email})]})]})]}),e.jsxs("div",{className:"text-right",children:[b(c.status),e.jsx("div",{className:"text-sm font-semibold text-green-600 mt-1",children:Yo(c.budget)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Requirements"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:c.requirements.map((f,p)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs",children:f},p))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Rating & Visits"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center space-x-1",children:u(c.rating)}),e.jsxs("span",{className:"text-xs text-gray-600",children:["(",c.visitCount??0," visits)"]})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Last Visit Feedback"}),e.jsx("p",{className:"text-sm text-gray-700",children:c.feedback})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ls,{size:10}),e.jsxs("span",{children:["Last visit: ",c.lastVisit]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{size:10}),e.jsxs("span",{children:["Follow-up: ",c.nextFollowup]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>d(c),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"WhatsApp",type:"button",children:e.jsx(tt,{size:14})}),e.jsx("button",{onClick:()=>v(c),className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",title:"Email",type:"button",children:e.jsx(Ds,{size:14})}),e.jsx("button",{onClick:()=>x(c),className:"p-2 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200 transition-colors",title:"Schedule Visit",type:"button",children:e.jsx(Ts,{size:14})})]})]})]},c.id))}),g.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ms,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-500",children:"No buyers found matching your criteria"})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:e.jsx(ss,{variant:"outline",onClick:a,children:"Close"})})]})}):null},vj=1e7,Nj=1e5;function wj(s){const a=(s||"").trim().toLowerCase();if(!a)return 0;const t=a.replace(/â‚¹/g,"").replace(/\s+/g,""),r=t.replace(/,/g,"");if(/^\d+$/.test(r))return parseInt(r,10)||0;const i=t.match(/^([\d,.]+)\s*l/);if(i)return Math.round(parseFloat(i[1].replace(/,/g,""))*Nj)||0;const n=t.match(/^([\d,.]+)\s*(cr|c)/);if(n)return Math.round(parseFloat(n[1].replace(/,/g,""))*vj)||0;const o=parseFloat(r);return Number.isNaN(o)?0:Math.round(o)}const Bm=s=>{const a=wj(String(s??""));return a?String(a):""},_j=s=>new Promise(a=>setTimeout(a,s)),Sj=s=>String(s||"").trim().toLowerCase().replace(/[._\-()/]/g," ").replace(/\s+/g," ").trim(),Om=s=>{const a=String(s??"").trim();if(!a)return"";const t=Number(a.replace(/,/g,""));return Number.isFinite(t)?t:""},vn=s=>{const a=String(s??"").trim();if(!a)return"";const t=parseInt(a.replace(/,/g,""),10);return Number.isFinite(t)?t:""},Um=s=>{const a=String(s??"").trim().toLowerCase();if(!a)return"";const r=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"].findIndex(n=>a.startsWith(n));if(r>=0)return String(r+1);const i=parseInt(a,10);return i>=1&&i<=12?String(i):""};function qm(s){const a=String(s??"").trim();if(!a)return[];try{const t=JSON.parse(a);if(Array.isArray(t))return t;if(typeof t=="string"&&t)return[t]}catch{return a.split(/[,;|]/).map(t=>t.trim()).filter(Boolean)}return[]}const Bl={"property type":"propertyType","property subtype":"propertySubtype","unit type":"unitType",wing:"wing","unit no":"unitNo",furnishing:"furnishing",bedrooms:"bedrooms",bathrooms:"bathrooms",facing:"facing","parking type":"parkingType","parking qty":"parkingQty",city:"city",location:"location","society name":"societyName",floor:"floor","total floors":"totalFloors","carpet area":"carpetArea","carpet area sq ft":"carpetArea","carpet area sqft":"carpetArea","builtup area":"builtupArea",budget:"budget","price type":"priceType","final price":"finalPrice",address:"address",status:"status","possession month":"possessionMonth","possession year":"possessionYear","purchase month":"purchaseMonth","purchase year":"purchaseYear","selling rights":"sellingRights",amenities:"amenities","furnishing items":"furnishingItems",description:"description","seller name":"seller",seller:"seller","property type name":"propertyType","property subtype name":"propertySubtype","unit no.":"unitNo",property_type_name:"propertyType",property_subtype_name:"propertySubtype",unit_type:"unitType",unit_no:"unitNo",furnishing_items:"furnishingItems","furnishing item":"furnishingItems",city_name:"city",location_name:"location",society_name:"societyName",parking_type:"parkingType",parking_qty:"parkingQty",carpet_area:"carpetArea",builtup_area:"builtupArea",price_type:"priceType",final_price:"finalPrice",lead_source:"leadSource",possession_month:"possessionMonth",possession_year:"possessionYear",purchase_month:"purchaseMonth",purchase_year:"purchaseYear",selling_rights:"sellingRights"},Vm={"property t":"property type","property s":"property subtype","unit ty":"unit type","unit t":"unit type","parking ty":"parking type","carpet are":"carpet area","society na":"society name","seller na":"seller name"};function kj(s){const a=Sj(s);if(Bl[a])return Bl[a];const t=Object.keys(Vm).find(o=>a.startsWith(o));if(t){const o=Vm[t];return Bl[o]}const r=Object.keys(Bl),i=r.find(o=>o.startsWith(a));if(i)return Bl[i];const n=r.find(o=>a.startsWith(o));if(n)return Bl[n]}const Cj=({isOpen:s,onClose:a,onDone:t,onImport:r})=>{const[i,n]=l.useState(!1),[o,m]=l.useState(null),[g,b]=l.useState(!1),[d,v]=l.useState([]),[x,u]=l.useState([]),[c,f]=l.useState(!1),[p,N]=l.useState(!1),[P,w]=l.useState({total:0,done:0,ok:0,fail:0}),$=l.useRef({abort:!1});if(!s)return null;const y=q=>{q.preventDefault(),q.stopPropagation(),(q.type==="dragenter"||q.type==="dragleave"||q.type==="dragover")&&n(q.type!=="dragleave")},k=q=>{q.preventDefault(),q.stopPropagation(),n(!1),q.dataTransfer.files&&q.dataTransfer.files[0]&&F(q.dataTransfer.files[0])},R=q=>{q.target.files&&q.target.files[0]&&F(q.target.files[0])},F=q=>{const ne=q.name.toLowerCase();if(!(ne.endsWith(".csv")||ne.endsWith(".xlsx")||ne.endsWith(".xls")))return alert("Please select a CSV or Excel (.xlsx/.xls) file");m(q),V(q)},T=async q=>new Promise((ne,le)=>{qh.parse(q,{header:!0,skipEmptyLines:!0,complete:S=>ne(S.data),error:S=>le(S)})}),j=async q=>{const ne=await q.arrayBuffer(),le=Vh(ne),S=le.Sheets[le.SheetNames[0]];return ei.sheet_to_json(S,{defval:""})},E=(q,ne)=>{const le={};for(const[ue,Q]of Object.entries(q)){const he=kj(ue);he&&(le[he]=Q)}const S={seller:(le.seller??"").toString().trim(),propertyType:(le.propertyType??"").toString().trim(),propertySubtype:(le.propertySubtype??"").toString().trim(),unitType:(le.unitType??"").toString().trim(),wing:(le.wing??"").toString().trim(),unitNo:(le.unitNo??"").toString().trim(),furnishing:(le.furnishing??"").toString().trim(),bedrooms:vn(le.bedrooms),bathrooms:vn(le.bathrooms),facing:(le.facing??"").toString().trim(),parkingType:(le.parkingType??"").toString().trim(),parkingQty:vn(le.parkingQty),city:(le.city??"").toString().trim(),location:(le.location??"").toString().trim(),societyName:(le.societyName??"").toString().trim(),floor:(le.floor??"").toString().trim(),totalFloors:(le.totalFloors??"").toString().trim(),carpetArea:Om(le.carpetArea),builtupArea:Om(le.builtupArea),budget:Bm(le.budget),priceType:(()=>{const ue=String(le.priceType??"").trim();return ue?/neg/i.test(ue)?"Negotiable":"Fixed":""})(),finalPrice:Bm(le.finalPrice),address:(le.address??"").toString().trim(),status:(le.status??"").toString().trim(),leadSource:(le.leadSource??"").toString().trim(),possessionMonth:Um(le.possessionMonth),possessionYear:vn(le.possessionYear),purchaseMonth:Um(le.purchaseMonth),purchaseYear:vn(le.purchaseYear),sellingRights:(le.sellingRights??"").toString().trim(),amenities:qm(le.amenities),furnishingItems:qm(le.furnishingItems),description:(le.description??"").toString().trim()},C=[],J=[["propertyType","Property Type is required",ue=>!!String(ue||"").trim()],["propertySubtype","Property Subtype is required",ue=>!!String(ue||"").trim()],["unitType","Unit Type is required",ue=>!!String(ue||"").trim()],["city","City is required",ue=>!!String(ue||"").trim()],["location","Location is required",ue=>!!String(ue||"").trim()],["societyName","Society Name is required",ue=>!!String(ue||"").trim()],["carpetArea","Carpet Area is required",ue=>ue!==""&&Number.isFinite(Number(ue))&&Number(ue)>=0]];for(const[ue,Q,he]of J)he(S[ue])||C.push(Q);return S.carpetArea!==""&&Number(S.carpetArea)<0&&C.push("Carpet Area < 0?"),S.builtupArea!==""&&Number(S.builtupArea)<0&&C.push("Built-up Area < 0?"),S.finalPrice&&Number(S.finalPrice)<0&&C.push("Final Price < 0?"),S.budget&&Number(S.budget)<0&&C.push("Budget < 0?"),typeof S.possessionYear=="number"&&(S.possessionYear<1900||S.possessionYear>2100)&&C.push("Possession Year looks invalid"),typeof S.purchaseYear=="number"&&(S.purchaseYear<1900||S.purchaseYear>2100)&&C.push("Purchase Year looks invalid"),{...S,__row:ne+1,__errors:C}},V=async q=>{b(!0),u([]),v([]);try{const le=q.name.toLowerCase().endsWith(".csv")?await T(q):await j(q);if(!le.length){u(["No rows found in the file."]);return}const S=le.map((C,J)=>E(C,J));v(S)}catch(ne){u([`Error processing file: ${(ne==null?void 0:ne.message)||ne}`])}finally{b(!1)}},W=q=>q.__errors.filter(ne=>/required/i.test(ne)).length===0,B=l.useMemo(()=>d.filter(W),[d]),M=B.length,A=d.length-M;function L(q){const ne=new FormData,le=new Date,S=String(le.getMonth()+1),C=String(le.getFullYear()),J={seller:q.seller||"",propertyType:q.propertyType||"",propertySubtype:q.propertySubtype||"",unitType:q.unitType||"",wing:q.wing||"",unitNo:q.unitNo||"",furnishing:q.furnishing||"",bedrooms:q.bedrooms===""?"":String(q.bedrooms),bathrooms:q.bathrooms===""?"":String(q.bathrooms),facing:q.facing||"",parkingType:q.parkingType||"",parkingQty:q.parkingQty===""?"":String(q.parkingQty),city:q.city||"",location:q.location||"",society:q.societyName||"",society_name:q.societyName||"",floor:q.floor||"",totalFloors:q.totalFloors||"",carpetArea:q.carpetArea===""?"":String(q.carpetArea),builtupArea:q.builtupArea===""?"":String(q.builtupArea),budget:q.budget||"",priceType:q.priceType||"Fixed",finalPrice:q.finalPrice||"",address:q.address||"",status:q.status||"Available",leadSource:q.leadSource||"",possessionMonth:q.possessionMonth||S,possessionYear:q.possessionYear===""?C:String(q.possessionYear),purchaseMonth:q.purchaseMonth||S,purchaseYear:q.purchaseYear===""?C:String(q.purchaseYear),sellingRights:q.sellingRights||"Standard",description:q.description||""};return Object.entries(J).forEach(([ue,Q])=>ne.append(ue,Q)),ne.append("amenities",JSON.stringify(q.amenities??[])),ne.append("furnishingItems",JSON.stringify(q.furnishingItems??[])),ne.append("nearby_places",JSON.stringify([])),ne}const D=async()=>{if(!d.length)return Z.error("No data to import");if(M===0)return Z.error("No valid rows to import. Fix required fields shown in red headers.");f(!0),N(!1),$.current.abort=!1;const q=B;w({total:q.length,done:0,ok:0,fail:0});const ne=3;let le=0,S=0,C=0;const J=async Q=>{try{const he=L(Q);await As.createProperty(he),S++}catch(he){console.error("Import row error:",{row:Q.__row,error:he}),C++}finally{const he=S+C;w({total:q.length,done:he,ok:S,fail:C})}},ue=[];for(let Q=0;Q<ne;Q++)ue.push((async function(){for(;le<q.length&&!$.current.abort;){if(p){await _j(200);continue}const se=le++;await J(q[se])}})());await Promise.all(ue),f(!1),$.current.abort?Z.info("Import cancelled."):(S&&Z.success(`Imported ${S} properties`),C&&Z.warn(`${C} failed`),A>0&&Z.info(`${A} rows skipped (missing required fields)`),t==null||t({ok:S,fail:C}),r==null||r([]))},I=()=>N(q=>!q),H=()=>{$.current.abort=!0,N(!1)},h=["Property Type","Property Subtype","Unit Type","Wing","Unit No","Furnishing","Bedrooms","Bathrooms","Facing","Parking Type","Parking Qty","City","Location","Society Name","Floor","Total Floors","Carpet Area","Builtup Area","Budget","Price Type","Final Price","Address","Status","Possession Month","Possession Year","Purchase Month","Purchase Year","Selling Rights","Amenities","Furnishing Items","Description","Seller Name"],Y=q=>`"${String(q??"").replace(/"/g,'""')}"`,K=()=>{try{const q={font:{bold:!0,color:{rgb:"FF000000"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"FFDDDDDD"}},bottom:{style:"thin",color:{rgb:"FFDDDDDD"}},left:{style:"thin",color:{rgb:"FFDDDDDD"}},right:{style:"thin",color:{rgb:"FFDDDDDD"}}}},ne={alignment:{vertical:"center"}},C=[h,["Residential","Apartment","2BHK","A","1204","Semi-Furnished","2","2","East","Covered","1","Mumbai","Bandra West","Sea View Towers","12","22","980","1050","18000000","Fixed","","Near Joggers Park","Available","Nov","2025","Jan","2023","Standard",'["Gym","Lift","Security"]','["Wardrobe","Modular Kitchen"]',"Well maintained apartment with sea breeze.","John Doe"],["Residential","Villa","3BHK","","","Fully-Furnished","3","4","North","Open","2","Pune","Koregaon Park","Green Valley","","","2200","2600","35000000","Negotiable","34000000","","Available","12","2025","6","2020","Exclusive","Gym, Pool, Clubhouse","Bed, Sofa, AC","Corner villa with large garden.","Jane Smith"]],J=Xn.utils.aoa_to_sheet(C);J["!cols"]=h.map(he=>({wch:Math.max(12,Math.min(28,he.length+2))}));for(let he=0;he<h.length;he++){const se=ei.encode_cell({r:0,c:he});J[se]&&(J[se].s=q)}const ue=new Set(["property type","property subtype","unit type","city","location","society name","carpet area"]);for(let he=0;he<h.length;he++){const se=h[he];if(ue.has(se.toLowerCase())){const ge=ei.encode_cell({r:0,c:he});if(!J[ge])continue;J[ge].s={...q,font:{...q.font,color:{rgb:"FFFF0000"}}}}}for(let he=1;he<C.length;he++)for(let se=0;se<C[he].length;se++){const ge=ei.encode_cell({r:he,c:se});J[ge]&&(J[ge].s=ne)}const Q=Xn.utils.book_new();Xn.utils.book_append_sheet(Q,J,"Properties Template"),Xn.writeFile(Q,"properties_template.xlsx")}catch(q){console.warn("xlsx-js-style failed; falling back to CSV",q);const ne=h.map(Y).join(","),le=["Residential","Apartment","2BHK","A","1204","Semi-Furnished","2","2","East","Covered","1","Mumbai","Bandra West","Sea View Towers","12","22","980","1050","18000000","Fixed","","Near Joggers Park","Available","Nov","2025","Jan","2023","Standard",'["Gym","Lift","Security"]','["Wardrobe","Modular Kitchen"]',"Well maintained apartment with sea breeze.","John Doe"].map(Y).join(","),S=["Residential","Villa","3BHK","","","Fully-Furnished","3","4","North","Open","2","Pune","Koregaon Park","Green Valley","","","2200","2600","35000000","Negotiable","34000000","","Available","12","2025","6","2020","Exclusive","Gym, Pool, Clubhouse","Bed, Sofa, AC","Corner villa with large garden.","Jane Smith"].map(Y).join(","),C=`${ne}
${le}
${S}`,J=new Blob([C],{type:"text/csv;charset=utf-8"}),ue=window.URL.createObjectURL(J),Q=document.createElement("a");Q.href=ue,Q.download="properties_template.csv",Q.click(),window.URL.revokeObjectURL(ue)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"px-6 py-2 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Import Properties (Bulk)"})}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsx("div",{className:"mb-6 bg-blue-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"min-w-0",children:e.jsx("h3",{className:"font-semibold text-blue-900",children:"Download Template"})}),e.jsxs("button",{onClick:K,className:"flex-shrink-0 flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Download Template"})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:`relative border-2 border-dashed rounded-xl p-8 text-center transition-colors ${i?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:y,onDragLeave:y,onDragOver:y,onDrop:k,children:[e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:R,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(dt,{className:"text-gray-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:o?o.name:"Drop your file here, or click to browse"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"CSV/XLSX, max 10MB"})]})]})]})}),g&&e.jsx("div",{className:"mb-6 bg-yellow-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-yellow-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900",children:"Processing file..."}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Parsing & validating your data"})]})]})}),x.length>0&&e.jsx("div",{className:"mb-6 bg-red-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ct,{className:"text-red-600 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900",children:"Import Errors"}),e.jsx("ul",{className:"text-sm text-red-700 mt-1 space-y-1",children:x.map((q,ne)=>e.jsxs("li",{children:["â€¢ ",q]},ne))})]})]})}),d.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Preview (",d.length," rows)"]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 text-green-700 font-semibold",children:[e.jsx(bs,{size:14})," ",M," ready"]}),e.jsxs("span",{className:"text-red-600 font-semibold",children:[A," invalid"]})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 max-h-64 overflow-y-auto",children:e.jsxs("div",{className:"space-y-2",children:[d.slice(0,30).map(q=>{const ne=W(q);return e.jsxs("div",{className:`rounded-lg p-3 border ${ne?"bg-white":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2 text-sm",children:[e.jsxs("div",{className:"font-medium",children:[q.propertyType||"-"," â€¢ ",q.propertySubtype||"-"," â€¢ ",q.unitType||"-"]}),e.jsxs("div",{className:"text-gray-600",children:[q.city||"-",q.location?`, ${q.location}`:""," â€¢ ",q.societyName||"-"]}),e.jsxs("div",{className:"text-gray-600",children:[q.furnishing||"-",q.parkingType?` â€¢ ${q.parkingType}`:"",q.parkingQty!==""?` x${q.parkingQty}`:""]}),e.jsxs("div",{className:"text-gray-600",children:[q.carpetArea!==""?`${q.carpetArea} sq.ft`:"-",q.bedrooms!==""?` â€¢ ${q.bedrooms} BR`:"",q.bathrooms!==""?`/${q.bathrooms} Bath`:""]}),e.jsxs("div",{className:"text-green-700 font-semibold",children:["â‚¹ ",Number(q.budget||0).toLocaleString("en-IN"),q.priceType?` â€¢ ${q.priceType}`:""]})]}),e.jsxs("div",{className:"text-xs mt-1",children:[e.jsxs("span",{className:"text-gray-500",children:[q.status||"Available",q.seller?` â€¢ Seller: ${q.seller}`:""]}),q.__errors.length>0&&e.jsx("ul",{className:"mt-1 text-red-600 list-disc list-inside",children:q.__errors.map((le,S)=>e.jsx("li",{children:le},S))})]}),q.description?e.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:q.description}):null]},q.__row)}),d.length>30&&e.jsxs("div",{className:"text-center text-gray-500 text-sm",children:["... and ",d.length-30," more rows"]})]})})]}),d.length>0&&e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-4 py-2 rounded-xl border",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Ready to import: ",e.jsx("b",{children:M})," rows"," ",A?e.jsxs("span",{className:"text-red-600",children:["(",A," invalid)"]}):null]}),e.jsx("div",{className:"flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg",children:[p?e.jsx(_l,{size:16}):e.jsx(Nu,{size:16}),p?"Resume":"Pause"]}),e.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-3 py-2 bg-red-600 text-white rounded-lg",children:[e.jsx(yh,{size:16})," Cancel"]})]}):e.jsxs("button",{onClick:D,disabled:!M,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg disabled:opacity-50",children:[e.jsx(yt,{size:16})," Import ",M]})})]}),c&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all",style:{width:P.total?`${P.done/P.total*100}%`:"0%"}})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[P.done,"/",P.total," â€¢ ",e.jsxs("span",{className:"text-green-700",children:["OK: ",P.ok]})," â€¢"," ",e.jsxs("span",{className:"text-red-600",children:["Fail: ",P.fail]})]})]})]}),e.jsx("div",{className:"px-6 py-2 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:d.length?`${d.length} rows loaded`:"No file selected"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),d.length>0&&!c&&M>0&&e.jsxs("button",{onClick:D,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(yt,{size:16}),e.jsxs("span",{children:["Import ",M," Properties"]})]})]})]})})]})})},Aj="https://investordeal.in/api/",Wm=(()=>{try{const s=new URL(Aj),a=s.pathname.replace(/\/api\/?$/,"").replace(/\/+$/,"");return s.pathname=a||"/",s.search="",s.hash="",typeof window<"u"&&window.location.protocol==="https:"&&s.protocol!=="https:"&&(s.protocol="https:"),s.origin+(s.pathname.endsWith("/")?s.pathname.slice(0,-1):s.pathname)}catch{return typeof window<"u"?window.location.origin:"https://investordeal.in"}})();function rg(s){if(!s)return null;const a=String(s).replace(/\\/g,"/").trim();if(/^https?:\/\//i.test(a))return typeof window<"u"&&window.location.protocol==="https:"?a.replace(/^http:\/\//i,"https://"):a;if(/^\/\//.test(a))return(typeof window<"u"&&window.location.protocol==="https:"?"https:":"http:")+a;if(a.startsWith("/uploads")||a.startsWith("/public"))return(typeof window<"u"?window.location.origin:Wm)+a;const t=a.startsWith("/")?a:`/${a}`;return(typeof window<"u"?window.location.origin:Wm)+t}const Pj=[{label:"Newest â†’ Oldest",value:"created_desc"},{label:"Oldest â†’ Newest",value:"created_asc"},{label:"Price: Low â†’ High",value:"price_asc"},{label:"Price: High â†’ Low",value:"price_desc"}],Tj=({isOpen:s,onClose:a,filters:t,setFilters:r,clearFilters:i,typeOptions:n,statusOptions:o,priceRangeOptions:m,locationOptions:g,sellerOptions:b,stageOptions:d,tagsOptions:v,executiveOptions:x=[],executivesLoading:u=!1})=>{if(l.useEffect(()=>{const p=N=>N.key==="Escape"&&a();return s&&document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[s,a]),l.useEffect(()=>{t!=null&&t.ignoreDate&&(t.dateFrom||t.dateTo)&&r({...t,dateFrom:"",dateTo:""})},[t==null?void 0:t.ignoreDate]),typeof window>"u")return null;const c=p=>r({...t||{},...p}),f=[{label:"All executives",value:"all"},...x||[],{label:"Unassigned",value:"__unassigned__"}];return Il.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300 
        ${s?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),e.jsxs("div",{className:`fixed top-0 right-0 h-full bg-gradient-to-b from-indigo-50 via-white to-purple-50 
        shadow-2xl w-full sm:w-[400px] transform transition-transform duration-300 ease-out
        ${s?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-indigo-500 to-purple-500 text-white",children:[e.jsx("h3",{className:"text-sm font-semibold tracking-wide",children:"Property Filters"}),e.jsx("button",{onClick:a,className:"p-1 rounded-full bg-white/20 hover:bg-white/30 transition",children:e.jsx(ns,{size:18})})]}),e.jsxs("div",{className:"p-4 overflow-y-auto h-[calc(100%-56px)] text-xs space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsx(da,{options:[{label:"All Types",value:"all"},...n],value:t.type??"all",onChange:p=>c({type:p}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Status"}),e.jsx(da,{options:[{label:"All Status",value:"all"},...o],value:t.status??"all",onChange:p=>c({status:p}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Price Range"}),e.jsx(da,{options:[{label:"Any",value:"all"},...m],value:t.priceRange??"all",onChange:p=>c({priceRange:p}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Location"}),e.jsx(da,{options:[{label:"All Locations",value:"all"},...g],value:t.location??"all",onChange:p=>c({location:p}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Seller / Owner"}),e.jsx(da,{options:[{label:"Any Seller",value:"all"},...b],value:t.seller??"all",onChange:p=>c({seller:p}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Stage"}),e.jsx(da,{options:[{label:"All Stages",value:"all"},...d],value:t.stage??"all",onChange:p=>c({stage:p}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Tags"}),e.jsx(da,{options:[{label:"Any Tag",value:"all"},...v],value:t.tags??"all",onChange:p=>c({tags:p}),triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Visibility"}),e.jsx(da,{options:[{label:"All",value:"all"},{label:"Public",value:"public"},{label:"Private",value:"private"}],value:t.isPublic===void 0?"all":t.isPublic?"public":"private",onChange:p=>{c(p==="all"?{isPublic:void 0}:{isPublic:p==="public"})},triggerClassName:"w-full text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Min Budget (â‚¹)"}),e.jsx(wr,{type:"number",value:t.minBudget||"",onChange:p=>c({minBudget:p.target.value}),placeholder:"e.g. 500000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Max Budget (â‚¹)"}),e.jsx(wr,{type:"number",value:t.maxBudget||"",onChange:p=>c({maxBudget:p.target.value}),placeholder:"e.g. 25000000"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Executive"}),e.jsx(da,{options:f,value:t.assignedExecutive??"all",onChange:p=>c({assignedExecutive:p}),triggerClassName:"w-full text-xs",disabled:u})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Sort"}),e.jsx(da,{options:Pj,value:t.sortOrder??"created_desc",onChange:p=>c({sortOrder:p}),triggerClassName:"w-full text-xs"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{id:"propIgnoreDate",type:"checkbox",checked:!!t.ignoreDate,onChange:p=>c({ignoreDate:p.target.checked}),className:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"propIgnoreDate",className:"text-gray-700",children:"Ignore Date Filters"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx(wr,{type:"date",value:t.dateFrom||"",onChange:p=>c({dateFrom:p.target.value}),disabled:!!t.ignoreDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx(wr,{type:"date",value:t.dateTo||"",onChange:p=>c({dateTo:p.target.value}),disabled:!!t.ignoreDate})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(ss,{variant:"outline",onClick:()=>{i(),r({type:"all",status:"all",priceRange:"all",location:"all",seller:"all",stage:"all",tags:"all",isPublic:void 0,ignoreDate:!1,dateFrom:"",dateTo:"",sortOrder:"created_desc",minBudget:"",maxBudget:"",assignedExecutive:"all"})},className:"flex-1 text-xs border-red-400 text-red-500 hover:bg-red-50",children:"Clear All"}),e.jsx(ss,{onClick:a,className:"flex-1 text-xs bg-indigo-500 hover:bg-indigo-600 text-white shadow-md",children:"Apply"})]})]})]})]}),document.body)},xd=s=>{if(s==null||s==="")return 0;if(typeof s=="number")return isFinite(s)?s:0;let a=String(s).trim().toLowerCase();if(!a)return 0;let t=1;/(^|[^a-z])cr\.?(ore(s)?)?($|[^a-z])/.test(a)?t=1e7:/(^|[^a-z])(l|lac|lakh|lakhs)($|[^a-z])/.test(a)?t=1e5:/(^|[^a-z])(k|thousand)($|[^a-z])/.test(a)&&(t=1e3);const r=a.replace(/[â‚¹,\s]/g,"").match(/-?\d+(\.\d+)?/),i=r?parseFloat(r[0]):NaN;return isFinite(i)?(/^\s*-/.test(String(s))?-1:1)*i*t:0},Ij=s=>{if(!s)return 1;const a=String(s).trim().toLowerCase();return a==="cr"||a.startsWith("crore")?1e7:a==="l"||a==="lac"||a.startsWith("lakh")?1e5:a==="k"||a.startsWith("thousand")?1e3:1},Hm=(s,a)=>{const t=xd(s);if((typeof s=="number"||typeof s=="string"&&/^[\s-]*\d+(\.\d+)?\s*$/.test(s))&&t<1e5&&a){const i=typeof s=="number"?s:parseFloat(String(s)),n=Ij(a);if(isFinite(i)&&n>1)return i*n}return t},Ym=s=>{const a=xd(s),t=Math.abs(a),r=a<0?"-":"",i=n=>n.toFixed(1).replace(/\.0$/,"");return t>=1e7?`${r}â‚¹${i(t/1e7)} Cr`:t>=1e5?`${r}â‚¹${i(t/1e5)} L`:`${r}â‚¹${Math.round(t).toLocaleString("en-IN")}`},hi=s=>s==null||typeof s=="string"&&s.trim()===""?"â€”":s,lg=s=>[s==null?void 0:s.type,s==null?void 0:s.unitType,s==null?void 0:s.subtype].map(t=>(t??"").toString().trim()).filter(Boolean).join(" ").replace(/\s{2,}/g," ").trim()||"Property",Dr=(...s)=>s.map(a=>typeof a=="string"?a:a==null?"":String(a)).map(a=>a.trim()).find(a=>!!a)||"",$j=s=>{const a=s.split(",").map(t=>t.trim()).filter(Boolean);if(a.length>=2){const t=a[a.length-1];return{primary:a.slice(0,a.length-1).join(", "),city:t}}return{primary:s.trim(),city:""}},Ej=s=>{var u,c;const a=Dr(s.type,s.property_type_name,s.propertyType,s.property_type),t=Dr(s.unitType,s.unit_type,s.unitTypeName),r=Dr(s.subtype,s.property_subtype_name,s.propertySubtype);let i=Dr(s.locationNormalized,s.location_normalized,s.normalized_location),n=Dr(s.location,s.location_name,s.location_name,s.locality,s.area,s.neighbourhood,(u=s.address)==null?void 0:u.line1,s.address_line1),o=Dr(s.city,s.city_name,s.town,(c=s.address)==null?void 0:c.city,s.address_city);if(!i){const f=n||"";f&&o?i=`${f}, ${o}`.replace(/\s{2,}/g," ").trim():i=f||o||""}if(!o&&i){const{primary:f,city:p}=$j(i);p&&(o=p,n||(n=f))}const m=s.id??s.propertyId??s.property_id,g=s.propertyId??s.property_id??s.id,b=Dr(s.slug,s.seo_slug),d=Array.isArray(s.images)?s.images:Array.isArray(s.photos)?s.photos:[],v=Array.isArray(s.furnishingItems)?s.furnishingItems:Array.isArray(s.furnishing_items)?s.furnishing_items:[],x=Dr(s.furnishing,s.furnishing_level,s.furnishing_status)||null;return{...s,id:m,propertyId:g,slug:b,type:a,unitType:t,subtype:r,unit_type:s.unit_type??null,property_type_name:s.property_type_name??null,property_subtype_name:s.property_subtype_name??null,price:s.price??s.final_price??s.budget??null,final_price:s.final_price??null,price_type:s.price_type??null,location:n,locationNormalized:i,location_name:s.location_name??null,city:o,carpet_area:s.carpet_area??s.square_feet??s.carpetArea??null,square_feet:s.square_feet??null,area:s.area??null,floor:s.floor??null,total_floors:s.total_floors??s.totalFloors??null,parking_type:s.parking_type??s.parking??null,parking_qty:s.parking_qty??null,unit_no:s.unit_no??s.unitNo??null,images:d,furnishing:x,furnishingItems:v,amenities:Array.isArray(s.amenities)?s.amenities:s.amenities?[s.amenities]:[],agent:s.agent??{name:s.agent_name??s.seller_name??"",phone:s.agent_phone??s.seller_phone??""}}},ng=s=>{const a=(s==null?void 0:s.locationNormalized)||(s==null?void 0:s.location)||"",t=(s==null?void 0:s.city)||"",r=a.trim(),i=t.trim();return!r&&!i?"":r?!i||r.toLowerCase().includes(i.toLowerCase())?r:`${r}, ${i}`:i},Mj=({p:s,publicBaseUrl:a,includeKeys:t})=>{var p,N;if(!s)return e.jsx("div",{className:"text-sm text-gray-500",children:"Nothing selected."});const i=((s==null?void 0:s.images)||(s==null?void 0:s.photos)||[])[0]||"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=400",n=(s==null?void 0:s.price)??(s==null?void 0:s.final_price)??(s==null?void 0:s.budget),o=Hm(n,s==null?void 0:s.price_type),m=(s==null?void 0:s.square_feet)??(s==null?void 0:s.carpet_area),g=xd(m),b=o&&g?Math.round(o/Math.max(1,g)):null,d=(s==null?void 0:s.propertyId)??(s==null?void 0:s.id),v=lg(s),x=ng(s),u=(a||"").replace(/\/+$/,""),c=t.has("propertyUrl")?s!=null&&s.slug?`${u}/properties/${s.slug}`:d?`${u}/properties/${d}`:"":"",f=[];return t.has("parking_type")&&s.parking_type&&f.push({k:"Parking Type",v:s.parking_type}),t.has("parking_qty")&&(s.parking_qty||s.parking_qty===0)&&f.push({k:"Parking Qty",v:s.parking_qty}),t.has("unit_no")&&s.unit_no&&f.push({k:"Unit No",v:s.unit_no}),t.has("area")&&(s.area||s.area===0)&&f.push({k:"Area",v:s.area}),t.has("location_name")&&s.location_name&&f.push({k:"Location Name",v:s.location_name}),t.has("carpet_area")&&(s.carpet_area||s.carpet_area===0)&&f.push({k:"Carpet Area",v:`${s.carpet_area} sq ft`}),t.has("property_type_name")&&s.property_type_name&&f.push({k:"Property Type",v:s.property_type_name}),t.has("property_subtype_name")&&s.property_subtype_name&&f.push({k:"Property Subtype",v:s.property_subtype_name}),t.has("unit_type")&&(s.unit_type||s.unitType)&&f.push({k:"Unit Type",v:s.unit_type||s.unitType}),t.has("floor")&&(s.floor||s.floor===0)&&f.push({k:"Floor",v:s.floor}),t.has("total_floors")&&(s.total_floors||s.total_floors===0)&&f.push({k:"Total Floors",v:s.total_floors}),t.has("price_type")&&s.price_type&&f.push({k:"Price Type",v:s.price_type}),t.has("final_price")&&(s.final_price||s.final_price===0)&&f.push({k:"Final Price",v:Ym(Hm(s.final_price,s.price_type))}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b bg-gray-50",children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:d?`#${d} â€” ${v}`:v}),e.jsx("div",{className:"text-xs text-gray-600",children:x||" - "}),c&&e.jsxs("div",{className:"text-[11px] text-blue-600 mt-1 flex items-center gap-1 break-all",children:[e.jsx(za,{size:12})," ",c]})]}),e.jsx("img",{src:i,alt:"cover",className:"w-full h-40 object-cover"}),e.jsxs("div",{className:"p-3 border-t",children:[e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Property Price"}),e.jsx("div",{className:"text-xl font-bold text-indigo-600",children:Ym(o)})]}),b?e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Per Sq Ft"}),e.jsxs("div",{className:"font-semibold",children:["â‚¹",b.toLocaleString("en-IN")]})]}):null]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-xs",children:[e.jsxs("div",{className:"p-2 border rounded-lg flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Beds"}),e.jsx("span",{className:"font-semibold",children:hi(s==null?void 0:s.bedrooms)})]}),e.jsxs("div",{className:"p-2 border rounded-lg flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Baths"}),e.jsx("span",{className:"font-semibold",children:hi(s==null?void 0:s.bathrooms)})]}),e.jsxs("div",{className:"p-2 border rounded-lg flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Area"}),e.jsxs("span",{className:"font-semibold",children:[hi((s==null?void 0:s.square_feet)||(s==null?void 0:s.carpet_area))," sq ft"]})]})]}),s!=null&&s.description?e.jsx("div",{className:"text-xs text-gray-700 mt-3 line-clamp-3",children:s.description}):null,t.has("furnishing")&&(s!=null&&s.furnishing)?e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-[11px] font-semibold text-gray-700 mb-1",children:"Furnishing"}),e.jsx("div",{className:"text-xs",children:s.furnishing})]}):null,t.has("furnishingItems")&&((p=s==null?void 0:s.furnishingItems)!=null&&p.length)?e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-[11px] font-semibold text-gray-700 mb-1",children:["Furnishing Items (",s.furnishingItems.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-h-32 overflow-y-auto",children:s.furnishingItems.map((P,w)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-amber-100 text-amber-800 text-[11px]",children:P},w))})]}):null,t.has("amenities")&&((N=s==null?void 0:s.amenities)!=null&&N.length)?e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-[11px] font-semibold text-gray-700 mb-1",children:["Amenities (",s.amenities.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-h-32 overflow-y-auto",children:s.amenities.map((P,w)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[11px]",children:P},w))})]}):null,f.length?e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-[11px] font-semibold text-gray-700 mb-1",children:"Property Details"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.map((P,w)=>e.jsxs("div",{className:"text-[11px] border rounded-md px-2 py-1 flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500",children:P.k}),e.jsx("span",{className:"font-semibold",children:hi(P.v)})]},w))})]}):null]})]})},Lj=({isOpen:s,onClose:a})=>{const[t,r]=l.useState(!1),[i,n]=l.useState([]),[o,m]=l.useState(""),[g,b]=l.useState(!1),[d,v]=l.useState([]),[x,u]=l.useState(0),c=l.useRef(null),[f,p]=l.useState(""),[N,P]=l.useState(!0),[w,$]=l.useState(!1),[y,k]=l.useState("http://localhost:5173/"),[R,F]=l.useState(!1),[T,j]=l.useState(["propertyType","location","mainImage","price","bedrooms","bathrooms","carpet_area","description","amenities","furnishing","furnishingItems","agentInfo","contactDetails","propertyUrl","parking_type","parking_qty","unit_no","area","location_name","property_type_name","property_subtype_name","unit_type","floor","total_floors","price_type","final_price"]),E=l.useMemo(()=>new Set(T),[T]);l.useEffect(()=>{(async()=>{var Y,K;try{const q=await _r.getSettings(),ne=((Y=q==null?void 0:q.data)==null?void 0:Y.company_logo)||(q==null?void 0:q.company_logo)||((K=q==null?void 0:q.data)==null?void 0:K.logo)||(q==null?void 0:q.logo)||"";p(ne)}catch(q){console.error("Error fetching system settings:",q)}})()},[]),l.useEffect(()=>{s&&(async()=>{var h;try{r(!0);const Y=await((h=As.getProperties)==null?void 0:h.call(As,{limit:500}));let K=Array.isArray(Y)?Y:(Y==null?void 0:Y.data)||(Y==null?void 0:Y.items)||[];K=K.map(Ej),n(K)}catch(Y){console.error(Y),Z.error("Failed to fetch properties")}finally{r(!1)}})()},[s]),l.useEffect(()=>{function h(Y){c.current&&!c.current.contains(Y.target)&&b(!1)}return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const V=l.useMemo(()=>{const h=o.trim().toLowerCase();return h?i.filter(Y=>[Y.type,Y.unitType,Y.subtype,Y.locationNormalized,Y.location,Y.city,Y.location_name,Y.unit_type,Y.property_type_name,Y.property_subtype_name,String(Y.propertyId||Y.id||""),...Y.furnishingItems||[]].filter(Boolean).join(" ").toLowerCase().includes(h)):i},[i,o]),W=l.useMemo(()=>i.filter(h=>d.includes(h.id??h.propertyId)),[i,d]);l.useEffect(()=>{x>0&&x>=W.length&&u(Math.max(0,W.length-1))},[W.length,x]);const B=W[x]||null,M=h=>{!h&&h!==0||v(Y=>Y.includes(h)?Y.filter(K=>K!==h):[...Y,h])},A=()=>{const h=V.map(Y=>Y.id??Y.propertyId).filter(Boolean);v(Y=>Array.from(new Set([...Y,...h])))},L=()=>v([]),D=h=>{j(Y=>Y.includes(h)?Y.filter(K=>K!==h):[...Y,h])},I=async()=>{if(!d.length)return Z.warn("Select at least one property");try{r(!0);const h=W.map(le=>({id:le.id??le.propertyId,furnishing:le.furnishing||null,furnishingItems:Array.isArray(le.furnishingItems)?le.furnishingItems:[],parking_type:le.parking_type??null,parking_qty:le.parking_qty??null,unit_no:le.unit_no??null,area:le.area??null,location_name:le.location_name??null,carpet_area:le.carpet_area??null,property_type_name:le.property_type_name??null,property_subtype_name:le.property_subtype_name??null,unit_type:le.unit_type??null,floor:le.floor??null,total_floors:le.total_floors??null,price_type:le.price_type??null,final_price:le.final_price??null})),Y={ids:d,customizations:{primaryColor:"#E6761D",secondaryColor:"#0b3856",fontStyle:"modern",layout:"standard",watermark:!0,selectedContent:T,companyLogo:f},includeCover:N,includeTOC:w,publicBaseUrl:y,overrides:h,fileName:"multi-property-brochure.pdf"},K=await As.generateBrochuresBulkSinglePDF("bulk",Y),q=URL.createObjectURL(K),ne=document.createElement("a");ne.href=q,ne.download="multi-property-brochure.pdf",document.body.appendChild(ne),ne.click(),ne.remove(),URL.revokeObjectURL(q),Z.success("Merged brochure downloaded")}catch(h){console.error(h),Z.error("Failed to generate merged brochure")}finally{r(!1)}};if(!s)return null;const H=[{key:"propertyType",label:"Show 'type / unitType / subtype' (title is fixed)"},{key:"location",label:"Location"},{key:"mainImage",label:"Main Image"},{key:"price",label:"Price & PSF"},{key:"bedrooms",label:"Bedrooms"},{key:"bathrooms",label:"Bathrooms"},{key:"parking",label:"Parking (legacy field)"},{key:"carpet_area",label:"Carpet Area"},{key:"description",label:"Description"},{key:"furnishing",label:"Furnishing"},{key:"possession",label:"Possession"},{key:"facing",label:"Facing"},{key:"builtYear",label:"Built Year"},{key:"floor",label:"Floor"},{key:"total_floors",label:"Total Floors"},{key:"wing",label:"Wing (legacy field)"},{key:"unitNo",label:"Unit No (legacy field)"},{key:"amenities",label:"Amenities"},{key:"furnishingItems",label:"Furnishing Items"},{key:"nearbyPlaces",label:"Nearby Places"},{key:"aiScore",label:"AI Score"},{key:"priceGrowth",label:"Price Growth"},{key:"investmentGrade",label:"Investment Grade"},{key:"agentInfo",label:"Executive Name"},{key:"contactDetails",label:"Executive Phone"},{key:"propertyUrl",label:"Property URL (deep link)"},{key:"parking_type",label:"Parking Type"},{key:"parking_qty",label:"Parking Quantity"},{key:"unit_no",label:"Unit No"},{key:"area",label:"Area"},{key:"location_name",label:"Location Name (location_name)"},{key:"property_type_name",label:"Property Type Name"},{key:"property_subtype_name",label:"Property Subtype Name"},{key:"unit_type",label:"Unit Type (raw)"},{key:"price_type",label:"Price Type"},{key:"final_price",label:"Final Price"}];return e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[92vh]",children:[e.jsxs("div",{className:"p-5 border-b bg-gradient-to-r from-purple-50 to-pink-50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Bulk Brochure (Select + Preview)"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choose multiple properties and preview before generating one PDF."})]}),f&&e.jsx("div",{className:"mx-4",children:e.jsx("img",{src:f,alt:"Company Logo",className:"h-12 w-auto object-contain",onError:h=>{console.error("Logo failed to load"),h.currentTarget.style.display="none"}})}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50",children:e.jsx(ns,{size:18})})]}),e.jsxs("div",{className:"flex-1 overflow-hidden grid grid-cols-1 lg:grid-cols-2 gap-0",children:[e.jsxs("div",{className:"p-5 border-r overflow-y-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Select Properties"}),e.jsxs("div",{ref:c,className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>b(h=>!h),className:"w-full border rounded-lg px-3 py-2 flex items-center justify-between hover:bg-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-700",children:d.length?`${d.length} selected`:"Choose properties"}),g?e.jsx(Cd,{size:16}):e.jsx(ea,{size:16})]}),g&&e.jsxs("div",{className:"absolute z-10 mt-2 w-full bg-white rounded-xl border shadow-2xl",children:[e.jsxs("div",{className:"p-2 border-b bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white border rounded-lg px-2",children:[e.jsx(it,{size:14,className:"text-gray-400"}),e.jsx("input",{value:o,onChange:h=>m(h.target.value),placeholder:"Search type, unit, subtype, city, furnishingâ€¦",className:"w-full text-sm py-2 outline-none"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("button",{onClick:A,className:"text-xs px-2 py-1 rounded bg-purple-600 text-white hover:bg-purple-700",type:"button",children:"Select All (filtered)"}),e.jsx("button",{onClick:L,className:"text-xs px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",type:"button",children:"Clear"}),e.jsxs("span",{className:"text-xs text-gray-600 ml-auto",children:[V.length," results"]})]})]}),e.jsx("div",{className:"max-h-72 overflow-auto",children:t?e.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Loadingâ€¦"}):V.length===0?e.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No properties found."}):V.map(h=>{const Y=h.id??h.propertyId,K=d.includes(Y),q=lg(h),ne=(Y?`#${Y} â€” `:"")+q,le=ng(h);return e.jsxs("label",{className:`flex items-start gap-3 p-3 cursor-pointer border-b last:border-b-0 ${K?"bg-purple-50":"hover:bg-gray-50"}`,children:[e.jsx("input",{type:"checkbox",className:"mt-1",checked:K,onChange:()=>M(Y)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:ne}),e.jsx("div",{className:"text-xs text-gray-600",children:le})]}),e.jsxs("button",{type:"button",onClick:S=>{S.preventDefault();const C=W.findIndex(J=>(J.id??J.propertyId)===Y);if(C===-1){const J=Math.max(0,[...W,h].findIndex(ue=>(ue.id??ue.propertyId)===Y));u(J)}else u(Math.max(0,C))},className:"text-xs inline-flex items-center gap-1 px-2 py-1 rounded border hover:bg-white",title:"Preview",children:[e.jsx(ks,{size:14}),"Preview"]})]},String(Y))})}),e.jsx("div",{className:"p-2 border-t bg-gray-50 text-right",children:e.jsx("button",{onClick:()=>b(!1),className:"text-sm px-3 py-1.5 rounded bg-purple-600 text-white hover:bg-purple-700",children:"Done"})})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{type:"button",onClick:()=>F(h=>!h),className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border hover:bg-gray-50",children:[e.jsx(ro,{size:16}),"Include in PDF",R?e.jsx(Cd,{size:16}):e.jsx(ea,{size:16})]}),R&&e.jsx("div",{className:"mt-2 p-3 rounded-xl border bg-white grid grid-cols-2 gap-2 max-h-64 overflow-auto",children:H.map(h=>e.jsxs("label",{className:"text-sm flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:E.has(h.key),onChange:()=>D(h.key)}),h.label]},h.key))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(za,{size:16})," Public Base URL"]}),e.jsx("input",{value:y,onChange:h=>k(h.target.value),placeholder:"http://localhost:5173/",className:"mt-1 w-full border rounded-lg px-3 py-2 text-sm"}),e.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Used to build a clickable property URL in the PDF (e.g., /properties/:slug or /properties/:id)."})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:h=>P(h.target.checked)}),"Include Cover"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:h=>$(h.target.checked)}),"Include Table of Contents"]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:I,disabled:t||d.length===0,className:"inline-flex items-center gap-2 px-5 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-50",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-4 w-4 rounded-full border-b-2 border-white"}),"Preparingâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ys,{size:16}),"Generate One PDF (",d.length,")"]})})})]}),e.jsxs("div",{className:"p-5 overflow-y-auto",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600",children:W.length?`Previewing ${x+1} of ${W.length}`:"No selection"}),W.length>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-2 py-1 rounded border text-sm",onClick:()=>u(h=>Math.max(0,h-1)),disabled:x===0,children:"Prev"}),e.jsx("button",{className:"px-2 py-1 rounded border text-sm",onClick:()=>u(h=>Math.min(W.length-1,h+1)),disabled:x>=W.length-1,children:"Next"})]})]}),e.jsx(Mj,{p:B,publicBaseUrl:y,includeKeys:E,companyLogo:f})]})]})]})})},ca=s=>s==null||s===""?" - ":s,tl=s=>{const a=Number(s);return Number.isFinite(a)?a:0},ig=s=>([s==null?void 0:s.assigned_to_full_name,s==null?void 0:s.full_name,s==null?void 0:s.fullName,s!=null&&s.first_name&&(s!=null&&s.last_name)?`${s.salutation?s.salutation+" ":""}${s.first_name} ${s.last_name}`:"",s==null?void 0:s.name,s==null?void 0:s.username,s==null?void 0:s.email].find(t=>typeof t=="string"&&t.trim())||"Unnamed Executive").trim(),Gm=({label:s,knownTags:a,selectedPropertyIds:t,propTags:r,onApply:i,isOpen:n,onToggle:o,onClose:m})=>{const[g,b]=l.useState([]),d=l.useMemo(()=>{const p=new Set;return t.forEach(N=>{(r[String(N)]||[]).forEach(w=>p.add(w))}),Array.from(p)},[t,r]),v=l.useMemo(()=>{const p=(a!=null&&a.length?a:Object.keys(Wn)).map(P=>String(P).trim()).filter(Boolean);return Array.from(new Map(p.map(P=>[P.toLowerCase(),P])).values()).sort((P,w)=>P.localeCompare(w))},[a]);l.useEffect(()=>{s==="Remove"&&n?b(d.filter(p=>v.includes(p))):s==="Add"&&n&&b([])},[n,s,d,v]);const x=p=>{b(N=>N.includes(p)?N.filter(P=>P!==p):[...N,p])},u=()=>b(v),c=()=>b([]),f=()=>{if(!g.length){Z.warn(`Please select at least one tag to ${s.toLowerCase()}`);return}i(g),m()};return e.jsxs("div",{className:"mb-2 relative",children:[e.jsxs("button",{className:"w-full text-left text-xs px-2 py-1 rounded hover:bg-gray-50 font-medium border border-transparent hover:border-gray-200 transition-colors",onClick:p=>{p.stopPropagation(),o()},type:"button",children:[s," tags",g.length>0&&e.jsxs("span",{className:"ml-2 inline-flex items-center px-1.5 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px]",children:[g.length," selected"]})]}),n&&e.jsxs("div",{className:"absolute z-40 left-0 right-0 mt-1 border rounded-lg bg-white shadow-lg p-2 min-w-[250px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"text-[11px] text-gray-500",children:[v.length," available tags",s==="Remove"&&d.length>0&&e.jsxs("span",{className:"ml-1 text-blue-600",children:["(",d.length," currently applied)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:u,className:"text-[11px] px-2 py-1 border rounded hover:bg-gray-50 transition-colors",children:"Select all"}),e.jsx("button",{onClick:c,className:"text-[11px] px-2 py-1 border rounded hover:bg-gray-50 transition-colors",children:"Clear"})]})]}),e.jsx("div",{className:"max-h-64 overflow-auto",children:e.jsx("ul",{className:"grid grid-cols-1 gap-2",children:v.map(p=>{const N=g.includes(p),P=Ea(p),w=d.includes(p);return e.jsxs("li",{className:`flex items-center gap-2 p-2 rounded-lg border cursor-pointer transition-all ${N?"border-blue-400 bg-blue-50/40 shadow-sm":"border-gray-200 hover:border-gray-300"} ${s==="Remove"&&w?"ring-1 ring-green-200 bg-green-50/30":""}`,onClick:()=>x(p),children:[e.jsx("input",{type:"checkbox",checked:N,onChange:()=>x(p),className:"h-3.5 w-3.5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:$=>$.stopPropagation()}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full ring-1 ${P.bg} ${P.text} ${P.ring} flex-1`,title:p,children:[e.jsx(og,{emoji:P.emoji,size:12,className:"text-xs mr-1"}),e.jsx("span",{className:"text-[11px] leading-none capitalize",children:p})]}),s==="Remove"&&w&&e.jsx("span",{className:"text-[10px] text-green-600 font-medium px-1.5 py-0.5 bg-green-100 rounded",children:"Applied"})]},p)})})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-2 border-t border-gray-200",children:[e.jsxs("div",{className:"text-[11px] text-gray-500",children:[g.length," tag",g.length!==1?"s":""," selected"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:m,className:"px-3 py-1.5 border rounded text-xs hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:f,className:"px-3 py-1.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:g.length===0,children:[s," ",g.length," Tag",g.length!==1?"s":""]})]})]})]})]})},Dj=({isOpen:s,onClose:a,executives:t,selectedProperties:r,onAssign:i,isBulk:n=!1})=>{const[o,m]=l.useState(""),[g,b]=l.useState(!1),d=async()=>{if(!o){Z.warn("Please select an executive");return}const v=t.find(x=>String(x.id)===String(o));if(!v){Z.error("Selected executive not found");return}b(!0);try{await i(o,v.name),m(""),a()}catch(x){console.error("Assignment failed:",x),Z.error("Failed to assign executive")}finally{b(!1)}};return l.useEffect(()=>{s||(m(""),b(!1))},[s]),s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:n?"Bulk Assign Executive":"Assign Executive"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ns,{size:20})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:n?`Assign ${r.length} properties to sales executive`:"Assign this property to sales executive"}),e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Executive"}),e.jsxs("select",{value:o,onChange:v=>m(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",disabled:g||t.length===0,children:[e.jsx("option",{value:"",children:"Choose an executive..."}),t.map(v=>e.jsxs("option",{value:v.id,children:[v.name,v.department&&` - ${v.department}`,v.role&&` (${v.role})`]},v.id))]}),t.length===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No sales executives available. Please check if executives are properly configured."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors disabled:opacity-50",disabled:g,children:"Cancel"}),e.jsx("button",{onClick:d,disabled:!o||g||t.length===0,className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Assigning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(La,{size:16}),e.jsx("span",{children:"Assign"})]})})]})]})}):null};function Rj(s,a){if(a==="all"||!a)return!0;if(!s||s<=0)return!1;if(a.includes("-")){const[r,i]=a.split("-").map(g=>g.trim()),n=g=>{if(!g)return 0;const b=g.match(/(\d+(?:\.\d+)?)/);if(!b)return 0;const d=parseFloat(b[1]);return g.toLowerCase().includes("cr")?d*1e7:g.toLowerCase().includes("l")?d*1e5:d},o=n(r),m=n(i);return s>=o&&s<=m}if(a.endsWith("+")){const r=a.replace("+","").trim(),n=(o=>{if(!o)return 0;const m=o.match(/(\d+(?:\.\d+)?)/);if(!m)return 0;const g=parseFloat(m[1]);return o.toLowerCase().includes("cr")?g*1e7:o.toLowerCase().includes("l")?g*1e5:g})(r);return s>=n}const t=a.match(/(\d+(?:\.\d+)?)/);if(t){const r=parseFloat(t[1]);return s===r}return!0}function og({emoji:s,size:a=12,className:t=""}){if(!s)return null;if(typeof s=="string")return e.jsx("span",{className:`${t} font-bold uppercase leading-none`,"aria-hidden":"true",children:s});const r=s;return e.jsx(r,{size:a,className:t,"aria-hidden":"true"})}const Km=({tags:s,className:a="",onClickTag:t})=>s!=null&&s.length?e.jsx("div",{className:`flex flex-wrap gap-1.5 ${a}`,children:s.map((r,i)=>{const n=String(r||"").trim(),o=Ea(n),m="inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-bold uppercase ring-1 shadow-sm leading-none",g=t?"button":"span";return e.jsxs(g,{title:t?`Filter by: ${n}`:n,className:`${m} ${o.bg} ${o.text} ${o.ring} ${t?"cursor-pointer hover:brightness-95 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-400":""}`,onClick:t?()=>t(n):void 0,type:t?"button":void 0,"aria-label":t?`Filter by tag ${n}`:void 0,children:[e.jsx(og,{emoji:o.emoji,size:12,className:"text-xs mr-1"}),e.jsx("span",{className:"leading-none",children:n})]},`${n}-${i}`)})}):null,zj=s=>{const a=new Set;return Object.values(s).forEach(t=>(t||[]).forEach(r=>a.add(r))),Array.from(a)},Jm=({srcCandidate:s,alt:a="image",className:t="",fitCover:r=!0,propertyCtx:i})=>{const[n,o]=l.useState(!1),[m,g]=l.useState(null);return l.useEffect(()=>{const b=rg(s||"");g(b),o(!1)},[s]),!m||n?e.jsx("div",{className:`bg-gray-200 text-gray-500 flex items-center justify-center ${t}`,style:{objectFit:r?"cover":void 0},children:e.jsx("span",{className:"text-xs",children:"Image not available"})}):e.jsx("img",{src:m,alt:a,className:t,style:{objectFit:r?"cover":void 0},onError:()=>o(!0)})};function cg(s){return s?Array.isArray(s)?s.map(String).filter(Boolean):typeof s=="string"?s.split(",").map(a=>a.trim()).filter(Boolean):typeof s=="object"?Object.entries(s).filter(([,a])=>!!a).map(([a])=>String(a)):[]:[]}function Fj(s){const a=(s==null?void 0:s.furnishingItems)??(s==null?void 0:s.furnishing_items)??(s==null?void 0:s.furnished_items)??(s==null?void 0:s.furnishing_details)??(s==null?void 0:s.furnishing_list)??(s==null?void 0:s.furnishingItem)??(s==null?void 0:s.furnishing_item)??(typeof(s==null?void 0:s.furnishing)=="string"&&s.furnishing.includes(",")?s.furnishing:void 0);return Array.from(new Set(cg(a).map(r=>String(r).replace(/[_\-]+/g," ").replace(/\s+/g," ").trim()).filter(Boolean)))}function Qm(s,a){const t=Array.isArray(s==null?void 0:s.photoUrls)?s.photoUrls:[],i=(t.length?t:Array.isArray(s==null?void 0:s.photos)&&s.photos.length?s.photos:cg(s==null?void 0:s.photos)).map(b=>t.length?b:rg(b)||"").filter(Boolean),n=Fj(s),o=(()=>{if(typeof(s==null?void 0:s.is_negotiable)=="boolean")return s.is_negotiable?"Negotiable":"Fixed";if(typeof(s==null?void 0:s.negotiable)=="boolean")return s.negotiable?"Negotiable":"Fixed";const b=(s==null?void 0:s.priceType)??(s==null?void 0:s.price_type)??(s==null?void 0:s.pricing_type)??(s==null?void 0:s.price_status)??"";if(typeof b=="string"){if(/negotiable/i.test(b))return"Negotiable";if(/fixed/i.test(b))return"Fixed"}return"Fixed"})(),m=(()=>{const b=(s==null?void 0:s.finalPrice)??(s==null?void 0:s.final_price)??(s==null?void 0:s.price)??null,d=Number(b);return Number.isFinite(d)?d:""})();(()=>{const b=(s==null?void 0:s.budget)??(s==null?void 0:s.expected_price)??(s==null?void 0:s.asking_price)??null,d=Number(b);return Number.isFinite(d)?d:" - "})();const g=(()=>{const b=(s==null?void 0:s.assignedTo)??((s==null?void 0:s.assigned_to)!=null?{id:s.assigned_to,name:s.assigned_to_name,full_name:s.assigned_to_full_name,email:s.assigned_to_email,phone:s.assigned_to_phone,department:s.assigned_to_department,role:s.assigned_to_role}:void 0);if(!b)return;const d=b.id??b.userId??b.user_id??(s==null?void 0:s.assigned_to);if(!(d==null||String(d).trim()===""))return{id:d,name:ig(b),email:b.email||(s==null?void 0:s.assigned_to_email)||"",phone:b.phone||(s==null?void 0:s.assigned_to_phone)||"",department:b.department||(s==null?void 0:s.assigned_to_department),role:b.role||(s==null?void 0:s.assigned_to_role)}})();return{id:s.id??a+1,propertyId:s.property_id||`REX${String(s.id??a+1).padStart(4,"0")}`,title:s.title||`${ca(s.unit_type)} ${ca(s.property_type_name||s.property_type||s.property_subtype_name)}`,type:s.property_type_name||s.property_type||" - ",subtype:s.property_subtype_name||s.property_subtype||" - ",unitType:s.unit_type||" - ",wing:s.wing_name||s.wing||" - ",unitNo:s.unit_no||s.unit||0,furnishing:s.furnishing||s.furnishing_status||" - ",furnishingItems:n,parkingType:s.parking_type||" - ",parkingQty:s.parking_qty??0,city:s.city_name||s.city||" - ",location:s.location_name||s.location||" - ",society:s.society_name||s.society||" - ",floor:s.floor??" - ",totalFloors:s.total_floors??" - ",carpetArea:s.carpet_area??0,builtupArea:s.builtup_area??0,status:s.status||" - ",leadSource:s.lead_source||" - ",purchaseMonth:s.purchase_month??" - ",purchaseYear:s.purchase_year??" - ",possessionMonth:s.possession_month??" - ",possessionYear:s.possession_year??" - ",budget:s.budget??" - ",address:s.address||" - ",description:s.description||" - ",selling_rights:s.selling_rights||" - ",photos:i,bedrooms:s.bedrooms||"",bathrooms:s.bathrooms||"",balcony:s.balcony||" ",facing:s.facing||" ",priceType:o,finalPrice:m,seller:{id:s.seller_id,name:s.seller_name||" - ",phone:s.seller_phone,email:s.seller_email,leadSource:s.lead_source},assignedTo:g,stage:s.stage||"initial_contact",stageProgress:tl(s.stage_progress??0),visits:tl(s.visits??0),totalVisits:tl(s.total_visits??0),lastVisit:s.last_visit||" - ",interestedBuyers:tl(s.interested_buyers??0),hotLeads:tl(s.hot_leads??0),created_at:s.created_at,updated_at:s.updated_at,isPublic:!!(s.is_public??!1),publicViews:tl(s.public_views??0),publicInquiries:tl(s.public_inquiries??0),amenities:s.amenities??[],nearby_places:(s.nearby_places||[]).map(b=>typeof b=="string"?{name:b}:b),ownershipDocUrl:s.ownership_doc_path||s.ownershipDocUrl||s.ownership_document||"",ownershipDocName:s.ownership_doc_name||s.ownershipDocName||s.ownership_document_name||"",ownershipDocId:s.ownership_doc_id||s.ownershipDocId||s.ownership_document_id||""}}const bt=s=>{if(s==null)return"";const a=String(s).trim();return a==="-"||a===" - "?"":a},Bj=s=>{var a;return{id:s.id,seller:bt((a=s.seller)==null?void 0:a.name),propertyType:bt(s.type),propertySubtype:bt(s.subtype),unitType:bt(s.unitType),wing:bt(s.wing),unitNo:bt(s.unitNo),furnishing:bt(s.furnishing),facing:bt(s.facing),bedrooms:bt(s.bedrooms),bathrooms:bt(s.bathrooms),balcony:bt(s.balcony),priceType:s.priceType||"Fixed",finalPrice:bt(s.finalPrice),parkingType:bt(s.parkingType),parkingQty:bt(s.parkingQty),city:bt(s.city),location:bt(s.location),society:bt(s.society),floor:bt(s.floor),totalFloors:bt(s.totalFloors),carpetArea:bt(s.carpetArea),builtupArea:bt(s.builtupArea),budget:bt(s.budget),address:bt(s.address),status:bt(s.status),leadSource:bt(s.leadSource),possessionMonth:bt(s.possessionMonth),possessionYear:bt(s.possessionYear),purchaseMonth:bt(s.purchaseMonth),purchaseYear:bt(s.purchaseYear),sellingRights:bt(s.selling_rights)||"Standard",amenities:Array.isArray(s.amenities)?s.amenities:[],furnishingItems:Array.isArray(s.furnishingItems)?s.furnishingItems:[],description:bt(s.description),nearby_places:Array.isArray(s.nearby_places)?s.nearby_places:[],existingOwnershipDocUrl:bt(s.ownershipDocUrl),existingOwnershipDocName:bt(s.ownershipDocName),existingOwnershipDocId:bt(s.ownershipDocId),existingPhotos:(s.photos||[]).map((t,r)=>({id:String(r+1),url:t,name:`photo-${r+1}.jpg`}))}},Ji={blue:{badge:"bg-blue-200",btn:"text-gray-600 hover:bg-gray-100",btnActive:"bg-blue-100 text-blue-700 border border-blue-200",countActive:"bg-blue-200"},green:{badge:"bg-green-200",btn:"text-gray-600 hover:bg-gray-100",btnActive:"bg-green-100 text-green-700 border border-green-200",countActive:"bg-green-200"},purple:{badge:"bg-purple-200",btn:"text-gray-600 hover:bg-gray-100",btnActive:"bg-purple-100 text-purple-700 border border-purple-200",countActive:"bg-purple-200"},orange:{badge:"bg-orange-200",btn:"text-gray-600 hover:bg-gray-100",btnActive:"bg-orange-100 text-orange-700 border border-orange-200",countActive:"bg-orange-200"},indigo:{badge:"bg-indigo-200",btn:"text-gray-600 hover:bg-gray-100",btnActive:"bg-indigo-100 text-indigo-700 border border-indigo-200",countActive:"bg-indigo-200"},red:{badge:"bg-red-200",btn:"text-gray-600 hover:bg-gray-100",btnActive:"bg-red-100 text-red-700 border border-red-200",countActive:"bg-red-200"}};function Oj(s,a){const t=Ji[a]||Ji.blue;return`flex items-center space-x-2 px-3 py-1.5 rounded-md transition-colors whitespace-nowrap text-xs ${s?t.btnActive:t.btn}`}function Uj(s,a){const t=Ji[a]||Ji.blue;return`px-2 py-0.5 rounded-full text-[10px] ${s?t.countActive:"bg-gray-200 text-gray-700"}`}const qj=()=>{const{user:s}=Hs(),a=Ws(s,"property.read"),t=Ws(s,"property.create"),r=Ws(s,"property.update"),i=Ws(s,"property.delete"),n=Ws(s,"data.import"),o=Ws(s,"data.export"),m=Ws(s,"property.assign"),g=Ws(s,"property.bulk_delete");if(!a)return e.jsx("div",{className:"h-full flex flex-col bg-gray-50",children:e.jsx("div",{className:"flex-1 grid place-items-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("div",{className:"text-gray-600 text-sm",children:"You do not have permission to view properties."})]})})});const[b,d]=l.useState(()=>typeof window>"u"?"all":new URLSearchParams(window.location.search).get("listTab")||localStorage.getItem("prop_list_tab")||"all"),[v,x]=l.useState(""),[u,c]=l.useState([]),[f,p]=l.useState(!1),[N,P]=l.useState(null),[w,$]=l.useState(!1),[y,k]=l.useState(!1),[R,F]=l.useState(!1),[T,j]=l.useState(!1),[E,V]=l.useState(null),[W,B]=l.useState(1),[M,A]=l.useState(25),[L,D]=l.useState("grid"),[I,H]=l.useState(null),[h,Y]=l.useState(!1),[K,q]=l.useState(null),[ne,le]=l.useState([]),[S,C]=l.useState(!1),[J,ue]=l.useState(!0),[Q,he]=l.useState(null),[se,ge]=l.useState(!1),[ee,de]=l.useState(!1),[U,X]=l.useState(!1),[re,fe]=l.useState(!0),[G,me]=l.useState({}),[oe,Fe]=l.useState(null),[$e,Le]=l.useState({}),[je,_e]=l.useState([]),[ve,Pe]=l.useState(new Set),[We,pe]=l.useState(!1),[O,Ie]=l.useState(0),[ze,xe]=l.useState(0),[Ee,Ke]=l.useState(!1),[Xe,ye]=l.useState(null);l.useEffect(()=>{async function De(){var ds,os;const is=await cr.getAll(!1),Qe=await cr.getAll(!0);Ie((ds=is==null?void 0:is.rows)==null?void 0:ds.reduce((zs,Us)=>zs+((Us==null?void 0:Us.total_views)||0),0)),xe((os=Qe==null?void 0:Qe.rows)==null?void 0:os.reduce((zs,Us)=>zs+((Us==null?void 0:Us.unique_views)||0),0))}De()},[]),l.useEffect(()=>{(async()=>{try{C(!0);const is=await Os.getByDeptRole({department:"Sales",role:"Sales Executive",is_active:1,limit:50}),Qe=(is==null?void 0:is.items)??(is==null?void 0:is.data)??is??[];if(Array.isArray(Qe)){const ds=Qe.map(os=>({id:os.id||os.userId,name:ig(os),email:os.email,phone:os.phone||os.mobile,department:os.department,role:os.role,is_active:os.is_active??os.active??!0}));le(ds)}else console.warn("Unexpected executives response format:",is),le([])}catch(is){console.error("Error fetching executives:",is),le([])}finally{C(!1)}})()},[]),l.useEffect(()=>{if(!b||localStorage.getItem("prop_list_tab")===b)return;localStorage.setItem("prop_list_tab",b);const is=setTimeout(()=>{const Qe=new URL(window.location.href);Qe.searchParams.set("listTab",b),window.history.replaceState({},"",Qe.toString())},300);return()=>clearTimeout(is)},[b]),l.useEffect(()=>{(async()=>{try{fe(!0);const is=await Gt(["common","lead","property"]);me(is)}catch(is){console.error("Error fetching master options:",is)}finally{fe(!1)}})()},[]);const Ce={dateFrom:"",dateTo:"",ignoreDate:!1,type:"all",status:"all",priceRange:"all",location:"all",seller:"all",stage:"all",tags:"all",minBudget:"",maxBudget:"",sortOrder:"created_desc",assignedExecutive:"all",isPublic:void 0},[_,ae]=l.useState(Ce),ke=()=>{ae(Ce)},[Me,Ye]=l.useState([]),ie=l.useMemo(()=>Object.keys(Wn),[]),we=l.useMemo(()=>zj($e),[$e]),Be=De=>{ae(is=>({...is,tags:De})),d("all"),B(1),Z.info(`Filtered by tag: ${De}`,{autoClose:1500})},Ve=l.useMemo(()=>{const De=new Set([...ie,...je,...we]);return Array.from(De).map(is=>String(is).trim()).filter(Boolean).sort((is,Qe)=>is.localeCompare(Qe,void 0,{sensitivity:"base"}))},[ie,je,we]),Je=async()=>{var De,is;console.log("ðŸ”„ Loading properties started..."),ue(!0),he(null),ge(!1);try{console.log("ðŸ“ž Calling propertiesAPI.getProperties()...");const Qe=await As.getProperties(),os=(Array.isArray(Qe)?Qe:(Qe==null?void 0:Qe.data)||[]).map((zs,Us)=>Qm(zs,Us));Ye(os)}catch(Qe){console.error("âŒ Error fetching properties:",Qe);let ds="Failed to load properties.";Qe!=null&&Qe.message?ds=Qe.message:(is=(De=Qe==null?void 0:Qe.response)==null?void 0:De.data)!=null&&is.message?ds=Qe.response.data.message:(Qe==null?void 0:Qe.code)==="NETWORK_ERROR"&&(ds="Network error - please check your connection",ge(!0)),he(ds),Ye([]),Z.error(`Loading failed: ${ds}`)}finally{ue(!1),console.log("ðŸ Loading finished")}};l.useEffect(()=>{Je();const De=()=>navigator.onLine&&Je();return window.addEventListener("online",De),()=>window.removeEventListener("online",De)},[]),l.useEffect(()=>{if(!N)return;const De=String(N.id),is=Me.find(Qe=>String(Qe.id)===De);is&&is.updated_at!==N.updated_at&&P(is)},[Me,N==null?void 0:N.id]),l.useEffect(()=>{if(!Me.length)return;const De=Me.filter(Qe=>!ve.has(String(Qe.id))&&!$e[String(Qe.id)]);if(De.length===0)return;(async()=>{try{const Qe={},ds=new Set(je);for(const os of De)try{const zs=await Qt.getById(os.id),Us=Array.isArray(zs==null?void 0:zs.tags)?zs.tags:[];Qe[String(os.id)]=Us,Us.forEach(pt=>ds.add(pt))}catch(zs){console.warn(`Failed to load tags for property ${os.id}:`,zs)}Object.keys(Qe).length>0&&(Le(os=>({...os,...Qe})),_e(os=>Array.from(new Set([...os,...Object.values(Qe).flat()])).sort()),Pe(os=>{const zs=new Set(os);return De.forEach(Us=>zs.add(String(Us.id))),zs}))}catch(Qe){console.error("Error loading tags:",Qe)}})()},[Me.length]),l.useEffect(()=>{if(!Me.length||We)return;const is=Date.now()-10080*60*1e3,Qe=Me.filter(os=>os.created_at?new Date(os.created_at).getTime()>=is:!1);if(Qe.length===0){pe(!0);return}(async()=>{try{for(const os of Qe){const zs=String(os.id),Us=$e[zs]||[];Us.some(pt=>pt.toLowerCase()==="new listing")||(Le(pt=>({...pt,[zs]:[...Us,"New Listing"]})),Qt.add(os.id,["New Listing"]).catch(console.error))}_e(os=>os.includes("New Listing")?os:["New Listing",...os].sort()),pe(!0)}catch(os){console.error("Auto-tagging failed:",os)}})()},[Me.length,We]);const Ue=l.useMemo(()=>[{id:"all",label:"All Properties",count:Me.length,color:"blue"},{id:"available",label:"Available",count:Me.filter(De=>De.status==="Available").length,color:"green"},{id:"sold",label:"Sold",count:Me.filter(De=>De.status==="Sold").length,color:"purple"},{id:"negotiation",label:"Under Negotiation",count:Me.filter(De=>De.status==="Under Negotiation").length,color:"orange"},{id:"public",label:"Public Listings",count:Me.filter(De=>De.isPublic).length,color:"indigo"},{id:"hot",label:"Hot Properties",count:Me.filter(De=>(Number(De.hotLeads)||0)>2).length,color:"red"}],[Me]),Oe=l.useMemo(()=>[...Me.filter(Qe=>{var xa,At,gr;const ds=(Qe.title||"").toLowerCase().includes(v.toLowerCase())||(Qe.propertyId||"").toLowerCase().includes(v.toLowerCase())||(Qe.location||"").toLowerCase().includes(v.toLowerCase())||(Qe.society||"").toLowerCase().includes(v.toLowerCase())||(((xa=Qe.seller)==null?void 0:xa.name)||"").toLowerCase().includes(v.toLowerCase()),os=b==="all"||b==="available"&&Qe.status==="Available"||b==="sold"&&Qe.status==="Sold"||b==="negotiation"&&Qe.status==="Under Negotiation"||b==="public"&&Qe.isPublic||b==="hot"&&(Number(Qe.hotLeads)||0)>2,zs=_.assignedExecutive==="all"||_.assignedExecutive==="__unassigned__"&&!((At=Qe.assignedTo)!=null&&At.id)||((gr=Qe.assignedTo)==null?void 0:gr.id)!=null&&String(Qe.assignedTo.id)===String(_.assignedExecutive),Us=_.isPublic===void 0||_.isPublic===!!Qe.isPublic,pt=(()=>{if(_.priceRange==="all"||!_.priceRange)return!0;const St=Number(Qe.budget);return!St||St<=0?!1:Rj(St,_.priceRange)})(),Ht=(()=>{const St=Number(Qe.budget);if(!St||St<=0)return!1;const ba=_.minBudget?Number(_.minBudget):0,be=_.maxBudget?Number(_.maxBudget):1/0;return St>=ba&&St<=be})(),qt=(()=>{if(_.ignoreDate)return!0;const St=_.dateFrom?new Date(_.dateFrom):null,ba=_.dateTo?new Date(_.dateTo):null;if(!St&&!ba)return!0;const be=new Date(Qe.created_at||Qe.updated_at||0);return be.setHours(0,0,0,0),St&&ba?(St.setHours(0,0,0,0),ba.setHours(23,59,59,999),be>=St&&be<=ba):St?(St.setHours(0,0,0,0),be>=St):ba?(ba.setHours(23,59,59,999),be<=ba):!0})(),lt=(_.type==="all"||Qe.type===_.type)&&(_.status==="all"||Qe.status===_.status)&&(_.location==="all"||Qe.location===_.location||Qe.city===_.location)&&(_.stage==="all"||Qe.stage===_.stage.toLowerCase().replace(/\s+/g,"_"))&&pt&&Ht&&(_.tags==="all"||($e[String(Qe.id)]||[]).some(St=>St===_.tags))&&zs&&Us&&qt;return ds&&os&&lt})].sort((Qe,ds)=>{switch(_.sortOrder){case"created_asc":return new Date(Qe.created_at||0).getTime()-new Date(ds.created_at||0).getTime();case"created_desc":return new Date(ds.created_at||0).getTime()-new Date(Qe.created_at||0).getTime();case"price_asc":return(Number(Qe.budget)||0)-(Number(ds.budget)||0);case"price_desc":return(Number(ds.budget)||0)-(Number(Qe.budget)||0);default:return new Date(ds.created_at||0).getTime()-new Date(Qe.created_at||0).getTime()}}),[Me,v,b,_,$e]),rs=Math.max(1,Math.ceil(Oe.length/M)),ms=(W-1)*M,cs=Oe.slice(ms,ms+M),gs=()=>{X(!0)},Ne=()=>{V(null),p(!0)},Ze=De=>{V(De),p(!0)},ls=De=>{P(De);const is=new URL(window.location.href);is.searchParams.set("view",String(De.id)),window.history.replaceState({},"",is.toString())},$s=()=>{P(null);const De=new URL(window.location.href);De.searchParams.delete("view"),De.searchParams.delete("tab"),window.history.replaceState({},"",De.toString())};l.useEffect(()=>{if(J||Q)return;const is=new URLSearchParams(window.location.search).get("view");if(is&&!N){const Qe=Me.find(ds=>String(ds.id)===is||String(ds.propertyId)===is);Qe&&P(Qe)}},[J,Q,Me,N]);const Gs=async De=>{if(window.confirm("Are you sure you want to delete this property?"))try{await As.deleteProperty(De.toString()),Ye(is=>is.filter(Qe=>Qe.id!==De)),Z.success("Property deleted successfully!"),Pe(is=>{const Qe=new Set(is);return Qe.delete(String(De)),Qe})}catch(is){console.error("Failed to delete property:",is),Z.error("Error deleting property. Please try again.")}},Se=De=>{c(is=>is.includes(De)?is.filter(Qe=>Qe!==De):[...is,De])},Ge=()=>{u.length===cs.length?c([]):c(cs.map(De=>De.id))},z=De=>{q(De),Y(!0)},te=()=>{if(u.length===0){Z.warn("No properties selected");return}Y(!0)},ce=async(De,is)=>{var Qe,ds;if(K)try{const zs={assigned_to:Number(De)},Us=await As.updateAssignedTo(K.id,zs);if(Us.success){const pt=ne.find(qt=>qt.id===De),Ht=pt?{id:pt.id,name:pt.name,email:pt.email,phone:pt.phone,department:pt.department,role:pt.role}:{id:De,name:is,email:"",phone:"",department:"",role:""};Ye(qt=>qt.map(lt=>lt.id===K.id?{...lt,assignedTo:Ht}:lt)),P(qt=>qt&&String(qt.id)===String(K.id)?{...qt,assignedTo:Ht}:qt),Us.success&&(await Je(),Z.success(`Property assigned to ${is}`))}else Z.error("Failed to assign executive")}catch(os){console.error("Assign executive failed:",os),Z.error(((ds=(Qe=os==null?void 0:os.response)==null?void 0:Qe.data)==null?void 0:ds.message)||"Error assigning executive")}},Re=async(De,is)=>{if(u.length!==0){de(!0);try{const Qe=Number(De),ds=ne.find(Us=>Us.id===De),os=ds?{id:ds.id,name:ds.name,email:ds.email,phone:ds.phone,department:ds.department,role:ds.role}:{id:De,name:is,email:"",phone:"",department:"",role:""};let zs=0;for(const Us of u)try{const pt={assigned_to:Qe};(await As.updateAssignedTo(Us,pt)).success&&(Ye(qt=>qt.map(lt=>lt.id===Us?{...lt,assignedTo:os}:lt)),zs++)}catch(pt){console.error(`Failed to assign property ${Us}:`,pt)}zs>0&&(await Je(),Z.success(`${zs} properties assigned to ${is}`)),c([])}catch(Qe){console.error("Bulk assign failed:",Qe),Z.error("Error during bulk assignment")}finally{de(!1)}}},Te=async(De,is)=>{K?await ce(De,is):u.length>0&&await Re(De,is)},qe=async De=>{var is,Qe;try{const ds={assigned_to:null};(await As.updateAssignedTo(De,ds)).success?(Ye(zs=>zs.map(Us=>Us.id===De?{...Us,assignedTo:void 0}:Us)),Z.success("Executive unassigned successfully")):Z.error("Failed to unassign executive")}catch(ds){console.error("Unassign executive failed:",ds),Z.error(((Qe=(is=ds==null?void 0:ds.response)==null?void 0:is.data)==null?void 0:Qe.message)||"Error unassigning executive")}},as=async()=>{if(u.length===0){Z.warn("No properties selected");return}de(!0);try{let De=0,is=0;for(const Qe of u)try{const ds={assigned_to:null};(await As.updateAssignedTo(Qe,ds)).success?(Ye(zs=>zs.map(Us=>Us.id===Qe?{...Us,assignedTo:void 0}:Us)),De++):is++}catch(ds){console.error(`Failed to unassign property ${Qe}:`,ds),is++}De>0&&Z.success(`${De} properties unassigned`),is>0&&Z.warn(`${is} properties failed to unassign`),c([])}catch(De){console.error("Bulk unassign failed:",De),Z.error("Error during bulk unassignment")}finally{de(!1)}},xs=async De=>{var is,Qe;if(u.length===0){Z.warn("No properties selected");return}de(!0);try{const ds=await As.bulkUpdateStatus({propertyIds:u,status:De,remarks:`Bulk status change to ${De}`,updatedBy:"User"});ds.success?(Ye(os=>os.map(zs=>u.includes(zs.id)?{...zs,status:De}:zs)),c([]),Z.success(`${ds.data.summary.successful} properties updated to ${De}`),ds.data.summary.failed>0&&Z.warn(`${ds.data.summary.failed} properties failed to update`)):Z.error("Failed to update properties status")}catch(ds){console.error("Bulk status update failed:",ds),Z.error(((Qe=(is=ds==null?void 0:ds.response)==null?void 0:is.data)==null?void 0:Qe.message)||"Error updating properties status")}finally{de(!1)}},ps=async De=>{var Qe,ds;if(!u.length)return Z.warn("No properties selected");const is=Array.from(new Set(De.map(os=>String(os).trim()).filter(Boolean)));if(!is.length)return Z.warn("Pick at least one tag");de(!0);try{for(const os of u){await Qt.add(os,is);const zs=String(os);Le(Us=>({...Us,[zs]:Array.from(new Set([...Us[zs]||[],...is]))}))}_e(os=>Array.from(new Set([...os,...is])).sort()),Z.success("Tags added to selected properties")}catch(os){console.error("Bulk add tags failed:",os),Z.error(((ds=(Qe=os==null?void 0:os.response)==null?void 0:Qe.data)==null?void 0:ds.message)||"Failed to add tags")}finally{de(!1)}},ys=async De=>{var Qe,ds;if(!u.length)return Z.warn("No properties selected");const is=Array.from(new Set(De.map(os=>String(os).trim()).filter(Boolean)));if(!is.length)return Z.warn("Pick at least one tag");de(!0);try{for(const os of u){await Qt.remove(os,is);const zs=String(os);Le(Us=>{const pt=(Us[zs]||[]).filter(Ht=>!is.some(qt=>qt.toLowerCase()===Ht.toLowerCase()));return{...Us,[zs]:pt}})}Z.success("Tags removed from selected properties")}catch(os){console.error("Bulk remove tags failed:",os),Z.error(((ds=(Qe=os==null?void 0:os.response)==null?void 0:Qe.data)==null?void 0:ds.message)||"Failed to remove tags")}finally{de(!1)}},He=async()=>{var De,is;if(u.length===0){Z.warn("No properties selected");return}de(!0);try{const Qe=await As.bulkMarkPublic({propertyIds:u,updatedBy:"User"});Qe.success?(Ye(ds=>ds.map(os=>u.includes(os.id)?{...os,isPublic:!0}:os)),c([]),Z.success(`${Qe.data.summary.successful} properties marked as public`),Qe.data.summary.failed>0&&Z.warn(`${Qe.data.summary.failed} properties failed to update`)):Z.error("Failed to mark properties as public")}catch(Qe){console.error("Bulk mark public failed:",Qe),Z.error(((is=(De=Qe==null?void 0:Qe.response)==null?void 0:De.data)==null?void 0:is.message)||"Error marking properties as public")}finally{de(!1)}},vs=async()=>{var De,is;if(u.length===0){Z.warn("No properties selected");return}de(!0);try{const Qe=await As.bulkMarkPrivate({propertyIds:u,updatedBy:"User"});Qe.success?(Ye(ds=>ds.map(os=>u.includes(os.id)?{...os,isPublic:!1}:os)),c([]),Z.success(`${Qe.data.summary.successful} properties marked as private`),Qe.data.summary.failed>0&&Z.warn(`${Qe.data.summary.failed} properties failed to update`)):Z.error("Failed to mark properties as private")}catch(Qe){console.error("Bulk mark private failed:",Qe),Z.error(((is=(De=Qe==null?void 0:Qe.response)==null?void 0:De.data)==null?void 0:is.message)||"Error marking properties as private")}finally{de(!1)}},_s=async()=>{if(u.length===0){Z.info("No properties selected to export.");return}de(!0);try{(await As.bulkExport({propertyIds:u,format:"csv",updatedBy:"User"})).success&&Z.success("Export completed successfully")}catch(De){console.error("Bulk export failed:",De);const is=Me.filter(lt=>u.includes(lt.id)),Qe=["ID","PropertyID","Title","Type","Subtype","UnitType","City","Location","Society","Status","Stage","Budget","IsPublic","AssignedTo"],ds=is.map(lt=>{var xa;return[String(lt.id),lt.propertyId??"",(lt.title??"").toString().replace(/\n/g," "),lt.type??"",lt.subtype??"",lt.unitType??"",lt.city??"",lt.location??"",lt.society??"",lt.status??"",lt.stage??"",String(lt.budget??""),lt.isPublic?"Yes":"No",((xa=lt.assignedTo)==null?void 0:xa.name)??""]}),os=lt=>{const xa=/[",\n]/.test(lt),At=lt.replace(/"/g,'""');return xa?`"${At}"`:At},zs=[Qe.join(","),...ds.map(lt=>lt.map(os).join(","))].join(`
`),Us=new Blob([zs],{type:"text/csv;charset=utf-8"}),pt=URL.createObjectURL(Us),Ht=document.createElement("a");Ht.href=pt;const qt=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");Ht.download=`properties_export_${qt}.csv`,document.body.appendChild(Ht),Ht.click(),Ht.remove(),URL.revokeObjectURL(pt),Z.success("Exported selected properties as CSV")}finally{de(!1)}},et=async()=>{var is,Qe;if(u.length===0){Z.warn("No properties selected");return}if(window.confirm(`Delete ${u.length} selected propert${u.length>1?"ies":"y"}? This cannot be undone.`)){de(!0);try{const ds=await As.bulkDelete({propertyIds:u,updatedBy:"User"});ds.success?(Ye(os=>os.filter(zs=>!u.includes(zs.id))),Pe(os=>{const zs=new Set(os);return u.forEach(Us=>zs.delete(String(Us))),zs}),c([]),Z.success(`${ds.data.summary.successful} properties deleted`),ds.data.summary.failed>0&&Z.warn(`${ds.data.summary.failed} properties failed to delete`)):Z.error("Failed to delete properties")}catch(ds){console.error("Bulk delete failed:",ds),Z.error(((Qe=(is=ds==null?void 0:ds.response)==null?void 0:is.data)==null?void 0:Qe.message)||"Error deleting properties")}finally{de(!1)}}},ts=async De=>{const is=Me.find(Qe=>Qe.id===De);if(is)try{const Qe=await As.setVisibility(De.toString(),!is.isPublic,"User");Qe.success?(Ye(ds=>ds.map(os=>os.id===De?{...os,isPublic:Qe.data.isPublic}:os)),Z.success(`Property marked as ${Qe.data.isPublic?"public":"private"}`)):Z.error("Failed to update property visibility")}catch(Qe){console.error("Toggle public failed:",Qe),Z.error("Error updating property visibility")}},js=De=>{H(De),$(!0)},Fs=De=>{H(De),k(!0)},ht=De=>{const is=Number(De);if(!Number.isFinite(is)||is<=0)return" - ";const Qe=1e7,ds=1e5;if(is>=Qe){const os=is/Qe;return`â‚¹${parseFloat(os.toFixed(2))}Cr`}if(is>=ds){const os=is/ds;return`â‚¹${parseFloat(os.toFixed(0))}L`}return`â‚¹${is.toLocaleString("en-IN")}`},vt=({assignedTo:De})=>!De||!De.name||De.name.trim()===""?null:e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs",children:[e.jsx(La,{size:10}),e.jsx("span",{className:"font-medium",children:De.name}),De.department&&e.jsxs("span",{className:"text-[10px] text-blue-500",children:["(",De.department,")"]})]});return N?e.jsx(pj,{property:N,onBack:$s,onEdit:Ze,onBuyerMatching:js,onViewBuyers:Fs,onUpdateProperty:De=>{P(De),Ye(is=>is.map(Qe=>Qe.id===De.id?{...Qe,...De}:Qe))}}):e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 lg:px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg",children:e.jsx(yt,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Property Management"}),e.jsx("p",{className:"text-gray-600 text-xs",children:"Complete property lifecycle management with buyer matching"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[n&&e.jsxs("button",{onClick:()=>F(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-md hover:from-green-600 hover:to-emerald-700 transition-all text-xs",children:[e.jsx(dt,{size:14}),e.jsx("span",{children:"Import"})]}),t&&e.jsxs("button",{onClick:Ne,className:"flex items-center space-x-1.5 px-3 py-1.5 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-md hover:from-blue-600 hover:to-indigo-700 transition-all text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add"})]}),o&&e.jsxs("button",{onClick:gs,className:"flex items-center space-x-1.5 px-3 py-1.5 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-md hover:from-blue-600 hover:to-indigo-700 transition-all text-xs",children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"brochureDownloads"})]})]})]}),e.jsx(Lj,{isOpen:U,onClose:()=>X(!1)}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mt-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-3 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Total Properties"}),e.jsx("p",{className:"text-lg font-bold",children:Me.length})]}),e.jsx(yt,{size:18,className:"text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-indigo-600 rounded-lg p-3 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-xs",children:"Total Views"}),e.jsx("p",{className:"text-lg font-bold",children:O}),e.jsxs("p",{className:"text-xs text-indigo-200",children:["Unique: ",ze]})]}),e.jsx(ks,{size:18,className:"text-indigo-300"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-3 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"Available"}),e.jsx("p",{className:"text-lg font-bold",children:Me.filter(De=>De.status==="Available").length})]}),e.jsx(bs,{size:18,className:"text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-3 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-xs",children:"Sold"}),e.jsx("p",{className:"text-lg font-bold",children:Me.filter(De=>De.status==="Sold").length})]}),e.jsx(Ct,{size:18,className:"text-purple-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-3 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-xs",children:"Assigned"}),e.jsx("p",{className:"text-lg font-bold",children:Me.filter(De=>De.assignedTo).length})]}),e.jsx(La,{size:18,className:"text-orange-200"})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:Ue.map(De=>e.jsxs("button",{onClick:()=>d(De.id),className:Oj(b===De.id,De.color),children:[e.jsx("span",{className:"font-medium text-xs",children:De.label}),e.jsx("span",{className:Uj(b===De.id,De.color),children:De.count})]},De.id))})})]}),e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 lg:px-6 py-3",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 flex items-center space-x-2",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search properties...",value:v,onChange:De=>x(De.target.value),className:"w-full pl-8 pr-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs"})]}),e.jsxs("button",{onClick:()=>j(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 text-xs",children:[e.jsx(Na,{size:14}),e.jsx("span",{children:"Filters"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>D("grid"),className:`p-1.5 rounded ${L==="grid"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:e.jsx(Uc,{size:14})}),e.jsx("button",{onClick:()=>D("list"),className:`p-1.5 rounded ${L==="list"?"bg-blue-100 text-blue-600":"text-gray-400"}`,children:e.jsx(dn,{size:14})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:M,onChange:De=>A(Number(De.target.value)),className:"px-2 py-1.5 border border-gray-300 rounded-md text-xs",children:[e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),o&&e.jsxs("button",{onClick:_s,disabled:ee,className:"flex items-center space-x-1.5 px-3 py-1.5 border border-gray-300 rounded-md hover:bg-gray-50 text-xs disabled:opacity-50",children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"Export"})]})]})]}),u.length>0&&(r||m||g||o)&&e.jsx("div",{className:"bg-blue-50 border-b border-blue-200 px-4 mt-2 lg:px-6 py-2.5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-medium text-blue-700",children:[u.length," selected"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[r&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>xs("Available"),disabled:ee,className:"px-2.5 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700 disabled:opacity-50",children:"Mark Available"}),e.jsx("button",{onClick:()=>xs("Sold"),disabled:ee,className:"px-2.5 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 disabled:opacity-50",children:"Mark Sold"})]}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:te,disabled:ee||S,className:"px-2.5 py-1 bg-indigo-600 text-white rounded text-xs hover:bg-indigo-700 disabled:opacity-50 flex items-center space-x-1",children:[e.jsx(Wr,{size:12}),e.jsx("span",{children:"Assign Executive"})]}),e.jsxs("button",{onClick:as,disabled:ee,className:"px-2.5 py-1 bg-gray-600 text-white rounded text-xs hover:bg-gray-700 disabled:opacity-50 flex items-center space-x-1",children:[e.jsx(Mi,{size:12}),e.jsx("span",{children:"Unassign Executive"})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>He(),disabled:ee,className:"px-2.5 py-1 bg-indigo-600 text-white rounded text-xs hover:bg-indigo-700 disabled:opacity-50",children:"Mark Public"}),e.jsx("button",{onClick:()=>vs(),disabled:ee,className:"px-2.5 py-1 bg-gray-600 text-white rounded text-xs hover:bg-gray-700 disabled:opacity-50",children:"Mark Private"})]}),o&&e.jsx("button",{onClick:_s,disabled:ee,className:"px-2.5 py-1 bg-purple-600 text-white rounded text-xs hover:bg-purple-700 disabled:opacity-50",children:"Export"}),g&&e.jsx("button",{onClick:et,disabled:ee,className:"px-2.5 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 disabled:opacity-50",children:"Delete"})]}),(r||m)&&e.jsxs("div",{className:"relative bulk-tags-menu",children:[e.jsx("button",{onClick:De=>{De.stopPropagation(),Ke(!Ee),ye(null)},className:"px-2.5 py-1 bg-gray-800 text-white rounded text-xs hover:bg-gray-900 transition-colors",children:"Tags"}),Ee&&e.jsx("div",{className:"absolute z-20 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg min-w-[230px] right-0",children:e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Bulk Tag Operations"}),e.jsxs("div",{className:"tag-picker-container",children:[e.jsx(Gm,{label:"Add",knownTags:Ve,selectedPropertyIds:u,propTags:$e,onApply:De=>{ps(De),Ke(!1),ye(null)},isOpen:Xe==="add",onToggle:()=>{ye(Xe&&Xe!=="add"?"add":Xe==="add"?null:"add")},onClose:()=>ye(null)}),e.jsx(Gm,{label:"Remove",knownTags:Ve,selectedPropertyIds:u,propTags:$e,onApply:De=>{ys(De),Ke(!1),ye(null)},isOpen:Xe==="remove",onToggle:()=>{ye(Xe&&Xe!=="remove"?"remove":Xe==="remove"?null:"remove")},onClose:()=>ye(null)})]})]})})]})]}),e.jsx("button",{onClick:()=>c([]),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Clear selection",children:e.jsx(ns,{size:14})})]})}),e.jsx(Tj,{isOpen:T,onClose:()=>{j(!1),B(1)},filters:_,setFilters:ae,clearFilters:ke,typeOptions:((G==null?void 0:G["property type"])||[]).map(De=>({label:De.label,value:De.value})),statusOptions:((G==null?void 0:G["property status"])||[]).map(De=>({label:De.label,value:De.value})),priceRangeOptions:((G==null?void 0:G["price range"])||[]).map(De=>({label:De.label,value:De.value})),locationOptions:((G==null?void 0:G.location)||[]).map(De=>({label:De.label,value:De.value})),sellerOptions:((G==null?void 0:G.sellers)||(G==null?void 0:G.agents)||[]).map(De=>({label:De.label,value:De.value})),stageOptions:((G==null?void 0:G["property stages"])||[]).map(De=>({label:De.label,value:De.value})),tagsOptions:je.map(De=>({label:De,value:De})),executiveOptions:ne.map(De=>({label:De.name,value:String(De.id)})),executivesLoading:S})]}),J&&e.jsx("div",{className:"flex-1 grid place-items-center text-gray-600 text-sm",children:"Loading propertiesâ€¦"}),!J&&Q&&e.jsx("div",{className:"flex-1 grid place-items-center",children:e.jsxs("div",{className:"max-w-md w-full bg-red-50 border border-red-200 rounded-lg p-4 text-sm",children:[e.jsx("div",{className:"font-semibold text-red-700 mb-1",children:"Couldn't load properties"}),e.jsx("div",{className:"text-red-700/90",children:Q}),se&&e.jsx("div",{className:"mt-2 text-red-600",children:"Looks like you're offline or the server is unreachable."}),e.jsx("div",{className:"mt-3 flex gap-2",children:e.jsx("button",{onClick:Je,className:"px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})})]})}),!J&&!Q&&Oe.length===0&&e.jsx("div",{className:"flex-1 grid place-items-center text-gray-500 text-sm p-8",children:'No properties found. Try changing filters or click "Add Property".'}),!J&&!Q&&Oe.length>0&&e.jsx("div",{className:"flex-1 overflow-auto",children:L==="grid"?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:cs.map(De=>{var is;return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-all group",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-t-xl cursor-pointer group",role:"button",tabIndex:0,"aria-label":"Open property details",onClick:()=>ls(De),onKeyDown:Qe=>{(Qe.key==="Enter"||Qe.key===" ")&&ls(De)},children:[e.jsx(Jm,{srcCandidate:Array.isArray(De.photos)&&De.photos.length>0?De.photos[0]:"",alt:ca(De.title),className:"w-full h-48 rounded-t-xl transition-transform duration-300 ease-out group-hover:scale-105",propertyCtx:{title:De.title,propertyId:De.propertyId}}),(r||i||m||g)&&e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("input",{type:"checkbox",checked:u.includes(De.id),onChange:()=>Se(De.id),onClick:Qe=>Qe.stopPropagation(),className:"h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsxs("div",{className:"absolute top-3 right-3 flex max-w-[78%] flex-wrap gap-1 justify-end",children:[e.jsx(Km,{tags:$e[String(De.id)]||[],onClickTag:Be}),De.isPublic?e.jsx("span",{className:"px-2 py-1 rounded-full text-[11px] font-semibold bg-green-50 text-green-700 ring-1 ring-green-200 shadow-sm",children:"PUBLIC"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-[11px] font-semibold bg-red-50 text-red-700 ring-1 ring-red-200 shadow-sm",children:"PRIVATE"})]}),e.jsx("div",{className:"absolute bottom-3 left-3",children:Zm(De.status)})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{children:e.jsxs("div",{className:" text-xs font-bold text-gray-900 mb-1 group-hover:text-blue-600 transition-colors",children:[De.type&&De.type!==" - "&&e.jsx("span",{className:"mr-2",children:De.type}),De.unitType&&De.unitType!==" - "&&e.jsxs("span",{className:"mr-2",children:[" ",De.unitType]}),De.subtype&&De.subtype!==" - "&&e.jsxs("span",{className:"mr-2",children:[" ",De.subtype]})]})}),e.jsx("div",{className:"text-xs text-gray-500",children:ca(De.propertyId)})]}),e.jsx("div",{className:"text-xl font-bold text-green-600 mb-2",children:ht(De.budget)}),De.assignedTo&&e.jsx("div",{className:"mb-2",children:e.jsx(vt,{assignedTo:De.assignedTo})}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Is,{size:12}),e.jsxs("span",{children:[De.unitType&&De.unitType!==" - "?`${De.unitType}`:"Unit",De.carpetArea?` â€¢ ${ca(De.carpetArea)} sq ft`:""]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Qs,{size:12}),e.jsx("span",{children:[De.location,De.city].filter(Boolean).join(", ")||" - "})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Ms,{size:12}),e.jsx("span",{children:ca((is=De.seller)==null?void 0:is.name)})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Xm(De.stage),e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[e.jsx(ks,{size:10}),e.jsxs("span",{children:[Number(De.visits)||0," visits"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>ls(De),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"View Details"}),e.jsx("button",{onClick:()=>js(De),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Match Buyers",children:e.jsx(Ns,{size:16})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),Fe(oe===De.id?null:De.id)},className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",children:e.jsx(xr,{size:16})}),oe===De.id&&e.jsx("div",{className:"absolute right-0 top-10 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[160px]",children:e.jsxs("div",{className:"p-1",children:[De.assignedTo?e.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),qe(De.id),Fe(null)},className:"flex items-center space-x-2 px-3 py-2 text-xs text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(Mi,{size:12}),e.jsx("span",{children:"Unassign Executive"})]}):e.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),z(De),Fe(null)},className:"flex items-center space-x-2 px-3 py-2 text-xs text-blue-600 hover:bg-blue-100 rounded w-full text-left",children:[e.jsx(Wr,{size:12}),e.jsx("span",{children:"Assign Executive"})]}),r&&e.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),Ze(De),Fe(null)},className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(ft,{size:12}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),ts(De.id),Fe(null)},className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(_t,{size:12}),e.jsx("span",{children:De.isPublic?"Make Private":"Make Public"})]}),i&&e.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),Gs(De.id),Fe(null)},className:"flex items-center space-x-2 px-3 py-2 text-xs text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(Es,{size:12}),e.jsx("span",{children:"Delete"})]})]})})]})]})]})]},De.id)})})}):e.jsx("div",{className:"bg-white",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[(r||i||m||g)&&e.jsx("th",{className:"px-4 py-3 text-left w-8",children:e.jsx("input",{type:"checkbox",checked:u.length===cs.length&&cs.length>0,onChange:Ge,className:"h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Property Details"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Location & Seller"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Specifications"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status & Stage"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Assigned To"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Performance"}),(r||i||m)&&e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:cs.map(De=>{var is;return e.jsxs("tr",{className:"group hover:bg-gray-50 transition-colors",children:[(r||i||m||g)&&e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:u.includes(De.id),onChange:()=>Se(De.id),className:"h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",className:"relative",onClick:()=>ls(De),"aria-label":"Open property details",children:e.jsx(Jm,{srcCandidate:Array.isArray(De.photos)&&De.photos.length>0?De.photos[0]:"",alt:ca(De.title),className:"w-12 h-12 rounded-lg transition-transform duration-300 ease-out group-hover:scale-110",propertyCtx:{title:De.title,propertyId:De.propertyId}})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-gray-900 text-lg",children:[De.type&&De.type!==" - "&&e.jsx("span",{className:"mr-2",children:De.type}),De.unitType&&De.unitType!==" - "&&e.jsxs("span",{className:"mr-2",children:[" ",De.unitType]}),De.subtype&&De.subtype!==" - "&&e.jsxs("span",{className:"mr-2",children:[" ",De.subtype]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:ca(De.propertyId)}),e.jsx("div",{className:"text-sm font-bold text-green-600",children:ht(De.budget)})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium",children:[De.location,De.city].filter(Boolean).join(", ")||" - "}),e.jsx("div",{className:"text-xs text-gray-600",children:ca(De.society)}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Seller: ",ca((is=De.seller)==null?void 0:is.name)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{children:[ca(De.unitType)," â€¢ ",ca(De.carpetArea)," sq ft"]}),e.jsxs("div",{children:[ca(De.floor)," of ",ca(De.totalFloors)]}),e.jsx("div",{children:ca(De.furnishing)}),e.jsxs("div",{children:["Parking: ",ca(De.parkingQty)," ",ca(De.parkingType)]}),e.jsx(Km,{tags:$e[String(De.id)]||[],className:"mt-2"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-2",children:[Zm(De.status),Xm(De.stage),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-1 rounded-full",style:{width:`${Number(De.stageProgress)||0}%`}})})]})}),e.jsx("td",{className:"px-4 py-3",children:De.assignedTo?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(vt,{assignedTo:De.assignedTo})}):e.jsxs("button",{onClick:()=>z(De),className:"flex items-center space-x-1 px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 rounded border border-blue-200 transition-colors",children:[e.jsx(Wr,{size:10}),e.jsx("span",{children:"Assign"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ks,{size:10,className:"text-blue-500"}),e.jsxs("span",{children:[Number(De.visits)||0," visits"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ns,{size:10,className:"text-green-500"}),e.jsxs("span",{children:[Number(De.interestedBuyers)||0," buyers"]})]}),De.isPublic&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_t,{size:10,className:"text-purple-500"}),e.jsxs("span",{children:[Number(De.publicViews)||0," views"]})]})]})}),(r||i||m)&&e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>ls(De),className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded transition-colors",title:"View Property",children:e.jsx(ks,{size:14})}),e.jsx("button",{onClick:()=>js(De),className:"p-1.5 text-green-600 hover:bg-green-100 rounded transition-colors",title:"Match Buyers",children:e.jsx(Ns,{size:14})}),De.assignedTo?e.jsx("button",{onClick:()=>qe(De.id),className:"p-1.5 text-red-600 hover:bg-red-100 rounded transition-colors",title:"Unassign Executive",children:e.jsx(Mi,{size:14})}):e.jsx("button",{onClick:()=>z(De),className:"p-1.5 text-indigo-600 hover:bg-indigo-100 rounded transition-colors",title:"Assign Executive",children:e.jsx(Wr,{size:14})}),r&&e.jsx("button",{onClick:()=>Ze(De),className:"p-1.5 text-orange-600 hover:bg-orange-100 rounded transition-colors",title:"Edit",children:e.jsx(ft,{size:14})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),Fe(oe===De.id?null:De.id)},className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:e.jsx(xr,{size:14})}),oe===De.id&&e.jsx("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[160px]",children:e.jsxs("div",{className:"p-1",children:[e.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),ts(De.id),Fe(null)},className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(_t,{size:12}),e.jsx("span",{children:De.isPublic?"Make Private":"Make Public"})]}),i&&e.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),Gs(De.id),Fe(null)},className:"flex items-center space-x-2 px-3 py-2 text-xs text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(Es,{size:12}),e.jsx("span",{children:"Delete"})]})]})})]})]})})]},De.id)})})]})})}),!J&&!Q&&Oe.length>0&&e.jsx("div",{className:"bg-white border-t border-gray-200 px-4 lg:px-6 py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",Oe.length?ms+1:0,"-",Math.min(ms+M,Oe.length)," of ",Oe.length]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>B(De=>Math.max(De-1,1)),disabled:W===1,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Wa,{size:14})}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,rs)},(De,is)=>{const Qe=is+1;return e.jsx("button",{onClick:()=>B(Qe),className:`px-2 py-1 rounded text-xs ${W===Qe?"bg-blue-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:Qe},Qe)})}),e.jsx("button",{onClick:()=>B(De=>Math.min(De+1,rs)),disabled:W===rs,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:14})})]})]})}),ee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Processing bulk operation..."})]})}),e.jsx(Dj,{isOpen:h,onClose:()=>{Y(!1),q(null)},executives:ne,selectedProperties:u,onAssign:Te,isBulk:!K&&u.length>0}),f&&e.jsx(no,{isOpen:f,onClose:()=>{p(!1),V(null)},mode:E?"edit":"create",propertyId:E==null?void 0:E.id,initialData:E?Bj(E):null,onSubmit:async()=>{await Je(),Z.success(E?"Property updated successfully":"Property created successfully")}},E?`edit-${E.id}`:"create-new"),w&&I&&e.jsx(tg,{isOpen:w,onClose:()=>{$(!1),H(null)},property:I}),y&&I&&e.jsx(jj,{isOpen:y,onClose:()=>{k(!1),H(null)},property:I}),R&&e.jsx(Cj,{isOpen:R,onClose:()=>F(!1),onImport:De=>{const is=(Array.isArray(De)?De:[]).map((Qe,ds)=>Qm(Qe,ds));is.length&&Ye(Qe=>[...is,...Qe])},onDone:async()=>{await Je(),F(!1)}})]})};function Zm(s){const a={Available:{bg:"bg-green-100",text:"text-green-700",label:"Available",icon:"ðŸŸ¢"},Sold:{bg:"bg-red-100",text:"text-red-600",label:"Sold",icon:"ðŸ”´"},"Under Negotiation":{bg:"bg-orange-100",text:"text-orange-700",label:"Under Negotiation",icon:"ðŸŸ¡"},"On Hold":{bg:"bg-gray-100",text:"text-gray-700",label:"On Hold",icon:"âš«"},Finalization:{bg:"bg-purple-100",text:"text-purple-700",label:"Finalization",icon:"ðŸŸ£"}," - ":{bg:"bg-gray-100",text:"text-gray-700",label:" - ",icon:"â€¢"}}[s]||{bg:"bg-gray-100",text:"text-gray-700",label:ca(s),icon:"â€¢"};return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${a.bg} ${a.text}`,children:[a.icon," ",a.label]})}function Xm(s){const a={initial_contact:{bg:"bg-blue-100",text:"text-blue-700",label:"Initial Contact",icon:"ðŸ“ž"},property_collection:{bg:"bg-purple-100",text:"text-purple-700",label:"Property Collection",icon:"ðŸ "},mandate_signed:{bg:"bg-green-100",text:"text-green-700",label:"Mandate Signed",icon:"âœ…"},selling_process:{bg:"bg-indigo-100",text:"text-indigo-700",label:"Selling Process",icon:"ðŸ”„"},deal_closure:{bg:"bg-pink-100",text:"text-pink-700",label:"Deal Closure",icon:"ðŸ“‹"}}[s]||{bg:"bg-gray-100",text:"text-gray-700",label:ca(s),icon:"â€¢"};return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${a.bg} ${a.text}`,children:[a.icon," ",a.label]})}const Vj=!0,ex=s=>String(s??"").trim().toLowerCase().replace(/\s+/g,"_"),pi=(s,a)=>{if(!a)return"";const t=ex(a),r=(s||[]).find(i=>ex(i.value??i.label)===t);return r?r.value??r.label:a||""},Wj=s=>(s??"").split("_").filter(Boolean).map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),bi=(...s)=>s.find(a=>a!=null&&String(a).trim()!==""),dg=s=>String(s.property_id??s.id??s._id??""),Hj=s=>{const a=bi(s.property_type_name,s.property_type,s.type,s.category,s.type_name,s.propertyType)??"",t=bi(s.unit_type,s.unitType,s.unit_type_name,s.flat_type,s.configuration,s.bhk,s.bhk_label)??"",r=bi(s.property_subtype_name,s.property_sub_type,s.property_subtype,s.subtype,s.propertySubType,s.segment,s.property_subtype_name)??"",i=bi(s.society_name,s.society,s.project_name,s.societyName,s.project,s.location_name)??"",n=[a,t,r].map(b=>String(b||"").trim()).filter(Boolean),o=n.length?n.join("  "):s.title||"Property",m=i?`${o} â€” ${String(i).trim()}`:o;if(m)return m;const g=s.title||s.society_name||s.name||s.location_name;return g?String(g):"Property"},Yj=s=>{const a=dg(s);return a?`REX ${a}`:""},mg=s=>(Array.isArray(s)?s:[]).map(a=>{var n;const t=dg(a),i={id:t||`P-${Math.random().toString(36).slice(2,11)}`,title:Hj(a),address:a.address||[a.location_name||a.locality_name,a.city_name||a.city].filter(Boolean).join(", "),price:a.budget??a.price??a.expected_price??"",size:a.carpet_area??a.area??a.super_builtup_area??"",image:a.image||a.photo||(Array.isArray(a.photos)?((n=a.photos[0])==null?void 0:n.url)||a.photos[0]:""),_rxpBadge:Yj(a),_pid:t,_rawProperty:a};return console.log("[adaptProperties] RAW â†’ BASE",a,i),i}),Gj=s=>(Array.isArray(s)?s:[]).map(a=>({id:Number(a.id??a.coSeller_id??a._id)||void 0,seller_id:Number(a.seller_id??a.parent_id)||void 0,coSeller_salutation:a.coSeller_salutation??a.salutation??"Mr.",coSeller_name:a.coSeller_name??a.name??"",coSeller_phone:a.coSeller_phone??a.phone??"",coSeller_whatsapp:a.coSeller_whatsapp??a.whatsapp??"",coSeller_email:a.coSeller_email??a.email??"",coSeller_dob:a.coSeller_dob??a.dob??"",coSeller_sameAsPhone:!!(a.coSeller_sameAsPhone??a.sameAsPhone),coSeller_relation:a.coSeller_relation??a.relation??""})),Kj=s=>{if(typeof s=="boolean")return s;if(s==null)return!1;const a=String(s).trim().toLowerCase();return a==="1"||a==="true"||a==="yes"||a==="y"},Nn=s=>!String(s??"").trim(),tn=new Date,sx=s=>String(s).padStart(2,"0"),Jj=s=>`${s.getFullYear()}-${sx(s.getMonth()+1)}-${sx(s.getDate())}`,Qj=new Date(tn.getFullYear()-18,tn.getMonth(),tn.getDate()),Kl=Jj(Qj),Zj=s=>{const a=typeof s=="string"?Number(s):s;return a==null||Number.isNaN(a)||a===""?"":a.toLocaleString("en-IN")},Xj=(s,a,t,r,i)=>{var b;if(!s)return{salutation:"Mr.",seller_dob:Kl,countryCode:"+91",properties:[],coSellers:[],source:""};const n=pi(a,(b=s.stage)!=null&&b.includes("_")?Wj(s.stage):s.stage),o=pi(t,s.priority),m=pi(r,s.status),g=pi(i,s.source);return{id:Number(s.id??s.seller_id??s._id),salutation:s.salutation??"Mr.",name:s.name??"",phone:s.phone??"",whatsapp:s.whatsapp??"",email:s.email??"",state:s.state??"",city:s.city??"",location:s.location??"",stage:n||"",leadType:s.leadType??s.lead_type??"",priority:o||"",status:m||"",source:g||"",assigned_to:s.assigned_to??s.assigned_to_id??"",assigned_to_name:s.assigned_to_name??s.assigned??"",notes:s.notes??"",seller_dob:s.seller_dob??s.dob??Kl,created_at:s.created_at,updated_at:s.updated_at,lastActivity:s.lastActivity,visits:s.visits,notifications:s.notifications,properties:mg(s.properties),coSellers:Gj(s.coSellers??s.cosellers)}},ev=({isOpen:s,onClose:a,seller:t,onSave:r})=>{const{user:i}=Hs(),[n,o]=l.useState({salutation:"Mr.",name:"",phone:"",whatsapp:"",email:"",state:"",city:"",location:"",stage:"",leadType:"",priority:"",status:"",properties:[],coSellers:[],notes:"",seller_dob:Kl,countryCode:"+91",assigned_to:"",assigned_to_name:"",source:""}),[m,g]=l.useState(!1),[b,d]=l.useState(!1),[v,x]=l.useState(!1),[u,c]=l.useState(!0),[f,p]=l.useState({}),[N,P]=l.useState(null),[w,$]=l.useState([]),[y,k]=l.useState("");l.useEffect(()=>{if(!s)return;let G=!0;return(async()=>{try{c(!0);const me=await Gt(["common","seller","lead"]);if(!G)return;p(me||{})}catch(me){console.error("Error fetching master options:",me)}finally{c(!1)}})(),()=>{G=!1}},[s]),l.useEffect(()=>{if(!s)return;let G=!0;return(async()=>{try{const me=$e=>{const Le=($e==null?void 0:$e.first_name)||($e==null?void 0:$e.firstName)||"",je=($e==null?void 0:$e.last_name)||($e==null?void 0:$e.lastName)||"",_e=`${Le} ${je}`.trim();return _e||($e!=null&&$e.name?$e.name:$e!=null&&$e.username?$e.username:$e!=null&&$e.email?$e.email.split("@")[0]:"Sales Executive")};let oe=[];try{if(Os.getSalesExecutives){const $e=await Os.getSalesExecutives();$e&&(Array.isArray($e)||$e.items||$e.data)&&(oe=Array.isArray($e)?$e:$e.items||$e.data||[])}}catch{console.log("getSalesExecutives failed, trying next method...")}if(oe.length===0&&Os.getAllUsers){const $e=await Os.getAllUsers();oe=(Array.isArray($e)?$e:($e==null?void 0:$e.data)||[]).filter(je=>{const _e=String((je==null?void 0:je.department)||"").toLowerCase(),ve=String((je==null?void 0:je.role)||"").toLowerCase();return _e.includes("sales")&&ve.includes("executive")})}const Fe=oe.map($e=>({id:$e.id||$e.userId||$e._id,name:me($e),first_name:$e.first_name||$e.firstName||"",last_name:$e.last_name||$e.lastName||"",email:$e.email||"",phone:$e.phone||$e.mobile||"",department:$e.department||"Sales",role:$e.role||"Sales Executive"}));if(!G)return;$(Fe)}catch(me){console.error("Error fetching sales users:",me),$([])}})(),()=>{G=!1}},[s]);const{fetchProperties:R,properties:F,loadingProps:T}=cd({autoLog:!1}),j=l.useRef(!1);l.useEffect(()=>{!s||j.current||(j.current=!0,R().then(()=>{console.log("[SellerFormModal] fetchProperties called")}).catch(console.error))},[s,R]),l.useEffect(()=>{s||(j.current=!1)},[s]);const E=f.salutation||[{value:"Mr.",label:"Mr."},{value:"Mrs.",label:"Mrs."},{value:"Ms.",label:"Ms."},{value:"Dr.",label:"Dr."}],V=f.state||[],W=f.city||[],B=f["Seller lead stage"]||f["seller lead stage"]||[],M=f["lead type"]||[],A=f["lead priority"]||[],L=f["Seller lead Status"]||f["seller lead status"]||[],D=f["lead source"]||f["Lead Source"]||[];l.useEffect(()=>{if(!s)return;const G=Xj(t,B,A,L,D);if(o(G),console.log("[SellerFormModal] Incoming seller â†’ FormData",t,G),G.phone){const me=String(G.phone),oe=me.replace(/\D/g,"").slice(-10),Fe=String(G.whatsapp??"").replace(/\D/g,"");g(!!Fe&&(Fe===oe||Fe===me.replace(/^\+?91/,"")))}else g(!1)},[s,t==null?void 0:t.id,B==null?void 0:B.length,A==null?void 0:A.length,L==null?void 0:L.length,D==null?void 0:D.length]);const I=l.useMemo(()=>{if(!Array.isArray(F)||!F.length)return[];const G=F.filter(me=>{const oe=Kj(me.is_public??me.isPublic??me.public),Fe=!(me.seller_id??me.sellerId??me.owner_seller_id);return oe&&Fe}).slice(0,50).map(me=>mg([me])[0]);return console.log("[SellerFormModal] availableProperties",G),G},[F]),H=l.useMemo(()=>{if(!y.trim())return I;const G=y.toLowerCase().trim();return I.filter(me=>{var Fe,$e,Le,je;return[me.title||"",me.address||"",me._rxpBadge||"",me._pid||"",((Fe=me._rawProperty)==null?void 0:Fe.society_name)||"",(($e=me._rawProperty)==null?void 0:$e.project_name)||"",((Le=me._rawProperty)==null?void 0:Le.location_name)||"",((je=me._rawProperty)==null?void 0:je.locality_name)||""].some(_e=>_e.toLowerCase().includes(G))})},[I,y]),h=l.useMemo(()=>W.filter(G=>!n.state||G.parentValue===n.state),[W,n.state]),Y=f.location||[],K=l.useMemo(()=>Y.filter(G=>n.city&&G.parentValue===n.city||!n.city&&n.state&&G.grandParentValue===n.state?!0:!n.state&&!n.city),[Y,n.city,n.state]);if(!s)return null;const q=l.useCallback((G,me)=>o(oe=>({...oe,[G]:me})),[]),ne=(G,me)=>{if(!me||!G)return"";const oe=me.dialCode||"",Fe=G.replace(/^\+/,"");return Fe.startsWith(oe)?Fe.slice(oe.length):Fe},le=l.useCallback(()=>{g(G=>{const me=!G;if(me&&n.phone&&N){const oe=ne(String(n.phone),N);o(Fe=>({...Fe,whatsapp:oe}))}return me})},[n.phone,N]),S=l.useCallback((G,me)=>{P(me),o(oe=>{const Fe={...oe,phone:G};return m&&me&&(Fe.whatsapp=ne(String(G),me)),Fe})},[m]),C=l.useCallback(G=>o(me=>({...me,whatsapp:G.target.value})),[]),J=l.useCallback(G=>{const me=I.find(Fe=>String(Fe.id)===String(G));if(console.log("[SellerFormModal] handlePropertySelection",G,me),!me)return;if((n.properties||[]).find(Fe=>String(Fe.id)===String(G))){console.warn("[SellerFormModal] Property already added:",G),x(!1);return}o(Fe=>({...Fe,properties:[...Fe.properties||[],{...me,id:String(me.id)}]})),x(!1),k("")},[I,n.properties]),ue=l.useCallback(G=>{console.log("[SellerFormModal] removeProperty",G),o(me=>({...me,properties:(me.properties||[]).filter(oe=>String(oe.id)!==String(G))}))},[]),Q=l.useCallback(()=>{o(G=>({...G,coSellers:[...G.coSellers||[],{coSeller_salutation:"Mr.",coSeller_name:"",coSeller_phone:"",coSeller_whatsapp:"",coSeller_email:"",coSeller_dob:"",coSeller_sameAsPhone:!1,coSeller_relation:""}]}))},[]),he=l.useCallback((G,me,oe)=>{o(Fe=>({...Fe,coSellers:(Fe.coSellers||[]).map(($e,Le)=>Le===G?{...$e,[me]:oe}:$e)}))},[]),se=l.useCallback(G=>{o(me=>({...me,coSellers:(me.coSellers||[]).filter((oe,Fe)=>Fe!==G)}))},[]),ge=l.useCallback((G,me,oe)=>{o(Fe=>({...Fe,coSellers:(Fe.coSellers||[]).map(($e,Le)=>{if(Le!==G)return $e;const je={...$e,coSeller_phone:me};return $e.coSeller_sameAsPhone&&oe&&(je.coSeller_whatsapp=ne(String(me),oe)),je})}))},[]),ee=l.useCallback((G,me)=>{o(oe=>({...oe,coSellers:(oe.coSellers||[]).map((Fe,$e)=>{if($e!==G)return Fe;const Le={...Fe,coSeller_sameAsPhone:me};if(me&&Fe.coSeller_phone){const je=String(Fe.coSeller_phone);Le.coSeller_whatsapp=je.length>10?je.slice(-10):je}return Le})}))},[]),de=l.useMemo(()=>{const G=n.seller_dob;if(!G)return 0;const me=new Date(G);let oe=tn.getFullYear()-me.getFullYear();const Fe=tn.getMonth()-me.getMonth();return(Fe<0||Fe===0&&tn.getDate()<me.getDate())&&oe--,oe},[n.seller_dob]),U=de<18?"Seller must be at least 18 years old":"",X=G=>(G||"").replace(/\D/g,""),re=G=>Nn(G)?!0:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(G)),fe=l.useCallback(async()=>{var G;if(Nn(n.name))return alert("Please enter seller name");if(Nn(n.phone))return alert("Please enter phone number");if(!re(n.email))return alert("Please enter a valid email");if(de<18)return alert("Seller must be at least 18 years old");d(!0);try{const me=(n.coSellers||[]).map(je=>({id:je.id??void 0,seller_id:n.id?Number(n.id):void 0,salutation:je.coSeller_salutation||"Mr.",name:(je.coSeller_name||"").trim(),phone:X(je.coSeller_phone||""),whatsapp:X(je.coSeller_whatsapp||""),email:(je.coSeller_email||"").trim(),relation:je.coSeller_relation||"",dob:je.coSeller_dob||""})),oe=(n.coSellers||[]).map(je=>({id:je.id??void 0,coSeller_salutation:je.coSeller_salutation||"Mr.",coSeller_name:(je.coSeller_name||"").trim(),coSeller_phone:X(je.coSeller_phone||""),coSeller_whatsapp:X(je.coSeller_whatsapp||""),coSeller_email:(je.coSeller_email||"").trim(),coSeller_dob:je.coSeller_dob||"",coSeller_sameAsPhone:!!je.coSeller_sameAsPhone,coSeller_relation:je.coSeller_relation||""})),Fe=new Date().toISOString(),$e=n.assigned_to||((G=i==null?void 0:i.role)!=null&&G.toLowerCase().includes("executive")?i.id:""),Le={...n,phone:X(String(n.phone||"")),whatsapp:X(n.whatsapp||""),email:(n.email||"").trim(),assigned_to:$e,assigned_to_name:n.assigned_to_name||($e&&i?`${i.first_name||""} ${i.last_name||""}`.trim():""),coSellers:oe,cosellers:me};Vj&&console.log("[SellerFormModal] onSave payload",Le),await(r==null?void 0:r(Le))}catch(me){console.error("Error preparing seller:",me),alert("Failed to save seller")}finally{d(!1)}},[de,n,r]);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"px-6 py-2 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t?"Edit Seller":"Add New Seller"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Enter Seller information and property details"})]}),e.jsx("button",{onClick:a,className:"group p-2.5 rounded-xl bg-white hover:bg-red-50 transition-all duration-200 shadow-lg hover:shadow-xl border hover:border-red-200","aria-label":"Close",children:e.jsx(ns,{size:18,className:"text-gray-600 group-hover:text-red-500 transition-colors"})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("main",{className:"md:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:16})," Seller â€” Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salutation *"}),e.jsx("select",{value:n.salutation||"Mr.",onChange:G=>q("salutation",G.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:E.map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",value:n.name||"",onChange:G=>q("name",G.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter full name",required:!0})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(vc,{value:n.seller_dob||Kl,onChange:G=>o(me=>({...me,seller_dob:G})),label:"Date of Birth",required:!0,max:Kl,placeholder:"Select your date of birth",size:"sm"})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Cs,{className:"mr-2",size:16})," Seller â€” Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsx(qn,{country:"in",value:n.phone||"",onChange:S,inputProps:{name:"phone",required:!0,autoFocus:!1},inputClass:"!w-full !h-9 !text-xs",containerClass:"!w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["WhatsApp Number"," ",e.jsxs("span",{className:"ml-2 inline-flex items-center",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:le,className:"mr-1"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Same as phone"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-green-500 text-base pointer-events-none"}),e.jsx("input",{type:"tel",inputMode:"tel",placeholder:"Enter WhatsApp number",value:n.whatsapp||"",onChange:C,disabled:m,className:"w-full pl-9 pr-2 py-2 border rounded-lg text-xs disabled:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:n.email||"",onChange:G=>q("email",G.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address"})]})]})]}),e.jsxs("aside",{className:"md:col-span-2 space-y-6 text-xs",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Qs,{className:"mr-2",size:16})," Location Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[V.length?e.jsxs("select",{value:n.state||"",onChange:G=>{const me=G.target.value;q("state",me),me!==n.state&&(q("city",""),q("location",""))},className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select State"}),V.map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]}):e.jsx("input",{type:"text",value:n.state||"",onChange:G=>q("state",G.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"State"}),h.length||W.length?e.jsxs("select",{value:n.city||"",onChange:G=>{const me=G.target.value;q("city",me),me!==n.city&&q("location","")},className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select City"}),(h.length?h:W).map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]}):e.jsx("input",{type:"text",value:n.city||"",onChange:G=>q("city",G.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"City"}),K.length||Y.length?e.jsxs("select",{value:n.location||"",onChange:G=>q("location",G.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select Location"}),(K.length?K:Y).map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]}):e.jsx("input",{type:"text",value:n.location||"",onChange:G=>q("location",G.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Location/Area"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Xs,{className:"mr-2",size:16})," Lead Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Source"}),e.jsxs("select",{className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",value:n.source||"",onChange:G=>q("source",G.target.value),children:[e.jsx("option",{value:"",children:"Select source"}),D.map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Stage"}),e.jsxs("select",{className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",value:n.stage||"",onChange:G=>q("stage",G.target.value),children:[e.jsx("option",{value:"",children:"Select stage"}),B.map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Lead Type"}),e.jsxs("select",{className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",value:n.leadType||"",onChange:G=>q("leadType",G.target.value),children:[e.jsx("option",{value:"",children:"Select type"}),M.map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",value:n.priority||"",onChange:G=>q("priority",G.target.value),children:[e.jsx("option",{value:"",children:"Select priority"}),A.map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",value:n.status||"",onChange:G=>q("status",G.target.value),children:[e.jsx("option",{value:"",children:"Select status"}),L.map(G=>e.jsx("option",{value:G.value??G.label,children:G.label??G.value},G.value??G.label))]})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Assigned Executive"}),e.jsxs("select",{className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",value:String(n.assigned_to||""),onChange:G=>{const me=G.target.value,oe=w.find(Fe=>String(Fe.id)===String(me));q("assigned_to",me),q("assigned_to_name",oe?oe.name:"")},children:[e.jsx("option",{value:"",children:"Select Sales Executive"}),w.map(G=>e.jsx("option",{value:G.id,children:G.name},G.id))]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:16})," Properties (Only Public & Unassigned)"]}),e.jsxs("div",{className:"space-y-2",children:[(n.properties||[]).map(G=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg border hover:shadow-md",children:[G.image?e.jsx("img",{src:G.image,alt:G.title,className:"w-16 h-16 object-cover rounded-lg"}):e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center text-xs text-gray-500",children:"No Image"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:G.title}),G._rxpBadge&&e.jsx("span",{className:"shrink-0 px-2 py-0.5 rounded-full text-[10px] bg-blue-100 text-blue-700 border border-blue-200",children:G._rxpBadge})]}),e.jsx("div",{className:"text-[11px] text-gray-600 truncate",children:G.address}),G.price&&e.jsxs("div",{className:"text-[12px] text-green-600 font-semibold",children:["â‚¹ ",Zj(G.price)]}),G.size&&e.jsxs("div",{className:"text-[11px] text-gray-500",children:[G.size," sq.ft"]})]}),e.jsx("button",{onClick:()=>ue(G.id),className:"group p-2 text-red-500 hover:bg-red-50 rounded-lg transition-all duration-200 hover:shadow-md border border-transparent hover:border-red-200","aria-label":"Remove property",children:e.jsx(Es,{size:14,className:"group-hover:scale-110 transition-transform"})})]},G.id)),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>x(!0),disabled:T,className:"group flex items-center justify-center space-x-2 w-fit px-4 py-2 border-2 border-emerald-500 text-emerald-600 rounded-full hover:bg-emerald-500 hover:text-white transition-all duration-300 font-medium disabled:opacity-50",children:[e.jsx(yt,{size:18,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{children:T?"Loading...":"Add Property"})]})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:16})," Co-Sellers (Optional)"]}),e.jsxs("div",{className:"space-y-3",children:[(n.coSellers||[]).map((G,me)=>e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-[100px_1fr_1fr] gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salutation *"}),e.jsx("select",{value:G.coSeller_salutation||"Mr.",onChange:oe=>he(me,"coSeller_salutation",oe.target.value),className:"w-full px-2 py-1.5 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:E.map(oe=>e.jsx("option",{value:oe.value??oe.label,children:oe.label??oe.value},oe.value??oe.label))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:G.coSeller_name||"",onChange:oe=>he(me,"coSeller_name",oe.target.value),className:"w-full h-7 px-1 border rounded text-[10px] focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Co-Seller full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:G.coSeller_email||"",onChange:oe=>he(me,"coSeller_email",oe.target.value),className:"w-full h-7 px-1 border rounded text-[10px] focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Email address"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx(qn,{country:"in",value:G.coSeller_phone||"",onChange:(oe,Fe)=>ge(me,oe,Fe),inputProps:{name:`coSeller-phone-${me}`,autoFocus:!1},inputClass:"!w-full !h-7 !text-[10px]",containerClass:"!w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-medium text-gray-700 mb-1 flex items-center gap-1",children:[e.jsx(Ia,{className:"text-green-500",size:10})," WhatsApp Number",e.jsx("input",{type:"checkbox",checked:!!G.coSeller_sameAsPhone,onChange:oe=>ee(me,oe.target.checked),className:"ml-1 scale-75"}),e.jsx("span",{className:"text-[9px] text-gray-500",children:"Same as phone"})]}),e.jsx("input",{type:"tel",value:G.coSeller_whatsapp||"",onChange:oe=>he(me,"coSeller_whatsapp",oe.target.value),disabled:!!G.coSeller_sameAsPhone,className:"w-full h-7 px-1 border rounded text-[10px] disabled:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"WhatsApp Number"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsx(vc,{value:G.coSeller_dob||"",onChange:oe=>he(me,"coSeller_dob",oe),label:"Date of Birth",placeholder:"Select date of birth",size:"sm",max:Kl})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-gray-700 mb-1",children:"Relation to Seller"}),e.jsx("input",{type:"text",value:G.coSeller_relation||"",onChange:oe=>he(me,"coSeller_relation",oe.target.value),className:"w-full h-9 px-2 border rounded text-[10px] focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Spouse, Brother, Partner"})]})]}),e.jsx("button",{onClick:()=>se(me),className:"ml-3 group px-3 py-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-all duration-200 border border-transparent hover:border-red-200 hover:shadow-sm","aria-label":"Remove co-seller",children:e.jsx(Es,{size:12,className:"group-hover:scale-110 transition-transform"})})]})]})},`coseller-${me}`)),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:Q,className:"group flex items-center justify-center space-x-2 w-fit px-4 py-2 border-2 border-purple-500 text-purple-600 rounded-full hover:bg-purple-500 hover:text-white transition-all duration-300 font-medium",children:[e.jsx(Cl,{size:18,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{children:"Add Co-Seller"})]})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes||"",onChange:G=>q("notes",G.target.value),className:"w-full px-3 py-2 border rounded-lg text-xs focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes about the Seller..."})]}),U&&e.jsx("div",{className:"mt-2 text-[12px] text-red-600",children:U})]}),e.jsx("div",{className:"p-6 border-t bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:u&&e.jsx("span",{className:"ml-2",children:"â€¢ Loading master dataâ€¦"})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:a,className:"flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 text-sm font-medium",children:e.jsx("span",{children:"Cancel"})}),e.jsxs("button",{onClick:fe,disabled:b||Nn(n.name)||Nn(n.phone)||!!U,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:b?"Saving...":t?"Update Seller":"Save Seller"})]})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Select Property"}),e.jsx("button",{onClick:()=>{x(!1),k("")},className:"group p-2 hover:bg-red-50 rounded-lg transition-all duration-200 border border-transparent hover:border-red-200","aria-label":"Close property selector",children:e.jsx(ns,{size:20,className:"text-gray-600 group-hover:text-red-500 transition-colors"})})]}),e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",value:y,onChange:G=>k(G.target.value),placeholder:"Search properties by title, address, RXP ID...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Found ",H.length," properties"]})]}),e.jsx("div",{className:"p-4 max-h-96 overflow-y-auto space-y-3",children:H.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:y?`No properties found for "${y}"`:"No public, unassigned properties available."}):H.map(G=>e.jsxs("button",{onClick:()=>J(G.id),className:"group w-full flex items-center space-x-3 p-4 border border-gray-200 rounded-xl hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 hover:shadow-md transform hover:scale-[1.01]",children:[G.image?e.jsx("img",{src:G.image,alt:G.title,className:"w-16 h-16 object-cover rounded-lg"}):e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center text-xs text-gray-500",children:"No Image"}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-medium truncate",children:G.title}),G._rxpBadge&&e.jsx("span",{className:"shrink-0 px-2 py-0.5 rounded-full text-[10px] bg-blue-100 text-blue-700 border border-blue-200",children:G._rxpBadge})]}),e.jsx("div",{className:"text-sm text-gray-600 truncate",children:G.address}),G.price?e.jsxs("div",{className:"text-xs text-green-600 font-semibold",children:["â‚¹ ",Number(G.price).toLocaleString("en-IN")]}):null,G._pid&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["ID: ",G._pid]})]})]},G.id))})]})})]})})},sv=({isOpen:s,onClose:a,seller:t={},onUpdateStage:r})=>{var N,P,w;if(!s)return null;const[i,n]=l.useState((t==null?void 0:t.stage)??""),[o,m]=l.useState(""),[g,b]=l.useState(""),[d,v]=l.useState(!1),x=[{id:"initial_contact",label:"Initial Contact",description:"First contact with seller",progress:10,icon:"ðŸ“ž",tasks:["Contact seller and introduce services","Understand seller requirements","Schedule property visit","Collect basic property information"]},{id:"property_collection",label:"Property Collection",description:"Collecting property details",progress:25,icon:"ðŸ ",tasks:["Visit property for inspection","Collect property documents","Take professional photos","Gather all property specifications"]},{id:"mandate_discussion",label:"Mandate Discussion",description:"Discussing mandate terms",progress:40,icon:"ðŸ’¬",tasks:["Explain mandate agreement benefits","Discuss commission structure","Negotiate terms and conditions","Address seller concerns"]},{id:"mandate_signed",label:"Mandate Signed",description:"Exclusive mandate agreement signed",progress:60,icon:"âœ…",tasks:["Prepare mandate agreement","Get seller signature","Complete OTP verification","File signed agreement"]},{id:"selling_process",label:"Selling Process",description:"Active marketing and selling",progress:75,icon:"ðŸ”„",tasks:["List property on portals","Market to potential buyers","Arrange property visits","Handle buyer inquiries"]},{id:"deal_negotiation",label:"Deal Negotiation",description:"Negotiating with buyers",progress:85,icon:"ðŸ¤",tasks:["Receive buyer offers","Negotiate price and terms","Facilitate buyer-seller meetings","Finalize deal terms"]},{id:"deal_closure",label:"Deal Closure",description:"Completing the sale",progress:95,icon:"ðŸ“‹",tasks:["Prepare sale agreement","Coordinate documentation","Handle registration process","Ensure smooth handover"]},{id:"completed",label:"Completed",description:"Sale successfully completed",progress:100,icon:"ðŸŽ‰",tasks:["Sale completed successfully","All documents finalized","Commission received","Relationship maintained"]}],u=Math.max(0,x.findIndex($=>$.id===t.stage));x.findIndex($=>$.id===i);const c=x.find($=>$.id===i)??null,f=async()=>{if(!o.trim()){alert("Please provide remarks for stage update");return}if(!g.trim()){alert("Please specify the next action");return}v(!0);try{await r(i,o,g)}catch($){console.error("Error updating stage:",$)}finally{v(!1)}},p=$=>{const y=Math.max(0,u);return $<=y+1};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Update Seller Stage"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.name," - Stage Progression"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Current Stage"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:u+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:(N=x[u])==null?void 0:N.label}),e.jsx("div",{className:"text-sm text-blue-700",children:(P=x[u])==null?void 0:P.description}),e.jsxs("div",{className:"text-xs text-blue-600",children:["Progress: ",(w=x[u])==null?void 0:w.progress,"%"]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select New Stage"}),e.jsx("div",{className:"space-y-3",children:x.map(($,y)=>{const k=y<u,R=y===u,F=i===$.id,T=p(y);return e.jsxs("button",{onClick:()=>T&&n($.id),disabled:!T,className:`w-full flex items-center space-x-4 p-4 rounded-xl border-2 transition-all text-left ${F?"border-purple-500 bg-purple-50":T?"border-gray-200 hover:border-gray-300 hover:bg-gray-50":"border-gray-100 bg-gray-50 cursor-not-allowed opacity-50"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-lg ${k?"bg-green-500 text-white":R?"bg-blue-500 text-white":F?"bg-purple-500 text-white":"bg-gray-200 text-gray-500"}`,children:k?e.jsx(bs,{size:20}):$.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:$.label}),!T&&y>u+1&&e.jsx("span",{className:"text-xs text-red-600 bg-red-100 px-2 py-1 rounded",children:"Complete previous stages first"})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:$.description}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full transition-all",style:{width:`${$.progress}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Progress: ",$.progress,"%"]})]}),e.jsx("div",{className:"text-right",children:F&&e.jsx(la,{className:"text-purple-600",size:20})})]},$.id)})})]}),c&&e.jsxs("div",{className:"bg-green-50 rounded-xl p-4 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-green-900 mb-3",children:["Tasks for ",c.label]}),e.jsx("div",{className:"space-y-2",children:c.tasks.map(($,y)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-600",size:14}),e.jsx("span",{className:"text-sm text-green-800",children:$})]},y))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Remarks ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:o,onChange:$=>m($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",rows:4,placeholder:"Provide details about the stage update, what was completed, challenges faced, etc.",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Next Action ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:g,onChange:$=>b($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",rows:4,placeholder:"Specify what needs to be done next, timeline, and responsible person...",required:!0})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Stage update will be recorded in seller timeline"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:f,disabled:d||!o.trim()||!g.trim()||i===t.stage,className:"flex items-center space-x-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:d?"Updating...":"Update Stage"})]})]})]})})]})})},tv=s=>s>=1e7?`â‚¹${(s/1e7).toFixed(1)}Cr`:s>=1e5?`â‚¹${(s/1e5).toFixed(1)}L`:`â‚¹${Number(s).toLocaleString("en-IN")}`,av=({isOpen:s,onClose:a,seller:t,onShare:r})=>{var W,B,M;const[i,n]=l.useState([]),[o,m]=l.useState(""),[g,b]=l.useState([]),[d,v]=l.useState({name:"",contact:"",type:"phone"}),[x,u]=l.useState(!1),[c,f]=l.useState([]),[p,N]=l.useState("profile");if(!s||!t)return null;const P=(t.stage??"").replace("_"," ").replace(/\b\w/g,A=>A.toUpperCase()),w={profile:`ðŸ‘¤ *Seller Profile - ${t.name??""}*

ðŸ“ž *Contact:* ${t.phone??"â€”"}
ðŸ“§ *Email:* ${t.email??"â€”"}
ðŸ“ *Location:* ${t.location??"â€”"}, ${t.city??"â€”"}
â­ *Lead Score:* ${t.leadScore??0}/100
ðŸ“Š *Stage:* ${P}

ðŸ  *Properties:* ${((W=t.properties)==null?void 0:W.length)||0} listed
ðŸ“ˆ *Response Rate:* ${t.responseRate??"â€”"}%
â±ï¸ *Avg Response:* ${t.avgResponseTime??"â€”"}

---
Shared via ResaleExpert
ðŸŒ www.resaleexpert.com`,properties:`ðŸ  *${t.name??""}'s Properties*

ðŸ“ *Seller Location:* ${t.location??"â€”"}, ${t.city??"â€”"}
ðŸ“ž *Contact:* ${t.phone??"â€”"}

${((B=t.properties)==null?void 0:B.map((A,L)=>`${L+1}. *${A.title??"Property"}*
   ðŸ“ ${A.address??A.location??"â€”"}
   ðŸ’° ${A.price!=null?tv(Number(A.price)):"â€”"}
   ðŸ¢ ${A.unitType??A.unit_type??"â€”"} â€¢ ${A.area??A.carpet_area??"â€”"} sq ft`).join(`

`))||"No properties listed yet"}

*Interested in any property? Contact us!*

---
ResaleExpert - Your Trusted Partner
ðŸ“ž +91 99999 99999`,contact:`ðŸ“ž *Contact Details - ${t.name??""}*

*Primary Contact:*
ðŸ“± Phone: ${t.phone??"â€”"}
ðŸ“§ Email: ${t.email??"â€”"}

*Location:*
ðŸ“ ${t.location??"â€”"}, ${t.city??"â€”"}

*Business Details:*
â­ Lead Score: ${t.leadScore??0}/100
ðŸ“Š Current Stage: ${P}
ðŸ“ˆ Response Rate: ${t.responseRate??"â€”"}%

---
ResaleExpert Team
ðŸŒ www.resaleexpert.com`},$=[{id:"whatsapp",label:"WhatsApp",icon:tt,color:"green",description:"Share via WhatsApp with rich formatting"},{id:"email",label:"Email",icon:Ds,color:"blue",description:"Send detailed email with seller information"},{id:"sms",label:"SMS",icon:Cs,color:"purple",description:"Send SMS with seller contact details"},{id:"public_link",label:"Public Link",icon:_t,color:"indigo",description:"Generate shareable public link"},{id:"qr_code",label:"QR Code",icon:an,color:"gray",description:"Generate QR code for easy sharing"},{id:"business_card",label:"Digital Business Card",icon:Ms,color:"pink",description:"Create digital business card"}],y=[{id:"profile",label:"Seller Profile",description:"Complete seller information"},{id:"properties",label:"Property List",description:"Seller's property listings"},{id:"contact",label:"Contact Details",description:"Contact information only"}],k=A=>{n(L=>L.includes(A)?L.filter(D=>D!==A):[...L,A])},R=()=>{d.name.trim()&&d.contact.trim()&&(b(A=>[...A,{...d,id:Date.now()}]),v({name:"",contact:"",type:"phone"}))},F=A=>{b(L=>L.filter(D=>D.id!==A))},T=()=>{const A=String(t.name??"").toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");return`https://resaleexpert.com/seller/${t.id??"seller"}/${A}`},j=()=>{const A=T();return`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(A)}`},E=async()=>{if(i.length===0){alert("Please select at least one sharing channel");return}u(!0),f([]);try{const A=[],L=o||w[p];for(const D of i)switch(await new Promise(I=>setTimeout(I,500)),D){case"whatsapp":{if(g.length>0){for(const I of g)if(I.type==="phone"){const H=`https://wa.me/${I.contact.replace(/\D/g,"")}?text=${encodeURIComponent(L)}`;window.open(H,"_blank"),A.push({channel:"WhatsApp",recipient:I.name,status:"sent"})}}break}case"email":{if(g.length>0){for(const I of g)if(I.type==="email"){const H=`Seller Information - ${t.name??""}`,h=`mailto:${I.contact}?subject=${encodeURIComponent(H)}&body=${encodeURIComponent(L)}`;window.open(h,"_blank"),A.push({channel:"Email",recipient:I.name,status:"sent"})}}break}case"sms":{A.push({channel:"SMS",recipient:"Multiple",status:"sent"});break}case"public_link":{const I=T();try{await navigator.clipboard.writeText(I),A.push({channel:"Public Link",recipient:"Copied to clipboard",status:"generated"})}catch{A.push({channel:"Public Link",recipient:I,status:"generated"})}break}case"qr_code":{const I=j(),H=window.open("","_blank");H&&H.document.write(`
                <html>
                  <head><title>QR Code - ${t.name??""}</title></head>
                  <body style="text-align: center; padding: 20px; font-family: Arial, sans-serif;">
                    <h2>Seller: ${t.name??""}</h2>
                    <img src="${I}" alt="QR Code" style="margin: 20px;">
                    <p>Scan to view seller profile</p>
                    <p style="font-size: 12px; color: #666;">${T()}</p>
                  </body>
                </html>
              `),A.push({channel:"QR Code",recipient:"Generated",status:"created"});break}default:A.push({channel:D,recipient:"Multiple",status:"sent"})}f(A),r({seller_id:t.id,channels:i,recipients:g,message:L,shareType:p,results:A,shared_at:new Date().toISOString()})}catch(A){console.error("Sharing failed:",A)}finally{u(!1)}},V=async A=>{try{await navigator.clipboard.writeText(A),alert("Copied to clipboard!")}catch{window.prompt("Copy to clipboard:",A)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Wt,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Share Seller Information"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.name," - Multi-channel Sharing"]})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"What to Share"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:y.map(A=>e.jsxs("button",{onClick:()=>N(A.id),className:`p-4 rounded-xl border-2 transition-all text-left ${p===A.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:A.label}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:A.description})]},A.id))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Seller Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Name:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Location:"}),e.jsxs("span",{className:"font-semibold ml-2",children:[t.location,", ",t.city]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Properties:"}),e.jsx("span",{className:"font-semibold ml-2",children:((M=t.properties)==null?void 0:M.length)||0})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select Sharing Channels"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map(A=>{const L=A.icon,D=i.includes(A.id);return e.jsxs("button",{onClick:()=>k(A.id),className:`p-4 rounded-xl border-2 transition-all text-left ${D?`border-${A.color}-500 bg-${A.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(L,{size:20,className:D?`text-${A.color}-600`:"text-gray-400"}),e.jsx("span",{className:`font-medium ${D?`text-${A.color}-900`:"text-gray-600"}`,children:A.label}),D&&e.jsx(bs,{size:16,className:`text-${A.color}-600`})]}),e.jsx("p",{className:"text-xs text-gray-500",children:A.description})]},A.id)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recipients"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx("input",{type:"text",value:d.name,onChange:A=>v({...d,name:A.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Recipient name"}),e.jsx("input",{type:"text",value:d.contact,onChange:A=>v({...d,contact:A.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Phone/Email"}),e.jsxs("select",{value:d.type,onChange:A=>v({...d,type:A.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"phone",children:"Phone"}),e.jsx("option",{value:"email",children:"Email"})]}),e.jsx("button",{onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add"})]})}),e.jsxs("div",{className:"space-y-2",children:[g.map(A=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:A.type==="email"?e.jsx(Ds,{size:16,className:"text-blue-600"}):e.jsx(Cs,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:A.name}),e.jsx("div",{className:"text-sm text-gray-600",children:A.contact})]})]}),e.jsx("button",{onClick:()=>F(A.id),className:"text-red-600 hover:text-red-800",children:e.jsx(ns,{size:16})})]},A.id)),g.length===0&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No recipients added. Add recipients to share seller information."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Message"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m(w[p]),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 transition-colors",children:"Use Default"}),e.jsxs("button",{onClick:()=>V(o||w[p]),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors",children:[e.jsx(Xt,{size:12,className:"inline mr-1"}),"Copy"]})]}),e.jsx("textarea",{value:o||w[p],onChange:A=>m(A.target.value),className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Enter your custom message..."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>V(T()),className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(za,{className:"text-blue-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Copy Profile Link"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Share direct seller profile"})]})]}),e.jsxs("button",{onClick:()=>{const A=window.open("","_blank");A&&A.document.write(`
                      <html>
                        <head><title>QR Code - ${t.name??""}</title></head>
                        <body style="text-align: center; padding: 20px; font-family: Arial, sans-serif;">
                          <h2>Seller: ${t.name??""}</h2>
                          <img src="${j()}" alt="QR Code" style="margin: 20px;">
                          <p>Scan to view seller profile</p>
                          <p style="font-size: 12px; color: #666;">${T()}</p>
                        </body>
                      </html>
                    `)},className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(an,{className:"text-gray-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Generate QR Code"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Create scannable QR code"})]})]})]})]}),c.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Sharing Results"}),e.jsx("div",{className:"space-y-2",children:c.map((A,L)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-600",size:16}),e.jsxs("span",{className:"text-sm font-medium text-green-800",children:[A.channel," - ",A.recipient]})]}),e.jsx("span",{className:"text-xs text-green-600 uppercase font-medium",children:A.status})]},L))})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[i.length," channel",i.length!==1?"s":""," selected â€¢ ",g.length," recipient",g.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:E,disabled:i.length===0||x,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{size:16,className:"animate-spin"}),e.jsx("span",{children:"Sharing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"Share Now"})]})})]})]})})]})})},hl=s=>String(s).padStart(2,"0"),rv=s=>{if(s==null)return null;if(typeof s=="string")return s;const a=s instanceof Date?s:new Date(s);return isNaN(a.getTime())?null:`${a.getFullYear()}-${hl(a.getMonth()+1)}-${hl(a.getDate())} ${hl(a.getHours())}:${hl(a.getMinutes())}:${hl(a.getSeconds())}`},lv=s=>{if(s==null)return null;if(typeof s=="string")return s;const a=s instanceof Date?s:new Date(s);return isNaN(a.getTime())?null:`${a.getFullYear()}-${hl(a.getMonth()+1)}-${hl(a.getDate())}`},nv=s=>s?/^\d{2}:\d{2}:\d{2}$/.test(s)?s:/^\d{2}:\d{2}$/.test(s)?`${s}:00`:s:null,iv=s=>s===1||s==="1"||s===!0||s==="true"?1:0,tx=s=>{const a={...s};return a.seller_id!=null&&a.sellerId==null&&(a.sellerId=a.seller_id,delete a.seller_id),"completedDate"in a&&(a.completedDate=rv(a.completedDate)),"scheduleDate"in a&&(a.scheduleDate=lv(a.scheduleDate)),"scheduleTime"in a&&(a.scheduleTime=nv(a.scheduleTime)),"reminder"in a&&(a.reminder=iv(a.reminder)),a};class ov{constructor(){xo(this,"cache",new Map);xo(this,"TTL",250)}generateKey(a,t,r){return`${a}:${t}:${JSON.stringify(r||{})}`}get(a){const t=this.cache.get(a);return t?Date.now()-t.timestamp>this.TTL?(this.cache.delete(a),null):t.promise:null}set(a,t){this.cache.set(a,{promise:t,timestamp:Date.now()}),setTimeout(()=>this.cache.delete(a),this.TTL)}clear(){this.cache.clear()}}const tr=new ov,wn=s=>{var a;throw s!=null&&s.response?(console.error("ðŸ§¨ API Error Response:",s.response.status,s.response.data),new Error(((a=s.response.data)==null?void 0:a.message)||"Server Error")):s!=null&&s.request?(console.error("ðŸ›°ï¸  API No Response:",s.request),new Error("No response from server. Please try again later.")):(console.error("âš ï¸  API Error:",s==null?void 0:s.message),new Error((s==null?void 0:s.message)||"Unexpected error"))},_n=(s,a,t)=>{},fi={create:async s=>{const a="/sellerfollowups/create",t=tx(s);try{const r=await Ae.post(a,t);if(_n("POST create (response)",a,r.data),!r.data.success||!r.data.data)throw new Error(r.data.message||"Failed to create follow-up");return tr.clear(),r.data.data}catch(r){wn(r)}},getAll:async s=>{const a="/sellerfollowups/getall",t={page:(s==null?void 0:s.page)??1,limit:(s==null?void 0:s.limit)??50,sellerId:(s==null?void 0:s.sellerId)??void 0},r=tr.generateKey("GET",a,t),i=tr.get(r);if(i)return i;const n=(async()=>{try{const o=await Ae.get(a,{params:t});if(_n("GET getAll (response)",a,o.data),!o.data.success)throw new Error(o.data.message||"Failed to fetch follow-ups");return o.data.data||[]}catch(o){wn(o)}})();return tr.set(r,n),n},getById:async s=>{const a=`/sellerfollowups/getbyid/${s}`,t=tr.generateKey("GET",a),r=tr.get(t);if(r)return r;const i=(async()=>{try{const n=await Ae.get(a);if(_n("GET getById (response)",a,n.data),!n.data.success||!n.data.data)throw new Error(n.data.message||"Follow-up not found");return n.data.data}catch(n){wn(n)}})();return tr.set(t,i),i},update:async(s,a)=>{const t=`/sellerfollowups/update/${s}`,r=tx(a);try{const i=await Ae.put(t,r);if(_n("PUT update (response)",t,i.data),!i.data.success||!i.data.data)throw new Error(i.data.message||"Failed to update follow-up");return tr.clear(),i.data.data}catch(i){wn(i)}},remove:async s=>{const a=`/sellerfollowups/remove/${s}`;try{const t=await Ae.delete(a);if(_n("DELETE remove (response)",a,t.data),!t.data.success)throw new Error(t.data.message||"Failed to delete follow-up");return tr.clear(),t.data.message||"Deleted successfully"}catch(t){wn(t)}},clearCache:()=>{tr.clear()}},Sn=[{value:"Phone Call",Icon:Cs,color:"blue"},{value:"WhatsApp",Icon:Ia,color:"green"},{value:"Email",Icon:Ds,color:"indigo"},{value:"Site Visit",Icon:Qs,color:"orange"},{value:"Meeting",Icon:Ns,color:"purple"},{value:"Other",Icon:Bt,color:"gray"}],ra=s=>s==null?"":String(s),ax=s=>ra(s).toLowerCase().replace(/\s+/g,""),Yr=(s,a)=>ax(s).includes(ax(a));function kn(s){if(!s)return null;const a=s.trim();if(/\d{4}-\d{2}-\d{2}T/.test(a)){const r=new Date(a);return isNaN(r.getTime())?null:r}if(/^\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}(:\d{2})?$/.test(a)){const[r,i]=a.split(/\s+/),[n,o,m]=r.split("-").map(Number),[g,b,d]=i.split(":").map(Number),v=Number.isFinite(d)?d:0;return new Date(n,o-1,m,g,b,v)}if(/^\d{4}-\d{2}-\d{2}$/.test(a)){const[r,i,n]=a.split("-").map(Number);return new Date(r,i-1,n,0,0,0)}if(/^\d{2}:\d{2}(:\d{2})?$/.test(a)){const[r,i,n]=a.split(":").map(Number),o=new Date;return new Date(o.getFullYear(),o.getMonth(),o.getDate(),r,i,Number.isFinite(n)?n:0)}const t=new Date(a);return isNaN(t.getTime())?null:t}function cv(s){if(!s)return"";const a=s.getFullYear(),t=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${a}-${t}-${r}`}function dv(s){if(!s)return"";const a=String(s.getHours()).padStart(2,"0"),t=String(s.getMinutes()).padStart(2,"0");return`${a}:${t}`}const mv=s=>{const a=b=>{for(const d of b)if(s&&typeof s[d]<"u")return s[d]},t=a(["type1Name","type1_name","type1","masterType1","master_type_1","master_type1","masterType1Name"])??a(["masterType1","master_type_1","master_type1"])??a(["master_type_1","master_type_1_name"])??a(["master_type_1"]),r=a(["value1Name","value1_name","value1","masterValue1","master_value_1","master_value1"])??a(["master_value_1"]),i=a(["type2Name","type2_name","type2","masterType2","master_type_2","master_type2"])??a(["master_type_2"]),n=a(["value2Name","value2_name","value2","masterValue2","master_value_2","master_value2"])??a(["master_value_2"]),o=a(["masterTabId","master_tab_id","master_tab","tabId","tab_id"])??a(["mastertabid","master_tab"]);let m=a(["remarks","remark","remarks_list","masterRemarks","master_remarks"])??void 0,g=[];return Array.isArray(m)?g=m.map(b=>ra(b).trim()).filter(Boolean):typeof m=="string"&&m.trim()&&(g=m.split(/\r?\n|,/).map(b=>ra(b).trim()).filter(Boolean)),{id:a(["id","_id","master_id","masterId"]),tabId:o?ra(o).trim():void 0,type1Name:t?ra(t).trim():void 0,value1Name:r?ra(r).trim():void 0,type2Name:i?ra(i).trim():void 0,value2Name:n?ra(n).trim():void 0,remarks:g,raw:s}},ud=s=>Array.from(new Set(s.map(a=>(a||"").trim()).filter(Boolean))),Qi=s=>!!s&&(Yr(s,"sellerleadstage")||Yr(s,"leadstage")||Yr(s,"stage")),Zi=s=>!!s&&(Yr(s,"sellerleadstatus")||Yr(s,"leadstatus")||Yr(s,"status")),rx=s=>!!s&&(Yr(s,"remark")||Yr(s,"remarks")),xv=s=>{const a=[];return s.forEach(t=>{Qi(t.type1Name)&&a.push(t.value1Name||""),Qi(t.type2Name)&&a.push(t.value2Name||"")}),ud(a)},lx=(s,a)=>{const t=[];return s.forEach(r=>{const i=Qi(r.type1Name),n=Qi(r.type2Name),o=Zi(r.type1Name),m=Zi(r.type2Name);i&&ra(r.value1Name).trim()===ra(a).trim()&&m&&t.push(r.value2Name||""),n&&ra(r.value2Name).trim()===ra(a).trim()&&o&&t.push(r.value1Name||"")}),ud(t)},nx=(s,a)=>{const t=[];return s.forEach(r=>{const i=Zi(r.type1Name),n=Zi(r.type2Name),o=rx(r.type1Name),m=rx(r.type2Name);i&&ra(r.value1Name).trim()===ra(a).trim()&&Array.isArray(r.remarks)&&r.remarks.length&&t.push(...r.remarks),n&&ra(r.value2Name).trim()===ra(a).trim()&&Array.isArray(r.remarks)&&r.remarks.length&&t.push(...r.remarks),i&&ra(r.value1Name).trim()===ra(a).trim()&&m&&t.push(r.value2Name||""),n&&ra(r.value2Name).trim()===ra(a).trim()&&o&&t.push(r.value1Name||"")}),ud(t)},ix={blue:"text-blue-600",green:"text-green-600",indigo:"text-indigo-600",orange:"text-orange-600",purple:"text-purple-600",gray:"text-gray-600"},xg=({options:s,value:a,onChange:t,disabled:r})=>{const[i,n]=l.useState(!1),o=l.useRef(null);l.useEffect(()=>{const d=v=>{o.current&&!o.current.contains(v.target)&&n(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const m=s.find(d=>d.value===a)??s[0],g=m.Icon,b=ix[m.color]||"text-gray-600";return e.jsxs("div",{className:"relative",ref:o,children:[e.jsxs("button",{type:"button",disabled:r,onClick:()=>n(d=>!d),className:`mt-1 w-full border border-gray-300 rounded-md px-3 py-2 text-left flex items-center gap-2
                    focus:outline-none focus:ring-2 focus:ring-blue-500 ${r?"opacity-60":""}`,"aria-haspopup":"listbox","aria-expanded":i,children:[e.jsx(g,{size:18,className:b}),e.jsx("span",{className:"flex-1",children:m.value}),e.jsx("svg",{viewBox:"0 0 20 20",className:"w-4 h-4",children:e.jsx("path",{d:"M5.5 7.5L10 12l4.5-4.5",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round"})})]}),i&&!r&&e.jsx("div",{role:"listbox",className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:s.map(d=>{const v=d.Icon,x=ix[d.color]||"text-gray-600",u=d.value===a;return e.jsxs("button",{type:"button",role:"option","aria-selected":u,onClick:()=>{t(d.value),n(!1)},className:`w-full px-3 py-2 text-left flex items-center gap-2 hover:bg-gray-50 ${u?"bg-indigo-50":""}`,children:[e.jsx(v,{size:18,className:x}),e.jsx("span",{children:d.value})]},d.value)})})]})};xg.displayName="ColoredFollowupTypeSelect";const uv=({isOpen:s,onClose:a,onSave:t,tabId:r,leadId:i,sellerId:n,initialForm:o})=>{if(!s)return null;const{user:m}=Hs(),g=(...ue)=>ue.find(Q=>Q!=null&&Q!==""),b=ue=>{var Q;return g(ue==null?void 0:ue.id,ue==null?void 0:ue.user_id,ue==null?void 0:ue._id,(Q=ue==null?void 0:ue.profile)==null?void 0:Q.id,ue==null?void 0:ue.employee_id,ue==null?void 0:ue.uid,ue==null?void 0:ue.auth_id)},d=ue=>{var Q;return g(ue==null?void 0:ue.executive_id,ue==null?void 0:ue.employee_id,(Q=ue==null?void 0:ue.profile)==null?void 0:Q.executive_id,ue==null?void 0:ue.currentExecutiveId,ue==null?void 0:ue.agent_id)},v=b(m),x=d(m)??v,u=i??n??"",c=typeof u=="number"?u:String(u||"").trim(),f=!!(o!=null&&o.id),[p,N]=l.useState([]),[P,w]=l.useState(!1),[$,y]=l.useState([]),[k,R]=l.useState(!1),[F,T]=l.useState(null),[j,E]=l.useState([]),[V,W]=l.useState([]),[B,M]=l.useState([]),A=(ue,Q)=>{if(o)return o[ue]??o[Q]},L=()=>{const ue=A("scheduleDate","schedule_date")??A("followup_date","followup_date")??A("date","date");A("scheduleTime","schedule_time")??A("followup_time","followup_time")??A("time","time");const Q=A("scheduleDateTime","schedule_datetime")??A("datetime","date_time"),he=kn(ue),se=kn(Q);return cv(he||se)},D=()=>{const ue=A("scheduleTime","schedule_time")??A("followup_time","followup_time")??A("time","time"),Q=A("scheduleDate","schedule_date")??A("followup_date","followup_date")??A("date","date"),he=A("scheduleDateTime","schedule_datetime")??A("datetime","date_time"),se=kn(ue)||kn(he)||kn(Q);return dv(se)},[I,H]=l.useState(()=>({followupType:A("followupType","followup_type")||Sn[0].value,sellerLeadStage:A("sellerLeadStage","seller_lead_stage")||A("buyerLeadStage","buyer_lead_stage")||"",sellerLeadStatus:A("sellerLeadStatus","seller_lead_status")||A("buyerLeadStatus","buyer_lead_status")||"",remark:A("remark","remark")||"",customRemark:A("customRemark","custom_remark")||A("notes","notes")||"",nextAction:A("nextAction","next_action")||"",scheduleDate:L(),scheduleTime:D(),priority:A("priority","priority")||""}));l.useEffect(()=>{s&&(async()=>{try{w(!0);const Q=await Gt(["lead"]),he=(Q==null?void 0:Q.common)??Q??{},se=he["Lead Priority"]||he["lead priority"]||(Array.isArray(Q["Lead Priority"])?Q["Lead Priority"]:[])||[];N(Array.isArray(se)?se:[]),!f&&!(o!=null&&o.priority)&&!I.priority&&Array.isArray(se)&&se.length&&H(ge=>({...ge,priority:se[0].value}))}catch(Q){console.error("âŒ Error fetching Lead Priority (masters/common):",Q),N([])}finally{w(!1)}})()},[s]),l.useEffect(()=>{(async()=>{if(s){R(!0),T(null);try{const Q=await yl.getRemarksByTabId(r);let he=[];Array.isArray(Q)?he=Q:Q!=null&&Q.data&&Array.isArray(Q.data)?he=Q.data:Q!=null&&Q.rows&&Array.isArray(Q.rows)?he=Q.rows:Q!=null&&Q.result&&Array.isArray(Q.result)?he=Q.result:Q&&typeof Q=="object"&&(he=Object.values(Q).flatMap(X=>Array.isArray(X)?X:[])),!he.length&&Q&&typeof Q=="object"&&Object.keys(Q).length&&(he=Array.isArray(Q)?Q:[Q]);const se=he.map(X=>mv(X||{})),ge=(r||"").toString().trim().toLowerCase(),ee=ge?se.filter(X=>(X.tabId||"").toString().trim().toLowerCase()===ge):se,de=ee.length?ee:se;y(de);const U=xv(de);E(U)}catch(Q){console.error("Failed to load follow-up options:",Q),T("Failed to load follow-up options."),y([]),E([]),W([]),M([])}finally{R(!1)}}})()},[s,r]),l.useEffect(()=>{if(!s)return;const ue=A("sellerLeadStage","seller_lead_stage")||A("buyerLeadStage","buyer_lead_stage")||I.sellerLeadStage||"";if($.length&&ue){const Q=lx($,ue);W(Q);const he=A("sellerLeadStatus","seller_lead_status")||A("buyerLeadStatus","buyer_lead_status")||I.sellerLeadStatus||"";if(he){const se=nx($,he);M(se)}else M([])}else W([]),M([])},[s,$]),l.useEffect(()=>{s&&H({followupType:A("followupType","followup_type")||Sn[0].value,sellerLeadStage:A("sellerLeadStage","seller_lead_stage")||A("buyerLeadStage","buyer_lead_stage")||"",sellerLeadStatus:A("sellerLeadStatus","seller_lead_status")||A("buyerLeadStatus","buyer_lead_status")||"",remark:A("remark","remark")||"",customRemark:A("customRemark","custom_remark")||A("notes","notes")||"",nextAction:A("nextAction","next_action")||"",scheduleDate:L(),scheduleTime:D(),priority:A("priority","priority")||""})},[s,o]);const h=ue=>Q=>H(he=>({...he,[ue]:Q.target.value})),Y=ue=>{const Q=ue.target.value,he=Q?lx($,Q):[];W(he),M([]),H(se=>({...se,sellerLeadStage:Q,sellerLeadStatus:"",remark:"",customRemark:""}))},K=ue=>{const Q=ue.target.value,he=Q?nx($,Q):[];M(he),H(se=>({...se,sellerLeadStatus:Q,remark:"",customRemark:""}))},q=ue=>{const Q=ue.target.value;H(he=>({...he,remark:Q,customRemark:Q?`${Q} â€“ `:""}))},ne=ue=>{if(ue.preventDefault(),!I.sellerLeadStage){alert("Please select a Seller Lead Stage.");return}if(!I.sellerLeadStatus){alert("Please select a Seller Lead Status.");return}if(!c){alert("Missing seller id. Cannot save follow-up without reference.");return}const Q=new Date().toISOString(),he={...I,seller_id:c,reminder:0,assigned_executive:x,...o!=null&&o.id?{id:o.id}:{},created_by:(o==null?void 0:o.created_by)??v,created_at:(o==null?void 0:o.created_at)??Q,updated_by:v,updated_at:Q};he.lead_id&&delete he.lead_id,t(he)},le=Sn.find(ue=>ue.value===I.followupType)||Sn[0],S=le.color==="blue"?"focus:ring-blue-500":le.color==="green"?"focus:ring-green-500":le.color==="indigo"?"focus:ring-indigo-500":le.color==="orange"?"focus:ring-orange-500":le.color==="purple"?"focus:ring-purple-500":"focus:ring-gray-500",C=new Date().toISOString().split("T")[0],J=f?void 0:C;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-xl p-5 m-4 max-h-[90vh] overflow-y-auto border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-transparent bg-clip-text",children:f?"Edit Seller Follow-up":"Add Seller New Follow-up"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl leading-none","aria-label":"Close",children:"Ã—"})]}),F&&e.jsx("div",{className:"mb-3 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:F}),e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Followup Type"}),e.jsx(xg,{options:Sn,value:I.followupType,onChange:ue=>H(Q=>({...Q,followupType:ue})),disabled:k})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lead Priority"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",value:I.priority,onChange:h("priority"),disabled:P||p.length===0&&!I.priority,children:[e.jsx("option",{value:"",children:P?"Loading...":"Select Priority"}),p.map(ue=>e.jsx("option",{value:ue.value,children:ue.label},ue.value)),!P&&I.priority&&!p.find(ue=>ue.value===I.priority)&&e.jsx("option",{value:I.priority,children:I.priority})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seller Lead Stage"}),e.jsxs("select",{className:`mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none ${S}`,value:I.sellerLeadStage,onChange:Y,disabled:k||j.length===0&&!I.sellerLeadStage,children:[e.jsx("option",{value:"",children:k?"Loading...":"Select stageâ€¦"}),I.sellerLeadStage&&!j.includes(I.sellerLeadStage)&&e.jsx("option",{value:I.sellerLeadStage,children:I.sellerLeadStage}),j.map(ue=>e.jsx("option",{value:ue,children:ue},ue))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seller Lead Status"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:I.sellerLeadStatus,onChange:K,disabled:k||!I.sellerLeadStage||V.length===0&&!I.sellerLeadStatus,children:[e.jsx("option",{value:"",children:I.sellerLeadStage?"Select statusâ€¦":"Select stage first"}),I.sellerLeadStatus&&!V.includes(I.sellerLeadStatus)&&e.jsx("option",{value:I.sellerLeadStatus,children:I.sellerLeadStatus}),V.map(ue=>e.jsx("option",{value:ue,children:ue},ue))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remarks"}),e.jsxs("select",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",value:I.remark,onChange:q,disabled:k||!I.sellerLeadStatus||B.length===0&&!I.remark,children:[e.jsx("option",{value:"",children:I.sellerLeadStatus?"Select remarkâ€¦":"Select status first"}),I.remark&&!B.includes(I.remark)&&e.jsx("option",{value:I.remark,children:I.remark}),B.map(ue=>e.jsx("option",{value:ue,children:ue},ue))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Custom Remark"}),e.jsx("textarea",{className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 min-h-[90px] focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Select a remark above or type your own detailsâ€¦",value:I.customRemark,onChange:h("customRemark")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Next Action"}),e.jsx("input",{type:"text",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter next action...",value:I.nextAction,onChange:h("nextAction")})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Schedule Date"}),e.jsx("input",{type:"date",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500",value:I.scheduleDate,onChange:h("scheduleDate"),min:J})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Schedule Time"}),e.jsx("input",{type:"time",className:"mt-1 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500",value:I.scheduleTime,onChange:h("scheduleTime")})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md text-white bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 hover:brightness-110 transition-colors",disabled:k,children:f?"Update Follow-up":"Save Follow-up"})]})]})]})]})},Yl=s=>s==null?"":String(s),Xi=s=>Yl(s).toLowerCase().replace(/\s+/g,"").trim();function Pl(s){if(!s)return null;const a=s.trim();if(/\d{4}-\d{2}-\d{2}T/.test(a)){const r=new Date(a);return isNaN(r.getTime())?null:r}if(/^\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}(:\d{2})?$/.test(a)){const[r,i]=a.split(/\s+/),[n,o,m]=r.split("-").map(Number),[g,b,d]=i.split(":").map(Number),v=Number.isFinite(d)?d:0;return new Date(n,o-1,m,g,b,v)}if(/^\d{4}-\d{2}-\d{2}$/.test(a)){const[r,i,n]=a.split("-").map(Number);return new Date(r,i-1,n,0,0,0)}if(/^\d{2}:\d{2}(:\d{2})?$/.test(a)){const[r,i,n]=a.split(":").map(Number),o=new Date;return new Date(o.getFullYear(),o.getMonth(),o.getDate(),r,i,Number.isFinite(n)?n:0)}const t=new Date(a);return isNaN(t.getTime())?null:t}function ug(s,a){const t=s>=12?"pm":"am",r=s%12||12,i=String(a).padStart(2,"0");return`${r}:${i} ${t}`}function gd(s){const a=String(s.getDate()).padStart(2,"0"),t=String(s.getMonth()+1).padStart(2,"0"),r=s.getFullYear();return`${a}/${t}/${r}`}function gg(s){const a=Pl(s);if(!a)return null;const t=/T\d{2}:\d{2}/.test(s||"")||/\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}/.test(s||""),r=gd(a);return t?`${r}, ${ug(a.getHours(),a.getMinutes())}`:r}function gv(s){if(!s)return"â€”";const a=s.match(/^(\d{2}):(\d{2})(?::(\d{2}))?$/);if(!a)return s;const t=Number(a[1]),r=Number(a[2]);return!Number.isFinite(t)||!Number.isFinite(r)?s:ug(t,r)}const hv=()=>({pending:{bg:"bg-orange-100",text:"text-orange-700",label:"Pending",icon:"â³"},scheduled:{bg:"bg-blue-100",text:"text-blue-700",label:"Scheduled",icon:"ðŸ“…"},completed:{bg:"bg-green-100",text:"text-green-700",label:"Completed",icon:"âœ…"},cancelled:{bg:"bg-red-100",text:"text-red-700",label:"Cancelled",icon:"âŒ"},inprogress:{bg:"bg-indigo-100",text:"text-indigo-700",label:"In Progress",icon:"ðŸ”„"},onhold:{bg:"bg-yellow-100",text:"text-yellow-700",label:"On Hold",icon:"â¸ï¸"},followup:{bg:"bg-purple-100",text:"text-purple-700",label:"Follow Up",icon:"ðŸ“ž"},interested:{bg:"bg-green-100",text:"text-green-700",label:"Interested",icon:"ðŸ‘"},notinterested:{bg:"bg-gray-100",text:"text-gray-700",label:"Not Interested",icon:"ðŸ‘Ž"},contacted:{bg:"bg-teal-100",text:"text-teal-700",label:"Contacted",icon:"ðŸ“§"},meeting:{bg:"bg-pink-100",text:"text-pink-700",label:"Meeting",icon:"ðŸ¤"},proposal:{bg:"bg-amber-100",text:"text-amber-700",label:"Proposal",icon:"ðŸ“‹"},negotiation:{bg:"bg-violet-100",text:"text-violet-700",label:"Negotiation",icon:"ðŸ’¼"},closed:{bg:"bg-slate-100",text:"text-slate-700",label:"Closed",icon:"ðŸ”"},done:{bg:"bg-emerald-100",text:"text-emerald-700",label:"Done",icon:"âœ…"},planned:{bg:"bg-blue-100",text:"text-blue-700",label:"Planned",icon:"ðŸ“…"},missed:{bg:"bg-rose-100",text:"text-rose-700",label:"Missed",icon:"âš ï¸"}}),hg=()=>({urgent:{border:"border-l-red-600",bg:"bg-red-50",text:"text-red-700",badge:"bg-red-100"},high:{border:"border-l-red-500",bg:"bg-red-50",text:"text-red-700",badge:"bg-red-100"},medium:{border:"border-l-yellow-500",bg:"bg-yellow-50",text:"text-yellow-700",badge:"bg-yellow-100"},normal:{border:"border-l-blue-500",bg:"bg-blue-50",text:"text-blue-700",badge:"bg-blue-100"},low:{border:"border-l-green-500",bg:"bg-green-50",text:"text-green-700",badge:"bg-green-100"},minimal:{border:"border-l-gray-400",bg:"bg-gray-50",text:"text-gray-700",badge:"bg-gray-100"},high_legacy:{border:"border-l-red-500",bg:"bg-red-50",text:"text-red-700",badge:"bg-red-100"},medium_legacy:{border:"border-l-yellow-500",bg:"bg-yellow-50",text:"text-yellow-700",badge:"bg-yellow-100"},low_legacy:{border:"border-l-green-500",bg:"bg-green-50",text:"text-green-700",badge:"bg-green-100"}}),pv=()=>({buyerLeadStage:{label:"Seller Stage",icon:fu,color:"bg-indigo-100 text-indigo-700",priority:1},buyerLeadStatus:{label:"Seller Status",icon:Rs,color:"bg-blue-100 text-blue-700",priority:2},followupType:{label:"Follow-up Type",icon:mr,color:"bg-purple-100 text-purple-700",priority:3},customRemark:{label:"Remarks",icon:ct,color:"bg-pink-100 text-pink-700",priority:5},nextAction:{label:"Next Action",icon:_l,color:"bg-yellow-100 text-yellow-700",priority:4},scheduleDate:{label:"Scheduled",icon:Ts,color:"bg-green-100 text-green-700",priority:6},transferredAt:{label:"Transferred",icon:$l,color:"bg-orange-100 text-orange-700",priority:7},assignedTo:{label:"Assigned Executive",icon:Ms,color:"bg-teal-100 text-teal-700",priority:8},type:{label:"Type",icon:Ls,color:"bg-gray-100 text-gray-700",priority:9},priority:{label:"Priority",icon:bu,color:"bg-gray-100 text-gray-700",priority:11},createdAt:{label:"Created",icon:Ts,color:"bg-gray-50 text-gray-700",priority:90},updatedAt:{label:"Updated",icon:Ts,color:"bg-gray-50 text-gray-700",priority:91},createdBy:{label:"Created By",icon:Ms,color:"bg-gray-50 text-gray-700",priority:92},updatedBy:{label:"Updated By",icon:Ms,color:"bg-gray-50 text-gray-700",priority:93}}),bv=s=>{switch(s){case"Phone Call":return e.jsx(Cs,{size:14,className:"text-blue-600"});case"WhatsApp":return e.jsx(tt,{size:14,className:"text-green-600"});case"Email":return e.jsx(Ds,{size:14,className:"text-indigo-600"});default:return e.jsx(mr,{size:14,className:"text-gray-500"})}},fv=s=>{const a=hv(),t=Xi(s),r=a[t]||a.planned,i=(r==null?void 0:r.label)||(s??"â€”"),n=r?`${r.bg} ${r.text}`:"bg-gray-100 text-gray-700";return e.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium inline-flex items-center gap-1 ${n}`,children:[e.jsx("span",{children:(r==null?void 0:r.icon)??"â€¢"}),i]})},yv=s=>{const a=hg(),t=Xi(s),r=a[t]||t==="high"&&a.high_legacy||t==="medium"&&a.medium_legacy||t==="low"&&a.low_legacy,i=s??"â€”",n=r?`${r.badge} ${r.text}`:"bg-gray-100 text-gray-700";return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${n}`,children:i})},Go=s=>s===!0||s===1||s==="1"||s==="true"||s==="yes",Ko=(s,a,t)=>{const r=s??null;if(r!=null&&String(r).trim()!=="")return String(r);const i=a??t;return i!=null?String(i):null},jv=s=>{const a=Go(s.transferred_from_lead)||Go(s.transferredFromLead)||Go(s.transferred_from_lead),t=s.followupType||s.followup_type||s.type||null,r=s.scheduleDate??s.schedule_date??s.followup_date??s.date??null,i=s.scheduleTime??s.schedule_time??s.followup_time??s.time??null,n=Ko(s.createdByName,s.created_by,s.createdBy),o=Ko(s.updatedByName,s.updated_by,s.updatedBy),m=Ko(s.assignedExecutiveName??s.assignedExecutiveName,s.assigned_to,s.assignedExecutive??s.assignedTo),g=s.customRemark??s.remark??s.notes??null;return{...s,id:String(s.id),category:a?"presales":"sales",followupType:t??null,scheduleDate:r??null,scheduleTime:i??null,assignedTo:m??null,createdBy:n??null,updatedBy:o??null,customRemark:g,createdAt:s.createdAt??s.created_at??null,updatedAt:s.updatedAt??s.updated_at??null,nextAction:s.nextAction??s.next_action??null,transferredAt:s.transferredAt??null}},ox=(s,a)=>{if(!s&&!a)return null;const t=(s??"").trim();if(t&&/\d{4}-\d{2}-\d{2}T/.test(t))return Pl(t);const r=(a??"").trim(),i=r?r.length===5?`${r}:00`:r:"00:00:00",n=t?`${t} ${i}`:i;return Pl(n)},cx=s=>{const a=ox(s.followup_date||s.date||null,s.followup_time||s.time||null);if(a)return a.getTime();const t=ox(s.schedule_date||s.scheduleDate||null,s.schedule_time||s.scheduleTime||null);if(t)return t.getTime();const r=Pl(s.updatedAt||s.updated_at||null);if(r)return r.getTime();const i=Pl(s.createdAt||s.created_at||null);return i?i.getTime():0},vv=({f:s})=>{const a=pv(),i=Object.keys(a).sort((n,o)=>a[n].priority-a[o].priority).map(n=>{let o=s[n];if(n==="scheduleDate"&&o){const g=Pl(o);o=g?gd(g):o}if((n==="createdAt"||n==="updatedAt"||n==="transferredAt")&&o&&(o=gg(o)),!o||String(o).trim()==="")return null;const m=a[n].icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-[11px] font-medium ${a[n].color}`,title:a[n].label,children:[e.jsx(m,{size:12}),e.jsxs("span",{children:[a[n].label,":"]}),e.jsx("span",{className:"font-semibold break-words",children:String(o)})]},n)}).filter(Boolean);return i.length===0?null:e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:i})},Nv=({followups:s,onAddFollowup:a,onEditFollowup:t,onDeleteFollowup:r,canCreate:i=!0,canUpdate:n=!0,canDelete:o=!0})=>{const[m,g]=Ps.useState("sales");Ps.useEffect(()=>{},[s]);const b=Ps.useMemo(()=>(s||[]).map(jv),[s]);Ps.useEffect(()=>{},[b]);const d=Ps.useMemo(()=>[...b].sort((f,p)=>cx(p)-cx(f)),[b]),v=d.filter(f=>f.category==="sales").length,x=d.filter(f=>f.category==="presales").length,u=d.filter(f=>f.category===m);Ps.useEffect(()=>{},[m,u]);const c=f=>{const p=hg(),N=Xi(f),P=p[N]||N==="high"&&p.high_legacy||N==="medium"&&p.medium_legacy||N==="low"&&p.low_legacy||null;return P?`${P.border} ${P.bg}`:"border-l-gray-400 bg-gray-50"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>g("sales"),className:`px-4 py-2 rounded-lg font-semibold transition-all duration-200 text-sm ${m==="sales"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Seller Follow-ups ",v>0&&`(${v})`]}),e.jsxs("button",{onClick:()=>g("presales"),className:`px-4 py-2 rounded-lg font-semibold transition-all duration-200 text-sm ${m==="presales"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Pre-Sales (Seller History) ",x>0&&`(${x})`]})]}),e.jsxs("button",{onClick:()=>{if(!i){Z.error("You do not have permission to create seller follow-ups");return}a()},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${i?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,title:i?"Add Seller Follow-up":"No permission to create follow-ups",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Seller Follow-up"})]})]}),u.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:u.map((f,p)=>{const N=(f.id??`f-${p}-${Xi(f.followupType||f.type||"followup")}`).toString();return e.jsx("div",{className:"h-full",children:e.jsx("div",{className:`h-full bg-white rounded-xl border border-gray-200 p-4 hover:shadow-md transition-shadow border-l-4 ${c(f.priority??void 0)}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:bv(f.followupType||f.followup_type||f.type||void 0)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.category==="presales"&&e.jsx("span",{className:"px-2 py-0.5 text-[10px] rounded-full bg-indigo-100 text-indigo-700 font-medium",children:"Pre-Sales History"}),f.category==="sales"&&e.jsx("span",{className:"px-2 py-0.5 text-[10px] rounded-full bg-indigo-100 text-indigo-700 font-medium",children:"Sales History"}),fv(f.status??void 0),yv(f.priority??void 0)]}),e.jsx(vv,{f}),f.scheduleDate&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"When:"})," ",gg(f.scheduleDate)||gd(Pl(f.scheduleDate)),f.scheduleTime?` â€¢ ${gv(f.scheduleTime)}`:""]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("button",{onClick:()=>{if(!n){Z.error("You do not have permission to edit follow-ups");return}t(f)},disabled:!n||f.category==="presales",className:"p-2 rounded hover:bg-gray-100 disabled:text-gray-300 disabled:cursor-not-allowed",title:f.category==="presales"?"Pre-sales history cannot be edited":n?"Edit seller follow-up":"No permission",children:e.jsx(pu,{size:16})}),e.jsx("button",{onClick:()=>{if(!o){Z.error("You do not have permission to delete follow-ups");return}r(f)},disabled:!o||f.category==="presales",className:"p-2 rounded hover:bg-rose-50 text-rose-600 disabled:text-gray-300 disabled:cursor-not-allowed",title:f.category==="presales"?"Pre-sales history cannot be deleted":o?"Delete seller follow-up":"No permission",children:e.jsx(Es,{size:16})})]})]})})},N)})}):e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx(Ts,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["No ",m==="sales"?"Seller":"Pre-Sales (Seller)"," follow-ups yet"]}),e.jsx("p",{className:"text-gray-500 mb-4",children:m==="sales"?"Plan your first seller follow-up for this seller":"This section shows seller follow-ups transferred from the lead stage."}),m==="sales"&&e.jsx("button",{onClick:()=>{if(!i){Z.error("You do not have permission to create seller follow-ups");return}a()},className:`px-4 py-2 rounded-lg transition-colors ${i?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:"Add Seller Follow-up"})]})]})},wv=({seller:s={},onBack:a=()=>{},onEdit:t=(...d)=>{},onAccount:r=(...d)=>{},onNext:i=()=>{},onPrevious:n=()=>{},currentIndex:o=0,totalSellers:m=1,onUpdateSeller:g=()=>{},sellerId:b})=>{var _e,ve,Pe,We,pe;const{user:d}=Hs(),v=Ws(d,"seller.update"),x=Ws(d,"followup.read"),u=Ws(d,"followup.create"),c=Ws(d,"followup.update"),f=Ws(d,"followup.delete"),[p,N]=l.useState("overview"),[P,w]=l.useState(!1),[$,y]=l.useState(!1),[k,R]=l.useState(!1),[F,T]=l.useState(!1),[j,E]=l.useState(!1),[V,W]=l.useState(null),[B,M]=l.useState(null),[A,L]=l.useState(!1),[D,I]=l.useState(null),[H,h]=l.useState(!1),[Y,K]=l.useState(null),q=[{id:"overview",label:"Overview",icon:Ms,count:null},{id:"details",label:"Details",icon:ws,count:null},{id:"buyers",label:"Buyers",icon:Ns,count:s.interestedBuyers||0},{id:"activities",label:"Activities",icon:jt,count:((_e=s.activities)==null?void 0:_e.length)||0},{id:"followups",label:"Follow-ups",icon:Ts,count:((ve=s.followups)==null?void 0:ve.length)||0},{id:"documents",label:"Documents",icon:ws,count:((Pe=s.documents)==null?void 0:Pe.length)||0},{id:"visits",label:"Visits",icon:ks,count:s.visits||0},{id:"deal",label:"Deal",icon:rt,count:null},{id:"analytics",label:"Analytics",icon:Ot,count:null}],ne=[{id:"initial_contact",label:"Initial Contact",progress:10,color:"blue"},{id:"property_collection",label:"Property Collection",progress:25,color:"purple"},{id:"mandate_discussion",label:"Mandate Discussion",progress:40,color:"orange"},{id:"mandate_signed",label:"Mandate Signed",progress:60,color:"green"},{id:"selling_process",label:"Selling Process",progress:75,color:"indigo"},{id:"deal_negotiation",label:"Deal Negotiation",progress:85,color:"yellow"},{id:"deal_closure",label:"Deal Closure",progress:95,color:"pink"},{id:"completed",label:"Completed",progress:100,color:"emerald"}],le=ne.find(O=>O.id===s.stage)||ne[0],S=b??(s==null?void 0:s.id)??(s==null?void 0:s.sellerId)??void 0,C=O=>{if(!O)return;const[Ie="00",ze="00",xe="00"]=O.split(":");return`${String(Ie).padStart(2,"0")}:${String(ze).padStart(2,"0")}:${String(xe).padStart(2,"0")}`},J=O=>{const Ie=(O==null?void 0:O.id)??(O==null?void 0:O.followup_id)??`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,ze=(O==null?void 0:O.followup_type)??(O==null?void 0:O.followupType),xe=(O==null?void 0:O.seller_lead_status)??(O==null?void 0:O.sellerLeadStatus)??(O==null?void 0:O.status),Ee=(O==null?void 0:O.created_by_name)??(O==null?void 0:O.createdByName)??null,Ke=(O==null?void 0:O.updated_by_name)??(O==null?void 0:O.updatedByName)??null,Xe=(O==null?void 0:O.assigned_executive_name)??(O==null?void 0:O.assignedExecutiveName)??null;(O==null?void 0:O.assigned_to_name)??(O==null||O.assignedToName),(O==null?void 0:O.transferred_by_name)??(O==null||O.transferredByName);const ye=(O==null?void 0:O.assigned_executive)??(O==null?void 0:O.assignedExecutive)??(O==null?void 0:O.assigned_to);return{id:String(Ie),seller_id:(O==null?void 0:O.seller_id)??(O==null?void 0:O.sellerId),followup_date:(O==null?void 0:O.schedule_date)??(O==null?void 0:O.followup_date)??(O==null?void 0:O.scheduleDate)??void 0,followup_time:C((O==null?void 0:O.schedule_time)??(O==null?void 0:O.followup_time)??(O==null?void 0:O.scheduleTime)??void 0),followup_type:ze,status:xe,priority:(O==null?void 0:O.priority)??"",notes:(O==null?void 0:O.custom_remark)??(O==null?void 0:O.customRemark)??(O==null?void 0:O.remark)??(O==null?void 0:O.notes)??void 0,next_action:(O==null?void 0:O.next_action)??(O==null?void 0:O.nextAction)??void 0,assigned_to:ye,reminder:Number((O==null?void 0:O.reminder)??0),created_at:(O==null?void 0:O.created_at)??(O==null?void 0:O.createdAt),updated_at:(O==null?void 0:O.updated_at)??(O==null?void 0:O.updatedAt),created_by:(O==null?void 0:O.created_by)??(O==null?void 0:O.createdBy),updated_by:(O==null?void 0:O.updated_by)??(O==null?void 0:O.updatedBy),createdByName:Ee,updatedByName:Ke,assignedExecutiveName:Xe,transferred_from_lead:(O==null?void 0:O.transferred_from_lead)===!0||(O==null?void 0:O.transferred_from_lead)===1||(O==null?void 0:O.transferredFromLead)===!0||(O==null?void 0:O.transferredFromLead)===1||!1,category:O!=null&&O.transferred_from_lead||O!=null&&O.transferredFromLead?"presales":"sales"}},ue=l.useCallback(O=>{const Ie=(O||[]).map(J),ze={...s,followups:Ie};g(ze)},[s,g]),Q=l.useCallback(async()=>{if(S)try{K(null),h(!0);const O=await fi.getAll({sellerId:S,page:1,limit:200}),Ie=O&&typeof O=="object"&&"data"in O?O.data:O;ue(Array.isArray(Ie)?Ie:[])}catch(O){console.error("Failed to load seller followups:",O),K((O==null?void 0:O.message)||"Failed to load follow-ups"),ue([])}finally{h(!1)}},[S,ue]);l.useEffect(()=>{b&&Q()},[b]);const he=O=>{if(!O)return null;const Ie=Array.isArray(O.photos)?O.photos.map((xe,Ee)=>xe?typeof xe=="string"?{id:`${O.id??"p"}-${Ee}`,url:xe,name:`photo-${Ee+1}`}:{id:xe.id??`${O.id??"p"}-${Ee}`,url:xe.url??xe.path??"",name:xe.name??`photo-${Ee+1}`}:null).filter(Boolean):Array.isArray(O.photoUrls)?O.photoUrls.map((xe,Ee)=>({id:`${O.id??"p"}-${Ee}`,url:xe,name:`photo-${Ee+1}`})):[],ze=Array.isArray(O.nearby_places)?O.nearby_places.map(xe=>({name:xe.name??xe.place??"",type:xe.type??xe.category??"",distance:xe.distance??"",unit:xe.unit??""})):[];return{id:O.id??O._id,salutation:O.salutation??O.ownerSalutation??"Mr",ownerName:O.ownerName??O.owner_name??O.contactName??O.seller_name??"",ownerPhone:O.ownerPhone??O.owner_phone??O.contactPhone??O.phone??"",ownerWhatsapp:O.ownerWhatsapp??O.owner_whatsapp??O.contactWhatsapp??"",sameAsPhone:!!(O.ownerWhatsapp&&O.ownerPhone&&O.ownerWhatsapp===O.ownerPhone||O.ownerWhatsapp&&O.ownerWhatsapp===O.phone),ownerEmail:O.ownerEmail??O.owner_email??O.contactEmail??O.email??"",ownerType:O.ownerType??O.owner_type??"individual",seller:O.seller??O.seller_name??`${Yl(s!=null&&s.salutation?s.salutation+" ":"")}${Yl(s==null?void 0:s.name)}`,propertyType:O.propertyType??O.type??O.property_type_name??"",propertySubtype:O.propertySubtype??O.subtype??O.property_subtype_name??"",unitType:O.unitType??O.unit_type??Yl(O.unit_type_name)??"",wing:O.wing??O.block??"",unitNo:O.unitNo??O.unit_no??O.unit??"",furnishing:O.furnishing??"",parkingType:O.parkingType??O.parking_type??"",parkingQty:yi(O.parkingQty??O.parking_qty),city:O.city??O.city_name??(s==null?void 0:s.city)??"",location:O.location??O.location_name??"",society:O.society??O.society_name??"",floor:O.floor??"",totalFloors:O.totalFloors??O.total_floors??"",carpetArea:yi(O.carpetArea??O.carpet_area??O.area),builtupArea:yi(O.builtupArea??O.builtup_area),budget:yi(O.budget??O.price??O.expectedPrice),address:O.address??O.displayAddress??O.full_address??"",status:O.status??"",leadSource:O.leadSource??O.lead_source??O.source??(s==null?void 0:s.source)??"Website",possessionMonth:O.possessionMonth??O.possession_month??"",possessionYear:O.possessionYear??O.possession_year??"",purchaseMonth:O.purchaseMonth??O.purchase_month??"",purchaseYear:O.purchaseYear??O.purchase_year??"",sellingRights:O.sellingRights??O.selling_rights??"",amenities:dx(O.amenities??O.amenities_list??[]),furnishingItems:dx(O.furnishingItems??O.furnishing_items??[]),description:O.description??O.longDescription??O.desc??"",nearby_places:ze,existingOwnershipDocUrl:O.ownership_doc_path??O.ownershipDocUrl??"",existingOwnershipDocName:O.ownership_doc_name??"",existingOwnershipDocId:O.ownership_doc_id??"",existingPhotos:Ie,public_inquiries:O.public_inquiries??O.publicInquiries??0,public_views:O.public_views??O.publicViews??0,publication_date:O.publication_date??O.publicationDate??null}},se=O=>{const Ie=he(O);M(Ie),E(!0)},ge=()=>{const O={seller:`${s!=null&&s.salutation?s.salutation+" ":""}${(s==null?void 0:s.name)??""}`,city:(s==null?void 0:s.city)??"",location:(s==null?void 0:s.location)??"",leadSource:(s==null?void 0:s.source)??"Website"};M(O),E(!0)},ee=(O,Ie,ze)=>{var Ee,Ke;const xe={...s,stage:O,stageProgress:((Ee=ne.find(Xe=>Xe.id===O))==null?void 0:Ee.progress)??0,lastActivity:new Date().toISOString().split("T")[0],activities:[...s.activities||[],{id:Date.now(),type:"stage_update",description:`Stage updated to ${((Ke=ne.find(Xe=>Xe.id===O))==null?void 0:Ke.label)??O}`,date:new Date().toISOString().split("T")[0],time:new Date().toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),stage:O,outcome:Ie,nextAction:ze,executedBy:"Admin User",remarks:Ie}]};g(xe),w(!1)},de=O=>{const Ie={...s,activities:[...s.activities||[],O],lastActivity:new Date().toISOString().split("T")[0]};g(Ie),R(!1),W(null)},U=O=>{const Ie={...s,followups:s.followups?s.followups.some(ze=>ze.id===O.id)?s.followups.map(ze=>ze.id===O.id?O:ze):[...s.followups,O]:[O]};g(Ie)},X=O=>{const Ie={...s,followups:(s.followups||[]).filter(ze=>ze.id!==O.id)};g(Ie)},re=O=>{const Ie={...s,visits:(s.visits||0)+1,totalVisits:(s.totalVisits||0)+1,lastActivity:new Date().toISOString().split("T")[0],activities:[...s.activities||[],{id:Date.now(),type:"visit",description:`Property visit scheduled for ${O.property}`,date:O.date,time:O.time,stage:s.stage,outcome:O.feedback||"Visit scheduled",nextAction:O.nextAction||"Follow up after visit",executedBy:"Admin User",remarks:O.remarks||""}]};g(Ie),T(!1)},fe=O=>{const Ie={...s,properties:[...s.properties||[],O]};g(Ie),E(!1),M(null)},G=async O=>{if(!S){alert("Missing seller id.");return}if(!u&&!D){Z.error("You do not have permission to create follow-ups");return}if(D&&!c){Z.error("You do not have permission to update follow-ups");return}try{K(null),h(!0);const Ie={...O,seller_id:O.seller_id??S};if(D!=null&&D.id){const xe=await fi.update(D.id,Ie),Ee=J(xe??Ie);U(Ee)}else{const xe=await fi.create(Ie),Ee=J(xe??Ie);U(Ee)}L(!1),I(null)}catch(Ie){console.error("Save seller follow-up failed:",Ie),K((Ie==null?void 0:Ie.message)||"Failed to save follow-up"),alert((Ie==null?void 0:Ie.message)||"Failed to save follow-up")}finally{h(!1)}},me=async O=>{if(!f){Z.error("You do not have permission to delete follow-ups");return}if(confirm("Are you sure you want to delete this follow-up?"))try{K(null),h(!0),await fi.remove(O.id),X(O),Z.success("Follow-up deleted")}catch(Ie){console.error("Delete seller follow-up failed:",Ie),K((Ie==null?void 0:Ie.message)||"Failed to delete follow-up"),alert((Ie==null?void 0:Ie.message)||"Failed to delete follow-up")}finally{h(!1)}},oe=()=>{var O,Ie,ze,xe,Ee,Ke,Xe,ye,Ce,_,ae,ke,Me,Ye,ie,we;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-2xl font-bold",children:Yl(s.name).charAt(0)||""}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:[s.salutation," ",s.name]}),e.jsxs("p",{className:"text-blue-100 text-lg",children:[s.location??"â€”",", ",s.city??"â€”"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("span",{className:"text-blue-100",children:[s.source??"â€”"," Lead"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Xs,{className:"text-yellow-300 fill-current",size:16}),e.jsxs("span",{className:"text-white font-medium",children:[s.leadScore??0,"/100"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold",children:[s.stageProgress??0,"%"]}),e.jsx("div",{className:"text-blue-100",children:"Progress"})]})]})}),e.jsxs("div",{className:"p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Stage Progress:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium",children:le.label}),e.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[s.stageProgress??0,"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${s.stageProgress??0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[e.jsx("span",{children:"Initial Contact"}),e.jsx("span",{children:"Completed"})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-blue-600 mb-1",children:[e.jsx(ks,{size:16}),e.jsx("span",{className:"text-xl font-bold",children:s.visits??0})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"visits"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-green-600 mb-1",children:[e.jsx(Ns,{size:16}),e.jsx("span",{className:"text-xl font-bold",children:s.interestedBuyers??0})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"buyers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-purple-600 mb-1",children:[e.jsx(Is,{size:16}),e.jsx("span",{className:"text-xl font-bold",children:(s.properties||[]).length})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"properties"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-orange-600 mb-1",children:[e.jsx(jt,{size:16}),e.jsx("span",{className:"text-xl font-bold",children:(s.activities||[]).length})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"activities"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Property Images"}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(Sa,{size:16}),e.jsx("span",{children:"Add Photos"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(((Ie=(O=s.properties)==null?void 0:O[0])==null?void 0:Ie.photos)??[]).slice(0,3).map((Be,Ve)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:Be,alt:`Property ${Ve+1}`,className:"w-full h-32 object-cover rounded-xl"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all rounded-xl flex items-center justify-center",children:e.jsx(ks,{className:"text-white opacity-0 group-hover:opacity-100 transition-all",size:24})})]},Ve)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl h-32 flex items-center justify-center hover:border-blue-400 transition-colors cursor-pointer",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Sa,{className:"mx-auto text-gray-400 mb-2",size:24}),e.jsx("span",{className:"text-sm text-gray-500",children:"Add Photo"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Property Details"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Type:"}),e.jsx("div",{className:"font-semibold text-gray-900 text-lg",children:((xe=(ze=s.properties)==null?void 0:ze[0])==null?void 0:xe.unit_type)||((Ke=(Ee=s.properties)==null?void 0:Ee[0])==null?void 0:Ke.property_type)||"â€”"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Carpet Area:"}),e.jsxs("div",{className:"font-semibold text-gray-900 text-lg",children:[((ye=(Xe=s.properties)==null?void 0:Xe[0])==null?void 0:ye.carpet_area)??"â€”"," sq ft"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Floor:"}),e.jsx("div",{className:"font-semibold text-gray-900 text-lg",children:((_=(Ce=s.properties)==null?void 0:Ce[0])==null?void 0:_.floor)??"â€”"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Parking:"}),e.jsx("div",{className:"font-semibold text-gray-900 text-lg",children:(ke=(ae=s.properties)==null?void 0:ae[0])!=null&&ke.parking_type?`${((Ye=(Me=s.properties)==null?void 0:Me[0])==null?void 0:Ye.parking_qty)||""} ${(we=(ie=s.properties)==null?void 0:ie[0])==null?void 0:we.parking_type}`:"â€”"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Seller Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ms,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:s.name??"â€”"}),e.jsx("div",{className:"text-sm text-gray-600",children:s.phone??"â€”"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(Ds,{size:14,className:"text-gray-400"}),e.jsxs("span",{children:["Email: ",s.email??"â€”"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(Qs,{size:14,className:"text-gray-400"}),e.jsxs("span",{children:["Lead Source: ",s.source??"â€”"]})]})]})]})]})]})]})},Fe=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Full Name"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[s.salutation," ",s.name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phone Number"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:s.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email Address"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:s.email})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Location"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[s.location,", ",s.city]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Lead Source"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:s.source})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-emerald-100 text-emerald-700",children:s.status??"Active"})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Properties Portfolio"}),e.jsxs("button",{onClick:ge,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Property"})]})]}),s.properties&&s.properties.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.properties.map((O,Ie)=>{var ze;return e.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("img",{src:((ze=O.photos)==null?void 0:ze[0])??"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=200",alt:O.title??"property",className:"w-16 h-12 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:O.title??O.slug??(O.unit_type||O.property_subtype_name||"Untitled")}),e.jsx("p",{className:"text-sm text-gray-600",children:O.address??O.location_name??O.location}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-sm font-medium text-green-600",children:O.price??O.budget??""}),e.jsx("span",{className:"text-xs text-gray-500",children:O.area??O.carpet_area??""})]})]}),e.jsx("div",{className:"flex items-start space-x-2",children:e.jsx("button",{onClick:()=>se(O),className:"p-1 rounded hover:bg-gray-100",title:"Edit property",children:e.jsx(ft,{size:16})})})]})},Ie)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Is,{className:"mx-auto text-gray-300 mb-3",size:48}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No properties added yet"}),e.jsx("button",{onClick:ge,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add First Property"})]})]})]}),$e=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Timeline"}),e.jsxs("button",{onClick:()=>R(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Activity"})]})]}),s.activities&&s.activities.length>0?e.jsx("div",{className:"space-y-4",children:s.activities.map((O,Ie)=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(jt,{className:"text-blue-600",size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:O.description}),e.jsx("span",{className:"text-sm text-gray-500",children:O.date})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{children:["Stage: ",O.stage]}),e.jsxs("div",{children:["Duration: ",O.duration]}),e.jsxs("div",{children:["By: ",O.executedBy]})]}),O.outcome&&e.jsxs("div",{className:"mt-2 text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Outcome:"})," ",O.outcome]}),O.nextAction&&e.jsxs("div",{className:"text-sm text-blue-600",children:[e.jsx("span",{className:"font-medium",children:"Next:"})," ",O.nextAction]})]})]})},Ie))}):e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx(jt,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No activities recorded"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Start tracking seller interactions"}),e.jsx("button",{onClick:()=>R(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add First Activity"})]})]}),Le=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Documents"}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Create Document"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Document Workflow"}),e.jsx("div",{className:"space-y-4",children:[{stage:"creation",label:"Document Creation",status:"completed",icon:ws},{stage:"sharing",label:"Sharing with Seller",status:"completed",icon:Dt},{stage:"otp",label:"OTP Verification",status:"pending",icon:at},{stage:"esign",label:"E-Signature",status:"pending",icon:Ct},{stage:"completion",label:"Document Completion",status:"pending",icon:bs}].map((O,Ie)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${O.status==="completed"?"bg-green-100":O.status==="pending"?"bg-orange-100":"bg-gray-100"}`,children:e.jsx(O.icon,{className:O.status==="completed"?"text-green-600":O.status==="pending"?"text-orange-600":"text-gray-600",size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:O.label}),e.jsx("div",{className:`text-sm ${O.status==="completed"?"text-green-600":O.status==="pending"?"text-orange-600":"text-gray-500"}`,children:O.status==="completed"?"Completed":O.status==="pending"?"Pending":"Not Started"})]}),O.status==="pending"&&e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:O.stage==="otp"?"Send OTP":O.stage==="esign"?"Initiate E-Sign":"Process"})]},Ie))})]}),s.documents&&s.documents.length>0?e.jsx("div",{className:"space-y-4",children:s.documents.map((O,Ie)=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ws,{className:"text-blue-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:O.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[O.category," â€¢ ",O.date]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${O.status==="completed"?"bg-green-100 text-green-700":O.status==="pending"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:O.status}),e.jsx("button",{className:"p-1 text-gray-600 hover:bg-gray-100 rounded",children:e.jsx(ks,{size:16})})]})]})},Ie))}):e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx(ws,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No documents created"}),e.jsx("p",{className:"text-gray-500",children:"Create documents for this seller"})]})]}),je=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"Response Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[s.responseRate??"â€”","%"]})]}),e.jsx(Rs,{size:24,className:"text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"Deal Potential"}),e.jsx("p",{className:"text-2xl font-bold capitalize",children:s.dealPotential??"â€”"})]}),e.jsx(rt,{size:24,className:"text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"Avg Response"}),e.jsx("p",{className:"text-2xl font-bold",children:s.avgResponseTime??"â€”"})]}),e.jsx(Ls,{size:24,className:"text-purple-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm",children:"Total Visits"}),e.jsx("p",{className:"text-2xl font-bold",children:s.totalVisits??0})]}),e.jsx(ks,{size:24,className:"text-orange-200"})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Stage Progress"}),e.jsx("div",{className:"space-y-3",children:ne.map((O,Ie)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${s.stage===O.id?"bg-blue-500 text-white":ne.findIndex(ze=>ze.id===s.stage)>Ie?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}`,children:ne.findIndex(ze=>ze.id===s.stage)>Ie?e.jsx(bs,{size:16}):Ie+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:O.label}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:s.stage===O.id?`${s.stageProgress??0}%`:ne.findIndex(ze=>ze.id===s.stage)>Ie?"100%":"0%"}})})]})]},O.id))})]})]});return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50 text-xs",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4 sticky top-0 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(ga,{size:20})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:Yl(s.name).charAt(0)||""}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-gray-900",children:[s.salutation," ",s.name]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:[e.jsxs("span",{children:[s.location??"â€”",", ",s.city??"â€”"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.source??"â€”"," Lead"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsxs("span",{children:[o+1," of ",m]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:n,disabled:o===0,className:"p-1 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:16,className:"rotate-180"})}),e.jsx("button",{onClick:i,disabled:o===m-1,className:"p-1 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:16})})]})]}),e.jsx("button",{onClick:()=>window.open(`tel:${(s.phone||"").replace(/\D/g,"")}`),className:"p-2 rounded-lg bg-green-100 text-green-600 hover:bg-green-200 transition-colors",title:"Call",children:e.jsx(Cs,{size:20})}),e.jsx("button",{onClick:()=>{const O=`Hi ${s.name}, this is regarding your property inquiry. How can I assist you today?`;window.open(`https://wa.me/${(s.phone||"").replace(/\D/g,"")}?text=${encodeURIComponent(O)}`,"_blank")},className:"p-2 rounded-lg bg-green-100 text-green-600 hover:bg-green-200 transition-colors",title:"WhatsApp",children:e.jsx(tt,{size:20})}),e.jsx("button",{onClick:()=>{const O=`Regarding Your Property - ${s.name}`,Ie=`Dear ${s.name},

I hope this email finds you well. I wanted to follow up regarding your property inquiry.

Best regards,
ResaleExpert Team`;window.open(`mailto:${s.email??""}?subject=${encodeURIComponent(O)}&body=${encodeURIComponent(Ie)}`,"_blank")},className:"p-2 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",title:"Email",children:e.jsx(Ds,{size:20})}),e.jsx("button",{onClick:()=>{if(!v){Z.error("You do not have permission to edit seller");return}t(s)},className:`p-2 rounded-lg ${v?"bg-blue-100 text-blue-600 hover:bg-blue-200":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,title:v?"Edit":"No permission to edit",disabled:!v,children:e.jsx(ft,{size:20})})]})]}),(H||Y)&&e.jsxs("div",{className:"mt-3 text-xs",children:[H&&e.jsx("span",{className:"text-blue-600",children:"Syncing follow-upsâ€¦"}),Y&&e.jsxs("span",{className:"text-rose-600",children:["â€¢ ",Y]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("nav",{className:"flex space-x-1",children:q.map(O=>{const Ie=O.icon,ze=p===O.id;return e.jsxs("button",{onClick:()=>N(O.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${ze?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(Ie,{size:16}),e.jsx("span",{className:"font-medium",children:O.label}),O.count!==null&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${ze?"bg-blue-200":"bg-gray-200"}`,children:O.count})]},O.id)})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[p==="overview"&&oe(),p==="details"&&Fe(),p==="activities"&&$e(),p==="followups"&&e.jsx(e.Fragment,{children:x?e.jsx(Nv,{followups:s.followups||[],onAddFollowup:()=>{if(!u){Z.error("You do not have permission to create follow-ups");return}I(null),L(!0)},onEditFollowup:O=>{if(!c){Z.error("You do not have permission to edit follow-ups");return}I(O),L(!0)},onDeleteFollowup:me,canCreate:u,canUpdate:c,canDelete:f}):e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"You do not have permission to view follow-ups."})})}),p==="documents"&&Le(),p==="analytics"&&je()]}),e.jsx("div",{className:"bg-white border-t border-gray-200 px-6 py-4 sticky bottom-0 z-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>w(!0),className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(Rs,{size:16}),e.jsx("span",{children:"Update Stage"})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center space-x-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[e.jsx(Wt,{size:16}),e.jsx("span",{children:"Share"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(ks,{size:16}),e.jsx("span",{children:"Track"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>{if(!u){Z.error("You do not have permission to create follow-ups");return}L(!0)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${u?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(Ts,{size:16}),e.jsx("span",{children:"Follow-ups"})]}),e.jsxs("button",{onClick:()=>{W(null),R(!0)},className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Activity"})]}),e.jsxs("button",{onClick:()=>T(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Ts,{size:16}),e.jsx("span",{children:"Schedule Visit"})]})]})]})}),P&&e.jsx(sv,{isOpen:P,onClose:()=>w(!1),seller:s,onUpdateStage:ee}),$&&e.jsx(av,{isOpen:$,onClose:()=>y(!1),seller:s,onShare:()=>y(!1)}),A&&e.jsx(uv,{isOpen:A,onClose:()=>{L(!1),I(null)},onSave:G,tabId:"seller",sellerId:(s==null?void 0:s.id)??(s==null?void 0:s.sellerId)??"",initialForm:D?{id:String(D.id),created_by:D.created_by,created_at:D.created_at,followupType:D.followup_type??"Phone Call",followup_type:D.followup_type??"Phone Call",sellerLeadStatus:D.status??"",seller_lead_status:D.status??"",sellerLeadStage:(s==null?void 0:s.stage_label)??(s==null?void 0:s.stage)??"",seller_lead_stage:(s==null?void 0:s.stage_label)??(s==null?void 0:s.stage)??"",remark:D.notes??"",customRemark:D.notes??"",custom_remark:D.notes??"",nextAction:D.next_action??"",next_action:D.next_action??"",scheduleDate:D.followup_date??"",schedule_date:D.followup_date??"",scheduleTime:((We=D.followup_time)==null?void 0:We.slice(0,5))??"",schedule_time:((pe=D.followup_time)==null?void 0:pe.slice(0,5))??"",priority:D.priority??""}:void 0}),k&&e.jsx(Hu,{isOpen:k,onClose:()=>{R(!1),W(null)},activity:V,onSave:de}),F&&e.jsx(od,{isOpen:F,onClose:()=>T(!1),visit:null,onSave:re,buyer:{id:s.id??"",name:s.name??""}}),j&&e.jsx(no,{isOpen:j,onClose:()=>{E(!1),M(null)},onSubmit:fe,mode:B&&B.id?"edit":"create",propertyId:B==null?void 0:B.id,initialData:B??{seller:`${(s==null?void 0:s.salutation)??""} ${(s==null?void 0:s.name)??""}`}})]})};function yi(s){if(s==null||s==="")return;const a=Number(s);return isNaN(a)?void 0:a}function dx(s){return s==null?[]:Array.isArray(s)?s:typeof s=="string"?s.split(",").map(a=>a.trim()).filter(Boolean):[s]}const mx=({activeTab:s,onTabChange:a,seller:t,unreadCount:r})=>{var d,v;const i=[{id:"dashboard",label:"Dashboard",icon:yt,description:"Overview & insights"},{id:"properties",label:"My Properties",icon:Is,description:"Property listings"},{id:"activities",label:"Activities",icon:jt,description:"Timeline & history"},{id:"visits",label:"Site Visits",icon:ks,description:"Visit management"},{id:"analytics",label:"Analytics",icon:Ot,description:"Performance metrics"},{id:"vendors",label:"Vendor Directory",icon:Ns,description:"Service providers"},{id:"deals",label:"Deals",icon:Cl,description:"Deal management"},{id:"transactions",label:"Transactions",icon:Ut,description:"Financial records"},{id:"calculators",label:"Calculators",icon:sr,description:"Financial tools"},{id:"documents",label:"Documents",icon:ws,description:"Document management"}],n=typeof(t==null?void 0:t.properties_count)=="number"?t.properties_count:Array.isArray(t==null?void 0:t.properties)?t.properties.length:0,o=x=>{const u=Number(x);if(!Number.isFinite(u)||u<=0)return" - ";const c=1e7,f=1e5;if(u>=c){const p=u/c;return`â‚¹${parseFloat(p.toFixed(2))}Cr`}if(u>=f){const p=u/f;return`â‚¹${parseFloat(p.toFixed(0))}L`}return`â‚¹${u.toLocaleString("en-IN")}`},{logout:m}=Hs(),g=(t==null?void 0:t.name)||"",b=((v=(d=g==null?void 0:g[0])==null?void 0:d.toUpperCase)==null?void 0:v.call(d))||"?";return e.jsxs("div",{className:"w-72 bg-white border-r border-gray-200 flex flex-col h-full",children:[e.jsxs("div",{className:"p-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-base",children:b}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(va,{className:"text-white",size:9})})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h3",{className:"font-semibold text-sm text-gray-900 truncate",children:[t!=null&&t.salutation?`${t.salutation} `:"",g||"Seller"]}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:[t==null?void 0:t.location,t==null?void 0:t.city].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xs,{className:"text-yellow-400 fill-current",size:11}),e.jsxs("span",{className:"text-[10px] font-medium text-gray-700",children:[(t==null?void 0:t.leadScore)??90,"/100"]})]}),e.jsx("span",{className:"text-[9px] text-green-700 bg-green-100 px-1.5 py-0.5 rounded-full",children:"Premium"})]})]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-blue-50 rounded p-2 text-center",children:[e.jsx("span",{className:"text-sm font-semibold",children:n}),e.jsx("div",{className:"text-[10px] text-blue-700",children:"Properties"})]}),e.jsxs("div",{className:"bg-green-50 rounded p-2 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-green-600",children:"24"}),e.jsx("div",{className:"text-[10px] text-green-700",children:"Inquiries"})]})]})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-2",children:e.jsx("div",{className:"space-y-1",children:i.map(x=>{const u=x.icon,c=s===x.id;return e.jsxs("button",{onClick:()=>a(x.id),className:`w-full flex items-center gap-2 px-2.5 py-2 rounded-lg transition-colors text-left group
                  ${c?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx("div",{className:`p-1.5 rounded-md
                  ${c?"bg-blue-100":"bg-gray-100 group-hover:bg-gray-200"}`,children:e.jsx(u,{size:15})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:x.label}),e.jsx("div",{className:"text-[10px] opacity-75 truncate",children:x.description})]}),x.id==="activities"&&r>0&&e.jsx("div",{className:"min-w-5 h-5 px-1 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] text-white font-bold",children:r})})]},x.id)})})}),e.jsxs("div",{className:"p-3 border-t border-gray-100",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-md p-3 text-white mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-xs",children:"Portfolio Value"}),e.jsx("div",{className:"text-lg font-bold leading-tight",children:o(67e6)})]}),e.jsx(Rs,{size:18,className:"text-green-100"})]}),e.jsx("div",{className:"text-[10px] text-green-100 mt-1",children:"+12% from last month"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{className:"w-full flex items-center gap-2 px-2 py-1.5 text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:[e.jsx(Yt,{size:15}),e.jsx("span",{className:"text-sm",children:"Account Settings"})]}),e.jsxs("button",{onClick:async()=>{await m(),window.location.href="/login"},className:"w-full flex items-center gap-2 px-2 py-1.5 text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:[e.jsx(eo,{size:15}),e.jsx("span",{className:"text-sm",children:"Sign Out"})]})]})]})]})},xx=s=>typeof s=="boolean"?s:s===1||s==="1"||s==="true",_v=s=>{if(!s)return new Date(NaN);if(/[tT]|\+|Z$/.test(s))return new Date(s);const a=s.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2}):(\d{2})$/);if(a){const[,t,r,i,n,o,m]=a;return new Date(Date.UTC(+t,+r-1,+i,+n,+o,+m))}return new Date(s)},Sv=s=>{const a=_v(s??"");if(Number.isNaN(a.getTime()))return"Unknown";const t=Math.floor((Date.now()-a.getTime())/6e4);if(t<1)return"Just now";if(t<60)return`${t}m ago`;const r=Math.floor(t/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`},kv=s=>{switch(s){case"property_inquiry":return e.jsx(Ns,{className:"text-blue-600",size:16});case"visit_scheduled":return e.jsx(ks,{className:"text-green-600",size:16});case"price_suggestion":return e.jsx(Rs,{className:"text-purple-600",size:16});case"document_ready":return e.jsx(ws,{className:"text-orange-600",size:16});case"lead_assign":return e.jsx(Ns,{className:"text-indigo-600",size:16});default:return e.jsx(ha,{className:"text-gray-600",size:16})}},Cv=s=>{switch(s){case"high":return{row:"border-l-red-500 bg-red-50",pill:"bg-red-100 text-red-700"};case"medium":return{row:"border-l-orange-500 bg-orange-50",pill:"bg-orange-100 text-orange-700"};case"low":return{row:"border-l-green-500 bg-green-50",pill:"bg-green-100 text-green-700"};default:return{row:"border-l-gray-500 bg-gray-50",pill:"bg-gray-100 text-gray-700"}}},Av=({notifications:s,unreadCount:a,onMarkAsRead:t,onMarkAllAsRead:r,onDeleteNotification:i,onViewAll:n})=>{const[o,m]=l.useState(!1),g=l.useRef(null),b=l.useMemo(()=>s.filter(v=>!xx(v.read)).length,[s]),d=typeof a=="number"?a:b;return l.useEffect(()=>{if(!o)return;const v=x=>{g.current&&(g.current.contains(x.target)||m(!1))};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[o]),l.useEffect(()=>{if(!o)return;const v=x=>{x.key==="Escape"&&m(!1)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[o]),e.jsxs("div",{className:"relative",ref:g,children:[e.jsxs("button",{"aria-haspopup":"dialog","aria-expanded":o,onClick:()=>m(v=>!v),className:"relative p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:[e.jsx(ha,{size:20,className:d>0?"text-blue-600":"text-gray-600"}),d>0&&e.jsx("div",{className:"absolute -top-1 -right-1 min-w-5 h-5 px-1 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] leading-none text-white font-bold",children:d>99?"99+":d})})]}),o&&e.jsxs("div",{role:"dialog","aria-label":"Notifications",className:"absolute right-0 top-12 w-96 bg-white border border-gray-200 rounded-xl shadow-2xl z-50",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d>0&&r&&e.jsx("button",{onClick:r,className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Mark all read"}),e.jsx("button",{onClick:()=>m(!1),className:"p-1 rounded hover:bg-gray-100",children:e.jsx(ns,{size:16})})]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:s!=null&&s.length?e.jsx("div",{className:"divide-y divide-gray-100",children:s.map(v=>{const x=xx(v.read),u=Cv(v.priority??"medium");return e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors border-l-4 ${u.row} ${x?"":"bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:kv(v.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`text-sm font-medium ${x?"text-gray-700":"text-gray-900"}`,children:v.title??"Notification"}),v.message?e.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:v.message}):null,e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:Sv(v.timestamp)}),v.priority&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${u.pill}`,children:v.priority})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[!x&&t&&e.jsx("button",{onClick:()=>t(v.id),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Mark as read",children:e.jsx(_a,{size:12})}),i&&e.jsx("button",{onClick:()=>i(v.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete",children:e.jsx(Es,{size:12})})]})]})})]})},String(v.id))})}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(ha,{className:"mx-auto text-gray-300 mb-3",size:32}),e.jsx("p",{className:"text-gray-500",children:"No notifications"})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx("button",{onClick:n,className:"w-full text-center text-sm text-blue-600 hover:text-blue-800 font-medium disabled:opacity-50",disabled:!n,children:"View All Notifications"})})]})]})},Zt=(s,a="-")=>s==null||typeof s=="string"&&s.trim()===""?a:s,Pv=s=>s?s.toLowerCase().replace(/\s+/g,"_"):"initial_contact",pg="fltcnt",ux="re_filter_token",Tv=s=>{var a;return typeof window<"u"&&((a=window.location)!=null&&a.origin)?window.location.origin:s||"https://investordeal.in"},Iv=s=>{if(typeof window>"u")return null;try{return new URL(window.location.href).searchParams.get(s)}catch{return null}},$v=()=>{if(typeof window>"u")return null;try{return sessionStorage.getItem(ux)||localStorage.getItem(ux)}catch{return null}},Ev=s=>String(s??"").toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),Mv=s=>{if(s!=null&&s.slug)return String(s.slug);const a=(s==null?void 0:s.id)??(s==null?void 0:s.property_id)??(s==null?void 0:s._id);if(!a)return;const t=(s==null?void 0:s.unit_type)??(s==null?void 0:s.unitType),r=(s==null?void 0:s.property_subtype_name)??(s==null?void 0:s.propertySubtype),i=(s==null?void 0:s.location_name)??(s==null?void 0:s.location)??(s==null?void 0:s.city)??(s==null?void 0:s.area),n=[String(a),t,r,i].filter(Boolean).map(Ev).filter(Boolean);return n.length?n.join("-"):String(a)},Lv=s=>{const a=Number(s);return Number.isFinite(a)?`REX00${a}`:""},Dv=({url:s,propertyId:a,slug:t,trackingToken:r,absoluteBase:i,trackingParamKey:n=pg})=>{if(s)try{if(r){const b=new URL(s);return b.searchParams.set(n,r),b.toString()}return s}catch{return s}const o=Tv(i);let m="";if(t){const b=String(t).replace(/^\//,"");m=b.startsWith("properties/")?`/${b}`:`/properties/${b}`}else if(a)m=`/properties/${a}`;else if(typeof window<"u")try{const b=new URL(window.location.href);return r&&b.searchParams.set(n,r),b.toString()}catch{return window.location.href}else return o;const g=new URL(o+m);return r&&g.searchParams.set(n,r),g.toString()},Rv=s=>{const a=Number(s??0);return a?a>=1e7?`â‚¹${(a/1e7).toFixed(1)}Cr`:a>=1e5?`â‚¹${(a/1e5).toFixed(1)}L`:`â‚¹${a.toLocaleString("en-IN")}`:"-"},zv=s=>{if(!s)return"-";const a=new Date(s);if(isNaN(a.getTime()))return"-";const t=String(a.getDate()).padStart(2,"0"),r=String(a.getMonth()+1).padStart(2,"0"),i=a.getFullYear();return`${t}-${r}-${i}`},Fv=s=>{if(s==null)return null;const a=Number(s);return Number.isFinite(a)?a:null},Bv=s=>{try{return JSON.parse(s)}catch{return null}},Ov=s=>{var i,n,o,m,g;const a=[];s!=null&&s.amenities&&a.push(s.amenities),s!=null&&s.features&&a.push(s.features),s!=null&&s.amenityList&&a.push(s.amenityList),s!=null&&s.property_amenities&&a.push(s.property_amenities),(i=s==null?void 0:s.raw)!=null&&i.amenities&&a.push(s.raw.amenities),(n=s==null?void 0:s.raw)!=null&&n.features&&a.push(s.raw.features),(o=s==null?void 0:s.property_details)!=null&&o.amenities&&a.push(s.property_details.amenities),(m=s==null?void 0:s.meta)!=null&&m.amenities&&a.push(s.meta.amenities),(g=s==null?void 0:s.details)!=null&&g.amenities&&a.push(s.details.amenities);const t=[];for(const b of a)if(b!=null){if(typeof b=="string"&&/^[\[\{].*[\]\}]$/.test(b.trim())){const d=Bv(b.trim());if(d){a.push(d);continue}}if(Array.isArray(b)){for(const d of b)if(d!=null){if(typeof d=="string"||typeof d=="number"){const v=String(d).trim();v&&!v.toLowerCase().includes("tag")&&!v.toLowerCase().includes("label")&&t.push(v)}else if(typeof d=="object"){const v=String(d.name??d.title??d.label??d.value??d.amenity??"").trim();v&&!v.toLowerCase().includes("tag")&&t.push(v)}}}else if(typeof b=="string"||typeof b=="number")String(b).split(/[,|/]+/g).map(d=>d.trim()).filter(Boolean).filter(d=>!d.toLowerCase().includes("tag")).forEach(d=>t.push(d));else if(typeof b=="object"&&!Array.isArray(b)){for(const[d,v]of Object.entries(b))if((v===!0||v===1||v==="1"||typeof v=="string"&&v.toLowerCase()==="true")&&!d.toLowerCase().includes("tag")){const u=d.replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/\s+/g," ").trim();t.push(u)}}}const r=new Set;return t.map(b=>b.replace(/\s+/g," ").trim()).filter(Boolean).filter(b=>{const d=b.toLowerCase();return["tag","label","category","type","id"].some(x=>d.includes(x))||r.has(d)?!1:(r.add(d),!0)}).sort((b,d)=>b.localeCompare(d))},Uv=({label:s})=>{const a=Ea(s),t=a.emoji;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] leading-5 ring-1 ${a.bg} ${a.text} ${a.ring}`,title:s,children:[typeof t=="string"?e.jsx("span",{"aria-hidden":!0,children:t}):t?Ps.createElement(t,{size:12,className:"opacity-95"}):null,e.jsx("span",{className:"font-medium",children:s})]})},qv=({name:s})=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full bg-blue-50 text-blue-700 text-xs font-medium border border-blue-200 hover:bg-blue-100 transition-colors cursor-default",title:s,children:s}),Vv=({property:s})=>{var M,A,L;const a=((M=s==null?void 0:s.photos)==null?void 0:M[0])??((A=s==null?void 0:s.images)==null?void 0:A[0])??((L=s==null?void 0:s.photoUrls)==null?void 0:L[0])??"https://dummyimage.com/800x450/e5e7eb/9ca3af.png&text=No+Image",t=Number((s==null?void 0:s.carpet_area)??(s==null?void 0:s.carpetArea)??(s==null?void 0:s.square_feet)??0),r=Number((s==null?void 0:s.builtup_area)??(s==null?void 0:s.builtupArea)??(s==null?void 0:s.area)??0),i=Number((s==null?void 0:s.price)??(s==null?void 0:s.budget)??(s==null?void 0:s.listing_price)??0),n=t&&i?`â‚¹${Math.round(i/t).toLocaleString()}/sq ft`:"-",o=Number((s==null?void 0:s.visits)??(s==null?void 0:s.views)??0),m=Number((s==null?void 0:s.inquiries)??0),g=Number((s==null?void 0:s.hotLeads)??(s==null?void 0:s.hot_leads)??0),b=Zt((s==null?void 0:s.availability)??(s==null?void 0:s.status)??(s==null?void 0:s.property_status)??"Available"),d=!!((s==null?void 0:s.isPublic)??(s==null?void 0:s.public)??!0),v=!!((s==null?void 0:s.isHot)??(s==null?void 0:s.hot)??(s==null?void 0:s.featured)??!1),x=!!((s==null?void 0:s.mandateSigned)??(s==null?void 0:s.mandate)??!1),u=Number((s==null?void 0:s.publicViews)??(s==null?void 0:s.views)),c=Number.isFinite(u)&&u>=0?u:0,f=Zt((s==null?void 0:s.lastActivity)??(s==null?void 0:s.updated_at)??(s==null?void 0:s.created_at)??(s==null?void 0:s.last_updated),""),p=zv(f),[N,P]=l.useState(!1),[w,$]=l.useState(!1),y=l.useMemo(()=>Iv(pg)||$v()||void 0,[]),k=l.useMemo(()=>Fv((s==null?void 0:s.id)??(s==null?void 0:s.property_id)??(s==null?void 0:s._id)),[s==null?void 0:s.id,s==null?void 0:s.property_id,s==null?void 0:s._id]),R=l.useMemo(()=>k?Lv(k):"",[k]),F=l.useMemo(()=>Mv({...s,id:k??(s==null?void 0:s.id)}),[s,k]),T=l.useMemo(()=>Dv({url:s==null?void 0:s.share_url,propertyId:k??void 0,slug:F,trackingToken:y}),[k,F,s==null?void 0:s.share_url,y]),[j,E]=l.useState({total:c||0,unique:0}),V=l.useMemo(()=>Ov(s),[s]);l.useEffect(()=>{V.length>0&&console.debug("[PropertyCard] Amenities Data:",{propertyId:k??(s==null?void 0:s._id)??(s==null?void 0:s.id)??"N/A",totalAmenities:V.length,amenities:V,source:"normalized"})},[V,k,s==null?void 0:s._id,s==null?void 0:s.id]),l.useEffect(()=>{let D=!0;async function I(){var H,h;if(k)try{const Y=await cr.getByProperty(k,!1),K=await cr.getByProperty(k,!0);if(!D)return;const q=Number(Y==null?void 0:Y.total_views)||Number((H=Y==null?void 0:Y.data)==null?void 0:H.total_views)||c||0,ne=Number(K==null?void 0:K.unique_views)||Number((h=K==null?void 0:K.data)==null?void 0:h.unique_views)||0;E({total:Number.isFinite(q)?q:0,unique:Number.isFinite(ne)?ne:0})}catch{if(!D)return;E(Y=>({total:Y.total||c||0,unique:Y.unique||0}))}}return I(),()=>{D=!1}},[k,c]);const W=async D=>{if(D==="share"){$(!0);const I=k??"0";As.sendPropertyEvent(I,"share","share_copy_from_card",{url:T},{filterToken:y,filterParamKey:"filter_token",slug:F}).catch(()=>{})}else D==="analytics"?alert("Open property analytics."):D==="edit"?alert("Edit property (hook into your flow)."):D==="boost"&&alert("Property boost activated!")},B=async()=>{const D=k??"0";As.sendPropertyEvent(D,"share","open_details_from_card",{url:T},{filterToken:y,filterParamKey:"filter_token",slug:F}).catch(()=>{}),window.open(T,"_blank","noopener,noreferrer")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg transition-all group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a,alt:String(Zt((s==null?void 0:s.title)??(s==null?void 0:s.name)??"Property")),className:"w-full h-48 object-cover",loading:"lazy"}),e.jsxs("div",{className:"absolute top-4 left-4 flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:b}),d&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:"PUBLIC"}),v&&e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-600 inline-flex items-center gap-1",children:[e.jsx(wu,{size:12})," HOT"]})]}),x&&e.jsx("div",{className:"absolute bottom-4 left-3 ",children:e.jsx("span",{className:"px-2 py-1 rounded-md text-xs font-medium bg-emerald-600 text-white shadow-sm",children:"Mandate Signed"})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>P(D=>!D),className:"p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all","aria-label":"Property actions",children:e.jsx(xr,{size:16})}),N&&e.jsx("div",{className:"absolute right-0 top-10 bg-white border border-gray-200 rounded-lg shadow-lg z-10 w-48",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("button",{onClick:()=>{W("share"),P(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(Wt,{size:14}),e.jsx("span",{children:"Share Property"})]}),e.jsxs("button",{onClick:()=>{W("edit"),P(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(ft,{size:14}),e.jsx("span",{children:"Edit Details"})]}),e.jsxs("button",{onClick:()=>{W("analytics"),P(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(Ot,{size:14}),e.jsx("span",{children:"View Analytics"})]}),e.jsxs("button",{onClick:()=>{W("boost"),P(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-purple-600 hover:bg-purple-100 rounded",children:[e.jsx(Ft,{size:14}),e.jsx("span",{children:"Boost Listing"})]})]})})]})})]}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg mb-1",children:[Zt(s==null?void 0:s.furnishing),Zt((s==null?void 0:s.unit_type)??(s==null?void 0:s.unitType)),Zt((s==null?void 0:s.property_subtype_name)??(s==null?void 0:s.subtype)),Zt((s==null?void 0:s.location_name)??(s==null?void 0:s.location))].filter(D=>D!=="-"&&D!=="").join("  ")}),e.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:R&&e.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 ring-1 ring-gray-200",children:R})}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 mb-2",children:[e.jsx(Qs,{size:14}),e.jsx("span",{className:"text-sm",children:Zt((s==null?void 0:s.address)??(s==null?void 0:s.location))})]}),Array.isArray(s==null?void 0:s.tags)&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:s.tags.map((D,I)=>e.jsx(Uv,{label:D},`${D}-${I}`))})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Rv(i)}),e.jsx("div",{className:"text-sm text-gray-500",children:n})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-md p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wide",children:"Type"}),e.jsx("div",{className:"font-medium text-gray-900",children:Zt((s==null?void 0:s.unit_type)??(s==null?void 0:s.unitType))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wide",children:"Carpet Area"}),e.jsx("div",{className:"font-medium text-gray-900",children:t?`${t.toLocaleString()} sq ft`:"-"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wide",children:"Builtup Area"}),e.jsx("div",{className:"font-medium text-gray-900",children:r?`${r.toLocaleString()} sq ft`:"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-blue-600 mb-1",children:[e.jsx(ks,{size:14}),e.jsx("span",{className:"font-bold",children:o})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Visits"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-green-600 mb-1",children:[e.jsx(Ns,{size:14}),e.jsx("span",{className:"font-bold",children:m})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Inquiries"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 text-red-600 mb-1",children:[e.jsx(rt,{size:14}),e.jsx("span",{className:"font-bold",children:g})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Hot Leads"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Selling Progress"}),e.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[Number((s==null?void 0:s.stageProgress)??0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-500",style:{width:`${Math.max(0,Math.min(100,Number((s==null?void 0:s.stageProgress)??0)))}%`}})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Amenities"}),V.length>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:[V.length," amenit",V.length===1?"y":"ies"]})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:V.length>0?e.jsxs(e.Fragment,{children:[V.slice(0,8).map((D,I)=>e.jsx(qv,{name:D},`${D}-${I}`)),V.length>8&&e.jsxs("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-medium border border-gray-200 cursor-help",title:`${V.slice(8).join(", ")}`,children:["+",V.length-8," more"]})]}):e.jsx("span",{className:"text-xs text-gray-500 italic",children:"No amenities listed"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:B,className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",title:"Open property details",children:"View Details"}),e.jsx("button",{onClick:()=>W("share"),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Share Property",children:e.jsx(Wt,{size:16})}),e.jsx("button",{onClick:()=>W("analytics"),className:"p-2 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200 transition-colors",title:"View Analytics",children:e.jsx(Ot,{size:16})})]}),e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"rounded-lg bg-gray-50 text-gray-700 px-3 py-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_t,{size:14,className:"text-purple-600"}),e.jsxs("span",{className:"text-sm",children:[j.total," public views",(j.unique,"")]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Last activity: ",p]})]})})]})]}),w&&e.jsx(xn,{onClose:()=>$(!1),url:T,propertyId:k??void 0,slug:F,title:[Zt((s==null?void 0:s.unit_type)??(s==null?void 0:s.unitType)),Zt((s==null?void 0:s.property_subtype_name)??(s==null?void 0:s.subtype)),Zt((s==null?void 0:s.location_name)??(s==null?void 0:s.location))].filter(D=>D!=="-"&&D!=="").join(" â€¢ "),description:Zt((s==null?void 0:s.address)??(s==null?void 0:s.description)),image:a})]})},Wv=({seller:s})=>{const[a,t]=l.useState(""),[r,i]=l.useState("all"),[n,o]=l.useState("all"),[m,g]=l.useState(null),[b,d]=l.useState(!1),[v,x]=l.useState(null),u=[{id:1,type:"call",title:"Follow-up Call Completed",description:"Called regarding property inquiry and requirements",timestamp:"2025-01-12T14:30:00Z",priority:"high",status:"completed",property:"Skyline Towers, Andheri West",stage:"property_hunting",duration:"15 minutes",outcome:"Positive response, interested in visiting property",nextAction:"Schedule property visit",executedBy:"Admin User",remarks:"Buyer showed genuine interest, ready to visit this weekend"},{id:2,type:"meeting",title:"Property Discussion Meeting",description:"Detailed discussion about property features and pricing",timestamp:"2025-01-11T16:00:00Z",priority:"medium",status:"completed",property:"Green Valley Villa, Pune",stage:"negotiation",duration:"45 minutes",outcome:"Price negotiation initiated, buyer interested",nextAction:"Prepare counter offer",executedBy:"Admin User",remarks:"Productive meeting, buyer understands property value"},{id:3,type:"email",title:"Property Details Shared",description:"Sent comprehensive property information via email",timestamp:"2025-01-10T11:15:00Z",priority:"medium",status:"completed",property:"Metro Heights, Andheri East",stage:"initial_contact",duration:"10 minutes",outcome:"Information shared successfully",nextAction:"Wait for buyer response",executedBy:"Admin User",remarks:"Sent detailed brochure and floor plans"},{id:4,type:"whatsapp",title:"WhatsApp Communication",description:"Quick discussion about property availability",timestamp:"2025-01-09T10:00:00Z",priority:"low",status:"completed",property:"Skyline Towers, Andheri West",stage:"initial_contact",duration:"5 minutes",outcome:"Confirmed property availability",nextAction:"Schedule detailed discussion",executedBy:"Admin User",remarks:"Quick response to buyer query"},{id:5,type:"presentation",title:"Property Presentation",description:"Detailed property presentation with market analysis",timestamp:"2025-01-08T15:30:00Z",priority:"high",status:"completed",property:"Green Valley Villa, Pune",stage:"requirement_gathering",duration:"1 hour",outcome:"Buyer impressed with property features",nextAction:"Arrange site visit",executedBy:"Admin User",remarks:"Comprehensive presentation covering all aspects"},{id:6,type:"follow_up",title:"Scheduled Follow-up",description:"Regular follow-up on property interest",timestamp:"2025-01-07T09:00:00Z",priority:"medium",status:"completed",property:"Metro Heights, Andheri East",stage:"property_hunting",duration:"20 minutes",outcome:"Maintained buyer interest",nextAction:"Continue regular follow-ups",executedBy:"Admin User",remarks:"Buyer still evaluating options"}],c=[{value:"all",label:"All Activities",count:u.length},{value:"call",label:"Calls",count:u.filter(T=>T.type==="call").length},{value:"meeting",label:"Meetings",count:u.filter(T=>T.type==="meeting").length},{value:"email",label:"Emails",count:u.filter(T=>T.type==="email").length},{value:"whatsapp",label:"WhatsApp",count:u.filter(T=>T.type==="whatsapp").length},{value:"presentation",label:"Presentations",count:u.filter(T=>T.type==="presentation").length}],f=[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"}],p=u.filter(T=>{const j=T.title.toLowerCase().includes(a.toLowerCase())||T.description.toLowerCase().includes(a.toLowerCase())||T.property.toLowerCase().includes(a.toLowerCase()),E=r==="all"||T.type===r;return j&&E}),N=T=>{switch(T){case"call":return e.jsx(Cs,{className:"text-blue-600",size:16});case"meeting":return e.jsx(Ns,{className:"text-green-600",size:16});case"email":return e.jsx(Ds,{className:"text-purple-600",size:16});case"whatsapp":return e.jsx(tt,{className:"text-green-600",size:16});case"presentation":return e.jsx(ws,{className:"text-orange-600",size:16});case"follow_up":return e.jsx(ha,{className:"text-blue-600",size:16});default:return e.jsx(jt,{className:"text-gray-600",size:16})}},P=T=>{switch(T){case"call":return"bg-blue-100 text-blue-700";case"meeting":return"bg-green-100 text-green-700";case"email":return"bg-purple-100 text-purple-700";case"whatsapp":return"bg-green-100 text-green-700";case"presentation":return"bg-orange-100 text-orange-700";case"follow_up":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},w=T=>{switch(T){case"high":return"border-l-red-500 bg-red-50";case"medium":return"border-l-orange-500 bg-orange-50";case"low":return"border-l-green-500 bg-green-50";default:return"border-l-gray-500 bg-gray-50"}},$=T=>new Date(T).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),y=()=>{x(null),d(!0)},k=T=>{x(T),d(!0)},R=T=>{d(!1),x(null),alert("Activity saved successfully!")},F=(T,j)=>{switch(T){case"schedule":alert("Follow-up scheduling functionality");break;case"update":k(j);break;case"notes":prompt("Add notes for this activity:")&&alert("Notes added successfully");break}};return e.jsxs("div",{className:`space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0\r
`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Activity Timeline"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Track all communications and interactions"})]}),e.jsxs("button",{onClick:y,className:"flex items-center justify-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Activity"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Total Activities"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:u.length})]}),e.jsx(jt,{size:18,className:"text-blue-200"})]}),e.jsx("div",{className:"text-blue-100 text-xs mt-1",children:"All interactions"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"This Week"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:u.filter(T=>{const j=new Date(T.timestamp),E=new Date(Date.now()-10080*60*1e3);return j>=E}).length})]}),e.jsx(Rs,{size:18,className:"text-green-200"})]}),e.jsx("div",{className:"text-green-100 text-xs mt-1",children:"Recent activities"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-xs",children:"High Priority"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:u.filter(T=>T.priority==="high").length})]}),e.jsx(rt,{size:18,className:"text-purple-200"})]}),e.jsx("div",{className:"text-purple-100 text-xs mt-1",children:"Important tasks"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-xs",children:"Avg Response"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:"2.5h"})]}),e.jsx(Ls,{size:18,className:"text-orange-200"})]}),e.jsx("div",{className:"text-orange-100 text-xs mt-1",children:"Response time"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3 sm:p-4",children:e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search activities...",value:a,onChange:T=>t(T.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsx("select",{value:r,onChange:T=>i(T.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:c.map(T=>e.jsxs("option",{value:T.value,children:[T.label," (",T.count,")"]},T.value))}),e.jsx("select",{value:n,onChange:T=>o(T.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:f.map(T=>e.jsx("option",{value:T.value,children:T.label},T.value))})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:c.map(T=>e.jsxs("button",{onClick:()=>i(T.value),className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors whitespace-nowrap text-xs ${r===T.value?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"font-medium",children:T.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${r===T.value?"bg-blue-200":"bg-gray-200"}`,children:T.count})]},T.value))})})]})}),e.jsx("div",{className:"space-y-3",children:p.map(T=>e.jsx("div",{className:`bg-white rounded-lg border-l-4 ${w(T.priority)} shadow-sm hover:shadow-md transition-all`,children:e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg flex-shrink-0",children:N(T.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-xs sm:text-sm truncate",children:T.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(T.type)}`,children:T.type.replace("_"," ").toUpperCase()}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T.priority==="high"?"bg-red-100 text-red-700":T.priority==="medium"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:T.priority})]})]}),e.jsx("p",{className:"text-gray-700 mb-2 text-xs",children:T.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-4 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{size:10}),e.jsx("span",{children:$(T.timestamp)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{size:10}),e.jsx("span",{className:"truncate",children:T.property})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ls,{size:10}),e.jsx("span",{children:T.duration})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ms,{size:10}),e.jsx("span",{children:T.executedBy})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>g(m===T.id?null:T.id),className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:m===T.id?e.jsx(ea,{size:14}):e.jsx(pa,{size:14})}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(xr,{size:14})}),e.jsx("div",{className:"absolute right-0 top-10 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10 w-48",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("button",{onClick:()=>F("update",T),className:"w-full flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(ft,{size:12}),e.jsx("span",{children:"Edit Activity"})]}),e.jsxs("button",{onClick:()=>F("schedule",T),className:"w-full flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(Ts,{size:12}),e.jsx("span",{children:"Schedule Follow-up"})]}),e.jsxs("button",{onClick:()=>F("notes",T),className:"w-full flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(ws,{size:12}),e.jsx("span",{children:"Add Notes"})]})]})})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Stage"}),e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:T.stage.replace("_"," ").replace(/\b\w/g,j=>j.toUpperCase())})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Outcome"}),e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:T.outcome})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Next Action"}),e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:T.nextAction})]})]}),T.remarks&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Remarks"}),e.jsx("div",{className:"text-xs text-gray-700",children:T.remarks})]})]}),m===T.id&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3 text-xs",children:"Activity Details"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Type:"}),e.jsx("span",{className:"text-blue-800 ml-2 capitalize",children:T.type.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Duration:"}),e.jsx("span",{className:"text-blue-800 ml-2",children:T.duration})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Stage:"}),e.jsx("span",{className:"text-blue-800 ml-2",children:T.stage.replace("_"," ").replace(/\b\w/g,j=>j.toUpperCase())})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Status:"}),e.jsx("span",{className:"text-blue-800 ml-2 capitalize",children:T.status})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Property:"}),e.jsx("span",{className:"text-blue-800 ml-2",children:T.property})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-3 text-xs",children:"Activity Outcome"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Outcome:"}),e.jsx("div",{className:"text-xs text-green-800 mt-1",children:T.outcome})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Next Action:"}),e.jsx("div",{className:"text-xs text-green-800 mt-1",children:T.nextAction})]}),T.remarks&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-green-700 font-medium",children:"Remarks:"}),e.jsx("div",{className:"text-xs text-green-800 mt-1",children:T.remarks})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>F("update",T),className:"flex items-center space-x-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(ft,{size:12}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:()=>F("schedule",T),className:"flex items-center space-x-1 px-2 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-xs",children:[e.jsx(Ts,{size:12}),e.jsx("span",{className:"hidden sm:inline",children:"Follow-up"})]}),e.jsxs("button",{onClick:()=>F("notes",T),className:"flex items-center space-x-1 px-2 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-xs",children:[e.jsx(ws,{size:12}),e.jsx("span",{className:"hidden sm:inline",children:"Add Notes"})]})]})]})},T.id))}),p.length===0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[e.jsx(jt,{className:"mx-auto text-gray-300 mb-4",size:36}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"No activities found"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Try adjusting your search or filter criteria"})]}),b&&e.jsx(Hv,{isOpen:b,onClose:()=>{d(!1),x(null)},activity:v,onSave:R})]})},Hv=({isOpen:s,onClose:a,activity:t,onSave:r})=>{const[i,n]=l.useState({type:(t==null?void 0:t.type)||"call",title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",property:(t==null?void 0:t.property)||"",stage:(t==null?void 0:t.stage)||"initial_contact",duration:(t==null?void 0:t.duration)||"30 minutes",outcome:(t==null?void 0:t.outcome)||"",nextAction:(t==null?void 0:t.nextAction)||"",executedBy:(t==null?void 0:t.executedBy)||"Admin User",remarks:(t==null?void 0:t.remarks)||"",priority:(t==null?void 0:t.priority)||"medium"}),[o,m]=l.useState(!1);if(!s)return null;const g=[{value:"call",label:"Phone Call",icon:Cs},{value:"meeting",label:"Meeting",icon:Ns},{value:"email",label:"Email",icon:Ds},{value:"whatsapp",label:"WhatsApp",icon:tt},{value:"presentation",label:"Presentation",icon:ws},{value:"follow_up",label:"Follow-up",icon:ha}],b=[{value:"initial_contact",label:"Initial Contact"},{value:"requirement_gathering",label:"Requirement Gathering"},{value:"property_hunting",label:"Property Hunting"},{value:"negotiation",label:"Negotiation"},{value:"documentation",label:"Documentation"},{value:"deal_closure",label:"Deal Closure"}],d=["5 minutes","10 minutes","15 minutes","30 minutes","45 minutes","1 hour","1.5 hours","2 hours","3 hours"],v=[{value:"high",label:"High Priority"},{value:"medium",label:"Medium Priority"},{value:"low",label:"Low Priority"}],x=(c,f)=>{n(p=>({...p,[c]:f}))},u=async()=>{if(!i.title.trim()){alert("Please enter activity title");return}if(!i.outcome.trim()){alert("Please enter activity outcome");return}m(!0);try{const c={...i,id:(t==null?void 0:t.id)||Date.now(),timestamp:(t==null?void 0:t.timestamp)||new Date().toISOString(),status:"completed",created_at:(t==null?void 0:t.created_at)||new Date().toISOString(),updated_at:new Date().toISOString()};await r(c)}catch(c){console.error("Error saving activity:",c)}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-gray-900",children:t?"Edit Activity":"Add New Activity"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Record seller interaction and outcomes"})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:16})})]})}),e.jsxs("div",{className:"p-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Activity Type"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:g.map(c=>{const f=c.icon,p=i.type===c.value;return e.jsxs("button",{type:"button",onClick:()=>x("type",c.value),className:`flex items-center space-x-2 p-2 rounded-lg border-2 transition-all text-xs ${p?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:[e.jsx(f,{size:14}),e.jsx("span",{className:"font-medium",children:c.label})]},c.value)})})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Activity Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.title,onChange:c=>x("title",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",placeholder:"Brief title of the activity",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property"}),e.jsx("input",{type:"text",value:i.property,onChange:c=>x("property",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",placeholder:"Property name or address"})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:c=>x("description",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",rows:3,placeholder:"Detailed description of the activity..."})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duration"}),e.jsx("select",{value:i.duration,onChange:c=>x("duration",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",children:d.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Stage"}),e.jsx("select",{value:i.stage,onChange:c=>x("stage",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",children:b.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("select",{value:i.priority,onChange:c=>x("priority",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",children:v.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Outcome ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:i.outcome,onChange:c=>x("outcome",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",rows:2,placeholder:"What was achieved in this activity?",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Next Action"}),e.jsx("textarea",{value:i.nextAction,onChange:c=>x("nextAction",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",rows:2,placeholder:"What should be done next?"})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Detailed Remarks"}),e.jsx("textarea",{value:i.remarks,onChange:c=>x("remarks",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs",rows:3,placeholder:"Detailed notes about the activity, client response, concerns, etc."})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Activity will be added to seller timeline"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:"Cancel"}),e.jsxs("button",{onClick:u,disabled:o||!i.title.trim()||!i.outcome.trim(),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:o?"Saving...":t?"Update Activity":"Save Activity"})]})]})]})})]})})},Yv=({seller:s})=>{const[a,t]=l.useState(""),[r,i]=l.useState("all"),[n,o]=l.useState("all"),[m,g]=l.useState(null),b=[{id:1,type:"property_visit",title:"Property Visit Completed",description:"Site visit conducted for Skyline Towers property",timestamp:"2025-01-12T14:30:00Z",priority:"high",status:"completed",property:"Skyline Towers, Andheri West",visitor:"Interested Family",visitType:"initial_inspection",details:{duration:"45 minutes",areasVisited:["Living room","All bedrooms","Kitchen","Balcony"],feedback:"Very impressed with the layout and amenities",rating:4.5,concerns:["Parking space","Price negotiation"],nextSteps:"Follow up for final decision",followupDate:"2025-01-15",visitOutcome:"positive"},remarks:"Potential buyer showed genuine interest, family liked the property layout"},{id:2,type:"property_revisit",title:"Property Revisit Scheduled",description:"Second visit arranged for Green Valley Villa",timestamp:"2025-01-11T16:00:00Z",priority:"medium",status:"scheduled",property:"Green Valley Villa, Pune",visitor:"Previous Visitor",visitType:"detailed_inspection",details:{scheduledDate:"2025-01-16",scheduledTime:"10:00 AM",purpose:"Technical inspection with family",previousVisitDate:"2025-01-08",previousFeedback:"Liked the property, wants detailed inspection",specialRequests:["Structural inspection","Legal document review"],accompaniedBy:"Family members and technical expert"},remarks:"Serious buyer, second visit indicates strong interest"},{id:3,type:"property_inquiry",title:"Property Inquiry Received",description:"New inquiry received for Metro Heights property",timestamp:"2025-01-10T11:15:00Z",priority:"high",status:"new",property:"Metro Heights, Andheri East",visitor:"Potential Investor",visitType:"inquiry",details:{inquirySource:"Website",interestLevel:"High",budgetRange:"â‚¹1.6Cr - â‚¹1.8Cr",requirements:["2BHK","Investment purpose","Good rental yield"],timeSpent:"12 minutes",pagesViewed:8,followupRequired:!0,nextAction:"Schedule property visit"},remarks:"Investment-focused inquiry, showed detailed interest in rental potential"},{id:4,type:"property_maintenance",title:"Property Maintenance Completed",description:"Scheduled maintenance work completed for property preparation",timestamp:"2025-01-09T10:00:00Z",priority:"medium",status:"completed",property:"Skyline Towers, Andheri West",visitor:"Maintenance Team",visitType:"maintenance",details:{workType:"Pre-sale preparation",duration:"4 hours",workCompleted:["Deep cleaning","Minor repairs","Touch-up painting"],cost:"â‚¹8,500",vendor:"Premium Maintenance Services",qualityRating:4.8,nextMaintenance:"2025-04-09"},remarks:"Property now market-ready, excellent condition for showcasing"},{id:5,type:"property_photography",title:"Professional Photography Session",description:"Professional photos and video shoot completed",timestamp:"2025-01-08T15:30:00Z",priority:"low",status:"completed",property:"Green Valley Villa, Pune",visitor:"Photography Team",visitType:"photography",details:{sessionDuration:"3 hours",photosCount:45,videosCount:3,areasCovers:["Exterior","All rooms","Garden","Amenities"],photographer:"Premium Photography Services",deliveryDate:"2025-01-10",cost:"â‚¹15,000",qualityRating:4.9},remarks:"Excellent quality photos captured, property looks stunning in images"},{id:6,type:"property_inspection",title:"Property Inspection Conducted",description:"Technical inspection completed for property assessment",timestamp:"2025-01-07T09:00:00Z",priority:"medium",status:"completed",property:"Metro Heights, Andheri East",visitor:"Technical Inspector",visitType:"technical_inspection",details:{inspectorName:"Certified Property Inspector",duration:"2 hours",areasInspected:["Structure","Electrical","Plumbing","Fixtures"],overallRating:8.5,issues:["Minor electrical work needed","Bathroom tile replacement"],recommendations:["Complete minor repairs before listing","Get electrical safety certificate"],estimatedRepairCost:"â‚¹25,000",marketReadiness:"Good with minor improvements"},remarks:"Property in good condition, minor improvements will enhance market appeal"}],d=[{value:"all",label:"All Activities",count:b.length},{value:"property_visit",label:"Visits",count:b.filter(N=>N.type==="property_visit").length},{value:"property_revisit",label:"Revisits",count:b.filter(N=>N.type==="property_revisit").length},{value:"property_inquiry",label:"Inquiries",count:b.filter(N=>N.type==="property_inquiry").length},{value:"property_maintenance",label:"Maintenance",count:b.filter(N=>N.type==="property_maintenance").length},{value:"property_photography",label:"Photography",count:b.filter(N=>N.type==="property_photography").length}],v=[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"}],x=b.filter(N=>{const P=N.title.toLowerCase().includes(a.toLowerCase())||N.description.toLowerCase().includes(a.toLowerCase())||N.property.toLowerCase().includes(a.toLowerCase()),w=r==="all"||N.type===r;return P&&w}),u=N=>{switch(N){case"property_visit":return e.jsx(ks,{className:"text-green-600",size:16});case"property_revisit":return e.jsx(ks,{className:"text-blue-600",size:16});case"property_inquiry":return e.jsx(Ns,{className:"text-blue-600",size:16});case"property_maintenance":return e.jsx(Yt,{className:"text-orange-600",size:16});case"property_photography":return e.jsx(Sa,{className:"text-purple-600",size:16});case"property_inspection":return e.jsx(at,{className:"text-indigo-600",size:16});default:return e.jsx(jt,{className:"text-gray-600",size:16})}},c=N=>{switch(N){case"high":return"border-l-red-500 bg-red-50";case"medium":return"border-l-orange-500 bg-orange-50";case"low":return"border-l-green-500 bg-green-50";default:return"border-l-gray-500 bg-gray-50"}},f=N=>new Date(N).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),p=(N,P)=>{switch(N){case"schedule":alert("Follow-up scheduling functionality");break;case"update":alert("Activity update functionality");break;case"notes":prompt("Add notes for this activity:")&&alert("Notes added successfully");break}};return e.jsxs("div",{className:`space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0\r
`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Activity Timeline"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Complete history of property interactions"})]}),e.jsxs("button",{className:"flex items-center justify-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Activity"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3 sm:p-4",children:e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search activities...",value:a,onChange:N=>t(N.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsx("select",{value:r,onChange:N=>i(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:d.map(N=>e.jsxs("option",{value:N.value,children:[N.label," (",N.count,")"]},N.value))}),e.jsx("select",{value:n,onChange:N=>o(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:v.map(N=>e.jsx("option",{value:N.value,children:N.label},N.value))})]})]})}),e.jsx("div",{className:"space-y-3",children:x.map((N,P)=>e.jsx("div",{className:`bg-white rounded-lg border-l-4 ${c(N.priority)} shadow-sm hover:shadow-md transition-all`,children:e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg flex-shrink-0",children:u(N.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-xs sm:text-sm truncate",children:N.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N.priority==="high"?"bg-red-100 text-red-700":N.priority==="medium"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:N.priority}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N.status==="new"?"bg-blue-100 text-blue-700":N.status==="active"?"bg-orange-100 text-orange-700":N.status==="scheduled"?"bg-purple-100 text-purple-700":"bg-green-100 text-green-700"}`,children:N.status})]})]}),e.jsx("p",{className:"text-gray-700 mb-2 text-xs",children:N.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-4 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{size:10}),e.jsx("span",{children:f(N.timestamp)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{size:10}),e.jsx("span",{className:"truncate",children:N.property})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ms,{size:10}),e.jsx("span",{children:N.visitor})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>g(m===N.id?null:N.id),className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:m===N.id?e.jsx(ea,{size:14}):e.jsx(pa,{size:14})}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(xr,{size:14})}),e.jsx("div",{className:"absolute right-0 top-10 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10 w-48",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("button",{onClick:()=>p("schedule"),className:"w-full flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(Ts,{size:12}),e.jsx("span",{children:"Schedule Follow-up"})]}),e.jsxs("button",{onClick:()=>p("update"),className:"w-full flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(ft,{size:12}),e.jsx("span",{children:"Update Activity"})]}),e.jsxs("button",{onClick:()=>p("notes"),className:"w-full flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded",children:[e.jsx(ws,{size:12}),e.jsx("span",{children:"Add Notes"})]})]})})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Visitor"}),e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:N.visitor}),e.jsx("div",{className:"text-xs text-gray-600",children:N.visitType.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Date"}),e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:f(N.timestamp).split(",")[0]}),e.jsx("div",{className:"text-xs text-gray-600",children:f(N.timestamp).split(",")[1]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Status"}),e.jsx("div",{className:"font-medium text-gray-900 capitalize text-xs",children:N.status}),e.jsxs("div",{className:"text-xs text-gray-600",children:[N.priority," priority"]})]})]}),N.remarks&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Remarks"}),e.jsx("div",{className:"text-xs text-gray-700",children:N.remarks})]})]}),m===N.id&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-indigo-900 mb-3 text-xs",children:"Visit Details"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs",children:Object.entries(N.details).map(([w,$])=>e.jsxs("div",{children:[e.jsxs("span",{className:"text-indigo-700 font-medium",children:[w.replace(/([A-Z])/g," $1").replace(/^./,y=>y.toUpperCase()),":"]}),e.jsx("div",{className:"text-indigo-800 mt-1",children:Array.isArray($)?e.jsx("div",{className:"flex flex-wrap gap-1",children:$.map((y,k)=>e.jsx("span",{className:"px-2 py-1 bg-indigo-200 text-indigo-800 rounded-full text-xs",children:y},k))}):e.jsx("span",{children:$==null?void 0:$.toString()})})]},w))})]}),N.type==="property_visit"&&e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-3 text-xs",children:"Visit Outcome"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-green-700",children:"Rating:"}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[Array.from({length:5},(w,$)=>e.jsx(Xs,{size:12,className:$<Math.floor(N.details.rating)?"text-yellow-400 fill-current":"text-gray-300"},$)),e.jsxs("span",{className:"text-xs font-medium ml-2",children:[N.details.rating,"/5"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-green-700",children:"Outcome:"}),e.jsx("div",{className:"text-xs font-medium text-green-900 mt-1 capitalize",children:N.details.visitOutcome})]})]})]}),N.type==="property_revisit"&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3 text-xs",children:"Revisit Information"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Previous Visit:"}),e.jsx("span",{className:"font-medium text-blue-900",children:N.details.previousVisitDate})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Scheduled:"}),e.jsxs("span",{className:"font-medium text-blue-900",children:[N.details.scheduledDate," at ",N.details.scheduledTime]})]})]})]})]})]})},N.id))}),x.length===0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[e.jsx(jt,{className:"mx-auto text-gray-300 mb-4",size:36}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"No activities found"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Try adjusting your search or filter criteria"})]})]})},gx={blue:{bg100:"bg-blue-100",text600:"text-blue-600",dot:"bg-blue-500"},green:{bg100:"bg-green-100",text600:"text-green-600",dot:"bg-green-500"},purple:{bg100:"bg-purple-100",text600:"text-purple-600",dot:"bg-purple-500"},orange:{bg100:"bg-orange-100",text600:"text-orange-600",dot:"bg-orange-500"}},Gv=({seller:s})=>{const[a,t]=l.useState("30d"),[r,i]=l.useState("all"),[n,o]=l.useState(!0),[m,g]=l.useState(new Date);l.useEffect(()=>{if(!n)return;const P=setInterval(()=>{g(new Date)},300*1e3);return()=>clearInterval(P)},[n]);const b=[{value:"7d",label:"Last 7 Days"},{value:"30d",label:"Last 30 Days"},{value:"90d",label:"Last 3 Months"},{value:"1y",label:"Last Year"}],d=[{value:"all",label:"All Properties"},{value:"PROP001",label:"Skyline Towers"},{value:"PROP002",label:"Green Valley Villa"}],v=[{label:"Total Views",value:"2,847",change:"+23.5%",trend:"up",color:"blue",icon:ks,description:"Property page views across all platforms"},{label:"Inquiries",value:"156",change:"+18.2%",trend:"up",color:"green",icon:Ns,description:"Direct inquiries from potential buyers"},{label:"Site Visits",value:"23",change:"+12.1%",trend:"up",color:"purple",icon:rt,description:"Physical property visits scheduled"},{label:"Conversion Rate",value:"14.7%",change:"+2.3%",trend:"up",color:"orange",icon:Rs,description:"Inquiry to visit conversion rate"}],x={pricePosition:{percentile:78,comparison:"Above average",marketPrice:245e5,yourPrice:25e6,difference:"+2.04%"},demandLevel:{score:85,level:"High",factors:["Prime location","Good amenities","Ready to move"],trend:"increasing"},competitorAnalysis:{similarProperties:12,averagePrice:242e5,averageDaysOnMarket:45,yourDaysOnMarket:28}},u=[{type:"price_optimization",title:"Price Optimization",insight:"Your property is priced 2% above market average, which is optimal for your location and amenities.",confidence:92,action:"Maintain current pricing",impact:"Medium"},{type:"marketing_boost",title:"Marketing Performance",insight:"Adding professional photos could increase inquiry rate by 40% based on similar properties.",confidence:87,action:"Schedule professional photoshoot",impact:"High"},{type:"timing_analysis",title:"Market Timing",insight:"Current market conditions in Andheri West are favorable for sellers with 15% higher activity.",confidence:78,action:"Accelerate marketing efforts",impact:"High"},{type:"buyer_behavior",title:"Buyer Behavior Analysis",insight:"Most inquiries come from families looking for ready-to-move properties in your price range.",confidence:85,action:"Highlight ready possession in marketing",impact:"Medium"}],c=[{source:"MagicBricks",views:1247,inquiries:67,percentage:43.8,color:"blue"},{source:"99acres",views:892,inquiries:45,percentage:31.3,color:"green"},{source:"Housing.com",views:456,inquiries:28,percentage:16,color:"purple"},{source:"Direct/Referral",views:252,inquiries:16,percentage:8.9,color:"orange"}],f={ageGroups:[{range:"25-35",percentage:45,count:70},{range:"35-45",percentage:35,count:55},{range:"45-55",percentage:15,count:23},{range:"55+",percentage:5,count:8}],budgetRanges:[{range:"â‚¹2-2.5Cr",percentage:40,count:62},{range:"â‚¹2.5-3Cr",percentage:35,count:55},{range:"â‚¹3-3.5Cr",percentage:20,count:31},{range:"â‚¹3.5Cr+",percentage:5,count:8}],locations:[{area:"Andheri West",percentage:30,count:47},{area:"Bandra West",percentage:25,count:39},{area:"Juhu",percentage:20,count:31},{area:"Other Mumbai",percentage:15,count:23},{area:"Outside Mumbai",percentage:10,count:16}]},p=P=>P>=1e7?`â‚¹${(P/1e7).toFixed(1)}Cr`:P>=1e5?`â‚¹${(P/1e5).toFixed(1)}L`:`â‚¹${P.toLocaleString("en-IN")}`,N=()=>{new Date().toISOString(),alert("Analytics report exported successfully!")};return e.jsxs("div",{className:`space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0\r
`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Comprehensive performance insights and AI-powered recommendations"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[e.jsx(Ls,{size:12}),e.jsxs("span",{children:["Last updated: ",m.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>o(!n),className:`p-2 rounded-lg transition-colors ${n?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}`,title:n?"Auto-refresh enabled":"Auto-refresh disabled",children:e.jsx(na,{size:14,className:n?"animate-spin":""})}),e.jsxs("button",{onClick:N,className:"flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(Ys,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Export Report"})]})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3 sm:p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{size:14,className:"text-gray-500"}),e.jsx("select",{value:a,onChange:P=>t(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:b.map(P=>e.jsx("option",{value:P.value,children:P.label},P.value))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Is,{size:14,className:"text-gray-500"}),e.jsx("select",{value:r,onChange:P=>i(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:d.map(P=>e.jsx("option",{value:P.value,children:P.label},P.value))})]})]})}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:v.map((P,w)=>{const $=P.icon,y=P.trend==="up",k=gx[P.color];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${k.bg100}`,children:e.jsx($,{size:18,className:k.text600})}),e.jsxs("div",{className:`flex items-center space-x-1 ${y?"text-green-600":"text-red-600"}`,children:[y?e.jsx(Li,{size:12}):e.jsx(_u,{size:12}),e.jsx("span",{className:"text-xs font-medium",children:P.change})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:P.label}),e.jsx("p",{className:"text-sm sm:text-base font-bold text-gray-900 mt-1",children:P.value}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:P.description})]})]},w)})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg",children:e.jsx(Mt,{className:"text-white",size:18})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"AI-Powered Insights"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Smart recommendations to optimize your property performance"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map((P,w)=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Va,{className:"text-purple-600",size:14}),e.jsx("span",{className:"text-xs font-medium text-purple-800 uppercase tracking-wide",children:P.type.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded-full",children:[P.confidence,"% confidence"]}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${P.impact==="High"?"bg-red-100 text-red-700":P.impact==="Medium"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[P.impact," impact"]})]})]}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2 text-xs",children:P.title}),e.jsx("p",{className:"text-xs text-gray-700 mb-3",children:P.insight}),e.jsx("button",{className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-2 px-4 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all text-xs font-medium",children:P.action})]},w))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(rt,{className:"mr-2 text-blue-600",size:16}),"Market Position"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-blue-700",children:"Price Percentile"}),e.jsxs("span",{className:"text-sm font-bold text-blue-900",children:[x.pricePosition.percentile,"th"]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${x.pricePosition.percentile}%`}})}),e.jsx("p",{className:"text-xs text-blue-700 mt-2",children:x.pricePosition.comparison})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-xs sm:text-sm font-bold text-green-600",children:p(x.pricePosition.marketPrice)}),e.jsx("div",{className:"text-xs text-green-700",children:"Market Average"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-xs sm:text-sm font-bold text-purple-600",children:p(x.pricePosition.yourPrice)}),e.jsx("div",{className:"text-xs text-purple-700",children:"Your Price"})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("span",{className:`text-xs font-medium ${x.pricePosition.difference.startsWith("+")?"text-green-600":"text-red-600"}`,children:[x.pricePosition.difference," vs market"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Rs,{className:"mr-2 text-green-600",size:16}),"Demand Analysis"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:x.demandLevel.score}),e.jsxs("div",{className:"text-xs text-green-700 font-medium",children:[x.demandLevel.level," Demand"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700",children:"Demand Factors:"}),x.demandLevel.factors.map((P,w)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-500",size:10}),e.jsx("span",{className:"text-xs text-gray-700",children:P})]},w))]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-xs font-medium text-green-700",children:"Market Trend"}),e.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-1",children:[e.jsx(Rs,{className:"text-green-600",size:12}),e.jsx("span",{className:"text-xs font-bold text-green-800 capitalize",children:x.demandLevel.trend})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(_t,{className:"mr-2 text-blue-600",size:16}),"Traffic Sources"]}),e.jsx("div",{className:"space-y-3",children:c.map((P,w)=>{const $=gx[P.color];return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${$.dot}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:P.source}),e.jsxs("div",{className:"text-xs text-gray-600",children:[P.views," views â€¢ ",P.inquiries," inquiries"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[P.percentage,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"of total traffic"})]})]},w)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4 text-xs",children:"Age Groups"}),e.jsx("div",{className:"space-y-3",children:f.ageGroups.map((P,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-700",children:[P.range," years"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${P.percentage}%`}})}),e.jsxs("span",{className:"text-xs font-medium text-gray-900",children:[P.percentage,"%"]})]})]},w))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4 text-xs",children:"Budget Ranges"}),e.jsx("div",{className:"space-y-3",children:f.budgetRanges.map((P,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-700",children:P.range}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${P.percentage}%`}})}),e.jsxs("span",{className:"text-xs font-medium text-gray-900",children:[P.percentage,"%"]})]})]},w))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4 text-xs",children:"Visitor Locations"}),e.jsx("div",{className:"space-y-3",children:f.locations.map((P,w)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-700",children:P.area}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${P.percentage}%`}})}),e.jsxs("span",{className:"text-xs font-medium text-gray-900",children:[P.percentage,"%"]})]})]},w))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ot,{className:"mr-2 text-orange-600",size:16}),"Competitor Analysis"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-orange-600",children:x.competitorAnalysis.similarProperties}),e.jsx("div",{className:"text-xs text-orange-700 mt-1",children:"Similar Properties"}),e.jsx("div",{className:"text-xs text-orange-600 mt-2",children:"In your area"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-blue-600",children:p(x.competitorAnalysis.averagePrice)}),e.jsx("div",{className:"text-xs text-blue-700 mt-1",children:"Average Price"}),e.jsx("div",{className:"text-xs text-blue-600 mt-2",children:"Competitor pricing"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:x.competitorAnalysis.yourDaysOnMarket}),e.jsx("div",{className:"text-xs text-green-700 mt-1",children:"Days on Market"}),e.jsxs("div",{className:"text-xs text-green-600 mt-2",children:["vs ",x.competitorAnalysis.averageDaysOnMarket," avg"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ot,{className:"mr-2 text-yellow-600",size:16}),"Performance Recommendations"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(bs,{className:"text-green-600",size:14}),e.jsx("span",{className:"font-medium text-green-800 text-xs",children:"What's Working Well"})]}),e.jsxs("ul",{className:"text-xs text-green-700 space-y-1",children:[e.jsx("li",{children:"â€¢ High inquiry rate (23% above average)"}),e.jsx("li",{children:"â€¢ Good visitor conversion (65%)"}),e.jsx("li",{children:"â€¢ Competitive pricing strategy"}),e.jsx("li",{children:"â€¢ Strong online presence"})]})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ct,{className:"text-orange-600",size:14}),e.jsx("span",{className:"font-medium text-orange-800 text-xs",children:"Areas for Improvement"})]}),e.jsxs("ul",{className:"text-xs text-orange-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Add professional photography"}),e.jsx("li",{children:"â€¢ Create virtual tour"}),e.jsx("li",{children:"â€¢ Optimize listing descriptions"}),e.jsx("li",{children:"â€¢ Increase social media presence"})]})]})]})]})]})},Kv=({seller:s})=>{const[a,t]=l.useState(""),[r,i]=l.useState("all"),[n,o]=l.useState([]),[m,g]=l.useState(!0),b=[{id:"all",label:"All Vendors",icon:Yt,count:28},{id:"plumber",label:"Plumber",icon:nn,count:5},{id:"painter",label:"Painter",icon:Vc,count:6},{id:"electrician",label:"Electrician",icon:Ft,count:4},{id:"carpenter",label:"Carpenter",icon:Su,count:4},{id:"tiles",label:"Tiles & Flooring",icon:yt,count:4},{id:"waterproofing",label:"Waterproofing",icon:fl,count:3},{id:"interior",label:"Interior Designer",icon:yt,count:2}],d=[{id:1,name:"Rajesh Kumar",businessName:"Rajesh Plumbing Services",category:"plumber",phone:"9876543210",whatsapp:"9876543210",email:"rajesh.plumber@email.com",address:"Shop 15, Andheri West, Mumbai",rating:4.8,experience:12,verified:!0,reExpertRecommended:!0,completedProjects:450,responseTime:"30 minutes",availability:"Available",services:[{name:"Pipe Fitting",rate:"â‚¹800-1200",unit:"per point"},{name:"Leak Repair",rate:"â‚¹500-800",unit:"per repair"},{name:"Bathroom Installation",rate:"â‚¹15000-25000",unit:"lumpsum"}],tags:["24/7 Service","Emergency","Licensed","Insured","Warranty"],portfolio:["https://images.pexels.com/photos/1129019/pexels-photo-1129019.jpeg?auto=compress&cs=tinysrgb&w=200","https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=200"],reviews:[{rating:5,comment:"Excellent work, very professional",client:"Amit S."},{rating:5,comment:"Quick response and quality service",client:"Priya M."}],pricing:{hourlyRate:"â‚¹500-800",minimumCharge:"â‚¹1000",emergencyRate:"â‚¹1200-1500"}},{id:2,name:"Suresh Patel",businessName:"Premium Tiles & Marble",category:"tiles",phone:"8765432109",whatsapp:"8765432109",email:"premium.tiles@email.com",address:"Showroom 5, Bandra East, Mumbai",rating:4.9,experience:15,verified:!0,reExpertRecommended:!0,completedProjects:320,responseTime:"1 hour",availability:"Available",services:[{name:"Tile Installation",rate:"â‚¹80-150",unit:"per sq ft"},{name:"Marble Flooring",rate:"â‚¹200-500",unit:"per sq ft"},{name:"Bathroom Tiling",rate:"â‚¹25000-45000",unit:"lumpsum"}],tags:["Premium Quality","Designer Tiles","5 Year Warranty","Installation Included"],portfolio:["https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=200"],reviews:[{rating:5,comment:"Beautiful tile work, exceeded expectations",client:"Rohit K."}],pricing:{materialCost:"Varies by selection",laborCost:"â‚¹80-150 per sq ft",designConsultation:"â‚¹2000-5000"}},{id:3,name:"Meena Sharma",businessName:"Creative Paint Solutions",category:"painter",phone:"7654321098",whatsapp:"7654321098",email:"creative.paint@email.com",address:"Unit 12, Malad East, Mumbai",rating:4.7,experience:8,verified:!0,reExpertRecommended:!1,completedProjects:200,responseTime:"2 hours",availability:"Available",services:[{name:"Interior Painting",rate:"â‚¹15-25",unit:"per sq ft"},{name:"Exterior Painting",rate:"â‚¹20-30",unit:"per sq ft"},{name:"Texture & Design",rate:"â‚¹35-50",unit:"per sq ft"}],tags:["Eco-Friendly","Asian Paints Partner","Design Consultation","Color Matching"],portfolio:["https://images.pexels.com/photos/1129019/pexels-photo-1129019.jpeg?auto=compress&cs=tinysrgb&w=200"],reviews:[{rating:5,comment:"Amazing color combinations and finish",client:"Neha R."}],pricing:{materialCost:"Premium paints included",laborCost:"â‚¹15-50 per sq ft",designConsultation:"Free"}},{id:4,name:"Vivek Electricals",businessName:"Spark Pro Solutions",category:"electrician",phone:"6543210987",whatsapp:"6543210987",email:"spark.pro@email.com",address:"Shop 8, Powai, Mumbai",rating:4.6,experience:10,verified:!0,reExpertRecommended:!0,completedProjects:280,responseTime:"1 hour",availability:"Busy",services:[{name:"Wiring Installation",rate:"â‚¹40-60",unit:"per point"},{name:"Smart Home Setup",rate:"â‚¹10000-25000",unit:"lumpsum"},{name:"MCB & Distribution",rate:"â‚¹5000-15000",unit:"lumpsum"}],tags:["Smart Home Expert","Safety Certified","24/7 Emergency","IoT Integration"],portfolio:["https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=200","https://images.pexels.com/photos/1129019/pexels-photo-1129019.jpeg?auto=compress&cs=tinysrgb&w=200"],reviews:[{rating:5,comment:"Excellent smart home installation",client:"Raj K."}],pricing:{hourlyRate:"â‚¹800-1200",minimumCharge:"â‚¹1500",emergencyRate:"â‚¹1500-2000"}}],v=d.filter(p=>{const N=p.name.toLowerCase().includes(a.toLowerCase())||p.businessName.toLowerCase().includes(a.toLowerCase())||p.services.some($=>$.name.toLowerCase().includes(a.toLowerCase())),P=r==="all"||p.category===r,w=!m||p.reExpertRecommended;return N&&P&&w}),x=p=>{o(N=>N.includes(p)?N.filter(P=>P!==p):[...N,p])},u=(p,N)=>{switch(N){case"call":window.open(`tel:+91${p.phone}`);break;case"whatsapp":const P=`Hi ${p.name}, I found your contact through ResaleExpert. I need ${p.category} services for my property. Please share your availability and rates.`;window.open(`https://wa.me/91${p.whatsapp}?text=${encodeURIComponent(P)}`,"_blank");break;case"email":const w="Service Inquiry from ResaleExpert",$=`Dear ${p.name},

I found your contact through ResaleExpert platform. I need ${p.category} services for my property.

Please share your availability and detailed quotation.

Property Details:
- Location: ${(s==null?void 0:s.location)||"Mumbai"}, ${(s==null?void 0:s.city)||"Mumbai"}
- Type: Residential

Looking forward to your response.

Best regards,
${(s==null?void 0:s.name)||"Property Owner"}`;window.open(`mailto:${p.email}?subject=${encodeURIComponent(w)}&body=${encodeURIComponent($)}`,"_blank");break}},c=()=>{if(n.length===0){alert("Please select vendors to contact");return}d.filter(p=>n.includes(p.id)),alert(`Inquiry sent to ${n.length} vendors. They will contact you within 24 hours.`),o([])},f=p=>{const N=b.find(P=>P.id===p);return N?N.icon:Yt};return e.jsxs("div",{className:`space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0\r
`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:"Vendor Directory"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Trusted service providers for property maintenance and improvement"})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[n.length>0&&e.jsxs("button",{onClick:c,className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(Dt,{size:14,className:"sm:size-4"}),e.jsxs("span",{className:"hidden sm:inline",children:["Contact ",n.length," Vendors"]}),e.jsxs("span",{className:"sm:hidden",children:["Contact (",n.length,")"]})]}),e.jsxs("button",{className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(fs,{size:14,className:"sm:size-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Request Service"}),e.jsx("span",{className:"sm:hidden",children:"Request"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex flex-col space-y-3 lg:flex-row lg:items-center lg:space-y-0 lg:space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search vendors by name, service, or specialization...",value:a,onChange:p=>t(p.target.value),className:"w-full pl-7 sm:pl-9 pr-3 sm:pr-4 py-1.5 sm:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:p=>g(p.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"RE Recommended Only"})]}),e.jsxs("button",{className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1.5 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(Ys,{size:12,className:"sm:size-4"}),e.jsx("span",{children:"Export"})]})]})]}),e.jsx("div",{className:"mt-3 sm:mt-4",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto scrollbar-hide pb-1",children:b.map(p=>{const N=p.icon;return e.jsxs("button",{onClick:()=>i(p.id),className:`flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-colors whitespace-nowrap ${r===p.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(N,{size:12,className:"sm:size-3.5"}),e.jsx("span",{className:"text-xs font-medium",children:p.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs ${r===p.id?"bg-blue-200":"bg-gray-200"}`,children:p.count})]},p.id)})})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6",children:v.map(p=>{const N=f(p.category),P=n.includes(p.id);return e.jsxs("div",{className:`bg-white rounded-lg sm:rounded-xl border-2 transition-all hover:shadow-lg ${P?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"p-3 sm:p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx("input",{type:"checkbox",checked:P,onChange:()=>x(p.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("div",{className:"p-1.5 sm:p-2 bg-blue-100 rounded-lg",children:e.jsx(N,{className:"text-blue-600 sm:size-5",size:16})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center space-y-1 sm:space-y-0 sm:space-x-1",children:[p.verified&&e.jsxs("div",{className:"flex items-center space-x-0.5 sm:space-x-1 px-1.5 sm:px-2 py-0.5 sm:py-1 bg-green-100 text-green-700 rounded-full",children:[e.jsx(bs,{size:8,className:"sm:size-3"}),e.jsx("span",{className:"text-xs font-bold",children:"VERIFIED"})]}),p.reExpertRecommended&&e.jsxs("div",{className:"flex items-center space-x-0.5 sm:space-x-1 px-1.5 sm:px-2 py-0.5 sm:py-1 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full",children:[e.jsx(va,{className:"text-white sm:size-3",size:8}),e.jsx("span",{className:"text-white text-xs font-bold",children:"RE EXPERT"})]})]})]}),e.jsx("h3",{className:"text-sm sm:text-base font-bold text-gray-900 mb-1",children:p.name}),e.jsx("p",{className:"text-xs text-gray-600 mb-2 sm:mb-3 truncate",children:p.businessName}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 mb-2 sm:mb-3 text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Xs,{className:"text-yellow-500 fill-current",size:12}),e.jsx("span",{className:"font-medium",children:p.rating})]}),e.jsx("span",{className:"text-gray-300",children:"â€¢"}),e.jsxs("span",{className:"text-gray-600",children:[p.experience," years exp"]}),e.jsx("span",{className:"text-gray-300 hidden sm:inline",children:"â€¢"}),e.jsxs("span",{className:"text-gray-600 hidden sm:inline",children:[p.completedProjects," projects"]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-600 mb-2 sm:mb-3",children:[e.jsx(Qs,{size:10,className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:p.address})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full text-xs font-medium ${p.availability==="Available"?"bg-green-100 text-green-700":p.availability==="Busy"?"bg-orange-100 text-orange-700":"bg-red-100 text-red-700"}`,children:p.availability}),e.jsxs("span",{className:"text-xs text-blue-600",children:["Response: ",p.responseTime]})]})]}),e.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium text-gray-700 mb-2 sm:mb-3",children:"Services & Rates"}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[p.services.slice(0,2).map((w,$)=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-2 sm:p-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:w.name})}),e.jsxs("div",{className:"text-right ml-2",children:[e.jsx("div",{className:"text-xs sm:text-sm font-bold text-green-600",children:w.rate}),e.jsx("div",{className:"text-xs text-gray-500",children:w.unit})]})]})},$)),p.services.length>2&&e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",p.services.length-2," more services"]})]})]}),e.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[p.tags.slice(0,3).map((w,$)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:w},$)),p.tags.length>3&&e.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs",children:["+",p.tags.length-3]})]})}),p.portfolio.length>0&&e.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-medium text-gray-700 mb-2",children:"Portfolio"}),e.jsxs("div",{className:"flex space-x-1.5 sm:space-x-2",children:[p.portfolio.slice(0,3).map((w,$)=>e.jsx("img",{src:w,alt:`Work ${$+1}`,className:"w-12 h-9 sm:w-16 sm:h-12 object-cover rounded"},$)),p.portfolio.length>3&&e.jsx("div",{className:"w-12 h-9 sm:w-16 sm:h-12 bg-gray-100 rounded flex items-center justify-center",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["+",p.portfolio.length-3]})})]})]}),e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-1 sm:gap-2 mb-2 sm:mb-3",children:[e.jsxs("button",{onClick:()=>u(p,"call"),className:"flex items-center justify-center space-x-0.5 sm:space-x-1 py-1.5 sm:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Cs,{size:10,className:"sm:size-3"}),e.jsx("span",{className:"text-xs font-medium",children:"Call"})]}),e.jsxs("button",{onClick:()=>u(p,"whatsapp"),className:"flex items-center justify-center space-x-0.5 sm:space-x-1 py-1.5 sm:py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(tt,{size:10,className:"sm:size-3"}),e.jsx("span",{className:"text-xs font-medium",children:"WhatsApp"})]}),e.jsxs("button",{onClick:()=>u(p,"email"),className:"flex items-center justify-center space-x-0.5 sm:space-x-1 py-1.5 sm:py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(Ds,{size:10,className:"sm:size-3"}),e.jsx("span",{className:"text-xs font-medium",children:"Email"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Response: ",p.responseTime]}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:"View Details"})]})]})]},p.id)})}),n.length>0&&e.jsxs("div",{className:"bg-blue-50 rounded-lg sm:rounded-xl border border-blue-200 p-4 sm:p-6",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-blue-900 mb-3 sm:mb-4",children:"Service Request Summary"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 sm:p-4",children:[e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:n.length}),e.jsx("div",{className:"text-xs sm:text-sm text-blue-700",children:"Vendors Selected"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 sm:p-4",children:[e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:n.reduce((p,N)=>{const P=d.find(w=>w.id===N);return p+((P==null?void 0:P.services.length)||0)},0)}),e.jsx("div",{className:"text-xs sm:text-sm text-green-700",children:"Total Services"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 sm:p-4",children:[e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:(n.reduce((p,N)=>{const P=d.find(w=>w.id===N);return p+((P==null?void 0:P.rating)||0)},0)/n.length).toFixed(1)}),e.jsx("div",{className:"text-xs sm:text-sm text-purple-700",children:"Avg Rating"})]})]})]}),v.length===0&&e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 p-8 sm:p-12 text-center",children:[e.jsx(Ns,{className:"mx-auto text-gray-300 mb-4 sm:size-12",size:32}),e.jsx("h3",{className:"text-sm sm:text-lg font-semibold text-gray-900 mb-2",children:"No vendors found"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]})]})},Ua=s=>s>=1e7?`â‚¹${(s/1e7).toFixed(1)}Cr`:s>=1e5?`â‚¹${(s/1e5).toFixed(1)}L`:`â‚¹${s.toLocaleString("en-IN")}`,Jv=({seller:s})=>{const[a,t]=l.useState("active"),[r,i]=l.useState(""),[n,o]=l.useState(null),m=[{id:1,property:{id:"PROP001",title:"Luxury 3BHK Apartment",address:"Skyline Towers, Andheri West, Mumbai",image:"https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=400"},buyer:{name:"Amit Patel",phone:"+91 98765 11111",email:"amit.patel@email.com",budget:"â‚¹2.2Cr - â‚¹2.6Cr"},dealDetails:{agreedPrice:245e5,originalPrice:25e6,negotiationDiscount:5e5,tokenAmount:5e5,registrationAmount:24e6,brokerageRate:2,brokerageAmount:49e4,dealDate:"2025-01-15",possessionDate:"2025-02-15",registrationDate:"2025-01-30"},status:"token_received",stage:"documentation",progress:65,priority:"high",timeline:[{date:"2025-01-10",event:"Initial offer received",status:"completed"},{date:"2025-01-12",event:"Price negotiation",status:"completed"},{date:"2025-01-15",event:"Token amount received",status:"completed"},{date:"2025-01-20",event:"Documentation in progress",status:"active"},{date:"2025-01-30",event:"Registration scheduled",status:"pending"}],documents:[{name:"Sale Agreement",status:"completed",date:"2025-01-15"},{name:"NOC from Society",status:"pending",date:null},{name:"Bank NOC",status:"in_progress",date:null},{name:"Registration Documents",status:"pending",date:null}],payments:[{type:"Token Amount",amount:5e5,status:"received",date:"2025-01-15"},{type:"Registration Amount",amount:24e6,status:"pending",dueDate:"2025-01-30"}]},{id:2,property:{id:"PROP002",title:"Premium Villa with Garden",address:"Green Valley Society, Pune",image:"https://images.pexels.com/photos/1396132/pexels-photo-1396132.jpeg?auto=compress&cs=tinysrgb&w=400"},buyer:{name:"Priya Shah",phone:"+91 87654 32109",email:"priya.shah@email.com",budget:"â‚¹3.8Cr - â‚¹4.5Cr"},dealDetails:{agreedPrice:41e6,originalPrice:42e6,negotiationDiscount:1e6,tokenAmount:1e6,registrationAmount:4e7,brokerageRate:1.5,brokerageAmount:615e3,dealDate:"2025-01-08",possessionDate:"2025-03-01",registrationDate:"2025-02-15"},status:"negotiation",stage:"price_discussion",progress:35,priority:"medium",timeline:[{date:"2025-01-05",event:"Initial inquiry",status:"completed"},{date:"2025-01-08",event:"Property visit",status:"completed"},{date:"2025-01-10",event:"Offer submitted",status:"completed"},{date:"2025-01-12",event:"Counter offer sent",status:"active"},{date:"2025-01-18",event:"Final negotiation",status:"pending"}],documents:[{name:"Property Valuation",status:"completed",date:"2025-01-08"},{name:"Legal Verification",status:"in_progress",date:null}],payments:[]}],g=[{id:"active",label:"Active Deals",count:m.filter(u=>u.status!=="completed").length},{id:"completed",label:"Completed",count:m.filter(u=>u.status==="completed").length},{id:"pipeline",label:"Pipeline",count:5},{id:"all",label:"All Deals",count:m.length}],b=m.filter(u=>{const c=u.buyer.name.toLowerCase().includes(r.toLowerCase())||u.property.title.toLowerCase().includes(r.toLowerCase())||u.property.address.toLowerCase().includes(r.toLowerCase()),f=a==="all"||a==="active"&&u.status!=="completed"||a==="completed"&&u.status==="completed";return c&&f}),d=u=>{const c={inquiry:{bg:"bg-blue-100",text:"text-blue-700",label:"Inquiry"},negotiation:{bg:"bg-orange-100",text:"text-orange-700",label:"Negotiation"},token_received:{bg:"bg-green-100",text:"text-green-700",label:"Token Received"},documentation:{bg:"bg-purple-100",text:"text-purple-700",label:"Documentation"},registration:{bg:"bg-indigo-100",text:"text-indigo-700",label:"Registration"},completed:{bg:"bg-emerald-100",text:"text-emerald-700",label:"Completed"}},f=c[u]||c.inquiry;return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${f.bg} ${f.text}`,children:f.label})},v=u=>{const f={high:{bg:"bg-red-100",text:"text-red-700",label:"High Priority",icon:"ðŸ”¥"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium Priority",icon:"âš¡"},low:{bg:"bg-green-100",text:"text-green-700",label:"Low Priority",icon:"ðŸŒ±"}}[u];return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${f.bg} ${f.text}`,children:[e.jsx("span",{className:"mr-1",children:f.icon}),e.jsx("span",{className:"hidden sm:inline",children:f.label})]})},x=(u,c)=>{switch(u){case"call":window.open(`tel:${c.buyer.phone}`);break;case"whatsapp":const f=`Hi ${c.buyer.name}, regarding the deal for ${c.property.title}. Current status: ${c.status}. Let me know if you need any updates.`;window.open(`https://wa.me/${c.buyer.phone.replace(/\D/g,"")}?text=${encodeURIComponent(f)}`,"_blank");break;case"email":const p=`Deal Update - ${c.property.title}`,N=`Dear ${c.buyer.name},

I hope this email finds you well.

This is to update you on the status of your property deal:

Property: ${c.property.title}
Agreed Price: ${Ua(c.dealDetails.agreedPrice)}
Current Status: ${c.status}

Next steps will be communicated shortly.

Best regards,
${(s==null?void 0:s.name)||"Property Agent"}`;window.open(`mailto:${c.buyer.email}?subject=${encodeURIComponent(p)}&body=${encodeURIComponent(N)}`,"_blank");break;case"view":o(c);break}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Deals Management"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Track and manage all your property deals in one place"})]}),e.jsxs("button",{className:"flex items-center justify-center space-x-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Create Deal"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"Total Deal Value"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:Ua(655e5)})]}),e.jsx(ka,{size:18,className:"text-green-200"})]}),e.jsx("div",{className:"text-green-100 text-xs mt-1",children:"Across all active deals"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Active Deals"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:m.filter(u=>u.status!=="completed").length})]}),e.jsx(Cl,{size:18,className:"text-blue-200"})]}),e.jsx("div",{className:"text-blue-100 text-xs mt-1",children:"In various stages"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-xs",children:"Avg Deal Time"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:"28 days"})]}),e.jsx(Ls,{size:18,className:"text-purple-200"})]}),e.jsx("div",{className:"text-purple-100 text-xs mt-1",children:"From inquiry to closure"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-xs",children:"Success Rate"}),e.jsx("p",{className:"text-sm sm:text-base font-bold",children:"78%"})]}),e.jsx(rt,{size:18,className:"text-orange-200"})]}),e.jsx("div",{className:"text-orange-100 text-xs mt-1",children:"Above industry average"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3 sm:p-4",children:e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search deals by buyer name, property...",value:r,onChange:u=>i(u.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(Na,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Advanced Filters"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(Ys,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]})]})}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto",children:g.map(u=>e.jsxs("button",{onClick:()=>t(u.id),className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors text-xs whitespace-nowrap ${a===u.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"font-medium",children:u.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${a===u.id?"bg-blue-200":"bg-gray-200"}`,children:u.count})]},u.id))})})]})}),e.jsx("div",{className:"space-y-3",children:b.map(u=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-all",children:e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between space-y-3 sm:space-y-0 mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("img",{src:u.property.image,alt:u.property.title,className:"w-12 h-12 sm:w-14 sm:h-14 object-cover rounded-lg flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-xs sm:text-sm truncate",children:u.property.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d(u.status),v(u.priority)]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mb-2",children:[e.jsx(Qs,{size:12}),e.jsx("span",{className:"text-xs truncate",children:u.property.address})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-4 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ms,{size:10}),e.jsxs("span",{children:["Buyer: ",u.buyer.name]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{size:10}),e.jsxs("span",{children:["Deal Date: ",u.dealDetails.dealDate]})]})]})]})]}),e.jsxs("div",{className:"text-center sm:text-right",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:Ua(u.dealDetails.agreedPrice)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Agreed Price"}),u.dealDetails.negotiationDiscount>0&&e.jsxs("div",{className:"text-xs text-red-600",children:["-",Ua(u.dealDetails.negotiationDiscount)," discount"]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Deal Progress"}),e.jsxs("span",{className:"text-xs font-bold text-blue-600",children:[u.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-500",style:{width:`${u.progress}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xs sm:text-sm font-bold text-green-600",children:Ua(u.dealDetails.brokerageAmount)}),e.jsxs("div",{className:"text-xs text-green-700",children:["Brokerage (",u.dealDetails.brokerageRate,"%)"]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xs sm:text-sm font-bold text-blue-600",children:Ua(u.dealDetails.tokenAmount)}),e.jsx("div",{className:"text-xs text-blue-700",children:"Token Amount"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xs sm:text-sm font-bold text-purple-600",children:u.dealDetails.possessionDate}),e.jsx("div",{className:"text-xs text-purple-700",children:"Possession Date"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xs sm:text-sm font-bold text-orange-600",children:u.dealDetails.registrationDate}),e.jsx("div",{className:"text-xs text-orange-700",children:"Registration Date"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:"Deal Timeline"}),e.jsx("div",{className:"flex items-center space-x-2 overflow-x-auto pb-2",children:u.timeline.map((c,f)=>e.jsxs("div",{className:"flex items-center space-x-2 min-w-max",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${c.status==="completed"?"bg-green-500 text-white":c.status==="active"?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:c.status==="completed"?e.jsx(bs,{size:12}):c.status==="active"?e.jsx(Ls,{size:12}):e.jsx(ct,{size:12})}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate max-w-24",children:c.event}),e.jsx("div",{className:"text-gray-500",children:c.date})]}),f<u.timeline.length-1&&e.jsx("div",{className:"w-4 h-0.5 bg-gray-300"})]},f))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:"Document Status"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:u.documents.map((c,f)=>e.jsxs("div",{className:`p-2 rounded-lg text-center ${c.status==="completed"?"bg-green-100 text-green-700":c.status==="in_progress"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:[e.jsx("div",{className:"text-xs font-medium truncate",children:c.name}),e.jsx("div",{className:"text-xs capitalize",children:c.status.replace("_"," ")})]},f))})]}),u.payments.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:"Payment Status"}),e.jsx("div",{className:"space-y-2",children:u.payments.map((c,f)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:c.type}),e.jsx("div",{className:"text-xs text-gray-600",children:Ua(c.amount)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c.status==="received"?"bg-green-100 text-green-700":c.status==="pending"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:c.status}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:c.date||c.dueDate})]})]},f))})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{onClick:()=>x("view",u),className:"flex items-center space-x-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(ks,{size:12}),e.jsx("span",{children:"View"})]}),e.jsxs("button",{onClick:()=>x("call",u),className:"flex items-center space-x-1 px-2 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-xs",children:[e.jsx(Cs,{size:12}),e.jsx("span",{className:"hidden sm:inline",children:"Call"})]}),e.jsxs("button",{onClick:()=>x("whatsapp",u),className:"flex items-center space-x-1 px-2 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-xs",children:[e.jsx(tt,{size:12}),e.jsx("span",{className:"hidden sm:inline",children:"WhatsApp"})]}),e.jsxs("button",{onClick:()=>x("email",u),className:"flex items-center space-x-1 px-2 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-xs",children:[e.jsx(Ds,{size:12}),e.jsx("span",{className:"hidden sm:inline",children:"Email"})]})]})]})},u.id))}),e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200 p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg",children:e.jsx(Va,{className:"text-white",size:18})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"AI Deal Intelligence"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Smart insights to optimize your deals"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(rt,{className:"text-indigo-600",size:14}),e.jsx("h4",{className:"font-semibold text-indigo-900 text-xs",children:"Deal Optimization"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(zt,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Amit Patel deal has 85% closure probability - prioritize follow-up"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(zt,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Priya Shah may accept 2% additional discount - consider negotiation"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(zt,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Documentation delays detected - expedite NOC processes"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Rs,{className:"text-indigo-600",size:14}),e.jsx("h4",{className:"font-semibold text-indigo-900 text-xs",children:"Market Timing"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(vl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Current market favors sellers - good time to close deals"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(vl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Interest rates stable for next 3 months - buyer confidence high"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(vl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Festival season approaching - accelerate closures"})]})]})]})]})]}),b.length===0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[e.jsx(Cl,{className:"mx-auto text-gray-300 mb-4",size:36}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"No deals found"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Try adjusting your search or filter criteria"})]}),n&&e.jsx(Qv,{deal:n,onClose:()=>o(null),onUpdate:u=>{o(null)}})]})},Qv=({deal:s,onClose:a,onUpdate:t})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900",children:["Deal Details - ",s.property.title]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(ns,{size:18})})]})}),e.jsx("div",{className:"p-4 max-h-[70vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-xs",children:"Deal Summary"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Original Price:"}),e.jsx("span",{className:"font-medium",children:Ua(s.dealDetails.originalPrice)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Agreed Price:"}),e.jsx("span",{className:"font-medium text-green-600",children:Ua(s.dealDetails.agreedPrice)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Discount Given:"}),e.jsx("span",{className:"font-medium text-red-600",children:Ua(s.dealDetails.negotiationDiscount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Brokerage:"}),e.jsx("span",{className:"font-medium text-purple-600",children:Ua(s.dealDetails.brokerageAmount)})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3 text-xs",children:"Buyer Information"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsx("div",{className:"font-medium text-blue-900",children:s.buyer.name}),e.jsx("div",{className:"text-blue-700",children:s.buyer.phone}),e.jsx("div",{className:"text-blue-700",children:s.buyer.email}),e.jsxs("div",{className:"text-blue-700",children:["Budget: ",s.buyer.budget]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-xs",children:"Document Checklist"}),e.jsx("div",{className:"space-y-2",children:s.documents.map((r,i)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-700",children:r.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.status==="completed"?"bg-green-100 text-green-700":r.status==="in_progress"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:r.status.replace("_"," ")})]},i))})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-3 text-xs",children:"Payment Schedule"}),e.jsx("div",{className:"space-y-2",children:s.payments.map((r,i)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-green-900",children:r.type}),e.jsx("div",{className:"text-xs text-green-700",children:Ua(r.amount)})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.status==="received"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:r.status})]},i))})]})]})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:"Close"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:"Update Deal"})]})})]})}),Fa=s=>typeof s!="number"||isNaN(s)?"â‚¹0":s>=1e7?`â‚¹${(s/1e7).toFixed(1)}Cr`:s>=1e5?`â‚¹${(s/1e5).toFixed(1)}L`:`â‚¹${s.toLocaleString("en-IN")}`,Zv=s=>{switch(s){case"brokerage_received":return e.jsx(Pa,{className:"text-green-600",size:16});case"brokerage_pending":return e.jsx(Ls,{className:"text-orange-600",size:16});case"marketing_expense":return e.jsx(Rs,{className:"text-blue-600",size:16});case"legal_fee":return e.jsx(ws,{className:"text-purple-600",size:16});case"maintenance":return e.jsx(Yt,{className:"text-gray-600",size:16});case"portal_listing":return e.jsx(Is,{className:"text-indigo-600",size:16});default:return e.jsx(Ut,{className:"text-gray-600",size:16})}},bg=s=>{const a={completed:{bg:"bg-green-100",text:"text-green-700",label:"Completed",icon:bs},pending:{bg:"bg-orange-100",text:"text-orange-700",label:"Pending",icon:Ls},failed:{bg:"bg-red-100",text:"text-red-700",label:"Failed",icon:ct}},t=a[s]??a.pending,r=t.icon;return e.jsxs("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${t.bg} ${t.text}`,children:[e.jsx(r,{size:10,className:"mr-1"}),t.label]})},Xv=({transaction:s,onClose:a})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl w-full max-w-3xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-3 sm:p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm sm:text-xl font-semibold text-gray-900",children:"Transaction Details"}),e.jsx("button",{onClick:a,className:"p-1 sm:p-2 hover:bg-gray-100 rounded",children:e.jsx(ns,{size:16,className:"sm:size-5"})})]})}),e.jsx("div",{className:"p-3 sm:p-6 max-h-[70vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-900 mb-2 sm:mb-3",children:"Transaction Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Amount:"}),e.jsx("span",{className:"text-xs sm:text-sm font-bold",children:Fa(s.amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Date:"}),e.jsx("span",{className:"text-xs font-medium",children:s.date})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Status:"}),e.jsx("span",{children:bg(s.status)})]})]}),e.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Method:"}),e.jsx("span",{className:"text-xs font-medium",children:s.paymentMethod??"â€”"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Transaction ID:"}),e.jsx("span",{className:"text-xs font-mono break-all",children:s.transactionId??"â€”"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Category:"}),e.jsx("span",{className:`text-xs font-medium capitalize ${s.category==="income"?"text-green-600":"text-red-600"}`,children:s.category??"other"})]})]})]})]}),s.dealValue!==void 0&&e.jsxs("div",{className:"bg-green-50 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-green-900 mb-2 sm:mb-3",children:"Deal Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Deal Value:"}),e.jsx("span",{className:"font-bold",children:Fa(s.dealValue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Brokerage Rate:"}),e.jsxs("span",{className:"font-bold",children:[s.brokerageRate??"â€”","%"]})]}),s.gstAmount!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"GST Amount:"}),e.jsx("span",{className:"font-bold",children:Fa(s.gstAmount)})]}),s.netAmount!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Net Received:"}),e.jsx("span",{className:"font-bold",children:Fa(s.netAmount)})]})]})]}),(s.features||s.services||s.workDetails)&&e.jsxs("div",{className:"bg-blue-50 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-blue-900 mb-2 sm:mb-3",children:"Service Details"}),e.jsxs("div",{className:"space-y-2",children:[s.features&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-blue-700",children:"Features:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.features.map((t,r)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded text-xs",children:t},r))})]}),s.services&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-blue-700",children:"Services:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.services.map((t,r)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded text-xs",children:t},r))})]}),s.workDetails&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-blue-700",children:"Work Done:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.workDetails.map((t,r)=>e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded text-xs",children:t},r))})]})]})]})]})}),e.jsx("div",{className:"p-3 sm:p-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-end space-x-2 sm:space-x-3",children:[e.jsx("button",{onClick:a,className:"px-3 py-1.5 sm:px-4 sm:py-2 text-xs text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"}),s.invoiceId&&e.jsx("button",{className:"px-3 py-1.5 sm:px-4 sm:py-2 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Download Invoice"})]})})]})}),eN=({seller:s,initialTransactions:a})=>{const[t,r]=l.useState("all"),[i,n]=l.useState(""),[o,m]=l.useState("all"),[g,b]=l.useState(null),d=a??[{id:1,type:"brokerage_received",description:"Brokerage commission received",amount:49e4,date:"2025-01-15",status:"completed",property:"Skyline Towers, Andheri West",buyer:"Amit Patel",dealValue:245e5,brokerageRate:2,paymentMethod:"RTGS",transactionId:"TXN123456789",gstAmount:88200,netAmount:401800,invoiceId:"INV-2025-001",category:"income"},{id:2,type:"marketing_expense",description:"Professional photography and videography",amount:15e3,date:"2025-01-10",status:"completed",property:"Green Valley Villa, Pune",vendor:"Premium Photography Services",category:"expense",paymentMethod:"UPI",transactionId:"TXN987654321",invoiceId:"EXP-2025-001"},{id:3,type:"portal_listing",description:"Premium listing on property portals",amount:5e3,date:"2025-01-08",status:"completed",property:"All Properties",vendor:"MagicBricks Premium",category:"expense",paymentMethod:"Credit Card",transactionId:"TXN555666777",duration:"3 months",features:["Featured listing","Top placement","Analytics"]},{id:4,type:"legal_fee",description:"Legal documentation and verification",amount:25e3,date:"2025-01-05",status:"completed",property:"Skyline Towers, Andheri West",vendor:"Legal Associates",category:"expense",paymentMethod:"Cheque",transactionId:"TXN444555666",services:["Document verification","Legal opinion","Registration support"]},{id:5,type:"maintenance",description:"Property maintenance and repairs",amount:35e3,date:"2025-01-03",status:"completed",property:"Green Valley Villa, Pune",vendor:"Home Maintenance Services",category:"expense",paymentMethod:"Cash",transactionId:"TXN333444555",workDetails:["Painting touch-up","Plumbing repairs","Electrical fixes"]},{id:6,type:"brokerage_pending",description:"Pending brokerage from villa deal",amount:615e3,date:"2025-01-20",status:"pending",property:"Green Valley Villa, Pune",buyer:"Priya Shah",dealValue:41e6,brokerageRate:1.5,expectedDate:"2025-01-25",category:"income"}],v=[{id:"all",label:"All Transactions",count:d.length},{id:"income",label:"Income",count:d.filter(w=>w.category==="income").length},{id:"expense",label:"Expenses",count:d.filter(w=>w.category==="expense").length},{id:"pending",label:"Pending",count:d.filter(w=>w.status==="pending").length}],x=[{value:"all",label:"All Time"},{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"quarter",label:"This Quarter"},{value:"year",label:"This Year"}],u=d.filter(w=>{const $=i.trim().toLowerCase(),y=!$||w.description.toLowerCase().includes($)||(w.property??"").toLowerCase().includes($)||(w.buyer??"").toLowerCase().includes($)||(w.vendor??"").toLowerCase().includes($),k=t==="all"||t==="pending"&&w.status==="pending"||w.category===t;return y&&k}),c=d.filter(w=>w.category==="income"&&w.status==="completed").reduce((w,$)=>w+$.amount,0),f=d.filter(w=>w.category==="expense"&&w.status==="completed").reduce((w,$)=>w+$.amount,0),p=d.filter(w=>w.category==="income"&&w.status==="pending").reduce((w,$)=>w+$.amount,0),N=c-f,P=()=>{new Date().toISOString(),alert("Transaction report exported successfully!")};return e.jsxs("div",{className:"space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:"Transaction History"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Complete financial transaction records and analysis"})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsxs("button",{onClick:P,className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(Ys,{size:14,className:"sm:size-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export Report"}),e.jsx("span",{className:"sm:hidden",children:"Export"})]}),e.jsxs("button",{className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(fs,{size:14,className:"sm:size-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Transaction"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg sm:rounded-xl p-3 sm:p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"Total Income"}),e.jsx("p",{className:"text-sm sm:text-lg lg:text-2xl font-bold",children:Fa(c)})]}),e.jsx(Rs,{size:18,className:"text-green-200 sm:size-6"})]}),e.jsx("div",{className:"text-green-100 text-xs mt-1 sm:mt-2 hidden sm:block",children:"From brokerage & commissions"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-lg sm:rounded-xl p-3 sm:p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-100 text-xs",children:"Total Expenses"}),e.jsx("p",{className:"text-sm sm:text-lg lg:text-2xl font-bold",children:Fa(f)})]}),e.jsx(qc,{size:18,className:"text-red-200 sm:size-6"})]}),e.jsx("div",{className:"text-red-100 text-xs mt-1 sm:mt-2 hidden sm:block",children:"Marketing & operational costs"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg sm:rounded-xl p-3 sm:p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Net Income"}),e.jsx("p",{className:"text-sm sm:text-lg lg:text-2xl font-bold",children:Fa(N)})]}),e.jsx(ka,{size:18,className:"text-blue-200 sm:size-6"})]}),e.jsx("div",{className:"text-blue-100 text-xs mt-1 sm:mt-2 hidden sm:block",children:"After all expenses"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg sm:rounded-xl p-3 sm:p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-xs",children:"Pending Income"}),e.jsx("p",{className:"text-sm sm:text-lg lg:text-2xl font-bold",children:Fa(p)})]}),e.jsx(Ls,{size:18,className:"text-orange-200 sm:size-6"})]}),e.jsx("div",{className:"text-orange-100 text-xs mt-1 sm:mt-2 hidden sm:block",children:"Expected this month"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex flex-col space-y-3 lg:flex-row lg:items-center lg:space-y-0 lg:space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search transactions...",value:i,onChange:w=>n(w.target.value),className:"w-full pl-7 sm:pl-9 pr-3 sm:pr-4 py-1.5 sm:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx("select",{value:o,onChange:w=>m(w.target.value),className:"px-2 sm:px-3 py-1.5 sm:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:x.map(w=>e.jsx("option",{value:w.value,children:w.label},w.value))}),e.jsxs("button",{className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1.5 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(Na,{size:12,className:"sm:size-4"}),e.jsx("span",{className:"hidden sm:inline",children:"More Filters"}),e.jsx("span",{className:"sm:hidden",children:"Filters"})]})]})]}),e.jsx("div",{className:"mt-3 sm:mt-4",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto scrollbar-hide",children:v.map(w=>e.jsxs("button",{onClick:()=>r(w.id),className:`flex items-center space-x-1 sm:space-x-2 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-colors whitespace-nowrap ${t===w.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"text-xs font-medium",children:w.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs ${t===w.id?"bg-blue-200":"bg-gray-200"}`,children:w.count})]},w.id))})})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[u.map(w=>e.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:e.jsxs("div",{className:"p-3 sm:p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-4 flex-1",children:[e.jsx("div",{className:"p-2 sm:p-3 bg-gray-50 rounded-lg sm:rounded-xl",children:Zv(w.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-xs sm:text-sm lg:text-base truncate",children:w.description}),bg(w.status)]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1 sm:gap-3 text-xs text-gray-600 mb-2 sm:mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{size:10,className:"sm:size-3"}),e.jsx("span",{children:w.date})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{size:10,className:"sm:size-3"}),e.jsx("span",{className:"truncate",children:w.property})]}),w.buyer&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ms,{size:10,className:"sm:size-3"}),e.jsx("span",{className:"truncate",children:w.buyer})]}),w.vendor&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ns,{size:10,className:"sm:size-3"}),e.jsx("span",{className:"truncate",children:w.vendor})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Payment Details"}),e.jsxs("div",{className:"space-y-0.5 sm:space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Method:"}),e.jsx("span",{className:"text-xs font-medium",children:w.paymentMethod})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Transaction ID:"}),e.jsx("span",{className:"text-xs font-mono truncate ml-2",children:w.transactionId})]}),w.invoiceId&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Invoice ID:"}),e.jsx("span",{className:"text-xs font-mono truncate ml-2",children:w.invoiceId})]})]})]}),w.category==="income"&&w.dealValue!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Deal Breakdown"}),e.jsxs("div",{className:"space-y-0.5 sm:space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Deal Value:"}),e.jsx("span",{className:"text-xs font-medium",children:Fa(w.dealValue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Brokerage Rate:"}),e.jsxs("span",{className:"text-xs font-medium",children:[w.brokerageRate,"%"]})]}),w.gstAmount!==void 0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"GST:"}),e.jsx("span",{className:"text-xs font-medium",children:Fa(w.gstAmount)})]}),w.netAmount!==void 0&&e.jsxs("div",{className:"flex justify-between border-t pt-0.5 sm:pt-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Net Amount:"}),e.jsx("span",{className:"text-xs font-bold text-green-600",children:Fa(w.netAmount)})]})]})]})]})]})]}),e.jsxs("div",{className:"text-right ml-2",children:[e.jsxs("div",{className:`text-sm sm:text-lg lg:text-2xl font-bold ${w.category==="income"?"text-green-600":"text-red-600"}`,children:[w.category==="income"?"+":"-",Fa(w.amount)]}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:w.category??"other"}),w.status==="pending"&&w.expectedDate&&e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["Expected: ",w.expectedDate]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 mt-3 sm:mt-4",children:[e.jsxs("button",{onClick:()=>b(w),className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1 sm:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(ks,{size:12,className:"sm:size-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"View Details"}),e.jsx("span",{className:"sm:hidden",children:"View"})]}),w.invoiceId&&e.jsxs("button",{className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1 sm:py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-xs",children:[e.jsx(Ys,{size:12,className:"sm:size-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Download Invoice"}),e.jsx("span",{className:"sm:hidden",children:"Download"})]}),e.jsxs("button",{className:"flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1 sm:py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-xs",children:[e.jsx(Wt,{size:12,className:"sm:size-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Share"}),e.jsx("span",{className:"sm:hidden",children:"Share"})]})]})]})},w.id)),u.length===0&&e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 p-6 sm:p-12 text-center",children:[e.jsx(Ut,{className:"mx-auto text-gray-300 mb-4",size:32}),e.jsx("h3",{className:"text-sm sm:text-lg font-semibold text-gray-900 mb-2",children:"No transactions found"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg sm:rounded-2xl border border-purple-200 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 mb-4 sm:mb-6",children:[e.jsx("div",{className:"p-2 sm:p-3 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg sm:rounded-xl",children:e.jsx(Va,{className:"text-white sm:size-6",size:16})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-xl font-bold text-gray-900",children:"AI Financial Insights"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Smart analysis of your transaction patterns"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2 sm:mb-3",children:[e.jsx(Ot,{className:"text-purple-600 w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-purple-900",children:"Expense Optimization"})]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-1.5 sm:space-x-2",children:[e.jsx(er,{className:"text-purple-600 mt-0.5 flex-shrink-0 w-2.5 h-2.5 sm:w-3 sm:h-3"}),e.jsx("span",{className:"text-xs text-purple-800",children:"Marketing expenses are 12% below industry average - consider increasing for better reach"})]}),e.jsxs("div",{className:"flex items-start space-x-1.5 sm:space-x-2",children:[e.jsx(er,{className:"text-purple-600 mt-0.5 flex-shrink-0 w-2.5 h-2.5 sm:w-3 sm:h-3"}),e.jsx("span",{className:"text-xs text-purple-800",children:"Professional photography ROI is 340% - excellent investment"})]}),e.jsxs("div",{className:"flex items-start space-x-1.5 sm:space-x-2",children:[e.jsx(er,{className:"text-purple-600 mt-0.5 flex-shrink-0 w-2.5 h-2.5 sm:w-3 sm:h-3"}),e.jsx("span",{className:"text-xs text-purple-800",children:"Consider bulk portal subscriptions for 25% cost savings"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2 sm:mb-3",children:[e.jsx(rt,{className:"text-purple-600 w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-purple-900",children:"Revenue Insights"})]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-1.5 sm:space-x-2",children:[e.jsx(zt,{className:"text-purple-600 mt-0.5 flex-shrink-0 w-2.5 h-2.5 sm:w-3 sm:h-3"}),e.jsx("span",{className:"text-xs text-purple-800",children:"Average deal closure time: 28 days (18% faster than market)"})]}),e.jsxs("div",{className:"flex items-start space-x-1.5 sm:space-x-2",children:[e.jsx(zt,{className:"text-purple-600 mt-0.5 flex-shrink-0 w-2.5 h-2.5 sm:w-3 sm:h-3"}),e.jsx("span",{className:"text-xs text-purple-800",children:"Brokerage rate optimization opportunity: +0.5% possible"})]}),e.jsxs("div",{className:"flex items-start space-x-1.5 sm:space-x-2",children:[e.jsx(zt,{className:"text-purple-600 mt-0.5 flex-shrink-0 w-2.5 h-2.5 sm:w-3 sm:h-3"}),e.jsx("span",{className:"text-xs text-purple-800",children:"Q1 revenue projection: â‚¹12.5L based on current pipeline"})]})]})]})]})]}),g&&e.jsx(Xv,{transaction:g,onClose:()=>b(null)})]})},sN=({seller:s})=>{var u;const[a,t]=l.useState("capital_gains"),[r,i]=l.useState({purchasePrice:2e7,purchaseDate:"2020-08-15",salePrice:25e6,saleDate:"2025-01-15",improvementCost:5e5,loanAmount:15e6,interestRate:8.5,remainingTenure:180,prepaymentAmount:2e6,monthlyIncome:15e4,existingEMIs:25e3,loanTenure:240,saleProceeds:25e6,reinvestmentBudget:3e7,targetLocation:"Bandra West",investmentGoal:"capital_appreciation"}),[n,o]=l.useState({capitalGains:{shortTermGains:0,longTermGains:0,taxLiability:0,netProceeds:0,indexationBenefit:0},prepayment:{currentEMI:0,newEMI:0,interestSaved:0,tenureReduction:0},eligibility:{maxLoanAmount:0,maxEMI:0,eligibilityRatio:0},reinvestment:{recommendedProperties:[],expectedReturns:0,riskLevel:"medium"}}),m=[{id:"capital_gains",label:"Capital Gains Tax",icon:Pa,description:"Calculate tax on property sale",color:"green"},{id:"prepayment",label:"Loan Prepayment",icon:en,description:"Analyze prepayment benefits",color:"blue"},{id:"eligibility",label:"Loan Eligibility",icon:bs,description:"Check loan eligibility",color:"purple"},{id:"reinvestment",label:"Reinvestment Analysis",icon:Rs,description:"Property reinvestment options",color:"orange"}];l.useEffect(()=>{g()},[r]);const g=()=>{const c=new Date(r.purchaseDate),N=(new Date(r.saleDate).getTime()-c.getTime())/(1e3*60*60*24*365)>=2,P=r.salePrice-r.purchasePrice-r.improvementCost,w=N?r.purchasePrice*.3:0,k=Math.max(0,P-w)*(N?.2:.3),R=r.salePrice-k,F=r.interestRate/1200,T=r.loanAmount*F*Math.pow(1+F,r.remainingTenure)/(Math.pow(1+F,r.remainingTenure)-1),j=r.loanAmount-r.prepaymentAmount,E=j*F*Math.pow(1+F,r.remainingTenure)/(Math.pow(1+F,r.remainingTenure)-1),V=T*r.remainingTenure-r.loanAmount,W=E*r.remainingTenure-j,B=V-W,A=(r.monthlyIncome-r.existingEMIs)*.6,L=A*(Math.pow(1+F,r.loanTenure)-1)/(F*Math.pow(1+F,r.loanTenure));o({capitalGains:{shortTermGains:N?0:P,longTermGains:N?P:0,taxLiability:Math.round(k),netProceeds:Math.round(R),indexationBenefit:Math.round(w)},prepayment:{currentEMI:Math.round(T),newEMI:Math.round(E),interestSaved:Math.round(B),tenureReduction:0},eligibility:{maxLoanAmount:Math.round(L),maxEMI:Math.round(A),eligibilityRatio:Math.round(r.loanAmount/L*100)},reinvestment:{recommendedProperties:[{title:"Premium 2BHK in Bandra",price:28e6,roi:12},{title:"Luxury 3BHK in Juhu",price:35e6,roi:10}],expectedReturns:11,riskLevel:"medium"}})},b=(c,f)=>{i(p=>({...p,[c]:f}))},d=c=>c>=1e7?`â‚¹${(c/1e7).toFixed(1)}Cr`:c>=1e5?`â‚¹${(c/1e5).toFixed(1)}L`:`â‚¹${c.toLocaleString("en-IN")}`,v=()=>{new Date().toISOString(),alert("Calculation exported successfully!")},x=()=>{var f;const c=`Financial Calculation Results

Calculator: ${(f=m.find(p=>p.id===a))==null?void 0:f.label}

Generated via ResaleExpert
www.resaleexpert.com`;navigator.share?navigator.share({title:"Financial Calculation",text:c}):(navigator.clipboard.writeText(c),alert("Calculation details copied to clipboard!"))};return e.jsxs("div",{className:"space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Financial Calculators"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Advanced financial planning tools with AI-powered suggestions"})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsxs("button",{onClick:v,className:"flex items-center space-x-1 sm:space-x-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:x,className:"flex items-center space-x-1 sm:space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(Wt,{size:14}),e.jsx("span",{children:"Share"})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3 sm:p-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:m.map(c=>{const f=c.icon,p=a===c.id;return e.jsxs("button",{onClick:()=>t(c.id),className:`p-3 rounded-lg border-2 transition-all text-left ${p?`border-${c.color}-500 bg-${c.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(f,{className:p?`text-${c.color}-600`:"text-gray-400",size:16}),e.jsx("span",{className:`font-medium text-xs ${p?`text-${c.color}-900`:"text-gray-600"}`,children:c.label})]}),e.jsx("p",{className:"text-xs text-gray-500",children:c.description})]},c.id)})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-5",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:[(u=m.find(c=>c.id===a))==null?void 0:u.label," Calculator"]}),a==="capital_gains"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Purchase Price (â‚¹)"}),e.jsx("input",{type:"number",value:r.purchasePrice,onChange:c=>b("purchasePrice",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-xs",placeholder:"20000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Purchase Date"}),e.jsx("input",{type:"date",value:r.purchaseDate,onChange:c=>b("purchaseDate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sale Price (â‚¹)"}),e.jsx("input",{type:"number",value:r.salePrice,onChange:c=>b("salePrice",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-xs",placeholder:"25000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sale Date"}),e.jsx("input",{type:"date",value:r.saleDate,onChange:c=>b("saleDate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Improvement Cost (â‚¹)"}),e.jsx("input",{type:"number",value:r.improvementCost,onChange:c=>b("improvementCost",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 text-xs",placeholder:"500000"})]})]}),a==="prepayment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Outstanding Loan Amount (â‚¹)"}),e.jsx("input",{type:"number",value:r.loanAmount,onChange:c=>b("loanAmount",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"15000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Interest Rate (%)"}),e.jsx("input",{type:"number",value:r.interestRate,onChange:c=>b("interestRate",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",step:"0.1",placeholder:"8.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Remaining Tenure (Months)"}),e.jsx("input",{type:"number",value:r.remainingTenure,onChange:c=>b("remainingTenure",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"180"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Prepayment Amount (â‚¹)"}),e.jsx("input",{type:"number",value:r.prepaymentAmount,onChange:c=>b("prepaymentAmount",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"2000000"})]})]}),a==="eligibility"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Monthly Income (â‚¹)"}),e.jsx("input",{type:"number",value:r.monthlyIncome,onChange:c=>b("monthlyIncome",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-xs",placeholder:"150000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Existing EMIs (â‚¹)"}),e.jsx("input",{type:"number",value:r.existingEMIs,onChange:c=>b("existingEMIs",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-xs",placeholder:"25000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Loan Tenure"}),e.jsxs("select",{value:r.loanTenure,onChange:c=>b("loanTenure",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 text-xs",children:[e.jsx("option",{value:120,children:"10 years"}),e.jsx("option",{value:180,children:"15 years"}),e.jsx("option",{value:240,children:"20 years"}),e.jsx("option",{value:300,children:"25 years"}),e.jsx("option",{value:360,children:"30 years"})]})]})]}),a==="reinvestment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sale Proceeds (â‚¹)"}),e.jsx("input",{type:"number",value:r.saleProceeds,onChange:c=>b("saleProceeds",Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-xs",placeholder:"25000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Additional Budget (â‚¹)"}),e.jsx("input",{type:"number",value:r.reinvestmentBudget-r.saleProceeds,onChange:c=>b("reinvestmentBudget",r.saleProceeds+Number(c.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-xs",placeholder:"5000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Target Location"}),e.jsxs("select",{value:r.targetLocation,onChange:c=>b("targetLocation",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-xs",children:[e.jsx("option",{value:"Bandra West",children:"Bandra West"}),e.jsx("option",{value:"Juhu",children:"Juhu"}),e.jsx("option",{value:"Worli",children:"Worli"}),e.jsx("option",{value:"Lower Parel",children:"Lower Parel"}),e.jsx("option",{value:"Powai",children:"Powai"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Investment Goal"}),e.jsxs("select",{value:r.investmentGoal,onChange:c=>b("investmentGoal",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-xs",children:[e.jsx("option",{value:"capital_appreciation",children:"Capital Appreciation"}),e.jsx("option",{value:"rental_income",children:"Rental Income"}),e.jsx("option",{value:"balanced",children:"Balanced Returns"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Calculation Results"}),a==="capital_gains"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 sm:p-4",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-3 text-xs",children:"Tax Calculation Summary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700 text-xs",children:"Capital Gain:"}),e.jsx("span",{className:"font-bold text-green-900 text-xs",children:d(r.salePrice-r.purchasePrice-r.improvementCost)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700 text-xs",children:"Indexation Benefit:"}),e.jsx("span",{className:"font-bold text-green-900 text-xs",children:d(n.capitalGains.indexationBenefit)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700 text-xs",children:"Tax Liability:"}),e.jsx("span",{className:"font-bold text-red-600 text-xs",children:d(n.capitalGains.taxLiability)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-green-700 font-medium text-xs",children:"Net Proceeds:"}),e.jsx("span",{className:"font-bold text-green-900 text-sm",children:d(n.capitalGains.netProceeds)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-3 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Mt,{className:"text-purple-600",size:14}),e.jsx("h4",{className:"font-semibold text-purple-900 text-xs",children:"AI Tax Optimization"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(er,{className:"text-purple-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-purple-800",children:"Consider reinvesting in another property within 2 years to claim exemption under Section 54"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(er,{className:"text-purple-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-purple-800",children:"Invest in Capital Gains Bonds to save up to â‚¹50L in taxes"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(er,{className:"text-purple-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-purple-800",children:"Consult tax advisor for additional deductions and exemptions"})]})]})]})]}),a==="prepayment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 sm:p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3 text-xs",children:"Prepayment Analysis"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 text-xs",children:"Current EMI:"}),e.jsx("span",{className:"font-bold text-blue-900 text-xs",children:d(n.prepayment.currentEMI)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 text-xs",children:"New EMI:"}),e.jsx("span",{className:"font-bold text-blue-900 text-xs",children:d(n.prepayment.newEMI)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700 text-xs",children:"EMI Reduction:"}),e.jsx("span",{className:"font-bold text-green-600 text-xs",children:d(n.prepayment.currentEMI-n.prepayment.newEMI)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-blue-700 font-medium text-xs",children:"Interest Saved:"}),e.jsx("span",{className:"font-bold text-green-900 text-sm",children:d(n.prepayment.interestSaved)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-3 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Mt,{className:"text-blue-600",size:14}),e.jsx("h4",{className:"font-semibold text-blue-900 text-xs",children:"Smart Prepayment Strategy"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(zt,{className:"text-blue-600 mt-0.5",size:10}),e.jsxs("span",{className:"text-xs text-blue-800",children:["Optimal prepayment amount: â‚¹",r.prepaymentAmount.toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(zt,{className:"text-blue-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-blue-800",children:"Best time to prepay: Beginning of financial year for maximum benefit"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(zt,{className:"text-blue-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-blue-800",children:"Consider partial prepayment to maintain liquidity"})]})]})]})]}),a==="eligibility"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 sm:p-4",children:[e.jsx("h4",{className:"font-semibold text-purple-900 mb-3 text-xs",children:"Loan Eligibility"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-700 text-xs",children:"Net Monthly Income:"}),e.jsx("span",{className:"font-bold text-purple-900 text-xs",children:d(r.monthlyIncome-r.existingEMIs)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-700 text-xs",children:"Max EMI (60%):"}),e.jsx("span",{className:"font-bold text-purple-900 text-xs",children:d(n.eligibility.maxEMI)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-purple-700 font-medium text-xs",children:"Max Loan Amount:"}),e.jsx("span",{className:"font-bold text-purple-900 text-sm",children:d(n.eligibility.maxLoanAmount)})]})]})]}),e.jsxs("div",{className:"bg-white border border-purple-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[n.eligibility.eligibilityRatio,"%"]}),e.jsx("div",{className:"text-xs text-purple-700",children:"Eligibility Utilization"})]}),e.jsx("div",{className:"w-full bg-purple-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${n.eligibility.eligibilityRatio<=80?"bg-green-500":n.eligibility.eligibilityRatio<=100?"bg-orange-500":"bg-red-500"}`,style:{width:`${Math.min(n.eligibility.eligibilityRatio,100)}%`}})}),e.jsx("div",{className:"text-xs text-center mt-2 text-purple-700",children:n.eligibility.eligibilityRatio<=80?"Excellent eligibility":n.eligibility.eligibilityRatio<=100?"Good eligibility":"Consider increasing income or reducing existing EMIs"})]})]}),a==="reinvestment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 sm:p-4",children:[e.jsx("h4",{className:"font-semibold text-orange-900 mb-3 text-xs",children:"Reinvestment Analysis"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-orange-700 text-xs",children:"Available Budget:"}),e.jsx("span",{className:"font-bold text-orange-900 text-xs",children:d(r.reinvestmentBudget)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-orange-700 text-xs",children:"Target Location:"}),e.jsx("span",{className:"font-bold text-orange-900 text-xs",children:r.targetLocation})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-orange-700 text-xs",children:"Expected Returns:"}),e.jsxs("span",{className:"font-bold text-green-600 text-xs",children:[n.reinvestment.expectedReturns,"% p.a."]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-lg p-3 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Mt,{className:"text-orange-600",size:14}),e.jsx("h4",{className:"font-semibold text-orange-900 text-xs",children:"AI Property Suggestions"})]}),e.jsx("div",{className:"space-y-2",children:n.reinvestment.recommendedProperties.map((c,f)=>e.jsx("div",{className:"bg-white rounded-lg p-2 border border-orange-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:c.title}),e.jsx("div",{className:"text-xs text-gray-600",children:d(c.price)})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs font-bold text-green-600",children:[c.roi,"% ROI"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Expected"})]})]})},f))})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg",children:e.jsx(Va,{className:"text-white",size:18})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"AI Financial Advisor"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Personalized financial recommendations based on your profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(rt,{className:"text-indigo-600",size:14}),e.jsx("h4",{className:"font-semibold text-indigo-900 text-xs",children:"Investment Strategy"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Xl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Diversify into commercial properties for higher yields"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Xl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Consider REITs for liquid real estate exposure"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Xl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Explore emerging micro-markets for better appreciation"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ct,{className:"text-indigo-600",size:14}),e.jsx("h4",{className:"font-semibold text-indigo-900 text-xs",children:"Tax Optimization"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(vl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Utilize Section 54 exemption for reinvestment"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(vl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Plan sale timing for optimal tax benefits"})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(vl,{className:"text-indigo-600 mt-0.5",size:10}),e.jsx("span",{className:"text-xs text-indigo-800",children:"Maintain proper documentation for all improvements"})]})]})]})]})]})]})},tN=({seller:s})=>{const[a,t]=l.useState("all"),[r,i]=l.useState(""),[n,o]=l.useState(null),[m,g]=l.useState(!1),[b,d]=l.useState(!1),[v,x]=l.useState(!1),[u,c]=l.useState(!1),p=s||{name:"John Doe",phone:"+91 9876543210",email:"john@example.com"},N=[{id:1,title:"Exclusive Mandate Agreement - Skyline Towers",type:"mandate_agreement",template:"Exclusive Mandate Agreement",property:"Skyline Towers, Andheri West",status:"pending_signature",priority:"high",created_date:"2025-01-12",created_by:"Admin User",document_id:"MAN-2025-001",progress:75,next_action:"Digital signature required",tracking_history:[{action:"Document Created",timestamp:"2025-01-12T10:00:00Z",user:"Admin User",status:"completed"},{action:"Sent for Review",timestamp:"2025-01-12T10:30:00Z",user:"Admin User",status:"completed"},{action:"Reviewed by Seller",timestamp:"2025-01-12T14:00:00Z",user:p.name,status:"completed"},{action:"OTP Verification",timestamp:"2025-01-12T14:30:00Z",user:p.name,status:"pending"}],shared_channels:["email","whatsapp"],approval_required:!1,otp_verified:!1,esign_completed:!1,validity_period:"6 months",commission_rate:"2%"},{id:2,title:"Property Sale Agreement - Green Valley Villa",type:"sale_agreement",template:"Property Sale Agreement",property:"Green Valley Villa, Pune",status:"otp_verified",priority:"high",created_date:"2025-01-10",created_by:"Manager User",document_id:"PSA-2025-002",progress:85,next_action:"E-signature pending",tracking_history:[{action:"Document Created",timestamp:"2025-01-10T09:00:00Z",user:"Manager User",status:"completed"},{action:"Shared with Parties",timestamp:"2025-01-10T09:30:00Z",user:"Manager User",status:"completed"},{action:"OTP Verified",timestamp:"2025-01-10T15:00:00Z",user:p.name,status:"completed"},{action:"E-Sign Pending",timestamp:"2025-01-10T15:30:00Z",user:p.name,status:"active"}],shared_channels:["email","whatsapp","sms"],approval_required:!1,otp_verified:!0,esign_completed:!1,sale_amount:"â‚¹4.2Cr",buyer_name:"Confidential"},{id:3,title:"Society NOC Request - Metro Heights",type:"society_noc",template:"Society NOC Request",property:"Metro Heights, Andheri East",status:"completed",priority:"medium",created_date:"2025-01-08",created_by:"Executive User",document_id:"NOC-2025-003",progress:100,next_action:"Document completed",tracking_history:[{action:"Document Created",timestamp:"2025-01-08T11:00:00Z",user:"Executive User",status:"completed"},{action:"Submitted to Society",timestamp:"2025-01-08T14:00:00Z",user:"Executive User",status:"completed"},{action:"Society Approval",timestamp:"2025-01-09T10:00:00Z",user:"Society Secretary",status:"completed"},{action:"NOC Received",timestamp:"2025-01-09T16:00:00Z",user:"Executive User",status:"completed"}],shared_channels:["email"],approval_required:!1,otp_verified:!0,esign_completed:!0,society_name:"Metro Heights Society"},{id:4,title:"Token Receipt - Skyline Towers",type:"token_receipt",template:"Token Receipt",property:"Skyline Towers, Andheri West",status:"shared",priority:"medium",created_date:"2025-01-11",created_by:"Admin User",document_id:"TR-2025-004",progress:60,next_action:"Awaiting buyer confirmation",tracking_history:[{action:"Document Created",timestamp:"2025-01-11T12:00:00Z",user:"Admin User",status:"completed"},{action:"Shared with Buyer",timestamp:"2025-01-11T12:30:00Z",user:"Admin User",status:"completed"},{action:"Buyer Review",timestamp:"2025-01-11T18:00:00Z",user:"Buyer",status:"pending"}],shared_channels:["whatsapp","email"],approval_required:!1,otp_verified:!1,esign_completed:!1,token_amount:"â‚¹5,00,000"},{id:5,title:"Bank NOC Request - All Properties",type:"bank_noc",template:"Bank NOC Request",property:"All Properties",status:"pending_approval",priority:"low",created_date:"2025-01-09",created_by:"Manager User",document_id:"BNOC-2025-005",progress:40,next_action:"Admin approval required",tracking_history:[{action:"Document Created",timestamp:"2025-01-09T14:00:00Z",user:"Manager User",status:"completed"},{action:"Pending Approval",timestamp:"2025-01-09T14:30:00Z",user:"Manager User",status:"active"}],shared_channels:[],approval_required:!0,otp_verified:!1,esign_completed:!1,bank_name:"HDFC Bank"}],P=[{id:"all",label:"All Docs",count:N.length},{id:"pending",label:"Pending",count:N.filter(j=>j.status!=="completed").length},{id:"completed",label:"Done",count:N.filter(j=>j.status==="completed").length},{id:"signatures",label:"Sign",count:N.filter(j=>!j.esign_completed).length}],w=N.filter(j=>{const E=j.title.toLowerCase().includes(r.toLowerCase())||j.property.toLowerCase().includes(r.toLowerCase())||j.document_id.toLowerCase().includes(r.toLowerCase()),V=a==="all"||a==="pending"&&j.status!=="completed"||a==="completed"&&j.status==="completed"||a==="signatures"&&!j.esign_completed;return E&&V}),$=j=>{const E={pending_signature:{bg:"bg-orange-50",text:"text-orange-600",label:"Pending Sign",icon:Ls},otp_verified:{bg:"bg-blue-50",text:"text-blue-600",label:"OTP Done",icon:at},shared:{bg:"bg-purple-50",text:"text-purple-600",label:"Shared",icon:Dt},completed:{bg:"bg-green-50",text:"text-green-600",label:"Complete",icon:bs},pending_approval:{bg:"bg-red-50",text:"text-red-600",label:"Need Approval",icon:ct}},V=E[j]||E.shared,W=V.icon;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${V.bg} ${V.text}`,children:[e.jsx(W,{size:10,className:"mr-1"}),V.label]})},y=j=>{const V={high:{bg:"bg-red-50",text:"text-red-600",label:"High"},medium:{bg:"bg-yellow-50",text:"text-yellow-600",label:"Medium"},low:{bg:"bg-green-50",text:"text-green-600",label:"Low"}}[j];return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${V.bg} ${V.text}`,children:V.label})},k=(j,E)=>{switch(o(E),j){case"view":g(!0);break;case"track":d(!0);break;case"otp":x(!0);break;case"esign":c(!0);break;case"download":const V=window.document.createElement("a");V.href="data:application/pdf;base64,JVBERi0xLjQKJdPr6eEKMSAwIG9iago8PAovVGl0bGUgKERvY3VtZW50KQo+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMyAwIFIKPj4KZW5kb2JqCjMgMCBvYmoKPDwKL1R5cGUgL1BhZ2VzCi9LaWRzIFs0IDAgUl0KL0NvdW50IDEKPD4KZW5kb2JqCjQgMCBvYmoKPDwKL1R5cGUgL1BhZ2UKL1BhcmVudCAzIDAgUgovTWVkaWFCb3ggWzAgMCA2MTIgNzkyXQo+PgplbmRvYmoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDA5IDAwMDAwIG4gCjAwMDAwMDAwNzQgMDAwMDAgbiAKMDAwMDAwMDEyMSAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAyIDAgUgo+PgpzdGFydHhyZWYKMjczCiUlRU9GCg==",V.download=`${E.document_id}.pdf`,V.click();break;case"share":const W=`Document: ${E.title}
Document ID: ${E.document_id}
Status: ${E.status}

View document: https://resaleexpert.com/document/${E.document_id}

ResaleExpert Team`;navigator.clipboard.writeText(W),alert("Document link copied to clipboard!");break}},R=async()=>{if(n)try{await new Promise(E=>setTimeout(E,1e3)),alert(`OTP sent to ${p.phone} for document verification`);const j=prompt("Enter OTP received on your phone:");if(j&&j==="123456"){const E={...n,otp_verified:!0,status:"otp_verified"};alert("OTP verified successfully! Document ready for e-signature."),x(!1)}else j&&alert("Invalid OTP. Please try again.")}catch{alert("OTP verification failed. Please try again.")}},F=async()=>{if(n)try{if(await new Promise(E=>setTimeout(E,2e3)),window.confirm("Proceed with digital signature using Aadhaar OTP?")){const E=prompt("Enter Aadhaar OTP for digital signature:");E&&E==="654321"?(alert("Document signed successfully! Digital signature completed."),c(!1)):E&&alert("Invalid Aadhaar OTP. Please try again.")}}catch{alert("E-signature failed. Please try again.")}},T=async()=>{if(!n)return;window.confirm("Approve this document for processing?")&&alert("Document approved successfully!")};return e.jsxs("div",{className:"space-y-4 sm:space-y-6 px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6 pt-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"Documents"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Manage property documents"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsxs("button",{className:"flex items-center justify-center space-x-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(dt,{size:14}),e.jsx("span",{children:"Upload"})]}),e.jsxs("button",{className:"flex items-center justify-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Create"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Total"}),e.jsx("p",{className:"text-lg font-bold",children:N.length})]}),e.jsx(ws,{size:16,className:"text-blue-200"})]}),e.jsx("div",{className:"text-blue-100 text-xs mt-1",children:"All docs"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-xs",children:"Pending"}),e.jsx("p",{className:"text-lg font-bold",children:N.filter(j=>j.status!=="completed").length})]}),e.jsx(Ls,{size:16,className:"text-orange-200"})]}),e.jsx("div",{className:"text-orange-100 text-xs mt-1",children:"Need action"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"Done"}),e.jsx("p",{className:"text-lg font-bold",children:N.filter(j=>j.status==="completed").length})]}),e.jsx(bs,{size:16,className:"text-green-200"})]}),e.jsx("div",{className:"text-green-100 text-xs mt-1",children:"Completed"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-3 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-xs",children:"This Month"}),e.jsx("p",{className:"text-lg font-bold",children:N.filter(j=>new Date(j.created_date).getMonth()===new Date().getMonth()).length})]}),e.jsx(Rs,{size:16,className:"text-purple-200"})]}),e.jsx("div",{className:"text-purple-100 text-xs mt-1",children:"New docs"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:[e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:r,onChange:j=>i(j.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsxs("button",{className:"flex items-center justify-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(Na,{size:14}),e.jsx("span",{children:"Filters"})]}),e.jsxs("button",{className:"flex items-center justify-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"Export"})]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-2",children:P.map(j=>e.jsxs("button",{onClick:()=>t(j.id),className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors whitespace-nowrap text-xs ${a===j.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"font-medium",children:j.label}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs ${a===j.id?"bg-blue-200":"bg-gray-200"}`,children:j.count})]},j.id))})})]}),e.jsx("div",{className:"space-y-3",children:w.map(j=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg flex-shrink-0",children:e.jsx(ws,{className:"text-blue-600",size:16})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-xs sm:text-sm truncate",children:j.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[$(j.status),y(j.priority)]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 text-xs text-gray-600 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Is,{size:10}),e.jsx("span",{className:"truncate",children:j.property})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{size:10}),e.jsx("span",{children:j.created_date})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ms,{size:10}),e.jsx("span",{className:"truncate",children:j.created_by})]})]}),e.jsxs("div",{className:"text-xs text-gray-700 mb-1",children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",j.document_id]}),e.jsxs("div",{className:"text-xs text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Next:"})," ",j.next_action]})]})]}),e.jsxs("div",{className:"text-center sm:text-right flex-shrink-0",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[j.progress,"%"]}),e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Progress"}),e.jsx("div",{className:"w-16 sm:w-20 bg-gray-200 rounded-full h-2 mx-auto sm:mx-0",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${j.progress}%`}})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3 mt-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Template"}),e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:j.template})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"OTP Status"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[j.otp_verified?e.jsx(bs,{className:"text-green-500",size:12}):e.jsx(Ls,{className:"text-orange-500",size:12}),e.jsx("span",{className:"text-xs font-medium",children:j.otp_verified?"Verified":"Pending"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"E-Sign"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[j.esign_completed?e.jsx(bs,{className:"text-green-500",size:12}):e.jsx(Ls,{className:"text-orange-500",size:12}),e.jsx("span",{className:"text-xs font-medium",children:j.esign_completed?"Done":"Pending"})]})]})]}),j.shared_channels.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-2",children:"Shared Via"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:j.shared_channels.map((E,V)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:E},V))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>k("view",j),className:"flex items-center space-x-1 px-2 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(ks,{size:12}),e.jsx("span",{children:"View"})]}),e.jsxs("button",{onClick:()=>k("track",j),className:"flex items-center space-x-1 px-2 py-1.5 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 transition-colors text-xs",children:[e.jsx(Ot,{size:12}),e.jsx("span",{children:"Track"})]}),j.approval_required&&e.jsxs("button",{onClick:T,className:"flex items-center space-x-1 px-2 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(bs,{size:12}),e.jsx("span",{children:"Approve"})]}),!j.otp_verified&&e.jsxs("button",{onClick:()=>k("otp",j),className:"flex items-center space-x-1 px-2 py-1.5 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-xs",children:[e.jsx(at,{size:12}),e.jsx("span",{children:"OTP"})]}),j.otp_verified&&!j.esign_completed&&e.jsxs("button",{onClick:()=>k("esign",j),className:"flex items-center space-x-1 px-2 py-1.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-xs",children:[e.jsx(Ct,{size:12}),e.jsx("span",{children:"Sign"})]}),e.jsxs("button",{onClick:()=>k("download",j),className:"flex items-center space-x-1 px-2 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:[e.jsx(Ys,{size:12}),e.jsx("span",{children:"Get"})]}),e.jsxs("button",{onClick:()=>k("share",j),className:"flex items-center space-x-1 px-2 py-1.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:[e.jsx(Wt,{size:12}),e.jsx("span",{children:"Share"})]})]})]})},j.id))}),w.length===0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[e.jsx(ws,{className:"mx-auto text-gray-300 mb-4",size:32}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"No documents found"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Try adjusting your search or filter criteria"})]}),m&&n&&e.jsx(aN,{document:n,onClose:()=>{g(!1),o(null)}}),b&&n&&e.jsx(rN,{document:n,onClose:()=>{d(!1),o(null)}}),v&&n&&e.jsx(lN,{document:n,seller:p,onVerify:R,onClose:()=>{x(!1),o(null)}}),u&&n&&e.jsx(nN,{document:n,seller:p,onSign:F,onClose:()=>{c(!1),o(null)}})]})},aN=({document:s,onClose:a})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm sm:text-lg font-semibold text-gray-900 truncate pr-4",children:s.title}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded flex-shrink-0",children:e.jsx(ns,{size:16})})]})}),e.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 min-h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ws,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Document Preview"}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",s.document_id]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",s.template]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Property:"})," ",s.property]})]})]})})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:"Close"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:"Download PDF"})]})})]})}),rN=({document:s,onClose:a})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm sm:text-lg font-semibold text-gray-900",children:"Document Tracking"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(ns,{size:16})})]})}),e.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto",children:e.jsx("div",{className:"space-y-3",children:s.tracking_history.map((t,r)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full flex-shrink-0 ${t.status==="completed"?"bg-green-100":t.status==="active"?"bg-blue-100":"bg-orange-100"}`,children:t.status==="completed"?e.jsx(bs,{className:"text-green-600",size:12}):t.status==="active"?e.jsx(Ls,{className:"text-blue-600",size:12}):e.jsx(ct,{className:"text-orange-600",size:12})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:t.action}),e.jsxs("div",{className:"text-xs text-gray-600",children:["by ",t.user]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleString()})]})]},r))})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx("button",{onClick:a,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:"Close"})})]})}),lN=({document:s,seller:a,onVerify:t,onClose:r})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"OTP Verification"}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(ns,{size:16})})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-full w-12 h-12 mx-auto mb-3",children:e.jsx(at,{className:"text-orange-600",size:24})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Verify Identity"}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"OTP will be sent to your phone"}),e.jsx("p",{className:"text-xs text-gray-500",children:a.phone})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2 text-xs",children:"Document Details"}),e.jsxs("div",{className:"text-xs text-blue-800 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Doc:"})," ",s.title]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",s.document_id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Property:"})," ",s.property]})]})]}),e.jsx("button",{onClick:t,className:"w-full bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 transition-colors font-medium text-xs",children:"Send OTP"})]})]})]})}),nN=({document:s,seller:a,onSign:t,onClose:r})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Digital Signature"}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(ns,{size:16})})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-full w-12 h-12 mx-auto mb-3",children:e.jsx(Ct,{className:"text-purple-600",size:24})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Digital Signature"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Sign document digitally"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-medium text-purple-900 mb-2 text-xs",children:"Signature Details"}),e.jsxs("div",{className:"text-xs text-purple-800 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Signer:"})," ",a.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Document:"})," ",s.document_id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Method:"})," Aadhaar OTP"]})]})]}),e.jsx("div",{className:"bg-yellow-50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(ct,{className:"text-yellow-600 mt-0.5 flex-shrink-0",size:12}),e.jsxs("div",{className:"text-xs text-yellow-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"Important:"}),e.jsxs("ul",{className:"space-y-0.5 list-disc list-inside",children:[e.jsx("li",{children:"Have Aadhaar card ready"}),e.jsx("li",{children:"OTP sent to Aadhaar phone"}),e.jsx("li",{children:"Legally binding signature"})]})]})]})}),e.jsx("button",{onClick:t,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition-colors font-medium text-xs",children:"Proceed with E-Sign"})]})]})]})}),fg=({seller:s,onBack:a,onUpdateSeller:t})=>{var $;const[r,i]=l.useState("dashboard"),[n,o]=l.useState(!1),m=l.useCallback(()=>o(!0),[]),g=l.useCallback(()=>o(!1),[]),b=l.useRef(null);l.useEffect(()=>{const y=k=>k.key==="Escape"&&o(!1);return n&&window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[n]),l.useEffect(()=>{const y=k=>{n&&b.current&&!b.current.contains(k.target)&&o(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[n]);const d=l.useCallback(y=>{i(y),g()},[g]),[v,x]=l.useState([{id:1,type:"property_inquiry",title:"New Property Inquiry",message:"Amit Patel is interested in your Skyline Towers property",timestamp:new Date(Date.now()-300*1e3).toISOString(),read:!1,priority:"high",actionUrl:"/property/PROP001"},{id:2,type:"visit_scheduled",title:"Visit Scheduled",message:"Property visit scheduled for tomorrow at 2:00 PM",timestamp:new Date(Date.now()-900*1e3).toISOString(),read:!1,priority:"medium",actionUrl:"/visits"},{id:3,type:"price_suggestion",title:"AI Price Suggestion",message:"Consider adjusting price by 3% based on market trends",timestamp:new Date(Date.now()-1800*1e3).toISOString(),read:!0,priority:"low",actionUrl:"/analytics"},{id:4,type:"document_ready",title:"Document Ready",message:"Mandate agreement is ready for signature",timestamp:new Date(Date.now()-3600*1e3).toISOString(),read:!1,priority:"high",actionUrl:"/documents"}]),u=l.useMemo(()=>v.filter(y=>!y.read).length,[v]);l.useEffect(()=>{const y=setInterval(()=>{const k={id:Date.now(),type:["property_inquiry","visit_scheduled","price_suggestion","document_ready"][Math.floor(Math.random()*4)],title:"New Activity",message:"You have a new update on your property",timestamp:new Date().toISOString(),read:!1,priority:["high","medium","low"][Math.floor(Math.random()*3)],actionUrl:"/dashboard"};Math.random()>.7&&x(R=>[k,...R].slice(0,10))},3e4);return()=>clearInterval(y)},[]);const c=y=>{x(k=>k.map(R=>R.id===y?{...R,read:!0}:R))},f=()=>{x(y=>y.map(k=>({...k,read:!0})))},p=y=>{x(k=>k.filter(R=>R.id!==y))},N=(s==null?void 0:s.name)||"",P=s!=null&&s.salutation?`${s.salutation} `:"",w=[s==null?void 0:s.location,s==null?void 0:s.city].filter(Boolean).join(", ");return e.jsxs("div",{className:"h-screen w-full bg-gray-50 flex overflow-hidden",children:[e.jsx("aside",{className:"hidden md:block w-68 shrink-0 bg-white border-r sticky top-0 h-screen overflow-y-auto",children:e.jsx(mx,{activeTab:r,onTabChange:i,seller:s,unreadCount:u})}),e.jsxs("div",{className:`fixed inset-0 z-40 md:hidden ${n?"block":"hidden"}`,"aria-hidden":!n,children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[1px] transition-opacity",onClick:g}),e.jsxs("div",{ref:b,className:`absolute left-0 top-0 h-full w-72 max-w-[85vw] bg-white border-r shadow-xl transform transition-transform duration-300 ${n?"translate-x-0":"-translate-x-full"} relative`,role:"dialog","aria-modal":"true","aria-label":"Seller menu",children:[e.jsx("button",{className:"absolute top-2 right-2 p-2 rounded-md hover:bg-gray-100",onClick:g,"aria-label":"Close menu",children:e.jsx(ns,{size:18})}),e.jsx(mx,{activeTab:r,onTabChange:d,seller:s,unreadCount:u})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-r from-purple-500 to-pink-600 px-4 md:px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[e.jsx("button",{onClick:m,className:"p-2 rounded-lg bg-white/90 text-gray-700 hover:bg-white transition-colors md:hidden","aria-label":"Open menu",children:e.jsx(so,{size:20})}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-white/90 text-gray-700 hover:bg-white transition-colors hidden sm:inline-flex","aria-label":"Back",children:e.jsx(ga,{size:20})}),e.jsx("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4",children:e.jsxs("div",{className:"min-w-0 max-w-[70vw] sm:max-w-[60vw] md:max-w-none",children:[e.jsxs("h1",{className:"text-base sm:text-lg md:text-xl font-bold text-white leading-tight truncate",children:["Welcome, ",P,N||"Seller"]}),e.jsx("p",{className:"text-purple-100 text-[10px] sm:text-[11px] md:text-xs leading-snug",children:"Your personalized property selling dashboard"}),e.jsxs("div",{className:"flex  gap-x-2 md:gap-x-3 gap-y-0.5 text-[11px] sm:text-xs md:text-sm text-white/95 mt-1",children:[e.jsx("span",{className:"shrink-0",children:"Seller Account"}),w&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden sm:inline",children:"â€¢"}),e.jsx("span",{className:"truncate max-w-[65vw] sm:max-w-[32ch]",title:w,children:w})]}),e.jsx("span",{className:"hidden sm:inline",children:"â€¢"}),e.jsx("span",{className:`font-medium ${s!=null&&s.is_active?"text-green-300":"text-red-200"}`,children:s!=null&&s.is_active?"Active":"Inactive"})]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 md:space-x-3",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("div",{className:"text-sm font-bold text-white",children:(($=s==null?void 0:s.seller)==null?void 0:$.leadScore)??92}),e.jsx("div",{className:"text-purple-100 text-xs",children:"Profile Score"})]}),e.jsx(Av,{notifications:v,unreadCount:u,onMarkAsRead:c,onMarkAllAsRead:f,onDeleteNotification:p}),e.jsx("button",{className:"p-2 rounded-lg bg-white/90 text-gray-700 hover:bg-white transition-colors","aria-label":"Settings",children:e.jsx(Yt,{size:20})})]})]})}),e.jsxs("main",{className:"flex-1 overflow-y-auto",children:[r==="dashboard"&&e.jsx(iN,{seller:s}),r==="properties"&&e.jsx(oN,{seller:s,onUpdateSeller:t}),r==="activities"&&e.jsx(cN,{seller:s}),r==="visits"&&e.jsx(dN,{seller:s}),r==="analytics"&&e.jsx(mN,{seller:s}),r==="vendors"&&e.jsx(xN,{seller:s}),r==="deals"&&e.jsx(uN,{seller:s}),r==="transactions"&&e.jsx(gN,{seller:s}),r==="calculators"&&e.jsx(hN,{seller:s}),r==="documents"&&e.jsx(pN,{seller:s})]})]})]})},iN=({seller:s})=>{const[a]=l.useState([{id:1,type:"price_optimization",title:"Price Optimization Suggestion",description:"Consider reducing price by 3% to attract more buyers",impact:"High",confidence:85,action:"Adjust pricing strategy"},{id:2,type:"marketing_boost",title:"Marketing Enhancement",description:"Add professional photos to increase inquiry rate by 40%",impact:"Medium",confidence:92,action:"Schedule photoshoot"},{id:3,type:"timing_advice",title:"Market Timing",description:"Current market conditions favor sellers in your area",impact:"High",confidence:78,action:"Accelerate marketing"}]),t=Array.isArray(s==null?void 0:s.properties)?s.properties:[],r=l.useMemo(()=>{const o=t.length;let m=0,g=0,b=0;for(const d of t)m+=Number((d==null?void 0:d.inquiries)??0),g+=Number((d==null?void 0:d.visits)??0),b+=Number((d==null?void 0:d.hotLeads)??(d==null?void 0:d.hot_leads)??0);return{totalProps:o,inquiries:m,visits:g,hotLeads:b}},[t]),i=[{label:"Properties Listed",value:String(r.totalProps),icon:()=>e.jsx("span",{className:"font-semibold",children:"ðŸ "}),color:"blue"},{label:"Total Inquiries",value:String(r.inquiries),icon:Ns,color:"green"},{label:"Site Visits",value:String(r.visits),icon:ks,color:"purple"},{label:"Hot Leads",value:String(r.hotLeads),icon:rt,color:"red"}],n={blue:{bg:"bg-blue-100",text:"text-blue-600"},green:{bg:"bg-green-100",text:"text-green-600"},purple:{bg:"bg-purple-100",text:"text-purple-600"},red:{bg:"bg-red-100",text:"text-red-600"}};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-6",children:i.map((o,m)=>{const g=o.icon,b=n[o.color];return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-600",children:o.label}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold text-gray-900 mt-2",children:o.value})]}),e.jsx("div",{className:`p-2 md:p-3 rounded-xl ${b.bg}`,children:typeof g=="function"?e.jsx(g,{className:b.text,size:22}):e.jsx(g,{className:b.text,size:22})})]})},m)})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg",children:e.jsx(Mt,{className:"text-white",size:18})}),e.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900",children:"AI Recommendations"})]}),e.jsx("button",{className:"text-xs md:text-sm text-purple-600 hover:text-purple-800 font-medium",children:"View All"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:a.map(o=>e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-3 md:p-4 border border-purple-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2 md:mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Va,{className:"text-purple-600",size:14}),e.jsx("span",{className:"text-xs md:text-sm font-medium text-purple-800",children:o.type.replace("_"," ").toUpperCase()})]}),e.jsxs("span",{className:"text-[10px] md:text-xs bg-purple-200 text-purple-800 px-2 py-1 rounded-full",children:[o.confidence,"% confidence"]})]}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-1.5 md:mb-2 text-sm md:text-base",children:o.title}),e.jsx("p",{className:"text-xs md:text-sm text-gray-700 mb-2 md:mb-3",children:o.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`text-[10px] md:text-xs px-2 py-1 rounded-full ${o.impact==="High"?"bg-red-100 text-red-700":o.impact==="Medium"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[o.impact," Impact"]}),e.jsx("button",{className:"text-[10px] md:text-xs bg-purple-600 text-white px-3 py-1 rounded-full hover:bg-purple-700 transition-colors",children:o.action})]})]},o.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-900",children:"Recent Activities"}),e.jsx("button",{className:"text-xs md:text-sm text-blue-600 hover:text-blue-800 font-medium",children:"View All Activities"})]}),e.jsx("div",{className:"space-y-3 md:space-y-4",children:[{id:1,type:"inquiry",title:"New inquiry from Amit Patel",description:"Interested in Skyline Towers property",timestamp:"2 hours ago",priority:"high"},{id:2,type:"visit",title:"Property visit completed",description:"Priya Shah visited Ocean Heights property",timestamp:"5 hours ago",priority:"medium"},{id:3,type:"document",title:"Mandate agreement signed",description:"Digital signature completed for PROP001",timestamp:"1 day ago",priority:"low"}].map(o=>e.jsxs("div",{className:"flex items-start space-x-3 md:space-x-4 p-3 md:p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-lg ${o.type==="inquiry"?"bg-blue-100":o.type==="visit"?"bg-green-100":"bg-purple-100"}`,children:o.type==="inquiry"?e.jsx(Ns,{className:"text-blue-600",size:14}):o.type==="visit"?e.jsx(ks,{className:"text-green-600",size:14}):e.jsx(ws,{className:"text-purple-600",size:14})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm md:text-base",children:o.title}),e.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:o.description}),e.jsx("p",{className:"text-[10px] md:text-xs text-gray-500 mt-1",children:o.timestamp})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] md:text-xs font-medium ${o.priority==="high"?"bg-red-100 text-red-700":o.priority==="medium"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:o.priority})]},o.id))})]})]})},hx=s=>({id:String(s.id??s.property_id??s._id??"-"),address:Zt(s.address),type:Zt(s.type),unitType:Zt(s.unitType??s.unit_type),carpet_area:Number(s.carpet_area??0),builtup_area:Number(s.builtup_area??0),unit_type:Zt(s.unit_type,"-"),price:Number(s.budget??0),status:Zt(s.status,"-"),furnishing:Zt(s.furnishing,"-"),property_subtype_name:Zt(s.property_subtype_name,"-"),location_name:Zt(s.location_name,"-"),stage:Pv(s.stage),stageProgress:Number(s.stage_progress??s.progress??0),visits:Number(s.visits??0),inquiries:Number(s.inquiries??0),hotLeads:Number(s.hotLeads??s.hot_leads??0),photos:Array.isArray(s.photos)?s.photos:[],amenities:Array.isArray(s.amenities)?s.amenities:[],isPublic:!!s.is_public,publicViews:Number(s.public_views??0),lastActivity:s.last_activity??s.updated_at??s.created_at??null,tags:Array.isArray(s.tags)?s.tags:[]}),oN=({seller:s,onUpdateSeller:a})=>{var d;const t=(Array.isArray(s==null?void 0:s.properties)?s.properties:[]).map(hx),[r,i]=l.useState(t),[n,o]=l.useState(!1);l.useEffect(()=>{let v=!0;async function x(){try{const u=await Qt.getAll(),c=new Map;if(u.forEach(f=>c.set(String(f.property_id),Array.isArray(f.tags)?f.tags:[])),!v)return;i(f=>f.map(p=>({...p,tags:c.get(p.id)??p.tags??[]})))}catch(u){console.error("Failed to load property tags:",u)}}return t.length>0&&x(),()=>{v=!1}},[(d=s==null?void 0:s.properties)==null?void 0:d.length]);const m=()=>o(!0),g=()=>o(!1),b=async v=>{const x=hx(v);i(u=>{const c=u.findIndex(f=>f.id===x.id);if(c>=0){const f=[...u];return f[c]={...f[c],...x},f}return[x,...u]});try{const u=await Qt.getById(x.id);i(c=>c.map(f=>f.id===x.id?{...f,tags:Array.isArray(u.tags)?u.tags:[]}:f))}catch(u){console.warn("Tags not found for property",x.id,u)}a==null||a(x),g()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"My Properties"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:m,className:"flex items-center space-x-2 px-3 md:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Property"})]})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:r.length>0?r.map(v=>e.jsx(Vv,{property:v},v.id)):e.jsx("div",{className:"text-sm text-gray-500",children:"No properties found."})})]}),n&&e.jsx(no,{isOpen:n,onClose:g,onSubmit:b,mode:"create"})]})},cN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(Wv,{seller:s})}),dN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(Yv,{seller:s})}),mN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(Gv,{seller:s})}),xN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(Kv,{seller:s})}),uN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(Jv,{seller:s})}),gN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(eN,{seller:s})}),hN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(sN,{seller:s})}),pN=({seller:s})=>e.jsx("div",{className:"p-4 md:p-6",children:e.jsx(tN,{seller:s})}),qa=ad,bN=s=>{var t,r,i,n;const a=(s==null?void 0:s.role)||(s==null?void 0:s.roles)||((t=s==null?void 0:s.raw)==null?void 0:t.role)||((r=s==null?void 0:s.raw)==null?void 0:r.roles)||((i=s==null?void 0:s.user)==null?void 0:i.role)||((n=s==null?void 0:s.user)==null?void 0:n.roles)||"";return Array.isArray(a)?a.join(",").toLowerCase():String(a||"").toLowerCase()},fN=s=>{const a=bN(s);return!!a&&/executive/.test(a)&&!/admin|manager|super/.test(a)},Jo=s=>{if(s==null||String(s).trim()==="")return{display:"",key:""};let a=String(s).trim();if(/e\+\d+$/i.test(a)){const r=Number(a);isNaN(r)||(a=Math.round(r).toString())}a=a.replace(/[^\d+]/g,""),a=a.replace(/^0+/,"");const t=a.replace(/[^\d]/g,"");if(/^\+?91\d{10}$/.test(a)||/^91\d{10}$/.test(a)||/^\d{10}$/.test(t)){const r=t.slice(-10);return{display:`+91${r}`,key:r}}return{display:a.startsWith("+")?a:`+${a}`,key:t}},al=s=>{if(s==null||s==="")return;const a=String(s).replace(/[^\d.-]/g,""),t=Number(a);return Number.isFinite(t)&&!isNaN(t)?t:void 0},yN=s=>{if(s==null||s==="")return;const a=String(s).toLowerCase().trim();if(a==="true"||a==="yes"||a==="1")return!0;if(a==="false"||a==="no"||a==="0")return!1},ya=s=>{if(!(s==null||s===""))return String(s).trim()},Qo=s=>{if(s==null||s==="")return;if(s instanceof Date)return new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())).toISOString().split("T")[0];const a=String(s).trim();if(/^\d+$/.test(a)){const i=Number(a);if(i>25569){const n=(i-25569)*86400*1e3,o=new Date(n);return new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate())).toISOString().split("T")[0]}}const t=new Date(a);if(!isNaN(t.getTime()))return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())).toISOString().split("T")[0];const r=[/(\d{4})-(\d{1,2})-(\d{1,2})/,/(\d{1,2})\/(\d{1,2})\/(\d{4})/,/(\d{1,2})-(\d{1,2})-(\d{4})/];for(const i of r){const n=a.match(i);if(n){let o,m,g;return i===r[0]?[,o,m,g]=n:i===r[1]?[,m,g,o]=n:[,g,m,o]=n,m=m.padStart(2,"0"),g=g.padStart(2,"0"),`${o}-${m}-${g}`}}};function jN({isOpen:s,onClose:a,title:t="Import Summary",duplicates:r,skippedRows:i,updatedRows:n}){if(!s)return null;const o=new Set;[...r.map(g=>g.data),...i.map(g=>g.data),...n.map(g=>g.data)].forEach(g=>{Object.entries(g||{}).forEach(([b,d])=>{d!=null&&String(d).trim()!==""&&o.add(b)})});const m=Array.from(o);return e.jsx(ma,{isOpen:s,onClose:a,title:t,width:"max-w-6xl",children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"text-sm text-gray-700 flex flex-wrap gap-4",children:[e.jsxs("span",{children:["Duplicates: ",e.jsx("span",{className:"font-semibold",children:r.length})]}),e.jsxs("span",{children:["Skipped: ",e.jsx("span",{className:"font-semibold",children:i.length})]}),n.length>0&&e.jsxs("span",{children:["Updated: ",e.jsx("span",{className:"font-semibold",children:n.length})]})]}),r.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-700 mb-2",children:"Duplicates (in file or CRM)"}),e.jsx("div",{className:"max-h-[260px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-purple-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"Duplicate Fields"}),e.jsx("th",{className:"border px-2 py-1",children:"Existing ID"}),e.jsx("th",{className:"border px-2 py-1",children:"Reason"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:r.map((g,b)=>e.jsxs("tr",{className:"hover:bg-purple-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row??null}),e.jsx("td",{className:"border px-2 py-1",children:g.duplicateFields&&g.duplicateFields.length>0?g.duplicateFields.join(", "):null}),e.jsx("td",{className:"border px-2 py-1 text-center",children:g.existingId??null}),e.jsx("td",{className:"border px-2 py-1 text-purple-700",children:g.reason}),m.map(d=>{var v;return e.jsx("td",{className:"border px-2 py-1",children:(v=g.data)!=null&&v[d]&&String(g.data[d]).trim()!==null?g.data[d]:null},d)})]},b))})]})})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-red-700 mb-2",children:"Skipped (non-duplicate issues)"}),e.jsx("div",{className:"max-h-[240px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-red-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"Reason"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:i.map((g,b)=>e.jsxs("tr",{className:"hover:bg-red-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row}),e.jsx("td",{className:"border px-2 py-1 text-red-600",children:e.jsxs("div",{children:[g.reason,g.errors&&g.errors.length>0&&e.jsx("div",{className:"text-xs text-red-500 mt-1",children:g.errors.map((d,v)=>e.jsxs("div",{children:["â€¢ ",d]},v))})]})}),m.map(d=>e.jsx("td",{className:"border px-2 py-1",children:g.data[d]&&String(g.data[d]).trim()!==""?g.data[d]:""},d))]},b))})]})})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:"Updated (existing in CRM)"}),e.jsx("div",{className:"max-h-[240px] overflow-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-xs border-collapse",children:[e.jsx("thead",{className:"bg-green-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-2 py-1",children:"Row"}),e.jsx("th",{className:"border px-2 py-1",children:"ID"}),e.jsx("th",{className:"border px-2 py-1",children:"Note"}),m.map(g=>e.jsx("th",{className:"border px-2 py-1 text-left",children:g},g))]})}),e.jsx("tbody",{children:n.map((g,b)=>e.jsxs("tr",{className:"hover:bg-green-50/30",children:[e.jsx("td",{className:"border px-2 py-1 text-center",children:g.row??null}),e.jsx("td",{className:"border px-2 py-1 text-center",children:g.id??null}),e.jsx("td",{className:"border px-2 py-1 text-green-700",children:g.note||"Updated"}),m.map(d=>{var v;return e.jsx("td",{className:"border px-2 py-1",children:(v=g.data)!=null&&v[d]&&String(g.data[d]).trim()!==""?g.data[d]:""},d)})]},b))})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(ss,{variant:"outline",onClick:a,children:"Close"})})]})})}const vN=()=>{const s=[["salutation","name","phone","whatsapp","email","state","city","location","countryCode","stage","leadType","priority","status","source","notes","seller_dob"],["Mr","Rajesh Kumar","9876543210","9876543210","rajesh.kumar@gmail.com","Maharashtra","Mumbai","Bandra West","IN","New Lead","Seller Lead","High","Active","Website","Interested in selling 2BHK apartment","1985-03-15"]],a=qa.utils.aoa_to_sheet(s);[0,1,2].forEach(i=>{const n=qa.utils.encode_cell({r:0,c:i});a[n]&&(a[n].s={font:{color:{rgb:"FF0000"},bold:!0},alignment:{horizontal:"center",vertical:"center"}})});for(let i=3;i<s[0].length;i++){const n=qa.utils.encode_cell({r:0,c:i});a[n]&&(a[n].s={font:{bold:!0},alignment:{horizontal:"center",vertical:"center"}})}for(let i=1;i<s.length;i++)for(let n=0;n<s[i].length;n++){const o=qa.utils.encode_cell({r:i,c:n});a[o]&&(a[o].s={alignment:{horizontal:"left",vertical:"center"}})}a["!cols"]=[12,20,15,15,25,12,12,16,10,12,12,10,10,12,20,12].map(i=>({width:i}));const r=qa.utils.book_new();qa.utils.book_append_sheet(r,a,"Sellers Template"),qa.writeFile(r,"Sellers_Import_Template.xlsx")};function NN({isOpen:s,onClose:a}){const{user:t}=Hs(),[r,i]=l.useState(null),[n,o]=l.useState(""),[m,g]=l.useState(!1),[b,d]=l.useState(!1),[v,x]=l.useState([]),[u,c]=l.useState([]),[f,p]=l.useState([]),[N,P]=l.useState([]),[w,$]=l.useState(!1),[y,k]=l.useState(!1),[R,F]=l.useState([]),[T,j]=l.useState(!1),[E,V]=l.useState(""),[W,B]=l.useState(new Set),[M,A]=l.useState("none"),L=fN(t),D=l.useRef(null),I=l.useRef(null);l.useEffect(()=>{function re(fe){I.current&&!I.current.contains(fe.target)&&j(!1)}return T&&document.addEventListener("mousedown",re),()=>document.removeEventListener("mousedown",re)},[T]),l.useEffect(()=>{s&&(async()=>{var re;try{k(!0);const fe=Le=>{const je=Le!=null&&Le.salutation?`${Le.salutation} `:"",_e=(Le==null?void 0:Le.first_name)||"",ve=(Le==null?void 0:Le.last_name)||"",Pe=(Le==null?void 0:Le.username)||(Le==null?void 0:Le.email)||"Executive";return`${je}${_e} ${ve}`.trim()||Pe};if(L){const Le=(t==null?void 0:t.id)||(t==null?void 0:t.userId)||(t==null?void 0:t._id)||(t==null?void 0:t.uuid)||((re=t==null?void 0:t.raw)==null?void 0:re.id)||String((t==null?void 0:t.email)||(t==null?void 0:t.username)||"me"),je=fe(t),_e={id:Le,name:je,email:t==null?void 0:t.email,username:t==null?void 0:t.username};F([_e]),B(new Set([Le])),A("selected");return}const G=async Le=>{var je;return(je=Os.getByDeptRole)==null?void 0:je.call(Os,{department:Le,role:"executive",is_active:1,limit:100})};let me;try{me=await G("presales")}catch{me=await G("pre-sales")}const oe=((me==null?void 0:me.items)??(me==null?void 0:me.data)??me??[]).map(Le=>({...Le,id:Le.id??Le.userId??Le._id??Le.uuid??String(Le.email||Le.username||Math.random()),name:fe(Le)})),$e=(Da(t,oe)||[]).map(Le=>{var je;return{id:Le.id,name:Le.name,email:Le.email,username:((je=Le.raw)==null?void 0:je.username)||Le.username}});F($e)}catch(fe){console.error(fe),Z.error("Could not fetch executives")}finally{k(!1)}})()},[s,t,L]);const H=l.useMemo(()=>{if(!E.trim())return R;const re=E.toLowerCase();return R.filter(fe=>String(fe.name||"").toLowerCase().includes(re)||String(fe.email||"").toLowerCase().includes(re)||String(fe.username||"").toLowerCase().includes(re))},[E,R]),h=re=>{B(fe=>{const G=new Set(fe);return G.has(re)?G.delete(re):G.add(re),G})},Y=()=>B(new Set(R.map(re=>re.id))),K=()=>B(new Set),q=re=>/duplicate/i.test(re||""),ne=(re,fe)=>{const G=[],me=(re||"").toLowerCase();return me.includes("phone")&&G.push("phone"),me.includes("email")&&G.push("email"),G.length===0&&((fe["phone*"]||fe.phone||fe.Phone)&&G.push("phone"),(fe.email||fe.Email)&&G.push("email")),Array.from(new Set(G))},le=(re,fe)=>{const G={};Object.keys(re||{}).forEach($e=>{re[$e]!==void 0&&re[$e]!==null&&re[$e]!==""&&(G[String($e).trim().toLowerCase()]=re[$e])});const me={salutation:ya(G.salutation),name:ya(G.name),phone:ya(G.phone),whatsapp:ya(G.whatsapp),email:ya(G.email),state:ya(G.state),city:ya(G.city),location:ya(G.location),countrycode:ya(G.countrycode??G.country),stage:ya(G.stage),leadtype:ya(G.leadtype??G.lead_type),priority:ya(G.priority),status:ya(G.status),source:ya(G.source),notes:ya(G.notes),seller_dob:Qo(G.seller_dob??G.dob),expected_close:Qo(G.expected_close),last_activity:Qo(G.last_activity),lead_score:al(G.lead_score),deal_value:al(G.deal_value),visits:al(G.visits),total_visits:al(G.total_visits),stage_progress:al(G.stage_progress),deal_potential:ya(G.deal_potential),response_rate:al(G.response_rate),avg_response_time:al(G.avg_response_time)},oe=Object.keys(me).reduce(($e,Le)=>(me[Le]!==void 0&&me[Le]!==null&&me[Le]!==""&&($e[Le]=me[Le]),$e),{}),Fe=[];if(oe.salutation||Fe.push("Missing salutation"),oe.name||Fe.push("Missing name"),oe.phone||Fe.push("Missing phone"),oe.phone){const $e=Jo(oe.phone);oe.phone=$e.display}if(oe.whatsapp){const $e=Jo(oe.whatsapp);oe.whatsapp=$e.display}return oe.is_active=oe.is_active!==void 0?yN(oe.is_active):!0,{seller:oe,rowErrors:Fe}},S=re=>{const fe=new Set,G=new Set,me=[],oe=[],Fe=[];return re.forEach(($e,Le)=>{const je=Le+2,{seller:_e,rowErrors:ve}=le($e);if(ve.length>0){oe.push({row:je,reason:`Validation failed: ${ve.join(", ")}`,data:$e,errors:ve});return}const We=Jo(_e.phone).key,pe=(_e.email?String(_e.email):"").toLowerCase();if(We&&fe.has(We)){Fe.push({row:je,reason:"Duplicate in file (phone)",data:$e,duplicateFields:["phone"]});return}if(pe&&G.has(pe)){Fe.push({row:je,reason:"Duplicate in file (email)",data:$e,duplicateFields:["email"]});return}const O=_e.phone.replace(/[^\d+]/g,"");if(!(/^\+91\d{10}$/.test(O)||/^\+\d{10,15}$/.test(O))){oe.push({row:je,reason:`Invalid phone format (${_e.phone})`,data:$e});return}if(pe&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(pe)){oe.push({row:je,reason:"Invalid email format",data:$e});return}me.push(_e),fe.add(We),pe&&G.add(pe)}),{validData:me,nonDuplicateSkipped:oe,localDuplicates:Fe}},C=re=>{var oe;const fe=(Fe,$e)=>({...$e,assigned_to:Fe??"",assigned_executive:Fe??""});if(L){const Fe=(t==null?void 0:t.id)||(t==null?void 0:t.userId)||(t==null?void 0:t._id)||(t==null?void 0:t.uuid)||((oe=t==null?void 0:t.raw)==null?void 0:oe.id)||String((t==null?void 0:t.email)||(t==null?void 0:t.username)||"me");return re.map($e=>fe(Fe,$e))}if(M==="none")return re.map(Fe=>fe("",Fe));const G=Array.from(W);if(G.length===0)return re.map(Fe=>fe("",Fe));const me=G.length;return re.map((Fe,$e)=>fe(G[$e%me],Fe))},J=async re=>{const fe=re.filter(G=>G&&Object.keys(G).length>0&&G.name&&G.phone);if(fe.length===0)throw new Error("Nothing to import after filtering");try{return await st.importSellers(fe)}catch{try{return await st.importSellers({sellers:fe})}catch{try{return await st.importSellers({data:fe})}catch(G){throw G}}}},ue=async(re,fe)=>{var ze,xe,Ee,Ke,Xe,ye,Ce,_;P([]),c([]),p([]),$(!1),x([]);const{validData:G,nonDuplicateSkipped:me,localDuplicates:oe}=S(re);if(G.length===0){c(me),P(oe),p([]);const ae=me.flatMap(ke=>ke.errors??[ke.reason]);x(ae),$(!0),oe.length===0&&Z.error(`No valid sellers found in the ${fe}`);return}const Fe=C(G);let $e;try{$e=await J(Fe)}catch(ae){console.error(ae),Z.error((ae==null?void 0:ae.message)||`Import failed from ${fe}`);return}if(!(($e==null?void 0:$e.success)===!0||($e==null?void 0:$e.ok)===!0||typeof($e==null?void 0:$e.status)=="number"&&$e.status>=200&&$e.status<300||typeof($e==null?void 0:$e.inserted)<"u"||Array.isArray($e==null?void 0:$e.insertedRows))){Z.error(($e==null?void 0:$e.message)||`Import failed from ${fe}`);return}const je=($e==null?void 0:$e.insertedRows)??((ze=$e==null?void 0:$e.data)==null?void 0:ze.insertedRows)??((xe=$e==null?void 0:$e.meta)==null?void 0:xe.insertedRows)??[],_e=($e==null?void 0:$e.inserted)??((Ee=$e==null?void 0:$e.data)==null?void 0:Ee.inserted)??((Ke=$e==null?void 0:$e.meta)==null?void 0:Ke.inserted)??(Array.isArray(je)?je.length:void 0)??Fe.length,ve=($e==null?void 0:$e.skippedRows)??((Xe=$e==null?void 0:$e.data)==null?void 0:Xe.skippedRows)??((ye=$e==null?void 0:$e.meta)==null?void 0:ye.skippedRows)??[],Pe=($e==null?void 0:$e.updatedRows)??((Ce=$e==null?void 0:$e.data)==null?void 0:Ce.updatedRows)??((_=$e==null?void 0:$e.meta)==null?void 0:_.updatedRows)??[],We=[],pe=[];if(Array.isArray(ve))for(const ae of ve){const ke=String((ae==null?void 0:ae.reason)||""),Me=(ae==null?void 0:ae.data)||ae||{};q(ke)?We.push({row:ae==null?void 0:ae.row,reason:ke||"Duplicate in CRM",data:Me,duplicateFields:ne(ke,Me),existingId:(ae==null?void 0:ae.id)||(ae==null?void 0:ae.existingId)}):pe.push({row:(ae==null?void 0:ae.row)??0,reason:ke||"Skipped by server",data:Me})}const O=[...oe,...We],Ie=[...me,...pe];if(P(O),c(Ie),p(Pe||[]),(_e??0)>0&&O.length===0&&Ie.length===0){if(Z.success(`Imported ${_e} seller(s) successfully.`),typeof st.getSellers=="function")try{await st.getSellers()}catch{}se()}else{const ae=[];(_e??0)>0&&ae.push(`${_e} imported`),O.length>0&&ae.push(`${O.length} duplicate`),Ie.length>0&&ae.push(`${Ie.length} skipped`),Z.info(`Import summary: ${ae.join(" â€¢ ")}`);const ke=Ie.flatMap(Me=>Me.errors??[Me.reason]).filter(Boolean);x(ke),$(!0)}},Q=async()=>{if(!r)return Z.error("Please select an Excel/CSV file");if(!L&&M==="selected"&&W.size===0)return Z.error("Please select at least one executive or choose None.");if(!m){g(!0);try{const re=new FileReader;re.onload=async G=>{var me;try{const oe=(me=G.target)==null?void 0:me.result;if(!oe){Z.error("Failed to read file");return}let Fe;if(r.name.toLowerCase().endsWith(".csv")){const _e=typeof oe=="string"?oe:String(oe);Fe=qa.read(_e,{type:"string",raw:!0})}else{const _e=oe;Fe=qa.read(_e,{type:"array",raw:!0})}const Le=Fe.Sheets[Fe.SheetNames[0]];if(!Le){Z.error("No sheet found in file");return}const je=qa.utils.sheet_to_json(Le,{raw:!0,defval:""});if(!je||je.length===0){Z.error("File appears to be empty");return}await ue(je,"file")}catch(oe){console.error(oe),Z.error("Error processing file. Please check the format.")}finally{g(!1)}},r.name.toLowerCase().endsWith(".csv")?re.readAsText(r):re.readAsArrayBuffer(r)}catch(re){console.error(re),Z.error("Error reading file"),g(!1)}}},he=async()=>{if(!n.trim())return Z.error("Please enter a Google Sheet URL");if(!L&&M==="selected"&&W.size===0)return Z.error("Please select at least one executive or choose None.");if(m)return;g(!0);const re=new AbortController;try{const fe=n.match(/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);if(!fe){Z.error("Invalid Google Sheet URL"),g(!1);return}const G=fe[1],me=n.match(/[?&]gid=(\d+)/),oe=me?`&gid=${me[1]}`:"",Fe=`https://docs.google.com/spreadsheets/d/${G}/export?format=csv${oe}`,$e=await fetch(Fe,{signal:re.signal});if(!$e.ok){Z.error($e.status===403?"Sheet is not publicly accessible. Make it 'Anyone with link can view'.":"Failed to access Google Sheet."),g(!1);return}const Le=await $e.text();if(!Le.trim()){Z.error("Google Sheet appears to be empty"),g(!1);return}const je=qa.read(Le,{type:"string",raw:!0}),_e=je.Sheets[je.SheetNames[0]];if(!_e){Z.error("No sheet found in Google Sheet"),g(!1);return}const ve=qa.utils.sheet_to_json(_e,{raw:!0,defval:""});if(!ve||ve.length===0){Z.error("No data found in Google Sheet"),g(!1);return}await ue(ve,"Google Sheet")}catch(fe){(fe==null?void 0:fe.name)!=="AbortError"&&(console.error(fe),Z.error("Error processing Google Sheet"))}finally{g(!1),re.abort()}},se=()=>{i(null),o(""),c([]),p([]),P([]),x([]),$(!1),g(!1),d(!1),a()},ge=()=>{if(m){Z.info("Please wait for import to complete");return}se()},ee=re=>{var me,oe;const fe=((me=re.target.files)==null?void 0:me[0])??null;if(!fe)return;const G=((oe=fe.name.split(".").pop())==null?void 0:oe.toLowerCase())??"";if(!["csv","xlsx","xls"].includes(G)){Z.error("Please upload only Excel (.xlsx, .xls) or CSV files");return}i(fe)},de=re=>{re.preventDefault(),re.stopPropagation(),(re.type==="dragenter"||re.type==="dragover")&&d(!0),re.type==="dragleave"&&d(!1)},U=re=>{var fe;if(re.preventDefault(),re.stopPropagation(),d(!1),re.dataTransfer.files&&re.dataTransfer.files[0]){const G=re.dataTransfer.files[0],me=((fe=G.name.split(".").pop())==null?void 0:fe.toLowerCase())??"";["csv","xlsx","xls"].includes(me)?i(G):Z.error("Please upload only Excel (.xlsx, .xls) or CSV files")}},X=()=>{if(!u.length){Z.info("No skipped rows to export");return}const re=["Row","Errors","Raw Data"],fe=u.map($e=>{const Le=Array.isArray($e.errors)?$e.errors.join(" | "):String($e.errors??$e.reason??""),je=JSON.stringify($e.data??{}).replace(/"/g,'""');return`"${$e.row}","${Le}","${je}"`}),G=[re.join(","),...fe].join(`
`),me=new Blob([`\uFEFF${G}`],{type:"text/csv;charset=utf-8"}),oe=URL.createObjectURL(me),Fe=document.createElement("a");Fe.href=oe,Fe.download=`sellers_import_errors_${new Date().toISOString().slice(0,19).replace(/[-:T]/g,"")}.csv`,document.body.appendChild(Fe),Fe.click(),document.body.removeChild(Fe),URL.revokeObjectURL(oe),Z.success("ðŸ“¤ Error report exported successfully")};return e.jsxs(e.Fragment,{children:[e.jsx(ma,{isOpen:s,onClose:ge,title:"Import Sellers",width:"max-w-5xl",children:e.jsxs("div",{className:"space-y-6 p-2",onClick:re=>re.stopPropagation(),children:[e.jsx("div",{className:"border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center",children:e.jsx(dt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Import Sellers"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Import sellers from Excel files or Google Sheets"})]})]}),e.jsx("button",{onClick:ge,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(ns,{className:"w-5 h-5 text-gray-400 hover:text-gray-600"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Upload File"})]}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200 ${b?"border-blue-400 bg-blue-50":r?"border-green-400 bg-green-50":"border-gray-300 hover:border-gray-400 bg-gray-50"}`,onDragEnter:de,onDragLeave:de,onDragOver:de,onDrop:U,children:[e.jsx("input",{ref:D,type:"file",accept:".csv,.xlsx,.xls",onChange:ee,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),r?e.jsxs("div",{className:"space-y-2 pointer-events-none",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-sm font-medium text-green-700 truncate",children:r.name}),e.jsx("p",{className:"text-xs text-green-600",children:"Click to change file"})]}):e.jsxs("div",{className:"space-y-2 pointer-events-none",children:[e.jsx("div",{className:"w-12 h-12 mx-auto bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Drop file or click to upload"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Excel (.xlsx, .xls) or CSV files"})]})]}),e.jsx(ss,{onClick:Q,disabled:!r||m,className:"mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 text-sm rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):"Import from File"})]}),e.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3.5 h-3.5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Google Sheets"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"https://docs.google.com/spreadsheets/... (supports gid=TAB_ID)",value:n,onChange:re=>o(re.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 mt-0.5 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-xs leading-5 text-blue-700",children:[e.jsx("p",{className:"font-medium mb-1",children:"Make sure your Google Sheet is:"}),e.jsxs("ul",{className:"space-y-0.5",children:[e.jsx("li",{children:"â€¢ Anyone with link can view"}),e.jsx("li",{children:"â€¢ Headers same as template"}),e.jsx("li",{children:"â€¢ Phone numbers are text"}),e.jsxs("li",{children:["â€¢ Optional: add ",e.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"gid="})," in the URL to select a specific tab"]})]})]})]})})]}),e.jsx(ss,{onClick:he,disabled:!n.trim()||m,className:"mt-4 w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 text-sm rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Importing..."]}):"Import from Google Sheet"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Seller Assignment"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${M==="none"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${L?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{type:"radio",className:"accent-blue-600",checked:M==="none",onChange:()=>!L&&A("none"),disabled:L}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"No Assignment"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Sellers will not be assigned to any executive"})]})]}),e.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${M==="selected"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${L?"border-blue-500 bg-blue-50":""}`,children:[e.jsx("input",{type:"radio",className:"accent-blue-600",checked:M==="selected"||L,onChange:()=>A("selected"),disabled:L}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:L?"Assigned to you":"Assign to selected executives"}),e.jsx("p",{className:"text-xs text-gray-500",children:L?"All imported sellers will be assigned to you automatically":"Sellers will be distributed evenly among selected executives"})]})]})]}),!L&&M==="selected"&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"relative",ref:I,children:[e.jsxs("button",{type:"button",onClick:()=>j(re=>!re),className:"w-full flex items-center justify-between rounded-md border border-gray-300 bg-white px-3 py-2 text-sm hover:border-gray-400 transition-colors",children:[e.jsx("span",{className:"truncate",children:W.size>0?`${W.size} executive(s) selected`:"Select executives"}),e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),T&&e.jsxs("div",{className:"absolute z-20 mt-1 w-full rounded-md border border-gray-300 bg-white shadow-lg",children:[e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{type:"text",value:E,onChange:re=>V(re.target.value),placeholder:"Search executive...",className:"w-full border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsx("div",{className:"max-h-56 overflow-auto",children:y?e.jsx("div",{className:"p-3 text-sm text-gray-500 text-center",children:"Loading executives..."}):H.length===0?e.jsx("div",{className:"p-3 text-sm text-gray-500 text-center",children:"No executives found"}):H.map(re=>e.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 text-sm cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"accent-blue-600",checked:W.has(re.id),onChange:()=>h(re.id)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:re.name}),re.email&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:re.email})]})]},re.id))}),H.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-2 border-t bg-gray-50",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ss,{variant:"outline",onClick:Y,className:"px-2 py-1 text-xs h-auto",children:"Select All"}),e.jsx(ss,{variant:"outline",onClick:K,className:"px-2 py-1 text-xs h-auto",children:"Clear"})]}),e.jsx(ss,{variant:"outline",onClick:()=>j(!1),className:"px-2 py-1 text-xs h-auto",children:"Done"})]})]})]}),W.size>0&&e.jsxs("p",{className:"mt-2 text-xs text-gray-600",children:["Sellers will be distributed evenly among ",W.size," selected executive(s) in round-robin fashion."]})]})]}),e.jsx("div",{className:"p-4 border rounded-lg bg-amber-50 border-amber-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ct,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-amber-800 mb-2",children:"Required Fields & Validation Rules"}),e.jsxs("div",{className:"text-xs text-amber-700 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Mandatory fields (marked with *):"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium",children:"Salutation*"}),e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium",children:"Name*"}),e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium",children:"Phone*"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{children:"â€¢ Email, WhatsApp are optional but recommended"}),e.jsx("p",{children:"â€¢ Phone numbers should be in valid format (+91XXXXXXXXXX)"}),e.jsx("p",{children:"â€¢ Dates should be in YYYY-MM-DD format"}),e.jsx("p",{children:"â€¢ Numeric fields (deal_value, lead_score, etc.) should contain only numbers"}),e.jsx("p",{children:"â€¢ Intra-file duplicate phone/emails will be skipped"}),e.jsx("p",{children:'â€¢ CRM duplicates are shown as "Duplicate in CRM"'})]})]})]})]})})]})]}),v.length>0&&e.jsx("div",{className:"bg-red-50 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ct,{className:"text-red-600 mt-0.5 flex-shrink-0",size:20}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-red-900",children:"Validation Errors"}),u.length>0&&e.jsxs("button",{onClick:X,className:"flex items-center gap-2 text-xs px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700 transition-colors flex-shrink-0",children:[e.jsx(yu,{size:14}),"Export Skipped"]})]}),e.jsxs("ul",{className:"text-sm text-red-700 space-y-1 max-h-40 overflow-auto",children:[v.slice(0,10).map((re,fe)=>e.jsxs("li",{className:"break-words",children:["â€¢ ",re]},fe)),v.length>10&&e.jsxs("li",{className:"text-red-600 font-medium",children:["... and ",v.length-10," more errors"]})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t",children:[e.jsx(ss,{onClick:vN,className:"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-medium py-3 rounded-lg transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Ys,{className:"w-5 h-5"}),"Download Template"]})}),e.jsx(ss,{variant:"outline",onClick:ge,className:"flex-1 sm:flex-none border-2 border-gray-300 hover:border-gray-400 text-gray-700 font-medium py-3 px-8 rounded-lg transition-colors",children:"Cancel"})]})]})}),e.jsx(jN,{isOpen:w,onClose:()=>$(!1),duplicates:N,skippedRows:u,updatedRows:f})]})}const wN=({isOpen:s,onClose:a,filters:t,setFilters:r,resetFilters:i,sources:n,stages:o,priorities:m,assignedUsers:g,statuses:b})=>{if(typeof window>"u")return null;l.useEffect(()=>{if(!s)return;const x=u=>{u.key==="Escape"&&a()};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[s,a]),l.useEffect(()=>{if(!s)return;const x=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=x}},[s]),l.useEffect(()=>{t!=null&&t.ignoreDate&&(t.dateFrom||t.dateTo)&&r(x=>({...x,dateFrom:"",dateTo:""}))},[t==null?void 0:t.ignoreDate,r,t==null?void 0:t.dateFrom,t==null?void 0:t.dateTo]);const d=(x,u)=>r(c=>({...c,[x]:u})),v=()=>{a()};return Il.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:a,"aria-hidden":!s,className:`fixed inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-200 ${s?"opacity-100 pointer-events-auto z-40":"opacity-0 pointer-events-none"}`}),e.jsxs("aside",{role:"dialog","aria-modal":"true","aria-labelledby":"seller-filter-title",className:`fixed top-0 right-0 h-full w-full sm:w-[380px] bg-gradient-to-b from-indigo-50 via-white to-purple-50 shadow-2xl transform transition-transform duration-300 ease-out z-50
          ${s?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-indigo-500 to-purple-500 text-white",children:[e.jsx("h3",{id:"seller-filter-title",className:"text-sm font-semibold tracking-wide",children:"Filters"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>i(),className:"text-xs bg-white/20 px-2 py-1 rounded hover:bg-white/30",children:"Reset"}),e.jsx("button",{onClick:a,"aria-label":"Close filters",className:"p-1 rounded-full bg-white/20 hover:bg-white/30 transition",children:e.jsx(ns,{size:18})})]})]}),e.jsxs("div",{className:"p-4 overflow-y-auto h-[calc(100%-56px)] text-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Source"}),e.jsx("select",{value:t.source,onChange:x=>d("source",x.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:n.map(x=>e.jsx("option",{value:x,children:x==="all"?"All":x},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Stage"}),e.jsx("select",{value:t.stage,onChange:x=>d("stage",x.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:o.map(x=>e.jsx("option",{value:x,children:x==="all"?"All":x.replace("_"," ").replace(/\b\w/g,u=>u.toUpperCase())},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("select",{value:t.priority,onChange:x=>d("priority",x.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:m.map(x=>e.jsx("option",{value:x,children:x==="all"?"All":x.charAt(0).toUpperCase()+x.slice(1)},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Assigned"}),e.jsx("select",{value:t.assigned,onChange:x=>d("assigned",x.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:g.map(x=>e.jsx("option",{value:x,children:x==="all"?"All":x},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{value:t.status,onChange:x=>d("status",x.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs",children:b.map(x=>e.jsx("option",{value:x,children:x==="all"?"All":x.charAt(0).toUpperCase()+x.slice(1)},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:t.dateFrom,onChange:x=>d("dateFrom",x.target.value),disabled:t.ignoreDate,className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:t.dateTo,onChange:x=>d("dateTo",x.target.value),disabled:t.ignoreDate,className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!t.ignoreDate,onChange:x=>d("ignoreDate",x.target.checked),className:"h-4 w-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Ignore Date"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>i(),className:"px-3 py-1 text-xs text-gray-600 hover:text-gray-800","aria-label":"Reset filters",children:"Reset"}),e.jsx("button",{onClick:v,className:"px-3 py-1 bg-purple-600 text-white rounded text-xs hover:bg-purple-700","aria-label":"Apply filters",children:"Apply"})]})]})]})]})]}),document.body)},Aa=(s,a="-")=>s==null||typeof s=="string"&&s.trim()===""?a:s,Zo=s=>{if(!s)return"-";try{const a=new Date(s);return Number.isNaN(a.getTime())?"-":a.toISOString().slice(0,10)}catch{return"-"}},px=s=>{if(Array.isArray(s))return s;if(typeof s=="string")try{const a=JSON.parse(s);return Array.isArray(a)?a:[]}catch{return[]}return[]},Cn=(...s)=>{for(const a of s){const t=px(a);if(t.length)return t}return px(s[0])},bx=s=>s?s.toLowerCase().replace(/\s+/g,"_"):"initial_contact",Xo=s=>{var a,t,r,i,n,o;return{id:Number(s.id??s.seller_id??s._id),salutation:Aa(s.salutation,"Mr."),name:Aa(s.name,"-"),phone:Aa(s.phone,"-"),whatsapp:Aa(s.whatsapp,"-"),email:Aa(s.email,"-"),state:Aa(s.state,"-"),city:Aa(s.city,"-"),location:Aa(s.location,"-"),source:Aa(s.source,"-"),leadType:Aa(s.leadType,"-"),priority:(s.priority||"-").toString().toLowerCase(),stage:bx(s.stage||s.current_stage),status:Aa(s.status,"-"),assigned:Aa(s.assigned_to_name,"-"),assigned_to:Number(s.assigned_to||0),assigned_to_name:Aa(s.assigned_to_name,"-"),assigned_to_email:s.assigned_to_email||null,assigned_to_phone:s.assigned_to_phone||null,leadScore:Number(s.lead_score||0),dealValue:Number(s.deal_value||0),expectedClose:s.expected_close||null,properties:Cn(s.properties,s.props,s.property_list),coSellers:Cn(s.coSellers,s.cosellers),activities:Cn(s.activities,(a=s.metrics)==null?void 0:a.activities),followups:Cn(s.followups,(t=s.metrics)==null?void 0:t.followups),documents:Cn(s.documents,(r=s.metrics)==null?void 0:r.documents),visits:Number(s.visits||0),totalVisits:Number(s.total_visits||0),lastActivity:s.last_activity||((i=s.metrics)==null?void 0:i.last_activity_date)||((o=(n=s.activities)==null?void 0:n[0])==null?void 0:o.created_at)||null,created_at:s.created_at||null,notifications:Number(s.notifications||0),currentStage:bx(s.current_stage||s.stage),stageProgress:Number(s.stage_progress||0),dealPotential:Aa(s.deal_potential,"-"),responseRate:Number(s.response_rate||0),avgResponseTime:s.avg_response_time||null,isActive:!!s.is_active,notes:s.notes||"",seller_dob:s.seller_dob||""}},fx=(s,a)=>{for(const t of a)if(s[t]&&Array.isArray(s[t]))return s[t];return[]},Fn={id:0,name:"Not assigned",email:"",phone:""},_N=(s,a,t=!1)=>{if(!s||!a||a.length===0)return[];const r=(s.role||"").toLowerCase(),i=(s.department||"").toLowerCase(),n=String(s.id||""),o=r.includes("admin")||r.includes("manager"),m=r.includes("superadmin")||r.includes("owner");return o||m?a:r.includes("executive")||i.includes("sales")||i.includes("presales")?a.filter(b=>String(b.assigned_to||"")===n):[]},ji=(s,a)=>{if(!s)return!1;const t=(s.role||"").toLowerCase(),r=String(s.id||"");return t.includes("admin")||t.includes("manager")||t.includes("superadmin")?!0:t.includes("executive")?String(a.assigned_to||"")===r:!1},ec=(s,a)=>{if(!s)return!1;const t=(s.role||"").toLowerCase(),r=String(s.id||"");return t.includes("admin")||t.includes("manager")||t.includes("superadmin")?!0:t.includes("executive")?String(a.assigned_to||"")===r:!1},sc=(s,a)=>{if(!s)return!1;const t=(s.role||"").toLowerCase(),r=String(s.id||"");return t.includes("admin")||t.includes("manager")||t.includes("superadmin")?!0:t.includes("executive")?String(a.assigned_to||"")===r:!1},SN=(s,a)=>{var n;if(!s)return a;if(console.log("=== getAssignableExecutives DEBUG ==="),console.log("Current User Role:",s==null?void 0:s.role),console.log("Current User ID:",s==null?void 0:s.id),console.log("Available Executives:",a),!a||a.length===0)return[];const t=[Fn];if(s.role==="admin"||s.role==="superadmin")return console.log("Admin user - returning all executives"),[Fn,...a.filter(o=>o.id!==0)];if(s.role==="manager"){const o=a.filter(m=>m.department===s.department&&m.id!==0);return console.log("Manager user - returning department executives:",o),[Fn,...o]}const r=(n=s.id)==null?void 0:n.toString(),i=a.find(o=>{var m,g,b;return((m=o.id)==null?void 0:m.toString())===r||((g=o.userId)==null?void 0:g.toString())===r||((b=o._id)==null?void 0:b.toString())===r});return console.log("Executive user - self found:",i),i&&i.id!==0&&t.push(i),console.log("Final executives for executive:",t),t},kN=()=>{const s=Ca(),{user:a}=Hs(),t=Ws(a,"seller.read"),r=Ws(a,"seller.create"),i=Ws(a,"seller.update"),n=Ws(a,"seller.delete"),o=Ws(a,"data.import"),m=Ws(a,"data.export"),g=Ws(a,"seller.assign"),b=Ws(a,"seller.bulk_delete"),d=i||n||g,v=t&&(d||!0);if(!t)return e.jsx("div",{className:"h-full flex flex-col bg-gray-50",children:e.jsx("div",{className:"flex-1 grid place-items-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("div",{className:"text-gray-600 text-sm",children:"You do not have permission to view sellers."})]})})});const[x,u]=l.useState("all"),[c,f]=l.useState(""),[p,N]=l.useState([]),[P,w]=l.useState(!1),[$,y]=l.useState(null),[k,R]=l.useState(null),[F,T]=l.useState(!1),[j,E]=l.useState(!1),[V,W]=l.useState(null),[B,M]=l.useState(0),[A,L]=l.useState(1),[D,I]=l.useState(25),[H,h]=l.useState([]),[Y,K]=l.useState([]),[q,ne]=l.useState(!0),[le,S]=l.useState(null),[C,J]=l.useState(!1),[ue,Q]=l.useState([Fn]),[he,se]=l.useState(!1),[ge,ee]=l.useState(!0),[de,U]=l.useState({}),[X,re]=l.useState({dateFrom:"",dateTo:"",ignoreDate:!1,source:"all",stage:"all",priority:"all",leadType:"all",assigned:"all",status:"all"});l.useEffect(()=>{(async()=>{try{ee(!0);const Ge=await Gt(["seller","lead"]);U(Ge)}catch(Ge){console.error("Error fetching master options:",Ge),Z.error("Failed to load dropdown options")}finally{ee(!1)}})()},[]),l.useEffect(()=>{(async()=>{try{ne(!0);const Ge=await st.getAll(),z=Array.isArray(Ge)?Ge.map(Xo):[];h(z)}catch(Ge){console.error("Error fetching sellers:",Ge),h([]),S("Failed to load sellers")}finally{ne(!1)}})()},[]),l.useEffect(()=>{if(H.length>0&&a){const Se=_N(a,H);K(Se)}else K([])},[H,a]),l.useEffect(()=>{(async()=>{try{se(!0),console.log("ðŸ”„ Loading executives for sellers...");const Ge=Te=>{const qe=Te!=null&&Te.salutation?`${Te.salutation} `:"",as=(Te==null?void 0:Te.first_name)||(Te==null?void 0:Te.firstName)||"",xs=(Te==null?void 0:Te.last_name)||(Te==null?void 0:Te.lastName)||"",ps=`${qe}${as} ${xs}`.trim();return ps||(Te!=null&&Te.name?Te.name:Te!=null&&Te.full_name?Te.full_name:Te!=null&&Te.username?Te.username:Te!=null&&Te.email?Te.email.split("@")[0]:"Sales Executive")};let z=[];try{if(Os.getSalesExecutives){const Te=await Os.getSalesExecutives();Te&&(Array.isArray(Te)||Te.items||Te.data)&&(z=Array.isArray(Te)?Te:Te.items||Te.data||[],console.log("âœ… Found via getSalesExecutives:",z.length))}}catch{console.log("getSalesExecutives failed, trying next method...")}if(z.length===0&&Os.getByDeptRole){const Te=[{department:"Sales",role:"Sales Executive"},{department:"sales",role:"sales executive"},{department:"Sales",role:"Executive"},{department:"sales",role:"executive"}];for(const qe of Te)try{const as=await Os.getByDeptRole({...qe,is_active:1,limit:100});if(as&&(Array.isArray(as)||as.items||as.data)){const xs=Array.isArray(as)?as:as.items||as.data||[];if(xs.length>0){z=xs,console.log(`âœ… Found via getByDeptRole (${qe.department}/${qe.role}):`,xs.length);break}}}catch{continue}}if(z.length===0&&Os.getAll)try{const Te=await Os.getAll({is_active:!0}),qe=Array.isArray(Te)?Te:(Te==null?void 0:Te.items)||(Te==null?void 0:Te.data)||[];qe.length>0&&(z=qe.filter(as=>{const xs=String(as.department||"").toLowerCase(),ps=String(as.role||"").toLowerCase();return(xs.includes("sales")||ps.includes("sales"))&&(ps.includes("executive")||ps.includes("sales"))}),console.log("âœ… Found via getAll + filter:",z.length))}catch{console.log("getAll failed")}if(z.length===0&&Os.getUsers)try{const Te=await Os.getUsers(),qe=Array.isArray(Te)?Te:(Te==null?void 0:Te.items)||(Te==null?void 0:Te.data)||[];qe.length>0&&(z=qe.filter(as=>{const xs=String(as.department||"").toLowerCase(),ps=String(as.role||"").toLowerCase();return(xs.includes("sales")||ps.includes("sales"))&&(ps.includes("executive")||ps.includes("sales"))}),console.log("âœ… Found via getUsers:",z.length))}catch{console.log("getUsers failed")}const ce=z.map(Te=>{const qe=Te.id||Te.userId||Te._id||Te.uuid||`exec-${Date.now()}-${Math.random()}`;return{id:Number(qe)||0,name:Ge(Te),email:Te.email||null,phone:Te.phone||Te.mobile||Te.contact_number||null,username:Te.username||null,department:Te.department||"Sales",role:Te.role||"Sales Executive"}}).filter((Te,qe,as)=>qe===as.findIndex(xs=>String(xs.id)===String(Te.id)&&xs.id!==0));console.log("ðŸ“Š Processed executives:",ce);const Re=SN(a,ce);console.log("ðŸ‘¤ Allowed executives after permission check:",Re),Q(Re),Re.length<=1&&console.warn("âš ï¸ No sales executives found in the system")}catch(Ge){console.error("âŒ Error loading executives:",Ge),Q([Fn]),["executive","sales"].includes(a==null?void 0:a.role)||Z.error("Failed to load sales executives")}finally{se(!1)}})()},[a]);const fe=Se=>((Se==null?void 0:Se.label)??(Se==null?void 0:Se.name)??(Se==null?void 0:Se.title)??(Se==null?void 0:Se.value)??(Se==null?void 0:Se.key)??"").toString(),G=Se=>((Se==null?void 0:Se.value)??(Se==null?void 0:Se.key)??(Se==null?void 0:Se.code)??(Se==null?void 0:Se.name)??"").toString(),me=fx(de,["seller lead stage"]),oe=fx(de,["lead_priority","lead priority"]),Fe=me.map(Se=>({value:G(Se),label:fe(Se)})).filter(Se=>Se.value),$e=oe.map(Se=>({value:G(Se).toLowerCase(),label:fe(Se)})).filter(Se=>Se.value),Le=["all",...Fe.map(Se=>Se.value)],je=["all",...$e.map(Se=>Se.value)],_e=async Se=>{if(p.length===0){Z.info("Please select sellers to assign");return}if(!g){Z.error("You do not have permission to assign executives");return}if(a&&["executive","sales"].includes(a.role)&&Se!==0&&Se!==a.id){Z.error("You can only assign to yourself");return}try{const Ge=p.map(te=>String(te));if(Se===0){try{await st.bulkUpdateLeadField(Ge,"assigned_to",null)}catch{await st.bulkAssignExecutive(Ge,null)}h(te=>te.map(ce=>p.includes(ce.id)?{...ce,assigned_to:0,assigned_to_name:"Unassigned",assigned_to_email:void 0,assigned_to_phone:void 0,assigned:"Unassigned"}:ce)),N([]),Z.success(`Unassigned ${Ge.length} seller(s) successfully`);return}await st.bulkAssignExecutive(Ge,Se);const z=ue.find(te=>te.id===Se);h(te=>te.map(ce=>p.includes(ce.id)?{...ce,assigned_to:Se,assigned_to_name:(z==null?void 0:z.name)||"Executive",assigned_to_email:z==null?void 0:z.email,assigned_to_phone:z==null?void 0:z.phone,assigned:(z==null?void 0:z.name)||"Executive"}:ce)),N([]),Z.success(`Assigned ${Ge.length} seller(s) successfully`)}catch(Ge){console.error("Error bulk assigning:",Ge),Z.error("Failed to assign sellers")}},ve=async Se=>{if(p.length===0){Z.info("Please select sellers to update status");return}if(!i){Z.error("You do not have permission to update sellers");return}try{const Ge=p.map(z=>String(z));await st.bulkUpdateLeadField(Ge,"is_active",Se==="active"?1:0),h(z=>z.map(te=>p.includes(te.id)?{...te,isActive:Se==="active"}:te)),N([]),Z.success(`Status updated for ${p.length} seller(s)`)}catch(Ge){console.error("Error bulk updating status:",Ge),Z.error("Failed to update status")}},Pe=async Se=>{if(p.length===0){Z.info("Please select sellers to update stage");return}if(!i){Z.error("You do not have permission to update sellers");return}try{const Ge=p.map(z=>String(z));await st.bulkUpdateLeadField(Ge,"stage",Se),h(z=>z.map(te=>p.includes(te.id)?{...te,stage:Se,currentStage:Se}:te)),N([]),Z.success(`Stage updated for ${p.length} seller(s)`)}catch(Ge){console.error("Error bulk updating stage:",Ge),Z.error("Failed to update stage")}},We=async Se=>{if(p.length===0){Z.info("Please select sellers to update priority");return}if(!i){Z.error("You do not have permission to update sellers");return}try{const Ge=p.map(z=>String(z));await st.bulkUpdateLeadField(Ge,"priority",Se),h(z=>z.map(te=>p.includes(te.id)?{...te,priority:Se}:te)),N([]),Z.success(`Priority updated for ${p.length} seller(s)`)}catch(Ge){console.error("Error bulk updating priority:",Ge),Z.error("Failed to update priority")}},pe=async()=>{if(p.length===0){Z.info("âš ï¸ No sellers selected for deletion.");return}if(!b){Z.error("You do not have permission to delete sellers");return}const Ge=H.filter(te=>p.includes(te.id)).filter(te=>!sc(a,te));if(Ge.length>0){Z.error(`You do not have permission to delete ${Ge.length} seller(s)`);return}const z=p.map(te=>String(te));Z(({closeToast:te})=>e.jsxs("div",{className:"flex flex-col items-center text-center space-y-3 p-3",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Do you want to delete ",e.jsx("b",{children:z.length})," selected seller(s)?"]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{className:"px-4 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700",onClick:async()=>{const ce=H;try{J(!0),h(Re=>Re.filter(Te=>!z.includes(String(Te.id)))),N([]),await st.bulkDelete(z),Z.success(`ðŸ—‘ï¸ ${z.length} seller(s) deleted successfully.`)}catch(Re){console.error("Error bulk deleting sellers:",Re),h(ce),Z.error("âŒ Failed to delete sellers. Try again.")}finally{J(!1),te==null||te()}},children:"âœ… Yes, Delete"}),e.jsx("button",{className:"px-4 py-1 bg-gray-300 text-gray-800 rounded text-xs hover:bg-gray-400",onClick:te,children:"âŒ Cancel"})]})]}),{autoClose:!1,closeOnClick:!1,draggable:!1,position:"top-center"})},O=()=>{const Se=H.filter(Te=>p.includes(Te.id)).map(Te=>({id:Te.id,name:`${Te.salutation} ${Te.name}`.trim(),phone:Te.phone,whatsapp:Te.whatsapp,email:Te.email,state:Te.state,city:Te.city,location:Te.location,source:Te.source,priority:Te.priority,leadType:Te.leadType,stage:Te.stage,status:Te.status,assigned:Te.assigned,assigned_to:Te.assigned_to,assigned_to_name:Te.assigned_to_name,assigned_to_email:Te.assigned_to_email,assigned_to_phone:Te.assigned_to_phone,leadScore:Te.leadScore,dealValue:Te.dealValue,created_at:Te.created_at??""}));if(Se.length===0){Z.info("No sellers selected to export.");return}const Ge=Object.keys(Se[0]??{id:"",name:"",phone:""}),z=[Ge.join(","),...Se.map(Te=>Ge.map(qe=>`"${String(Te[qe]??"").replace(/"/g,'""')}"`).join(","))].join(`
`),te=new Blob([z],{type:"text/csv;charset=utf-8;"}),ce=URL.createObjectURL(te),Re=document.createElement("a");Re.href=ce,Re.download=`sellers_selected_${p.length}.csv`,Re.click(),Re.remove(),URL.revokeObjectURL(ce),Z.success("Exported CSV successfully")},Ie=()=>{if(ye.length===0){Z.info("No sellers to export based on current filters.");return}const Se=ye.map(Te=>({id:Te.id,name:`${Te.salutation} ${Te.name}`.trim(),phone:Te.phone,email:Te.email,location:Te.location,source:Te.source,priority:Te.priority,stage:Te.stage,status:Te.status,assigned:Te.assigned,assigned_to:Te.assigned_to,assigned_to_name:Te.assigned_to_name,assigned_to_email:Te.assigned_to_email,assigned_to_phone:Te.assigned_to_phone,created_at:Te.created_at??""})),Ge=Object.keys(Se[0]),z=[Ge.join(","),...Se.map(Te=>Ge.map(qe=>`"${String(Te[qe]??"").replace(/"/g,'""')}"`).join(","))].join(`
`),te=new Blob([z],{type:"text/csv;charset=utf-8;"}),ce=URL.createObjectURL(te),Re=document.createElement("a");Re.href=ce,Re.download="filtered_sellers.csv",Re.click(),Re.remove(),URL.revokeObjectURL(ce),Z.success("Exported CSV successfully")},ze=()=>N([]),xe=l.useMemo(()=>{const Se=Ge=>Y.filter(Ge).length;return[{id:"all",label:"All",count:Y.length,color:"blue"},{id:"leads",label:"Fresh Leads",count:Se(Ge=>Ge.stage==="initial_contact"),color:"purple"},{id:"active",label:"Active",count:Se(Ge=>Ge.isActive),color:"green"},{id:"mandate",label:"Mandate Signed",count:Se(Ge=>Ge.stage==="mandate_signed"),color:"orange"},{id:"selling",label:"In Selling",count:Se(Ge=>Ge.stage==="selling_process"),color:"indigo"},{id:"hot",label:"Hot Deals",count:Se(Ge=>Ge.priority==="high"&&Ge.stage==="deal_negotiation"),color:"red"}]},[Y]),Ee=l.useMemo(()=>{const Se=new Set(["all"]);return Y.forEach(Ge=>Ge.source&&Se.add(Ge.source)),Array.from(Se)},[Y]),Ke=["all","active","inactive"],Xe=l.useMemo(()=>{const Se=new Set(["all","Unassigned"]);return Y.forEach(Ge=>Ge.assigned&&Se.add(Ge.assigned)),Array.from(Se)},[Y]),ye=l.useMemo(()=>{const Se=c.toLowerCase();return Y.filter(Ge=>{const z=(Ge.name||"").toLowerCase().includes(Se)||(Ge.phone||"").toLowerCase().includes(Se)||(Ge.email||"").toLowerCase().includes(Se)||(Ge.location||"").toLowerCase().includes(Se),te=typeof Ge.isActive=="number"?Ge.isActive===1:!!Ge.isActive,ce=x==="all"||x==="leads"&&Ge.stage==="initial_contact"||x==="active"&&(te||(Ge.status||"").toLowerCase()==="active")||x==="mandate"&&Ge.stage==="mandate_signed"||x==="selling"&&Ge.stage==="selling_process"||x==="hot"&&Ge.priority==="high"&&Ge.stage==="deal_negotiation",Re=(X.source==="all"||Ge.source===X.source)&&(X.stage==="all"||Ge.stage===X.stage)&&(X.priority==="all"||Ge.priority===X.priority)&&(X.assigned==="all"||Ge.assigned===X.assigned)&&(X.status==="all"||X.status==="active"&&Ge.isActive||X.status==="inactive"&&!Ge.isActive),Te=Ge.created_at?new Date(Ge.created_at):null,qe=!X.dateFrom||!Te||Te>=new Date(X.dateFrom),as=!X.dateTo||!Te||Te<=new Date(X.dateTo),xs=X.ignoreDate||qe&&as;return z&&ce&&Re&&xs})},[Y,c,x,X]),Ce=Math.ceil(ye.length/D)||1,_=(A-1)*D,ae=ye.slice(_,_+D),ke=()=>{W(null),w(!0)},Me=Se=>{if(!ec(a,Se)){Z.error("You do not have permission to edit this seller");return}$&&(y(null),M(0)),W(Se),w(!0)},Ye=Se=>{if(!ji(a,Se)){Z.error("You do not have permission to view this seller");return}const Ge=ye.findIndex(z=>z.id===Se.id);M(Ge),y(Se)},ie=Se=>{const Ge=H.find(z=>z.id===Se);if(!Ge){Z.error("Seller not found");return}if(!ji(a,Ge)){Z.error("You do not have permission to view this seller account");return}s(`/dashboard/sellers-account/${Se}`)},we=()=>{y(null),R(null),M(0)},Be=async Se=>{const Ge=H.find(z=>z.id===Se);if(Ge){if(!sc(a,Ge)){Z.error("You do not have permission to delete this seller");return}if(window.confirm("Are you sure you want to delete this seller?"))try{await st.delete(String(Se)),h(z=>z.filter(te=>te.id!==Se)),($==null?void 0:$.id)===Se&&y(null),Z.success("Seller deleted successfully!")}catch(z){console.error("Error deleting seller:",z),Z.error("Failed to delete seller. Please try again.")}}},Ve=async Se=>{var Ge,z;try{let te;if(V!=null&&V.id){if(!ec(a,V)){Z.error("You do not have permission to edit this seller");return}try{te=await st.update(String(V.id),Se),Z.success("Seller updated successfully")}catch(Re){if(((Ge=Re==null?void 0:Re.response)==null?void 0:Ge.status)===404||(z=Re==null?void 0:Re.message)!=null&&z.includes("not found"))console.warn("Seller not found, creating new one..."),te=await st.create(Se),Z.success("Seller created successfully (original not found)");else throw Re}}else{if(!r){Z.error("You do not have permission to create sellers");return}te=await st.create(Se),Z.success("Seller created successfully")}const ce=Xo(te);await Je(),w(!1),W(null)}catch(te){console.error("âŒ Error saving seller:",te),Z.error("Failed to save seller. Please try again.")}},Je=async()=>{try{ne(!0);const Se=await st.getAll(),Ge=Array.isArray(Se)?Se.map(Xo):[];h(Ge)}catch(Se){console.error("Error refreshing sellers:",Se),Z.error("Failed to refresh sellers list")}finally{ne(!1)}},Ue=Se=>{const Ge=H.find(z=>z.id===Se);if(!Ge||!ji(a,Ge)){Z.error("You do not have permission to select this seller");return}N(z=>z.includes(Se)?z.filter(te=>te!==Se):[...z,Se])},Oe=()=>{const Se=ae.filter(Ge=>ji(a,Ge));p.length===Se.length&&Se.length>0?N([]):N(Se.map(Ge=>Ge.id))},rs=()=>{if(B<ye.length-1){const Se=B+1;M(Se),y(ye[Se])}},ms=()=>{if(B>0){const Se=B-1;M(Se),y(ye[Se])}},cs=Se=>{const z=(typeof Se=="number"?Se===1:Se)?{bg:"bg-emerald-100",text:"text-emerald-700",label:"Active",icon:"ðŸŸ¢"}:{bg:"bg-gray-100",text:"text-gray-600",label:"Inactive",icon:"âš«"};return e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${z.bg} ${z.text}`,children:[z.icon," ",z.label]})},gs=Se=>{const Ge=Fe.find(Te=>Te.value===Se),z=(Ge==null?void 0:Ge.label)||Se.replace(/_/g," ").replace(/\b\w/g,Te=>Te.toUpperCase()),Re={initial_contact:{bg:"bg-blue-100",text:"text-blue-700",icon:"ðŸ“ž"},property_collection:{bg:"bg-purple-100",text:"text-purple-700",icon:"ðŸ "},mandate_discussion:{bg:"bg-orange-100",text:"text-orange-700",icon:"ðŸ’¬"},mandate_signed:{bg:"bg-green-100",text:"text-green-700",icon:"âœ…"},selling_process:{bg:"bg-indigo-100",text:"text-indigo-700",icon:"ðŸ”„"},deal_negotiation:{bg:"bg-yellow-100",text:"text-yellow-700",icon:"ðŸ¤"},deal_closure:{bg:"bg-pink-100",text:"text-pink-700",icon:"ðŸ“‹"},completed:{bg:"bg-emerald-100",text:"text-emerald-700",icon:"ðŸŽ‰"}}[Se||"initial_contact"]||{bg:"bg-gray-100",text:"text-gray-700"};return e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${Re.bg} ${Re.text}`,children:[Re.icon?`${Re.icon} `:"",z]})},Ne=Se=>{const Ge=$e.find(Te=>Te.value===Se),z=(Ge==null?void 0:Ge.label)||Se.charAt(0).toUpperCase()+Se.slice(1),te=(Se||"").toLowerCase(),Re={high:{bg:"bg-red-100",text:"text-red-700",icon:"ðŸ”¥"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",icon:"âš¡"},low:{bg:"bg-green-100",text:"text-green-700",icon:"ðŸŒ±"}}[te]||{bg:"bg-gray-100",text:"text-gray-700"};return e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${Re.bg} ${Re.text}`,children:[Re.icon?`${Re.icon} `:"",z]})},Ze=Se=>{const Ge=Number(Se)||0,z=Ge>=80?"text-green-600":Ge>=60?"text-yellow-600":"text-red-600",te=Ge>=80?"bg-green-100":Ge>=60?"bg-yellow-100":"bg-red-100";return e.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded-full ${te} ${z}`,children:[e.jsx(Xs,{size:12,className:"mr-1"}),e.jsx("span",{className:"text-xs font-bold",children:Ge})]})},ls=()=>{re({dateFrom:"",dateTo:"",ignoreDate:!1,source:"all",stage:"all",priority:"all",leadType:"all",assigned:"all",status:"all"})},$s=()=>{let Se=7;return(i||n||g||b)&&(Se+=1),v&&(Se+=1),Se},Gs=l.useMemo(()=>{const Se=((a==null?void 0:a.role)||"").toLowerCase(),Ge=((a==null?void 0:a.department)||"").toLowerCase();return Se.includes("executive")||Ge.includes("sales")||Ge.includes("presales")},[a]);return $?e.jsx(wv,{seller:$,onBack:we,onEdit:Me,onAccount:ie,onNext:rs,onPrevious:ms,currentIndex:B,totalSellers:ye.length,onUpdateSeller:Se=>{h(Ge=>Ge.map(z=>z.id===Se.id?Se:z)),y(Se)}}):k?e.jsx(fg,{seller:k,onBack:we,onUpdateSeller:Se=>{h(Ge=>Ge.map(z=>z.id===Se.id?Se:z)),R(Se)}}):e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 lg:px-6 py-3",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl",children:e.jsx(Ns,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"Seller & Lead Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Complete seller lifecycle from lead to deal closure"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o&&e.jsxs("button",{onClick:()=>T(!0),className:"flex items-center space-x-2 px-3 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all text-sm",children:[e.jsx(dt,{size:14}),e.jsx("span",{children:"Import"})]}),r&&e.jsxs("button",{onClick:ke,className:"flex items-center space-x-2 px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all text-sm",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Seller"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:xe.map(Se=>e.jsxs("button",{onClick:()=>u(Se.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all whitespace-nowrap text-sm font-medium ${x===Se.id?`bg-${Se.color}-100 text-${Se.color}-700 border border-${Se.color}-200`:"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{children:Se.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${x===Se.id?`bg-${Se.color}-200`:"bg-gray-200"}`,children:Se.count})]},Se.id))})})]}),e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 lg:px-6 py-3",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 flex items-center space-x-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search sellers...",value:c,onChange:Se=>f(Se.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsxs("button",{onClick:()=>E(!j),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[e.jsx(Na,{size:14}),e.jsx("span",{children:"Filters"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:D,onChange:Se=>I(Number(Se.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),m&&e.jsxs("button",{onClick:Ie,className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"Export"})]})]})]}),Gs&&e.jsxs("div",{className:"mt-3 bg-blue-50 border border-blue-100 rounded-lg px-4 py-2 text-xs text-blue-700 flex items-center",children:[e.jsx("div",{className:"mr-2",children:e.jsx(La,{size:14,className:"text-blue-500"})}),e.jsxs("div",{children:[e.jsx("strong",{className:"font-semibold",children:"Visibility Note:"})," ","You are viewing ",Y.length," seller(s) assigned to you"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Quick:"}),e.jsx("button",{onClick:()=>re(Se=>({...Se,stage:"all",priority:"all"})),className:`px-2 py-1 rounded-full text-xs font-medium transition-colors ${X.stage==="all"&&X.priority==="all"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"All"}),Le.filter(Se=>Se!=="all").slice(0,4).map(Se=>{var Ge;return e.jsx("button",{onClick:()=>re(z=>({...z,stage:Se})),className:`px-2 py-1 rounded-full text-xs font-medium transition-colors ${X.stage===Se?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:((Ge=Fe.find(z=>z.value===Se))==null?void 0:Ge.label)||Se.replace("_"," ").replace(/\b\w/g,z=>z.toUpperCase())},Se)}),je.filter(Se=>Se!=="all").map(Se=>{var Ge;return e.jsx("button",{onClick:()=>re(z=>({...z,priority:Se})),className:`px-2 py-1 rounded-full text-xs font-medium transition-colors ${X.priority===Se?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:((Ge=$e.find(z=>z.value===Se))==null?void 0:Ge.label)||Se.charAt(0).toUpperCase()+Se.slice(1)},Se)})]}),p.length>0&&(i||g||b||m)&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2 rounded-lg border border-blue-200 bg-blue-50 px-2.5 py-1.5",children:[e.jsxs("span",{className:"text-xs font-semibold text-blue-700",children:[p.length," selected"]}),e.jsx("span",{className:"mx-1 h-4 w-px bg-blue-200"}),g&&e.jsxs("select",{onChange:Se=>{const Ge=Number(Se.target.value);Number.isNaN(Ge)||_e(Ge),Se.target.value=""},className:"px-2 py-1 border border-gray-300 rounded text-xs",disabled:he,children:[e.jsx("option",{value:"",children:"Assign Executive"}),e.jsx("option",{value:0,children:"â€” Unassigned â€”"}),ue.filter(Se=>Se.id!==0).map(Se=>e.jsxs("option",{value:Se.id,children:[Se.name," ",Se.id===(a==null?void 0:a.id)?"(You)":""]},Se.id))]}),i&&e.jsxs("select",{onChange:Se=>{const Ge=Se.target.value;Ge&&Pe(Ge),Se.target.value=""},className:"px-2 py-1 border border-gray-300 rounded text-xs",children:[e.jsx("option",{value:"",children:"Update Stage"}),Le.filter(Se=>Se!=="all").map(Se=>{var Ge;return e.jsx("option",{value:Se,children:((Ge=Fe.find(z=>z.value===Se))==null?void 0:Ge.label)||Se.replace("_"," ").replace(/\b\w/g,z=>z.toUpperCase())},Se)})]}),i&&e.jsxs("select",{onChange:Se=>{const Ge=Se.target.value;Ge&&We(Ge),Se.target.value=""},className:"px-2 py-1 border border-gray-300 rounded text-xs",children:[e.jsx("option",{value:"",children:"Update Priority"}),je.filter(Se=>Se!=="all").map(Se=>{var Ge;return e.jsx("option",{value:Se,children:((Ge=$e.find(z=>z.value===Se))==null?void 0:Ge.label)||Se.charAt(0).toUpperCase()+Se.slice(1)},Se)})]}),i&&e.jsxs("select",{onChange:Se=>{const Ge=Se.target.value;Ge&&ve(Ge),Se.target.value=""},className:"px-2 py-1 border border-gray-300 rounded text-xs",children:[e.jsx("option",{value:"",children:"Update Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),m&&e.jsx("button",{onClick:O,className:"rounded-md bg-emerald-600 px-2.5 py-1 text-xs text-white hover:bg-emerald-700",children:"Export"}),b&&e.jsx("button",{onClick:pe,disabled:C,className:"rounded-md bg-red-600 px-2.5 py-1 text-xs text-white hover:bg-red-700 disabled:opacity-50",children:C?"Deleting...":"Delete"}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:ze,className:"rounded-full p-1 text-blue-700 hover:bg-blue-100",title:"Clear selection",children:e.jsx(ns,{size:14})})]})}),e.jsx(wN,{isOpen:j,onClose:()=>E(!1),filters:X,setFilters:re,resetFilters:ls,sources:Ee,stages:Le,priorities:je,assignedUsers:Xe,statuses:Ke})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"bg-white",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[(i||n||g||b)&&e.jsx("th",{className:"px-3 py-2 text-left w-8",children:e.jsx("input",{type:"checkbox",checked:p.length===ae.length&&ae.length>0,onChange:Oe,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Seller Details"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact & Location"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Business Info"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Assigned To"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Progress & Activity"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Performance"}),v&&e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:d?"Actions":"View"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:q?e.jsx("tr",{children:e.jsx("td",{colSpan:$s(),children:e.jsx("div",{className:"w-full flex items-center justify-center py-8",children:e.jsx(md,{message:"Loading sellers...",size:"lg",colSpan:8})})})}):le?e.jsx("tr",{children:e.jsx("td",{colSpan:$s(),className:"px-3 py-8 text-center text-sm text-red-600",children:le})}):ae.length>0?ae.map(Se=>{var Ge,z,te,ce;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[(i||n||g||b)&&e.jsx("td",{className:"px-3 py-3",children:e.jsx("input",{type:"checkbox",checked:p.includes(Se.id),onChange:()=>Ue(Se.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-xs font-bold",children:((Ge=Se.name)==null?void 0:Ge.charAt(0))||"S"}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>Ye(Se),className:"font-medium text-gray-900 hover:text-blue-600  text-left",children:[Se.salutation," ",Se.name]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",Se.id]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[cs(Se.isActive),Ze(Se.leadScore)]})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(Cs,{size:12,className:"text-gray-400"}),e.jsx("span",{children:Se.phone})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(Ds,{size:12,className:"text-gray-400"}),e.jsx("span",{className:"truncate max-w-[120px]",children:Se.email})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(Qs,{size:12,className:"text-gray-400"}),e.jsx("span",{className:"truncate max-w-[120px]",children:Se.location})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:gs(Se.stage)}),e.jsx("div",{children:Ne(Se.priority)}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Source: ",e.jsx("span",{className:"font-medium",children:Se.source})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Created: ",e.jsx("span",{className:"font-medium",children:Zo(Se.created_at)})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center text-xs text-gray-600",children:((z=Se.assigned_to_name)==null?void 0:z.charAt(0))||"U"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:Se.assigned_to_name||"Unassigned"}),Se.assigned_to_email&&e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[120px]",children:Se.assigned_to_email})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Stage Progress"}),e.jsxs("span",{children:[Se.stageProgress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:`${Se.stageProgress}%`}})})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Visits: ",e.jsx("span",{className:"font-medium",children:Se.visits})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Last Activity: ",e.jsx("span",{className:"font-medium",children:Zo(Se.lastActivity)})]})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Deal Value:"}),e.jsxs("span",{className:"font-medium",children:["â‚¹",(te=Se.dealValue)==null?void 0:te.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Response Rate:"}),e.jsxs("span",{className:"font-medium",children:[Se.responseRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Properties:"}),e.jsx("span",{className:"font-medium",children:((ce=Se.properties)==null?void 0:ce.length)||0})]}),Se.expectedClose&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Expected Close:"}),e.jsx("span",{className:"font-medium text-orange-600",children:Zo(Se.expectedClose)})]})]})}),v&&e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>Ye(Se),className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded transition-colors",title:"View Details",children:e.jsx(ks,{size:14})}),e.jsx("button",{onClick:()=>ie(Se.id),className:"p-1.5 text-green-600 hover:bg-green-100 rounded transition-colors",title:"Seller Account",children:e.jsx(La,{size:14})}),i&&ec(a,Se)&&e.jsx("button",{onClick:()=>Me(Se),className:"p-1.5 text-orange-600 hover:bg-orange-100 rounded transition-colors",title:"Edit",children:e.jsx(ft,{size:14})}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:e.jsx(xr,{size:14})}),e.jsx("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:e.jsxs("div",{className:"p-1",children:[e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(ju,{size:12}),e.jsx("span",{children:"Call"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(tt,{size:12}),e.jsx("span",{children:"WhatsApp"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 text-xs text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(Dt,{size:12}),e.jsx("span",{children:"Email"})]})]}),n&&sc(a,Se)&&e.jsxs("button",{onClick:()=>Be(Se.id),className:"flex items-center space-x-2 px-3 py-2 text-xs text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(Es,{size:12}),e.jsx("span",{children:"Delete"})]})]})})]})]})})]},Se.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:$s(),className:"px-3 py-8 text-center text-sm text-gray-500",children:Y.length===0?e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(Ns,{className:"h-8 w-8 text-gray-300"}),e.jsx("div",{children:"No sellers assigned to you yet."}),e.jsx("div",{className:"text-xs text-gray-500",children:"Contact Admin to get assigned sellers."})]}):"No sellers match the current filters."})})})]})})}),!q&&!le&&e.jsx("div",{className:"bg-white border-t border-gray-200 px-4 lg:px-6 py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",ye.length===0?0:_+1,"-",Math.min(_+D,ye.length)," of ",ye.length]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>L(Se=>Math.max(Se-1,1)),disabled:A===1,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Wa,{size:14})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[Array.from({length:Math.min(5,Ce)},(Se,Ge)=>{const z=Ge+1;return e.jsx("button",{onClick:()=>L(z),className:`px-2 py-1 rounded text-xs ${A===z?"bg-blue-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:z},z)}),Ce>5&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-1 text-xs",children:"..."}),e.jsx("button",{onClick:()=>L(Ce),className:`px-2 py-1 rounded text-xs ${A===Ce?"bg-blue-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:Ce})]})]}),e.jsx("button",{onClick:()=>L(Se=>Math.min(Se+1,Ce)),disabled:A===Ce,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:14})})]})]})}),P&&e.jsx(ev,{isOpen:P,seller:V||void 0,onClose:()=>{w(!1),W(null)},onSave:Ve},V?`edit-${V.id}`:"create"),F&&e.jsx(NN,{isOpen:F,onClose:()=>T(!1)})]})};function Bi(s,a="document.pdf"){var i;if(!s)return a;let t=/filename\*=(?:UTF-8''|)([^;]+)/i.exec(s)||/filename="?([^";\n]+)"?/i.exec(s);const r=(i=t==null?void 0:t[1])==null?void 0:i.trim();if(!r)return a;try{const n=r.replace(/^"+|"+$/g,"");return decodeURIComponent(n)}catch{return r||a}}function yx(s,a){const t=URL.createObjectURL(s),r=document.createElement("a");r.href=t,r.download=a||"document.pdf",document.body.appendChild(r),r.click(),r.remove(),setTimeout(()=>URL.revokeObjectURL(t),0)}function yg(s,a){var n;const t=((n=Ae==null?void 0:Ae.defaults)==null?void 0:n.baseURL)||"",r=t?t.replace(/\/$/,""):"/api",i=a?"?"+Object.entries(a).map(([o,m])=>`${encodeURIComponent(o)}=${encodeURIComponent(m)}`).join("&"):"";return`${r}${s}${i}`}async function CN(s,a){const t=((a==null?void 0:a.page)||"a4").toLowerCase(),r=(a==null?void 0:a.disposition).toLowerCase(),i=yg(`/documents-generated/${s}/pdf`,{page:t,disposition:r}),n=await fetch(i,{method:"GET",credentials:"include"});if(!n.ok){let d=`Failed to download PDF (HTTP ${n.status})`;try{const v=await n.json();v!=null&&v.error&&(d=v.error)}catch{const v=await n.text().catch(()=>"");v&&(d+=`
${v}`)}throw new Error(d)}const o=await n.blob(),m=o.type||n.headers.get("Content-Type")||"";m.toLowerCase().includes("pdf")||console.warn("âš ï¸ Response is not application/pdf. Received:",m);const g=n.headers.get("Content-Disposition"),b=Bi(g,"document.pdf");return{blob:o,filename:b}}const ot={getAll:async s=>(await Ae.get("/documents-generated",{params:s})).data.data,getById:async s=>(await Ae.get(`/documents-generated/${s}`)).data.data,create:async s=>{const a={template_id:s.template_id??null,name:s.name??null,description:s.description??null,category:s.category??null,content:s.content??null,variables:s.variables??null,status:s.status??"draft",created_by:s.created_by??null,updated_by:s.updated_by??null};return(await Ae.post("/documents-generated",a)).data.data},update:async(s,a)=>{const t={template_id:a.template_id??null,name:a.name??null,description:a.description??null,category:a.category??null,content:a.content??null,variables:a.variables??null,status:a.status??"draft",created_by:a.created_by??null,updated_by:a.updated_by??null};return(await Ae.patch(`/documents-generated/${s}`,t)).data.data},softDelete:async s=>(await Ae.post(`/documents-generated/${s}/soft-delete`)).data,restore:async s=>(await Ae.post(`/documents-generated/${s}/restore`)).data,hardDelete:async s=>(await Ae.delete(`/documents-generated/${s}`)).data,downloadPdf:async(s,a)=>{const t=(a==null?void 0:a.page)||"a4",r=await Ae.get(`/documents-generated/${s}/download`,{params:{page:t},responseType:"blob"}),i=new Blob([r.data],{type:"application/pdf"}),n=URL.createObjectURL(i),o=document.createElement("a");o.href=n,o.download=(a==null?void 0:a.filenameFallback)||"document.pdf",o.click(),setTimeout(()=>URL.revokeObjectURL(n),1e3)},getOneWithRelations:async s=>(await Ae.get(`/documents-generated/with-relations/${s}`)).data.data,getAllWithRelations:async s=>(await Ae.get("/documents-generated/with-relations/getall",{params:s})).data.data,bulkDownloadZip:async(s,a)=>{var m,g;if(!Array.isArray(s)||s.length===0)throw new Error("ids[] required");const t=await Ae.post("/documents-generated/bulk-download",{ids:s,options:{page:(a==null?void 0:a.page)||"a4",filenamePrefix:(a==null?void 0:a.filenamePrefix)||"documents"}},{responseType:"blob"}),r=t.data,i=((m=t.headers)==null?void 0:m["content-disposition"])||((g=t.headers)==null?void 0:g["Content-Disposition"]),n=`${((a==null?void 0:a.filenamePrefix)||"documents").toString().replace(/[^\w\-]+/g,"_")}_${s.length}_files.zip`,o=Bi(i,n);return yx(r,o),{blob:r,filename:o}},bulkDownloadZipBlob:async(s,a)=>{var m,g;if(!Array.isArray(s)||s.length===0)throw new Error("ids[] required");const t=await Ae.post("/documents-generated/bulk-download",{ids:s,options:{page:(a==null?void 0:a.page)||"a4",filenamePrefix:(a==null?void 0:a.filenamePrefix)||"documents"}},{responseType:"blob"}),r=t.data,i=((m=t.headers)==null?void 0:m["content-disposition"])||((g=t.headers)==null?void 0:g["Content-Disposition"]),n=`${((a==null?void 0:a.filenamePrefix)||"documents").toString().replace(/[^\w\-]+/g,"_")}_${s.length}_files.zip`,o=Bi(i,n);return{blob:r,filename:o}},openPdf:async(s,a="a4")=>{const{blob:t}=await CN(s,{page:a,disposition:"inline"}),r=URL.createObjectURL(t);window.open(r,"_blank","noopener,noreferrer"),setTimeout(()=>URL.revokeObjectURL(r),6e4)},savePdf:async(s,a)=>(await Ae.post(`/documents-generated/${s}/save-pdf`,{},{params:{page:(a==null?void 0:a.page)||"a4"}})).data,getVerificationSummary:async s=>(await Ae.get(`/documents-generated/${s}/verification-summary`)).data,downloadFinalPdf:async(s,a)=>{const t=await Ae.get(`/documents-generated/${s}/final-pdf`,{responseType:"blob"}),r=t.data,i=t.headers["content-disposition"]||t.headers["Content-Disposition"]||"",n=Bi(i,(a==null?void 0:a.filenameFallback)||"final.pdf");return yx(r,n),{blob:r,filename:n}},openFinalPdf:async s=>{const a=await Ae.get(`/documents-generated/${s}/final-pdf`,{responseType:"blob"}),t=URL.createObjectURL(a.data);window.open(t,"_blank","noopener,noreferrer"),setTimeout(()=>URL.revokeObjectURL(t),6e4)},previewUrl:async(s,a="a4")=>{try{if(!s)throw new Error("Invalid document ID");const t=await Ae.get(`/documents-generated/documents/${s}/preview.pdf`,{params:{page:a},responseType:"blob"}),r=new Blob([t.data],{type:"application/pdf"}),i=URL.createObjectURL(r);return setTimeout(()=>URL.revokeObjectURL(i),300*1e3),i}catch(t){throw console.error("âŒ Error building preview URL:",t),t}},openPreview:async(s,a="a4")=>{try{const t=await ot.previewUrl(s,a);window.open(t,"_blank","noopener,noreferrer")||console.warn("âš ï¸ Popup blocked or failed to open window")}catch(t){console.error("âŒ Error opening preview:",t),alert("Failed to open document preview. Please try again.")}},getPreviewEmbedSrc:async(s,a="a4")=>{try{if(!s)throw new Error("Invalid document ID");return await ot.previewUrl(s,a)}catch(t){return console.error("âŒ Error getting preview embed src:",t),""}},getFinalPdfUrl:(s,a)=>{const t=(a==null?void 0:a.mask)===!1?"0":"1";return yg(`/documents-generated/${s}/final-pdf`,{mask:t})}},sa=s=>{var a,t;if(s!=null&&s.response){const r=s.response.status,i=((a=s.response.data)==null?void 0:a.message)||((t=s.response.data)==null?void 0:t.error)||JSON.stringify(s.response.data);return new Error(`HTTP ${r}: ${i}`)}return s!=null&&s.request?new Error("Network error: no response from server"):new Error((s==null?void 0:s.message)||"Unknown error")},An=s=>{const a=Object.entries(s).filter(([,t])=>t!=null&&t!=="").map(([t,r])=>Array.isArray(r)?r.map(i=>`${encodeURIComponent(t)}=${encodeURIComponent(i)}`).join("&"):`${encodeURIComponent(t)}=${encodeURIComponent(String(r))}`).join("&");return a?`?${a}`:""},ua={async fetchCatalog(){var s;try{return((s=(await Ae.get("/doc-status/status-catalog")).data)==null?void 0:s.data)??[]}catch(a){throw sa(a)}},async bulkSetStatus(s){var a,t;try{if(!((a=s==null?void 0:s.ids)!=null&&a.length))throw new Error("ids must be a non-empty array");if(!s.new_status)throw new Error("new_status is required");return(t=(await Ae.post("/doc-status/documents/bulk-status",s)).data)==null?void 0:t.data}catch(r){throw sa(r)}},async getSnapshot(s){var a;try{return((a=(await Ae.get(`/doc-status/documents/${s}/snapshot`)).data)==null?void 0:a.data)??null}catch(t){throw sa(t)}},async setStatus(s,a){var t;try{return(t=(await Ae.post(`/doc-status/documents/${s}/status`,a)).data)==null?void 0:t.data}catch(r){throw sa(r)}},async getHistory(s){var a;try{return((a=(await Ae.get(`/doc-status/documents/${s}/history`)).data)==null?void 0:a.data)??[]}catch(t){throw sa(t)}},async getTimeline(s){var a;try{return((a=(await Ae.get(`/doc-status/documents/${s}/timeline`)).data)==null?void 0:a.data)??[]}catch(t){throw sa(t)}},async createShareBatch(s,a){var t;try{return(t=(await Ae.post(`/doc-status/documents/${s}/share-batches`,a)).data)==null?void 0:t.data}catch(r){throw sa(r)}},async listShareBatches(s){var a;try{return((a=(await Ae.get(`/doc-status/documents/${s}/share-batches`)).data)==null?void 0:a.data)??[]}catch(t){throw sa(t)}},async getShareRecipients(s){var a;try{return((a=(await Ae.get(`/doc-status/share-batches/${s}/recipients`)).data)==null?void 0:a.data)??[]}catch(t){throw sa(t)}},async logOtpEvent(s,a){var t;try{return(t=(await Ae.post(`/doc-status/documents/${s}/otp-events`,a)).data)==null?void 0:t.data}catch(r){throw sa(r)}},async logEsignEvent(s,a){var t;try{return(t=(await Ae.post(`/doc-status/documents/${s}/esign-events`,a)).data)==null?void 0:t.data}catch(r){throw sa(r)}},requestOtp:async(s,a)=>{var t;try{const r=await Ae.post(`/doc-status/documents/${s}/otp/request`,a);return((t=r.data)==null?void 0:t.data)??r.data}catch(r){throw sa(r)}},verifyOtp:async(s,a)=>{var t;try{const r=await Ae.post(`/doc-status/documents/${s}/otp/verify`,a);return((t=r.data)==null?void 0:t.data)??r.data}catch(r){throw sa(r)}},async listOtpSessions(s={}){var a;try{return(a=(await Ae.get(`/doc-status/otp-sessions${An(s)}`)).data)==null?void 0:a.data}catch(t){throw sa(t)}},async getOtpSessionsByDocument(s,a={}){var t;try{return((t=(await Ae.get(`/doc-status/documents/${s}/otp-sessions${An(a)}`)).data)==null?void 0:t.data)??[]}catch(r){throw sa(r)}},async getOtpSessionById(s){var a;try{return(a=(await Ae.get(`/doc-status/otp-sessions/${s}`)).data)==null?void 0:a.data}catch(t){throw sa(t)}},async listOtpEvents(s){return Ae.get("/api/doc-status/otp-events",{params:s}).then(a=>a.data)},async getOtpEventsByDocument(s,a={}){var t;try{return((t=(await Ae.get(`/doc-status/documents/${s}/otp-events${An(a)}`)).data)==null?void 0:t.data)??[]}catch(r){throw sa(r)}},async getLatestOtpEvent(s,a={}){var t;try{return((t=(await Ae.get(`/doc-status/documents/${s}/otp-events/latest${An(a)}`)).data)==null?void 0:t.data)??null}catch(r){throw sa(r)}},async listLatestOtpEventForDocuments(s){var a;try{return((a=(await Ae.post("/doc-status/otp-events/latest-by-documents",s)).data)==null?void 0:a.data)??[]}catch(t){throw sa(t)}},async getOtpDocStatusesLatest(s,a){const t=await ua.listLatestOtpEventForDocuments({document_ids:s,purpose:a??null,fields:["document_id","status"]}),r=new Map;for(const i of t)typeof i.document_id=="number"&&typeof i.status=="string"&&r.set(i.document_id,i.status);return r},async getOtpDocEventsCompact(s){return ua.getOtpEventsByDocument(s,{fields:"document_id,status,purpose,created_at"})},async getAllByDocument(s,a){var t,r;try{const i=An({includeRecipients:a!=null&&a.includeRecipients?"true":void 0,onlyActive:typeof(a==null?void 0:a.onlyActive)=="boolean"?String(a.onlyActive):void 0,verified:typeof(a==null?void 0:a.verified)=="boolean"?String(a.verified):void 0,timelineLimit:(a==null?void 0:a.timelineLimit)??void 0,otpEventsFields:(t=a==null?void 0:a.otpEventsFields)!=null&&t.length?a.otpEventsFields.join(","):void 0});return(r=(await Ae.get(`/doc-status/documents/${s}/all${i}`)).data)==null?void 0:r.data}catch(i){throw sa(i)}}},jx=({onNavigateToTracking:s})=>{const[a,t]=l.useState([]),[r,i]=l.useState(!1),[n,o]=l.useState(null),[m,g]=l.useState(null),[b,d]=l.useState({}),v=j=>{var E;return Array.isArray(j)?j:Array.isArray(j==null?void 0:j.rows)?j.rows:Array.isArray(j==null?void 0:j.data)?j.data:Array.isArray((E=j==null?void 0:j.data)==null?void 0:E.rows)?j.data.rows:Array.isArray(j==null?void 0:j.list)?j.list:[]},x=(j,E)=>{for(const V of E){const W=V.split(".").reduce((B,M)=>B?B[M]:void 0,j);if(W!=null&&W!=="")return W}},u=(...j)=>j.map(E=>(E??"").trim()).filter(Boolean).join(" "),c=j=>j?/\.$/.test(j)?j:`${j}.`:"",f=j=>j?j.name??j.full_name??j.fullName??j.display_name??(j.first_name&&j.last_name?`${j.first_name} ${j.last_name}`:null)??j.first_name??j.last_name??null:null,p=j=>j==="esign_pending"?"e-sign_pending":j,N=j=>{if(!j)return!1;const E=new Date(j);if(isNaN(E.getTime()))return!1;const V=M=>new Intl.DateTimeFormat("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"2-digit",day:"2-digit"}).format(M),W=V(new Date),B=V(E);return W===B},P=j=>{var le;const E=(j==null?void 0:j.name)??(j==null?void 0:j.title)??(j==null?void 0:j.document_title)??(j==null?void 0:j.template_name)??"Untitled Document",V=(j==null?void 0:j.category)??(j==null?void 0:j.type)??(j==null?void 0:j.template_type)??"Document",W=typeof(j==null?void 0:j.variables)=="string"?(()=>{try{return JSON.parse(j.variables)}catch{return{}}})():(j==null?void 0:j.variables)||{},B=(W==null?void 0:W.__form_snapshot)||{},M=x({vars:W,snap:B,d:j},["vars.seller_salutation","vars.seller.salutation","vars.seller_title","vars.seller.title","snap.seller.salutation","d.seller.salutation"]),A=x({vars:W,snap:B,d:j},["vars.buyer_salutation","vars.buyer.salutation","vars.buyer_title","vars.buyer.title","snap.buyer.salutation","d.buyer.salutation"]),L=x({vars:W,snap:B,d:j},["vars.seller_name","vars.seller.name","snap.seller.name","d.seller.name"])||u(x({vars:W,snap:B},["vars.seller.first_name","snap.seller.first_name"]),x({vars:W,snap:B},["vars.seller.middle_name","snap.seller.middle_name"]),x({vars:W,snap:B},["vars.seller.last_name","snap.seller.last_name"]))||f(j==null?void 0:j.seller)||(Array.isArray(j==null?void 0:j.sellers)&&j.sellers.length?f(j.sellers[0]):null),D=x({vars:W,snap:B,d:j},["vars.buyer_name","vars.buyer.name","snap.buyer.name","d.buyer.name"])||u(x({vars:W,snap:B},["vars.buyer.first_name","snap.buyer.first_name"]),x({vars:W,snap:B},["vars.buyer.middle_name","snap.buyer.middle_name"]),x({vars:W,snap:B},["vars.buyer.last_name","snap.buyer.last_name"]))||f(j==null?void 0:j.buyer)||(Array.isArray(j==null?void 0:j.buyers)&&j.buyers.length?f(j.buyers[0]):null),I=u(c(M),L)||null,H=u(c(A),D)||null,h=H&&I?`${H} â€¢ ${I}`:H||I||((le=j==null?void 0:j.client)==null?void 0:le.name)||(j==null?void 0:j.party_name)||"â€”",Y=p(j==null?void 0:j.status)??"created",K=(j==null?void 0:j.updated_at)??(j==null?void 0:j.created_at)??new Date().toISOString(),q=String(K).slice(0,10);let ne="low";return Y==="e-sign_pending"||Y==="otp_verified"?ne="high":Y==="shared"&&(ne="medium"),{id:Number(j==null?void 0:j.id),title:E,type:V,client:h,buyerName:H,sellerName:I,status:Y,date:q,priority:ne}};l.useEffect(()=>{let j=!0;return(async()=>{try{i(!0),o(null);const E=await ot.getAllWithRelations({limit:10,order:"desc"}),V=v(E).map(P);V.sort((W,B)=>W.date<B.date?1:-1),j&&t(V)}catch(E){console.error(E),j&&o((E==null?void 0:E.message)||"Failed to load documents")}finally{j&&i(!1)}})(),()=>{j=!1}},[]),l.useEffect(()=>{if(!a.length)return;let j=!1;return(async()=>{const V=Array.from(new Set(a.map(M=>Number(M.id)).filter(M=>Number.isFinite(M)))),W=await Promise.allSettled(V.map(M=>ua.getSnapshot(M)));if(j)return;const B={};W.forEach((M,A)=>{const L=V[A];M.status==="fulfilled"&&M.value&&(B[L]=M.value)}),d(M=>({...M,...B}))})(),()=>{j=!0}},[a]);const w=j=>{const E=b[j.id];return p(E==null?void 0:E.current_status)||j.status},$=l.useMemo(()=>{var M,A;const j=a.length,E=new Set;for(const L of a)L.buyerName&&L.buyerName.trim()&&E.add(L.buyerName.trim()),L.sellerName&&L.sellerName.trim()&&E.add(L.sellerName.trim());const V=E.size;let W=0,B=0;for(const L of a){const D=w(L);if(D==="e-sign_pending"&&(W+=1),D==="completed"){const I=((M=b[L.id])==null?void 0:M.changed_at)||((A=b[L.id])==null?void 0:A.updated_at);if(N(I))B+=1;else{const H=L.date?`${L.date}T00:00:00.000Z`:void 0;N(H)&&(B+=1)}}}return{totalDocs:j,activeClients:V,pendingApprovals:W,completedToday:B}},[a,b]),y=j=>{const E={completed:{bg:"bg-green-100",text:"text-green-800",label:"Completed"},"e-sign_pending":{bg:"bg-orange-100",text:"text-orange-800",label:"E-Sign Pending"},otp_verified:{bg:"bg-blue-100",text:"text-blue-800",label:"OTP Verified"},shared:{bg:"bg-purple-100",text:"text-purple-800",label:"Shared"},created:{bg:"bg-gray-100",text:"text-gray-800",label:"Created"},on_hold:{bg:"bg-amber-100",text:"text-amber-800",label:"On Hold"},cancelled:{bg:"bg-red-100",text:"text-red-800",label:"Cancelled"},draft:{bg:"bg-gray-100",text:"text-gray-800",label:"Draft"}},V=E[j]??E.created;return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${V.bg} ${V.text}`,children:V.label})},k=j=>{const V={high:{bg:"bg-red-100",text:"text-red-700",label:"High"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium"},low:{bg:"bg-green-100",text:"text-green-700",label:"Low"}}[j];return e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${V.bg} ${V.text}`,children:V.label})},R=j=>{s==null||s()},F=async j=>{try{g(j),await ot.downloadPdf(j,{page:"a4",filenameFallback:`document-${j}.pdf`})}catch(E){console.error(E),alert("Download failed. Please try again.")}finally{g(null)}},T=({buyer:j,seller:E,fallback:V})=>!j&&!E?e.jsx("span",{className:"text-xs text-gray-900",children:V}):e.jsxs("div",{className:"grid items-center gap-1",children:[j?e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 text-[10px] font-medium",children:["Buyer: ",j]}):null,E?e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 text-[10px] font-medium",children:["Seller: ",E]}):null]});return e.jsxs("div",{className:"p-4 space-y-4",children:[n?e.jsx("div",{className:"p-3 rounded border border-red-200 bg-red-50 text-red-700 text-xs",children:n}):null,e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Documents",value:String($.totalDocs),icon:ws,color:"blue"},{label:"Active Clients",value:String($.activeClients),icon:Ns,color:"green"},{label:"Pending Approvals",value:String($.pendingApprovals),icon:Ls,color:"orange"},{label:"Completed Today",value:String($.completedToday),icon:bs,color:"emerald"}].map((j,E)=>{const V=j.icon;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:j.label}),e.jsx("p",{className:"text-lg font-bold text-gray-900 mt-1",children:j.value})]}),e.jsx("div",{className:`p-2 rounded-lg bg-${j.color}-100`,children:e.jsx(V,{className:`text-${j.color}-600`,size:18})})]}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(Rs,{className:"text-green-500",size:14}),e.jsx("span",{className:"text-gray-500 text-xs ml-1",children:"live"})]})]},E)})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Recent Documents"}),e.jsxs("button",{onClick:s,className:"flex items-center space-x-1 text-blue-600 hover:text-blue-800 text-xs font-medium transition-colors",children:[e.jsx("span",{children:"View All"}),e.jsx(la,{size:12})]})]})}),r?e.jsx("div",{className:"p-4 text-xs text-gray-500",children:"Loadingâ€¦"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:["Document","Client","Status","Priority","Date","Actions"].map((j,E)=>e.jsx("th",{className:"px-4 py-2 text-left text-[10px] font-medium text-gray-500 uppercase tracking-wider",children:j},E))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{className:"px-4 py-6 text-center text-gray-500 text-xs",colSpan:6,children:"No documents yet."})}):a.map(j=>{const E=w(j);return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-900",children:j.title}),e.jsx("div",{className:"text-[11px] text-gray-500",children:j.type})]})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(T,{buyer:j.buyerName,seller:j.sellerName,fallback:j.client})}),e.jsx("td",{className:"px-4 py-2",children:y(E)}),e.jsx("td",{className:"px-4 py-2",children:k(j.priority)}),e.jsx("td",{className:"px-4 py-2 text-[11px] text-gray-500",children:j.date}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{title:"View Document",onClick:()=>R(j.id),className:"p-1 rounded bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",children:e.jsx(ks,{size:14})}),e.jsx("button",{title:"Download Document",onClick:()=>F(j.id),disabled:m===j.id,className:"p-1 rounded bg-green-100 text-green-600 hover:bg-green-200 disabled:opacity-60 transition-colors",children:m===j.id?e.jsx("span",{className:"px-1 text-[10px]",children:"â€¦"}):e.jsx(Ys,{size:14})})]})})]},j.id)})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:flex-wrap sm:gap-3",children:[e.jsx("button",{className:"w-full sm:w-auto bg-blue-600 text-white py-1.5 px-4 rounded-lg hover:bg-blue-700 transition-colors text-xs",children:"Generate New Document"}),e.jsx("button",{className:"w-full sm:w-auto bg-gray-100 text-gray-700 py-1.5 px-4 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:"Create Template"}),e.jsx("button",{className:"w-full sm:w-auto bg-gray-100 text-gray-700 py-1.5 px-4 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:"Add New Client"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Template Usage"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Sale Agreement"}),e.jsx("span",{className:"text-sm font-semibold",children:"45"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Token Receipt"}),e.jsx("span",{className:"text-sm font-semibold",children:"32"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"NOC Request"}),e.jsx("span",{className:"text-sm font-semibold",children:"18"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"System Health"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-600",children:"API Status: Online"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Database: Connected"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Storage: Available"})]})]})]})]})]})},AN=({isOpen:s,onClose:a,document:t,onSave:r,userRole:i})=>{var u,c,f,p,N,P,w,$,y,k,R,F,T;const[n,o]=l.useState({...t,title:(t==null?void 0:t.title)||"",seller_name:((u=t==null?void 0:t.data)==null?void 0:u.seller_name)||"",seller_phone:((c=t==null?void 0:t.data)==null?void 0:c.seller_phone)||"",seller_email:((f=t==null?void 0:t.data)==null?void 0:f.seller_email)||"",buyer_name:((p=t==null?void 0:t.data)==null?void 0:p.buyer_name)||"",buyer_phone:((N=t==null?void 0:t.data)==null?void 0:N.buyer_phone)||"",buyer_email:((P=t==null?void 0:t.data)==null?void 0:P.buyer_email)||"",property_address:((w=t==null?void 0:t.data)==null?void 0:w.property_address)||"",property_type:(($=t==null?void 0:t.data)==null?void 0:$.property_type)||"",property_area:((y=t==null?void 0:t.data)==null?void 0:y.property_area)||"",sale_amount:((k=t==null?void 0:t.data)==null?void 0:k.sale_amount)||0,token_amount:((R=t==null?void 0:t.data)==null?void 0:R.token_amount)||0,booking_amount:((F=t==null?void 0:t.data)==null?void 0:F.booking_amount)||0,sales_executive:((T=t==null?void 0:t.data)==null?void 0:T.sales_executive)||"",status:(t==null?void 0:t.status)||"created",priority:(t==null?void 0:t.priority)||"medium",notes:(t==null?void 0:t.notes)||""}),[m,g]=l.useState(""),[b,d]=l.useState(!1);if(!s||!t)return null;const v=(j,E)=>{o(V=>({...V,[j]:E}))},x=async()=>{if(i==="manager"&&!m.trim()){alert("Please provide a reason for editing this document");return}d(!0);try{const j={...n,data:{...t.data,seller_name:n.seller_name,seller_phone:n.seller_phone,seller_email:n.seller_email,buyer_name:n.buyer_name,buyer_phone:n.buyer_phone,buyer_email:n.buyer_email,property_address:n.property_address,property_type:n.property_type,property_area:n.property_area,sale_amount:n.sale_amount,token_amount:n.token_amount,booking_amount:n.booking_amount,sales_executive:n.sales_executive},edit_reason:m,edited_by:i==="admin"?"Admin User":"Manager User",edited_at:new Date().toISOString(),requires_approval:i==="manager"};await r(j),a()}catch(j){console.error("Error updating document:",j)}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Document"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.title})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[i==="manager"&&e.jsx("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ct,{className:"text-orange-600",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-orange-800",children:"Manager Edit Request"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Your changes will be sent to admin for approval before being applied."})]})]})}),i==="manager"&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for Edit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:m,onChange:j=>g(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Please explain why this document needs to be edited...",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ws,{className:"mr-2",size:20}),"Document Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Document Title"}),e.jsx("input",{type:"text",value:n.title,onChange:j=>v("title",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:n.status,onChange:j=>v("status",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"created",children:"Created"}),e.jsx("option",{value:"shared",children:"Shared"}),e.jsx("option",{value:"otp_verified",children:"OTP Verified"}),e.jsx("option",{value:"e-sign_pending",children:"E-Sign Pending"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:n.priority,onChange:j=>v("priority",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sales Executive"}),e.jsx("input",{type:"text",value:n.sales_executive,onChange:j=>v("sales_executive",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Seller Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Name"}),e.jsx("input",{type:"text",value:n.seller_name,onChange:j=>v("seller_name",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Phone"}),e.jsx("input",{type:"tel",value:n.seller_phone,onChange:j=>v("seller_phone",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Email"}),e.jsx("input",{type:"email",value:n.seller_email,onChange:j=>v("seller_email",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Buyer Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Name"}),e.jsx("input",{type:"text",value:n.buyer_name,onChange:j=>v("buyer_name",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Phone"}),e.jsx("input",{type:"tel",value:n.buyer_phone,onChange:j=>v("buyer_phone",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Email"}),e.jsx("input",{type:"email",value:n.buyer_email,onChange:j=>v("buyer_email",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Address"}),e.jsx("textarea",{value:n.property_address,onChange:j=>v("property_address",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsx("input",{type:"text",value:n.property_type,onChange:j=>v("property_type",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Area (sq ft)"}),e.jsx("input",{type:"number",value:n.property_area,onChange:j=>v("property_area",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:20}),"Financial Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sale Amount (â‚¹)"}),e.jsx("input",{type:"number",value:n.sale_amount,onChange:j=>v("sale_amount",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Token Amount (â‚¹)"}),e.jsx("input",{type:"number",value:n.token_amount,onChange:j=>v("token_amount",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Booking Amount (â‚¹)"}),e.jsx("input",{type:"number",value:n.booking_amount,onChange:j=>v("booking_amount",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes,onChange:j=>v("notes",j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes or comments..."})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="manager"?"Changes will require admin approval":"Changes will be applied immediately"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:x,disabled:b||i==="manager"&&!m.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:b?"Saving...":i==="manager"?"Send for Approval":"Save Changes"})]})]})]})})]})})},PN=({isOpen:s,onClose:a,document:t,onSubmit:r,userRole:i})=>{var f,p;const[n,o]=l.useState(""),[m,g]=l.useState(""),[b,d]=l.useState(!1);if(!s||!t)return null;const v=["Wrong client details entered","Incorrect property information","Duplicate document created by mistake","Wrong template used","Document created for wrong transaction","Client requested cancellation","Data entry error","Template variables filled incorrectly","Document no longer needed","Other (specify below)"],x=async()=>{const N=m==="Other (specify below)"?n:m;if(!N.trim()){alert("Please select or provide a reason for deletion");return}d(!0);try{const P={document_id:t.id,document_title:t.title,reason:N,requested_by:i==="admin"?"Admin User":"Manager User",requested_at:new Date().toISOString(),requires_approval:i==="manager",status:i==="admin"?"approved":"pending"};await r(P),a()}catch(P){console.error("Error submitting delete request:",P)}finally{d(!1)}},u=N=>{const P={completed:{bg:"bg-green-100",text:"text-green-800",label:"Completed"},"e-sign_pending":{bg:"bg-orange-100",text:"text-orange-800",label:"E-Sign Pending"},otp_verified:{bg:"bg-blue-100",text:"text-blue-800",label:"OTP Verified"},shared:{bg:"bg-purple-100",text:"text-purple-800",label:"Shared"},created:{bg:"bg-gray-100",text:"text-gray-800",label:"Created"}},w=P[N]||P.created;return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w.bg} ${w.text}`,children:w.label})},c=N=>{const w={high:{bg:"bg-red-100",text:"text-red-700",label:"High"},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium"},low:{bg:"bg-green-100",text:"text-green-700",label:"Low"}}[N];return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${w.bg} ${w.text}`,children:w.label})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-red-50 to-orange-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(Es,{className:"text-red-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:i==="admin"?"Delete Document":"Request Document Deletion"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.title})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Xa,{className:"text-red-600 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-800",children:i==="admin"?"Permanent Deletion Warning":"Deletion Request Warning"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:i==="admin"?"This action cannot be undone. The document and all its associated data will be permanently deleted.":"This will send a deletion request to the admin. The document will remain until approved."})]})]})}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(ws,{className:"mr-2",size:16}),"Document to be Deleted"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Title:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Template:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.template_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Seller:"}),e.jsx("span",{className:"font-semibold ml-2",children:((f=t.data)==null?void 0:f.seller_name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Buyer:"}),e.jsx("span",{className:"font-semibold ml-2",children:((p=t.data)==null?void 0:p.buyer_name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Created:"}),e.jsx("span",{className:"font-semibold ml-2",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("span",{className:"ml-2",children:u(t.status)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Priority:"}),e.jsx("span",{className:"ml-2",children:c(t.priority)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Created By:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.created_by})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Reason for Deletion ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"space-y-2",children:v.map((N,P)=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"deleteReason",value:N,checked:m===N,onChange:w=>g(w.target.value),className:"text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},P))})]}),m==="Other (specify below)"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Please specify the reason"}),e.jsx("textarea",{value:n,onChange:N=>o(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:3,placeholder:"Please provide detailed reason for deletion...",required:!0})]}),i==="manager"&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Request Process"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Your deletion request will be sent to the admin"}),e.jsx("li",{children:"â€¢ The document will remain active until approved"}),e.jsx("li",{children:"â€¢ You will be notified of the admin's decision"}),e.jsx("li",{children:"â€¢ Admin can approve or reject the deletion request"})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="admin"?"Document will be deleted immediately":"Request will be sent to admin for approval"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:x,disabled:b||!m||m==="Other (specify below)"&&!n.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Es,{size:16}),e.jsx("span",{children:b?"Processing...":i==="admin"?"Delete Document":"Send Delete Request"})]})]})]})})]})})},TN=({isOpen:s,onClose:a,document:t})=>{var u,c,f,p;const[r,i]=l.useState("details");if(!s||!t)return null;const n=[{id:"details",label:"Document Details",icon:ws},{id:"timeline",label:"Timeline",icon:jt},{id:"preview",label:"Preview",icon:ks},{id:"sharing",label:"Sharing",icon:Wt}],o=N=>{const P={completed:{bg:"bg-green-100",text:"text-green-800",label:"Completed",icon:bs},"e-sign_pending":{bg:"bg-orange-100",text:"text-orange-800",label:"E-Sign Pending",icon:Ls},otp_verified:{bg:"bg-blue-100",text:"text-blue-800",label:"OTP Verified",icon:at},shared:{bg:"bg-purple-100",text:"text-purple-800",label:"Shared",icon:Dt},created:{bg:"bg-gray-100",text:"text-gray-800",label:"Created",icon:ws}},w=P[N]||P.created,$=w.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${w.bg} ${w.text}`,children:[e.jsx($,{size:14,className:"mr-1"}),w.label]})},m=N=>{const w={high:{bg:"bg-red-100",text:"text-red-700",label:"High Priority",icon:ct},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium Priority",icon:Ls},low:{bg:"bg-green-100",text:"text-green-700",label:"Low Priority",icon:bs}}[N],$=w.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${w.bg} ${w.text}`,children:[e.jsx($,{size:14,className:"mr-1"}),w.label]})},g=N=>new Date(N).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),b=N=>N>=1e7?`â‚¹${(N/1e7).toFixed(1)}Cr`:N>=1e5?`â‚¹${(N/1e5).toFixed(1)}L`:`â‚¹${N.toLocaleString("en-IN")}`,d=N=>{const w={FileText:ws,Mail:Ds,MessageCircle:tt,Eye:ks,Shield:at,CheckCircle:bs,Award:Ct,Crown:va,Send:Dt,Phone:Cs}[N]||ws;return e.jsx(w,{size:16})},v=N=>({created:"text-gray-600 bg-gray-100",shared:"text-purple-600 bg-purple-100",viewed:"text-blue-600 bg-blue-100",otp_initiated:"text-orange-600 bg-orange-100",otp_verified:"text-green-600 bg-green-100",under_review:"text-indigo-600 bg-indigo-100",reviewed:"text-cyan-600 bg-cyan-100",e_signed:"text-pink-600 bg-pink-100",completed:"text-emerald-600 bg-emerald-100"})[N]||"text-gray-600 bg-gray-100",x=()=>{var N;return t.template_name==="Booking Form"?`
        <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 0 auto; padding: 40px;">
          <div style="text-align: center; margin-bottom: 40px; border-bottom: 3px solid #1f2937; padding-bottom: 20px;">
            <h1 style="color: #1f2937; margin-bottom: 10px; font-size: 28px;">PROPERTY BOOKING FORM</h1>
            <p style="color: #6b7280; font-size: 16px;">Document ID: ${t.data.document_id}</p>
            <p style="color: #6b7280; font-size: 16px;">Date: ${t.data.document_date}</p>
          </div>
          
          <div style="margin-bottom: 30px;">
            <h2 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Property Details</h2>
            <div style="margin-top: 20px; background: #f9fafb; padding: 20px; border-radius: 8px;">
              <p><strong>Property Address:</strong> ${t.data.property_address}</p>
              <p><strong>Property Type:</strong> ${t.data.property_type}</p>
              <p><strong>Area:</strong> ${t.data.property_area} sq ft</p>
              <p><strong>Booking Amount:</strong> â‚¹${(N=t.data.booking_amount)==null?void 0:N.toLocaleString("en-IN")}</p>
            </div>
          </div>
          
          <div style="margin-bottom: 30px;">
            <h2 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Customer Information</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
              <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                <h3 style="color: #4b5563; margin-bottom: 15px;">Primary Applicant</h3>
                <p><strong>Name:</strong> ${t.data.buyer_name}</p>
                <p><strong>Phone:</strong> ${t.data.buyer_phone}</p>
                <p><strong>Email:</strong> ${t.data.buyer_email}</p>
              </div>
              <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
                <h3 style="color: #4b5563; margin-bottom: 15px;">Deal Executive</h3>
                <p><strong>Name:</strong> ${t.data.sales_executive}</p>
                <p><strong>Employee ID:</strong> ${t.data.executive_id}</p>
                <p><strong>Contact:</strong> ${t.data.executive_phone}</p>
                <p><strong>Email:</strong> ${t.data.executive_email}</p>
              </div>
            </div>
          </div>
        </div>
      `:`
      <div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 0 auto; padding: 40px;">
        <div style="text-align: center; margin-bottom: 40px; border-bottom: 3px solid #1f2937; padding-bottom: 20px;">
          <h1 style="color: #1f2937; margin-bottom: 10px; font-size: 28px;">${t.template_name.toUpperCase()}</h1>
          <p style="color: #6b7280; font-size: 16px;">Document ID: ${t.data.document_id}</p>
          <p style="color: #6b7280; font-size: 16px;">Date: ${t.data.document_date}</p>
        </div>
        
        <div style="margin-bottom: 30px;">
          <h2 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Parties Involved</h2>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
              <h3 style="color: #4b5563; margin-bottom: 15px;">Seller</h3>
              <p><strong>Name:</strong> ${t.data.seller_name}</p>
              <p><strong>Phone:</strong> ${t.data.seller_phone}</p>
              <p><strong>Email:</strong> ${t.data.seller_email}</p>
            </div>
            ${t.data.buyer_name?`
            <div style="background: #f9fafb; padding: 20px; border-radius: 8px;">
              <h3 style="color: #4b5563; margin-bottom: 15px;">Buyer</h3>
              <p><strong>Name:</strong> ${t.data.buyer_name}</p>
              <p><strong>Phone:</strong> ${t.data.buyer_phone}</p>
              <p><strong>Email:</strong> ${t.data.buyer_email}</p>
            </div>
            `:""}
          </div>
        </div>
        
        <div style="margin-bottom: 30px;">
          <h2 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Property Details</h2>
          <div style="margin-top: 20px; background: #f9fafb; padding: 20px; border-radius: 8px;">
            <p><strong>Address:</strong> ${t.data.property_address}</p>
            <p><strong>Type:</strong> ${t.data.property_type}</p>
            <p><strong>Area:</strong> ${t.data.property_area} sq ft</p>
            ${t.data.sale_amount?`<p><strong>Sale Amount:</strong> â‚¹${t.data.sale_amount.toLocaleString("en-IN")}</p>`:""}
            ${t.data.token_amount?`<p><strong>Token Amount:</strong> â‚¹${t.data.token_amount.toLocaleString("en-IN")}</p>`:""}
          </div>
        </div>
        
        <div style="margin-top: 60px; display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
          <div style="text-align: center;">
            <div style="border-top: 2px solid #374151; padding-top: 15px; margin-top: 40px;">
              <p style="font-weight: bold; margin-bottom: 5px;">Seller Signature</p>
              <p style="color: #6b7280; font-size: 14px;">${t.data.seller_name}</p>
              <p style="color: #6b7280; font-size: 12px;">Date: ${t.data.document_date}</p>
            </div>
          </div>
          ${t.data.buyer_name?`
          <div style="text-align: center;">
            <div style="border-top: 2px solid #374151; padding-top: 15px; margin-top: 40px;">
              <p style="font-weight: bold; margin-bottom: 5px;">Buyer Signature</p>
              <p style="color: #6b7280; font-size: 14px;">${t.data.buyer_name}</p>
              <p style="color: #6b7280; font-size: 12px;">Date: ${t.data.document_date}</p>
            </div>
          </div>
          `:""}
        </div>
      </div>
    `};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(ws,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.title}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.template_name," â€¢ ID: ",t.data.document_id]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>{const N=t.createElement("a");N.href="data:application/pdf;base64,JVBERi0xLjQKJdPr6eEKMSAwIG9iago8PAovVGl0bGUgKERvY3VtZW50KQo+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMyAwIFIKPj4KZW5kb2JqCjMgMCBvYmoKPDwKL1R5cGUgL1BhZ2VzCi9LaWRzIFs0IDAgUl0KL0NvdW50IDEKPD4KZW5kb2JqCjQgMCBvYmoKPDwKL1R5cGUgL1BhZ2UKL1BhcmVudCAzIDAgUgovTWVkaWFCb3ggWzAgMCA2MTIgNzkyXQo+PgplbmRvYmoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDA5IDAwMDAwIG4gCjAwMDAwMDAwNzQgMDAwMDAgbiAKMDAwMDAwMDEyMSAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAyIDAgUgo+PgpzdGFydHhyZWYKMjczCiUlRU9GCg==",N.download=`${t.title}.pdf`,N.click()},className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Download"})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})]})}),e.jsx("div",{className:"border-b border-gray-200 px-6",children:e.jsx("nav",{className:"flex space-x-8",children:n.map(N=>{const P=N.icon;return e.jsxs("button",{onClick:()=>i(N.id),className:`flex items-center space-x-2 py-4 border-b-2 font-medium text-sm transition-colors ${r===N.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(P,{size:16}),e.jsx("span",{children:N.label})]},N.id)})})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[r==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Document Summary"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o(t.status),m(t.priority)]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Template:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.template_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Created By:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.created_by})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Assigned To:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.assigned_to})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Progress:"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[t.stage_progress,"%"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Seller Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Name:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.seller_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Phone:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.seller_phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Email:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.seller_email})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsxs("button",{onClick:()=>window.open(`tel:${t.data.seller_phone}`),className:"flex items-center space-x-1 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(Cs,{size:14}),e.jsx("span",{children:"Call"})]}),e.jsxs("button",{onClick:()=>{const N=`Hi ${t.data.seller_name}, regarding document ${t.data.document_id}`;window.open(`https://wa.me/${t.data.seller_phone.replace(/\D/g,"")}?text=${encodeURIComponent(N)}`,"_blank")},className:"flex items-center space-x-1 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(tt,{size:14}),e.jsx("span",{children:"WhatsApp"})]})]})]}),t.data.buyer_name&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ns,{className:"mr-2",size:20}),"Buyer Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Name:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.buyer_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Phone:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.buyer_phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Email:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.buyer_email})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsxs("button",{onClick:()=>window.open(`tel:${t.data.buyer_phone}`),className:"flex items-center space-x-1 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(Cs,{size:14}),e.jsx("span",{children:"Call"})]}),e.jsxs("button",{onClick:()=>{const N=`Hi ${t.data.buyer_name}, regarding document ${t.data.document_id}`;window.open(`https://wa.me/${t.data.buyer_phone.replace(/\D/g,"")}?text=${encodeURIComponent(N)}`,"_blank")},className:"flex items-center space-x-1 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(tt,{size:14}),e.jsx("span",{children:"WhatsApp"})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Address:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.property_address})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Type:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.property_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Area:"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:[t.data.property_area," sq ft"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Sales Executive:"}),e.jsx("div",{className:"font-semibold text-gray-900",children:t.data.sales_executive})]})]})]}),(t.data.sale_amount||t.data.token_amount||t.data.booking_amount)&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ka,{className:"mr-2",size:20}),"Financial Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.data.sale_amount&&e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:b(t.data.sale_amount)}),e.jsx("div",{className:"text-sm text-green-700",children:"Sale Amount"})]}),t.data.token_amount&&e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:b(t.data.token_amount)}),e.jsx("div",{className:"text-sm text-blue-700",children:"Token Amount"})]}),t.data.booking_amount&&e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:b(t.data.booking_amount)}),e.jsx("div",{className:"text-sm text-purple-700",children:"Booking Amount"})]})]})]})]}),r==="timeline"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Document Timeline"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Overall Progress"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[t.stage_progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${t.stage_progress}%`}})})]}),e.jsx("div",{className:"space-y-4",children:(u=t.tracking_history)==null?void 0:u.map((N,P)=>e.jsxs("div",{className:"relative",children:[P<t.tracking_history.length-1&&e.jsx("div",{className:"absolute left-6 top-12 w-0.5 h-16 bg-gray-200"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-full ${v(N.stage)}`,children:d(N.icon)}),e.jsxs("div",{className:"flex-1 bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:N.action}),e.jsx("span",{className:"text-sm text-gray-500",children:g(N.timestamp)})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:N.details}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["by ",N.user]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v(N.stage)}`,children:N.stage.replace("_"," ").replace(/\b\w/g,w=>w.toUpperCase())})]})]})]})]},N.id))}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"Next Steps"}),e.jsxs("div",{className:"space-y-2",children:[t.status==="created"&&e.jsxs("div",{className:"flex items-center space-x-2 text-blue-700",children:[e.jsx(Dt,{size:14}),e.jsx("span",{className:"text-sm",children:"Share document with parties"})]}),t.status==="shared"&&e.jsxs("div",{className:"flex items-center space-x-2 text-blue-700",children:[e.jsx(at,{size:14}),e.jsx("span",{className:"text-sm",children:"Wait for OTP verification"})]}),t.status==="otp_verified"&&e.jsxs("div",{className:"flex items-center space-x-2 text-blue-700",children:[e.jsx(Ct,{size:14}),e.jsx("span",{className:"text-sm",children:"Proceed with e-signature"})]}),t.status==="e-sign_pending"&&e.jsxs("div",{className:"flex items-center space-x-2 text-blue-700",children:[e.jsx(va,{size:14}),e.jsx("span",{className:"text-sm",children:"Complete final processing"})]}),t.status==="completed"&&e.jsxs("div",{className:"flex items-center space-x-2 text-green-700",children:[e.jsx(bs,{size:14}),e.jsx("span",{className:"text-sm",children:"Document processing completed"})]})]})]})]}),r==="preview"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Document Preview"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx(ks,{size:14}),e.jsx("span",{children:"Full Screen"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"Download PDF"})]})]})]}),e.jsx("div",{className:"border border-gray-200 rounded-xl bg-gray-50 p-4",children:e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm max-h-96 overflow-auto",dangerouslySetInnerHTML:{__html:x()}})})]}),r==="sharing"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sharing Information"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Sharing Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.shared_channels.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Channels Used"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:((c=t.tracking_history)==null?void 0:c.filter(N=>N.action.includes("Shared")).length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Times Shared"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:((f=t.tracking_history)==null?void 0:f.filter(N=>N.action.includes("Viewed")).length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Times Viewed"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Sharing History"}),(p=t.tracking_history)==null?void 0:p.filter(N=>N.action.includes("Shared")).map(N=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${v(N.stage)}`,children:d(N.icon)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:N.action}),e.jsx("div",{className:"text-sm text-gray-600",children:N.details})]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:g(N.timestamp)})]})},N.id))]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Quick Share"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(tt,{className:"text-green-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"WhatsApp"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Send via WhatsApp"})]})]}),e.jsxs("button",{className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Ds,{className:"text-blue-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Email"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Send via Email"})]})]}),e.jsxs("button",{className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Cs,{className:"text-purple-600",size:20}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"SMS"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Send via SMS"})]})]})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",g(t.updated_at)]}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})})]})})},IN=({isOpen:s,onClose:a,document:t,onShare:r})=>{var C,J,ue;const[i,n]=l.useState([]),[o,m]=l.useState([]),[g,b]=l.useState({id:0,name:"",contact:"",type:"phone",role:"Custom"}),[d,v]=l.useState(!1),[x,u]=l.useState([]),[c,f]=l.useState("both"),[p,N]=l.useState(""),[P,w]=l.useState("");if(!s||!t)return null;const $=(t==null?void 0:t.data)||{},y=Q=>i.includes(Q),k=Q=>{const he=Number(Q);return Number.isFinite(he)?he.toLocaleString("en-IN"):""},R=l.useMemo(()=>{const Q=new Set;return y("email")&&Q.add("email"),(y("whatsapp")||y("sms"))&&Q.add("phone"),i.length===0&&(Q.add("phone"),Q.add("email")),Q},[i]),F=Q=>String(Q).replace(/\D/g,""),T=()=>{const Q=String(t.title||"").toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");return`https://resaleexpert.com/document/${$.document_id??""}/${Q}`},j={doc:()=>`Document: ${t.title??""}`,id:()=>`Document ID: ${$.document_id??""}`,date:()=>`Date: ${$.document_date??""}`,propHeader:()=>"Property Details:",addr:()=>`â€¢ Address: ${$.property_address??""}`,type:()=>`â€¢ Type: ${$.property_type??""}`,area:()=>`â€¢ Area: ${$.property_area?`${$.property_area} sq ft`:""}`,saleAmount:()=>$.sale_amount?`â€¢ Sale Amount: â‚¹${k($.sale_amount)}`:"",tokenAmount:()=>$.token_amount?`â€¢ Token Amount: â‚¹${k($.token_amount)}`:"",bookingAmount:()=>$.booking_amount?`â€¢ Booking Amount: â‚¹${k($.booking_amount)}`:"",footerA:()=>`Best regards,
${$.sales_executive||"ResaleExpert Team"}`,footerB:()=>`---
ResaleExpert - Your Trusted Real Estate Partner
Contact: +91 99999 99999
www.resaleexpert.com`},E=()=>[j.propHeader(),j.addr(),j.type(),j.area(),j.saleAmount(),j.tokenAmount(),j.bookingAmount(),$.buyer_name?`
Buyer: ${$.buyer_name}${$.buyer_phone?` â€¢ ${$.buyer_phone}`:""}`:""].filter(Boolean).join(`
`),V=()=>[j.propHeader(),j.addr(),j.type(),j.area(),j.saleAmount(),j.tokenAmount(),j.bookingAmount(),$.seller_name?`
Seller: ${$.seller_name}${$.seller_phone?` â€¢ ${$.seller_phone}`:""}`:""].filter(Boolean).join(`
`),W=(Q,he)=>{const se=he??(Q==="Seller"?$.seller_name&&String($.seller_name).trim()||"Client":$.buyer_name&&String($.buyer_name).trim()||"Client"),ge=Q==="Seller"?E():V();return[`Dear ${se},`,"",`Please find attached the ${t.template_name??"document"} for your review.`,"",j.doc(),j.id(),j.date(),"",ge,"","Please review the document and let us know if you have any questions.","",j.footerA(),"",j.footerB()].join(`
`)},B=(Q,he)=>{const se=he??(Q==="Seller"?$.seller_name&&String($.seller_name).trim()||"Client":$.buyer_name&&String($.buyer_name).trim()||"Client"),ge=T();return[`Hi ${se},`,`${t.template_name??"Document"}: ${t.title??""}`,`ID: ${$.document_id??""} â€¢ ${$.document_date??""}`,`Link: ${ge}`].join(`
`)},M=(Q,he)=>{const se=he??(Q==="Seller"?$.seller_name&&String($.seller_name).trim()||"Client":$.buyer_name&&String($.buyer_name).trim()||"Client"),ge=T(),ee=Q==="Seller"?$.buyer_name?`- Buyer: ${$.buyer_name}${$.buyer_phone?` â€¢ ${$.buyer_phone}`:""}`:"":$.seller_name?`- Seller: ${$.seller_name}${$.seller_phone?` â€¢ ${$.seller_phone}`:""}`:"",de=[$.sale_amount?`- Sale Amount: â‚¹${k($.sale_amount)}`:"",$.token_amount?`- Token Amount: â‚¹${k($.token_amount)}`:"",$.booking_amount?`- Booking Amount: â‚¹${k($.booking_amount)}`:""].filter(Boolean).join(`
`);return[`Dear ${se},`,"",`Please find attached the ${t.template_name??"document"} for your review.`,"",`*Document:* ${t.title??""}`,`*Document ID:* ${$.document_id??""}`,`*Date:* ${$.document_date??""}`,"","*Property Details:*",`- Address: ${$.property_address??""}`,`- Type: ${$.property_type??""}`,`- Area: ${$.property_area?`${$.property_area} sq ft`:""}`,de||"",ee?`
${ee}`:"","",`*Link:* ${ge}`,"","Please review the document and let us know if you have any questions.","","Best regards,",`${$.sales_executive||"ResaleExpert Team"}`,"","---","ResaleExpert - Your Trusted Real Estate Partner","Contact: +91 99999 99999","www.resaleexpert.com"].filter(Boolean).join(`
`)},A=(Q,he,se)=>he==="whatsapp"?M(se,Q):he==="sms"?B(se,Q):W(se,Q);l.useEffect(()=>{const Q=[];$.seller_name&&$.seller_phone&&Q.push({id:"seller_phone",name:$.seller_name,contact:String($.seller_phone),type:"phone",role:"Seller"}),$.seller_name&&$.seller_email&&Q.push({id:"seller_email",name:$.seller_name,contact:String($.seller_email),type:"email",role:"Seller"}),$.buyer_name&&$.buyer_phone&&Q.push({id:"buyer_phone",name:$.buyer_name,contact:String($.buyer_phone),type:"phone",role:"Buyer"}),$.buyer_name&&$.buyer_email&&Q.push({id:"buyer_email",name:$.buyer_name,contact:String($.buyer_email),type:"email",role:"Buyer"}),m(Q)},[t==null?void 0:t.id]),l.useEffect(()=>{N(W("Seller")),w(W("Buyer"))},[t==null?void 0:t.id]);const L={green:{border:"border-green-500",bg:"bg-green-50",text:"text-green-600",textStrong:"text-green-900",check:"text-green-600",borderIdle:"border-gray-200",hoverBorder:"hover:border-gray-300",textIdle:"text-gray-600"},blue:{border:"border-blue-500",bg:"bg-blue-50",text:"text-blue-600",textStrong:"text-blue-900",check:"text-blue-600",borderIdle:"border-gray-200",hoverBorder:"hover:border-gray-300",textIdle:"text-gray-600"},purple:{border:"border-purple-500",bg:"bg-purple-50",text:"text-purple-600",textStrong:"text-purple-900",check:"text-purple-600",borderIdle:"border-gray-200",hoverBorder:"hover:border-gray-300",textIdle:"text-gray-600"},indigo:{border:"border-indigo-500",bg:"bg-indigo-50",text:"text-indigo-600",textStrong:"text-indigo-900",check:"text-indigo-600",borderIdle:"border-gray-200",hoverBorder:"hover:border-gray-300",textIdle:"text-gray-600"}},D=[{id:"whatsapp",label:"WhatsApp",icon:Yn,color:"green",description:"Send via WhatsApp with rich formatting"},{id:"email",label:"Email",icon:Ds,color:"blue",description:"Send detailed email with document attachment"},{id:"sms",label:"SMS",icon:Cs,color:"purple",description:"Send SMS with document link"},{id:"public_link",label:"Public Link",icon:_t,color:"indigo",description:"Generate shareable public link"}],I=Q=>{n(he=>he.includes(Q)?he.filter(se=>se!==Q):[...he,Q])},H=()=>{if(g.name.trim()&&g.contact.trim()){m(he=>[...he,{...g,id:Date.now()}]);const Q=y("email")&&!(y("whatsapp")||y("sms"))?"email":"phone";b({id:0,name:"",contact:"",type:Q,role:"Custom"})}},h=Q=>{m(he=>he.filter(se=>se.id!==Q))},Y=l.useMemo(()=>o.filter(se=>c==="both"?!0:c==="seller"?se.role==="Seller"||se.role==="Custom":c==="buyer"?se.role==="Buyer"||se.role==="Custom":!0).filter(se=>R.has(se.type)),[o,c,R]),K=Y.length,q=i.length,ne=(Q,he)=>{const se=Q.role==="Seller"?"Seller":"Buyer";return Q.role==="Custom"?A(Q.name,he,se):he==="whatsapp"?M(se):he==="sms"?B(se):se==="Seller"?p||W("Seller"):P||W("Buyer")},le=async()=>{if(q===0){alert("Please select at least one sharing channel");return}if(K===0&&!y("public_link")){alert("Please add/select at least one recipient (based on your filters).");return}v(!0),u([]);try{const Q=[];for(const he of i){if(await new Promise(se=>setTimeout(se,200)),he==="whatsapp"){const se=Y.filter(ge=>ge.type==="phone");for(const ge of se){const ee=ne(ge,"whatsapp"),de=`https://wa.me/${F(ge.contact)}?text=${encodeURIComponent(ee)}`;window.open(de,"_blank","noopener,noreferrer"),Q.push({channel:"WhatsApp",recipient:ge.name,contact:ge.contact,status:"sent",timestamp:new Date().toISOString()})}}if(he==="email"){const se=Y.filter(ge=>ge.type==="email");for(const ge of se){const ee=`${t.template_name??"Document"} - ${$.document_id??""}`,de=ne(ge,"email"),U=`mailto:${encodeURIComponent(ge.contact)}?subject=${encodeURIComponent(ee)}&body=${encodeURIComponent(de)}`;window.location.href=U,Q.push({channel:"Email",recipient:ge.name,contact:ge.contact,status:"sent",timestamp:new Date().toISOString()})}}if(he==="sms"){const se=Y.filter(ge=>ge.type==="phone");for(const ge of se){const ee=ne(ge,"sms");Q.push({channel:"SMS",recipient:ge.name,contact:ge.contact,status:"queued",timestamp:new Date().toISOString()})}}if(he==="public_link"){const se=T();await navigator.clipboard.writeText(se),Z.success("Public link copied!"),Q.push({channel:"Public Link",recipient:"Link copied",contact:se,status:"generated",timestamp:new Date().toISOString()})}}u(Q);try{await ua.createShareBatch(t.id,{channels:i,message:p||P||"",public_link:T(),recipients:Y.map(se=>({recipient_name:se.name,recipient_type:se.type,recipient_value:se.contact,role:se.role,channel:i[0]||"unknown",status:"sent"}))});const he=await ua.getSnapshot(t.id);r==null||r({document_id:t.id,channels:i,recipients:Y,results:Q,snapshot:he,shared_at:new Date().toISOString()}),Z.success('Share recorded and status updated to "Shared" âœ…')}catch(he){console.error("Failed to log share batch or update snapshot:",he),Z.error("Backend share log failed (status may not update)")}}catch(Q){console.error("Sharing failed:",Q),Z.error("Sharing failed. Check console for details.")}finally{v(!1)}},S=async Q=>{try{await navigator.clipboard.writeText(Q)}catch{const he=t.createElement("textarea");he.value=Q,he.style.position="fixed",he.style.left="-9999px",t.body.appendChild(he),he.select(),t.execCommand("copy"),t.body.removeChild(he)}Z.success("Copied to clipboard!")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 !mt-0",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Wt,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-gray-900 text-xs",children:"Share Document"}),e.jsx("p",{className:"text-gray-600 mt-1 text-xs",children:t.title})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-xs",children:"Document Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Document:"}),e.jsx("span",{className:"font-semibold ml-2 text-xs",children:(C=t==null?void 0:t.data)==null?void 0:C.document_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Template:"}),e.jsx("span",{className:"font-semibold ml-2 text-xs",children:t.template_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Seller:"}),e.jsx("span",{className:"font-semibold ml-2 text-xs",children:(J=t==null?void 0:t.data)==null?void 0:J.seller_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Property:"}),e.jsx("span",{className:"font-semibold ml-2 text-xs",children:(ue=t==null?void 0:t.data)==null?void 0:ue.property_type})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-xs",children:"Select Sharing Channels"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:D.map(Q=>{const he=Q.icon,se=i.includes(Q.id),ge=L[Q.color];return e.jsxs("button",{onClick:()=>I(Q.id),className:`p-4 rounded-xl border-2 transition-all text-left ${se?`${ge.border} ${ge.bg}`:`${ge.borderIdle} ${ge.hoverBorder}`}`,children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(he,{size:20,className:se?`${ge.text}`:"text-gray-400"}),e.jsx("span",{className:`font-medium text-xs ${se?`${ge.textStrong}`:`${ge.textIdle}`}`,children:Q.label}),se&&e.jsx(_a,{size:16,className:`${ge.check}`})]}),e.jsx("p",{className:"text-xs text-gray-500",children:Q.description})]},Q.id)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-xs",children:"Recipients"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[10px] text-gray-600 mb-1",children:"Show"}),e.jsxs("select",{value:c,onChange:Q=>f(Q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:[e.jsx("option",{value:"seller",children:"Only Seller"}),e.jsx("option",{value:"buyer",children:"Only Buyer"}),e.jsx("option",{value:"both",children:"Both"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2 text-xs",children:"Add Custom Recipient"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx("input",{type:"text",value:g.name,onChange:Q=>b({...g,name:Q.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"Recipient name"}),e.jsx("input",{type:"text",value:g.contact,onChange:Q=>b({...g,contact:Q.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:y("email")&&!(y("whatsapp")||y("sms"))?"Email":"Phone"}),e.jsxs("select",{value:g.type,onChange:Q=>b({...g,type:Q.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:[R.has("phone")&&e.jsx("option",{value:"phone",children:"Phone"}),R.has("email")&&e.jsx("option",{value:"email",children:"Email"})]}),e.jsx("button",{onClick:H,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:e.jsx(fs,{size:16})})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[Y.map(Q=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:Q.type==="email"?e.jsx(Ds,{size:16,className:"text-blue-600"}):e.jsx(Cs,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 text-xs",children:Q.name}),e.jsx("div",{className:"text-xs text-gray-600",children:Q.contact})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:Q.role}),e.jsx("button",{onClick:()=>h(Q.id),className:"text-red-600 hover:text-red-800",children:e.jsx(ns,{size:16})})]})]},Q.id)),Y.length===0&&e.jsx("div",{className:"p-3 text-xs text-gray-500 border border-dashed border-gray-300 rounded-lg",children:"No recipients to show for the current filters."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-xs",children:"Message"}),c==="both"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[11px] font-medium text-gray-700",children:"Seller Message (Email template)"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:()=>N(W("Seller")),className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-[11px] hover:bg-blue-200",children:"Use Default"}),e.jsxs("button",{onClick:()=>S(p||W("Seller")),className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-[11px] hover:bg-gray-200",children:[e.jsx(Xt,{size:12,className:"inline mr-1"}),"Copy"]})]})]}),e.jsx("textarea",{value:p||W("Seller"),onChange:Q=>N(Q.target.value),className:"w-full h-40 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[11px] font-medium text-gray-700",children:"Buyer Message (Email template)"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:()=>w(W("Buyer")),className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-[11px] hover:bg-blue-200",children:"Use Default"}),e.jsxs("button",{onClick:()=>S(P||W("Buyer")),className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-[11px] hover:bg-gray-200",children:[e.jsx(Xt,{size:12,className:"inline mr-1"}),"Copy"]})]})]}),e.jsx("textarea",{value:P||W("Buyer"),onChange:Q=>w(Q.target.value),className:"w-full h-40 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none text-xs"})]})]}):c==="seller"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>N(W("Seller")),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-xs hover:bg-blue-200",children:"Use Default (Seller)"}),e.jsxs("button",{onClick:()=>S(p||W("Seller")),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:[e.jsx(Xt,{size:12,className:"inline mr-1"}),"Copy"]})]}),e.jsx("textarea",{value:p||W("Seller"),onChange:Q=>N(Q.target.value),className:"w-full h-40 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none text-xs"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>w(W("Buyer")),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-xs hover:bg-blue-200",children:"Use Default (Buyer)"}),e.jsxs("button",{onClick:()=>S(P||W("Buyer")),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:[e.jsx(Xt,{size:12,className:"inline mr-1"}),"Copy"]})]}),e.jsx("textarea",{value:P||W("Buyer"),onChange:Q=>w(Q.target.value),className:"w-full h-40 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none text-xs"})]})]}),x.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-xs",children:"Sharing Results"}),e.jsx("div",{className:"space-y-2",children:x.map((Q,he)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_a,{className:"text-green-600",size:16}),e.jsxs("span",{className:"text-xs font-medium text-green-800",children:[Q.channel," - ",Q.recipient]}),Q.contact&&e.jsxs("span",{className:"text-xs text-green-600",children:["(",Q.contact,")"]})]}),e.jsx("span",{className:"text-xs text-green-600 uppercase font-medium",children:Q.status})]},he))})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl py-2 px-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3 text-xs",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>{const Q=T();S(Q)},className:"flex items-center space-x-2 p-3 bg-white border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(za,{className:"text-blue-600",size:16}),e.jsx("span",{className:"text-blue-800 font-medium text-xs",children:"Copy Public Link"})]}),e.jsxs("button",{onClick:()=>{const Q=T(),he=window.open("","_blank");he&&he.document.write(`
                      <html>
                        <head><title>QR Code - ${t.title??""}</title></head>
                        <body style="text-align: center; padding: 20px; font-family: Arial, sans-serif;">
                          <h2 style="font-size:12px;margin:0 0 8px 0">${t.title??""}</h2>
                          <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(Q)}" alt="QR Code" style="margin: 12px;">
                          <p style="font-size: 12px; color: #666;">Scan to view document</p>
                          <p style="font-size: 10px; color: #666;">${Q}</p>
                        </body>
                      </html>
                    `)},className:"flex items-center space-x-2 p-3 bg-white border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(an,{className:"text-blue-600",size:16}),e.jsx("span",{className:"text-blue-800 font-medium text-xs",children:"Generate QR Code"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[q," channel",q!==1?"s":""," selected â€¢ ",K," recipient",K!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-xs",children:"Cancel"}),e.jsx("button",{onClick:le,disabled:q===0||K===0&&!y("public_link")||d,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:d?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{size:16,className:"animate-spin"}),e.jsx("span",{children:"Sharing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"Share Now"})]})})]})]})})]})})},vx=s=>(s==="e-sign_pending"?"esign_pending":s)||"created",tc=["created","shared","on_hold","otp_verified","esign_pending","completed","cancelled"],ac={created:"Created",shared:"Shared",on_hold:"On Hold",cancelled:"Cancelled",otp_verified:"OTP Verified",esign_pending:"E-Sign Pending",completed:"Completed"},$N={created:{ring:"ring-gray-300",fill:"bg-gray-100",text:"text-gray-700",line:"bg-gray-200"},shared:{ring:"ring-purple-300",fill:"bg-purple-100",text:"text-purple-700",line:"bg-purple-200"},on_hold:{ring:"ring-yellow-300",fill:"bg-yellow-100",text:"text-yellow-700",line:"bg-yellow-200"},cancelled:{ring:"ring-red-300",fill:"bg-red-100",text:"text-red-700",line:"bg-red-200"},otp_verified:{ring:"ring-blue-300",fill:"bg-blue-100",text:"text-blue-700",line:"bg-blue-200"},esign_pending:{ring:"ring-orange-300",fill:"bg-orange-100",text:"text-orange-700",line:"bg-orange-200"},completed:{ring:"ring-green-300",fill:"bg-green-100",text:"text-green-700",line:"bg-green-200"}};function EN({docId:s,currentStatus:a,onSynced:t,disabled:r,onRequestStep:i}){const n=vx(a),[o,m]=l.useState(null),g=l.useMemo(()=>Math.max(0,tc.indexOf(n)),[n]),b=v=>!(r||o||n==="completed"&&v==="cancelled");l.useEffect(()=>{const v=x=>{};return window.addEventListener("doc:status",v),()=>window.removeEventListener("doc:status",v)},[]);const d=async v=>{if(n==="completed"&&v==="cancelled"){Z.info("This document is already completed and cannot be cancelled.");return}if(!(i&&i(v)))try{m(v);const x={new_status:v,reason:`Changed via status stepper to ${v}`,details:{source:"ui-status-stepper"},changed_by:null};await ua.setStatus(s,x);const u=await ua.getSnapshot(s);t==null||t({id:s,status:vx((u==null?void 0:u.current_status)||v),progress:typeof(u==null?void 0:u.progress_pct)=="number"?u.progress_pct:void 0,updated_at:u==null?void 0:u.updated_at}),Z.success(`Status â†’ ${ac[v]}`)}catch(x){console.error(x),Z.error((x==null?void 0:x.message)||"Failed to update status")}finally{m(null)}};return e.jsx("div",{className:"flex items-center gap-2",children:tc.map((v,x)=>{const u=x<=g,c=b(v),f=$N[v];return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>c&&d(v),title:ac[v],className:["w-8 h-8 rounded-full flex items-center justify-center border transition-all",u?"border-green-500 bg-green-100":`border-gray-300 ${f.fill}`,c?"hover:ring-2 "+f.ring:"opacity-60 cursor-not-allowed"].join(" "),disabled:!c,children:u?e.jsx(bs,{size:16,className:"text-green-600"}):e.jsx(Ls,{size:16,className:f.text})}),e.jsx("div",{className:["text-[11px] font-medium",u?"text-green-700":f.text].join(" "),children:ac[v]}),x<tc.length-1&&e.jsx("div",{className:["w-6 h-0.5 rounded-full",x<g?"bg-green-400":f.line].join(" ")})]},v)})})}const MN=({isOpen:s,documentId:a,defaultBuyer:t,defaultSeller:r,defaultExecutive:i,onClose:n,onVerified:o})=>{const[m,g]=l.useState(""),b=l.useMemo(()=>!!(t&&(t.name||t.email||t.phone)),[t]),d=l.useMemo(()=>!!(r&&(r.name||r.email||r.phone)),[r]),v=b&&!d?!0:!(d&&!b),x=d&&!b?!0:!(b&&!d),[u,c]=l.useState((t==null?void 0:t.name)||""),[f,p]=l.useState((t==null?void 0:t.email)||""),[N,P]=l.useState((t==null?void 0:t.phone)||""),[w,$]=l.useState(t!=null&&t.email?"email":"sms"),[y,k]=l.useState(""),[R,F]=l.useState(!1),[T,j]=l.useState(!1),[E,V]=l.useState(!1),[W,B]=l.useState(0),[M,A]=l.useState((r==null?void 0:r.name)||""),[L,D]=l.useState((r==null?void 0:r.email)||""),[I,H]=l.useState((r==null?void 0:r.phone)||""),[h,Y]=l.useState(r!=null&&r.email?"email":"sms"),[K,q]=l.useState(""),[ne,le]=l.useState(!1),[S,C]=l.useState(!1),[J,ue]=l.useState(!1),[Q,he]=l.useState(0);l.useEffect(()=>{if(!s){se();return}c((t==null?void 0:t.name)||""),p((t==null?void 0:t.email)||""),P((t==null?void 0:t.phone)||""),A((r==null?void 0:r.name)||""),D((r==null?void 0:r.email)||""),H((r==null?void 0:r.phone)||""),$(t!=null&&t.email?"email":"sms"),Y(r!=null&&r.email?"email":"sms"),ge()},[s,a,t,r]);const se=l.useCallback(()=>{V(!1),ue(!1),k(""),q(""),g(""),B(0),he(0)},[]),ge=async()=>{try{const Le=await ua.getOtpSessionsByDocument(a,{verified:!0}),je=Le==null?void 0:Le.find(ve=>ve.role==="buyer"&&ve.verified_at),_e=Le==null?void 0:Le.find(ve=>ve.role==="seller"&&ve.verified_at);je&&v&&V(!0),_e&&x&&ue(!0)}catch(Le){console.error("Error fetching verification status:",Le)}};l.useEffect(()=>{if(!s)return;const Le=setInterval(()=>{B(je=>je>0?je-1:0),he(je=>je>0?je-1:0)},1e3);return()=>clearInterval(Le)},[s]);const ee=Le=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Le),de=Le=>/^\+?[\d\s-()]{10,}$/.test(Le.replace(/\s/g,"")),U=async()=>{try{if(w==="sms"&&!de(N)){Z.error("Please enter a valid buyer phone number");return}if(w==="email"&&!ee(f)){Z.error("Please enter a valid buyer email address");return}F(!0),await ua.requestOtp(a,{role:"buyer",channel:w,to:w==="sms"?N:f,name:u||"Buyer"}),Z.success(`Buyer OTP sent via ${w.toUpperCase()}`),B(60)}catch(Le){console.error("Buyer OTP send error:",Le),Z.error((Le==null?void 0:Le.message)||"Failed to send OTP to buyer")}finally{F(!1)}},X=async()=>{if(!y.trim()){Z.error("Please enter the OTP received by buyer");return}try{j(!0),await ua.verifyOtp(a,{role:"buyer",code:y.trim()}),E||Z.success("Buyer verified successfully âœ…"),V(!0),G()}catch(Le){console.error("Buyer OTP verification error:",Le),Z.error((Le==null?void 0:Le.message)||"Buyer verification failed")}finally{j(!1)}},re=async()=>{try{if(h==="sms"&&!de(I)){Z.error("Please enter a valid seller phone number");return}if(h==="email"&&!ee(L)){Z.error("Please enter a valid seller email address");return}le(!0),await ua.requestOtp(a,{role:"seller",channel:h,to:h==="sms"?I:L,name:M||"Seller"}),Z.success(`Seller OTP sent via ${h.toUpperCase()}`),he(60)}catch(Le){console.error("Seller OTP send error:",Le),Z.error((Le==null?void 0:Le.message)||"Failed to send OTP to seller")}finally{le(!1)}},fe=async()=>{if(!K.trim()){Z.error("Please enter the OTP received by seller");return}try{C(!0),await ua.verifyOtp(a,{role:"seller",code:K.trim()}),J||Z.success("Seller verified successfully âœ…"),ue(!0),G()}catch(Le){console.error("Seller OTP verification error:",Le),Z.error((Le==null?void 0:Le.message)||"Seller verification failed")}finally{C(!1)}},G=()=>{},me=()=>E&&J&&(v&&x)?"Continue (Both Verified)":E?"Continue (Buyer Verified)":J?"Continue (Seller Verified)":"Continue (Not Verified)",oe=v&&E||x&&J,Fe=()=>{const Le={note:m.trim()||void 0,defaultExecutive:i};v&&(u||E)&&(Le.buyer={name:u,email:f,phone:N,channel:w,verified:E}),x&&(M||J)&&(Le.seller={name:M,email:L,phone:I,channel:h,verified:J}),o(Le)},$e=()=>{se(),n()};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-2xl shadow-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Verify Parties"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Verify at least one party (",v&&"buyer",v&&x&&" or ",x&&"seller",") to continue"]})]}),e.jsx("button",{onClick:$e,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(ns,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[v&&e.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["Buyer Details ",!E&&"(Optional)"]}),E?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-green-100 text-green-800 rounded-full px-2 py-1",children:[e.jsx(bs,{size:12})," Verified"]}):e.jsx("span",{className:"text-xs text-gray-500",children:"Not verified"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[e.jsx("input",{value:u,onChange:Le=>c(Le.target.value),placeholder:"Buyer name",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:E}),e.jsx("input",{type:"email",value:f,onChange:Le=>p(Le.target.value),placeholder:"Buyer email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:E}),e.jsx("input",{type:"tel",value:N,onChange:Le=>P(Le.target.value),placeholder:"Buyer phone",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:E})]}),!E&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Send via:"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:w==="sms",onChange:()=>$("sms"),className:"text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm",children:"SMS"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:w==="email",onChange:()=>$("email"),disabled:!f.trim(),className:"text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),e.jsx("span",{className:"text-sm",children:"Email"})]}),e.jsx("button",{onClick:U,disabled:R||W>0||w==="sms"&&!de(N)||w==="email"&&!ee(f),className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:R?"Sendingâ€¦":W>0?`Resend (${W}s)`:"Send OTP"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{value:y,onChange:Le=>k(Le.target.value),placeholder:"Enter OTP received by buyer",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",maxLength:6}),e.jsx("button",{onClick:X,disabled:T||E||!y.trim(),className:"bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:T?"Verifyingâ€¦":"Verify"})]})]})]}),x&&e.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["Seller Details ",!J&&"(Optional)"]}),J?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-green-100 text-green-800 rounded-full px-2 py-1",children:[e.jsx(bs,{size:12})," Verified"]}):e.jsx("span",{className:"text-xs text-gray-500",children:"Not verified"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[e.jsx("input",{value:M,onChange:Le=>A(Le.target.value),placeholder:"Seller name",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:J}),e.jsx("input",{type:"email",value:L,onChange:Le=>D(Le.target.value),placeholder:"Seller email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:J}),e.jsx("input",{type:"tel",value:I,onChange:Le=>H(Le.target.value),placeholder:"Seller phone",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:J})]}),!J&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Send via:"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:h==="sms",onChange:()=>Y("sms"),className:"text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm",children:"SMS"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:h==="email",onChange:()=>Y("email"),disabled:!L.trim(),className:"text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),e.jsx("span",{className:"text-sm",children:"Email"})]}),e.jsx("button",{onClick:re,disabled:ne||Q>0||h==="sms"&&!de(I)||h==="email"&&!ee(L),className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:ne?"Sendingâ€¦":Q>0?`Resend (${Q}s)`:"Send OTP"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{value:K,onChange:Le=>q(Le.target.value),placeholder:"Enter OTP received by seller",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",maxLength:6}),e.jsx("button",{onClick:fe,disabled:S||J||!K.trim(),className:"bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:S?"Verifyingâ€¦":"Verify"})]})]})]}),(v&&E||x&&J)&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Verification Summary"}),e.jsx("div",{className:"text-sm text-blue-700 space-y-1",children:v&&E&&x&&J?e.jsx("p",{children:"âœ… Both buyer and seller are verified"}):v&&E?e.jsxs("p",{children:["âœ… Buyer is verified"," ",x&&M&&"(Seller details captured but not verified)"]}):e.jsxs("p",{children:["âœ… Seller is verified"," ",v&&u&&"(Buyer details captured but not verified)"]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes (Optional)"}),e.jsx("textarea",{value:m,onChange:Le=>g(Le.target.value),rows:3,className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Add any notes about the verification process (e.g., OTP received on buyer's phone, partial verification details, etc.)"})]})]}),e.jsx("div",{className:"border-t border-gray-200 p-6 bg-gray-50 shrink-0",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:$e,className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"Cancel"}),e.jsx("button",{onClick:Fe,disabled:!oe,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:me()})]})})]})}):null};async function LN(s){var a;try{const{data:t}=await Ae.post("/digio/uploadpdf",s);return t}catch(t){return{success:!1,error:((a=t==null?void 0:t.response)==null?void 0:a.data)||(t==null?void 0:t.message)}}}async function jg(s,a){var t;try{const r=typeof a<"u"&&a!==null?`/digio/document/${encodeURIComponent(s)}?local_document_id=${encodeURIComponent(String(a))}`:`/digio/document/${encodeURIComponent(s)}`,{data:i}=await Ae.get(r);return i}catch(r){return{success:!1,error:((t=r==null?void 0:r.response)==null?void 0:t.data)||(r==null?void 0:r.message)}}}async function DN(s,a,t=!1){const r=`/digio/document/${encodeURIComponent(s)}/download?inline=${t?"1":"0"}`,i=await Ae.get(r,{responseType:"blob"}),n=new Blob([i.data],{type:i.headers["content-type"]||"application/pdf"}),o=a||`${s}.pdf`,m=document.createElement("a");m.href=URL.createObjectURL(n),m.download=o,document.body.appendChild(m),m.click(),m.remove(),URL.revokeObjectURL(m.href)}async function Ic(s){var a;try{const{data:t}=await Ae.get(`/digio/status/${encodeURIComponent(String(s))}`);return t}catch(t){return{success:!1,error:((a=t==null?void 0:t.response)==null?void 0:a.data)||(t==null?void 0:t.message)}}}const Nx=globalThis;Nx.__pdfjsWorkerSet__||(Tu.workerSrc=new URL("/assets/mjs/pdf.worker.min-qwK7q_zL.mjs",import.meta.url).toString(),Nx.__pdfjsWorkerSet__=!0);const Pn=(s="")=>`${s}${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`,RN=s=>/\S+@\S+\.\S+/.test(s),zN=s=>/^\+?\d{7,15}$/.test(s),jr={success:console.log,error:console.error,info:console.info};function FN(s){try{const a=s.includes(",")?s.split(",")[1]:s,t=atob(a.replace(/\s/g,"")),r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}catch(a){return console.error("base64ToUint8 failed:",a),new Uint8Array}}function BN(s){let a="";for(let t=0;t<s.length;t++)a+=String.fromCharCode(s[t]);return btoa(a)}function ON({json:s,onClose:a,textareaRef:t}){const r=l.useRef(null);l.useEffect(()=>{const m=g=>{g.key==="Escape"&&a()};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[a]);const i=m=>{m.target===r.current&&a()},n=async()=>{try{await navigator.clipboard.writeText(s||"{}"),jr.success("Coordinates copied to clipboard.")}catch{jr.error("Copy failed.")}},o=()=>{try{const m=new Blob([s||"{}"],{type:"application/json;charset=utf-8"}),g=URL.createObjectURL(m),b=document.createElement("a");b.href=g,b.download=`esign-coordinates-${new Date().toISOString().slice(0,19).replace(/[:T]/g,"-")}.json`,document.body.appendChild(b),b.click(),b.remove(),URL.revokeObjectURL(g)}catch{jr.error("Download failed.")}};return e.jsx("div",{ref:r,onMouseDown:i,className:"fixed inset-0 z-[999] bg-black/50 flex items-center justify-center px-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-2xl shadow-2xl overflow-hidden",onMouseDown:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h4",{className:"text-base font-semibold",children:"Generated Coordinates (Digio JSON)"}),e.jsx("button",{onClick:a,className:"p-2 rounded hover:bg-gray-100","aria-label":"Close",children:e.jsx(ns,{size:18})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Read-only preview. Copy or download to use in the API payload."}),e.jsx("textarea",{ref:t,value:s,readOnly:!0,className:"w-full h-80 text-xs font-mono border rounded-lg p-3 bg-gray-50",spellCheck:!1})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t bg-gray-50",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Tip: Boxes are drawn in screen px; JSON is normalized to PDF points with origin bottom-left."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:n,className:"inline-flex items-center gap-2 px-3 py-1.5 text-xs border rounded-lg hover:bg-gray-100",children:[e.jsx(Xt,{size:14})," Copy"]}),e.jsxs("button",{onClick:o,className:"inline-flex items-center gap-2 px-3 py-1.5 text-xs bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Ys,{size:14})," Download"]})]})]})]})})}function UN({status:s,digioResponse:a,onCreateNewRequest:t,onClose:r}){return s==="idle"||s==="creating"?null:e.jsx("div",{className:"fixed inset-0 z-[1000] bg-black/50 flex items-center justify-center px-4",children:e.jsx("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-2xl p-6",children:e.jsx("div",{className:"text-center",children:s==="created"&&a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Un,{className:"text-green-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Request Created Successfully!"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Your e-sign request has been submitted to Digio."}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left mb-4",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Request Details:"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Digio ID:"})," ",a.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",a.agreement_status||"requested"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"File:"})," ",a.file_name]}),a.signing_parties&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Signers:"})," ",a.signing_parties.length]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"Close & Monitor Status"}),e.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:"Create New Request"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ns,{className:"text-red-600",size:24})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Request Failed"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"There was an error creating your e-sign request."}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"Try Again"}),e.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:"Close"})]})]})})})})}function qN({isOpen:s,onClose:a,documentId:t,defaultBuyer:r,defaultSeller:i,onProgress:n,onBothSigned:o}){const[m,g]=l.useState(null),[b,d]=l.useState("Document.pdf"),[v,x]=l.useState(!1),[u,c]=l.useState(""),[f,p]=l.useState(""),[N,P]=l.useState(null),[w,$]=l.useState(1),[y,k]=l.useState(null),[R,F]=l.useState(1),T=l.useRef({}),j=l.useMemo(()=>m?{data:new Uint8Array(m)}:null,[m]),E=l.useMemo(()=>m?`pdf-${m.length}-${m[0]??0}`:"none",[m]),[V,W]=l.useState("{}"),B=l.useRef(null),[M,A]=l.useState(!1),[L,D]=l.useState(!1),[I,H]=l.useState(null),[h,Y]=l.useState({}),[K,q]=l.useState(null),[ne,le]=l.useState(null),[S,C]=l.useState(null),[J,ue]=l.useState(null),[Q,he]=l.useState("idle"),[se,ge]=l.useState(null),ee=l.useRef(null),de=l.useRef({}),U=l.useRef({}),[X,re]=l.useState([{id:Pn("buyer-"),role:"Buyer",name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",phone:(r==null?void 0:r.phone)||"",reason:"Reason for Verification",index:0,identifierType:r!=null&&r.email?"email":r!=null&&r.phone?"phone":void 0},{id:Pn("seller-"),role:"Seller",name:(i==null?void 0:i.name)||"",email:(i==null?void 0:i.email)||"",phone:(i==null?void 0:i.phone)||"",reason:"Reason for Verification",index:1,identifierType:i!=null&&i.email?"email":i!=null&&i.phone?"phone":void 0}]),[fe,G]=l.useState([]);l.useEffect(()=>{s&&G(ye=>ye.length?ye:X.map(Ce=>Ce.id))},[s,X]),l.useEffect(()=>{s&&(he("idle"),ge(null))},[s]),l.useEffect(()=>{if(!s||!t)return;let ye=!0;return(async()=>{var _,ae,ke,Me;x(!0),P(null),c(""),p(""),g(null),$(1),k(null),T.current={},Y({}),W("{}");try{const Ye=await ot.getById(t),ie=(Ye==null?void 0:Ye.pdf_base64)||((_=Ye==null?void 0:Ye.data)==null?void 0:_.pdf_base64)||((ae=Ye==null?void 0:Ye.data)==null?void 0:ae.pdfBase64),we=(Ye==null?void 0:Ye.file_name)||((ke=Ye==null?void 0:Ye.data)==null?void 0:ke.file_name)||((Me=Ye==null?void 0:Ye.data)==null?void 0:Me.fileName);if(we&&d(we),!ie)throw new Error("API must return pdf_base64 for this viewer.");const Be=FN(ie);if(!ye)return;if(!Be||!Be.length)throw new Error("Invalid PDF bytes");g(new Uint8Array(Be))}catch(Ye){if(console.error("âŒ PDF load error:",Ye),!ye)return;c((Ye==null?void 0:Ye.message)||"Failed to load PDF")}finally{ye&&x(!1)}})(),()=>{ye=!1}},[s,t]);const me=async ye=>{var ae;const Ce=(ae=ye.target.files)==null?void 0:ae[0];if(!Ce)return;if(Ce.type!=="application/pdf"){jr.error("Please upload PDF only");return}const _=await Ce.arrayBuffer();g(new Uint8Array(_)),d(Ce.name||"Document.pdf"),p(""),c(""),$(1),k(null),T.current={},Y({}),W("{}")},oe=ye=>{try{const Ce=ye.getViewport({scale:1});T.current[ye.pageNumber]={width:Ce.width,height:Ce.height},y||k(Ce.width)}catch(Ce){console.warn("viewport read failed",Ce)}};l.useEffect(()=>{const ye=()=>{if(!y||!ee.current)return;const Ce=ee.current.clientWidth,ae=Math.max(320,Ce-32)/y;F(Math.min(2,Math.max(.4,ae)))};return ye(),window.addEventListener("resize",ye),()=>window.removeEventListener("resize",ye)},[y]);const Fe=ye=>["#3b82f6","#22c55e","#a855f7","#f59e0b","#ec4899","#06b6d4","#8b5cf6","#f97316"][X.findIndex(Ce=>Ce.id===ye)%8],$e=ye=>G(Ce=>Ce.includes(ye)?Ce.filter(_=>_!==ye):[...Ce,ye]),Le=ye=>ye.identifierType==="phone"?ye.phone.trim():ye.identifierType==="email"?ye.email.trim():"",je=ye=>{Y(Ce=>{const _=ye(Ce);return _e(_),_})},_e=(ye=h)=>{const Ce={},_=R||1;X.forEach(ke=>{if(!fe.includes(ke.id))return;const Me=Le(ke);if(!Me)return;const Ye=ye[ke.id]||[];Ye.length&&Ye.forEach(ie=>{var Oe,rs;const we=T.current[ie.page];if(!we)return;const Be=Math.round(ie.x/_),Ve=Math.round(we.height-(ie.y+ie.height)/_),Je=Math.round((ie.x+ie.width)/_),Ue=Math.round(we.height-ie.y/_);Ce[Me]||(Ce[Me]={}),((Oe=Ce[Me])[rs=String(ie.page)]||(Oe[rs]=[])).push({llx:Be,lly:Ve,urx:Je,ury:Ue})})});const ae=JSON.stringify(Ce,null,2);W(ae)};l.useEffect(()=>{_e()},[R,h,X,fe]);const ve=()=>{const ye=ee.current;if(!ye)return 1;let Ce=1,_=-1/0;const ae=ye.scrollTop,ke=ae+ye.clientHeight;for(let Me=1;Me<=w;Me++){const Ye=de.current[Me];if(!Ye)continue;const ie=Ye.offsetTop,we=ie+Ye.clientHeight,Be=Math.min(ke,we)-Math.max(ae,ie);Be>_&&(_=Be,Ce=Me)}return Ce},Pe=ye=>{const Ce=ve(),_=U.current[Ce],ae=(ke,Me,Ye=180,ie=44)=>{je(we=>{const Be=[...we[ye]||[]];return Be.push({id:Pn("coord-"),page:Ce,x:ke,y:Me,width:Ye,height:ie}),{...we,[ye]:Be}})};if(!_)ae(80,120,220,60);else{const Ye=Math.max(10,Math.round((_.width-180)/2)),ie=Math.max(10,Math.round((_.height-44)/3));ae(Ye,ie,180,44)}jr.success("Signature area added & coordinates generated")},We=(ye,Ce)=>{const _=Ce.getBoundingClientRect();return{x:ye.clientX-_.left,y:ye.clientY-_.top}},pe=(ye,Ce,_)=>{const{x:ae,y:ke}=We(ye,_);if(!L)for(const[Me,Ye]of Object.entries(h))for(let ie=0;ie<(Ye||[]).length;ie++){const we=Ye[ie];if(we.page!==Ce)continue;const Be=[{x:we.x,y:we.y,corner:"top-left"},{x:we.x+we.width,y:we.y,corner:"top-right"},{x:we.x,y:we.y+we.height,corner:"bottom-left"},{x:we.x+we.width,y:we.y+we.height,corner:"bottom-right"}];for(const Ve of Be)if(Math.abs(ae-Ve.x)<8&&Math.abs(ke-Ve.y)<8){ue({signerId:Me,index:ie,corner:Ve.corner}),q({x:ae,y:ke});return}if(ae>=we.x&&ae<=we.x+we.width&&ke>=we.y&&ke<=we.y+we.height){C({signerId:Me,index:ie}),q({x:ae-we.x,y:ke-we.y});return}}L&&I&&(q({x:ae,y:ke}),le({page:Ce,x:ae,y:ke,width:0,height:0}))},O=(ye,Ce,_)=>{const{x:ae,y:ke}=We(ye,_);if(S&&K){const{signerId:Me,index:Ye}=S;je(ie=>{const we={...ie},Be=[...we[Me]||[]],Ve=Be[Ye];return Ve.page!==Ce?ie:(Be[Ye]={...Ve,x:ae-K.x,y:ke-K.y},we[Me]=Be,we)});return}if(J&&K){const{signerId:Me,index:Ye,corner:ie}=J;je(we=>{const Be={...we},Ve=[...Be[Me]||[]],Je=Ve[Ye];if(Je.page!==Ce)return we;let Ue=Je.x,Oe=Je.y,rs=Je.width,ms=Je.height;switch(ie){case"top-left":Ue=ae,Oe=ke,rs=Je.width+(Je.x-ae),ms=Je.height+(Je.y-ke);break;case"top-right":Oe=ke,rs=ae-Je.x,ms=Je.height+(Je.y-ke);break;case"bottom-left":Ue=ae,rs=Je.width+(Je.x-ae),ms=ke-Je.y;break;case"bottom-right":rs=ae-Je.x,ms=ke-Je.y;break}return rs>10&&ms>10&&(Ve[Ye]={...Je,x:Ue,y:Oe,width:rs,height:ms}),Be[Me]=Ve,Be});return}K&&L&&ne&&ne.page===Ce&&le({page:Ce,x:Math.min(K.x,ae),y:Math.min(K.y,ke),width:Math.abs(ae-K.x),height:Math.abs(ke-K.y)})},Ie=()=>{if(ne&&L&&I&&ne.width>10&&ne.height>10){const ye={id:Pn("coord-"),page:ne.page,x:ne.x,y:ne.y,width:ne.width,height:ne.height};je(Ce=>({...Ce,[I]:[...Ce[I]||[],ye]})),jr.success("Signature area marked & coordinates generated")}_e(),q(null),le(null),C(null),ue(null)},ze=()=>{const ye={id:Pn("custom-"),role:"Custom",name:"",email:"",phone:"",reason:"Reason for signing",index:X.length,customRole:""};re(Ce=>[...Ce,ye]),G(Ce=>[...Ce,ye.id])},xe=(ye,Ce)=>{re(_=>_.map(ae=>ae.id===ye?{...ae,role:Ce,customRole:Ce==="Custom"?ae.customRole:""}:ae))},Ee=(ye,Ce)=>{re(_=>_.map(ae=>ae.id===ye?{...ae,customRole:Ce,role:"Custom"}:ae))},Ke=()=>{he("idle"),ge(null)},Xe=async()=>{var ye;try{he("creating");const _=X.filter(Ve=>fe.includes(Ve.id)).map(Ve=>{const Je=Le(Ve);if(!Je)throw new Error(`Missing identifier for signer "${Ve.name||Ve.role}". Choose Email/Phone in "Select identifier".`);const Ue=Ve.customRole||Ve.role;return{identifier:Je,name:Ve.name||String(Ue||"Signer"),sign_type:"aadhaar",reason:Ve.reason||"Reason for signing"}}),ae=JSON.parse(V||"{}"),ke=Object.keys(ae),Ye=[...new Set(_.map(Ve=>Ve.identifier))].filter(Ve=>!ke.includes(Ve));Ye.length&&jr.info(`Note: No coordinates for ${Ye.length} signer(s). They won't have a signature box.`);const ie=m&&m.length?BN(m):"";if(!ie)throw new Error("No PDF data available");const we={local_document_id:t,signers:_,expire_in_days:10,display_on_page:"custom",notify_signers:!0,send_sign_link:!0,file_name:b||"Test.pdf",generate_access_token:!0,include_authentication_url:!0,file_data:ie,sign_coordinates:ae};console.log("[E-SIGN FINAL PAYLOAD]",we);const Be=await LN(we);if(Be.success&&Be.data)ge(Be.data),he("created"),jr.success("E-sign request created successfully!"),n&&await n({docId:t,payload:we});else throw new Error(((ye=Be.error)==null?void 0:ye.message)||"Failed to create e-sign request")}catch(Ce){console.error("Submit error:",Ce),he("error"),jr.error((Ce==null?void 0:Ce.message)||"Failed to create e-sign request")}};return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white w-full max-w-7xl rounded-2xl shadow-2xl max-h-[95vh] flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:["E-sign (Aadhaar) ",e.jsxs("span",{className:"text-xs text-gray-600",children:["Doc ID: ",String(t)]})]}),e.jsx("p",{className:"text-xs text-gray-600",children:'Click "Add Box" or "Mark (Drag)" â€” coordinates are generated automatically.'})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 text-xs border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx(dt,{size:14}),e.jsx("span",{children:"Upload PDF"}),e.jsx("input",{type:"file",accept:"application/pdf",className:"hidden",onChange:me})]}),e.jsxs("button",{onClick:()=>{_e(),A(!0),setTimeout(()=>{var ye;return(ye=B.current)==null?void 0:ye.focus()},0)},className:"px-3 py-1.5 text-xs border rounded hover:bg-gray-50 inline-flex items-center gap-2",children:[e.jsx(ws,{size:14}),"View Coordinates"]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100","aria-label":"Close modal",children:e.jsx(ns,{size:18})})]})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[e.jsxs("div",{className:"w-80 border-r border-gray-200 overflow-y-auto p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Signers"}),e.jsxs("button",{onClick:ze,className:"px-2 py-1 text-xs border rounded-lg flex items-center gap-1 hover:bg-gray-50",children:[e.jsx(fs,{size:12}),"Add"]})]}),X.map(ye=>{const Ce=h[ye.id]||[],_=I===ye.id,ae=Fe(ye.id),ke=ye.customRole||ye.role;return e.jsx("div",{className:`border rounded p-3 ${_?"ring-2 ring-blue-500 bg-blue-50":""}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("input",{type:"checkbox",className:"mt-1",checked:fe.includes(ye.id),onChange:()=>{$e(ye.id),setTimeout(()=>_e(),0)}}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-full",style:{backgroundColor:ae}}),e.jsx("span",{className:"text-sm font-medium",children:ke})]}),e.jsxs("select",{className:"w-full px-2 py-1 border rounded text-xs",value:ye.role,onChange:Me=>xe(ye.id,Me.target.value),children:[e.jsx("option",{value:"Buyer",children:"Buyer"}),e.jsx("option",{value:"Seller",children:"Seller"}),e.jsx("option",{value:"Executive",children:"Executive"}),e.jsx("option",{value:"Witness",children:"Witness"}),e.jsx("option",{value:"Notary",children:"Notary"}),e.jsx("option",{value:"Custom",children:"Custom"})]}),ye.role==="Custom"&&e.jsx("input",{className:"w-full px-2 py-1 border rounded text-xs",value:ye.customRole||"",onChange:Me=>Ee(ye.id,Me.target.value),placeholder:"Enter custom role (e.g., Manager, Director, etc.)"}),e.jsx("input",{className:"w-full px-2 py-1 border rounded text-xs",value:ye.name,onChange:Me=>re(Ye=>Ye.map(ie=>ie.id===ye.id?{...ie,name:Me.target.value}:ie)),placeholder:"Name"}),e.jsx("input",{className:"w-full px-2 py-1 border rounded text-xs",value:ye.email,onChange:Me=>{re(Ye=>Ye.map(ie=>ie.id===ye.id?{...ie,email:Me.target.value}:ie)),setTimeout(()=>_e(),0)},placeholder:"Email"}),e.jsx("input",{className:"w-full px-2 py-1 border rounded text-xs",value:ye.phone,onChange:Me=>{re(Ye=>Ye.map(ie=>ie.id===ye.id?{...ie,phone:Me.target.value}:ie)),setTimeout(()=>_e(),0)},placeholder:"Phone"}),e.jsxs("select",{className:"w-full px-2 py-1 border rounded text-xs",value:ye.identifierType||"",onChange:Me=>{re(Ye=>Ye.map(ie=>ie.id===ye.id?{...ie,identifierType:Me.target.value}:ie)),setTimeout(()=>_e(),0)},children:[e.jsx("option",{value:"",children:"Select identifier"}),RN(ye.email)&&e.jsx("option",{value:"email",children:"Use Email"}),zN(ye.phone)&&e.jsx("option",{value:"phone",children:"Use Phone"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[e.jsxs("button",{onClick:()=>Pe(ye.id),className:"px-2 py-1.5 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center justify-center gap-1",children:[e.jsx(fs,{size:12})," Add Box"]}),_?e.jsx("button",{onClick:()=>{D(!1),H(null)},className:"px-2 py-1.5 text-xs bg-red-500 text-white rounded hover:bg-red-600",children:"Stop Marking"}):e.jsxs("button",{onClick:()=>{D(!0),H(ye.id)},className:"px-2 py-1.5 text-xs border rounded hover:bg-gray-50 flex items-center justify-center gap-1",children:[e.jsx(Qs,{size:12})," Mark (Drag)"]})]}),!!Ce.length&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"text-xs text-gray-600",children:["Signature Areas (",Ce.length,")"]}),Ce.map((Me,Ye)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-gray-50 px-2 py-1 rounded",children:[e.jsxs("span",{children:["Page ",Me.page]}),e.jsx("button",{onClick:()=>je(ie=>{const we=[...ie[ye.id]||[]];return we.splice(Ye,1),{...ie,[ye.id]:we}}),className:"text-red-600 hover:text-red-800",children:e.jsx(Es,{size:12})})]},Me.id))]}),e.jsxs("button",{onClick:()=>{re(Me=>Me.filter(Ye=>Ye.id!==ye.id)),G(Me=>Me.filter(Ye=>Ye!==ye.id)),je(Me=>{const Ye={...Me};return delete Ye[ye.id],Ye})},className:"w-full px-2 py-1.5 text-xs border border-red-300 text-red-600 rounded hover:bg-red-50 flex items-center justify-center gap-1 mt-2",children:[e.jsx(Es,{size:12})," Remove Signer"]})]})]})},ye.id)})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b bg-gray-50 flex items-center gap-2",children:e.jsxs("span",{className:"text-xs",children:[L?"ðŸ“ Marking mode ON":"âœ¨ Move/resize enabled",N&&e.jsxs("span",{className:"ml-2 text-gray-500",children:[N.total?Math.round(N.loaded/N.total*100):0,"% loaded"]})]})}),e.jsx("div",{ref:ee,className:"flex-1 bg-gray-100 p-4 overflow-auto",onMouseUp:Ie,children:v?e.jsxs("div",{className:"h-96 flex items-center justify-center text-gray-600",children:[e.jsx(na,{size:24,className:"animate-spin mr-2"})," Loading PDFâ€¦"]}):j?e.jsx(jh,{file:j,onLoadSuccess:({numPages:ye})=>{$(ye),p("")},onLoadError:ye=>{console.error("react-pdf error:",ye),p(String((ye==null?void 0:ye.message)||ye))},onLoadProgress:({loaded:ye,total:Ce})=>P({loaded:ye,total:Ce}),renderMode:"canvas",loading:e.jsxs("div",{className:"h-96 flex items-center justify-center text-gray-600",children:[e.jsx(na,{size:24,className:"animate-spin mr-2"})," Renderingâ€¦"]}),error:e.jsxs("div",{className:"h-96 flex flex-col items-center justify-center text-red-600 text-sm p-6",children:[e.jsx("p",{className:"font-medium mb-2",children:"Failed to render PDF."}),e.jsx("button",{className:"px-3 py-1.5 text-xs border rounded hover:bg-gray-50",onClick:()=>g(m?new Uint8Array(m):null),children:"Retry"})]}),children:e.jsx("div",{className:"mx-auto max-w-[1000px]",children:Array.from({length:w},(ye,Ce)=>Ce+1).map(ye=>e.jsxs("div",{ref:Ce=>de.current[ye]=Ce,className:"relative inline-block bg-white shadow mb-6",children:[e.jsx(vh,{pageNumber:ye,scale:R,renderTextLayer:!1,renderAnnotationLayer:!1,onLoadSuccess:oe}),e.jsx(VN,{page:ye,signerCoordinates:h,signers:X,isMarkingMode:L,currentMarkingSigner:I,getColor:Fe,dragRect:ne,onMouseDown:pe,onMouseMove:O,onOverlaySize:(Ce,_,ae)=>U.current[Ce]={width:_,height:ae},onRemoveBox:(Ce,_)=>je(ae=>{const ke=(ae[Ce]||[]).filter(Me=>Me.id!==_);return{...ae,[Ce]:ke}})})]},ye))})},E):u?e.jsxs("div",{className:"h-96 flex flex-col items-center justify-center text-red-600 text-sm p-6",children:[e.jsx("p",{className:"font-medium mb-2",children:u}),e.jsx("button",{className:"px-3 py-1.5 text-xs border rounded hover:bg-gray-50",onClick:()=>{g(ye=>ye&&new Uint8Array(ye))},children:"Retry"})]}):e.jsxs("div",{className:"h-96 flex flex-col items-center justify-center text-gray-600 p-8 text-center",children:[e.jsx(ws,{size:48,className:"mb-4 text-gray-400"}),e.jsx("p",{className:"font-medium",children:"No PDF loaded"}),e.jsxs("p",{className:"text-xs mt-2",children:["API should return ",e.jsx("code",{children:"pdf_base64"})," or upload a PDF."]})]})})]})]}),e.jsx("div",{className:"p-4 border-t bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 min-w-0",children:[e.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-2 shrink-0",children:[e.jsx(Un,{size:14})," ",fe.length," signer(s) | ",Object.values(h).flat().length," area(s)"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:justify-end",children:[e.jsx("button",{onClick:()=>{D(!1),H(null)},className:"px-3 py-1.5 text-xs border rounded hover:bg-gray-100 shrink-0",children:"Stop Marking"}),e.jsx("button",{onClick:Xe,disabled:Q==="creating",className:"px-3 py-1.5 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed shrink-0 flex items-center gap-2",children:Q==="creating"?e.jsxs(e.Fragment,{children:[e.jsx(na,{size:12,className:"animate-spin"}),"Creating..."]}):"Submit to Digio"}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-100 rounded-lg text-sm hover:bg-gray-200 shrink-0",children:"Close"})]})]})})]})}),e.jsx(UN,{status:Q,digioResponse:se,onCreateNewRequest:Ke,onClose:a}),M&&e.jsx(ON,{json:V||"{}",onClose:()=>A(!1),textareaRef:B})]}):null}function VN({page:s,signerCoordinates:a,signers:t,isMarkingMode:r,currentMarkingSigner:i,getColor:n,dragRect:o,onMouseDown:m,onMouseMove:g,onOverlaySize:b,onRemoveBox:d}){const v=l.useRef(null);l.useEffect(()=>{if(!v.current)return;const u=v.current,c=()=>b(s,u.clientWidth,u.clientHeight);c();const f=new ResizeObserver(c);return f.observe(u),()=>f.disconnect()},[s,b]);const x={zIndex:20,pointerEvents:"auto",cursor:r?"crosshair":"default"};return e.jsxs("div",{ref:v,className:"absolute inset-0",style:x,onMouseDown:u=>v.current&&m(u,s,v.current),onMouseMove:u=>v.current&&g(u,s,v.current),children:[Object.entries(a).flatMap(([u,c])=>(c||[]).filter(f=>f.page===s).map(f=>{const p=n(u),N=t.find($=>$.id===u),P=(N==null?void 0:N.customRole)||(N==null?void 0:N.role)||"Signer",w={left:f.x,top:f.y,width:f.width,height:f.height,borderColor:p,backgroundColor:`${p}20`,cursor:r?"crosshair":"move",pointerEvents:"auto",position:"absolute",borderStyle:"solid",borderWidth:2};return e.jsxs("div",{className:"absolute",style:w,children:[e.jsx("div",{className:"text-xs font-bold px-1 absolute -top-5 left-0 whitespace-nowrap",style:{color:p},children:P}),e.jsx("button",{type:"button",onClick:$=>{$.stopPropagation(),d(u,f.id)},className:"absolute right-0 top-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-white border shadow hover:bg-gray-100 text-[10px] font-bold flex items-center justify-center","aria-label":"Remove",title:"Remove",children:"âœ•"}),["top-left","top-right","bottom-left","bottom-right"].map($=>e.jsx("div",{className:"absolute -left-1 -top-1 w-2 h-2 bg-white border border-gray-400 rounded-sm pointer-events-none",style:{...$==="top-right"&&{left:"auto",right:"-0.25rem",top:"-0.25rem"},...$==="bottom-left"&&{top:"auto",bottom:"-0.25rem",left:"-0.25rem"},...$==="bottom-right"&&{top:"auto",left:"auto",bottom:"-0.25rem",right:"-0.25rem"},cursor:$==="top-left"||$==="bottom-right"?"nwse-resize":"nesw-resize"}},$)),e.jsx("div",{className:"w-full h-full flex items-center justify-center text-[12px] font-medium",style:{color:"#1f2937"},children:(N==null?void 0:N.name)||P})]},`${u}-${f.id}`)})),o&&o.page===s&&r&&e.jsx("div",{className:"absolute border-2 border-dashed border-blue-500 bg-blue-500/10 pointer-events-none",style:{left:o.x,top:o.y,width:o.width,height:o.height}})]})}function WN({isOpen:s,onClose:a,doc:t,details:r,onResumeEsign:i,onMarkCompleted:n,onDetailsChange:o}){var w,$,y,k,R,F;if(!s)return null;const[m,g]=l.useState(r),[b,d]=l.useState(!1),[v,x]=l.useState(null);l.useEffect(()=>{g(r||null)},[r]),l.useEffect(()=>{let T=!0;return(async()=>{if(s&&!(m!=null&&m.digio_id||m!=null&&m.status))try{d(!0);const E=await Ic(t==null?void 0:t.id),V={success:!!(E!=null&&E.success),digio_id:E==null?void 0:E.digio_id,status:E==null?void 0:E.status,local_document_id:(E==null?void 0:E.local_document_id)??(t==null?void 0:t.id),data:E==null?void 0:E.data,db:E==null?void 0:E.db,error:E==null?void 0:E.error};if(!T)return;g(V),o==null||o(V),V.success||x(typeof V.error=="string"?V.error:"Unable to fetch status")}catch(E){if(!T)return;x((E==null?void 0:E.message)||"Failed to fetch status")}finally{T&&d(!1)}})(),()=>{T=!1}},[s]);const u=HN(m==null?void 0:m.status),c=YN(u),f={name:(w=t==null?void 0:t.data)==null?void 0:w.buyer_name,email:($=t==null?void 0:t.data)==null?void 0:$.buyer_email,phone:(y=t==null?void 0:t.data)==null?void 0:y.buyer_phone},p={name:(k=t==null?void 0:t.data)==null?void 0:k.seller_name,email:(R=t==null?void 0:t.data)==null?void 0:R.seller_email,phone:(F=t==null?void 0:t.data)==null?void 0:F.seller_phone},N=async()=>{var T,j;m!=null&&m.digio_id&&await DN(m.digio_id,((T=m==null?void 0:m.data)==null?void 0:T.file_name)||((j=m==null?void 0:m.db)==null?void 0:j.file_name)||void 0,!1)},P=async()=>{try{d(!0),x(null);let T=null;if(m!=null&&m.digio_id){const j=await jg(m.digio_id,t==null?void 0:t.id);T={success:!!(j!=null&&j.success),digio_id:(j==null?void 0:j.digio_id)||m.digio_id,status:(j==null?void 0:j.status)||(m==null?void 0:m.status),local_document_id:(j==null?void 0:j.local_document_id)??(t==null?void 0:t.id),data:j==null?void 0:j.data,db:j==null?void 0:j.db,error:j==null?void 0:j.error}}else{const j=await Ic(t==null?void 0:t.id);T={success:!!(j!=null&&j.success),digio_id:j==null?void 0:j.digio_id,status:j==null?void 0:j.status,local_document_id:(j==null?void 0:j.local_document_id)??(t==null?void 0:t.id),data:j==null?void 0:j.data,db:j==null?void 0:j.db,error:j==null?void 0:j.error}}g(T),o==null||o(T),T!=null&&T.success||x(typeof(T==null?void 0:T.error)=="string"?T.error:"Unable to fetch latest status")}catch(T){x((T==null?void 0:T.message)||"Failed to refresh status")}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 z-[1000] bg-black/50 flex items-center justify-center px-4 !mt-0",children:e.jsxs("div",{className:"bg-white w-full max-w-5xl rounded-2xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 truncate",children:"Existing Digio Request Found"}),e.jsxs("p",{className:"text-sm text-gray-600 truncate",children:[t==null?void 0:t.title," â€¢ Template: ",t==null?void 0:t.template_name]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{disabled:b,onClick:P,className:`inline-flex items-center gap-1 px-3 py-1.5 border rounded hover:bg-gray-50 ${b?"opacity-60 cursor-not-allowed":""}`,"aria-label":"Check latest status",title:"Check latest status",children:[e.jsx(Nh,{size:16,className:b?"animate-spin":""}),e.jsx("span",{className:"text-sm",children:"Check Status"})]}),e.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100",onClick:a,"aria-label":"Close",children:e.jsx(ns,{size:18})})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.icon,e.jsx("div",{className:`px-2 py-0.5 rounded-full text-xs ${c.classes}`,children:c.label}),(m==null?void 0:m.digio_id)&&e.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Digio ID: ",e.jsx("span",{className:"font-mono",children:m.digio_id})]}),b&&e.jsx("div",{className:"text-xs text-gray-400",children:"Refreshingâ€¦"})]}),v&&e.jsx("div",{className:"text-xs text-red-600 bg-red-50 border border-red-100 rounded p-2",children:v}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(wx,{title:"Buyer",party:f}),e.jsx(wx,{title:"Seller",party:p})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[(u==="requested"||u==="created")&&e.jsxs("button",{className:"inline-flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:i,children:[e.jsx(ws,{size:14})," Resume e-Sign Flow"]}),u==="completed"&&e.jsxs("button",{className:"inline-flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700",onClick:n,children:[e.jsx(bs,{size:14})," Mark Completed in CRM"]}),(m==null?void 0:m.digio_id)&&e.jsx(e.Fragment,{children:u==="completed"&&e.jsxs("button",{onClick:N,className:"inline-flex items-center gap-1 px-3 py-1.5 border rounded hover:bg-gray-50",children:[e.jsx(Ys,{size:14})," Download PDF"]})})]}),e.jsxs("div",{className:"text-[11px] text-gray-500 px-1",children:["Inline preview disabled. Use ",e.jsx("span",{className:"font-medium",children:"Open In New Tab"})," to view."]})]})]})})}function wx({title:s,party:a}){return e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:s}),e.jsx("div",{className:"text-sm font-medium",children:(a==null?void 0:a.name)||"â€”"}),e.jsx("div",{className:"text-xs text-gray-600 break-all",children:(a==null?void 0:a.email)||"â€”"}),e.jsx("div",{className:"text-xs text-gray-600 break-all",children:(a==null?void 0:a.phone)||"â€”"})]})}function HN(s){const a=(s||"").toLowerCase();return["requested","pending","shared"].some(t=>a.includes(t))?"requested":["completed","signed","success"].some(t=>a.includes(t))?"completed":["cancel","void","rejected"].some(t=>a.includes(t))?"cancelled":["created"].some(t=>a.includes(t))?"created":a||"created"}function YN(s){switch(s){case"requested":return{label:"Request Sent / Pending",classes:"bg-orange-100 text-orange-700",icon:e.jsx(Ls,{size:16,className:"text-orange-600"})};case"completed":return{label:"Completed / Signed",classes:"bg-green-100 text-green-700",icon:e.jsx(bs,{size:16,className:"text-green-600"})};case"cancelled":return{label:"Cancelled / Rejected",classes:"bg-red-100 text-red-700",icon:e.jsx(ct,{size:16,className:"text-red-600"})};default:return{label:"Created",classes:"bg-gray-100 text-gray-700",icon:e.jsx(ws,{size:16,className:"text-gray-600"})}}}const vi=s=>s==="e-sign_pending"?"esign_pending":s||"created",Ni=s=>{if(!s)return"";const a=new Date(s);if(isNaN(a.getTime()))return"";const t=new Intl.DateTimeFormat("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).formatToParts(a),r=v=>{var x;return((x=t.find(u=>u.type===v))==null?void 0:x.value)||""},i=r("year"),n=r("month"),o=r("day"),m=r("hour"),g=r("minute"),b=r("second"),d=r("dayPeriod");return`${i}-${n}-${o} ${m}:${g}:${b} ${d}`},GN=s=>{var r;const a=Array.isArray(s.tracking_history)?s.tracking_history:[];for(const i of a){const n=(i==null?void 0:i.details)??"",o=(i==null?void 0:i.action)??"";if(!(!n&&!o)&&(/digio/i.test(o)||/digio_id|DID/i.test(n))){const m=(n==null?void 0:n.match(/digio_id[":\s]+([A-Za-z0-9\-_]+)/i))||(n==null?void 0:n.match(/\bDID[:\s"]?([A-Za-z0-9\-_]+)/i));if(m!=null&&m[1])return m[1]}}const t=((r=s==null?void 0:s.variables)==null?void 0:r.digio_id)||(s==null?void 0:s.digio_id);return typeof t=="string"&&t.trim()?t.trim():null},_x=s=>{const a=(s||"").toLowerCase();return a?["requested","pending","shared"].some(t=>a.includes(t))?"requested":["completed","signed","success"].some(t=>a.includes(t))?"completed":["cancel","void","rejected"].some(t=>a.includes(t))?"cancelled":["created"].some(t=>a.includes(t))?"created":a:""},Sx=()=>{var ms,cs,gs,Ne,Ze,ls,$s,Gs,Se,Ge,z,te;const{user:s}=Hs(),[a,t]=l.useState(""),[r,i]=l.useState("all"),[n,o]=l.useState("all"),[m,g]=l.useState("all"),[b,d]=l.useState([]),[v,x]=l.useState(!1),[u,c]=l.useState(!1),[f,p]=l.useState(!1),[N,P]=l.useState(!1),[w,$]=l.useState(null),[y]=l.useState("admin"),[k,R]=l.useState("table"),[F,T]=l.useState(1),[j]=l.useState(10),[E,V]=l.useState(!1),[W,B]=l.useState(!1),[M,A]=l.useState(!1),[L,D]=l.useState(null),[I,H]=l.useState(""),[h,Y]=l.useState([]),[K,q]=l.useState(!1),[ne,le]=l.useState(null),[S,C]=l.useState(void 0),[J,ue]=l.useState(!1),[Q,he]=l.useState(null),[se,ge]=Ps.useState(!1),[ee,de]=Ps.useState(null),[U,X]=l.useState(!1),[re,fe]=l.useState(null),[G,me]=l.useState(null);l.useEffect(()=>{const ce=Re=>{const{id:Te,status:qe}=Re.detail||{}};return window.addEventListener("doc:status",ce),()=>window.removeEventListener("doc:status",ce)},[]);const oe=async ce=>{try{if(!(ce!=null&&ce.id)){de(ce),ge(!0),le(ce);return}let Re=GN(ce);if(!Re){const qe=await Ic(ce.id);if(qe!=null&&qe.success&&(qe!=null&&qe.digio_id)){Re=qe.digio_id;const as=_x(qe.status);if(as==="requested"||as==="completed"){fe(ce),me({...qe,local_document_id:qe.local_document_id??ce.id}),X(!0),le(ce);return}de(ce),ge(!0),le(ce);return}de(ce),ge(!0),le(ce);return}const Te=await jg(Re,ce.id);if(Te!=null&&Te.success){const qe=_x(Te.status);if(qe==="requested"||qe==="completed"){fe(ce),me(Te),X(!0),le(ce);return}}de(ce),ge(!0),le(ce)}catch(Re){console.error("Error checking Digio status:",Re),de(ce),ge(!0),le(ce)}},Fe=async()=>{if(!b.length)return;const ce=await Promise.all(b.map(qe=>ua.getSnapshot(qe)));We(qe=>qe.map(as=>{const xs=b.indexOf(as.id);if(xs===-1)return as;const ps=ce[xs];return{...as,status:vi(ps==null?void 0:ps.current_status)||as.status,stage_progress:typeof(ps==null?void 0:ps.progress_pct)=="number"?ps.progress_pct:as.stage_progress}}));const Re=ce.map(qe=>vi(qe==null?void 0:qe.current_status)),Te=Re.length&&Re.every(qe=>qe===Re[0])?Re[0]:"";Y(Re),H(Te),B(!0)},$e=async(ce,Re,Te)=>{await ua.setStatus(ce,{new_status:Re,reason:Te,details:{source:"ui-stepper"},changed_by:Number(s==null?void 0:s.id)||null});const qe=await ua.getSnapshot(ce);We(as=>as.map(xs=>xs.id===ce?{...xs,status:vi(qe==null?void 0:qe.current_status),stage_progress:typeof(qe==null?void 0:qe.progress_pct)=="number"?qe.progress_pct:void 0,updated_at:(qe==null?void 0:qe.updated_at)??xs.updated_at}:xs))},Le=l.useCallback(async()=>{try{q(!0);const ce=await ot.getAllWithRelations(),Te=(ts=>{var js;return Array.isArray(ts)?ts:Array.isArray(ts==null?void 0:ts.rows)?ts.rows:Array.isArray(ts==null?void 0:ts.data)?ts.data:Array.isArray((js=ts==null?void 0:ts.data)==null?void 0:js.rows)?ts.data.rows:Array.isArray(ts==null?void 0:ts.list)?ts.list:[]})(ce),qe=(ts,js)=>{for(const Fs of js){const ht=Fs.split(".").reduce((vt,De)=>vt?vt[De]:void 0,ts);if(ht!=null&&ht!=="")return ht}},as=(...ts)=>ts.map(js=>(js??"").trim()).filter(Boolean).join(" "),xs=ts=>ts?/\.$/.test(ts)?ts:`${ts}.`:"",ps=ts=>{if(ts==null||ts==="")return null;const js=Number(String(ts).replace(/[, ]/g,""));return Number.isFinite(js)?js:null},ys=ts=>{if(!ts)return"";const js=new Date(ts);if(isNaN(js))return"";const Fs=String(js.getDate()).padStart(2,"0"),ht=String(js.getMonth()+1).padStart(2,"0"),vt=js.getFullYear(),De=new Intl.DateTimeFormat("en-IN",{timeZone:"Asia/Kolkata",hour:"numeric",minute:"2-digit",hour12:!0}).format(js);return`${Fs}/${ht}/${vt} ${De}`},He=(...ts)=>ts.filter(Boolean).join(" â€¢ "),vs=ts=>ts==null?"":String(ts),_s=ts=>ts?Array.isArray(ts)?ts.map(js=>String((js==null?void 0:js.id)??js)).filter(Boolean):[]:[],et=Te.map(ts=>{var un,fd,yd;const js=typeof(ts==null?void 0:ts.variables)=="string"?(()=>{try{return JSON.parse(ts.variables)}catch{return{}}})():(ts==null?void 0:ts.variables)||{},Fs=js.__form_snapshot||{},ht=js.property||Fs.property||{},vt=qe({vars:js,snap:Fs,doc:ts},["vars.seller_salutation","vars.seller.salutation","vars.seller_title","vars.seller.title","snap.seller.salutation","doc.seller.salutation","vars.salutation"]),De=qe({vars:js,snap:Fs,doc:ts},["vars.buyer_salutation","vars.buyer.salutation","vars.buyer_title","vars.buyer.title","snap.buyer.salutation","doc.buyer.salutation"]),is=qe({vars:js,snap:Fs,doc:ts},["vars.seller_name","vars.seller.name","snap.seller.name","doc.seller.name"])||as(qe({vars:js,snap:Fs},["vars.seller.first_name","snap.seller.first_name"]),qe({vars:js,snap:Fs},["vars.seller.middle_name","snap.seller.middle_name"]),qe({vars:js,snap:Fs},["vars.seller.last_name","snap.seller.last_name"])),Qe=qe({vars:js,snap:Fs,doc:ts},["vars.buyer_name","vars.buyer.name","snap.buyer.name","doc.buyer.name"])||as(qe({vars:js,snap:Fs},["vars.buyer.first_name","snap.buyer.first_name"]),qe({vars:js,snap:Fs},["vars.buyer.middle_name","snap.buyer.middle_name"]),qe({vars:js,snap:Fs},["vars.buyer.last_name","snap.buyer.last_name"])),ds=as(xs(vt),is)||"N/A",os=as(xs(De),Qe)||"N/A",zs=qe({vars:js,snap:Fs,doc:ts},["vars.seller_phone","vars.seller.phone","snap.seller_phone","snap.seller.phone","doc.seller.phone","vars.seller_phone_number","vars.seller.contact_phone"])||"",Us=qe({vars:js,snap:Fs,doc:ts},["vars.seller_email","vars.seller.email","snap.seller_email","snap.seller.email","doc.seller.email"])||"",pt=qe({vars:js,snap:Fs,doc:ts},["vars.buyer_phone","vars.buyer.phone","snap.buyer_phone","snap.buyer.phone","doc.buyer.phone","vars.buyer_phone_number","vars.buyer.contact_phone"])||"",Ht=qe({vars:js,snap:Fs,doc:ts},["vars.buyer_email","vars.buyer.email","snap.buyer_email","snap.buyer.email","doc.buyer.email"])||"",qt=qe({vars:js,p:ht,snap:Fs},["vars.carpet_area","vars.property_area","p.carpet_area","p.area","p.property_area","snap.carpet_area","snap.property_area","snap.property.area"]),lt=ps(qt),xa=lt==null?"":`${lt} sq ft`,At=lt==null?"":String(lt),gr=qe({vars:js,p:ht,snap:Fs},["vars.property_address","p.address","snap.address"])||"N/A",St=(un=qe({vars:js,p:ht,snap:Fs},["vars.property_type_name","p.property_type_name","snap.property_type_name","vars.property_type","p.property_type"]))==null?void 0:un.trim(),ba=(fd=qe({vars:js,p:ht,snap:Fs},["vars.property_subtype_name","p.property_subtype_name","snap.property_subtype_name"]))==null?void 0:fd.trim(),be=(yd=qe({vars:js,p:ht,snap:Fs},["vars.unit_type","p.unit_type","snap.unit_type"]))==null?void 0:yd.trim(),es=St&&St.toLowerCase()==="commercial"?St:He(St,ba,be),hs=He(es,xa),Ss=ps(qe({vars:js},["vars.deal_price"]))??0,qs=ps(qe({vars:js},["vars.token_amount"]))??0,Vs=ps(qe({vars:js},["vars.booking_amount","vars.token_amount"]))??qs??0,us=ps(qe({vars:js},["vars.total_paid","vars.amount_paid"]))??0,Zs=Math.max(Ss-us,0),mt=Zs,xt=ys((ts==null?void 0:ts.created_at)||(ts==null?void 0:ts.createdAt)),Rt=ys(qe({vars:js},["vars.last_payment_date"])),Ma=ys(qe({vars:js},["vars.next_due_date"])),hr=Number(qe({vars:js},["vars.receipt_count"]))||0,Ar=vs(qe({vars:js,snap:Fs,doc:ts},["vars.executive_id","snap.executive.id","doc.executive_id","vars.executive.id"])),nt=vs(qe({vars:js,snap:Fs,doc:ts},["vars.buyer.id","doc.buyer_id","snap.buyer.id"])),fa=vs(qe({vars:js,snap:Fs,doc:ts},["vars.seller.id","doc.seller_id","snap.seller.id"])),io=vs(qe({vars:js,p:ht,snap:Fs,doc:ts},["p.id","vars.property.id","doc.property_id","snap.property.id"])),oo=_s(js.properties||Fs.properties),Pr=qe({vars:js,snap:Fs,doc:ts},["vars.executive_name","vars.executive.name","snap.executive.name","doc.executive.name","vars.sales_executive"])||"Unassigned",co=qe({vars:js,snap:Fs,doc:ts},["vars.executive_salutation","vars.executive.salutation","vars.executive_title","vars.executive.title","snap.executive.salutation","doc.executive.salutation"]);return{id:Number(ts==null?void 0:ts.id)||0,title:String((ts==null?void 0:ts.name)||(js==null?void 0:js.title)||"Untitled Document"),template_name:String((ts==null?void 0:ts.template_name)||(ts==null?void 0:ts.template_description)||"Untitled Template"),template_id:Number((ts==null?void 0:ts.template_id)??(js==null?void 0:js.template_id))||0,data:{seller_name:ds,buyer_name:os,seller_phone:String(zs),seller_email:String(Us),buyer_phone:String(pt),buyer_email:String(Ht),property_address:String(gr),property_type:es||String(js.property_type||"N/A"),property_area:At,property_area_label:xa,type_area_line:hs,sale_amount:Ss,token_amount:qs,sales_executive:as(xs(co),Pr)||"Unassigned",executive_phone:String(qe({vars:js,snap:Fs},["vars.executive_phone","snap.executive_phone"])||""),executive_email:String(qe({vars:js,snap:Fs},["vars.executive_email","snap.executive_email"])||""),document_id:String((ts==null?void 0:ts.id)||0),document_date:xt,booking_amount:Vs,executive_id:Ar,buyer_id:nt,seller_id:fa,property_id:io,property_ids:oo,total_paid:us,total_due:Zs,outstanding_amount:mt,receipt_count:hr,last_payment_date:Rt,next_due_date:Ma,notes:vs(qe({vars:js},["vars.notes"]))},status:"created",priority:"medium",created_by:(ts==null?void 0:ts.created_by_name)||"Unknown",assigned_to:Pr,created_at:(ts==null?void 0:ts.created_at)||"",updated_at:(ts==null?void 0:ts.updated_at)||"",shared_channels:[],stage_progress:0,tracking_history:[{id:1,action:"Document Created",timestamp:(ts==null?void 0:ts.created_at)||new Date().toISOString(),user:(ts==null?void 0:ts.created_by_name)||"System",details:`Generated from template ${(ts==null?void 0:ts.template_id)??(js==null?void 0:js.template_id)??"?"}`,stage:"created",icon:"FileText"}]}});We(et);try{const ts=await Promise.all(et.map(js=>ua.getSnapshot(js.id)));We(js=>js.map((Fs,ht)=>{const vt=ts[ht];return vt?{...Fs,status:vi(vt.current_status||Fs.status),stage_progress:typeof vt.progress_pct=="number"?vt.progress_pct:Fs.stage_progress}:Fs}))}catch(ts){console.warn("âš ï¸ Failed to load live snapshots:",ts)}}catch(ce){console.error("âŒ Error fetching documents:",ce),We([])}finally{q(!1)}},[]);l.useEffect(()=>{Le()},[Le]);const je=ce=>{if(ce==null)return"";const Re=String(ce);return/[",\n]/.test(Re)?`"${Re.replace(/"/g,'""')}"`:Re},_e=()=>{const ce=new Date,Re=String(ce.getDate()).padStart(2,"0"),Te=String(ce.getMonth()+1).padStart(2,"0"),qe=ce.getFullYear(),as=String(ce.getHours()).padStart(2,"0"),xs=String(ce.getMinutes()).padStart(2,"0"),ps=String(ce.getSeconds()).padStart(2,"0");return`${qe}${Te}${Re}_${as}${xs}${ps}`},ve=ce=>ce==="e-sign_pending"?"esign_pending":ce||"created",[Pe,We]=l.useState([]),pe=Pe.filter(ce=>{const Re=ce.title.toLowerCase().includes(a.toLowerCase())||ce.data.seller_name.toLowerCase().includes(a.toLowerCase())||(ce.data.buyer_name||"").toLowerCase().includes(a.toLowerCase())||ce.data.property_address.toLowerCase().includes(a.toLowerCase())||ce.template_name.toLowerCase().includes(a.toLowerCase()),Te=ve(ce.status),qe=ve(r),as=r==="all"||Te===qe,xs=n==="all"||ce.priority===n,ps=m==="all"||ce.template_name===m;return Re&&as&&xs&&ps}),O=Math.ceil(pe.length/j),Ie=(F-1)*j,ze=pe.slice(Ie,Ie+j),xe=ce=>{const Re=ce==="e-sign_pending"?"esign_pending":ce,Te={completed:{bg:"bg-green-100",text:"text-green-800",label:"Completed",icon:bs},esign_pending:{bg:"bg-orange-100",text:"text-orange-800",label:"E-Sign Pending",icon:Ls},otp_verified:{bg:"bg-blue-100",text:"text-blue-800",label:"OTP Verified",icon:at},shared:{bg:"bg-purple-100",text:"text-purple-800",label:"Shared",icon:Dt},created:{bg:"bg-gray-100",text:"text-gray-800",label:"Created",icon:ws},on_hold:{bg:"bg-yellow-100",text:"text-yellow-800",label:"On Hold",icon:ct},cancelled:{bg:"bg-red-100",text:"text-red-800",label:"Cancelled",icon:ct}},qe=Te[Re]??Te.created,as=qe.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${qe.bg} ${qe.text}`,children:[e.jsx(as,{size:14,className:"mr-1"}),qe.label]})},Ee=ce=>{const Te={high:{bg:"bg-red-100",text:"text-red-700",label:"High",icon:ct},medium:{bg:"bg-yellow-100",text:"text-yellow-700",label:"Medium",icon:Ls},low:{bg:"bg-green-100",text:"text-green-700",label:"Low",icon:bs}}[ce],qe=Te.icon;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${Te.bg} ${Te.text}`,children:[e.jsx(qe,{size:12,className:"mr-1"}),Te.label]})},Ke=(ce,Re)=>{const as={created:"bg-gray-400",shared:"bg-purple-500",otp_verified:"bg-blue-500",esign_pending:"bg-orange-500",completed:"bg-green-500",on_hold:"bg-yellow-500",cancelled:"bg-red-500"}[ce==="e-sign_pending"?"esign_pending":ce]||"bg-gray-400";return e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`${as} h-2 rounded-full transition-all duration-500`,style:{width:`${Re}%`}})})},Xe=ce=>{d(Re=>Re.includes(ce)?Re.filter(Te=>Te!==ce):[...Re,ce])},ye=()=>{b.length===ze.length?d([]):d(ze.map(ce=>ce.id))},Ce=ce=>{$(ce),p(!0)},_=ce=>{$(ce),x(!0)},ae=ce=>{$(ce),c(!0)},ke=ce=>{$(ce),P(!0)},Me=async ce=>{try{D(ce.id),await ot.downloadFinalPdf(ce.id,{filenameFallback:`${(ce.title||ce.name||"document").toString().trim().replace(/[^\w\s.-]+/g,"_")}.pdf`})}catch(Re){console.error("Final PDF download failed:",Re),alert((Re==null?void 0:Re.message)||"Final PDF download failed")}finally{D(null)}},Ye=ce=>{We(Re=>Re.map(Te=>Te.id===ce.id?{...Te,...ce}:Te)),x(!1),$(null)},ie=async ce=>{if(w)try{await ot.softDelete(w.id),We(Re=>Re.filter(Te=>Te.id!==w.id)),Z.success("Document deleted successfully (soft delete).")}catch(Re){console.error("Soft delete failed:",Re),Z.error((Re==null?void 0:Re.message)||"Failed to delete document.")}finally{c(!1),$(null)}},we=async()=>{const ce=Pe.filter(as=>b.includes(as.id));if(!ce.length)return;const Re={channels:["whatsapp","email"],message:"Please review and sign.",public_link:"",recipients:[]};We(as=>as.map(xs=>b.includes(xs.id)?{...xs,shared_channels:Array.from(new Set([...xs.shared_channels||[],...Re.channels])),tracking_history:[...xs.tracking_history,{id:xs.tracking_history.length+1,action:`Shared via ${Re.channels.join(", ")}`,timestamp:new Date().toISOString(),user:"Admin User",details:Re.message||"Shared",stage:"shared",icon:"Send"}]}:xs));const qe=(await Promise.allSettled(ce.map(as=>ua.createShareBatch(as.id,Re)))).map((as,xs)=>as.status==="fulfilled"?ce[xs].id:null).filter(Boolean);if(qe.length){const as=await Promise.all(qe.map(xs=>ua.getSnapshot(xs)));We(xs=>xs.map(ps=>{const ys=qe.indexOf(ps.id);if(ys===-1)return ps;const He=as[ys];return{...ps,status:(He==null?void 0:He.current_status)||"shared",stage_progress:typeof(He==null?void 0:He.progress_pct)=="number"?He.progress_pct:ps.stage_progress}}))}d([])},Be=async()=>{const ce=b.length?b:pe.map(Re=>Re.id);if(!ce.length){Z.info("Select at least one document.");return}try{D("bulk"),await ot.bulkDownloadZip(ce,{page:"a4",filenamePrefix:"documents"}),Z.success(`Downloading ${ce.length} PDFs as ZIP`)}catch(Re){console.error(Re),Z.error((Re==null?void 0:Re.message)||"Bulk download failed")}finally{D(null),d([])}},Ve=()=>{const ce=b.length?Pe.filter(_s=>b.includes(_s.id)):pe;if(!ce.length){Z.info("Nothing to export.");return}const Re=["ID","Title","Template","Seller","Buyer","Property Type","Property Area (sq ft)","Property Address","Sale Amount","Token Amount","Total Paid","Outstanding","Receipt Count","Last Payment Date","Next Due Date","Status","Progress (%)","Priority","Shared Channels","Assigned To","Created By","Created At","Updated At"],Te=ce.map(_s=>{var js,Fs,ht,vt,De,is,Qe,ds,os,zs,Us,pt,Ht;const et=ve(_s.status),ts=(_s.shared_channels||[]).join("|");return[_s.id,_s.title,_s.template_name,((js=_s.data)==null?void 0:js.seller_name)??"",((Fs=_s.data)==null?void 0:Fs.buyer_name)??"",((ht=_s.data)==null?void 0:ht.property_type)??"",((vt=_s.data)==null?void 0:vt.property_area)??"",((De=_s.data)==null?void 0:De.property_address)??"",((is=_s.data)==null?void 0:is.sale_amount)??"",((Qe=_s.data)==null?void 0:Qe.token_amount)??"",((ds=_s.data)==null?void 0:ds.total_paid)??"",((os=_s.data)==null?void 0:os.outstanding_amount)??((zs=_s.data)==null?void 0:zs.total_due)??"",((Us=_s.data)==null?void 0:Us.receipt_count)??"",Ni((pt=_s.data)==null?void 0:pt.last_payment_date),Ni((Ht=_s.data)==null?void 0:Ht.next_due_date),et,_s.stage_progress??0,_s.priority??"",ts,_s.assigned_to??"",_s.created_by??"",Ni(_s.created_at),Ni(_s.updated_at)].map(je).join(",")}),qe=[Re.map(je).join(","),...Te].join(`\r
`),as="\uFEFF",xs=new Blob([as+qe],{type:"text/csv;charset=utf-8;"}),ps=window.URL.createObjectURL(xs),ys=document.createElement("a"),He=_e(),vs=b.length?`selected_${b.length}`:"filtered";ys.href=ps,ys.download=`documents_export_${vs}_${He}.csv`,document.body.appendChild(ys),ys.click(),document.body.removeChild(ys),window.URL.revokeObjectURL(ps),b.length&&d([]),Z.success(`Exported ${ce.length} row${ce.length>1?"s":""} to CSV`)},Je=async ce=>{var Re,Te,qe,as,xs,ps,ys,He,vs,_s,et,ts,js,Fs,ht,vt,De,is,Qe,ds,os,zs,Us,pt,Ht,qt,lt,xa;try{const At=await ot.getById(ce.id),gr=(At==null?void 0:At.content)??(At==null?void 0:At.templateContent)??(At==null?void 0:At.template_html)??(At==null?void 0:At.template_html_snapshot)??null;if(!gr){Z.error("Source document has no content to duplicate.");return}const St=(Re=ce==null?void 0:ce.data)!=null&&Re.document_id?`${ce.data.document_id}_COPY`:`DOC_COPY_${Date.now()}`,ba=new Date().toISOString(),be={template_id:ce.template_id,name:`${ce.title} (Copy)`,description:ce.description??null,category:ce.category??null,status:"created",content:String(gr),created_by:(s==null?void 0:s.id)||ce.created_by||null,updated_by:Number(s==null?void 0:s.id)||null,variables:{__cloned_from:ce.id,__source_document_id:(Te=ce.data)==null?void 0:Te.document_id,document_id:St,sales_executive:(qe=ce.data)==null?void 0:qe.sales_executive,executive_id:(as=ce.data)==null?void 0:as.executive_id,executive_phone:(xs=ce.data)==null?void 0:xs.executive_phone,executive_email:(ps=ce.data)==null?void 0:ps.executive_email,executive_name:(ys=ce.data)==null?void 0:ys.sales_executive,seller_name:(He=ce.data)==null?void 0:He.seller_name,seller_phone:(vs=ce.data)==null?void 0:vs.seller_phone,seller_email:(_s=ce.data)==null?void 0:_s.seller_email,seller_id:(et=ce.data)==null?void 0:et.seller_id,buyer_name:(ts=ce.data)==null?void 0:ts.buyer_name,buyer_phone:(js=ce.data)==null?void 0:js.buyer_phone,buyer_email:(Fs=ce.data)==null?void 0:Fs.buyer_email,buyer_id:(ht=ce.data)==null?void 0:ht.buyer_id,property_address:(vt=ce.data)==null?void 0:vt.property_address,property_type:(De=ce.data)==null?void 0:De.property_type,property_area:(is=ce.data)==null?void 0:is.property_area,property_ids:((Qe=ce.data)==null?void 0:Qe.property_ids)??[],property_id:(ds=ce.data)==null?void 0:ds.property_id,sale_amount:(os=ce.data)==null?void 0:os.sale_amount,token_amount:(zs=ce.data)==null?void 0:zs.token_amount,booking_amount:(Us=ce.data)==null?void 0:Us.booking_amount,document_date:ba,notes:((pt=ce.data)==null?void 0:pt.notes)||""}},es=await ot.create(be),hs=(es==null?void 0:es.id)??((Ht=es==null?void 0:es.document)==null?void 0:Ht.id)??((qt=es==null?void 0:es.data)==null?void 0:qt.id)??Date.now(),Ss=(es==null?void 0:es.variables)||((lt=es==null?void 0:es.document)==null?void 0:lt.variables)||((xa=es==null?void 0:es.data)==null?void 0:xa.variables);let qs="";try{const us=typeof Ss=="string"?JSON.parse(Ss):Ss;qs=(us==null?void 0:us.document_id)||""}catch{}const Vs=ba;We(us=>{var Zs,mt,xt;return[...us,{...ce,id:hs,title:`${ce.title} (Copy)`,assigned_to:ce.assigned_to||((Zs=ce.data)==null?void 0:Zs.sales_executive)||"Unassigned",data:{...ce.data,document_id:qs||St,document_date:Vs.split("T")[0]},status:"created",stage_progress:10,created_at:(es==null?void 0:es.created_at)||Vs,updated_at:(es==null?void 0:es.updated_at)||Vs,shared_channels:[],otp_verified_at:null,completed_at:null,tracking_history:[...ce.tracking_history||[],{id:(((mt=ce.tracking_history)==null?void 0:mt.length)||0)+1,action:"Document Duplicated",timestamp:Vs,user:"Admin User",details:`Duplicated from ${(xt=ce.data)==null?void 0:xt.document_id}`,stage:"created",icon:"Copy"}]}]}),Z.success("Document duplicated successfully!"),await Le()}catch(At){console.error(At),Z.error((At==null?void 0:At.message)||"Duplicate failed")}},Ue=ce=>{We(Re=>Re.map(Te=>Te.id===ce.id?{...Te,status:"archived",updated_at:new Date().toISOString(),tracking_history:[...Te.tracking_history,{id:Te.tracking_history.length+1,action:"Document Archived",timestamp:new Date().toISOString(),user:"Admin User",details:"Document moved to archive",stage:"archived",icon:"Archive"}]}:Te)),alert("Document archived successfully!")},Oe=ce=>new Date(ce).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),rs=()=>[...new Set(Pe.map(Re=>Re.template_name))];return e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-xs",children:"Total Documents"}),e.jsx("p",{className:"text-xl font-bold",children:Pe.length})]}),e.jsx(ws,{size:24,className:"text-blue-200"})]}),e.jsx("div",{className:"mt-1 text-blue-100 text-xs",children:"ðŸ“„ All document types"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-xs",children:"Completed"}),e.jsx("p",{className:"text-xl font-bold",children:Pe.filter(ce=>ce.status==="completed").length})]}),e.jsx(bs,{size:24,className:"text-green-200"})]}),e.jsx("div",{className:"mt-1 text-green-100 text-xs",children:"âœ… Fully processed"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-xs",children:"In Progress"}),e.jsx("p",{className:"text-xl font-bold",children:Pe.filter(ce=>ce.status!=="completed"&&ce.status!=="created").length})]}),e.jsx(Ls,{size:24,className:"text-orange-200"})]}),e.jsx("div",{className:"mt-1 text-orange-100 text-xs",children:"â³ Being processed"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-xs",children:"High Priority"}),e.jsx("p",{className:"text-xl font-bold",children:Pe.filter(ce=>ce.priority==="high").length})]}),e.jsx(ct,{size:24,className:"text-purple-200"})]}),e.jsx("div",{className:"mt-1 text-purple-100 text-xs",children:"ðŸ”¥ Urgent documents"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center space-y-2 lg:space-y-0 lg:space-x-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:a,onChange:ce=>t(ce.target.value),className:`w-full pl-8 pr-2 py-1.5 border border-gray-300 rounded-lg \r
focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-xs`})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>V(!E),className:"flex items-center space-x-1 px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(Na,{size:14}),e.jsx("span",{children:"Filters"})]}),e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-0.5",children:[e.jsx("button",{onClick:()=>R("table"),className:`p-1.5 rounded ${k==="table"?"bg-white shadow-sm":""}`,children:e.jsx(ws,{size:14,className:k==="table"?"text-blue-600":"text-gray-400"})}),e.jsx("button",{onClick:()=>R("cards"),className:`p-1.5 rounded ${k==="cards"?"bg-white shadow-sm":""}`,children:e.jsx(Is,{size:14,className:k==="cards"?"text-blue-600":"text-gray-400"})})]})]})]}),E&&e.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:r,onChange:ce=>i(ce.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"created",children:"Created"}),e.jsx("option",{value:"shared",children:"Shared"}),e.jsx("option",{value:"otp_verified",children:"OTP Verified"}),e.jsx("option",{value:"esign_pending",children:"E-Sign Pending"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:n,onChange:ce=>o(ce.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:[e.jsx("option",{value:"all",children:"All Priority"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Template"}),e.jsxs("select",{value:m,onChange:ce=>g(ce.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",children:[e.jsx("option",{value:"all",children:"All Templates"}),rs().map(ce=>e.jsx("option",{value:ce,children:ce},ce))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{i("all"),o("all"),g("all"),t("")},className:"px-3 py-1.5 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-xs",children:"Reset"})})]})})]}),b.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs font-medium text-blue-700",children:[b.length," document",b.length!==1?"s":""," selected"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:we,className:"px-2.5 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Bulk Share"}),e.jsx("button",{onClick:Be,className:"px-2.5 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700",children:"Bulk Download"}),e.jsx("button",{onClick:Ve,disabled:!b.length&&!pe.length,className:"px-2.5 py-1 bg-purple-600 text-white rounded text-xs hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Bulk Export"}),e.jsx("button",{onClick:Fe,className:"px-2.5 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700",children:"Change Status"})]})]}),e.jsx("button",{onClick:()=>d([]),className:"text-blue-600 hover:text-blue-800",children:e.jsx(ns,{size:14})})]})}),k==="table"?e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsxs("table",{className:"w-full min-w-[900px] border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left w-8 bg-gray-50",children:e.jsx("input",{type:"checkbox",checked:b.length===ze.length&&ze.length>0,onChange:ye,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Document"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Parties"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Property"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Status & Progress"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Timeline"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-xs",children:ze.map(ce=>{const Re=ce.status==="e-sign_pending"?"esign_pending":ce.status,Te=Re==="cancelled",qe=Re==="on_hold";return e.jsxs(Ps.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"checkbox",checked:b.includes(ce.id),onChange:()=>Xe(ce.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(ws,{className:"text-blue-600",size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 text-xs",children:ce.title}),e.jsx("div",{className:"text-gray-500",children:ce.template_name}),e.jsxs("div",{className:"text-gray-400",children:["ID: ",ce.data.document_id]}),e.jsxs("div",{className:"text-gray-400",children:["by ",ce.created_by]})]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Seller:"})," ",ce.data.seller_name]}),ce.data.buyer_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Buyer:"})," ",ce.data.buyer_name]}),e.jsxs("div",{className:"text-gray-500",children:["Assigned to: ",ce.assigned_to]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("div",{className:"font-medium text-gray-900",children:ce.data.property_type}),e.jsxs("div",{className:"text-gray-600",children:[ce.data.property_area," sq ft"]}),e.jsx("div",{className:"text-gray-500 line-clamp-2",children:ce.data.property_address}),ce.data.sale_amount&&e.jsxs("div",{className:"font-medium text-green-600",children:["â‚¹",(ce.data.sale_amount/1e5).toFixed(1),"L"]}),ce.data.token_amount&&e.jsxs("div",{className:"font-medium text-blue-600",children:["Token: â‚¹",(ce.data.token_amount/1e5).toFixed(1),"L"]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"space-y-1",children:[xe(Re),Ee(ce.priority),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[ce.stage_progress,"%"]})]}),Ke(Re,ce.stage_progress)]}),!!ce.shared_channels.length&&e.jsxs("div",{className:"flex items-center space-x-1",children:[ce.shared_channels.includes("email")&&e.jsx(Ds,{size:12,className:"text-blue-500"}),ce.shared_channels.includes("whatsapp")&&e.jsx(tt,{size:12,className:"text-green-500"}),ce.shared_channels.includes("sms")&&e.jsx(Cs,{size:12,className:"text-purple-500"})]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"space-y-0.5 text-gray-500",children:[e.jsxs("div",{children:["Created: ",Oe(ce.created_at)]}),e.jsxs("div",{children:["Updated: ",Oe(ce.updated_at)]}),ce.otp_verified_at&&e.jsxs("div",{className:"text-green-600",children:["OTP: ",Oe(ce.otp_verified_at)]}),ce.completed_at&&e.jsxs("div",{className:"text-blue-600",children:["Done: ",Oe(ce.completed_at)]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx("button",{onClick:()=>Ce(ce),className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded-lg",title:"View Document",children:e.jsx(ks,{size:12})}),e.jsx("button",{onClick:()=>ke(ce),className:"p-1.5 text-green-600 hover:bg-green-100 rounded-lg",title:"Share Document",children:e.jsx(Wt,{size:12})}),e.jsx("button",{onClick:()=>Me(ce),className:"p-1.5 text-purple-600 hover:bg-purple-100 rounded-lg",title:"Download PDF",children:e.jsx(Ys,{size:12})}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(xr,{size:12})}),e.jsx("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:e.jsxs("div",{className:"p-1",children:[e.jsxs("button",{onClick:()=>_(ce),className:"flex items-center space-x-1.5 px-2 py-1 text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(ft,{size:11}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:()=>ae(ce),className:"flex items-center space-x-1.5 px-2 py-1 text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(ct,{size:11}),e.jsx("span",{children:"Delete"})]}),e.jsxs("button",{onClick:()=>Je(ce),className:"flex items-center space-x-1.5 px-2 py-1 text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(Xt,{size:11}),e.jsx("span",{children:"Duplicate"})]}),e.jsxs("button",{onClick:()=>Ue(ce),className:"flex items-center space-x-1.5 px-2 py-1 text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(wh,{size:11}),e.jsx("span",{children:"Archive"})]})]})})]})]})})]}),e.jsx("tr",{className:"",children:e.jsx("td",{colSpan:7,className:"",children:e.jsx("div",{className:" ",children:e.jsxs("div",{className:"p-3 mb-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(EN,{docId:ce.id,currentStatus:Re,disabled:Te,onSynced:({id:as,status:xs,progress:ps,updated_at:ys})=>{We(He=>He.map(vs=>vs.id===as?{...vs,status:xs,stage_progress:typeof ps=="number"?ps:vs.stage_progress,updated_at:ys??vs.updated_at}:vs))},onRequestStep:as=>{switch(as){case"shared":return $(ce),P(!0),!0;case"on_hold":return le(ce),C(["on_hold"]),H("on_hold"),Y([Re]),B(!0),!0;case"completed":return le(ce),C(["completed"]),H("completed"),Y([Re]),B(!0),!0;case"cancelled":return le(ce),C(["cancelled"]),H("cancelled"),Y([Re]),B(!0),!0;case"otp_verified":return he(ce),ue(!0),le(ce),!0;case"esign_pending":return oe(ce),!0;default:return!1}}}),!!(ce.shared_channels&&ce.shared_channels.length)&&e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[ce.shared_channels.includes("email")&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] px-2 py-0.5 bg-blue-50 text-blue-700 rounded-full",children:[e.jsx(Ds,{size:12})," Email"]}),ce.shared_channels.includes("whatsapp")&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] px-2 py-0.5 bg-green-50 text-green-700 rounded-full",children:[e.jsx(tt,{size:12})," WhatsApp"]}),ce.shared_channels.includes("sms")&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] px-2 py-0.5 bg-purple-50 text-purple-700 rounded-full",children:[e.jsx(Cs,{size:12})," SMS"]})]})]}),qe&&e.jsx("div",{className:"mt-2 text-[11px] text-yellow-700 bg-yellow-50 border border-yellow-200 rounded px-2 py-1 inline-block",children:"On Hold â€” advance the step to resume workflow."}),Te&&e.jsx("div",{className:"mt-2 text-[11px] text-red-700 bg-red-50 border border-red-200 rounded px-2 py-1 inline-block",children:"Cancelled â€” stepper disabled; reopen from Actions if allowed."})]})})})})]},ce.id)})})]})})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ze.map(ce=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow text-xs",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:b.includes(ce.id),onChange:()=>Xe(ce.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(ws,{className:"text-blue-600",size:18})})]}),e.jsx("div",{className:"flex items-center space-x-1",children:xe(ce.status)})]}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:ce.title}),e.jsx("p",{className:"text-gray-600 mb-2",children:ce.template_name}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Seller:"})," ",ce.data.seller_name]}),ce.data.buyer_name&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Buyer:"})," ",ce.data.buyer_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Property:"})," ",ce.data.property_type," â€¢ ",ce.data.property_area," sq ft"]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Ee(ce.priority),e.jsx("div",{className:"text-gray-500",children:Oe(ce.created_at)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[ce.stage_progress,"%"]})]}),Ke(ce.status,ce.stage_progress)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Ce(ce),className:"flex-1 bg-blue-600 text-white py-1.5 px-2 rounded-lg hover:bg-blue-700 transition-colors text-xs",children:"View"}),e.jsx("button",{onClick:()=>ke(ce),className:"p-1.5 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",children:e.jsx(Wt,{size:14})}),e.jsx("button",{onClick:()=>Me(ce),className:"p-1.5 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200 transition-colors",children:e.jsx(Ys,{size:14})})]})]},ce.id))}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 px-4 py-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-gray-700",children:["Showing ",Ie+1,"-",Math.min(Ie+j,pe.length)," of ",pe.length]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>T(ce=>Math.max(ce-1,1)),disabled:F===1,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Wa,{size:14})}),e.jsxs("div",{className:"flex items-center space-x-0.5",children:[Array.from({length:Math.min(5,O)},(ce,Re)=>{const Te=Re+1;return e.jsx("button",{onClick:()=>T(Te),className:`px-2 py-1 rounded text-xs ${F===Te?"bg-blue-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:Te},Te)}),O>5&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-1 text-xs",children:"..."}),e.jsx("button",{onClick:()=>T(O),className:`px-2 py-1 rounded text-xs ${F===O?"bg-blue-600 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:O})]})]}),e.jsx("button",{onClick:()=>T(ce=>Math.min(ce+1,O)),disabled:F===O,className:"p-1.5 rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pa,{size:14})})]})]})}),W&&e.jsx(KN,{isOpen:W,onClose:()=>{B(!1),le(null),C(void 0)},selectedCount:ne?1:b.length,onStatusChange:async(ce,Re)=>{const Te=(ne==null?void 0:ne.id)??null;Te&&(await $e(Te,ve(ce),Re||"-"),B(!1),le(null),C(void 0))},initialStatus:I,currentStatuses:h,allowedStatuses:S}),f&&e.jsx(TN,{isOpen:f,onClose:()=>{p(!1),$(null)},document:w}),v&&e.jsx(AN,{isOpen:v,onClose:()=>{x(!1),$(null)},document:w,userRole:y,onSave:Ye}),u&&e.jsx(PN,{isOpen:u,onClose:()=>{c(!1),$(null)},document:w,userRole:y,onSubmit:ie}),se&&ee&&e.jsx(qN,{isOpen:se,onClose:()=>{ge(!1),de(null),le(null)},documentId:ee.id,defaultBuyer:{name:((ms=ee.data)==null?void 0:ms.buyer_name)||"",email:((cs=ee.data)==null?void 0:cs.buyer_email)||"",phone:((gs=ee.data)==null?void 0:gs.buyer_phone)||""},defaultSeller:{name:((Ne=ee.data)==null?void 0:Ne.seller_name)||"",email:((Ze=ee.data)==null?void 0:Ze.seller_email)||"",phone:((ls=ee.data)==null?void 0:ls.seller_phone)||""},onProgress:async ce=>{const{docId:Re,payload:Te}=ce,qe=(Te==null?void 0:Te.sessionIds)??(Te==null?void 0:Te.session_ids)??(Te==null?void 0:Te.sessions)??[];if(!qe||!Array.isArray(qe)){console.error("[TrackingTab] âŒ BLOCKED: Invalid sessionIds",qe);return}if(qe.length<2){console.error("[TrackingTab] âŒ BLOCKED: Incomplete sessions",{expected:2,received:qe.length,sessions:qe}),Z.error("Both Buyer and Seller must verify before updating status!");return}try{await $e(Number(Re),"esign_pending","Aadhaar OTP verified for both parties; signing in progress"),Z.success("[TrackingTab] âœ… Status updated successfully")}catch(as){console.error("[TrackingTab] âŒ Status update failed:",as),Z.error("Failed to update document status")}},onBothSigned:async({docId:ce})=>{await $e(Number(ce),"completed","Both parties signed via Aadhaar eSign"),ge(!1),de(null),le(null)}}),U&&re&&e.jsx(WN,{isOpen:U,onClose:()=>{X(!1),fe(null),me(null),le(null)},doc:re,details:G,onResumeEsign:()=>{X(!1),de(re),ge(!0)},onMarkCompleted:async()=>{re&&(await $e(re.id,"completed","Marked completed from DigioStatusModal"),X(!1),fe(null),me(null),le(null))}}),J&&Q&&e.jsx(MN,{isOpen:J,documentId:Q.id,defaultBuyer:{name:(($s=Q.data)==null?void 0:$s.buyer_name)||"",email:((Gs=Q.data)==null?void 0:Gs.buyer_email)||"",phone:((Se=Q.data)==null?void 0:Se.buyer_phone)||""},defaultSeller:{name:((Ge=Q.data)==null?void 0:Ge.seller_name)||"",email:((z=Q.data)==null?void 0:z.seller_email)||"",phone:((te=Q.data)==null?void 0:te.seller_phone)||""},onClose:()=>{ue(!1),he(null),le(null)},onVerified:async ce=>{const{note:Re,buyer:Te,seller:qe}=ce;if(!ne)return;let as="";Te!=null&&Te.verified&&(qe!=null&&qe.verified)?as="Both parties verified":Te!=null&&Te.verified?as="Buyer verified only":qe!=null&&qe.verified&&(as="Seller verified only");const xs=Re?`${as}: ${Re}`:as;await $e(ne.id,"otp_verified",xs),ue(!1),he(null),le(null)}}),N&&w&&e.jsx(IN,{isOpen:N,onClose:()=>{P(!1),$(null)},document:w,onShare:ce=>{try{We(Re=>Re.map(Te=>{var qe,as;return Te.id===w.id?{...Te,status:((qe=ce==null?void 0:ce.snapshot)==null?void 0:qe.current_status)||"shared",stage_progress:typeof((as=ce==null?void 0:ce.snapshot)==null?void 0:as.progress_pct)=="number"?ce.snapshot.progress_pct:Te.stage_progress,shared_channels:Array.from(new Set([...Te.shared_channels||[],...ce.channels||[]])),tracking_history:[...Te.tracking_history,{id:Te.tracking_history.length+1,action:`Shared via ${ce.channels.join(", ")}`,timestamp:new Date().toISOString(),user:"Admin User",details:ce.message||"Shared",stage:"shared",icon:"Send"}]}:Te}))}catch(Re){console.error("Share UI update failed:",Re),alert("Share UI update failed")}finally{P(!1),$(null)}}})]})},KN=({isOpen:s,onClose:a,selectedCount:t,onStatusChange:r,initialStatus:i="",currentStatuses:n=[],allowedStatuses:o})=>{const[m,g]=l.useState(i||""),[b,d]=l.useState("");if(l.useEffect(()=>{g(i||""),d("")},[i,s]),!s)return null;const v=[{value:"created",label:"Created",description:"Document is created but not shared"},{value:"shared",label:"Shared",description:"Document has been shared with parties"},{value:"otp_verified",label:"OTP Verified",description:"Identity verification completed"},{value:"esign_pending",label:"E-Sign Pending",description:"Awaiting digital signature"},{value:"completed",label:"Completed",description:"All processes finished"},{value:"on_hold",label:"On Hold",description:"Document processing paused"},{value:"cancelled",label:"Cancelled",description:"Document cancelled"}],x=o!=null&&o.length?v.filter(c=>o.includes(c.value)):v,u=()=>{if(!m)return alert("Please select a status");if(!b.trim())return alert("Please provide a reason for status change");r(m,b),g(""),d("")};return(()=>{if(!(n!=null&&n.length))return null;const c=n.every(f=>f===n[0]);return e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:c?e.jsxs(e.Fragment,{children:["Current status: ",e.jsx("span",{className:"font-medium",children:n[0]})]}):e.jsxs(e.Fragment,{children:["Current statuses: ",e.jsx("span",{className:"font-medium",children:Array.from(new Set(n)).join(", ")})]})})})(),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 !mt-0",children:e.jsxs("div",{className:`bg-white w-full max-w-2xl rounded-2xl shadow-2xl\r
                      max-h-[85vh] sm:max-h-[90vh] flex flex-col overflow-hidden`,children:[e.jsx("div",{className:"p-6 border-b border-gray-200 shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Change Document Status"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Update status for ",t," selected documents"]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["New Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"space-y-2",children:x.map(c=>e.jsxs("label",{className:"flex items-start space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"status",value:c.value,checked:m===c.value,onChange:f=>g(f.target.value),className:"mt-1 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:c.label}),e.jsx("div",{className:"text-sm text-gray-600",children:c.description})]})]},c.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for Change ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:b,onChange:c=>d(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Please provide a reason for changing the status...",required:!0})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["This will update ",t," documents"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:u,disabled:!m||!b.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Update Status"})]})]})})]})})},pl={getAll:async()=>(await Ae.get("/doctemplates/getall")).data.data,getById:async s=>(await Ae.get(`/doctemplates/getbyid/${s}`)).data.data,create:async s=>{const a=await Ae.post("/doctemplates/create",s);return a.data.data||a.data},update:async(s,a)=>(await Ae.put(`/doctemplates/update/${s}`,a)).data,delete:async s=>(await Ae.delete(`/doctemplates/delete/${s}`)).data,useTemplate:async s=>(await Ae.post(`/doctemplates/${s}/use`)).data};function JN(s){if(!s)return"â€”";const a=new Date(s);if(isNaN(a.getTime()))return"â€”";const r=new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"}).formatToParts(a),i={};for(const m of r)i[m.type]=m.value;const n=`${i.day}/${i.month}/${i.year}`,o=`${i.hour}:${i.minute}${i.dayPeriod?" "+i.dayPeriod.toUpperCase():""}`;return`${n} ${o}`}const $c=[{id:"all",label:"All Templates",icon:ws},{id:"agency",label:"Agency",icon:Is},{id:"deal",label:"Deal",icon:Cl},{id:"society",label:"Society",icon:Ns},{id:"handover",label:"Handover",icon:Pa},{id:"banking",label:"Banking",icon:Ut}],QN=[{id:"all",label:"All Status"},{id:"active",label:"Active"},{id:"draft",label:"Draft"},{id:"archived",label:"Archived"}],vg=()=>new Date().toISOString();function Za(s){if(s==null)return"";try{return String(s).toLowerCase()}catch{return""}}function ZN(s){const a=Za(s);return a==="active"?"bg-green-100 text-green-700 border border-green-200":a==="draft"?"bg-amber-100 text-amber-700 border border-amber-200":a==="archived"?"bg-gray-100 text-gray-600 border border-gray-200":"bg-gray-100 text-gray-600 border-gray-200"}function kx(s){return(Array.isArray(s==null?void 0:s.data)?s.data:Array.isArray(s)?s:[]).map(t=>({id:t.id,name:t.name??"",description:t.description??"",category:Za((t==null?void 0:t.category)??""),variables:Array.isArray(t.variables)?t.variables:[],lastUsed:t.last_used_at||t.last_used||t.lastUsed||"",usageCount:typeof t.usageCount=="number"?t.usageCount:typeof t.usage_count=="number"?t.usage_count:0,status:Za(t.status??"draft"),content:t.content,created_at:t.created_at,updated_at:t.updated_at,created_by:t.created_by??null,updated_by:t.updated_by??null,created_by_name:t.created_by_name||"",updated_by_name:t.updated_by_name||"",...t}))}function XN(s){const a=$c.find(t=>t.id===Za(s||""));return a?a.icon:ws}function wi(s){return{template_id:s.id,name:(s.name||"Untitled Document").trim(),description:s.description||null,category:s.category||null,content:s.content||null,variables:{template_name:s.name||null,template_category:s.category||null,template_updated_at:s.updated_at||null,started_at:vg()}}}const Ng=({templates:s,onSelectTemplate:a,onCreateTemplate:t,onEditTemplate:r,onDeleteTemplate:i,onDuplicateTemplate:n,mode:o="select",autoCreateGenerated:m=!1})=>{const g=o==="select"&&Array.isArray(s),[b,d]=l.useState(""),[v,x]=l.useState("all"),[u,c]=l.useState("all"),[f,p]=l.useState(s??[]),[N,P]=l.useState(!g),[w,$]=l.useState(""),[y,k]=l.useState(null);l.useEffect(()=>{g&&(p(kx(s)),P(!1),$(""))},[g,s]),l.useEffect(()=>{g||(async()=>{P(!0),$("");try{const B=await pl.getAll(),M=kx(B).map(A=>{var L,D,I,H;return{...A,created_by_name:A.created_by_name||((L=A.created_by_user)==null?void 0:L.name)||((D=A.creator)==null?void 0:D.name)||"â€”",updated_by_name:A.updated_by_name||((I=A.updated_by_user)==null?void 0:I.name)||((H=A.updater)==null?void 0:H.name)||"â€”"}});p(M)}catch{$("Failed to fetch templates."),p([])}finally{P(!1)}})()},[g,o]);const R=l.useMemo(()=>o==="select"?f.filter(B=>Za(B.status||"draft")==="active"):f,[f,o]),F=l.useMemo(()=>{const B=Za(b.trim());return R.filter(M=>{const A=Za(M.name||""),L=Za(M.description||""),D=Za(M.category||""),I=Za(M.status||"draft");return(!B||A.includes(B)||L.includes(B))&&(v==="all"||D===v)&&(o==="select"?!0:u==="all"||I===u)})},[R,b,v,u,o]),T=B=>{o==="select"&&a?a({...B,_pendingGeneratedPayload:wi(B)}):o==="manage"&&r&&r(B)},j=(B,M)=>{M.stopPropagation(),r==null||r(B)},E=(B,M)=>{M.stopPropagation(),i==null||i(B)},V=(B,M)=>{M.stopPropagation(),n==null||n(B)},W=async(B,M)=>{if(M.stopPropagation(),o!=="select")return;const A=B.id;k(A);const L={...B,usageCount:(B.usageCount??0)+1,lastUsed:vg()};p(D=>D.map(I=>I.id===A?L:I));try{const D=await pl.useTemplate(A),I=(D==null?void 0:D.data)||(D==null?void 0:D.template)||D||null,H=I?{...B,...I,usageCount:typeof I.usage_count=="number"?I.usage_count:typeof I.usageCount=="number"?I.usageCount:L.usageCount,lastUsed:I.last_used_at||I.last_used||I.lastUsed||L.lastUsed}:L;if(p(K=>K.map(q=>q.id===A?H:q)),!m){a==null||a({...H,_pendingGeneratedPayload:wi(H)});return}const h={...wi(H),status:"draft"},Y=await ot.create(h);a==null||a({...H,_generatedDoc:Y})}catch(D){console.error("useTemplate API failed:",D),a==null||a({...L,_pendingGeneratedPayload:wi(L)})}finally{k(null)}};return e.jsxs("div",{className:"space-y-6 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("h2",{className:"font-bold text-gray-900",children:o==="select"?"Select Template":"Template Management"})}),o==="manage"&&t&&e.jsxs("button",{onClick:t,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{size:12}),e.jsx("span",{children:"Create New Template"})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:12}),e.jsx("input",{type:"text",placeholder:"Search templates by name, description...",value:b,onChange:B=>d(B.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-xs"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Na,{size:12,className:"text-gray-500"}),e.jsx("select",{value:v,onChange:B=>x(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-w-[160px] text-xs bg-white",children:$c.map(B=>e.jsx("option",{value:B.id,children:B.label},B.id))})]}),o==="manage"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Na,{size:12,className:"text-gray-500"}),e.jsx("select",{value:u,onChange:B=>c(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-w-[140px] text-xs bg-white",children:QN.map(B=>e.jsx("option",{value:B.id,children:B.label},B.id))})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:$c.map(B=>{const M=B.icon;return e.jsxs("button",{onClick:()=>x(B.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors whitespace-nowrap ${v===B.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-50 border border-transparent"} text-xs`,children:[e.jsx(M,{size:12}),e.jsx("span",{className:"font-medium",children:B.label})]},B.id)})})}),N&&e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 text-center text-xs",children:"Loading templatesâ€¦"}),!N&&w&&e.jsx("div",{className:"bg-white rounded-lg border border-red-200 p-6 text-center text-xs text-red-600",children:w}),!N&&!w&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 max-h-96 overflow-y-auto",children:F.map(B=>{const M=XN(B.category),A=Array.isArray(B.variables)?B.variables:[],L=typeof B.usageCount=="number"?B.usageCount:0,D=Za(B.status||"draft"),I=y===B.id,H=(B.created_by_name||"").trim()||"â€”",h=(B.updated_by_name||"").trim()||"â€”",Y=JN(B.lastUsed);return e.jsxs("div",{className:"relative bg-white rounded-lg border border-gray-200 hover:shadow-lg transition-all cursor-pointer group hover:border-blue-300 text-xs",onClick:()=>T(B),children:[(o==="manage"||D==="active")&&e.jsx("div",{className:"absolute right-3 top-3 z-10",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-md text-[10px] font-semibold ${ZN(D)}`,children:D||"draft"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-blue-50 ring-1 ring-blue-100 flex items-center justify-center group-hover:bg-blue-100 transition-colors",children:e.jsx(M,{className:"text-blue-600",size:16})}),e.jsx("span",{className:"px-2 py-1 rounded-md bg-gray-100 text-gray-700 text-[11px] font-medium capitalize",children:B.category||"general"}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:[L," uses "," ","Last used: ",e.jsx("span",{className:"font-medium text-gray-700",children:Y})]})]})}),o==="manage"&&e.jsxs("div",{className:"flex items-center space-x-1 mb-3",children:[e.jsx("button",{onClick:K=>j(B,K),className:"p-1 rounded bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",title:"Edit Template",children:e.jsx(ft,{size:10})}),e.jsx("button",{onClick:K=>V(B,K),className:"p-1 rounded bg-green-100 text-green-600 hover:bg-green-200 transition-colors",title:"Duplicate Template",children:e.jsx(Xt,{size:10})}),e.jsx("button",{onClick:K=>E(B.id,K),className:"p-1 rounded bg-red-100 text-red-600 hover:bg-red-200 transition-colors",title:"Delete Template",children:e.jsx(Es,{size:10})})]}),e.jsx("h3",{className:"font-bold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors",children:B.name||"Untitled"}),e.jsx("p",{className:"text-gray-600 mb-4",children:B.description||"â€”"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500 uppercase",children:"Variables:"}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[A.slice(0,3).map((K,q)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded",children:K},`${B.id}-var-${q}-${K}`)),A.length>3&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded",children:["+",A.length-3," more"]}),A.length===0&&e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-500 rounded",children:"None"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-1 text-[11px] text-gray-600 mb-3",children:e.jsxs("div",{className:"flex flex-wrap gap-x-3 gap-y-1",children:[e.jsxs("span",{children:[e.jsx("span",{className:"text-gray-500",children:"Created by:"})," ",e.jsx("span",{className:"font-medium",children:H})]}),e.jsxs("span",{children:[e.jsx("span",{className:"text-gray-500",children:"Updated by:"})," ",e.jsx("span",{className:"font-medium",children:h})]})]})}),e.jsx("button",{onClick:K=>o==="select"?W(B,K):j(B,K),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-60",disabled:I,children:o==="select"?I?"Startingâ€¦":"Use Template":"Manage Template"})]})]})]},B.id)})}),F.length===0&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center text-xs",children:[e.jsx(ws,{className:"mx-auto text-gray-300 mb-4",size:40}),e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Try adjusting your search or category."}),o==="manage"&&t&&e.jsxs("button",{onClick:t,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors mx-auto",children:[e.jsx(fs,{size:12}),e.jsx("span",{children:"Create New Template"})]})]})]})]})},ew=`<title>RESALE EXPERT</title><style>
body{background:#ccc;font-size:13px;font-family:Verdana, sans-serif;line-height:1.3}
#printDialog{width:210mm;margin:0 auto;}
.main-page{width:210mm;min-height:297mm;margin:10mm auto;background:white;box-shadow:0 0 5px rgba(0,0,0,0.5);}
.sub-page{margin:20px 40px;}
@page{size:A4;margin:0;}
@media print{html,body{width:210mm;height:297mm;}.main-page{margin:0;box-shadow:none;page-break-after:always;}}
</style>`,sw=`<title>RESALE EXPERT</title><style>
body{background:#ccc;font-size:13px;font-family:Verdana, sans-serif;line-height:1.3}
#printDialog{width:216mm;margin:0 auto;}
.main-page{width:216mm;min-height:356mm;margin:10mm auto;background:white;box-shadow:0 0 5px rgba(0,0,0,0.5);}
.sub-page{margin:20px 40px;}
@page{size:Legal;margin:0;}
@media print{html,body{width:216mm;height:356mm;}.main-page{margin:0;box-shadow:none;page-break-after:always;}}
</style>`;function tw(s){const a=Number(s);return isFinite(a)?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(a):"â€”"}function aw(s){if(!s)return"â€”";const a=new Date(s);return isNaN(a.getTime())?String(s):`${String(a.getDate()).padStart(2,"0")}-${String(a.getMonth()+1).padStart(2,"0")}-${a.getFullYear()}`}function rw(s,a){const t=s.toLowerCase();return/(amount|price|sale|token|booking)/.test(t)?tw(a):/(date|_at)$/.test(t)?aw(a):a===0?"0":a??"â€”"}function lw(s,a){if(!a)return;const t=a.split(".");let r=s;for(const i of t){if(r==null)return;r=r[i]}return r}function Cx(s,a,t){const r=new Date().toISOString().slice(0,10),i={...a,template_name:t??"",_today:r};return s.replace(/{{\s*([a-zA-Z0-9_\.]+)\s*}}/g,(n,o)=>{const m=lw(i,o),g=rw(o,m);return String(g)})}function nw({template:s,documentData:a,isVisible:t=!0,pageType:r="A4",documentId:i,onEnsureSaved:n}){const[o,m]=l.useState("preview"),[g,b]=l.useState(!1),[d,v]=l.useState(r),x=l.useRef(null),[u,c]=l.useState(800),[f,p]=l.useState(!1),N=l.useMemo(()=>"",[]),P=l.useMemo(()=>{const y=(s==null?void 0:s.css)??(d==="Legal"?sw:ew),k=s!=null&&s.content?Cx(s.content,a??{},s==null?void 0:s.name):N,F=/id\s*=\s*["']printDialog["']/.test(k)||/class\s*=\s*["'][^"']*\bmain-page\b/.test(k)?k:`<div id="printDialog"><div class="main-page"><div class="sub-page">${k}</div></div></div>`,T=`<!doctype html><html><head><meta charset="utf-8" />${y}
      <style>html,body{margin:0;padding:0;-webkit-print-color-adjust:exact;overflow:auto;}</style>
      </head><body>${F}</body></html>`;return Wh.sanitize(T,{ADD_TAGS:["style"],KEEP_CONTENT:!0})},[s==null?void 0:s.css,s==null?void 0:s.content,d,a,N,s==null?void 0:s.name]);if(l.useEffect(()=>{const y=x.current;if(!y)return;const k=()=>{var j;const R=y.contentDocument;if(!R)return;const F=R.documentElement,T=Math.max(F.scrollHeight,((j=R.body)==null?void 0:j.scrollHeight)??0)+5;c(T)};return y.addEventListener("load",k),()=>{y.removeEventListener("load",k)}},[P]),!t)return null;const w=()=>{var k;const y=(k=x.current)==null?void 0:k.contentWindow;y&&(y.focus(),y.print())},$=async()=>{try{if(p(!0),n&&await n(),!i){alert("Document not saved yet. Please save or generate first.");return}await ot.downloadPdf(i,{page:d.toLowerCase(),filenameFallback:`${((s==null?void 0:s.name)||"document").toString().replace(/[^\w\-]+/g,"_")}.pdf`})}catch(y){console.error("PDF download failed:",y),alert(y instanceof Error?y.message:"Failed to download PDF")}finally{p(!1)}};return e.jsxs("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${g?"fixed inset-0 z-50 p-6 bg-white flex flex-col":""}`,children:[e.jsxs("div",{className:"p-3 border-b border-gray-100 flex items-center justify-between gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m("preview"),className:`p-2 rounded-md ${o==="preview"?"bg-blue-50 text-blue-700":"bg-gray-50 hover:bg-gray-100"}`,title:"Preview",children:e.jsx(ks,{size:16})}),e.jsx("button",{onClick:()=>m("code"),className:`p-2 rounded-md ${o==="code"?"bg-blue-50 text-blue-700":"bg-gray-50 hover:bg-gray-100"}`,title:"HTML",children:e.jsx(rn,{size:16})}),e.jsxs("div",{className:"ml-2 flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Page:"}),e.jsxs("select",{value:d,onChange:y=>v(y.target.value),className:"px-2 py-1 border rounded bg-white text-sm",children:[e.jsx("option",{value:"A4",children:"A4"}),e.jsx("option",{value:"Legal",children:"Legal"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:w,title:"Print",className:"p-2 rounded-md bg-gray-50 hover:bg-gray-100",children:e.jsx(ku,{size:16})}),e.jsx("button",{onClick:$,disabled:f,title:f?"Downloading...":"Download PDF",className:`p-2 rounded-md ${f?"bg-gray-100 text-gray-400":"bg-gray-50 hover:bg-gray-100"}`,children:e.jsx(Ys,{size:16})}),e.jsx("button",{title:g?"Exit fullscreen":"Fullscreen",onClick:()=>b(y=>!y),className:"p-2 rounded-md bg-gray-50 hover:bg-gray-100",children:g?e.jsx(Wc,{size:16}):e.jsx(Vn,{size:16})})]})]}),o==="preview"?e.jsx("div",{className:g?"overflow-auto flex-grow flex justify-center":"flex justify-center",children:e.jsx("iframe",{ref:x,title:(s==null?void 0:s.name)??"Document Preview",style:{width:"100%",height:u,border:"0",background:"#eee"},srcDoc:P})}):e.jsx("div",{className:"bg-gray-900 text-green-300 p-3 rounded font-mono text-xs overflow-auto",style:{maxHeight:g?"calc(100vh - 80px)":520},children:e.jsx("pre",{className:"whitespace-pre-wrap break-words",children:s!=null&&s.content?Cx(s.content,a??{},s==null?void 0:s.name):N})})]})}function iw(s){return Array.isArray(s)?s:Array.isArray(s==null?void 0:s.data)?s.data:Array.isArray(s==null?void 0:s.rows)?s.rows:Array.isArray(s==null?void 0:s.items)?s.items:[]}const ow=({count:s=6})=>e.jsx("div",{className:"animate-pulse grid grid-cols-1 md:grid-cols-2 gap-3",children:Array.from({length:s}).map((a,t)=>e.jsx("div",{className:"p-3 border rounded-lg bg-gray-50 border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-200"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})},t))}),Ax=({onSelect:s,onClose:a,title:t="Select Client",mode:r="buyer"})=>{const[i,n]=l.useState(""),[o,m]=l.useState([]),[g,b]=l.useState(!1),[d,v]=l.useState(""),x=l.useCallback(async()=>{b(!0),v("");try{const p=await(r==="buyer"?Vt.getAll:st.getAll)(),P=iw(p).map(w=>({id:w.id??w._id??w.buyer_id??w.seller_id,name:w.name??w.full_name??w.company_name??"Unnamed",phone:w.phone??w.mobile??w.whatsapp??"",email:w.email??"",address:w.address??w.location??"",salutation:w.salutation??"",type:w.type??(w.company_name?"Company":"Individual"),...w}));m(P)}catch(f){console.error("load clients failed:",f),v("Failed to load list"),m([])}finally{b(!1)}},[r]);l.useEffect(()=>{x()},[x]),l.useEffect(()=>{const f=setTimeout(()=>{},300);return()=>clearTimeout(f)},[i]);const u=l.useMemo(()=>{if(!i)return o;const f=i.toLowerCase();return o.filter(p=>(p.name||"").toLowerCase().includes(f)||(p.email||"").toLowerCase().includes(f)||(p.phone||"").includes(i))},[o,i]),c=f=>String(f).toLowerCase()==="company"?{card:"bg-purple-50 border-purple-200 hover:bg-purple-100",iconBg:"bg-purple-100"}:{card:"bg-green-50 border-green-200 hover:bg-green-100",iconBg:"bg-green-100"};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 text-xs",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-bold text-gray-900",children:t||(r==="buyer"?"Select Buyer":"Select Seller")}),e.jsx("button",{onClick:a,className:"p-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",children:e.jsx(ns,{size:16})})]})}),e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:`Search ${r} by name, phone, or email...`,value:i,onChange:f=>n(f.target.value),className:"w-full pl-9 pr-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("button",{className:"flex items-center space-x-1.5 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add New"})]})]}),!!d&&!g&&e.jsx("div",{className:"mt-2 text-red-600",children:d})]}),e.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:g?e.jsx(ow,{count:6}):u.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-8",children:["No ",r,"s found"]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:u.map(f=>{const p=c(f.type);return e.jsx("div",{onClick:()=>s(f),className:`p-3 border rounded-lg cursor-pointer transition-all ${p.card}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p.iconBg}`,children:e.jsx(Ms,{size:16,className:"text-gray-700"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[f.salutation," ",f.name]}),e.jsx("p",{className:"text-gray-500 mb-1 capitalize",children:f.type||(r==="seller"?"Seller":"Buyer")}),e.jsxs("div",{className:"space-y-1",children:[(f.phone||f.whatsapp)&&e.jsxs("div",{className:"flex items-center space-x-1.5 text-gray-600",children:[e.jsx(Cs,{size:12,className:"text-green-600"}),e.jsx("span",{children:f.phone||f.whatsapp})]}),f.email&&e.jsxs("div",{className:"flex items-center space-x-1.5 text-gray-600",children:[e.jsx(Ds,{size:12,className:"text-blue-600"}),e.jsx("span",{children:f.email})]}),f.address&&e.jsxs("div",{className:"flex items-center space-x-1.5 text-gray-600",children:[e.jsx(Qs,{size:12,className:"text-red-600"}),e.jsx("span",{children:f.address})]})]})]})]}),e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Select"})]})},String(f.id??f.email??Math.random()))})})})]})})};function cw(s){return Array.isArray(s)?s:Array.isArray(s==null?void 0:s.data)?s.data:Array.isArray(s==null?void 0:s.rows)?s.rows:Array.isArray(s==null?void 0:s.items)?s.items:[]}const Px=(s,a)=>{var i;if(!a)return!0;const t=String(a);return[s.seller_id,(i=s==null?void 0:s.seller)==null?void 0:i.id].map(n=>n==null?void 0:String(n)).some(n=>n===t)},dw=s=>{const a=Number(String(s).replace(/[, ]/g,""));return Number.isFinite(a)?a:void 0},_i=s=>{if(!s)return[];if(Array.isArray(s))return s.filter(Boolean).map(a=>String(a).trim());if(typeof s=="string"){try{const a=JSON.parse(s);if(Array.isArray(a))return a.filter(Boolean).map(t=>String(t).trim())}catch{}return s.split(/[;,]+/g).map(a=>a.trim()).filter(Boolean)}return[]},mw=s=>{if(s!=null&&s.length)return s.find(Boolean)},xw=s=>{const a=dw(s);if(a==null)return"";try{return new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(a)}catch{return String(a)}};function uw(s){return[s==null?void 0:s.society_name,[s==null?void 0:s.wing,s==null?void 0:s.unit_no].filter(Boolean).join("-")||void 0,s==null?void 0:s.city_name].filter(Boolean).join(" â€¢ ")||"Property"}function gw(s){return(s==null?void 0:s.property_subtype_name)||(s==null?void 0:s.property_type_name)||(s==null?void 0:s.unit_type)||(s==null?void 0:s.type)||"Apartment"}function hw(s){const a=[s==null?void 0:s.address,s==null?void 0:s.location_name,s==null?void 0:s.city_name].filter(Boolean).map(t=>String(t));return Array.from(new Set(a)).join(", ")}function pw(s){return(s==null?void 0:s.status)||(s==null?void 0:s.status_raw)||"â€”"}function Tx(s){var g;const a=_i(s==null?void 0:s.amenities),t=_i(s==null?void 0:s.furnishing_items),r=_i(s==null?void 0:s.nearby_places),i=_i(s==null?void 0:s.photos),n=(s==null?void 0:s.final_price)??(s==null?void 0:s.budget)??(s==null?void 0:s.price),o=(s==null?void 0:s.carpet_area)??(s==null?void 0:s.area)??(s==null?void 0:s.carpet),m=(s==null?void 0:s.builtup_area)??(s==null?void 0:s.builtup)??(s==null?void 0:s.super_builtup);return{id:s.id??s.property_id??s._id,title:uw(s),address:hw(s),type:gw(s),area:o,floor:(s==null?void 0:s.floor)??(s==null?void 0:s.floor_raw)??"",facing:(s==null?void 0:s.facing)??"",price:n,status:pw(s),developer:(s==null?void 0:s.developer)??(s==null?void 0:s.builder)??"",society:(s==null?void 0:s.society_name)??(s==null?void 0:s.society)??(s==null?void 0:s.project)??"",parking:[s==null?void 0:s.parking_type,s!=null&&s.parking_qty?`Ã—${s.parking_qty}`:void 0].filter(Boolean).join(" ")||"",amenities:a,image:(s==null?void 0:s.image)??(s==null?void 0:s.cover_image)??mw(i),seller_name:s==null?void 0:s.seller_name,seller_id:(s==null?void 0:s.seller_id)??((g=s==null?void 0:s.seller)==null?void 0:g.id),lead_id:s==null?void 0:s.lead_id,assigned_to:s==null?void 0:s.assigned_to,property_type_name:s==null?void 0:s.property_type_name,property_subtype_name:s==null?void 0:s.property_subtype_name,unit_type:s==null?void 0:s.unit_type,wing:s==null?void 0:s.wing,unit_no:s==null?void 0:s.unit_no,furnishing:s==null?void 0:s.furnishing,bedrooms:s==null?void 0:s.bedrooms,bathrooms:s==null?void 0:s.bathrooms,parking_type:s==null?void 0:s.parking_type,parking_qty:s==null?void 0:s.parking_qty,city_name:s==null?void 0:s.city_name,location_name:s==null?void 0:s.location_name,society_name:s==null?void 0:s.society_name,floor_raw:(s==null?void 0:s.floor)??(s==null?void 0:s.floor_raw),total_floors:s==null?void 0:s.total_floors,carpet_area:o,builtup_area:m,budget:s==null?void 0:s.budget,price_type:s==null?void 0:s.price_type,final_price:s==null?void 0:s.final_price,status_raw:s==null?void 0:s.status,lead_source:s==null?void 0:s.lead_source,possession_month:s==null?void 0:s.possession_month,possession_year:s==null?void 0:s.possession_year,purchase_month:s==null?void 0:s.purchase_month,purchase_year:s==null?void 0:s.purchase_year,selling_rights:s==null?void 0:s.selling_rights,ownership_doc_path:s==null?void 0:s.ownership_doc_path,photos:i,furnishing_items:t,nearby_places:r,description:s==null?void 0:s.description,created_at:s==null?void 0:s.created_at,updated_at:s==null?void 0:s.updated_at,is_public:s==null?void 0:s.is_public,publication_date:s==null?void 0:s.publication_date,created_by:s==null?void 0:s.created_by,updated_by:s==null?void 0:s.updated_by,public_views:s==null?void 0:s.public_views,public_inquiries:s==null?void 0:s.public_inquiries,slug:s==null?void 0:s.slug,...s}}const bw=({onSelect:s,onClose:a,title:t="Select Property",sellerId:r,prefetchedItems:i})=>{const[n,o]=l.useState(""),[m,g]=l.useState([]),[b,d]=l.useState(!1),[v,x]=l.useState(""),u=l.useCallback(async()=>{d(!0),x("");try{if(i&&i.length){const $=i.map(Tx),y=r?$.filter(k=>Px(k,r)):$;g(y);return}let N;if(r&&typeof As.getBySellerId=="function")N=await As.getBySellerId(r);else if(typeof As.getProperties=="function")N=await As.getProperties({seller_id:r});else if(typeof As.getAll=="function")N=await As.getAll({seller_id:r});else throw new Error("propertiesAPI method not available");const P=cw(N).map(Tx),w=r?P.filter($=>Px($,r)):P;g(w)}catch(N){console.error("Failed to load properties:",N),x("Failed to load properties"),g([])}finally{d(!1)}},[i,r]);l.useEffect(()=>{u()},[u]);const c=l.useMemo(()=>{const N=n.toLowerCase();return N?m.filter(P=>[P.title,P.address,P.type,P.id,P.city_name,P.location_name,P.society_name,P.wing,P.unit_no,P.slug,P.seller_name,P.status,P.price_type].map($=>$==null?"":String($).toLowerCase()).some($=>$.includes(N))):m},[m,n]),f=N=>{switch(N.toLowerCase()){case"swimming pool":return e.jsx(Fc,{className:"text-blue-500",size:12});case"gym":return e.jsx(Bc,{className:"text-red-500",size:12});case"security":return e.jsx(at,{className:"text-green-500",size:12});case"garden":case"private garden":return e.jsx(vr,{className:"text-green-600",size:12});case"kids play area":return e.jsx(Ns,{className:"text-purple-500",size:12});case"high speed internet":case"internet":return e.jsx(ao,{className:"text-blue-600",size:12});default:return e.jsx(yt,{className:"text-gray-500",size:12})}},p=N=>{const P=String(N??"").toLowerCase();return P.includes("villa")?e.jsx(yt,{className:"text-green-600",size:20}):P.includes("penthouse")?e.jsx(Is,{className:"text-purple-600",size:20}):P.includes("commercial")?e.jsx(Is,{className:"text-blue-600",size:20}):e.jsx(Is,{className:"text-orange-600",size:20})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 text-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"px-6 py-2 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:r?"Showing properties for the selected seller":"Choose from property listings"})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-white hover:bg-gray-50 transition-colors shadow","aria-label":"Close property selector",children:e.jsx(ns,{size:18})})]})}),e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search by title, address, type, ID, city, society, wing/unit...",value:n,onChange:N=>o(N.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),b&&e.jsx("div",{className:"mt-2 text-gray-500 text-xs",children:"Loading propertiesâ€¦"}),!!v&&e.jsx("div",{className:"mt-2 text-red-600 text-xs",children:v})]}),e.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[e.jsx("div",{className:"grid gap-4",children:c.map(N=>{var P;return e.jsx("div",{onClick:()=>s(N),className:"bg-white border border-gray-200 rounded-xl hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-all duration-200 shadow hover:shadow-md group",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:N.image||"https://via.placeholder.com/120x90.png?text=Property",alt:N.title,className:"w-28 h-20 object-cover rounded-lg"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p(N.type),e.jsx("h3",{className:"text-base font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:N.title}),N.id&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:N.id}),(N.wing||N.unit_no)&&e.jsxs("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[N.wing?`${N.wing}-`:"",N.unit_no??""]})]}),(N.address??"")&&e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600",children:[e.jsx(Qs,{size:12}),e.jsx("span",{className:"text-xs",children:N.address})]}),N.seller_name&&e.jsxs("div",{className:"mt-1 text-[11px] text-gray-500",children:["Seller: ",e.jsx("span",{className:"font-medium text-gray-700",children:N.seller_name})]})]}),e.jsxs("div",{className:"text-right",children:[N.price!==void 0&&N.price!==""&&e.jsxs("div",{className:"text-lg font-bold text-green-600 mb-0.5",children:["â‚¹",xw(N.price),N.price_type?` â€¢ ${N.price_type}`:""]}),e.jsx("div",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(N.status??"").toLowerCase().includes("ready")?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:N.status??"â€”"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2 mb-2 text-xs",children:[e.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase mb-0.5",children:"Type"}),e.jsx("div",{className:"font-medium text-gray-900",children:N.type??"â€”"})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase mb-0.5",children:"Carpet"}),e.jsx("div",{className:"font-medium text-gray-900",children:N.carpet_area?`${N.carpet_area} sq ft`:"â€”"})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase mb-0.5",children:"Built-up"}),e.jsx("div",{className:"font-medium text-gray-900",children:N.builtup_area?`${N.builtup_area} sq ft`:"â€”"})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase mb-0.5",children:"Beds/Baths"}),e.jsxs("div",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Oc,{size:12})," ",N.bedrooms??"â€”"]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Gn,{size:12})," ",N.bathrooms??"â€”"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase mb-0.5",children:"Floor"}),e.jsxs("div",{className:"font-medium text-gray-900",children:[N.floor_raw??N.floor??"â€”",N.total_floors?` / ${N.total_floors}`:""]})]}),e.jsxs("div",{className:"bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase mb-0.5",children:"Facing"}),e.jsx("div",{className:"font-medium text-gray-900",children:N.facing??"â€”"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[N.parking&&e.jsxs("span",{className:"px-2 py-0.5 bg-amber-50 text-amber-700 rounded-full text-[11px]",children:["Parking: ",N.parking]}),N.furnishing&&e.jsx("span",{className:"px-2 py-0.5 bg-violet-50 text-violet-700 rounded-full text-[11px]",children:N.furnishing}),N.society_name&&e.jsx("span",{className:"px-2 py-0.5 bg-sky-50 text-sky-700 rounded-full text-[11px]",children:N.society_name})]}),!!((P=N.amenities)!=null&&P.length)&&e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500 uppercase mb-1",children:"Amenities"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[N.amenities.slice(0,5).map((w,$)=>e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-0.5 bg-blue-50 text-blue-700 rounded-full text-xs",children:[f(w),e.jsx("span",{children:w})]},$)),N.amenities.length>5&&e.jsxs("div",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs",children:["+",N.amenities.length-5," more"]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:w=>{w.stopPropagation(),s(N)},className:"px-4 py-1.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 text-sm font-medium shadow",children:"Select"})})]})]})})},String(N.id))})}),!b&&c.length===0&&e.jsxs("div",{className:"text-center py-10 text-sm",children:[e.jsx(Is,{className:"mx-auto text-gray-300 mb-3",size:40}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-1",children:"No properties found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search terms"})]})]})]})})},fw={user_id:"current_user.id",user_username:"current_user.username",user_first_name:"current_user.first_name",user_last_name:"current_user.last_name",user_email:"current_user.email",user_phone:"current_user.phone",user_role:"current_user.role",user_is_active:"current_user.is_active",user_avatar:"current_user.avatar",user_designation:"current_user.designation",user_department:"current_user.department",user_dob:"current_user.dob",user_blood_group:"current_user.blood_group",user_last_login:"current_user.last_login",user_created_at:"current_user.created_at",user_updated_at:"current_user.updated_at",user_total_leads:"current_user.total_leads",user_total_properties:"current_user.total_properties",user_total_revenue:"current_user.total_revenue",user_module_permissions:"current_user.module_permissions",user_salutation:"current_user.salutation",user_buyer_id:"current_user.buyer_id",user_seller_id:"current_user.seller_id",salutation:"seller.salutation",seller_id:"seller.id",seller_salutation:"seller.salutation",seller_name:"seller.name",seller_phone:"seller.phone",seller_whatsapp:"seller.whatsapp",seller_email:"seller.email",seller_address:"seller.address",seller_state:"seller.state",seller_city:"seller.city",seller_location:"seller.location",seller_countryCode:"seller.countryCode",seller_stage:"seller.stage",seller_leadType:"seller.leadType",seller_priority:"seller.priority",seller_status:"seller.status",seller_source:"seller.source",seller_notes:"seller.notes",seller_dob:"seller.dob",seller_expected_close:"seller.expected_close",seller_last_activity:"seller.last_activity",seller_lead_score:"seller.lead_score",seller_deal_value:"seller.deal_value",seller_visits:"seller.visits",seller_total_visits:"seller.total_visits",seller_stage_progress:"seller.stage_progress",seller_deal_potential:"seller.deal_potential",seller_response_rate:"seller.response_rate",seller_avg_response_time:"seller.avg_response_time",seller_assigned_to:"seller.assigned_to",seller_assigned_to_name:"seller.assigned_to_name",seller_notifications:"seller.notifications",seller_is_active:"seller.is_active",seller_created_at:"seller.created_at",seller_updated_at:"seller.updated_at",seller_current_stage:"seller.current_stage",seller_cosellers:"seller_cosellers",seller_coseller1_id:"seller_cosellers.0.id",seller_coseller1_seller_id:"seller_cosellers.0.seller_id",seller_coseller1_salutation:"seller_cosellers.0.salutation",seller_coseller1_name:"seller_cosellers.0.name",seller_coseller1_phone:"seller_cosellers.0.phone",seller_coseller1_whatsapp:"seller_cosellers.0.whatsapp",seller_coseller1_email:"seller_cosellers.0.email",seller_coseller1_relation:"seller_cosellers.0.relation",seller_coseller1_dob:"seller_cosellers.0.dob",seller_coseller1_created_at:"seller_cosellers.0.created_at",seller_coseller1_updated_at:"seller_cosellers.0.updated_at",buyer_id:"buyer.id",buyer_salutation:"buyer.salutation",buyer_name:"buyer.name",buyer_phone:"buyer.phone",buyer_whatsapp_number:"buyer.whatsapp_number",buyer_email:"buyer.email",buyer_state:"buyer.state",buyer_city:"buyer.city",buyer_location:"buyer.location",buyer_lead_priority:"buyer.buyer_lead_priority",buyer_lead_source:"buyer.buyer_lead_source",buyer_lead_stage:"buyer.buyer_lead_stage",buyer_lead_status:"buyer.buyer_lead_status",buyer_budget_min:"buyer.budget_min",buyer_budget_max:"buyer.budget_max",buyer_requirements:"buyer.requirements",buyer_financials:"buyer.financials",buyer_is_active:"buyer.is_active",buyer_created_at:"buyer.created_at",buyer_updated_at:"buyer.updated_at",buyer_lead_id:"buyer.lead_id",buyer_lead_type:"buyer.lead_type",buyer_assigned_executive:"buyer.assigned_executive",buyer_created_by:"buyer.created_by",buyer_updated_by:"buyer.updated_by",buyer_last_contact:"buyer.last_contact",buyer_last_contact_by:"buyer.last_contact_by",buyer_remark:"buyer.remark",buyer_dob:"buyer.dob",buyer_nearbylocations:"buyer.nearbylocations",property_address:"property_address",property_type:"property_type",property_area:"property_area",unit_number:"unit_number",society_name:"society_name",property_id:"id",property_seller_name:"seller_name",property_seller_id:"seller_id",property_lead_id:"lead_id",property_assigned_to:"assigned_to",property_type_name:"property_type_name",property_subtype_name:"property_subtype_name",property_unit_type:"unit_type",property_wing:"wing",property_unit_no:"unit_no",property_furnishing:"furnishing",property_bedrooms:"bedrooms",property_bathrooms:"bathrooms",property_facing:"facing",property_parking_type:"parking_type",property_parking_qty:"parking_qty",property_city_name:"city_name",property_location_name:"location_name",property_society_name_full:"society_name",property_floor:"floor",property_total_floors:"total_floors",property_carpet_area:"carpet_area",property_builtup_area:"builtup_area",property_budget:"budget",property_price_type:"price_type",property_final_price:"final_price",property_address_line:"address",property_status_full:"status",property_lead_source:"lead_source",property_possession_month:"possession_month",property_possession_year:"possession_year",property_purchase_month:"purchase_month",property_purchase_year:"purchase_year",property_selling_rights:"selling_rights",property_ownership_doc_path:"ownership_doc_path",property_photos:"photos",property_amenities:"amenities",property_furnishing_items:"furnishing_items",property_nearby_places:"nearby_places",property_description:"description",property_created_at:"created_at",property_updated_at:"updated_at",property_is_public:"is_public",property_publication_date:"publication_date",property_created_by:"created_by",property_updated_by:"updated_by",property_public_views:"public_views",property_public_inquiries:"public_inquiries",property_slug:"slug",sale_amount:"sale_amount",token_amount:"token_amount",booking_amount:"booking_amount",commission_rate:"commission_rate",validity_period:"validity_period",agreement_date:"agreement_date",possession_date:"possession_date",related_party:"related_party",amount:"amount",amount_in_words:"amount_in_words",in_words:"amount_in_words",payment_date:"payment_date",payment_reference:"payment_reference",deal_value:"deal_value",payment_type:"payment_type",payment_method:"payment_method",buyer_bank_name:"transaction_details.buyer_bank_name",seller_bank_name:"transaction_details.seller_bank_name",ledger_entries:"ledger_entries",receipt_id:"receipt.receipt_id",type:"receipt.type",status:"receipt.status",payment_status:"receipt.payment_status",receipt_date:"receipt.receipt_date",notes:"receipt.notes",created_by:"receipt.created_by",updated_by:"receipt.updated_by",created_at:"receipt.created_at",updated_at:"receipt.updated_at",created_by_name:"created_by_name",updated_by_name:"created_by_name",ledger_index:"ledger_entries.0.index",ledger_date:"ledger_entries.0.date",ledger_type:"ledger_entries.0.type",ledger_amount:"ledger_entries.0.amount",ledger_balance:"ledger_entries.0.balance",ledger_description:"ledger_entries.0.description",title:"title",document_id:"document_id",document_date:"document_date",sales_executive:"sales_executive",executive_id:"executive_id",executive_name:"sales_executive",executive_phone:"executive_phone",executive_email:"executive_email",executive_role:"executive_role",lead_id:"lead.id",lead_salutation:"lead.salutation",lead_name:"lead.name",lead_phone:"lead.phone",lead_whatsapp_number:"lead.whatsapp_number",lead_email:"lead.email",lead_type:"lead.lead_type",lead_source:"lead.lead_source",lead_stage:"lead.stage",lead_status:"lead.status",lead_priority:"lead.priority",lead_state:"lead.state",lead_city:"lead.city",lead_location:"lead.location",lead_assigned_executive:"lead.assigned_executive",lead_created_by:"lead.created_by",lead_updated_by:"lead.updated_by",lead_last_contact:"lead.last_contact",lead_last_contact_by:"lead.last_contact_by",lead_created_at:"lead.created_at",lead_updated_at:"lead.updated_at",lead_transferred_to_buyer_at:"lead.transferred_to_buyer_at",lead_transferred_to_buyer:"lead.transferred_to_buyer",lead_transferred_to_seller:"lead.transferred_to_seller",lead_transferred_to_seller_at:"lead.transferred_to_seller_at",lead_transferred_to_seller_by:"lead_transferred_to_seller_by",lead_transferred_to_buyer_by:"lead_transferred_to_buyer_by",lead_is_listed:"lead.is_listed",company_name:"system_settings.company_name",company_logo:"system_settings.company_logo",footer_logo:"system_settings.footer_logo",company_favicon:"system_settings.company_favicon",primary_color:"system_settings.primary_color",secondary_color:"system_settings.secondary_color",currency:"system_settings.currency",date_format:"system_settings.date_format",time_format:"system_settings.time_format",default_language:"system_settings.default_language",max_file_size:"system_settings.max_file_size",backup_frequency:"system_settings.backup_frequency",auto_assign_leads:"system_settings.auto_assign_leads",lead_scoring_enabled:"system_settings.lead_scoring_enabled",property_auto_approval:"system_settings.property_auto_approval",current_date:"__computed.current_date",current_time:"__computed.current_time",current_datetime:"__computed.current_datetime"},hd=s=>s==null;function yw(s,a){const t=a.split(".");let r=s;for(const i of t){if(hd(r))return;r=r[i]}return r}const Jl=s=>String(s).padStart(2,"0");function Ix(s,a){const t=Jl(s.getDate()),r=Jl(s.getMonth()+1),i=s.getFullYear();return a.replace(/DD/g,t).replace(/MM/g,r).replace(/YYYY/g,String(i))}function $x(s,a){const t=Jl(s.getHours()),r=Jl(s.getMinutes()),i=Jl(s.getSeconds()),n=s.getHours(),o=n%12||12,m=Jl(o),g=n<12?"AM":"PM",b=g.toLowerCase();return a.replace(/HH/g,t).replace(/hh/g,m).replace(/mm/g,r).replace(/ss/g,i).replace(/A/g,g).replace(/a/g,b)}function pd(s,a){const t=Array.isArray(s.variables)?s.variables:[],r={},i=a&&a.system_settings||{},n=typeof i.date_format=="string"&&i.date_format.trim()?i.date_format:"DD-MM-YYYY",o=typeof i.time_format=="string"&&i.time_format.trim()?i.time_format:"hh:mm:ss A",m=new Date,g={current_date:Ix(m,n),current_time:$x(m,o),current_datetime:`${Ix(m,n)} ${$x(m,o)}`};for(const b of t){if(b in g){r[b]=g[b];continue}const d=fw[b];if(!d){r[b]="";continue}if(d.startsWith("__computed.")){r[b]=g[b]??"";continue}const v=yw(a,d);r[b]=hd(v)?"":v}return r}function jw(s,a){return s?s.replace(/\{\{\s*([a-zA-Z0-9_.-]+)\s*\}\}/g,(t,r)=>{const i=a[r];return hd(i)?"":typeof i=="number"?String(i):typeof i=="boolean"?i?"Yes":"No":String(i)}):""}const wg="documentEditor:resume";function Ec(s){const a={draftId:s.draftId??null,templateId:s.templateId??null,title:s.title??"Untitled Draft",initialVariables:s.initialVariables??{},editorState:s.editorState??{},source:s.source??"server-draft",savedAt:new Date().toISOString()};sessionStorage.setItem(wg,JSON.stringify(a))}function vw(){const s=sessionStorage.getItem(wg);if(!s)return console.warn("[RESUME] no snapshot in sessionStorage"),null;try{const a=JSON.parse(s);return console.groupEnd(),a}catch(a){return console.error("[RESUME] parse failed",a),null}}const bl={getAll:async()=>(await Ae.get("/receipts/all")).data,getById:async s=>{if(!s)throw new Error("Receipt ID is required");return(await Ae.get(`/receipts/id/${s}`)).data},getByReceiptId:async s=>{if(!s)throw new Error("Receipt ID string is required");return(await Ae.get(`/receipts/rid/${s}`)).data},create:async s=>(await Ae.post("/receipts",s)).data,update:async(s,a)=>{if(!s)throw new Error("Receipt numeric ID is required");return(await Ae.patch(`/receipts/${s}`,a)).data},delete:async s=>{if(!s)throw new Error("Receipt numeric ID is required");return(await Ae.delete(`/receipts/${s}`)).data},bulkDelete:async(s,a=!1)=>{if(!(s!=null&&s.length))throw new Error("Receipt IDs are required");return(await Ae.post("/receipts/bulk-delete",{ids:s,hard:a})).data}},Si=s=>{if(!s)return"";const a=String(s);if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(a))return a;const t=new Date(a);if(isNaN(t.getTime()))return"";const r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),m=String(t.getMinutes()).padStart(2,"0");return`${r}-${i}-${n}T${o}:${m}`},rc=s=>{if(!s)return null;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(s)){const[g,b]=s.split("T");return`${g} ${b}:00`}const a=new Date(s);if(isNaN(a.getTime()))return null;const t=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),i=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),o=String(a.getMinutes()).padStart(2,"0"),m=String(a.getSeconds()).padStart(2,"0");return`${t}-${r}-${i} ${n}:${o}:${m}`},Nw=({isOpen:s,onClose:a,receipt:t,onSave:r,userRole:i,prefill:n,lockSelections:o={}})=>{const[m,g]=l.useState([]),[b,d]=l.useState([]),[v,x]=l.useState([]),[u,c]=l.useState(!0),{user:f}=Hs(),p=l.useRef(!1),[N,P]=l.useState(!0),[w,$]=l.useState({}),[y,k]=l.useState({seller_id:"",buyer_id:"",property_id:"",receipt_id:"",seller_name:"",seller_phone:"",seller_email:"",buyer_name:"",buyer_phone:"",buyer_email:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0,brokerage_percentage:0,payment_type:"",amount:0,amount_in_words:"",receipt_date:Si(new Date),payment_date:Si(new Date),payment_reference:"",transaction_details:{payment_method:"",buyer_bank_name:"",seller_bank_name:""},related_party:"buyer_to_seller",notes:"",created_by:"",updated_by:"",created_at:"",updated_at:""}),[R,F]=l.useState(!1),T=l.useRef(!1),j=K=>k(q=>({...q,...K})),E=K=>{const q=Math.floor(Math.abs(K));if(!q)return"Zero Only";const ne=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],le=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],S=ge=>ge<20?ne[ge]:`${le[Math.floor(ge/10)]}${ge%10?" "+ne[ge%10]:""}`.trim(),C=ge=>{const ee=Math.floor(ge/100),de=ge%100;return`${ee?ne[ee]+" Hundred":""}${de?(ee?" ":"")+S(de):""}`.trim()};let J=q;const ue=Math.floor(J/1e7);J%=1e7;const Q=Math.floor(J/1e5);J%=1e5;const he=Math.floor(J/1e3);J%=1e3;const se=[];return ue&&se.push(`${S(ue)} Crore`),Q&&se.push(`${S(Q)} Lakh`),he&&se.push(`${S(he)} Thousand`),J&&se.push(C(J)),`${K<0?"Minus ":""}${se.join(" ")} Only`.replace(/\s+/g," ").trim()},V=(K,q)=>{if(K.includes(".")){const[ne,le]=K.split(".");k(S=>({...S,[ne]:{...S[ne],[le]:q}}))}else j({[K]:q})};l.useEffect(()=>{(async()=>{try{P(!0);const q=await Gt(["common"]);$(q)}catch(q){console.error("Error fetching master options:",q),Z.error("Failed to load dropdown options")}finally{P(!1)}})()},[]),l.useEffect(()=>{if(!s||T.current)return;T.current=!0,(async()=>{c(!0);try{const[q,ne]=await Promise.all([st.getAll(),Vt.getAll()]);g(Array.isArray(q)?q:[]),d(Array.isArray(ne)?ne:[])}catch(q){console.error("Failed to fetch sellers/buyers",q),Z.error("Failed to load data")}finally{c(!1)}})()},[s]),l.useEffect(()=>{s||(T.current=!1)},[s]),l.useEffect(()=>{if(!s||!(n!=null&&n.propertyId)||!y.seller_id||y.property_id||v.length===0)return;const K=v.find(q=>String(q.id)===String(n.propertyId));if(K){const q={type:K.type||K.property_type_name||"",area:K.area||K.carpet_area||"",floor:(K.floor??K.floor_number??"").toString(),facing:K.facing||K.direction||""};j({property_id:String(n.propertyId),property_address:K.address||"",property_details:q,deal_value:Number(K.price??K.expected_price??K.deal_value??0)})}},[s,n==null?void 0:n.propertyId,y.seller_id,v]),l.useEffect(()=>{if(!s||p.current||u||N)return;const{sellerId:K,buyerId:q,propertyId:ne}=n||{};let le=[];if(K&&m.length>0){const S=m.find(C=>String(C.id)===String(K));if(S){const C=`${S.salutation||""} ${S.name||""}`.trim();j({seller_id:String(K),seller_name:C,seller_phone:S.phone||"",seller_email:S.email||""}),le=Array.isArray(S.properties)?S.properties:[],x(le)}}if(q&&b.length>0){const S=b.find(C=>String(C.id)===String(q));if(S){const C=`${S.salutation||""} ${S.name||""}`.trim();j({buyer_id:String(q),buyer_name:C,buyer_phone:S.phone||"",buyer_email:S.email||""})}}if(ne&&le.length>0){const S=le.find(C=>String(C.id)===String(ne));if(S){const C={type:S.type||S.property_type_name||"",area:S.area||S.carpet_area||"",floor:(S.floor??S.floor_number??"").toString(),facing:S.facing||S.direction||""};j({property_id:String(ne),property_address:S.address||"",property_details:C,deal_value:Number(S.price??S.expected_price??S.deal_value??0)})}}if(t){const S=t.property_details||{type:t.property_type||"",area:t.property_area||"",floor:t.property_floor||"",facing:t.property_facing||""};k(C=>{var J,ue,Q;return{...C,receipt_id:t.receipt_id||C.receipt_id||"",seller_id:t.seller_id!=null?String(t.seller_id):C.seller_id,buyer_id:t.buyer_id!=null?String(t.buyer_id):C.buyer_id,property_id:t.property_id!=null?String(t.property_id):C.property_id,seller_name:t.seller_name||C.seller_name,seller_phone:t.seller_phone||C.seller_phone,seller_email:t.seller_email||C.seller_email,buyer_name:t.buyer_name||C.buyer_name,buyer_phone:t.buyer_phone||C.buyer_phone,buyer_email:t.buyer_email||C.buyer_email,property_address:t.property_address||C.property_address,property_details:{type:S.type||"",area:S.area||"",floor:S.floor||"",facing:S.facing||""},deal_value:Number(t.deal_value)||C.deal_value,payment_type:t.payment_type||C.payment_type||"",amount:Number(t.amount)||C.amount,amount_in_words:t.amount_in_words||C.amount_in_words,receipt_date:Si(t.receipt_date)||C.receipt_date,payment_date:Si(t.payment_date)||C.payment_date,payment_reference:t.payment_reference||C.payment_reference,transaction_details:{payment_method:((J=t.transaction_details)==null?void 0:J.payment_method)||C.transaction_details.payment_method||"",buyer_bank_name:((ue=t.transaction_details)==null?void 0:ue.buyer_bank_name)||C.transaction_details.buyer_bank_name||"",seller_bank_name:((Q=t.transaction_details)==null?void 0:Q.seller_bank_name)||C.transaction_details.seller_bank_name||""},related_party:t.related_party||C.related_party,notes:t.notes||C.notes,created_by:(t==null?void 0:t.created_by)??(f==null?void 0:f.id)??C.created_by,updated_by:(f==null?void 0:f.id)??(t==null?void 0:t.updated_by)??C.updated_by,created_at:t.created_at||C.created_at,updated_at:new Date().toISOString()}})}p.current=!0},[s,u,N,n,m,b,t,f==null?void 0:f.id]),l.useEffect(()=>{s||(p.current=!1)},[s]);const W=(w==null?void 0:w.banks)??[],B=(w==null?void 0:w["payment types"])??[],M=(w==null?void 0:w["payement methods"])||(w==null?void 0:w["payment methods"])||[],A=l.useMemo(()=>[...W].sort((K,q)=>K.label.localeCompare(q.label,void 0,{sensitivity:"base"})),[W]),L=l.useMemo(()=>[...B].sort((K,q)=>K.label.localeCompare(q.label,void 0,{sensitivity:"base"})),[B]),D=l.useMemo(()=>[...M].sort((K,q)=>K.label.localeCompare(q.label,void 0,{sensitivity:"base"})),[M]);l.useEffect(()=>{if(!y.seller_id||m.length===0){x([]);return}const K=m.find(q=>String(q.id)===String(y.seller_id));x(Array.isArray(K==null?void 0:K.properties)?K.properties:[])},[y.seller_id,m]),l.useEffect(()=>{j({amount_in_words:y.amount?E(Number(y.amount)||0):""})},[y.amount]);const I=K=>{if(o.seller)return;if(!K){j({seller_id:"",seller_name:"",seller_phone:"",seller_email:"",property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0}),x([]);return}const q=m.find(ne=>String(ne.id)===String(K));if(q){const ne=`${q.salutation||""} ${q.name||""}`.trim();j({seller_id:K,seller_name:ne,seller_phone:q.phone||"",seller_email:q.email||"",...!o.property&&{property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0}}),x(Array.isArray(q.properties)?q.properties:[])}else j({seller_id:"",seller_name:"",seller_phone:"",seller_email:""}),x([])},H=K=>{if(o.buyer)return;if(!K){j({buyer_id:"",buyer_name:"",buyer_phone:"",buyer_email:""});return}const q=b.find(ne=>String(ne.id)===String(K));if(q){const ne=`${q.salutation||""} ${q.name||""}`.trim();j({buyer_id:K,buyer_name:ne,buyer_phone:q.phone||"",buyer_email:q.email||""})}else j({buyer_id:"",buyer_name:"",buyer_phone:"",buyer_email:""})},h=K=>{if(o.property)return;if(!K){j({property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0});return}const q=v.find(ne=>String(ne.id)===String(K));if(q){const ne={type:q.type||q.property_type_name||"",area:q.area||q.carpet_area||"",floor:(q.floor??q.floor_number??"").toString(),facing:q.facing||q.direction||""};j({property_id:String(K),property_address:q.address||"",property_details:ne,deal_value:Number(q.price??q.expected_price??q.deal_value??0)})}else j({property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""}})},Y=async()=>{if(!y.seller_name.trim()){Z.error("Please select a seller");return}if(!y.buyer_name.trim()){Z.error("Please select a buyer");return}if(!y.property_address.trim()){Z.error("Please select a property");return}if(!y.payment_type){Z.error("Please select a payment type");return}if(!y.amount||Number(y.amount)<=0){Z.error("Please enter valid amount");return}if(!y.payment_reference.trim()){Z.error("Please enter payment reference");return}F(!0);try{const K=new Date().toISOString(),q={type:"property_payment_receipt",status:"paid",payment_status:"paid",receipt_id:y.receipt_id,seller_id:y.seller_id,seller_name:y.seller_name,seller_phone:y.seller_phone,seller_email:y.seller_email,buyer_id:y.buyer_id,buyer_name:y.buyer_name,buyer_phone:y.buyer_phone,buyer_email:y.buyer_email,property_id:y.property_id,property_address:y.property_address,property_details:{...y.property_details},deal_value:y.deal_value,payment_type:y.payment_type,amount:Number(y.amount)||0,amount_in_words:y.amount_in_words,receipt_date:rc(y.receipt_date),payment_date:rc(y.payment_date),payment_reference:y.payment_reference,transaction_details:{...y.transaction_details},related_party:y.related_party,notes:y.notes,created_at:(t==null?void 0:t.created_at)||K,updated_at:K,created_by:(t==null?void 0:t.created_by)??(y.created_by||(f==null?void 0:f.id)||""),updated_by:(f==null?void 0:f.id)??y.updated_by??"",ledger_entries:(t==null?void 0:t.ledger_entries)||[{type:"credit",amount:Number(y.amount)||0,description:"Property payment received",date:rc(y.payment_date)||y.payment_date,balance:Number(y.amount)||0}]};await r(q),Z.success("Receipt saved successfully!")}catch(K){console.error("Error saving receipt:",K),Z.error("Failed to save receipt")}finally{F(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"px-6 py-2 border-b border-gray-200 bg-gradient-to-r from-orange-50 to-amber-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(Pa,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Property Payment Receipt":"Create Property Payment Receipt"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Property Payment acknowledgment with transaction details"}),Object.values(o).some(Boolean)&&e.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"Some fields are locked based on document selection"})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:u?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-gray-500",children:"Loading data..."})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Pa,{className:"mr-2",size:20}),"Receipt Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt ID"}),e.jsx("input",{type:"text",value:y.receipt_id,placeholder:"Auto generated after Create",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Party"}),e.jsxs("select",{value:y.related_party,onChange:K=>V("related_party",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"buyer",children:"From Buyer"}),e.jsx("option",{value:"seller",children:"From Seller"}),e.jsx("option",{value:"buyer_to_seller",children:"Buyer to Seller"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Date"}),e.jsx("input",{type:"datetime-local",value:y.receipt_date,onChange:K=>V("receipt_date",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date"}),e.jsx("input",{type:"datetime-local",value:y.payment_date,onChange:K=>V("payment_date",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Seller Information",o.seller&&e.jsx("span",{className:"ml-2 text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded",children:"Locked"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Seller ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:y.seller_id,onChange:K=>I(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o.seller,required:!0,children:[e.jsx("option",{value:"",children:"-- Select Seller --"}),m.length?m.map(K=>e.jsxs("option",{value:String(K.id),children:[K.salutation," ",K.name]},K.id)):e.jsx("option",{disabled:!0,children:"No sellers available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller ID"}),e.jsx("input",{type:"text",value:y.seller_id,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",placeholder:"Auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Phone"}),e.jsx("input",{type:"tel",value:y.seller_phone,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Email"}),e.jsx("input",{type:"email",value:y.seller_email,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ns,{className:"mr-2",size:20}),"Buyer Information",o.buyer&&e.jsx("span",{className:"ml-2 text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded",children:"Locked"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Buyer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:y.buyer_id,onChange:K=>H(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o.buyer,required:!0,children:[e.jsx("option",{value:"",children:"-- Select Buyer --"}),b.length?b.map(K=>e.jsxs("option",{value:String(K.id),children:[K.salutation," ",K.name]},K.id)):e.jsx("option",{disabled:!0,children:"No buyers available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer ID"}),e.jsx("input",{type:"text",value:y.buyer_id,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",placeholder:"Auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Phone"}),e.jsx("input",{type:"tel",value:y.buyer_phone,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Email"}),e.jsx("input",{type:"email",value:y.buyer_email,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Information",o.property&&e.jsx("span",{className:"ml-2 text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded",children:"Locked"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Property ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:y.property_id,onChange:K=>h(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!y.seller_id||v.length===0||o.property,required:!0,children:[e.jsx("option",{value:"",children:y.seller_id?v.length===0?"-- No Properties Available --":"-- Select Property --":"-- Select Seller First --"}),v.map(K=>e.jsxs("option",{value:String(K.id),children:[K.address," (",K.type||K.property_type_name,")"]},String(K.id)))]}),y.seller_id&&v.length===0&&e.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"This seller has no properties attached"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property ID"}),e.jsx("input",{type:"text",value:y.property_id,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",placeholder:"Auto"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Address"}),e.jsx("textarea",{value:y.property_address,readOnly:!0,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsx("input",{type:"text",value:y.property_details.type,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area (Sq ft)"}),e.jsx("input",{type:"text",value:y.property_details.area,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Floor"}),e.jsx("input",{type:"text",value:y.property_details.floor,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Facing"}),e.jsx("input",{type:"text",value:y.property_details.facing,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:20}),"Payment Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:y.payment_type,onChange:K=>V("payment_type",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:N,required:!0,children:[e.jsx("option",{value:"",children:N?"Loading payment typesâ€¦":"-- Select Payment Type --"}),(N?[]:L).map(K=>e.jsx("option",{value:K.value,children:K.label},K.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount (â‚¹) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.amount,onChange:K=>V("amount",Number(K.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"500000",required:!0})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-orange-700 mb-1",children:"Amount in Words"}),e.jsx("div",{className:"text-sm text-orange-800 font-medium",children:y.amount_in_words})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(en,{className:"mr-2",size:20}),"Transaction Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),e.jsxs("select",{value:y.transaction_details.payment_method,onChange:K=>V("transaction_details.payment_method",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:N,children:[e.jsx("option",{value:"",children:N?"Loading payment methodsâ€¦":"-- Select Payment Method --"}),(N?[]:D).map(K=>e.jsx("option",{value:K.value,children:K.label},K.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Reference ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:y.payment_reference,onChange:K=>V("payment_reference",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"TXN123456789",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Bank Name"}),e.jsxs("select",{value:y.transaction_details.buyer_bank_name,onChange:K=>V("transaction_details.buyer_bank_name",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:N,children:[e.jsx("option",{value:"",children:N?"Loading banksâ€¦":"-- Select Buyer Bank --"}),(N?[]:A).map(K=>e.jsx("option",{value:K.value,children:K.label},K.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Bank Name"}),e.jsxs("select",{value:y.transaction_details.seller_bank_name,onChange:K=>V("transaction_details.seller_bank_name",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:N,children:[e.jsx("option",{value:"",children:N?"Loading banksâ€¦":"-- Select Seller Bank --"}),(N?[]:A).map(K=>e.jsx("option",{value:K.value,children:K.label},K.value))]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:y.notes,onChange:K=>V("notes",K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes or terms..."})]})]})]})}),e.jsx("div",{className:"px-6 py-2 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="manager"?"Receipt will require admin approval":"Receipt will be created immediately"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:Y,disabled:R||!y.seller_name.trim()||!y.buyer_name.trim()||!y.property_address.trim()||!y.payment_type||!y.amount||!y.payment_reference.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:R?"Saving...":t?"Update Receipt":"Create Receipt"})]})]})]})})]})}):null};function _g(s){return Array.isArray(s)?s:Array.isArray(s==null?void 0:s.data)?s.data:Array.isArray(s==null?void 0:s.rows)?s.rows:Array.isArray(s==null?void 0:s.items)?s.items:[]}const ww=s=>{if(!s)return[];const a=new Set,t=/\{\{\s*([a-zA-Z0-9_.-]+)\s*\}\}/g;let r;for(;r=t.exec(s);)a.add(r[1]);return Array.from(a)};function _w(s,a){const t=pd(s,a);return Array.isArray(s.variables)&&s.variables.length,Object.entries(t).filter(([r,i])=>i!=="").length,Object.entries(t).filter(([r,i])=>i==="").map(([r])=>r),t}const Sw={id:1,name:"Sale Agreement",category:"Agreement",variables:["salutation","seller_name","buyer_name","property_address","sale_amount","token_amount","booking_amount","commission_rate","validity_period","agreement_date","possession_date"]},kw=({template:s=Sw,documentData:a={},onDataChange:t=()=>{},onBack:r=()=>{}})=>{var G,me,oe,Fe,$e,Le;const[i,n]=l.useState({title:"",seller:null,buyer:null,property:null,document_id:"",document_date:new Date().toISOString().split("T")[0],sales_executive:"",executive_id:"",executive_phone:"",executive_email:"",executive_role:"",status:"draft",...a}),[o,m]=l.useState((a==null?void 0:a.id)??null),[g,b]=l.useState(!1),[d,v]=l.useState(!1),[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState(!1),[P,w]=l.useState(!1),[$]=l.useState([]),{user:y}=Hs(),[k,R]=l.useState("A4"),F=(s==null?void 0:s.pageType)||k,[T,j]=l.useState([]),[E,V]=l.useState(!1),[W,B]=l.useState(null);l.useEffect(()=>{const je=new URL(window.location.href),_e=je.searchParams.get("resume");if(je.searchParams.get("draftId"),_e!=="1")return;const ve=vw();if(!ve)return;ve.initialVariables&&n(We=>({...We,...ve.initialVariables}));const Pe=ve.editorState||{};if(Pe.page_type&&R(Pe.page_type==="Legal"?"Legal":"A4"),Pe.active_step_key){const We=Y.findIndex(pe=>pe.key===Pe.active_step_key);We>=0&&q(We)}else typeof Pe.active_index=="number"&&q(Math.max(0,Math.min(Y.length-1,Pe.active_index)));(Pe.server_id||ve.draftId)&&m(Pe.server_id??ve.draftId)},[]),l.useEffect(()=>{let je=!0;return(async()=>{try{V(!0),B(null);const _e=await Os.getAllUsers({role:"executive",department:"sales"});let ve=[];Array.isArray(_e)?ve=_e:Array.isArray(_e==null?void 0:_e.data)?ve=_e.data:Array.isArray(_e==null?void 0:_e.rows)?ve=_e.rows:Array.isArray(_e==null?void 0:_e.items)?ve=_e.items:Array.isArray(_e==null?void 0:_e.users)?ve=_e.users:ve=_g(_e);const Pe=ve.filter(pe=>{const O=String(pe.role??pe.user_role??pe.type??"").toLowerCase(),Ie=String(pe.department??pe.dept??"").toLowerCase();return O==="executive"&&Ie==="sales"}),We=Da(y,Pe);je&&j(We.map(pe=>({id:pe.id??pe.user_id??pe._id,salutation:pe.salutation??"",name:pe.name??`${pe.first_name??""} ${pe.last_name??""}`.trim(),phone:pe.phone??pe.mobile??pe.whatsapp??"",email:pe.email??"",designation:pe.designation??"",department:pe.department??"",raw:pe})))}catch(_e){Z.error("executives fetch failed",_e),je&&(B((_e==null?void 0:_e.message)||"Failed to load executives"),j([]))}finally{je&&V(!1)}})(),()=>{je=!1}},[y]);const M=Array.isArray(s.variables)?s.variables:[],A=je=>M.some(_e=>_e.startsWith(je)),L=M.includes("buyer_name")||A("buyer_"),D=M.includes("seller_name")||A("seller_"),I=L||D,H=M.includes("property_address")||A("property_")||M.some(je=>["unit_number","society_name","property_area","property_type"].includes(je));l.useEffect(()=>{(async()=>{try{const je=await _r.getSettings(),_e=(je==null?void 0:je.data)??je;n(ve=>({...ve,system_settings:_e||{},current_user:y||{}}))}catch(je){Z.error("system settings fetch failed",je),n(_e=>({..._e,current_user:y||{}}))}})()},[y]);const h=l.useMemo(()=>{const je=Array.isArray(s.variables)?s.variables:[],_e=ww(s.content),ve=Array.from(new Set([...je,..._e]));return{...s,variables:ve}},[s]),Y=l.useMemo(()=>{const je=[];return I&&je.push({key:"parties",label:"Parties",description:"Select seller/buyer",icon:Ns}),H&&je.push({key:"property",label:"Property",description:"Choose property",icon:Is}),je.push({key:"document",label:"Document",description:"Fill document data",icon:ws}),je.push({key:"review",label:"Review",description:"Review and checklist",icon:ks}),je.push({key:"final",label:"Final Preview",description:"Print-accurate view",icon:ks}),je},[I,H,s.id]),[K,q]=l.useState(0);l.useEffect(()=>{q(je=>Math.min(je,Math.max(Y.length-1,0)))},[Y.length]),l.useEffect(()=>{if(!i.document_id){const je=((s==null?void 0:s.category)??"DOC").toString().toUpperCase().slice(0,3),_e=Date.now().toString().slice(-6);n(ve=>({...ve,document_id:`${je}${_e}`}))}},[s==null?void 0:s.id]),l.useEffect(()=>{if(s&&i.seller&&i.buyer){const je=`${s.name} - ${i.seller.name} to ${i.buyer.name}`;n(_e=>({..._e,title:je}))}else if(s&&i.seller){const je=`${s.name} - ${i.seller.name}`;n(_e=>({..._e,title:je}))}else n(je=>({...je,title:je.title||s.name}))},[s,i.seller,i.buyer]);const ne=(je,_e)=>{n(ve=>{const Pe={...ve,[je]:_e};return t==null||t(Pe),Pe})},le=(je,_e)=>({id:je.id??je.coseller_id??je._id??"",seller_id:je.seller_id??_e??"",salutation:je.salutation??"",name:je.name??je.full_name??"",phone:je.phone??je.mobile??"",whatsapp:je.whatsapp??"",email:je.email??"",relation:je.relation??je.relationship??"",dob:je.dob??je.date_of_birth??"",created_at:je.created_at??je.createdAt??"",updated_at:je.updated_at??je.updatedAt??""}),S=async je=>{var Pe,We,pe,O,Ie;const _e={id:je.id??je.seller_id??je._id,salutation:je.salutation??"",name:je.name??je.full_name??je.company_name??"",phone:je.phone??je.mobile??"",whatsapp:je.whatsapp??"",email:je.email??"",address:je.address??je.location??"",state:je.state??"",city:je.city??"",location:je.location??"",...je};let ve=[];try{const ze=((Pe=st.getById)==null?void 0:Pe.call(st,_e.id))??((We=st.getOne)==null?void 0:We.call(st,_e.id))??((pe=st.get)==null?void 0:pe.call(st,_e.id));if(!ze)throw new Error("sellerAPI.getById/getOne/get is not available");const xe=await ze,Ee=((O=xe==null?void 0:xe.data)==null?void 0:O.data)??(xe==null?void 0:xe.data)??xe,Ke=(Ee==null?void 0:Ee.seller_cosellers)??(Ee==null?void 0:Ee.cosellers)??((Ie=Ee==null?void 0:Ee.data)==null?void 0:Ie.cosellers)??[];ve=Array.isArray(Ke)?Ke.map(Xe=>le(Xe,_e.id)):[]}catch(ze){Z.warn("co-sellers fetch failed",ze),ve=[]}n(ze=>({...ze,seller:_e,seller_cosellers:ve,seller_name:_e.name,seller_phone:_e.phone,seller_email:_e.email,seller_address:_e.address})),b(!1)},C=je=>{const _e={...je,whatsapp_number:je.whatsapp??je.phone??"",state:je.state??"",city:je.city??"",location:je.location??""};n(ve=>({...ve,buyer:_e,salutation:ve.salutation||"",buyer_name:_e.name,buyer_phone:_e.phone,buyer_email:_e.email,buyer_address:_e.address})),v(!1)},J=je=>{const _e=je;n(ve=>{var Pe;return{...ve,property:je,property_id:_e.id??_e.property_id??"",property_address:_e.address??"",property_type:_e.type??_e.property_type_name??"",property_area:_e.carpet_area??_e.area??"",unit_number:_e.unit_no??_e.unitNo??"",society_name:_e.society_name??_e.society??"",id:_e.id,seller_name:_e.seller_name??"",seller_id:_e.seller_id??((Pe=_e==null?void 0:_e.seller)==null?void 0:Pe.id)??"",lead_id:_e.lead_id??"",assigned_to:_e.assigned_to??"",property_type_name:_e.property_type_name??"",property_subtype_name:_e.property_subtype_name??"",unit_type:_e.unit_type??"",wing:_e.wing??"",unit_no:_e.unit_no??_e.unitNo??"",furnishing:_e.furnishing??"",bedrooms:_e.bedrooms??"",bathrooms:_e.bathrooms??"",facing:_e.facing??"",parking_type:_e.parking_type??"",parking_qty:_e.parking_qty??"",city_name:_e.city_name??"",location_name:_e.location_name??"",society_name_full:_e.society_name??"",floor:_e.floor_raw??_e.floor??"",total_floors:_e.total_floors??"",carpet_area:_e.carpet_area??_e.area??"",builtup_area:_e.builtup_area??"",budget:_e.budget??"",price_type:_e.price_type??"",final_price:_e.final_price??_e.price??"",address:_e.address??"",status:_e.status_raw??_e.status??"",lead_source:_e.lead_source??"",possession_month:_e.possession_month??"",possession_year:_e.possession_year??"",purchase_month:_e.purchase_month??"",purchase_year:_e.purchase_year??"",selling_rights:_e.selling_rights??"",ownership_doc_path:_e.ownership_doc_path??"",photos:Array.isArray(_e.photos)?_e.photos:[],amenities:Array.isArray(_e.amenities)?_e.amenities:[],furnishing_items:Array.isArray(_e.furnishing_items)?_e.furnishing_items:[],nearby_places:Array.isArray(_e.nearby_places)?_e.nearby_places:[],description:_e.description??"",created_at:_e.created_at??"",updated_at:_e.updated_at??"",is_public:_e.is_public??0,publication_date:_e.publication_date??"",created_by:_e.created_by??"",updated_by:_e.updated_by??"",public_views:_e.public_views??0,public_inquiries:_e.public_inquiries??0,slug:_e.slug??""}}),u(!1)},ue=l.useMemo(()=>pd(h,i),[h,i]);l.useMemo(()=>({...i,...ue}),[i,ue]);const Q=je=>{var O,Ie,ze,xe;const _e=je??(i.status||"draft");_w(s,i);const ve=ue,Pe={property_id:((O=i.property)==null?void 0:O.id)??i.property_id??"",seller_id:((Ie=i.seller)==null?void 0:Ie.id)??i.seller_id??"",buyer_id:((ze=i.buyer)==null?void 0:ze.id)??i.buyer_id??""},We={...ve,...Pe},pe=jw(h.content||"",We);return{template_id:h.id,name:i.title||`${h.name} - Draft`,category:h.category??null,content:pe,variables:{...We,__form_snapshot:{...i},__meta:{property_id:Pe.property_id,seller_id:Pe.seller_id,buyer_id:Pe.buyer_id},__editor_state:{active_step_key:(xe=Y[K])==null?void 0:xe.key,active_index:K,page_type:k,template_id:h.id,server_id:o??null,updated_at:new Date().toISOString()}},status:_e}},he=async je=>{var We;const _e=Number((y==null?void 0:y.id)??null)||null,Pe={...Q(je),updated_by:_e};if(o)return await ot.update(o,Pe),o;{const pe={...Pe,created_by:_e},O=await ot.create(pe),Ie=(O==null?void 0:O.id)??((We=O==null?void 0:O.data)==null?void 0:We.id);return Ie?(m(Ie),await ot.update(Ie,{...Q(je),updated_by:_e}),Ie):null}},se=async()=>{var je;N(!0);try{const _e=await he("draft");Ec({draftId:_e,templateId:s.id,title:i.title||`${s.name} - Draft`,initialVariables:{...i},editorState:{active_step_key:(je=Y[K])==null?void 0:je.key,active_index:K,page_type:k,template_id:s.id,server_id:_e,updated_at:new Date().toISOString()},source:"editor-save"}),Z("âœ… Draft saved successfully!")}catch{Z.error("Failed to save draft")}finally{N(!1)}},ge=async()=>{f(!0);try{const je=await he("created");if(!je)throw new Error("Document ID not available");await ot.savePdf(je,{page:F==="Legal"?"legal":"a4"}),await ot.downloadPdf(je,{page:F==="Legal"?"legal":"a4",filenameFallback:`${((s==null?void 0:s.name)||"document").toString().replace(/[^\w\-]+/g,"_")}.pdf`}),Z.success("Document generated successfully!")}catch(je){Z.error(je),Z.error("Failed to generate")}finally{f(!1)}},ee=async()=>{try{await he("draft"),Z.success("Document prepared & ready to share!")}catch(je){Z.error(je),Z.error("Could not prepare document for sharing.")}},de=je=>{switch(je){case"parties":{const _e=!D||!!i.seller,ve=!L||!!i.buyer;return _e&&ve}case"property":return!H||!!i.property||!!i.property_address;case"document":return!!i.title&&!!i.document_date;case"review":case"final":return!0;default:return!0}},U=je=>{for(let _e=0;_e<je;_e++)if(!de(Y[_e].key))return!1;return!0},X=je=>{var _e;Ec({draftId:je??o??null,templateId:h.id,title:i.title||`${h.name} - Draft`,initialVariables:{...i},editorState:{active_step_key:(_e=Y[K])==null?void 0:_e.key,active_index:K,page_type:k,template_id:h.id,server_id:je??o??null,updated_at:new Date().toISOString()},source:"editor-autosave"})},re=async()=>{const je=Y[K].key;if(de(je)){w(!0);try{const _e=await he("draft");X(_e),q(ve=>Math.min(ve+1,Y.length-1))}catch(_e){Z.error("Failed to save on Next:",_e)}finally{w(!1)}}},fe=l.useMemo(()=>[...new Set(M)].sort(),[M]);return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50 text-xs",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:r,className:"p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",type:"button","aria-label":"Back",children:e.jsx(ga,{size:16})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Create Document"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Template: ",s.name,o?` â€¢ #${o}`:""]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"hidden sm:flex items-center space-x-2 mr-2",children:[e.jsx("label",{htmlFor:"page-type-select",className:"text-sm text-gray-600",children:"Page:"}),e.jsxs("select",{id:"page-type-select",value:k,onChange:je=>R(je.target.value),className:"px-2 py-1 border rounded bg-white text-sm",children:[e.jsx("option",{value:"A4",children:"A4"}),e.jsx("option",{value:"Legal",children:"Legal"})]})]}),e.jsxs("button",{onClick:se,disabled:p,className:"flex items-center space-x-1.5 px-3 py-1.5 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",type:"button",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:p?"Saving...":"Save Draft"})]}),e.jsxs("button",{onClick:ee,className:"flex items-center space-x-1.5 px-3 py-1.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",type:"button",children:[e.jsx(Wt,{size:14}),e.jsx("span",{children:"Share"})]}),e.jsxs("button",{onClick:ge,disabled:c,className:"flex items-center space-x-1.5 px-4 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",type:"button",children:[e.jsx(ws,{size:14}),e.jsx("span",{children:c?"Generating...":"Generate Document"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex items-center justify-between overflow-x-auto",children:Y.map((je,_e)=>{const ve=je.icon,Pe=K===_e,We=de(je.key),pe=U(_e);return e.jsxs("div",{className:"flex items-center shrink-0",children:[e.jsxs("button",{type:"button",onClick:async()=>{if(pe){w(!0);try{await he("draft"),q(_e)}catch(O){Z.error("Failed to save on step jump:",O)}finally{w(!1)}}},disabled:!pe||P,className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-all ${Pe?"bg-blue-100 text-blue-700 border border-blue-200":We?"bg-green-100 text-green-700 border border-green-200":pe?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-gray-50 text-gray-400 cursor-not-allowed"}`,children:[e.jsx("div",{className:`p-1.5 rounded-lg ${Pe?"bg-blue-200":We?"bg-green-200":"bg-gray-200"}`,children:e.jsx(ve,{size:12})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:je.label}),e.jsx("div",{className:"opacity-75",children:je.description})]}),We&&e.jsx(bs,{className:"text-green-600",size:12})]}),_e<Y.length-1&&e.jsx("div",{className:`w-16 sm:w-24 h-0.5 mx-1 ${de(je.key)?"bg-green-300":"bg-gray-300"}`})]},je.key)})})})]}),e.jsx("div",{className:"flex-1 p-4 overflow-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[((G=Y[K])==null?void 0:G.key)==="parties"&&e.jsx(Cw,{formData:i,onInputChange:ne,onSellerSelect:()=>b(!0),onBuyerSelect:()=>v(!0),template:s,requiresBuyer:L,requiresSeller:D}),((me=Y[K])==null?void 0:me.key)==="property"&&e.jsx(Aw,{formData:i,onInputChange:ne,onPropertySelect:()=>u(!0),template:s,requiresProperty:H,onContinue:()=>re()}),((oe=Y[K])==null?void 0:oe.key)==="document"&&e.jsx(Pw,{formData:i,onInputChange:ne,template:s,usedVariables:fe,onVariableInsert:je=>{Z.success(`Variable {{${je}}} inserted!`)}}),((Fe=Y[K])==null?void 0:Fe.key)==="review"&&e.jsx(Tw,{formData:i,template:s,requiresBuyer:L,requiresSeller:D,requiresProperty:H,onInputChange:ne,execLoading:E,execError:W,executivesList:T}),(($e=Y[K])==null?void 0:$e.key)==="final"&&e.jsx(Iw,{template:s,formData:i,pageType:F==="Legal"?"Legal":"A4",documentId:o,onEnsureSaved:async()=>{await he("created")}})]})}),e.jsx("div",{className:"bg-white border-t border-gray-200 px-6 py-3 text-xs",children:e.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{type:"button",onClick:()=>q(je=>Math.max(je-1,0)),disabled:K===0||P,className:"flex items-center space-x-1.5 px-3 py-1.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ga,{size:12}),e.jsx("span",{children:"Previous"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"text-gray-500",children:["Step ",K+1," of ",Y.length," â€¢ ",s.name,i.status?` â€¢ ${String(i.status).toUpperCase()}`:"",P?" â€¢ Savingâ€¦":""]}),K<Y.length-1?e.jsxs("button",{type:"button",onClick:re,disabled:!de(Y[K].key)||P,className:"flex items-center space-x-1.5 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{children:P?"Savingâ€¦":"Next"}),e.jsx(ga,{size:12,className:"rotate-180"})]}):e.jsxs("button",{type:"button",onClick:ge,disabled:c,className:"flex items-center space-x-1.5 px-4 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ws,{size:12}),e.jsx("span",{children:c?"Generating...":"Generate Document"})]})]})]})}),g&&e.jsx(Ax,{title:"Select Seller",mode:"seller",onSelect:S,onClose:()=>b(!1)}),d&&e.jsx(Ax,{title:"Select Buyer",mode:"buyer",onSelect:C,onClose:()=>v(!1)}),x&&e.jsx(bw,{title:"Select Property",sellerId:(Le=i.seller)==null?void 0:Le.id,prefetchedItems:$,onSelect:J,onClose:()=>u(!1)})]})},Cw=({formData:s,onSellerSelect:a,onBuyerSelect:t,requiresBuyer:r,requiresSeller:i})=>{var n,o,m,g,b,d,v,x,u,c,f,p;return e.jsxs("div",{className:"space-y-6 text-xs",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-gray-900 mb-2",children:"Select Parties"}),e.jsx("p",{className:"text-gray-600",children:"Choose the seller and buyer for this document"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:16}),"Seller Information ",e.jsx("span",{className:"ml-2 text-red-500",children:"*"})]}),s.seller?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Ms,{className:"text-green-600",size:18})}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:[(n=s==null?void 0:s.seller)==null?void 0:n.salutation,(o=s==null?void 0:s.seller)==null?void 0:o.name].filter(Boolean).join(" ")}),(m=s==null?void 0:s.seller)!=null&&m.phone?e.jsxs("a",{href:`tel:${s.seller.phone}`,className:"flex items-center gap-2 text-gray-700 hover:text-gray-900",children:[e.jsx(Cs,{size:12,className:"shrink-0 text-green-600"}),e.jsx("span",{className:"truncate",children:s.seller.phone})]}):null,(g=s==null?void 0:s.seller)!=null&&g.email?e.jsxs("a",{href:`mailto:${s.seller.email}`,className:"flex items-center gap-2 text-gray-700 hover:text-gray-900",children:[e.jsx(Ds,{size:12,className:"shrink-0 text-blue-600"}),e.jsx("span",{className:"truncate",children:s.seller.email})]}):null,(b=s==null?void 0:s.seller)!=null&&b.address||(d=s==null?void 0:s.seller)!=null&&d.location?e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(Qs,{size:12,className:"shrink-0 text-red-600"}),e.jsx("span",{className:"truncate",children:s.seller.address||s.seller.location})]}):null]})]}),e.jsx("button",{type:"button",onClick:a,className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Change Seller"})]}):e.jsx("button",{type:"button",onClick:a,className:"w-full p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ms,{className:"mx-auto text-gray-400 mb-2",size:24}),e.jsx("div",{className:"font-medium text-gray-900",children:"Select Seller"}),e.jsx("div",{className:"text-gray-500",children:"Choose from existing clients or add new"})]})})]}),r&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ns,{className:"mr-2",size:16}),"Buyer Information ",e.jsx("span",{className:"ml-2 text-red-500",children:"*"})]}),s.buyer?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Ns,{className:"text-green-600",size:18})}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:[((v=s==null?void 0:s.buyer)==null?void 0:v.salutation)??(s==null?void 0:s.salutation),(x=s==null?void 0:s.buyer)==null?void 0:x.name].filter(Boolean).join(" ")}),(u=s==null?void 0:s.buyer)!=null&&u.phone?e.jsxs("a",{href:`tel:${s.buyer.phone}`,className:"flex items-center gap-2 text-gray-700 hover:text-gray-900",children:[e.jsx(Cs,{size:12,className:"shrink-0 text-green-600"}),e.jsx("span",{className:"truncate",children:s.buyer.phone})]}):null,(c=s==null?void 0:s.buyer)!=null&&c.email?e.jsxs("a",{href:`mailto:${s.buyer.email}`,className:"flex items-center gap-2 text-gray-700 hover:text-gray-900",children:[e.jsx(Ds,{size:12,className:"shrink-0 text-blue-600"}),e.jsx("span",{className:"truncate",children:s.buyer.email})]}):null,(f=s==null?void 0:s.buyer)!=null&&f.address||(p=s==null?void 0:s.buyer)!=null&&p.location?e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(Qs,{size:12,className:"shrink-0 text-red-600"}),e.jsx("span",{className:"truncate",children:s.buyer.address||s.buyer.location})]}):null]})]}),e.jsx("button",{type:"button",onClick:t,className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Change Buyer"})]}):e.jsx("button",{type:"button",onClick:t,className:"w-full p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ns,{className:"mx-auto text-gray-400 mb-2",size:24}),e.jsx("div",{className:"font-medium text-gray-900",children:"Select Buyer"}),e.jsx("div",{className:"text-gray-500",children:"Choose from existing clients or add new"})]})})]})]})]})},Aw=({formData:s,onInputChange:a,onPropertySelect:t,requiresProperty:r,onContinue:i,propertyTypeHints:n=[]})=>{if(Ps.useEffect(()=>{const x=s==null?void 0:s.property;x&&(x.address&&!s.property_address&&a("property_address",x.address),x.type&&!s.property_type&&a("property_type",x.type),x.area&&!s.property_area&&a("property_area",x.area),x.unit&&!s.unit_number&&a("unit_number",x.unit))},[s==null?void 0:s.property]),!r)return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(Is,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Property Not Required"}),e.jsx("p",{className:"text-gray-500",children:"This template doesn't require property information"}),e.jsx("button",{type:"button",onClick:i,className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Continue to Next Step"})]})});const o=s.property_address??"",m=s.property_type??"",g=s.property_area??"",b=s.unit_number??"",d=Array.isArray(n)&&n.length>0,v=d?"property-type-hints":void 0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Property Information"}),e.jsx("p",{className:"text-gray-600",children:"Select or enter property details for this document"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Details ",e.jsx("span",{className:"ml-2 text-red-500",children:"*"})]}),s.property?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Is,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:s.property.title??"Selected Property"}),e.jsx("div",{className:"text-sm text-gray-600",children:s.property.address??"Address not set"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[(s.property.type??m)||"Type N/A"," â€¢"," ",(s.property.area??g)||"Area N/A"]})]})]}),e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Change Property"})]}):e.jsx("button",{type:"button",onClick:t,className:"w-full p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Is,{className:"mx-auto text-gray-400 mb-2",size:32}),e.jsx("div",{className:"font-medium text-gray-900",children:"Select Property"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Choose from existing properties or add new"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Or Enter Property Details Manually"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Property Address"}),e.jsx("textarea",{name:"property_address",value:o,onChange:x=>a("property_address",x.currentTarget.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",rows:2,placeholder:"Enter complete property address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Property Type"}),e.jsx("input",{name:"property_type",type:"text",value:m,onChange:x=>a("property_type",x.currentTarget.value),list:v,className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"e.g., Apartment / Villa / Office / Shop"}),d&&e.jsx("datalist",{id:v,children:n.map(x=>e.jsx("option",{value:x},x))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Property Area (sq ft)"}),e.jsx("input",{name:"property_area",type:"number",inputMode:"numeric",value:g,onChange:x=>a("property_area",x.currentTarget.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"e.g., 1250"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Unit Number"}),e.jsx("input",{name:"unit_number",type:"text",value:b,onChange:x=>a("unit_number",x.currentTarget.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"e.g., A-404"})]})]})]})]})},Ex=s=>s?s.slice(0,10):"",Pw=({formData:s,onInputChange:a,template:t,usedVariables:r,onVariableInsert:i})=>{var k,R,F,T,j,E;const[n,o]=Ps.useState(!0),[m,g]=Ps.useState(!1),[b,d]=Ps.useState(null),[v,x]=Ps.useState([]),[u,c]=Ps.useState(!1),f=V=>V==null?"":String(V).trim(),p=()=>{var V;return f(((V=s==null?void 0:s.seller)==null?void 0:V.id)??(s==null?void 0:s.seller_id))},N=()=>{var V;return f(((V=s==null?void 0:s.buyer)==null?void 0:V.id)??(s==null?void 0:s.buyer_id))},P=()=>{var V;return f(((V=s==null?void 0:s.property)==null?void 0:V.id)??(s==null?void 0:s.property_id)??(s==null?void 0:s.id))},w=V=>{var M,A;const W=typeof(V==null?void 0:V.transaction_details)=="string"?(()=>{try{return JSON.parse(V.transaction_details)}catch{return{}}})():(V==null?void 0:V.transaction_details)||{},B=Number((V==null?void 0:V.amount)||0);a("payment_type",(V==null?void 0:V.payment_type)??""),a("amount",B||0),a("receipt_id",(V==null?void 0:V.receipt_id)??""),a("payment_reference",(V==null?void 0:V.payment_reference)??""),a("payment_method",(W==null?void 0:W.payment_method)??""),a("buyer_bank_name",(W==null?void 0:W.buyer_bank_name)??""),a("seller_bank_name",(W==null?void 0:W.seller_bank_name)??""),a("receipt_date",V!=null&&V.receipt_date?Ex(V.receipt_date):""),a("payment_date",V!=null&&V.payment_date?Ex(V.payment_date):""),a("related_party",(V==null?void 0:V.related_party)??""),a("payment_status",(V==null?void 0:V.payment_status)??""),a("type",(V==null?void 0:V.type)??""),a("status",(V==null?void 0:V.status)??""),a("notes",(V==null?void 0:V.notes)??""),a("deal_value",(V==null?void 0:V.deal_value)??""),a("amount_in_words",(V==null?void 0:V.amount_in_words)??""),(A=(M=t==null?void 0:t.variables)==null?void 0:M.includes)!=null&&A.call(M,"token_amount")&&a("token_amount",B||0)},$=async()=>{const V=p(),W=N(),B=P();if(!V||!W||!B){Z.warn("Select Seller, Buyer and Property first.");return}g(!0);try{const M=await bl.getAll();let A=_g(M)||[];const L=D=>{var I,H;return D.property_id??D.propertyId??((I=D==null?void 0:D.property)==null?void 0:I.id)??((H=D==null?void 0:D.property)==null?void 0:H.property_id)??""};if(A=A.filter(D=>f(D.seller_id)===V&&f(D.buyer_id)===W&&f(L(D))===B),!A.length){Z.info("No receipts found for this Sellerâ€“Buyerâ€“Property."),x([]),d(null);return}if(A.sort((D,I)=>{const H=f(D.created_at||D.receipt_date);return f(I.created_at||I.receipt_date).localeCompare(H)}),x(A),n&&A.length>0){const D=A[0];d(D),w(D),Z.success(`Applied receipt #${(D==null?void 0:D.receipt_id)||(D==null?void 0:D.id)||""}`)}}catch(M){Z.error(`Receipt fetch failed: ${(M==null?void 0:M.message)||M}`)}finally{g(!1)}},y=V=>{if(!V){d(null),["payment_type","amount","receipt_id","payment_reference","payment_method","buyer_bank_name","seller_bank_name","receipt_date","payment_date","related_party","payment_status","type","status","notes","deal_value","amount_in_words"].forEach(M=>a(M,""));return}const W=v.find(B=>String(B.id)===V);W&&(d(W),w(W),Z.success(`Applied receipt #${(W==null?void 0:W.receipt_id)||(W==null?void 0:W.id)||""}`))};return Ps.useEffect(()=>{if(!n||b||m)return;const V=p(),W=N(),B=P();V&&W&&B&&$()},[(k=s==null?void 0:s.seller)==null?void 0:k.id,s==null?void 0:s.seller_id,(R=s==null?void 0:s.buyer)==null?void 0:R.id,s==null?void 0:s.buyer_id,(F=s==null?void 0:s.property)==null?void 0:F.id,s==null?void 0:s.property_id,s==null?void 0:s.id,n]),e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Document Information"}),e.jsx("p",{className:"text-gray-600",children:"Fill in the document details and financial information"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(ws,{className:"mr-2",size:16}),"Document Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Document Title"}),e.jsx("input",{type:"text",value:s.title,onChange:V=>a("title",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"Enter document title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Document ID"}),e.jsx("input",{type:"text",value:s.document_id,readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg bg-gray-50 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Document Date"}),e.jsx("input",{type:"date",value:s.document_date,onChange:V=>a("document_date",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(vu,{className:"mr-2",size:16}),"Financial Information"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx("button",{type:"button",onClick:$,disabled:m,className:"px-2.5 py-1 bg-gray-800 text-white rounded-md text-[11px] hover:bg-gray-900 disabled:opacity-50",children:m?"Fetchingâ€¦":"Fetch Receipts"}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] px-2 py-1 border rounded-md bg-white",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:V=>o(V.target.checked)}),"Auto-apply latest"]}),v.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-[11px] text-gray-700",children:"Select Receipt:"}),e.jsxs("select",{value:(b==null?void 0:b.id)||"",onChange:V=>y(V.target.value),className:"px-2 py-1 border rounded-md text-[11px] bg-white",children:[e.jsx("option",{value:"",children:"-- Select Receipt --"}),v.map(V=>{var W;return e.jsxs("option",{value:V.id,children:["#",V.receipt_id||V.id," - ",V.payment_type," - â‚¹",V.amount," - ",(W=V.receipt_date)==null?void 0:W.slice(0,10)]},V.id)})]})]}),e.jsx("button",{type:"button",onClick:()=>{const V=p(),W=N(),B=P();if(!V||!W||!B){Z.warn("Select Seller, Buyer and Property first.");return}c(!0)},className:"px-2.5 py-1 bg-orange-600 text-white rounded-md text-[11px] hover:bg-orange-700",children:"+ Add New Receipt"}),b?e.jsxs("span",{className:"ml-auto text-[11px] px-2 py-1 rounded bg-green-50 text-green-700 border border-green-200",children:["Applied: ",e.jsx("b",{children:(b==null?void 0:b.receipt_id)||(b==null?void 0:b.id)})]}):null]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Payment Type"}),e.jsx("input",{type:"text",value:s.payment_type||"",onChange:V=>a("payment_type",V.target.value),placeholder:"e.g., Token, Booking, Part Payment",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Payment Method"}),e.jsx("input",{type:"text",value:s.payment_method||"",onChange:V=>a("payment_method",V.target.value),placeholder:"e.g., Cash, UPI, Bank Transfer",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Payment Status"}),e.jsx("input",{type:"text",value:s.payment_status||"",onChange:V=>a("payment_status",V.target.value),placeholder:"e.g., Paid, Pending",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Receipt ID"}),e.jsx("input",{type:"text",value:s.receipt_id||"",onChange:V=>a("receipt_id",V.target.value),placeholder:"Receipt ID",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Receipt Date"}),e.jsx("input",{type:"date",value:s.receipt_date||"",onChange:V=>a("receipt_date",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Payment Date"}),e.jsx("input",{type:"date",value:s.payment_date||"",onChange:V=>a("payment_date",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Amount (â‚¹)"}),e.jsx("input",{type:"number",value:s.amount??"",onChange:V=>{var B,M;const W=Number(V.target.value||0);a("amount",W),(M=(B=t==null?void 0:t.variables)==null?void 0:B.includes)!=null&&M.call(B,"token_amount")&&a("token_amount",W)},placeholder:"500000",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Amount in Words"}),e.jsx("input",{type:"text",value:s.amount_in_words||"",onChange:V=>a("amount_in_words",V.target.value),placeholder:"Five Lakh Only",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Deal Value (â‚¹)"}),e.jsx("input",{type:"number",value:s.deal_value??"",onChange:V=>a("deal_value",Number(V.target.value||0)),placeholder:"Total deal value",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Related Party"}),e.jsx("input",{type:"text",value:s.related_party||"",onChange:V=>a("related_party",V.target.value),placeholder:"Party involved",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Type"}),e.jsx("input",{type:"text",value:s.type||"",onChange:V=>a("type",V.target.value),placeholder:"Receipt type",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Status"}),e.jsx("input",{type:"text",value:s.status||"",onChange:V=>a("status",V.target.value),placeholder:"Receipt status",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Payment Reference"}),e.jsx("input",{type:"text",value:s.payment_reference||"",onChange:V=>a("payment_reference",V.target.value),placeholder:"Txn/UTR/Cheque No. etc.",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Buyer Bank Name"}),e.jsx("input",{type:"text",value:s.buyer_bank_name||"",onChange:V=>a("buyer_bank_name",V.target.value),placeholder:"e.g., HDFC Bank",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Seller Bank Name"}),e.jsx("input",{type:"text",value:s.seller_bank_name||"",onChange:V=>a("seller_bank_name",V.target.value),placeholder:"e.g., ICICI Bank",className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Notes"}),e.jsx("textarea",{value:s.notes||"",onChange:V=>a("notes",V.target.value),placeholder:"Additional notes...",rows:2,className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.variables.includes("commission_rate")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Commission Rate (%)"}),e.jsx("input",{type:"number",value:s.commission_rate||"",onChange:V=>a("commission_rate",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"2",step:"0.1"})]}),t.variables.includes("validity_period")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Validity Period"}),e.jsx("input",{type:"text",value:s.validity_period||"",onChange:V=>a("validity_period",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs",placeholder:"6 months"})]}),t.variables.includes("agreement_date")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Agreement Date"}),e.jsx("input",{type:"date",value:s.agreement_date||"",onChange:V=>a("agreement_date",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]}),t.variables.includes("possession_date")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Possession Date"}),e.jsx("input",{type:"date",value:s.possession_date||"",onChange:V=>a("possession_date",V.target.value),className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 h-fit",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"Variables"})}),e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Inserted Placeholder"}),e.jsxs("select",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg text-xs bg-white",defaultValue:"",onChange:V=>{const W=V.target.value;W&&(i(W),V.currentTarget.value="")},children:[e.jsx("option",{value:"",disabled:!0,children:"Select a variable"}),r.map(V=>e.jsx("option",{value:V,children:V},V))]}),e.jsx("div",{className:"mt-3 text-[11px] text-gray-500",children:"Only variables used by this template are listed."})]})]}),u&&e.jsx(Nw,{isOpen:u,onClose:()=>c(!1),userRole:"manager",prefill:{sellerId:((T=s==null?void 0:s.seller)==null?void 0:T.id)??(s==null?void 0:s.seller_id),buyerId:((j=s==null?void 0:s.buyer)==null?void 0:j.id)??(s==null?void 0:s.buyer_id),propertyId:((E=s==null?void 0:s.property)==null?void 0:E.id)??(s==null?void 0:s.property_id)??(s==null?void 0:s.id)},lockSelections:{seller:!0,buyer:!0,property:!0},receipt:void 0,onSave:async V=>{try{const W=await bl.create(V),B=(W==null?void 0:W.data)??W;await $(),n&&B&&(d(B),w(B)),Z.success("Receipt created & applied to document."),c(!1)}catch(W){Z.error(`Failed to create receipt: ${(W==null?void 0:W.message)||W}`)}}})]})},Tw=({formData:s,template:a,requiresBuyer:t,requiresSeller:r,requiresProperty:i,onInputChange:n,execLoading:o,execError:m,executivesList:g})=>{var b,d,v,x,u,c,f,p,N,P,w,$;return e.jsxs("div",{className:"space-y-5 text-xs",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Review & Finalize"}),e.jsx("p",{className:"text-gray-600",children:"Review all information before generating the document."})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Document Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Document Information"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Template:"}),e.jsx("span",{className:"font-medium text-right",children:a.name})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Title:"}),e.jsx("span",{className:"font-medium text-right",children:s.title})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Document ID:"}),e.jsx("span",{className:"font-medium text-right",children:s.document_id})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium text-right",children:s.document_date?s.document_date.split("-").reverse().join("-"):""})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Parties Information"}),e.jsxs("div",{className:"space-y-2",children:[r&&e.jsxs("div",{className:"space-y-1.5 border-b border-gray-200 pb-2",children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Seller ID:"}),e.jsx("span",{className:"text-right",children:((b=s.seller)==null?void 0:b.id)||"-"})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Seller Name:"}),e.jsxs("span",{className:"font-medium text-right",children:[(d=s.seller)==null?void 0:d.salutation," ",((v=s.seller)==null?void 0:v.name)||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Contact:"}),e.jsxs("span",{className:"text-right",children:[((x=s.seller)==null?void 0:x.email)||"-"," ",(u=s.seller)!=null&&u.phone?`â€¢ ${(c=s.seller)==null?void 0:c.phone}`:""]})]})]}),t&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Buyer ID:"}),e.jsx("span",{className:"text-right",children:((f=s.buyer)==null?void 0:f.id)||"-"})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Buyer Name:"}),e.jsxs("span",{className:"font-medium text-right",children:[(p=s.buyer)==null?void 0:p.salutation," ",((N=s.buyer)==null?void 0:N.name)||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-gray-600",children:"Contact:"}),e.jsxs("span",{className:"text-right",children:[((P=s.buyer)==null?void 0:P.email)||"-"," ",(w=s.buyer)!=null&&w.phone?`â€¢ ${($=s.buyer)==null?void 0:$.phone}`:""]})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Assigned Sales Executive"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:s.executive_id||"",disabled:o||!!m,onChange:y=>{const k=y.target.value,R=g.find(F=>String(F.id)===String(k));R?(n("executive_id",R.id),n("sales_executive",R.name||""),n("executive_phone",R.phone||""),n("executive_email",R.email||"")):(n("executive_id",""),n("sales_executive",""),n("executive_phone",""),n("executive_email",""))},className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-xs bg-white",children:[e.jsx("option",{value:"",children:o?"Loading executivesâ€¦":m?"Failed to load":"Select executive"}),g.map(y=>e.jsxs("option",{value:String(y.id),children:[y.name,y.designation?` â€¢ ${y.designation}`:""," (Sales)"]},y.id))]}),s.executive_id&&e.jsx("button",{type:"button",onClick:()=>{n("executive_id",""),n("sales_executive",""),n("executive_phone",""),n("executive_email","")},className:"px-2 py-1.5 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Clear"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Exec ID"}),e.jsx("input",{type:"text",value:s.executive_id||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-200 rounded-lg bg-gray-50 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Exec Name"}),e.jsx("input",{type:"text",value:s.sales_executive||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-200 rounded-lg bg-gray-50 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Exec Phone"}),e.jsx("input",{type:"text",value:s.executive_phone||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-200 rounded-lg bg-gray-50 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Exec Email"}),e.jsx("input",{type:"text",value:s.executive_email||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-200 rounded-lg bg-gray-50 text-xs"})]})]})]}),i&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Property Summary"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Address:"}),e.jsx("span",{className:"font-medium text-right",children:s.property_address||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Property Type:"}),e.jsx("span",{className:"font-medium text-right",children:s.property_type||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Area:"}),e.jsx("span",{className:"font-medium text-right",children:s.property_area?`${s.property_area} sq ft`:"-"})]})]})]})]}),(s.sale_amount||s.token_amount||s.booking_amount)&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Financial Summary"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s.sale_amount&&e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["â‚¹",(Number(s.sale_amount)/1e5).toFixed(1),"L"]}),e.jsx("div",{className:"text-xs text-green-700",children:"Sale Amount"})]}),s.token_amount&&e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["â‚¹",(Number(s.token_amount)/1e5).toFixed(1),"L"]}),e.jsx("div",{className:"text-xs text-blue-700",children:"Token Amount"})]}),s.booking_amount&&e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:["â‚¹",(Number(s.booking_amount)/1e5).toFixed(1),"L"]}),e.jsx("div",{className:"text-xs text-purple-700",children:"Booking Amount"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Pre-Generation Checklist"}),e.jsxs("div",{className:"space-y-2",children:[r&&e.jsxs("div",{className:"flex items-center space-x-2",children:[s.seller?e.jsx(bs,{className:"text-green-600",size:16}):e.jsx(ct,{className:"text-red-600",size:16}),e.jsx("span",{className:s.seller?"text-green-700":"text-red-700",children:"Seller information is complete"})]}),t&&e.jsxs("div",{className:"flex items-center space-x-2",children:[s.buyer?e.jsx(bs,{className:"text-green-600",size:16}):e.jsx(ct,{className:"text-red-600",size:16}),e.jsx("span",{className:s.buyer?"text-green-700":"text-red-700",children:"Buyer information is complete"})]}),i&&e.jsxs("div",{className:"flex items-center space-x-2",children:[s.property_address||s.property?e.jsx(bs,{className:"text-green-600",size:16}):e.jsx(ct,{className:"text-red-600",size:16}),e.jsx("span",{className:s.property_address||s.property?"text-green-700":"text-red-700",children:"Property information is complete"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.title&&s.document_date?e.jsx(bs,{className:"text-green-600",size:16}):e.jsx(ct,{className:"text-red-600",size:16}),e.jsx("span",{className:s.title&&s.document_date?"text-green-700":"text-red-700",children:"Document details are complete"})]})]})]})]})},Iw=({template:s,formData:a,pageType:t,documentId:r,onEnsureSaved:i})=>{const n=Ps.useMemo(()=>pd(s,a),[s,a]);return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(ks,{className:"mr-2",size:16}),"Final Preview"]}),e.jsx(nw,{template:s,documentData:{...a,...n},isVisible:!0,pageType:t,documentId:r??void 0,onEnsureSaved:i})]})},$w=()=>{const[s,a]=l.useState(null),[t,r]=l.useState({}),i=o=>{a(o);const m=o==null?void 0:o._generatedDoc;r(m??{})},n=()=>{a(null),r({})};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:s?e.jsx(kw,{template:s,documentData:t,onDataChange:r,onBack:n}):e.jsx(Ng,{mode:"select",onSelectTemplate:i})})},rl=s=>{var t,r,i,n;const a=((r=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:r.message)||((n=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:n.error)||(s==null?void 0:s.message)||"Request failed";return new Error(a)},ll={getAll:async()=>(await Ae.get("/variables/get-all")).data,getByTab:async s=>{if(!s)throw new Error("Tab ID is required");try{return(await Ae.get(`/variables/${encodeURIComponent(s)}`)).data}catch(a){throw rl(a)}},create:async s=>{if(!(s!=null&&s.name)||!(s!=null&&s.variable_tab_id))throw new Error("Name and Tab ID are required");if(!s.variable_key)throw new Error("Variable key is required");if(!s.placeholder)throw new Error("Placeholder is required");if(!s.category)throw new Error("Category is required");try{return(await Ae.post("/variables",s)).data}catch(a){throw rl(a)}},update:async(s,a)=>{if(!s)throw new Error("Variable ID is required");try{return(await Ae.put(`/variables/${s}`,a)).data}catch(t){throw rl(t)}},delete:async s=>{if(!s)throw new Error("Variable ID is required");try{return(await Ae.delete(`/variables/${s}`)).data}catch(a){throw rl(a)}},bulkDelete:async s=>{if(!Array.isArray(s)||s.length===0)throw new Error("IDs are required");try{return(await Ae.post("/variables/bulk-delete",{ids:s})).data}catch(a){throw rl(a)}},bulkUpdateStatus:async(s,a)=>{if(!Array.isArray(s)||s.length===0)throw new Error("IDs are required");if(!["active","inactive"].includes(a))throw new Error("Invalid status");try{return(await Ae.post("/variables/bulk-status",{ids:s,status:a})).data}catch(t){throw rl(t)}},importFile:async(s,a,t=!0)=>{if(!s)throw new Error("File is required");if(!a)throw new Error("Tab ID is required");try{const r=new FormData;return r.append("file",s),r.append("tabId",a),r.append("skipDup",String(t)),(await Ae.post(`/variables/import?tabId=${encodeURIComponent(a)}&skipDup=${t?"1":"0"}`,r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw rl(r)}}},Sg=[{id:"all",label:"All Variables",icon:qi},{id:"buyer",label:"Buyer Variables",icon:Ms},{id:"seller",label:"Seller Variables",icon:Ms},{id:"property",label:"Property Variables",icon:Is},{id:"leads",label:"Leads Variables",icon:Ms},{id:"account",label:"Account Variables",icon:Ut},{id:"company",label:"Company Variables",icon:Is},{id:"common",label:"Common Variables",icon:qi}];function Ew(s){const a=String(s||"").toLowerCase().trim();return new Set(Sg.map(r=>r.id).filter(r=>r!=="all")).has(a)?a:"common"}const Mw=({onVariableInsert:s,onLoaded:a})=>{const[t,r]=l.useState(""),[i,n]=l.useState("all"),[o,m]=l.useState([]);l.useEffect(()=>{(async()=>{try{const v=await ll.getAll(),x=((v==null?void 0:v.data)||[]).map(u=>({name:u.variable_key,label:u.name,category:Ew(u.category),description:u.name}));m(x),a==null||a(x)}catch(v){console.error("Error fetching variables:",v),m([]),a==null||a([])}})()},[a]);const g=l.useMemo(()=>{const v=new Set(o.map(c=>c.category)),u=Sg.filter(c=>c.id!=="all").filter(c=>v.has(c.id));return[{id:"all",label:"All Variables",icon:qi},...u]},[o]),b=l.useMemo(()=>{const v=t.toLowerCase();return o.filter(x=>{const u=x.name.toLowerCase().includes(v)||x.label.toLowerCase().includes(v),c=i==="all"||x.category===i;return u&&c})},[o,t,i]),d=l.useMemo(()=>{const v={};for(const x of o)v[x.category]=(v[x.category]||0)+1;return v.all=o.length,v},[o]);return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Variables Panel"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search variables...",value:t,onChange:v=>r(v.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:g.map(v=>{const x=v.icon,u=i===v.id,c=d[v.id]??0;return e.jsxs("button",{onClick:()=>n(v.id),className:`flex items-center space-x-1 px-2 py-1 rounded text-xs font-medium transition-colors ${u?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,title:`${v.label} (${c})`,children:[e.jsx(x,{size:12}),e.jsx("span",{children:v.label}),e.jsx("span",{className:`ml-1 inline-block px-1 rounded ${u?"bg-blue-200":"bg-gray-200"} text-[10px]`,children:c})]},v.id)})})]}),e.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:e.jsx("div",{className:"space-y-2",children:b.map(v=>e.jsx("div",{onClick:()=>s==null?void 0:s(v),className:"p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm font-mono bg-gray-100 px-2 py-1 rounded text-blue-600 group-hover:bg-blue-100",children:`{{${v.name}}}`}),e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-gray-100 text-gray-700",children:v.category})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:v.description})]}),e.jsx(Xt,{className:"text-gray-400 group-hover:text-blue-600",size:14})]})},v.name))})}),b.length===0&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(qi,{className:"mx-auto text-gray-400 mb-2",size:32}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No variables found"})]})]})},Lw=[{label:"8 pt",sizeCmd:1},{label:"10 pt",sizeCmd:2},{label:"12 pt",sizeCmd:3},{label:"14 pt",sizeCmd:4},{label:"18 pt",sizeCmd:5},{label:"24 pt",sizeCmd:6},{label:"36 pt",sizeCmd:7}],Dw=["Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial","Arial","Times New Roman","Georgia","Verdana","Tahoma","Courier New","Monaco","Calibri","Garamond"],Rw=["all","buyer","seller","property","leads","account","company","common"],nl="<title>RESALE EXPERT</title><style>body{background:rgb(204,204,204);font-size:13px;font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif !important;line-height:1.3 !important;}#printDialog{width:230mm;height:100%;margin:0 auto;padding:0;font-size:13px;font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif !important;background:rgb(204,204,204);line-height:1.3 !important;}*{box-sizing:border-box;-moz-box-sizing:border-box;}.main-page{width:210mm;min-height:297mm;margin:10mm auto;background:white;box-shadow:0 0 0.5cm rgba(0,0,0,0.5);}.sub-page{margin-left:50px;margin-right:50px;font-size:13px;}@page{size:A4;margin:0;}@media print{html,body{width:210mm;height:297mm;}.main-page{margin:0;border:initial;border-radius:initial;width:initial;min-height:initial;box-shadow:initial;background:initial;page-break-after:always;}a:link{text-decoration:none !important;}a[href]:after{content:none !important;}}.left{float:left;} .right{float:right;}.companylogo{width:180px;height:60px;} .projectlogo{width:180px;height:60px;}.footerlogo{width:180px;height:60px;}hr.new1{border-top:1px solid;}.div-table{border:1px solid #000;border-collapse:collapse;font-size:11px;}.div-table-row{border:1px solid #000;border-collapse:collapse;}.div-table-col{border:1px solid #000;border-collapse:collapse;padding-left:5px;}table{font-size:13px;font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif !important;border-collapse:unset;}</style>",zw="<title>RESALE EXPERT</title><style>body{background:rgb(204,204,204);font-size:13px;font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif !important;line-height:1.3 !important;}#printDialog{width:236mm;height:100%;margin:0 auto;padding:0;font-size:13px;font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif !important;background:rgb(204,204,204);line-height:1.3 !important;}*{box-sizing:border-box;-moz-box-sizing:border-box;}.main-page{width:216mm;min-height:356mm;margin:10mm auto;background:white;box-shadow:0 0 0.5cm rgba(0,0,0,0.5);}.sub-page{margin-left:50px;margin-right:50px;font-size:13px;}@page{size:Legal;margin:0;}@media print{html,body{width:216mm;height:356mm;}.main-page{margin:0;border:initial;border-radius:initial;width:initial;min-height:initial;box-shadow:initial;background:initial;page-break-after:always;}a:link{text-decoration:none !important;}a[href]:after{content:none !important;}}.left{float:left;} .right{float:right;}.companylogo{width:180px;height:60px;} .projectlogo{width:180px;height:60px;}.footerlogo{width:180px;height:60px;}hr.new1{border-top:1px solid;}.div-table{border:1px solid #000;border-collapse:collapse;font-size:11px;}.div-table-row{border:1px solid #000;border-collapse:collapse;}.div-table-col{border:1px solid #000;border-collapse:collapse;padding-left:5px;}table{font-size:13px;font-family:'Lucida Sans','Lucida Sans Regular','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,sans-serif !important;border-collapse:unset;}</style>",Ol=[{id:"blank-legal",name:"Legal â€¢ Blank Page",html:`<!doctype html><html><head>${zw}</head><body id="printDialog"><div class="main-page"><div class="sub-page" style="padding-top:24px;padding-bottom:24px;"><p style="color:#000000;margin:0 0 8px 0;">(Blank Legal page)</p><br></div></div></body></html>`},{id:"blank-a4",name:"A4 â€¢ Blank Page",html:`<!doctype html><html><head>${nl}</head><body id="printDialog"><div class="main-page"><div class="sub-page" style="padding-top:24px;padding-bottom:24px;"><p style="color:#000000;margin:0 0 8px 0;">(Blank A4 page)</p><br></div></div></body></html>`},{id:"blank-receipt",name:"A4 â€¢ Blank Receipt",html:`<!doctype html><html><head>${nl}</head><body id="printDialog"><div class="main-page"><div class="sub-page"><table width="100%" style="padding-top:24px"><tbody><tr><td style="width:50%;vertical-align:top;"><img src="{{company_logo}}" alt="Company Logo" class="companylogo"/><h2 style="margin:8px 0 0;color:#0c3854;">Resale Expert</h2><div style="color:#000000;">Address line 1<br/>City, State PIN<br/>+91-XXXXXXXXXX</div></td><td style="text-align:right;vertical-align:top;"><h1 style="margin:0;color:#E6761D;">RECEIPT</h1><div>Date: <strong>__ / __ / ____</strong></div><div>Receipt No: <strong>RE-0001</strong></div></td></tr></tbody></table><hr class="new1" style="margin:16px 0"/><table width="100%" class="div-table"><tbody><tr class="div-table-row"><td class="div-table-col" style="width:25%;">Received From</td><td class="div-table-col" colspan="3">[Buyer / Client Name]</td></tr><tr class="div-table-row"><td class="div-table-col">Amount</td><td class="div-table-col">â‚¹ ___________</td><td class="div-table-col">Mode</td><td class="div-table-col">Cash / UPI / Cheque</td></tr><tr class="div-table-row"><td class="div-table-col">Against</td><td class="div-table-col" colspan="3">[Property / Service]</td></tr></tbody></table><p style="margin-top:24px;">Notes: ____________________________________________________________________</p><table width="100%" style="margin-top:48px;"><tr><td style="width:50%;"></td><td style="text-align:right;"><div>For <strong>Resale Expert</strong></div><div style="margin-top:48px;">Authorised Signatory</div></td></tr></table></div></div></body></html>`},{id:"letterhead",name:"A4 â€¢ Letterhead",html:`<!doctype html><html><head>${nl}</head><body id="printDialog"><div class="main-page"><div class="sub-page"><table width="100%" style="padding-top:24px"><tr><td style="vertical-align:middle;"><img src="{{company_logo}}" alt="Company Logo" class="companylogo"/></td><td style="text-align:right;"><div style="font-size:12px;color:#000000;">www.resale.expert<br/>hello@resale.expert<br/>+91-XXXXXXXXXX</div></td></tr></table><hr class="new1" style="margin:16px 0 24px"/><h2 style="margin:0;color:#0c3854;">Subject: ______________________________</h2><p style="margin:16px 0;">Dear ________,</p><p>[Compose your letter hereâ€¦]</p><p style="margin-top:32px;">Regards,<br/><strong>Resale Expert</strong></p><hr class="new1" style="margin-top:40px"/><div style="text-align:center;color:#000000;font-size:11px;padding:8px 0;">Registered Office â€¢ Address line 1 â€¢ City â€¢ State â€¢ PIN</div></div></div></body></html>`},{id:"property-brochure",name:"A4 â€¢ Property Brochure (1-pg)",html:`<!doctype html><html><head>${nl}</head><body id="printDialog"><div class="main-page"><div class="sub-page"><table width="100%" style="padding-top:24px;"><tr><td><h1 style="margin:0;color:#E6761D;">Property Brochure</h1><div style="color:#000000;">Project / Society â€¢ City</div></td><td style="text-align:right;"><img src="" alt="Project Logo" class="projectlogo"/></td></tr></table><table width="100%" style="margin-top:16px;"><tr><td style="width:50%;vertical-align:top;padding-right:12px;"><div style="height:180px;background:#f3f4f6;border:1px solid #e5e7eb;display:flex;align-items:center;justify-content:center;">Hero Image</div><div style="display:flex;gap:8px;margin-top:8px;"><div style="flex:1;height:80px;background:#f3f4f6;border:1px solid #e5e7eb;"></div><div style="flex:1;height:80px;background:#f3f4f6;border:1px solid #e5e7eb;"></div><div style="flex:1;height:80px;background:#f3f4f6;border:1px solid #e5e7eb;"></div></div></td><td style="vertical-align:top;"><table width="100%" class="div-table"><tr><td class="div-table-col" style="width:40%;">Property Type</td><td class="div-table-col">Apartment</td></tr><tr><td class="div-table-col">Configuration</td><td class="div-table-col">2 BHK</td></tr><tr><td class="div-table-col">Carpet Area</td><td class="div-table-col">____ sq.ft</td></tr><tr><td class="div-table-col">Price</td><td class="div-table-col">â‚¹ ________</td></tr><tr><td class="div-table-col">Location</td><td class="div-table-col">__________</td></tr><tr><td class="div-table-col">RERA</td><td class="div-table-col">__________</td></tr></table><div style="margin-top:12px;"><strong>Amenities:</strong><ul style="margin:8px 0 0 16px;"><li>Clubhouse</li><li>Gym</li><li>Swimming Pool</li><li>Security</li></ul></div></td></tr></table><div style="margin-top:16px;"><strong>Description:</strong><p style="margin-top:8px;">Write a short description of the property hereâ€¦</p></div></div></div></body></html>`},{id:"quotation",name:"A4 â€¢ Quotation",html:`<!doctype html><html><head>${nl}</head><body id="printDialog"><div class="main-page"><div class="sub-page"><table width="100%" style="padding-top:24px"><tr><td><h1 style="margin:0;color:#E6761D;">QUOTATION</h1><div style="color:#000000;">Ref: QT-0001 â€¢ Date: __/__/____</div></td><td style="text-align:right;"><img src="" alt="Company Logo" class="companylogo"/></td></tr></table><table width="100%" class="div-table" style="margin-top:12px;"><tr class="div-table-row"><td class="div-table-col" style="width:20%;">To</td><td class="div-table-col">[Client Name]</td></tr><tr class="div-table-row"><td class="div-table-col">Email</td><td class="div-table-col">client@email.com</td></tr><tr class="div-table-row"><td class="div-table-col">Phone</td><td class="div-table-col">+91-XXXXXXXXXX</td></tr></table><table width="100%" class="div-table" style="margin-top:16px;"><thead><tr class="div-table-row"><th class="div-table-col" style="width:8%;">#</th><th class="div-table-col">Description</th><th class="div-table-col" style="width:15%;">Qty</th><th class="div-table-col" style="width:18%;">Rate (â‚¹)</th><th class="div-table-col" style="width:18%;">Amount (â‚¹)</th></tr></thead><tbody><tr class="div-table-row"><td class="div-table-col">1</td><td class="div-table-col">Service / Unit</td><td class="div-table-col">1</td><td class="div-table-col">0.00</td><td class="div-table-col">0.00</td></tr><tr class="div-table-row"><td class="div-table-col">2</td><td class="div-table-col">Service / Unit</td><td class="div-table-col">1</td><td class="div-table-col">0.00</td><td class="div-table-col">0.00</td></tr></tbody></table><table width="40%" align="right" class="div-table" style="margin-top:12px;"><tr class="div-table-row"><td class="div-table-col">Subtotal</td><td class="div-table-col">â‚¹ 0.00</td></tr><tr class="div-table-row"><td class="div-table-col">Taxes</td><td class="div-table-col">â‚¹ 0.00</td></tr><tr class="div-table-row"><td class="div-table-col"><strong>Total</strong></td><td class="div-table-col"><strong>â‚¹ 0.00</strong></td></tr></table><div style="clear:both;"></div><p style="margin-top:24px;"><strong>Terms & Conditions:</strong><br/>â€” Valid for 7 days â€¢ â€” Payment terms â€¢ â€” Other notes</p></div></div></body></html>`},{id:"agreement-summary",name:"A4 â€¢ Agreement Summary",html:`<!doctype html><html><head>${nl}</head><body id="printDialog"><div class="main-page"><div class="sub-page"><h1 style="margin:24px 0 8px;color:#E6761D;">Agreement Summary</h1><table width="100%" class="div-table"><tr class="div-table-row"><td class="div-table-col" style="width:30%;">Buyer</td><td class="div-table-col">{{buyer_name}}</td></tr><tr class="div-table-row"><td class="div-table-col">Seller</td><td class="div-table-col">{{seller_name}}</td></tr><tr class="div-table-row"><td class="div-table-col">Property</td><td class="div-table-col">{{property_address}}</td></tr><tr class="div-table-row"><td class="div-table-col">Agreement Value</td><td class="div-table-col">â‚¹ {{sale_amount}}</td></tr><tr class="div-table-row"><td class="div-table-col">Date</td><td class="div-table-col">{{agreement_date}}</td></tr></table><h3 style="margin:16px 0 8px;color:#0c3854;">Clauses</h3><ol style="margin:0 0 0 18px;"><li>Clause 1â€¦</li><li>Clause 2â€¦</li><li>Clause 3â€¦</li></ol><table width="100%" style="margin-top:32px;"><tr><td style="width:50%;vertical-align:top;"><div><strong>Buyer Signature</strong></div><div style="height:60px;border:1px dashed #9ca3af;margin-top:8px;"></div></td><td style="vertical-align:top;text-align:right;"><div><strong>Seller Signature</strong></div><div style="height:60px;border:1px dashed #9ca3af;margin-top:8px;"></div></td></tr></table></div></div></body></html>`}],lc=s=>/class\s*=\s*["']main-page["']/.test(s)&&/class\s*=\s*["']sub-page["']/.test(s),Bn=s=>`<!doctype html><html><head>${nl}</head><body id="printDialog"><div class="main-page"><div class="sub-page" style="padding-top:24px;padding-bottom:24px;">${s}</div></div></body></html>`,nc=s=>s.replace(/\s+$/g,"");function Mx(s,a){const t=s.match(/<div[^>]*class=["'][^"']*sub-page[^"']*["'][^>]*>/i);if(!t)return Bn(a);const r=t[0],i=s.indexOf(r)+r.length,n=s.indexOf("</div>",i);return n===-1?Bn(a):s.slice(0,i)+a+s.slice(n)}function ic(s){if(!s)return[];const t=(s.match(/\{\{([a-zA-Z0-9_]+)\}\}/g)||[]).map(r=>r.slice(2,-2));return Array.from(new Set(t))}const Lx=s=>{if(!s)return"";if(/^(data:|https?:|blob:)/i.test(s))return s;const a=window.location.origin;try{return new URL(s,a).href}catch{return s}};function Dx(s){return new Promise((a,t)=>{const r=new FileReader;r.onload=()=>a(String(r.result||"")),r.onerror=t,r.readAsDataURL(s)})}function Ul(s,a,t){try{const i=new DOMParser().parseFromString(s,"text/html");a&&i.querySelectorAll("img.companylogo").forEach(m=>{m.setAttribute("src",a),m.setAttribute("alt",m.getAttribute("alt")||"Company Logo")}),t&&i.querySelectorAll("img.footerlogo").forEach(m=>{m.setAttribute("src",t),m.setAttribute("alt",m.getAttribute("alt")||"Footer Logo")});const n=/^\s*<!doctype/i.test(s),o=i.documentElement.outerHTML;return(n?"<!doctype html>":"")+o}catch{return s}}const Fw=({template:s,onSave:a,onClose:t})=>{const[r,i]=l.useState([]),[n,o]=l.useState([]),[m,g]=l.useState("all"),[b,d]=l.useState({name:"",description:"",category:"deal",status:"draft"}),[v,x]=l.useState(""),[u,c]=l.useState("visual"),[f,p]=l.useState(!1),[N,P]=l.useState("blank-a4"),[w,$]=l.useState(""),[y,k]=l.useState(""),R=l.useRef(null),F=l.useRef(null),T=l.useRef(null),j=l.useRef(null),E=l.useRef(null),{user:V}=Hs(),[W,B]=l.useState([]);l.useEffect(()=>{(async()=>{try{const he=await _r.getSettings(),se=he==null?void 0:he.data;se!=null&&se.company_logo&&$(se.company_logo),se!=null&&se.footer_logo&&k(se.footer_logo)}catch(he){console.error("Error fetching settings:",he)}})()},[]);const M=l.useMemo(()=>(V==null?void 0:V.id)??null,[V]);l.useEffect(()=>{(async()=>{try{const Q=await _r.getSettings(),he=(Q==null?void 0:Q.data)??Q;he!=null&&he.company_logo&&$(Lx(he.company_logo)),he!=null&&he.footer_logo&&k(Lx(he.footer_logo))}catch(Q){console.error("Error fetching settings:",Q)}})()},[]),l.useEffect(()=>{i((s==null?void 0:s.variables)||[]),d({name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",category:(s==null?void 0:s.category)||"deal",status:(s==null?void 0:s.status)||"draft"});const Q=(s==null?void 0:s.content)||Ol.find(he=>he.id==="blank-a4").html;x(nc(Q))},[s]),l.useEffect(()=>{u==="visual"&&F.current&&F.current.innerHTML!==v&&(F.current.innerHTML=v)},[u,v]),l.useEffect(()=>{!w&&!y||x(Q=>{const he=Ul(Q,w,y);return u==="visual"&&F.current&&(F.current.innerHTML=he),he})},[w,y,u]);const A=l.useCallback((Q,he)=>{var se;(se=F.current)==null||se.focus(),document.execCommand(Q,!1,he),F.current&&x(F.current.innerHTML)},[]),L=Q=>{if(u!=="visual"||!F.current){x(U=>U+Q);return}F.current.focus();const he=window.getSelection();if(!he||he.rangeCount===0)return;const se=he.getRangeAt(0);se.deleteContents();const ge=document.createElement("div");ge.innerHTML=Q;const ee=ge.firstChild,de=document.createTextNode("â€‹");ee&&(se.insertNode(ee),se.setStartAfter(ee),se.setEndAfter(ee),se.insertNode(de),se.setStartAfter(de),he.removeAllRanges(),he.addRange(se)),document.execCommand("foreColor",!1,"#000000"),x(F.current.innerHTML)},D=Q=>{const he=Q.target.value;if(!he)return;const se=`<span style="color:#000000;padding:2px 4px;border-radius:4px;font-weight:500;">{{${he}}}</span>`;L(se),i(ge=>Array.from(new Set([...ge,he]))),Q.target.selectedIndex=0},I=Q=>{const he=Ol.find(ge=>ge.id===Q);if(!he)return;P(Q);const se=Ul(he.html,w,y);x(nc(se)),F.current&&u==="visual"&&(F.current.innerHTML=se)},H=()=>{const Q=parseInt(prompt("Enter number of rows","3")||"3",10),he=parseInt(prompt("Enter number of columns","3")||"3",10);if(isNaN(Q)||isNaN(he)||Q<1||he<1)return;let se='<table style="border-collapse: collapse; width: 100%; border: 1px solid #ccc;"><tbody>';for(let ge=0;ge<Q;ge++){se+="<tr>";for(let ee=0;ee<he;ee++)se+='<td style="border: 1px solid #ccc; padding: 8px;">Cell</td>';se+="</tr>"}se+="</tbody></table><p><br></p>",L(se)},h=()=>{const Q=lc(v)?v:Bn(v),he=window.open("","_blank");if(!he){alert("Could not open print window. Please disable your popup blocker.");return}he.document.write(Q),he.document.close(),he.focus(),he.print()},Y=()=>{let Q=v;if(lc(v))Q=Ul(Q,w,y);else{const de=Ol.find(U=>U.id===N);Q=de?Mx(de.html,v):Bn(v),Q=Ul(Q,w,y)}const he=(b.name||"template")+".html",se=new Blob([Q],{type:"text/html;charset=utf-8"}),ge=URL.createObjectURL(se),ee=document.createElement("a");ee.href=ge,ee.download=he,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(ge)},K=()=>{const Q=Ol.find(U=>U.id===N);if(!Q)return;const he=Ul(Q.html,w,y),se=Q.name.replace(/[^\w]+/g,"-").toLowerCase()+".html",ge=new Blob([he],{type:"text/html;charset=utf-8"}),ee=URL.createObjectURL(ge),de=document.createElement("a");de.href=ee,de.download=se,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(ee)},q=async Q=>{const he=await Q.text();if(!he)return;let se;if(lc(he))se=he;else{const ge=Ol.find(ee=>ee.id===N);se=ge?Mx(ge.html,he):Bn(he)}se=Ul(se,w,y),x(nc(se))},ne=l.useMemo(()=>{const Q=new Set([...ic(b.description),...ic(v),...r]);return Array.from(Q)},[b.description,v,r]),le=()=>{var de;if(!b.name.trim()){Z.warn("Please enter a template name.");return}const Q=u==="visual"?((de=F.current)==null?void 0:de.innerHTML)||"":v,he=b.description+Q,se=ic(he),ge=Array.from(new Set([...r,...se])),ee={...s,...b,content:Q,variables:ge,updated_at:new Date().toISOString(),id:(s==null?void 0:s.id)||Date.now(),created_by:(s==null?void 0:s.created_by)??M,updated_by:M};a(ee)},S=async Q=>{var ge;const he=(ge=Q.target.files)==null?void 0:ge[0];if(!he)return;const se=await Dx(he);$(se),Q.target.value=""},C=async Q=>{var ge;const he=(ge=Q.target.files)==null?void 0:ge[0];if(!he)return;const se=await Dx(he);k(se),Q.target.value=""},J=l.useMemo(()=>n.length?n.reduce((Q,he)=>{const se=he.category||"common";return(Q[se]=Q[se]||[]).push(he),Q},{}):{},[n]),ue=l.useMemo(()=>m==="all"?n:n.filter(Q=>Q.category===m),[n,m]);return e.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:[e.jsx("div",{style:{display:"none"},children:e.jsx(Mw,{onLoaded:o})}),e.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full flex flex-col ${f?"h-screen max-h-screen max-w-full rounded-none":"max-w-6xl max-h-[95vh]"}`,children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:s?"Edit Template":"Create New Template"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>p(!f),className:"p-2 rounded-full hover:bg-gray-100",title:f?"Exit Fullscreen":"Fullscreen",children:f?e.jsx(Wc,{size:20}):e.jsx(Vn,{size:20})}),e.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Close",children:e.jsx(ns,{size:20,className:"text-gray-600"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-2 space-y-6",children:[e.jsxs("fieldset",{className:"border rounded-md p-3 pt-0 space-y-3",children:[e.jsx("legend",{className:"text-xs font-medium text-gray-600 px-1",children:"Template Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Template Name"}),e.jsx("input",{type:"text",value:b.name,onChange:Q=>d({...b,name:Q.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"e.g., Sales Agreement",required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Status"}),e.jsxs("select",{value:b.status,onChange:Q=>d({...b,status:Q.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm bg-white",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Category"}),e.jsxs("select",{value:b.category,onChange:Q=>d({...b,category:Q.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm bg-white",children:[e.jsx("option",{value:"deal",children:"Deal"}),e.jsx("option",{value:"agency",children:"Agency"}),e.jsx("option",{value:"society",children:"Society"}),e.jsx("option",{value:"handover",children:"Handover"}),e.jsx("option",{value:"banking",children:"Banking"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{ref:R,value:b.description,onChange:Q=>d({...b,description:Q.target.value}),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 text-sm h-10 min-h-[40px] resize-y md:resize-none",placeholder:"Brief (e.g., {{buyer_name}} allowed)"})]}),e.jsxs("div",{role:"button",tabIndex:0,title:"Upload header company logo",onClick:()=>{var Q;return(Q=j.current)==null?void 0:Q.click()},onKeyDown:Q=>{var he;return(Q.key==="Enter"||Q.key===" ")&&((he=j.current)==null?void 0:he.click())},className:"group w-full max-w-sm px-2 py-1 rounded border border-gray-300 bg-white hover:bg-gray-50 cursor-pointer flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[11px] font-medium text-gray-800 group-hover:underline",children:"Header Company Logo"}),e.jsx("div",{className:"text-[10px] text-gray-500",children:w?"Click to change":"Click to choose"})]}),e.jsx("div",{className:"w-24 h-12 rounded border border-gray-200 bg-white overflow-hidden flex items-center justify-center",children:w?e.jsx("img",{src:w,alt:"Header logo preview",className:"max-w-full max-h-full object-contain"}):e.jsx(Vi,{className:"opacity-60",size:16})}),e.jsx("input",{ref:j,type:"file",accept:"image/*",onChange:S,className:"hidden","aria-label":"Upload header company logo"})]}),e.jsxs("div",{role:"button",tabIndex:0,title:"Upload footer company logo",onClick:()=>{var Q;return(Q=E.current)==null?void 0:Q.click()},onKeyDown:Q=>{var he;return(Q.key==="Enter"||Q.key===" ")&&((he=E.current)==null?void 0:he.click())},className:"group w-full max-w-sm px-2 py-1 rounded border border-gray-300 bg-white hover:bg-gray-50 cursor-pointer flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[11px] font-medium text-gray-800 group-hover:underline",children:"Footer Company Logo"}),e.jsx("div",{className:"text-[10px] text-gray-500",children:y?"Click to change":"Click to choose"})]}),e.jsx("div",{className:"w-24 h-12 rounded border border-gray-200 bg-white overflow-hidden flex items-center justify-center",children:y?e.jsx("img",{src:y,alt:"Footer logo preview",className:"max-w-full max-h-full object-contain"}):e.jsx(Vi,{className:"opacity-60",size:16})}),e.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:C,className:"hidden","aria-label":"Upload footer company logo"})]})]})]}),e.jsxs("fieldset",{className:"border rounded-md",children:[e.jsx("legend",{className:"text-sm font-medium text-gray-600 px-2",children:"Template Content"}),e.jsxs("div",{className:"rounded-lg",children:[e.jsxs("div",{className:"p-1 border-b border-gray-200 sticky top-[-15px] bg-gray-50 z-20 flex flex-wrap items-center gap-1 text-gray-700 shadow-sm",children:[e.jsx("select",{className:"px-2 py-1 text-xs border border-gray-300 rounded mr-2",value:N,onChange:Q=>I(Q.target.value),title:"Apply a Predefined Template",children:Ol.map(Q=>e.jsx("option",{value:Q.id,children:Q.name},Q.id))}),e.jsx("button",{onClick:K,title:"Download selected template",className:"p-2 rounded hover:bg-gray-200 flex items-center gap-1",children:e.jsx(ws,{size:16})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>{var Q;return(Q=T.current)==null?void 0:Q.click()},title:"Import HTML",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(dt,{size:16})}),e.jsx("input",{ref:T,type:"file",accept:".html,text/html",className:"hidden",onChange:Q=>{var se;const he=(se=Q.target.files)==null?void 0:se[0];he&&q(he),Q.currentTarget.value=""}}),e.jsx("button",{onClick:Y,title:"Export current editor content",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Ys,{size:16})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>A("bold"),title:"Bold",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Hc,{size:16})}),e.jsx("button",{onClick:()=>A("italic"),title:"Italic",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Yc,{size:16})}),e.jsx("button",{onClick:()=>A("underline"),title:"Underline",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Gc,{size:16})}),e.jsx("button",{onClick:()=>A("strikeThrough"),title:"Strikethrough",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Kc,{size:16})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("select",{onChange:Q=>A("fontName",Q.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded",title:"Font Family",children:Dw.map(Q=>e.jsx("option",{value:Q,children:Q.split(",")[0]},Q))}),e.jsx("select",{onChange:Q=>A("fontSize",Q.target.value),className:"px-2 py-1 text-xs border border-gray-300 rounded",defaultValue:"3",title:"Font Size",children:Lw.map(Q=>e.jsx("option",{value:Q.sizeCmd,children:Q.label},Q.label))}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>A("justifyLeft"),title:"Align Left",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Jc,{size:16})}),e.jsx("button",{onClick:()=>A("justifyCenter"),title:"Align Center",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Qc,{size:16})}),e.jsx("button",{onClick:()=>A("justifyRight"),title:"Align Right",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Zc,{size:16})}),e.jsx("button",{onClick:()=>A("justifyFull"),title:"Justify",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Xc,{size:16})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>A("insertUnorderedList"),title:"Bulleted List",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(dn,{size:16})}),e.jsx("button",{onClick:()=>A("insertOrderedList"),title:"Numbered List",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(ed,{size:16})}),e.jsx("button",{onClick:H,title:"Insert Table",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Hl,{size:16})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>A("undo"),title:"Undo",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(sd,{size:16})}),e.jsx("button",{onClick:()=>A("redo"),title:"Redo",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(td,{size:16})}),e.jsx("button",{onClick:h,title:"Print",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(ku,{size:16})}),e.jsx("button",{onClick:()=>c(Q=>Q==="visual"?"source":"visual"),title:"Toggle Source Code",className:`p-2 rounded hover:bg-gray-200 ${u==="source"?"bg-blue-100 text-blue-700":""}`,children:e.jsx(rn,{size:16})}),e.jsx("select",{onChange:Q=>g(Q.target.value),value:m,className:"text-xs px-2 py-1 border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500",title:"Filter by category",children:Rw.map(Q=>e.jsx("option",{value:Q,children:Q.charAt(0).toUpperCase()+Q.slice(1)},Q))}),e.jsxs("select",{onChange:D,className:"text-xs px-2 py-1 border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-blue-500",defaultValue:"","aria-label":"Insert a variable",title:"Insert variable into page",disabled:n.length===0,children:[e.jsx("option",{value:"",disabled:!0,children:n.length===0?"Loading...":"Insert variableâ€¦"}),m==="all"?Object.entries(J).sort(([Q],[he])=>Q.localeCompare(he)).map(([Q,he])=>e.jsx("optgroup",{label:Q.charAt(0).toUpperCase()+Q.slice(1),children:he.map(se=>e.jsx("option",{value:se.name,children:se.label},se.name))},Q)):ue.map(Q=>e.jsx("option",{value:Q.name,children:Q.label},Q.name))]}),e.jsxs("select",{className:"text-xs px-2 py-1 border border-gray-300 rounded-md bg-gray-100 text-gray-700",title:"Variables detected in this template",value:"",onChange:()=>{},children:[e.jsxs("option",{value:"",children:["Used variables (",ne.length,")"]}),ne.length===0?e.jsx("option",{value:"",disabled:!0,children:"None"}):ne.sort().map(Q=>{var he;return e.jsx("option",{value:Q,disabled:!0,children:((he=n.find(se=>se.name===Q))==null?void 0:he.label)||Q},Q)})]})]}),e.jsx("div",{className:"overflow-hidden",children:u==="visual"?e.jsx("div",{ref:F,contentEditable:!0,suppressContentEditableWarning:!0,onInput:Q=>x(Q.currentTarget.innerHTML),className:"min-h-[400px] p-4 text-gray-900 focus:outline-none prose max-w-none",style:{whiteSpace:"normal"}}):e.jsx("textarea",{value:v,onChange:Q=>x(Q.target.value),className:"w-full min-h-[400px] p-4 font-mono text-sm bg-gray-800 text-green-300 rounded-b-lg focus:outline-none resize-none",placeholder:""})})]})]})]}),e.jsx("div",{className:"flex-shrink-0 flex flex-wrap items-center justify-end gap-3 p-4 bg-gray-50 border-t border-gray-200 rounded-b-lg",children:e.jsxs("button",{onClick:le,disabled:!b.name.trim(),className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:s?"Save Changes":"Save Template"})]})})]})]})};function Rx(s){if(s==null)return"";try{return String(s).toLowerCase()}catch{return""}}function ki(s){const a=(s==null?void 0:s.data)??s??{};return{id:a.id,name:a.name??"",description:a.description??"",category:Rx(a.category??""),variables:Array.isArray(a.variables)?a.variables:[],lastUsed:a.lastUsed??a.last_used??"",usageCount:typeof a.usageCount=="number"?a.usageCount:typeof a.usage_count=="number"?a.usage_count:0,status:Rx(a.status??"draft"),content:a.content??"",created_at:a.created_at??"",updated_at:a.updated_at??"",created_by:a.created_by,updated_by:a.updated_by}}const Bw=({currentUserId:s})=>{const{user:a}=Hs(),t=(a==null?void 0:a.id)??s??null,[r,i]=l.useState(!1),[n,o]=l.useState(null),[m,g]=l.useState([]),[b,d]=l.useState(!0),v=()=>{i(!1),o(null)},x=()=>{const w=new Date;return{iso:w.toISOString(),date:w.toISOString().split("T")[0]}},u=async()=>{d(!0);try{const w=await pl.getAll(),y=(Array.isArray(w==null?void 0:w.data)?w.data:Array.isArray(w)?w:[]).map(ki);g(y)}catch(w){console.error("Error fetching templates:",w),g([])}finally{d(!1)}};l.useEffect(()=>{u()},[]);const c=()=>{o(null),i(!0)},f=w=>{o(w),i(!0)},p=async w=>{if(window.confirm("Are you sure you want to delete this template?"))try{await pl.delete(w),g($=>$.filter(y=>y.id!==w)),Z.success("Template deleted successfully!"),u()}catch($){console.error("Delete template failed:",$),Z.error("Failed to delete template!")}},N=async w=>{try{const{iso:$,date:y}=x(),k={...w,name:`${w.name} (Copy)`,usageCount:0,lastUsed:y,created_at:$,updated_at:$,created_by:t,updated_by:t};delete k.id;const R=await pl.create(k),F=ki(R);g(T=>[...T,F]),Z.success("Template duplicated successfully!"),u()}catch($){console.error("Duplicate template failed:",$),Z.error("Failed to duplicate template!")}},P=async w=>{const{iso:$,date:y}=x(),k={...w,updated_at:$,updated_by:t};try{if(n!=null&&n.id){const R=await pl.update(n.id,k),F=ki(R);g(T=>T.map(j=>j.id===n.id?F:j)),Z.success("Template updated successfully!"),await u()}else{const R={...k,created_at:$,lastUsed:k.lastUsed||y,created_by:t,variables:Array.isArray(k==null?void 0:k.variables)?k.variables:[]},F=await pl.create(R),T=ki(F);g(j=>[...j,T]),Z.success("Template saved successfully!"),await u()}v()}catch(R){console.error("Save template failed:",R),Z.error("Failed to save template!")}};return b?e.jsx("p",{children:"Loading templates..."}):e.jsx("div",{children:r?e.jsx(Fw,{template:n,onSave:P,onClose:v,currentUserId:t}):e.jsx(Ng,{mode:"manage",templates:m,onCreateTemplate:c,onEditTemplate:f,onDeleteTemplate:p,onDuplicateTemplate:N})})},oc={primary:"#E6761D",primaryHover:"#CC6A1A"},zx=({children:s,tone:a="gray"})=>{const t={gray:"bg-gray-100 text-gray-700 ring-1 ring-gray-200",violet:"bg-violet-50 text-violet-700 ring-1 ring-violet-200",orange:"bg-orange-100 text-orange-800 ring-1 ring-orange-200"};return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-medium ${t[a]}`,children:s})},Ow=()=>e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"h-4 w-40 bg-gray-200 rounded"}),e.jsx("div",{className:"h-5 w-16 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-3 w-24 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("div",{className:"h-6 w-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-14 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-9 w-full bg-gray-200 rounded"})]});function Uw(s){if(!s)return{};if(typeof s=="string")try{const a=JSON.parse(s);return a&&typeof a=="object"?a:{}}catch{return{}}return typeof s=="object"?s:{}}function qw(s){if(!s)return"â€”";const a=new Date(s);if(isNaN(a.getTime()))return"â€”";const r=new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"}).formatToParts(a),i={};for(const m of r)i[m.type]=m.value;const n=`${i.day}/${i.month}/${i.year}`,o=`${i.hour}:${i.minute}${i.dayPeriod?" "+i.dayPeriod.toUpperCase():""}`;return`${n} ${o}`}const Vw=({onContinue:s})=>{const[a,t]=Ps.useState([]),[r,i]=Ps.useState(!1),[n,o]=Ps.useState(null),m=Ps.useCallback(x=>{const u=(x==null?void 0:x.updated_at)||(x==null?void 0:x.created_at)||(x==null?void 0:x.last_used_at)||new Date().toISOString();return{id:String(x.id),title:x.name||"Untitled Draft",templateId:x.template_id??null,templateName:x.category||x.template_name||x.template_id||"-",savedAt:u,status:x.status??"draft",content:x.content??null,data:Uw(x.variables),created_at:x==null?void 0:x.created_at,updated_at:x==null?void 0:x.updated_at,created_by_name:(x==null?void 0:x.created_by_name)||"",updated_by_name:(x==null?void 0:x.updated_by_name)||""}},[]),g=Ps.useCallback(async()=>{var x;try{i(!0),o(null);const u=await((x=ot.getAll)==null?void 0:x.call(ot)),f=((Array.isArray(u==null?void 0:u.data)?u.data:Array.isArray(u)?u:[])||[]).filter(p=>String((p==null?void 0:p.status)??"draft").toLowerCase()==="draft").map(m).sort((p,N)=>new Date(N.savedAt).getTime()-new Date(p.savedAt).getTime());t(f)}catch(u){o((u==null?void 0:u.message)||"Failed to load drafts"),t([])}finally{i(!1)}},[m]);Ps.useEffect(()=>{g()},[g]);const b=async x=>{if(window.confirm("Delete this draft? This cannot be undone."))try{if(i(!0),ot.softDelete)await ot.softDelete(x);else if(ot.remove)await ot.remove(x);else if(ot.delete)await ot.delete(x);else throw new Error("Delete method not found on documentsGeneratedAPI");await g()}catch(u){o((u==null?void 0:u.message)||"Failed to delete draft")}finally{i(!1)}},d="/dashboard/document-center/create",v=x=>{var p,N;const u=((p=x.data)==null?void 0:p.__editor_state)||{},c=(N=x.data)!=null&&N.__form_snapshot&&Object.keys(x.data.__form_snapshot).length?x.data.__form_snapshot:x.data||{};Ec({draftId:x.id,templateId:x.templateId??null,title:x.title??"Untitled Draft",initialVariables:c,editorState:u,source:"server-draft"}),s==null||s(x);const f=`${d}?resume=1&draftId=${x.id}&templateId=${x.templateId??""}`;window.location.assign(f)};return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Draft Documents"}),e.jsxs("button",{onClick:g,className:"inline-flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-medium ring-1 ring-gray-200 hover:bg-gray-50",children:[e.jsx(na,{size:14}),r?"Refreshingâ€¦":"Refresh"]})]}),n&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:n}),r&&a.length===0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:Array.from({length:6}).map((x,u)=>e.jsx(Ow,{},u))}),!r&&a.length===0&&!n&&e.jsxs("div",{className:"rounded-2xl border border-dashed border-gray-300 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-gray-100",children:e.jsx(ws,{className:"text-gray-400",size:22})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"No drafts found"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Start creating a document and save it as a draft to see it here."})]}),!r&&a.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:a.map(x=>{const u=x.data||{},c=[];u.seller_name&&c.push(`Seller: ${u.seller_name}`),u.buyer_name&&c.push(`Buyer: ${u.buyer_name}`),u.property_address&&c.push(`Address: ${u.property_address}`);const f=qw(x.savedAt),p=(x.created_by_name||"").trim(),N=(x.updated_by_name||"").trim();return e.jsxs("div",{className:"group relative rounded-2xl border border-gray-200 bg-white p-5 shadow-sm hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-xl ring-1 ring-gray-200 bg-orange-50 flex items-center justify-center",children:e.jsx(ws,{size:16,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900 leading-5",children:x.title||"Untitled Draft"}),e.jsxs("div",{className:"mt-1 text-[11px] text-gray-500",children:["Template: ",x.templateName||"-"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zx,{tone:"orange",children:"draft"}),e.jsx(zx,{tone:"violet",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(_h,{size:12})," server"]})})]})]}),c.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-1.5",children:c.map(P=>e.jsx("span",{className:"rounded-full bg-gray-100 text-gray-700 ring-1 ring-gray-200 px-2 py-0.5 text-[11px]",children:P},P))}),e.jsxs("div",{className:"mt-3 text-[11px] text-gray-600 space-y-0.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Saved: "}),e.jsx("span",{className:"font-medium text-gray-700",children:f})]}),(p||N)&&e.jsxs("div",{className:"text-gray-500",children:[p&&e.jsxs(e.Fragment,{children:["Created by: ",e.jsx("span",{className:"text-gray-700",children:p}),N&&" Â· "]}),N&&e.jsxs(e.Fragment,{children:["Updated by: ",e.jsx("span",{className:"text-gray-700",children:N})]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>v(x),className:"inline-flex items-center justify-center gap-2 rounded-xl px-3 py-2 text-xs font-semibold text-white",style:{background:oc.primary},onMouseOver:P=>P.currentTarget.style.background=oc.primaryHover,onMouseOut:P=>P.currentTarget.style.background=oc.primary,title:"Open this draft in the editor from exactly where you left off",children:[e.jsx($l,{size:14}),"Continue"]}),e.jsxs("button",{onClick:()=>b(String(x.id)),className:"inline-flex items-center justify-center gap-2 rounded-xl px-3 py-2 text-xs font-semibold text-red-600 hover:bg-red-50",title:"Delete draft",children:[e.jsx(Es,{size:14}),"Delete"]})]})]},x.id)})})]})},Fx=({children:s,tone:a="gray"})=>{const t={gray:"bg-gray-100 text-gray-700 ring-gray-200",green:"bg-emerald-100 text-emerald-700 ring-emerald-200",blue:"bg-blue-100 text-blue-700 ring-blue-200"};return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-medium ring-1 ${t[a]}`,children:s})};function Ww(s){try{const a=typeof s=="string"?JSON.parse(s):s;if(a&&typeof a=="object")return a}catch{}return{}}const Hw=()=>e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"h-4 w-40 bg-gray-200 rounded"}),e.jsx("div",{className:"h-5 w-14 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-3 w-24 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-20 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-9 w-full bg-gray-200 rounded"})]});function Yw(s,a="document.pdf"){if(!s)return a;try{const t=s.match(/filename="([^"]+)"/i);if(t!=null&&t[1])return t[1];const r=s.match(/filename\*\s*=\s*[^']*''([^;]+)/i);if(r!=null&&r[1])return decodeURIComponent(r[1])}catch{}return a}function Bx(s){if(!s)return"â€”";const a=new Date(s);if(isNaN(a.getTime()))return"â€”";const r=new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"}).formatToParts(a),i={};for(const m of r)i[m.type]=m.value;const n=`${i.day}/${i.month}/${i.year}`,o=`${i.hour}:${i.minute}${i.dayPeriod?" "+i.dayPeriod.toUpperCase():""}`;return`${n} ${o}`}const Gw=()=>{const[s,a]=Ps.useState(!1),[t,r]=Ps.useState([]),[i,n]=Ps.useState(null),[o,m]=Ps.useState(""),[g,b]=Ps.useState("all"),[d,v]=Ps.useState("recent"),[x,u]=Ps.useState("a4"),c=k=>Array.isArray(k)?k:Array.isArray(k==null?void 0:k.data)?k.data:Array.isArray(k==null?void 0:k.items)?k.items:[],f=Ps.useCallback(async()=>{if(typeof ot.getAll=="function"){const R=await ot.getAll();return c(R)}const k=await ot.getAll({});return c(k)},[]),p=Ps.useCallback(async()=>{a(!0),n(null);try{const R=(await f()).filter(F=>(F==null?void 0:F.status)==="created"&&((F==null?void 0:F.is_deleted)===0||(F==null?void 0:F.is_deleted)==null)).sort((F,T)=>{const j=new Date(F.updated_at||F.created_at||0).getTime();return new Date(T.updated_at||T.created_at||0).getTime()-j});r(R)}catch(k){n((k==null?void 0:k.message)||"Failed to load created documents")}finally{a(!1)}},[f]);Ps.useEffect(()=>{p()},[p]);const N=async k=>{if(window.confirm("Delete this document? This cannot be undone."))try{if(typeof ot.remove=="function")await ot.remove(k);else if(typeof ot.delete=="function")await ot.delete(k);else if(typeof ot.softDelete=="function")await ot.softDelete(k);else throw new Error("Delete method not found on documentsGeneratedAPI");await p()}catch(R){alert((R==null?void 0:R.message)||"Failed to delete")}},P=async k=>{try{if(!(typeof ot.getPdfUrl=="function"))throw new Error("getPdfUrl not available in documentsGeneratedAPI");const F=ot.getPdfUrl(k.id,x);if(typeof ot.fetchPdfBlob=="function"){const{blob:M,filename:A}=await ot.fetchPdfBlob(k.id,x),L=document.createElement("a"),D=URL.createObjectURL(M);L.href=D,L.download=A||`${(k.name||"document").replace(/\s+/g,"_")}.pdf`,L.click(),URL.revokeObjectURL(D);return}const T=await fetch(F,{method:"GET"});if(!T.ok)throw new Error(`Download failed (${T.status})`);const j=T.headers.get("Content-Disposition"),E=Yw(j,`${(k.name||"document").replace(/\s+/g,"_")}.pdf`),V=await T.blob(),W=URL.createObjectURL(V),B=document.createElement("a");B.href=W,B.download=E,B.click(),URL.revokeObjectURL(W)}catch(R){alert((R==null?void 0:R.message)||"Failed to download PDF")}},w=async k=>{try{await navigator.clipboard.writeText(k||"")}catch{}},$=Ps.useMemo(()=>{const k=new Set;return t.forEach(R=>R.category&&k.add(R.category)),["all",...Array.from(k).sort((R,F)=>R.localeCompare(F))]},[t]),y=Ps.useMemo(()=>{const k=o.trim().toLowerCase(),R=j=>g!=="all"&&(j.category||"").toLowerCase()!==g.toLowerCase()?!1:k?[j.name,j.description||"",j.category||"",j.template_id?String(j.template_id):""].join(" ").toLowerCase().includes(k):!0,F=t.filter(R),T=j=>new Date(j.updated_at||j.created_at||0).getTime();switch(d){case"recent":return F.sort((j,E)=>T(E)-T(j));case"oldest":return F.sort((j,E)=>T(j)-T(E));case"name_az":return F.sort((j,E)=>(j.name||"").localeCompare(E.name||""));case"name_za":return F.sort((j,E)=>(E.name||"").localeCompare(j.name||""));default:return F}},[t,o,g,d]);return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Created Documents"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Final snapshots you generated"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:p,className:"inline-flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-medium ring-1 ring-gray-200 hover:bg-gray-50",children:[e.jsx(na,{size:14}),"Refresh"]})})]}),e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-3 sm:p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(it,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:o,onChange:k=>m(k.target.value),placeholder:"Search by name, descriptionâ€¦",className:"w-full pl-9 pr-9 py-2 text-sm rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-orange-200"}),o&&e.jsx("button",{onClick:()=>m(""),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-gray-100",title:"Clear",children:e.jsx(ns,{size:14,className:"text-gray-500"})})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:g,onChange:k=>b(k.target.value),className:"w-full appearance-none pl-3 pr-8 py-2 text-sm rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-orange-200 bg-white",children:$.map(k=>e.jsx("option",{value:k,children:k==="all"?"All categories":k},k))}),e.jsx(ea,{size:16,className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:d,onChange:k=>v(k.target.value),className:"w-full appearance-none pl-3 pr-8 py-2 text-sm rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-orange-200 bg-white",children:[e.jsx("option",{value:"recent",children:"Sort: Recently updated"}),e.jsx("option",{value:"oldest",children:"Sort: Oldest first"}),e.jsx("option",{value:"name_az",children:"Sort: Name Aâ†’Z"}),e.jsx("option",{value:"name_za",children:"Sort: Name Zâ†’A"})]}),e.jsx(ea,{size:16,className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:x,onChange:k=>u(k.target.value),className:"w-full appearance-none pl-3 pr-8 py-2 text-sm rounded-xl border border-gray-200 outline-none focus:ring-2 focus:ring-orange-200 bg-white",title:"PDF page size",children:[e.jsx("option",{value:"a4",children:"Page: A4"}),e.jsx("option",{value:"legal",children:"Page: Legal"})]}),e.jsx(ea,{size:16,className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"})]})})]}),e.jsxs("div",{className:"mt-3 text-xs text-gray-600",children:["Showing ",e.jsx("span",{className:"font-semibold text-gray-800",children:y.length})," of"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:t.length})," documents",g!=="all"?e.jsxs(e.Fragment,{children:[" ","in category ",e.jsx("span",{className:"font-semibold text-gray-800",children:g})]}):null,o?e.jsxs(e.Fragment,{children:[" ",'for search "',e.jsx("span",{className:"font-semibold text-gray-800",children:o}),'"']}):null]})]}),i&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:i}),s&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:Array.from({length:6}).map((k,R)=>e.jsx(Hw,{},R))}),!s&&!i&&y.length===0&&e.jsxs("div",{className:"rounded-2xl border border-dashed border-gray-300 bg-white p-10 text-center",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-gray-100",children:e.jsx(ws,{className:"text-gray-400",size:22})}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"No documents match your filters"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Try clearing the search or changing filters."})]}),!s&&!i&&y.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:y.map(k=>{const R=Ww(k.variables),F=R.buyer_name||R.buyerName||R.buyer,T=R.seller_name||R.sellerName||R.seller,j=R.buyer_salutation||R.buyerSalutation||"",E=R.seller_salutation||R.sellerSalutation||"",V=`${j} ${F||""}`.trim(),W=`${E} ${T||""}`.trim(),B=R.property_title||R.propertyTitle||R.title,M=R.property_address||R.propertyAddress||R.address,A=Bx(k.created_at),L=Bx(k.updated_at),D=(k.created_by_name||"").trim();return e.jsxs("div",{className:"group relative rounded-2xl border border-gray-200 bg-white p-5 shadow-sm hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-xl ring-1 ring-gray-200 bg-blue-50 flex items-center justify-center flex-shrink-0",children:e.jsx(ws,{size:16,className:"text-blue-600"})}),e.jsx("div",{className:"text-sm font-semibold text-gray-900 leading-5",children:k.name||"Untitled"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[k.category?e.jsx(Fx,{tone:"blue",children:k.category}):null,e.jsx(Fx,{tone:"green",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx($l,{size:12})," created"]})})]})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity -mr-1 -mt-1",children:e.jsx("button",{onClick:()=>w(k.name),className:"p-2 rounded-lg hover:bg-gray-100",title:"Copy title",children:e.jsx(Xt,{size:14,className:"text-gray-500"})})})]}),(F||T||B||M)&&e.jsxs("div",{className:"mb-3 space-y-2 text-xs",children:[F&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ms,{size:12,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Buyer:"})," ",e.jsx("span",{className:"text-gray-900",children:V})]})]}),T&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ms,{size:12,className:"text-orange-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Seller:"})," ",e.jsx("span",{className:"text-gray-900",children:W})]})]}),(B||M)&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Qs,{size:12,className:"text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Property:"})," ",e.jsxs("span",{className:"text-gray-900",children:[B,B&&M&&" - ",M]})]})]})]}),e.jsxs("div",{className:"text-[11px] text-gray-600 space-y-1 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Created by:"})," ",e.jsx("span",{className:"font-medium text-gray-800",children:D||"â€”"}),k.created_at&&e.jsxs(e.Fragment,{children:[" Â· ",e.jsx("span",{className:"text-gray-500",children:"on"})," ",e.jsx("span",{className:"font-medium text-gray-800",children:A})]})]}),k.updated_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Updated:"})," ",e.jsx("span",{className:"font-medium text-gray-800",children:L})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>P(k),className:"inline-flex items-center justify-center gap-1.5 rounded-xl px-3 py-2 text-xs font-semibold ring-1 ring-gray-200 hover:bg-gray-50",title:"Download PDF",children:[e.jsx(Ys,{size:14}),"Download"]}),e.jsxs("button",{onClick:()=>N(k.id),className:"inline-flex items-center justify-center gap-1.5 rounded-xl px-3 py-2 text-xs font-semibold text-red-600 hover:bg-red-50",title:"Delete",children:[e.jsx(Es,{size:14}),"Delete"]})]})]},k.id)})})]})},Ox=()=>{const[s,a]=l.useState("documents"),[t,r]=l.useState(null),i=[{id:"documents",label:"Document Creation",icon:ws},{id:"templates",label:"Template Creation",icon:Is},{id:"drafts",label:"Draft Documents",icon:Sh},{id:"created",label:"Created Documents",icon:ws}],n=l.useCallback(o=>{r(o),a("documents"),window.dispatchEvent(new CustomEvent("resumeDraft",{detail:o}))},[]);return e.jsxs("div",{className:"p-6 pt-0",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-6 overflow-x-auto",children:i.map(o=>{const m=o.icon,g=s===o.id;return e.jsxs("button",{onClick:()=>a(o.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${g?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(m,{size:16}),e.jsx("span",{children:o.label})]},o.id)})})})}),e.jsxs("div",{children:[s==="documents"&&e.jsx($w,{}),s==="templates"&&e.jsx(Bw,{}),s==="drafts"&&e.jsx(Vw,{onContinue:n}),s==="created"&&e.jsx(Gw,{})]})]})},Kw=()=>{var i;const[s,a]=l.useState(()=>localStorage.getItem("activeTab")||"dashboard"),t=[{id:"dashboard",label:"Dashboard",component:jx},{id:"tracking",label:"Tracking",component:Sx},{id:"creation",label:"Creation",component:Ox}];(i=t.find(n=>n.id===s))==null||i.component;const r=()=>{a("tracking"),localStorage.setItem("activeTab","tracking")};return l.useEffect(()=>{localStorage.setItem("activeTab",s)},[s]),e.jsxs("div",{className:"h-full flex flex-col bg-gray-50 ",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Document Center"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Manage templates, track documents, and generate new files"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"px-2 py-0.5 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:"System Active"}),e.jsx("div",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:"Admin Access"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("nav",{className:"flex space-x-6",children:t.map(n=>e.jsx("button",{onClick:()=>a(n.id),className:`py-1 px-1 border-b-2 font-medium text-xs transition-colors ${s===n.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.label},n.id))})})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[s==="dashboard"&&e.jsx(jx,{onNavigateToTracking:r}),s==="tracking"&&e.jsx(Sx,{}),s==="creation"&&e.jsx(Ox,{})]})]})},Jw=({isOpen:s,onClose:a,item:t,type:r,onShare:i})=>{var y,k,R;const[n,o]=l.useState([]),[m,g]=l.useState(""),[b,d]=l.useState(!1);if(!s||!t)return null;const v=()=>r==="invoice"?t.total_amount||t.amount||0:t.amount||t.total_amount||0,x=()=>t.client_name||t.buyer_name||t.from_party||"N/A",u=()=>t.property_address||t.property||"N/A",c=()=>t.invoice_id||t.receipt_id||t.id||"N/A",f=()=>t.date||t.created_date||new Date().toLocaleDateString(),p=r==="invoice"?`Dear ${x()},

Please find attached your brokerage invoice ${c()} for the property transaction.

Amount: â‚¹${(y=v())==null?void 0:y.toLocaleString("en-IN")}
Property: ${u()}

Thank you for choosing ResaleExpert.

Best regards,
ResaleExpert Team`:`Dear ${x()},

This is to acknowledge the receipt of payment for ${c()}.

Amount: â‚¹${(k=v())==null?void 0:k.toLocaleString("en-IN")}
Date: ${f()}

Thank you.

Best regards,
ResaleExpert Team`,N=[{id:"whatsapp",label:"WhatsApp",icon:tt,color:"green"},{id:"email",label:"Email",icon:Ds,color:"blue"},{id:"sms",label:"SMS",icon:Cs,color:"purple"}],P=F=>{o(T=>T.includes(F)?T.filter(j=>j!==F):[...T,F])},w=async()=>{if(n.length===0){alert("Please select at least one sharing channel");return}d(!0);try{await new Promise(T=>setTimeout(T,2e3));const F={channels:n,message:m||p,timestamp:new Date().toISOString(),recipients:$()};i(F),a()}catch(F){console.error("Sharing failed:",F)}finally{d(!1)}},$=()=>{const F=[],T=t.client_phone||t.buyer_phone||t.phone,j=x();return T&&j!=="N/A"&&F.push({type:"client",contact:T,name:j}),t.seller_phone&&t.seller_name&&F.push({type:"seller",contact:t.seller_phone,name:t.seller_name}),t.to_party&&t.to_party_phone&&F.push({type:"recipient",contact:t.to_party_phone,name:t.to_party}),F};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Share ",r==="invoice"?"Invoice":"Receipt"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:c()})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Document Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Amount:"}),e.jsxs("span",{className:"font-semibold ml-2",children:["â‚¹",(R=v())==null?void 0:R.toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"}),e.jsx("span",{className:"font-semibold ml-2",children:f()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Client:"}),e.jsx("span",{className:"font-semibold ml-2",children:x()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Property:"}),e.jsx("span",{className:"font-semibold ml-2",children:u()})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Recipients"}),e.jsx("div",{className:"space-y-2",children:$().map((F,T)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:F.type==="client"?e.jsx(Ms,{size:16,className:"text-blue-600"}):e.jsx(Is,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:F.name}),e.jsx("p",{className:"text-sm text-gray-600",children:F.contact})]}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium capitalize",children:F.type})]},T))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Select Sharing Channels"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:N.map(F=>{const T=F.icon,j=n.includes(F.id);return e.jsx("button",{onClick:()=>P(F.id),className:`p-4 rounded-xl border-2 transition-all ${j?`border-${F.color}-500 bg-${F.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(T,{size:20,className:j?`text-${F.color}-600`:"text-gray-400"}),e.jsx("span",{className:`font-medium ${j?`text-${F.color}-900`:"text-gray-600"}`,children:F.label}),j&&e.jsx(_a,{size:16,className:`text-${F.color}-600`})]})},F.id)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Message"}),e.jsx("textarea",{value:m||p,onChange:F=>g(F.target.value),className:"w-full h-32 p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Enter your message..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["This message will be sent along with the ",r," document"]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[n.length," channel",n.length!==1?"s":""," selected"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:w,disabled:n.length===0||b,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{size:16,className:"animate-spin"}),e.jsx("span",{children:"Sharing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"Share Now"})]})})]})]})})]})})},Qw=({isOpen:s,onClose:a,item:t,type:r})=>{var g,b;if(!s||!t)return null;const i=[{id:1,action:"Created",timestamp:"2025-01-12T10:30:00Z",user:"Admin User",details:`${r==="invoice"?"Invoice":"Receipt"} created with ID ${t.invoice_id||t.receipt_id}`,status:"completed",icon:_a},{id:2,action:"Shared via WhatsApp",timestamp:"2025-01-12T11:15:00Z",user:"Admin User",details:`Sent to ${t.client_name} (+91 98765 43210)`,status:"completed",icon:tt,recipients:[{name:t.client_name,contact:"+91 98765 43210",status:"delivered"}]},{id:3,action:"Shared via Email",timestamp:"2025-01-12T11:16:00Z",user:"Admin User",details:`Sent to ${t.client_email||"client@email.com"}`,status:"completed",icon:Ds,recipients:[{name:t.client_name,contact:t.client_email||"client@email.com",status:"opened"}]},{id:4,action:"Viewed by Client",timestamp:"2025-01-12T14:22:00Z",user:t.client_name,details:"Document opened and viewed",status:"completed",icon:ks},{id:5,action:"Payment Received",timestamp:r==="invoice"?"2025-01-12T16:45:00Z":null,user:"System",details:r==="invoice"?"Payment confirmed and invoice marked as paid":null,status:r==="invoice"?"completed":"pending",icon:_a}].filter(d=>d.details),n=d=>{switch(d){case"completed":return e.jsx(_a,{className:"text-green-500",size:16});case"pending":return e.jsx(Ls,{className:"text-orange-500",size:16});case"failed":return e.jsx(ct,{className:"text-red-500",size:16});default:return e.jsx(Ls,{className:"text-gray-400",size:16})}},o=d=>{const v={delivered:{bg:"bg-green-100",text:"text-green-800",label:"Delivered"},opened:{bg:"bg-blue-100",text:"text-blue-800",label:"Opened"},pending:{bg:"bg-orange-100",text:"text-orange-800",label:"Pending"},failed:{bg:"bg-red-100",text:"text-red-800",label:"Failed"}},x=v[d]||v.pending;return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x.bg} ${x.text}`,children:x.label})},m=d=>new Date(d).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Tracking History"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.invoice_id||t.receipt_id," - ",t.client_name]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Document Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Amount:"}),e.jsxs("span",{className:"font-semibold ml-2",children:["â‚¹",(g=t.total_amount||t.amount)==null?void 0:g.toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("span",{className:"ml-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="paid"?"bg-green-100 text-green-800":t.status==="sent"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:t.status==="paid"?"Paid":t.status==="sent"?"Sent":"Pending"})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Activity Timeline"}),i.map((d,v)=>{const x=d.icon;return e.jsxs("div",{className:"relative",children:[v<i.length-1&&e.jsx("div",{className:"absolute left-6 top-12 w-0.5 h-16 bg-gray-200"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-full ${d.status==="completed"?"bg-green-100":d.status==="pending"?"bg-orange-100":"bg-red-100"}`,children:e.jsx(x,{className:d.status==="completed"?"text-green-600":d.status==="pending"?"text-orange-600":"text-red-600",size:20})}),e.jsxs("div",{className:"flex-1 bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:d.action}),e.jsxs("div",{className:"flex items-center space-x-2",children:[n(d.status),e.jsx("span",{className:"text-sm text-gray-500",children:m(d.timestamp)})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:d.details}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["by ",d.user]}),d.recipients&&e.jsx("div",{className:"flex items-center space-x-2",children:d.recipients.map((u,c)=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:u.contact}),o(u.status)]},c))})]})]})]})]},d.id)})]}),e.jsxs("div",{className:"mt-8 bg-blue-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Sharing Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"3"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Times Shared"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"2"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Channels Used"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"1"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Times Viewed"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",m((b=i[0])==null?void 0:b.timestamp)]}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})})]})})},Zw=({isOpen:s,onClose:a,document:t,onSave:r,userRole:i})=>{const[n,o]=l.useState({...t,client_name:(t==null?void 0:t.client_name)||"",client_phone:(t==null?void 0:t.client_phone)||"",client_email:(t==null?void 0:t.client_email)||"",property_address:(t==null?void 0:t.property_address)||"",amount:(t==null?void 0:t.amount)||(t==null?void 0:t.total_amount)||0,brokerage_amount:(t==null?void 0:t.brokerage_amount)||0,gst_amount:(t==null?void 0:t.gst_amount)||0,total_amount:(t==null?void 0:t.total_amount)||0,date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],status:(t==null?void 0:t.status)||"pending",notes:(t==null?void 0:t.notes)||""}),[m,g]=l.useState(""),[b,d]=l.useState(!1);if(!s||!t)return null;const v=(c,f)=>{o(p=>{const N={...p,[c]:f};if(c==="brokerage_amount"&&t.type==="invoice"){const P=parseFloat(f)||0,w=P*.18,$=P+w;N.gst_amount=w,N.total_amount=$,N.amount=$}return N})},x=async()=>{if(i==="manager"&&!m.trim()){alert("Please provide a reason for editing this document");return}d(!0);try{const c={...n,edit_reason:m,edited_by:i==="admin"?"Admin User":"Manager User",edited_at:new Date().toISOString(),requires_approval:i==="manager"};await r(c),a()}catch(c){console.error("Error updating document:",c)}finally{d(!1)}},u=c=>{switch(c){case"invoice":return"Brokerage Invoice";case"brokerage_receipt":return"Brokerage Receipt";case"payment_receipt":return"Payment Receipt";default:return"Document"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Edit ",u(t.type)]}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.invoice_id||t.receipt_id})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[i==="manager"&&e.jsx("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ct,{className:"text-orange-600",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-orange-800",children:"Manager Edit Request"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Your changes will be sent to admin for approval before being applied."})]})]})}),i==="manager"&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for Edit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:m,onChange:c=>g(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Please explain why this document needs to be edited...",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Client Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),e.jsx("input",{type:"text",value:n.client_name,onChange:c=>v("client_name",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:n.client_phone,onChange:c=>v("client_phone",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:n.client_email,onChange:c=>v("client_email",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:n.date,onChange:c=>v("date",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Information"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Address"}),e.jsx("textarea",{value:n.property_address,onChange:c=>v("property_address",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:20}),"Financial Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.type==="invoice"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brokerage Amount (â‚¹)"}),e.jsx("input",{type:"number",value:n.brokerage_amount,onChange:c=>v("brokerage_amount",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GST Amount (â‚¹)"}),e.jsx("input",{type:"number",value:n.gst_amount,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount (â‚¹)"}),e.jsx("input",{type:"number",value:n.total_amount,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (â‚¹)"}),e.jsx("input",{type:"number",value:n.amount,onChange:c=>v("amount",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:n.status,onChange:c=>v("status",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes,onChange:c=>v("notes",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes or comments..."})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="manager"?"Changes will require admin approval":"Changes will be applied immediately"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:x,disabled:b||i==="manager"&&!m.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:b?"Saving...":i==="manager"?"Send for Approval":"Save Changes"})]})]})]})})]})})},Xw=({isOpen:s,onClose:a,document:t,onSubmit:r,userRole:i})=>{var c;const[n,o]=l.useState(""),[m,g]=l.useState(""),[b,d]=l.useState(!1);if(!s||!t)return null;const v=["Wrong client details entered","Incorrect amount or calculations","Duplicate entry created by mistake","Property details are incorrect","Document created for wrong transaction","Client requested cancellation","Data entry error","Other (specify below)"],x=async()=>{const f=m==="Other (specify below)"?n:m;if(!f.trim()){alert("Please select or provide a reason for deletion");return}d(!0);try{const p={document_id:t.id,document_type:t.type,reason:f,requested_by:i==="admin"?"Admin User":"Manager User",requested_at:new Date().toISOString(),requires_approval:i==="manager",status:i==="admin"?"approved":"pending"};await r(p),a()}catch(p){console.error("Error submitting delete request:",p)}finally{d(!1)}},u=f=>{switch(f){case"invoice":return"Brokerage Invoice";case"brokerage_receipt":return"Brokerage Receipt";case"payment_receipt":return"Payment Receipt";default:return"Document"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-red-50 to-orange-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(Es,{className:"text-red-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:i==="admin"?"Delete Document":"Request Document Deletion"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.invoice_id||t.receipt_id})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Xa,{className:"text-red-600 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-800",children:i==="admin"?"Permanent Deletion Warning":"Deletion Request Warning"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:i==="admin"?"This action cannot be undone. The document and all its associated data will be permanently deleted.":"This will send a deletion request to the admin. The document will remain until approved."})]})]})}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(ws,{className:"mr-2",size:16}),"Document to be Deleted"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Type:"}),e.jsx("span",{className:"font-semibold ml-2",children:u(t.type)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"ID:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.invoice_id||t.receipt_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Client:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.client_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Amount:"}),e.jsxs("span",{className:"font-semibold ml-2",children:["â‚¹",(c=t.total_amount||t.amount)==null?void 0:c.toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.date})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${t.status==="paid"?"bg-green-100 text-green-800":t.status==="sent"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:t.status==="paid"?"Paid":t.status==="sent"?"Sent":"Pending"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Reason for Deletion ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"space-y-2",children:v.map((f,p)=>e.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"deleteReason",value:f,checked:m===f,onChange:N=>g(N.target.value),className:"text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:f})]},p))})]}),m==="Other (specify below)"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Please specify the reason"}),e.jsx("textarea",{value:n,onChange:f=>o(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:3,placeholder:"Please provide detailed reason for deletion...",required:!0})]}),i==="manager"&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Request Process"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Your deletion request will be sent to the admin"}),e.jsx("li",{children:"â€¢ The document will remain active until approved"}),e.jsx("li",{children:"â€¢ You will be notified of the admin's decision"}),e.jsx("li",{children:"â€¢ Admin can approve or reject the deletion request"})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="admin"?"Document will be deleted immediately":"Request will be sent to admin for approval"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:x,disabled:b||!m||m==="Other (specify below)"&&!n.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Es,{size:16}),e.jsx("span",{children:b?"Processing...":i==="admin"?"Delete Document":"Send Delete Request"})]})]})]})})]})})},e1=({isOpen:s,onClose:a,invoice:t,onSave:r,userRole:i})=>{const[n,o]=l.useState([]),[m,g]=l.useState([]),[b,d]=l.useState([]),[v,x]=l.useState(!0),{user:u}=Hs(),[c,f]=l.useState({invoice_id:"",seller_id:"",seller_name:"",seller_phone:"",seller_email:"",buyer_id:"",buyer_name:"",buyer_phone:"",buyer_email:"",property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0,brokerage_percentage:2,brokerage_amount:0,gst_applicable:!0,gst_percentage:18,gst_amount:0,total_amount:0,amount_in_words:"",date:new Date().toISOString().split("T")[0],due_date:"",payment_details:{bank_name:"HDFC Bank",account_number:"50100123456789",ifsc_code:"HDFC0001234",account_holder:"ResaleExpert Pvt Ltd"},related_party:"seller",notes:"",created_by:"",updated_by:""}),[p,N]=l.useState(!1),P=l.useRef(!1),w=l.useRef(!1),$=E=>{const V=Math.round(E);if(V===0)return"Zero Only";const W=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],B=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],M=K=>{if(K<20)return W[K];const q=Math.floor(K/10),ne=K%10;return`${B[q]}${ne?" "+W[ne]:""}`.trim()},A=K=>{const q=Math.floor(K/100),ne=K%100;let le="";return q&&(le+=`${W[q]} Hundred`),ne&&(le+=`${le?" ":""}${M(ne)}`),le.trim()},L=[];let D=V;const I=Math.floor(D/1e7);D%=1e7;const H=Math.floor(D/1e5);D%=1e5;const h=Math.floor(D/1e3);D%=1e3;const Y=D;return I&&L.push(`${M(I)} Crore`),H&&L.push(`${M(H)} Lakh`),h&&L.push(`${M(h)} Thousand`),Y&&L.push(A(Y)),`${L.join(" ")} Only`.replace(/\s+/g," ").trim()},y=E=>f(V=>({...V,...E})),k=(E,V)=>{const W=V.trim(),B=String(E).includes("percentage")||String(E).includes("gst_percentage"),M=W===""?"0":W.replace(/^0+(?=\d)/,""),A=B?parseFloat(M):parseInt(M,10);y({[E]:isNaN(A)?0:A})};l.useEffect(()=>{if(!s||P.current)return;P.current=!0,(async()=>{x(!0);try{const[V,W]=await Promise.all([st.getAll(),Vt.getAll()]);o(Array.isArray(V)?V:[]),g(Array.isArray(W)?W:[])}catch(V){console.error("Error fetching data:",V)}finally{x(!1)}})()},[s]),l.useEffect(()=>{s||(P.current=!1)},[s]),l.useEffect(()=>{if(s)if(t){const E=t.property_details||{type:t.property_type||"",area:t.property_area||"",floor:t.property_floor||"",facing:t.property_facing||""},V=t.payment_details||{bank_name:t.payment_bank_name||"HDFC Bank",account_number:t.payment_account_number||"50100123456789",ifsc_code:t.payment_ifsc_code||"HDFC0001234",account_holder:t.payment_account_holder||"ResaleExpert Pvt Ltd"};f(W=>({...W,invoice_id:t.invoice_id||W.invoice_id||`INV-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`,seller_id:t.seller_id!=null?String(t.seller_id):"",seller_name:t.seller_name||"",seller_phone:t.seller_phone||"",seller_email:t.seller_email||"",buyer_id:t.buyer_id!=null?String(t.buyer_id):"",buyer_name:t.buyer_name||"",buyer_phone:t.buyer_phone||"",buyer_email:t.buyer_email||"",property_id:t.property_id!=null?String(t.property_id):"",property_address:t.property_address||"",property_details:{type:E.type||"",area:E.area||"",floor:E.floor||"",facing:E.facing||""},deal_value:Number(t.deal_value)||0,brokerage_percentage:Number(t.brokerage_percentage)||0,brokerage_amount:Number(t.brokerage_amount)||0,gst_applicable:typeof t.gst_applicable=="boolean"?t.gst_applicable:!0,gst_percentage:Number(t.gst_percentage)||0,gst_amount:Number(t.gst_amount)||0,total_amount:Number(t.total_amount)||0,amount_in_words:t.amount_in_words||"",date:t.date||new Date().toISOString().split("T")[0],due_date:t.due_date||"",payment_details:{bank_name:V.bank_name||"HDFC Bank",account_number:V.account_number||"50100123456789",ifsc_code:V.ifsc_code||"HDFC0001234",account_holder:V.account_holder||"ResaleExpert Pvt Ltd"},related_party:t.related_party||"seller",notes:t.notes||"",created_by:t.created_by??(u==null?void 0:u.id)??"",updated_by:(u==null?void 0:u.id)??t.updated_by??""}))}else{const E=`INV-${new Date().getFullYear()}-${String(Date.now()).slice(-6)}`;f(V=>({...V,invoice_id:E,created_by:(u==null?void 0:u.id)??"",updated_by:(u==null?void 0:u.id)??""}))}},[t,s,u==null?void 0:u.id]),l.useEffect(()=>{if(!c.seller_id||n.length===0){d([]);return}const E=n.find(V=>String(V.id)===String(c.seller_id));d(Array.isArray(E==null?void 0:E.properties)?E.properties:[])},[c.seller_id,n]),l.useEffect(()=>{const E=Number(c.deal_value)||0,V=Number(c.brokerage_percentage)||0,W=Number(c.gst_percentage)||0,B=Math.round(E*V/100),M=c.gst_applicable?Math.round(B*W/100):0,A=Math.round(B+M),L=$(A);(B!==c.brokerage_amount||M!==c.gst_amount||A!==c.total_amount||L!==c.amount_in_words)&&y({brokerage_amount:B,gst_amount:M,total_amount:A,amount_in_words:L})},[c.deal_value,c.brokerage_percentage,c.gst_applicable,c.gst_percentage]),l.useEffect(()=>{if(c.date&&!c.due_date){const E=new Date(c.date);E.setDate(E.getDate()+15);const V=E.toISOString().split("T")[0];V!==c.due_date&&y({due_date:V})}},[c.date,c.due_date]);const R=E=>{if(!E){y({seller_id:"",seller_name:"",seller_phone:"",seller_email:"",property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""}}),d([]);return}const V=n.find(W=>String(W.id)===String(E));if(V){const W=`${V.salutation||""} ${V.name||""}`.trim();y({seller_id:E,seller_name:W,seller_phone:V.phone||"",seller_email:V.email||"",property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""}}),d(Array.isArray(V.properties)?V.properties:[])}else y({seller_id:"",seller_name:"",seller_phone:"",seller_email:""}),d([])},F=E=>{if(!E){y({buyer_id:"",buyer_name:"",buyer_phone:"",buyer_email:""});return}const V=m.find(W=>String(W.id)===String(E));if(V){const W=`${V.salutation||""} ${V.name||""}`.trim();y({buyer_id:E,buyer_name:W,buyer_phone:V.phone||"",buyer_email:V.email||""})}else y({buyer_id:"",buyer_name:"",buyer_phone:"",buyer_email:""})},T=E=>{if(!E){y({property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0});return}const V=b.find(W=>String(W.id)===String(E));if(V){const W={type:V.type||V.property_type_name||"",area:V.area||V.carpet_area||"",floor:(V.floor??V.floor_number??"").toString(),facing:V.facing||V.direction||""};y({property_id:String(E),property_address:V.address||"",property_details:W,deal_value:Number(V.price??V.expected_price??V.deal_value??0)})}else y({property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""}})},j=async()=>{if(!w.current){if(!c.seller_name.trim()){alert("Please select a seller");return}if(!c.buyer_name.trim()){alert("Please select a buyer");return}if(!c.property_address.trim()){alert("Please select a property");return}if(!c.deal_value||c.deal_value<=0){alert("Please enter valid deal value");return}w.current=!0,N(!0);try{const E=new Date().toISOString(),V={invoice_id:c.invoice_id,type:"brokerage_invoice",seller_id:c.seller_id,seller_name:c.seller_name,seller_phone:c.seller_phone,seller_email:c.seller_email,buyer_id:c.buyer_id,buyer_name:c.buyer_name,buyer_phone:c.buyer_phone,buyer_email:c.buyer_email,property_id:c.property_id,property_address:c.property_address,property_details:{...c.property_details},deal_value:c.deal_value,brokerage_percentage:c.brokerage_percentage,brokerage_amount:c.brokerage_amount,gst_applicable:c.gst_applicable,gst_percentage:c.gst_percentage,gst_amount:c.gst_amount,total_amount:c.total_amount,amount_in_words:c.amount_in_words,date:c.date,due_date:c.due_date,payment_details:{...c.payment_details},related_party:c.related_party,notes:c.notes,created_at:(t==null?void 0:t.created_at)||E,updated_at:E,created_by:(t==null?void 0:t.created_by)??c.created_by,updated_by:(u==null?void 0:u.id)??c.updated_by,ledger_entries:(t==null?void 0:t.ledger_entries)||[{type:"debit",amount:c.total_amount,description:"Brokerage invoice raised",date:c.date,balance:c.total_amount}]};await r(V)}catch{}finally{N(!1),w.current=!1}}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"px-6 py-2 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(ws,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t?"Edit Brokerage Invoice":"Create Brokerage Invoice"}),e.jsx("p",{className:"text-gray-600 mt-1 text-xs",children:"Commission invoice with GST calculation"})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-gray-500",children:"Loading data..."})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ws,{className:"mr-2",size:20}),"Invoice Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice ID"}),e.jsx("input",{type:"text",value:c.invoice_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Party"}),e.jsxs("select",{value:c.related_party,onChange:E=>y({related_party:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"seller",children:"Seller"}),e.jsx("option",{value:"buyer",children:"Buyer"}),e.jsx("option",{value:"both",children:"Both Parties"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date"}),e.jsx("input",{type:"date",value:c.date,onChange:E=>y({date:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:c.due_date,onChange:E=>y({due_date:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Seller Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Seller ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:c.seller_id,onChange:E=>R(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"-- Select Seller --"}),n.length>0?n.map(E=>e.jsxs("option",{value:String(E.id),children:[E.salutation," ",E.name]},E.id)):e.jsx("option",{disabled:!0,children:"No sellers available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller ID"}),e.jsx("input",{type:"text",value:c.seller_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",readOnly:!0,placeholder:"Auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Phone"}),e.jsx("input",{type:"tel",value:c.seller_phone,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Email"}),e.jsx("input",{type:"email",value:c.seller_email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ns,{className:"mr-2",size:20}),"Buyer Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Buyer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:c.buyer_id,onChange:E=>F(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"-- Select Buyer --"}),m.length>0?m.map(E=>e.jsxs("option",{value:String(E.id),children:[E.salutation," ",E.name]},E.id)):e.jsx("option",{disabled:!0,children:"No buyers available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer ID"}),e.jsx("input",{type:"text",value:c.buyer_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",readOnly:!0,placeholder:"Auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Phone"}),e.jsx("input",{type:"tel",value:c.buyer_phone,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Email"}),e.jsx("input",{type:"email",value:c.buyer_email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Property ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:c.property_id,onChange:E=>T(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!c.seller_id||b.length===0,required:!0,children:[e.jsx("option",{value:"",children:c.seller_id?b.length===0?"-- No Properties Available --":"-- Select Property --":"-- Select Seller First --"}),b.map(E=>e.jsxs("option",{value:String(E.id),children:[E.address," (",E.type||E.property_type_name,")"]},String(E.id)))]}),c.seller_id&&b.length===0&&e.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"This seller has no properties attached"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property ID"}),e.jsx("input",{type:"text",value:c.property_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",readOnly:!0,placeholder:"Auto"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Address"}),e.jsx("textarea",{value:c.property_address,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",rows:2,readOnly:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsx("input",{type:"text",value:c.property_details.type,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area (Sq fit)"}),e.jsx("input",{type:"text",value:c.property_details.area,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Floor"}),e.jsx("input",{type:"text",value:c.property_details.floor,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Facing"}),e.jsx("input",{type:"text",value:c.property_details.facing,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(sr,{className:"mr-2",size:20}),"Financial Calculation"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deal Value (â‚¹) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:c.deal_value||"",onChange:E=>k("deal_value",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"25000000",min:"0",step:"1",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Brokerage Percentage (%) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:c.brokerage_percentage||"",onChange:E=>k("brokerage_percentage",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",step:"0.1",min:"0",max:"10",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brokerage Amount (â‚¹)"}),e.jsx("input",{type:"text",value:`â‚¹${c.brokerage_amount.toLocaleString("en-IN",{maximumFractionDigits:2})}`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-semibold",readOnly:!0})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:c.gst_applicable,onChange:E=>y({gst_applicable:E.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"GST Applicable"})]}),c.gst_applicable&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GST Percentage (%)"}),e.jsx("input",{type:"number",value:c.gst_percentage||"",onChange:E=>k("gst_percentage",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",step:"0.1",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"GST Amount (â‚¹)"}),e.jsx("input",{type:"text",value:`â‚¹${c.gst_amount.toLocaleString("en-IN",{maximumFractionDigits:2})}`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-semibold",readOnly:!0})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-5 border-2 border-blue-200",children:[e.jsx("label",{className:"block text-sm font-semibold text-blue-700 mb-2",children:"Total Invoice Amount"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-900 mb-2",children:["â‚¹",c.total_amount.toLocaleString("en-IN",{maximumFractionDigits:2})]}),e.jsx("div",{className:"text-sm text-blue-700 font-medium leading-relaxed",children:c.amount_in_words})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:20}),"Payment Details"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",value:c.payment_details.bank_name,onChange:E=>y({payment_details:{...c.payment_details,bank_name:E.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",value:c.payment_details.account_number,onChange:E=>y({payment_details:{...c.payment_details,account_number:E.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IFSC Code"}),e.jsx("input",{type:"text",value:c.payment_details.ifsc_code,onChange:E=>y({payment_details:{...c.payment_details,ifsc_code:E.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Holder Name"}),e.jsx("input",{type:"text",value:c.payment_details.account_holder,onChange:E=>y({payment_details:{...c.payment_details,account_holder:E.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:c.notes,onChange:E=>y({notes:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes or terms..."})]})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="manager"?"Invoice will require admin approval":"Invoice will be created immediately"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:j,disabled:p||!c.seller_name.trim()||!c.buyer_name.trim()||!c.property_address.trim()||!c.deal_value,className:"flex items-center space-x-2 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:p?"Saving...":t?"Update Invoice":"Create Invoice"})]})]})]})})]})}):null},s1=({isOpen:s,onClose:a,receipt:t,onSave:r,userRole:i})=>{const[n,o]=l.useState("brokerage_receipt"),[m,g]=l.useState({receipt_id:"",seller_name:"",seller_phone:"",seller_email:"",buyer_name:"",buyer_phone:"",buyer_email:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0,brokerage_percentage:2,payment_type:"Token Amount",amount:0,amount_in_words:"",receipt_date:new Date().toISOString().split("T")[0],payment_date:new Date().toISOString().split("T")[0],payment_method:"RTGS",payment_reference:"",transaction_details:{from_account:"",to_account:"",transaction_id:"",bank_charges:0},payment_details:{bank_name:"",account_number:"",ifsc_code:"",account_holder:""},related_party:"buyer_to_seller",notes:""}),[b,d]=l.useState(!1);l.useEffect(()=>{if(t)o(t.type),g({...t,receipt_date:t.receipt_date||new Date().toISOString().split("T")[0],payment_date:t.payment_date||new Date().toISOString().split("T")[0],property_details:t.property_details||{type:"",area:"",floor:"",facing:""},transaction_details:t.transaction_details||{from_account:"",to_account:"",transaction_id:"",bank_charges:0},payment_details:t.payment_details||{bank_name:"",account_number:"",ifsc_code:"",account_holder:""}});else{const N=`${n==="brokerage_receipt"?"BR":"PPR"}-${new Date().getFullYear()}-${String(Date.now()).slice(-3)}`;g(P=>({...P,receipt_id:N}))}},[t,n]),l.useEffect(()=>{if(n==="brokerage_receipt"&&m.deal_value&&m.brokerage_percentage){const p=m.deal_value*m.brokerage_percentage/100;g(N=>({...N,amount:p,amount_in_words:v(p)}))}},[m.deal_value,m.brokerage_percentage,n]),l.useEffect(()=>{m.amount&&n==="property_payment_receipt"&&g(p=>({...p,amount_in_words:v(m.amount)}))},[m.amount,n]);const v=p=>{const N=Math.floor(p/1e7),P=Math.floor(p%1e7/1e5),w=Math.floor(p%1e5/1e3),$=Math.floor(p%1e3/100),y=p%100;let k="";return N>0&&(k+=`${N} Crore `),P>0&&(k+=`${P} Lakh `),w>0&&(k+=`${w} Thousand `),$>0&&(k+=`${$} Hundred `),y>0&&(k+=`${y} `),k.trim()+" Only"},x=(p,N)=>{if(p.includes(".")){const[P,w]=p.split(".");g($=>({...$,[P]:{...$[P]||{},[w]:N}}))}else g(P=>({...P,[p]:N}))},u=async()=>{if(!m.seller_name.trim()){alert("Please enter seller name");return}if(!m.buyer_name.trim()){alert("Please enter buyer name");return}if(!m.property_address.trim()){alert("Please enter property address");return}if(!m.amount||m.amount<=0){alert("Please enter valid amount");return}if(!m.payment_reference.trim()){alert("Please enter payment reference");return}d(!0);try{const p={...m,type:n,status:"paid",payment_status:"paid",created_at:(t==null?void 0:t.created_at)||new Date().toISOString(),updated_at:new Date().toISOString(),ledger_entries:(t==null?void 0:t.ledger_entries)||[{type:"credit",amount:m.amount,description:n==="brokerage_receipt"?"Brokerage payment received":"Property payment received",date:m.payment_date,balance:m.amount}]};await r(p)}catch(p){console.error("Error saving receipt:",p)}finally{d(!1)}},c=["Token Amount","First Installment","Second Installment","Final Payment","Registration Amount","Stamp Duty","Other"],f=[{value:"RTGS",label:"RTGS",icon:Nr},{value:"NEFT",label:"NEFT",icon:Nr},{value:"IMPS",label:"IMPS",icon:Ui},{value:"UPI",label:"UPI",icon:Ui},{value:"Cheque",label:"Cheque",icon:en},{value:"Cash",label:"Cash",icon:cn},{value:"DD",label:"Demand Draft",icon:en}];return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-50 to-emerald-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Pa,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Receipt":"Create Receipt"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Brokerage Payment Receipt  acknowledgment with transaction details"})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Pa,{className:"mr-2",size:20}),"Receipt Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt ID"}),e.jsx("input",{type:"text",value:m.receipt_id,onChange:p=>x("receipt_id",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Party"}),e.jsxs("select",{value:m.related_party,onChange:p=>x("related_party",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"buyer",children:"From Buyer"}),e.jsx("option",{value:"seller",children:"From Seller"}),e.jsx("option",{value:"buyer_to_seller",children:"Buyer to Seller"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Date"}),e.jsx("input",{type:"date",value:m.receipt_date,onChange:p=>x("receipt_date",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date"}),e.jsx("input",{type:"date",value:m.payment_date,onChange:p=>x("payment_date",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Seller Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Seller Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:m.seller_name,onChange:p=>x("seller_name",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter seller name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Phone"}),e.jsx("input",{type:"tel",value:m.seller_phone,onChange:p=>x("seller_phone",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+91 98765 43210"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Email"}),e.jsx("input",{type:"email",value:m.seller_email,onChange:p=>x("seller_email",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"seller@email.com"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ns,{className:"mr-2",size:20}),"Buyer Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Buyer Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:m.buyer_name,onChange:p=>x("buyer_name",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter buyer name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Phone"}),e.jsx("input",{type:"tel",value:m.buyer_phone,onChange:p=>x("buyer_phone",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+91 98765 43210"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Email"}),e.jsx("input",{type:"email",value:m.buyer_email,onChange:p=>x("buyer_email",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"buyer@email.com"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Property Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:m.property_address,onChange:p=>x("property_address",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2,placeholder:"Enter complete property address",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsxs("select",{value:m.property_details.type,onChange:p=>x("property_details.type",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"Apartment",children:"Apartment"}),e.jsx("option",{value:"Villa",children:"Villa"}),e.jsx("option",{value:"Penthouse",children:"Penthouse"}),e.jsx("option",{value:"Commercial",children:"Commercial"}),e.jsx("option",{value:"Plot",children:"Plot"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area"}),e.jsx("input",{type:"text",value:m.property_details.area,onChange:p=>x("property_details.area",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 1250 sq ft"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:20}),"Payment Information"]}),e.jsxs("div",{className:"space-y-4",children:[n==="brokerage_receipt"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deal Value (â‚¹)"}),e.jsx("input",{type:"number",value:m.deal_value,onChange:p=>x("deal_value",Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"25000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brokerage Percentage (%)"}),e.jsx("input",{type:"number",value:m.brokerage_percentage,onChange:p=>x("brokerage_percentage",Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",step:"0.1",min:"0",max:"10"})]})]}),n==="property_payment_receipt"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),e.jsx("select",{value:m.payment_type,onChange:p=>x("payment_type",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:c.map(p=>e.jsx("option",{value:p,children:p},p))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount (â‚¹) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:m.amount,onChange:p=>x("amount",Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"500000",required:!0,readOnly:n==="brokerage_receipt"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-green-700 mb-1",children:"Amount in Words"}),e.jsx("div",{className:"text-sm text-green-800 font-medium",children:m.amount_in_words})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(en,{className:"mr-2",size:20}),"Transaction Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),e.jsx("select",{value:m.payment_method,onChange:p=>x("payment_method",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:f.map(p=>(p.icon,e.jsx("option",{value:p.value,children:p.label},p.value)))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Reference ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:m.payment_reference,onChange:p=>x("payment_reference",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"TXN123456789",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Account"}),e.jsx("input",{type:"text",value:m.transaction_details.from_account,onChange:p=>x("transaction_details.from_account",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Buyer Name - Bank Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Account"}),e.jsx("input",{type:"text",value:m.transaction_details.to_account,onChange:p=>x("transaction_details.to_account",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Seller Name - Bank Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction ID"}),e.jsx("input",{type:"text",value:m.transaction_details.transaction_id,onChange:p=>x("transaction_details.transaction_id",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Bank transaction ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Charges (â‚¹)"}),e.jsx("input",{type:"number",value:m.transaction_details.bank_charges,onChange:p=>x("transaction_details.bank_charges",Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"25"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Nr,{className:"mr-2",size:20}),"Bank Details"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",value:m.payment_details.bank_name,onChange:p=>x("payment_details.bank_name",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"HDFC Bank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",value:m.payment_details.account_number,onChange:p=>x("payment_details.account_number",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"50100123456789"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IFSC Code"}),e.jsx("input",{type:"text",value:m.payment_details.ifsc_code,onChange:p=>x("payment_details.ifsc_code",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"HDFC0001234"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Holder Name"}),e.jsx("input",{type:"text",value:m.payment_details.account_holder,onChange:p=>x("payment_details.account_holder",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Account holder name"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:m.notes,onChange:p=>x("notes",p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes or terms..."})]})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="manager"?"Receipt will require admin approval":"Receipt will be created immediately"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:u,disabled:b||!m.seller_name.trim()||!m.buyer_name.trim()||!m.property_address.trim()||!m.amount,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:b?"Saving...":t?"Update Receipt":"Create Receipt"})]})]})]})})]})}):null},t1=({isOpen:s,onClose:a,document:t})=>{var g,b,d,v;if(!s||!t)return null;const r=x=>`â‚¹${x.toLocaleString("en-IN")}`,i=x=>new Date(x).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}),n=x=>x==="credit"?e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Rs,{className:"text-green-600",size:16})}):e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(qc,{className:"text-red-600",size:16})}),o=x=>{switch(x){case"brokerage_invoice":return e.jsx(ws,{className:"text-purple-600",size:20});case"brokerage_receipt":return e.jsx(Pa,{className:"text-green-600",size:20});case"property_payment_receipt":return e.jsx(Ut,{className:"text-orange-600",size:20});default:return e.jsx(ws,{className:"text-gray-600",size:20})}},m=((g=t.ledger_entries)==null?void 0:g.reduce((x,u)=>u.type==="credit"?x+u.amount:x-u.amount,0))||0;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:o(t.type)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Ledger History"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.invoice_id||t.receipt_id," - Credit/Debit Tracking"]})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Document Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Document:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.invoice_id||t.receipt_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Client:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.client_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Amount:"}),e.jsx("span",{className:"font-semibold ml-2",children:r(t.total_amount||t.amount)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${t.payment_status==="paid"?"bg-green-100 text-green-800":t.payment_status==="pending"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:t.payment_status==="paid"?"Paid":t.payment_status==="pending"?"Pending":"Unknown"})]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Current Balance"}),e.jsx("div",{className:"text-3xl font-bold",children:r(Math.abs(m))}),e.jsx("div",{className:"text-blue-100 text-sm mt-1",children:m>0?"Amount Receivable":m<0?"Amount Payable":"Settled"})]}),e.jsx("div",{className:"p-3 bg-blue-400 rounded-lg",children:e.jsx(cn,{size:32})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Transaction History"}),t.ledger_entries&&t.ledger_entries.length>0?e.jsx("div",{className:"space-y-3",children:t.ledger_entries.map((x,u)=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[n(x.type),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:x.description}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center space-x-2",children:[e.jsx(Ts,{size:12}),e.jsx("span",{children:i(x.date)})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-lg font-bold ${x.type==="credit"?"text-green-600":"text-red-600"}`,children:[x.type==="credit"?"+":"-",r(x.amount)]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Balance: ",r(x.balance)]})]})]})},u))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ws,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Ledger Entries"}),e.jsx("p",{className:"text-gray-500",children:"No transaction history available for this document"})]})]}),e.jsxs("div",{className:"mt-8 bg-gray-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Transaction Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:((b=t.ledger_entries)==null?void 0:b.filter(x=>x.type==="debit").length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Debit Entries"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:((d=t.ledger_entries)==null?void 0:d.filter(x=>x.type==="credit").length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Credit Entries"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((v=t.ledger_entries)==null?void 0:v.length)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Transactions"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",i(t.updated_at||t.created_at)]}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})})]})})},a1=({isOpen:s,onClose:a,document:t,onApprove:r,userRole:i})=>{const[n,o]=l.useState(""),[m,g]=l.useState(""),[b,d]=l.useState(!1);if(!s||!t)return null;const v=async()=>{if(!n.trim()){alert("Please provide approval reason");return}d(!0);try{await r(!0)}finally{d(!1)}},x=async()=>{if(!m.trim()){alert("Please provide rejection reason");return}d(!0);try{await r(!1)}finally{d(!1)}},u=f=>{switch(f){case"brokerage_invoice":return"Brokerage Invoice";case"brokerage_receipt":return"Brokerage Receipt";case"property_payment_receipt":return"Property Payment Receipt";default:return"Document"}},c=f=>`â‚¹${f.toLocaleString("en-IN")}`;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-orange-50 to-red-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(at,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Document Approval"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[t.invoice_id||t.receipt_id," - Pending Admin Review"]})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(ws,{className:"mr-2",size:16}),"Document Summary"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Type:"}),e.jsx("span",{className:"font-semibold ml-2",children:u(t.type)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"ID:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.invoice_id||t.receipt_id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Created By:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.created_by})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Created Date:"}),e.jsx("span",{className:"font-semibold ml-2",children:new Date(t.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Seller:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.seller_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Buyer:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.buyer_name})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Property:"}),e.jsx("span",{className:"font-semibold ml-2",children:t.property_address})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:16}),"Financial Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.deal_value&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c(t.deal_value)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Deal Value"})]}),t.brokerage_percentage&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[t.brokerage_percentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Brokerage Rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c(t.total_amount||t.amount)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Amount"})]})]}),t.amount_in_words&&e.jsx("div",{className:"mt-3 text-center text-sm text-gray-600 font-medium",children:t.amount_in_words})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-semibold text-green-800 mb-3 flex items-center",children:[e.jsx(bs,{className:"mr-2",size:20}),"Approve Document"]}),e.jsx("textarea",{value:n,onChange:f=>o(f.target.value),className:"w-full px-3 py-2 border border-green-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",rows:3,placeholder:"Reason for approval (e.g., All details verified, amounts correct, documentation complete)"}),e.jsxs("button",{onClick:v,disabled:b||!n.trim(),className:"w-full mt-3 flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(bs,{size:16}),e.jsx("span",{children:b?"Processing...":"Approve Document"})]})]}),e.jsxs("div",{className:"bg-red-50 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-semibold text-red-800 mb-3 flex items-center",children:[e.jsx(Ta,{className:"mr-2",size:20}),"Reject Document"]}),e.jsx("textarea",{value:m,onChange:f=>g(f.target.value),className:"w-full px-3 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:3,placeholder:"Reason for rejection (e.g., Incorrect amounts, missing information, invalid data)"}),e.jsxs("button",{onClick:x,disabled:b||!m.trim(),className:"w-full mt-3 flex items-center justify-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ta,{size:16}),e.jsx("span",{children:b?"Processing...":"Reject Document"})]})]})]}),e.jsxs("div",{className:"mt-6 bg-yellow-50 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-semibold text-yellow-800 mb-3 flex items-center",children:[e.jsx(Xa,{className:"mr-2",size:20}),"Approval Guidelines"]}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-2",children:[e.jsx("li",{children:"â€¢ Verify all party details (seller, buyer) are correct"}),e.jsx("li",{children:"â€¢ Check property address and details for accuracy"}),e.jsx("li",{children:"â€¢ Validate financial calculations and amounts"}),e.jsx("li",{children:"â€¢ Ensure payment details and references are proper"}),e.jsx("li",{children:"â€¢ Confirm all required fields are filled"}),e.jsx("li",{children:"â€¢ Review notes and additional information"})]})]}),t.notes&&e.jsxs("div",{className:"mt-6 bg-blue-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Document Notes"}),e.jsx("p",{className:"text-sm text-blue-700",children:t.notes})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Review carefully before approving or rejecting"}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})]})})]})})},ql=s=>{if(!s)return"";const a=String(s);if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(a))return a;const t=new Date(a);if(isNaN(t.getTime()))return"";const r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),m=String(t.getMinutes()).padStart(2,"0");return`${r}-${i}-${n}T${o}:${m}`},cc=s=>{if(!s)return null;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(s)){const[g,b]=s.split("T");return`${g} ${b}:00`}const a=new Date(s);if(isNaN(a.getTime()))return null;const t=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),i=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),o=String(a.getMinutes()).padStart(2,"0"),m=String(a.getSeconds()).padStart(2,"0");return`${t}-${r}-${i} ${n}:${o}:${m}`},r1=({isOpen:s,onClose:a,receipt:t,onSave:r,userRole:i})=>{const[n,o]=l.useState([]),[m,g]=l.useState([]),[b,d]=l.useState([]),[v,x]=l.useState(!0),{user:u}=Hs(),c=l.useRef(!1),[f,p]=l.useState(!0),[N,P]=l.useState({});l.useEffect(()=>{(async()=>{try{p(!0);const Y=await Gt(["common"]);P(Y)}catch(Y){console.error("Error fetching master options:",Y),console.error("Failed to load dropdown options")}finally{p(!1)}})()},[]),l.useEffect(()=>{if(!s||c.current||v||f||!t)return;const h=t.property_details||{type:t.property_type||"",area:t.property_area||"",floor:t.property_floor||"",facing:t.property_facing||""};j(Y=>{var K,q,ne;return{...Y,receipt_id:t.receipt_id||Y.receipt_id||"",seller_id:t.seller_id!=null?String(t.seller_id):Y.seller_id,buyer_id:t.buyer_id!=null?String(t.buyer_id):Y.buyer_id,property_id:t.property_id!=null?String(t.property_id):Y.property_id,seller_name:t.seller_name||Y.seller_name,seller_phone:t.seller_phone||Y.seller_phone,seller_email:t.seller_email||Y.seller_email,buyer_name:t.buyer_name||Y.buyer_name,buyer_phone:t.buyer_phone||Y.buyer_phone,buyer_email:t.buyer_email||Y.buyer_email,property_address:t.property_address||Y.property_address,property_details:{type:h.type||"",area:h.area||"",floor:h.floor||"",facing:h.facing||""},deal_value:Number(t.deal_value)||Y.deal_value,payment_type:t.payment_type||Y.payment_type||"",amount:Number(t.amount)||Y.amount,amount_in_words:t.amount_in_words||Y.amount_in_words,receipt_date:ql(t.receipt_date)||Y.receipt_date,payment_date:ql(t.payment_date)||Y.payment_date,payment_reference:t.payment_reference||Y.payment_reference,transaction_details:{payment_method:((K=t.transaction_details)==null?void 0:K.payment_method)||Y.transaction_details.payment_method||"",buyer_bank_name:((q=t.transaction_details)==null?void 0:q.buyer_bank_name)||Y.transaction_details.buyer_bank_name||"",seller_bank_name:((ne=t.transaction_details)==null?void 0:ne.seller_bank_name)||Y.transaction_details.seller_bank_name||""},related_party:t.related_party||Y.related_party,notes:t.notes||Y.notes,created_by:(t==null?void 0:t.created_by)??(u==null?void 0:u.id)??Y.created_by,updated_by:(u==null?void 0:u.id)??(t==null?void 0:t.updated_by)??Y.updated_by,created_at:t.created_at||Y.created_at,updated_at:new Date().toISOString()}}),c.current=!0},[s,v,f,t,u==null?void 0:u.id]),l.useEffect(()=>{s||(c.current=!1)},[s]);const w=(N==null?void 0:N.banks)??[],$=(N==null?void 0:N["payment types"])??[],y=(N==null?void 0:N["payement methods"])||(N==null?void 0:N["payment methods"])||[],k=l.useMemo(()=>[...w].sort((h,Y)=>h.label.localeCompare(Y.label,void 0,{sensitivity:"base"})),[w]),R=l.useMemo(()=>[...$].sort((h,Y)=>h.label.localeCompare(Y.label,void 0,{sensitivity:"base"})),[$]),F=l.useMemo(()=>[...y].sort((h,Y)=>h.label.localeCompare(Y.label,void 0,{sensitivity:"base"})),[y]),[T,j]=l.useState({seller_id:"",buyer_id:"",property_id:"",receipt_id:"",seller_name:"",seller_phone:"",seller_email:"",buyer_name:"",buyer_phone:"",buyer_email:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0,brokerage_percentage:0,payment_type:"",amount:0,amount_in_words:"",receipt_date:ql(new Date),payment_date:ql(new Date),payment_reference:"",transaction_details:{payment_method:"",buyer_bank_name:"",seller_bank_name:""},related_party:"buyer_to_seller",notes:"",created_by:"",updated_by:"",created_at:"",updated_at:""}),[E,V]=l.useState(!1),W=l.useRef(!1),B=h=>j(Y=>({...Y,...h})),M=h=>{const Y=Math.floor(Math.abs(h));if(!Y)return"Zero Only";const K=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],q=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],ne=he=>he<20?K[he]:`${q[Math.floor(he/10)]}${he%10?" "+K[he%10]:""}`.trim(),le=he=>{const se=Math.floor(he/100),ge=he%100;return`${se?K[se]+" Hundred":""}${ge?(se?" ":"")+ne(ge):""}`.trim()};let S=Y;const C=Math.floor(S/1e7);S%=1e7;const J=Math.floor(S/1e5);S%=1e5;const ue=Math.floor(S/1e3);S%=1e3;const Q=[];return C&&Q.push(`${ne(C)} Crore`),J&&Q.push(`${ne(J)} Lakh`),ue&&Q.push(`${ne(ue)} Thousand`),S&&Q.push(le(S)),`${h<0?"Minus ":""}${Q.join(" ")} Only`.replace(/\s+/g," ").trim()},A=(h,Y)=>{if(h.includes(".")){const[K,q]=h.split(".");j(ne=>({...ne,[K]:{...ne[K],[q]:Y}}))}else B({[h]:Y})};l.useEffect(()=>{if(!s||W.current)return;W.current=!0,(async()=>{x(!0);try{const[Y,K]=await Promise.all([st.getAll(),Vt.getAll()]);o(Array.isArray(Y)?Y:[]),g(Array.isArray(K)?K:[])}catch(Y){console.error("Failed to fetch sellers/buyers",Y)}finally{x(!1)}})()},[s]),l.useEffect(()=>{s||(W.current=!1)},[s]),l.useEffect(()=>{if(s)if(t){const h=t.property_details||{type:t.property_type||"",area:t.property_area||"",floor:t.property_floor||"",facing:t.property_facing||""};j(Y=>{var K,q,ne;return{...Y,receipt_id:t.receipt_id||Y.receipt_id||"",seller_id:t.seller_id!=null?String(t.seller_id):Y.seller_id,buyer_id:t.buyer_id!=null?String(t.buyer_id):Y.buyer_id,property_id:t.property_id!=null?String(t.property_id):Y.property_id,seller_name:t.seller_name||Y.seller_name,seller_phone:t.seller_phone||Y.seller_phone,seller_email:t.seller_email||Y.seller_email,buyer_name:t.buyer_name||Y.buyer_name,buyer_phone:t.buyer_phone||Y.buyer_phone,buyer_email:t.buyer_email||Y.buyer_email,property_address:t.property_address||Y.property_address,property_details:{type:h.type||"",area:h.area||"",floor:h.floor||"",facing:h.facing||""},deal_value:Number(t.deal_value)||Y.deal_value,payment_type:t.payment_type||Y.payment_type||"",amount:Number(t.amount)||Y.amount,amount_in_words:t.amount_in_words||Y.amount_in_words,receipt_date:ql(t.receipt_date)||Y.receipt_date,payment_date:ql(t.payment_date)||Y.payment_date,payment_reference:t.payment_reference||Y.payment_reference,transaction_details:{payment_method:((K=t.transaction_details)==null?void 0:K.payment_method)||Y.transaction_details.payment_method||"",buyer_bank_name:((q=t.transaction_details)==null?void 0:q.buyer_bank_name)||Y.transaction_details.buyer_bank_name||"",seller_bank_name:((ne=t.transaction_details)==null?void 0:ne.seller_bank_name)||Y.transaction_details.seller_bank_name||""},related_party:t.related_party||Y.related_party,notes:t.notes||Y.notes,created_by:(t==null?void 0:t.created_by)??(u==null?void 0:u.id)??Y.created_by,updated_by:(u==null?void 0:u.id)??(t==null?void 0:t.updated_by)??Y.updated_by,created_at:t.created_at||Y.created_at,updated_at:new Date().toISOString()}})}else B({created_by:(u==null?void 0:u.id)??"",updated_by:(u==null?void 0:u.id)??"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()})},[t,s,u==null?void 0:u.id]),l.useEffect(()=>{if(!T.seller_id||n.length===0){d([]);return}const h=n.find(Y=>String(Y.id)===String(T.seller_id));d(Array.isArray(h==null?void 0:h.properties)?h.properties:[])},[T.seller_id,n]),l.useEffect(()=>{B({amount_in_words:T.amount?M(Number(T.amount)||0):""})},[T.amount]);const L=h=>{if(!h){B({seller_id:"",seller_name:"",seller_phone:"",seller_email:"",property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0}),d([]);return}const Y=n.find(K=>String(K.id)===String(h));if(Y){const K=`${Y.salutation||""} ${Y.name||""}`.trim();B({seller_id:h,seller_name:K,seller_phone:Y.phone||"",seller_email:Y.email||"",property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0}),d(Array.isArray(Y.properties)?Y.properties:[])}else B({seller_id:"",seller_name:"",seller_phone:"",seller_email:""}),d([])},D=h=>{if(!h){B({buyer_id:"",buyer_name:"",buyer_phone:"",buyer_email:""});return}const Y=m.find(K=>String(K.id)===String(h));if(Y){const K=`${Y.salutation||""} ${Y.name||""}`.trim();B({buyer_id:h,buyer_name:K,buyer_phone:Y.phone||"",buyer_email:Y.email||""})}else B({buyer_id:"",buyer_name:"",buyer_phone:"",buyer_email:""})},I=h=>{if(!h){B({property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""},deal_value:0});return}const Y=b.find(K=>String(K.id)===String(h));if(Y){const K={type:Y.type||Y.property_type_name||"",area:Y.area||Y.carpet_area||"",floor:(Y.floor??Y.floor_number??"").toString(),facing:Y.facing||Y.direction||""};B({property_id:String(h),property_address:Y.address||"",property_details:K,deal_value:Number(Y.price??Y.expected_price??Y.deal_value??0)})}else B({property_id:"",property_address:"",property_details:{type:"",area:"",floor:"",facing:""}})},H=async()=>{if(!T.seller_name.trim()){alert("Please select a seller");return}if(!T.buyer_name.trim()){alert("Please select a buyer");return}if(!T.property_address.trim()){alert("Please select a property");return}if(!T.payment_type){alert("Please select a payment type");return}if(!T.amount||Number(T.amount)<=0){alert("Please enter valid amount");return}if(!T.payment_reference.trim()){alert("Please enter payment reference");return}V(!0);try{const h=new Date().toISOString(),Y={type:"property_payment_receipt",status:"paid",payment_status:"paid",receipt_id:T.receipt_id,seller_id:T.seller_id,seller_name:T.seller_name,seller_phone:T.seller_phone,seller_email:T.seller_email,buyer_id:T.buyer_id,buyer_name:T.buyer_name,buyer_phone:T.buyer_phone,buyer_email:T.buyer_email,property_id:T.property_id,property_address:T.property_address,property_details:{...T.property_details},deal_value:T.deal_value,payment_type:T.payment_type,amount:Number(T.amount)||0,amount_in_words:T.amount_in_words,receipt_date:cc(T.receipt_date),payment_date:cc(T.payment_date),payment_reference:T.payment_reference,transaction_details:{...T.transaction_details},related_party:T.related_party,notes:T.notes,created_at:(t==null?void 0:t.created_at)||h,updated_at:h,created_by:(t==null?void 0:t.created_by)??(T.created_by||(u==null?void 0:u.id)||""),updated_by:(u==null?void 0:u.id)??T.updated_by??"",ledger_entries:(t==null?void 0:t.ledger_entries)||[{type:"credit",amount:Number(T.amount)||0,description:"Property payment received",date:cc(T.payment_date)||T.payment_date,balance:Number(T.amount)||0}]};await r(Y)}catch(h){console.error("Error saving receipt:",h)}finally{V(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"px-6 py-2 border-b border-gray-200 bg-gradient-to-r from-orange-50 to-amber-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(Pa,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Property Payment Receipt":"Create Property Payment Receipt"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Property Payment acknowledgment with transaction details"})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[75vh] overflow-y-auto",children:v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-gray-500",children:"Loading data..."})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Pa,{className:"mr-2",size:20}),"Receipt Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt ID"}),e.jsx("input",{type:"text",value:T.receipt_id,placeholder:"Auto generated after Create ",readOnly:!0,className:"w-full px-3 py-2  border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Party"}),e.jsxs("select",{value:T.related_party,onChange:h=>A("related_party",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"buyer",children:"From Buyer"}),e.jsx("option",{value:"seller",children:"From Seller"}),e.jsx("option",{value:"buyer_to_seller",children:"Buyer to Seller"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Date"}),e.jsx("input",{type:"datetime-local",value:T.receipt_date,onChange:h=>A("receipt_date",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date"}),e.jsx("input",{type:"datetime-local",value:T.payment_date,onChange:h=>A("payment_date",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ms,{className:"mr-2",size:20}),"Seller Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Seller ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:T.seller_id,onChange:h=>L(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"-- Select Seller --"}),n.length?n.map(h=>e.jsxs("option",{value:String(h.id),children:[h.salutation," ",h.name]},h.id)):e.jsx("option",{disabled:!0,children:"No sellers available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller ID"}),e.jsx("input",{type:"text",value:T.seller_id,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",placeholder:"Auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Phone"}),e.jsx("input",{type:"tel",value:T.seller_phone,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Email"}),e.jsx("input",{type:"email",value:T.seller_email,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ns,{className:"mr-2",size:20}),"Buyer Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Buyer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:T.buyer_id,onChange:h=>D(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"-- Select Buyer --"}),m.length?m.map(h=>e.jsxs("option",{value:String(h.id),children:[h.salutation," ",h.name]},h.id)):e.jsx("option",{disabled:!0,children:"No buyers available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer ID"}),e.jsx("input",{type:"text",value:T.buyer_id,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",placeholder:"Auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Phone"}),e.jsx("input",{type:"tel",value:T.buyer_phone,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Email"}),e.jsx("input",{type:"email",value:T.buyer_email,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Is,{className:"mr-2",size:20}),"Property Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Property ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:T.property_id,onChange:h=>I(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!T.seller_id||b.length===0,required:!0,children:[e.jsx("option",{value:"",children:T.seller_id?b.length===0?"-- No Properties Available --":"-- Select Property --":"-- Select Seller First --"}),b.map(h=>e.jsxs("option",{value:String(h.id),children:[h.address," (",h.type||h.property_type_name,")"]},String(h.id)))]}),T.seller_id&&b.length===0&&e.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"This seller has no properties attached"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property ID"}),e.jsx("input",{type:"text",value:T.property_id,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 font-mono text-sm",placeholder:"Auto"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Address"}),e.jsx("textarea",{value:T.property_address,readOnly:!0,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Type"}),e.jsx("input",{type:"text",value:T.property_details.type,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area (Sq ft)"}),e.jsx("input",{type:"text",value:T.property_details.area,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Floor"}),e.jsx("input",{type:"text",value:T.property_details.floor,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Facing"}),e.jsx("input",{type:"text",value:T.property_details.facing,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ut,{className:"mr-2",size:20}),"Payment Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:T.payment_type,onChange:h=>A("payment_type",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:f,required:!0,children:[e.jsx("option",{value:"",children:f?"Loading payment typesâ€¦":"-- Select Payment Type --"}),(f?[]:R).map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount (â‚¹) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:T.amount,onChange:h=>A("amount",Number(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"500000",required:!0})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-orange-700 mb-1",children:"Amount in Words"}),e.jsx("div",{className:"text-sm text-orange-800 font-medium",children:T.amount_in_words})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(en,{className:"mr-2",size:20}),"Transaction Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),e.jsxs("select",{value:T.transaction_details.payment_method,onChange:h=>A("transaction_details.payment_method",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:f,children:[e.jsx("option",{value:"",children:f?"Loading payment methodsâ€¦":"-- Select Payment Method --"}),(f?[]:F).map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Reference ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:T.payment_reference,onChange:h=>A("payment_reference",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"TXN123456789",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buyer Bank Name"}),e.jsxs("select",{value:T.transaction_details.buyer_bank_name,onChange:h=>A("transaction_details.buyer_bank_name",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:f,children:[e.jsx("option",{value:"",children:f?"Loading banksâ€¦":"-- Select Buyer Bank --"}),(f?[]:k).map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seller Bank Name"}),e.jsxs("select",{value:T.transaction_details.seller_bank_name,onChange:h=>A("transaction_details.seller_bank_name",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:f,children:[e.jsx("option",{value:"",children:f?"Loading banksâ€¦":"-- Select Seller Bank --"}),(f?[]:k).map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:T.notes,onChange:h=>A("notes",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Additional notes or terms..."})]})]})]})}),e.jsx("div",{className:"px-6 py-2 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i==="manager"?"Receipt will require admin approval":"Receipt will be created immediately"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:H,disabled:E||!T.seller_name.trim()||!T.buyer_name.trim()||!T.property_address.trim()||!T.payment_type||!T.amount||!T.payment_reference.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:E?"Saving...":t?"Update Receipt":"Create Receipt"})]})]})]})})]})}):null},dc=s=>{if(!s)return"";const a=new Date(s);return isNaN(a.getTime())?"":a.toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},mc=(s,a={})=>{if(!s)return a;if(typeof s=="object")return s;try{return JSON.parse(String(s))}catch{return a}},Ux=s=>{const a=mc(s.property_details,s.property_details||{}),t=mc(s.transaction_details,s.transaction_details||{}),r=s.payment_method||t.payment_method||"";return{id:Number(s.id),type:"property_payment_receipt",client_name:s.buyer_name||s.seller_name||"â€”",client_phone:s.buyer_phone||s.seller_phone||"",client_email:s.buyer_email||s.seller_email||"",seller_id:s.seller_id,buyer_id:s.buyer_id,property_id:s.property_id,receipt_id:s.receipt_id,seller_name:s.seller_name,buyer_name:s.buyer_name,seller_phone:s.seller_phone,seller_email:s.seller_email,buyer_phone:s.buyer_phone,buyer_email:s.buyer_email,property_address:s.property_address,property_details:a,deal_value:s.deal_value??void 0,payment_type:s.payment_type,amount:Number(s.amount??0),amount_in_words:s.amount_in_words,receipt_date:s.receipt_date||void 0,payment_date:s.payment_date||void 0,payment_reference:s.payment_reference,payment_method:r,status:s.status,payment_status:s.payment_status,transaction_details:{...t,payment_method:r},notes:s.notes,ledger_entries:mc(s.ledger_entries,s.ledger_entries||[]),related_party:s.related_party,created_by:String(s.created_by??""),created_by_name:s.created_by_name||"",updated_by:String(s.updated_by??""),updated_by_name:s.updated_by_name||"",created_at:s.created_at,updated_at:s.updated_at}},l1=()=>{const[s,a]=l.useState("all"),[t,r]=l.useState(""),[i,n]=l.useState(!1),[o,m]=l.useState(!1),[g,b]=l.useState(!1),[d,v]=l.useState(!1),[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState(!1),[P,w]=l.useState(!1),[$,y]=l.useState(!1),[k,R]=l.useState(!1),[F,T]=l.useState(null),[j,E]=l.useState(null),[V]=l.useState("admin"),[W,B]=l.useState([]),{user:M}=Hs(),[A,L]=l.useState(!1),[D,I]=l.useState(null),[H,h]=l.useState(!1),Y=l.useCallback(async()=>{var ve;try{L(!0),I(null);const Pe=await bl.getAll(),pe=((Pe==null?void 0:Pe.items)??((ve=Pe==null?void 0:Pe.data)==null?void 0:ve.items)??[]).map(Ux);le(O=>{const Ie=O.filter(ze=>ze.type!=="property_payment_receipt");return[...pe,...Ie]}),h(!0)}catch(Pe){console.error("loadAllPropertyReceipts",Pe),I((Pe==null?void 0:Pe.message)||"Failed to load receipts"),Z.error("Failed to load property receipts")}finally{L(!1)}},[]);l.useEffect(()=>{H||Y()},[H,Y]);const K=l.useCallback(async ve=>{var Pe;try{const We=await bl.getById(ve),pe=((Pe=We==null?void 0:We.data)==null?void 0:Pe.item)??(We==null?void 0:We.item)??(We==null?void 0:We.data)??We;return Ux(pe)}catch(We){return console.error("fetchReceiptById",We),Z.error("Could not fetch latest receipt"),null}},[]),q=[{id:"all",label:"All Documents",count:28,color:"blue"},{id:"brokerage_invoice",label:"Brokerage Invoices",count:12,color:"purple"},{id:"brokerage_receipt",label:"Brokerage Receipts",count:8,color:"green"},{id:"property_payment_receipt",label:"Property Payment Receipts",count:8,color:"orange"},{id:"pending_approval",label:"Pending Approval",count:3,color:"red"}],[ne,le]=l.useState([{id:1,type:"brokerage_invoice",invoice_id:"INV-2025-001",client_name:"Rajesh Kumar",client_phone:"+91 98765 43210",client_email:"rajesh.kumar@email.com",seller_name:"Rajesh Kumar",buyer_name:"Amit Patel",property_address:"Flat A-404, Skyline Towers, Andheri West, Mumbai",property_details:{type:"Apartment",area:"1250 sq ft",floor:"4th Floor",facing:"North-East"},deal_value:25e6,brokerage_percentage:2,brokerage_amount:5e5,gst_percentage:18,gst_amount:9e4,total_amount:59e4,amount_in_words:"Five Lakh Ninety Thousand Only",date:"2025-01-12",due_date:"2025-01-25",status:"sent",payment_status:"pending",created_by:"Admin User",approved_by:null,requires_approval:!1,shared_channels:["email","whatsapp"],notes:"Commission for property sale transaction",ledger_entries:[{type:"debit",amount:59e4,description:"Brokerage invoice raised",date:"2025-01-12",balance:59e4}],payment_details:{bank_name:"HDFC Bank",account_number:"50100123456789",ifsc_code:"HDFC0001234",account_holder:"ResaleExpert Pvt Ltd"},related_party:"seller"},{id:2,type:"brokerage_invoice",invoice_id:"INV-2025-002",client_name:"Priya Sharma",client_phone:"+91 87654 32109",client_email:"priya.sharma@email.com",seller_name:"Priya Sharma",buyer_name:"Rohit Gupta",property_address:"Villa B-201, Green Valley Society, Pune",property_details:{type:"Villa",area:"2800 sq ft",floor:"Ground + 2",facing:"South"},deal_value:42e6,brokerage_percentage:1.5,brokerage_amount:63e4,gst_percentage:18,gst_amount:113400,total_amount:743400,amount_in_words:"Seven Lakh Forty Three Thousand Four Hundred Only",date:"2025-01-10",due_date:"2025-01-23",status:"paid",payment_status:"paid",payment_date:"2025-01-15",payment_method:"RTGS",payment_reference:"TXN123456789",created_by:"Manager User",approved_by:"Admin User",requires_approval:!1,shared_channels:["email"],notes:"Premium property commission",ledger_entries:[{type:"debit",amount:743400,description:"Brokerage invoice raised",date:"2025-01-10",balance:743400},{type:"credit",amount:743400,description:"Payment received via RTGS",date:"2025-01-15",balance:0}],payment_details:{bank_name:"HDFC Bank",account_number:"50100123456789",ifsc_code:"HDFC0001234",account_holder:"ResaleExpert Pvt Ltd"},related_party:"seller"},{id:3,type:"brokerage_receipt",receipt_id:"BR-2025-001",client_name:"Amit Patel",client_phone:"+91 76543 21098",client_email:"amit.patel@email.com",seller_name:"Sunita Gupta",buyer_name:"Amit Patel",property_address:"Penthouse PH-01, Royal Residency, Bandra, Mumbai",property_details:{type:"Penthouse",area:"3200 sq ft",floor:"15th Floor",facing:"Sea Facing"},deal_value:85e6,brokerage_percentage:2,amount:17e5,amount_in_words:"Seventeen Lakh Only",receipt_date:"2025-01-08",payment_date:"2025-01-08",payment_method:"RTGS",payment_reference:"TXN987654321",status:"paid",created_by:"Admin User",approved_by:"Admin User",requires_approval:!1,shared_channels:["email","whatsapp"],notes:"Commission received for luxury property sale",ledger_entries:[{type:"credit",amount:17e5,description:"Brokerage payment received",date:"2025-01-08",balance:17e5}],payment_details:{bank_name:"ICICI Bank",account_number:"123456789012",ifsc_code:"ICIC0001234",account_holder:"Amit Patel"},related_party:"buyer"},{id:4,type:"property_payment_receipt",receipt_id:"PPR-2025-001",client_name:"Rajesh Kumar",client_phone:"+91 98765 43210",client_email:"rajesh.kumar@email.com",seller_name:"Rajesh Kumar",buyer_name:"Amit Patel",property_address:"Flat A-404, Skyline Towers, Andheri West, Mumbai",property_details:{type:"Apartment",area:"1250 sq ft",floor:"4th Floor",facing:"North-East"},payment_type:"Token Amount",amount:5e5,amount_in_words:"Five Lakh Only",receipt_date:"2025-01-12",payment_date:"2025-01-12",payment_method:"RTGS",payment_reference:"TXN555666777",transaction_details:{from_account:"Amit Patel - HDFC Bank",to_account:"Rajesh Kumar - SBI Bank",transaction_id:"TXN555666777",bank_charges:25},status:"paid",created_by:"Manager User",approved_by:"Admin User",requires_approval:!1,shared_channels:["email","whatsapp"],notes:"Token amount for property booking",ledger_entries:[{type:"credit",amount:5e5,description:"Token amount received from buyer",date:"2025-01-12",balance:5e5}],related_party:"buyer_to_seller"},{id:5,type:"brokerage_invoice",invoice_id:"INV-2025-003",client_name:"Neha Agarwal",client_phone:"+91 65432 10987",client_email:"neha.agarwal@email.com",seller_name:"Neha Agarwal",buyer_name:"Vikash Singh",property_address:"Office 301, Tech Park, Gurgaon",property_details:{type:"Commercial",area:"1500 sq ft",floor:"3rd Floor",facing:"East"},deal_value:35e6,brokerage_percentage:1.8,brokerage_amount:63e4,gst_percentage:18,gst_amount:113400,total_amount:743400,amount_in_words:"Seven Lakh Forty Three Thousand Four Hundred Only",date:"2025-01-13",due_date:"2025-01-28",status:"pending_approval",payment_status:"pending",created_by:"Manager User",approved_by:null,requires_approval:!0,shared_channels:[],notes:"Commercial property commission - pending admin approval",ledger_entries:[],payment_details:{bank_name:"HDFC Bank",account_number:"50100123456789",ifsc_code:"HDFC0001234",account_holder:"ResaleExpert Pvt Ltd"},related_party:"seller"}]),S=l.useMemo(()=>{const ve=t.trim().toLowerCase();return ne.filter(Pe=>{const We=(Pe.client_name||"").toLowerCase(),pe=(Pe.property_address||"").toLowerCase(),O=(Pe.invoice_id||"").toLowerCase(),Ie=(Pe.receipt_id||"").toLowerCase(),ze=ve===""||We.includes(ve)||pe.includes(ve)||O.includes(ve)||Ie.includes(ve),xe=s==="all"||Pe.type===s||s==="pending_approval"&&!!Pe.requires_approval;return ze&&xe})},[ne,t,s]),C=l.useMemo(()=>ne.reduce((ve,Pe)=>{const We=Pe.total_amount??Pe.amount??0;return ve+We},0),[ne]),J=l.useMemo(()=>ne.filter(ve=>ve.payment_status==="paid"||ve.status==="paid").reduce((ve,Pe)=>ve+(Pe.total_amount??Pe.amount??0),0),[ne]),ue=C-J,Q=l.useMemo(()=>{const ve=new Date;return ne.reduce((Pe,We)=>{const pe=We.date??We.receipt_date;if(!pe)return Pe;const O=new Date(pe);return O.getMonth()===ve.getMonth()&&O.getFullYear()===ve.getFullYear()?Pe+(We.total_amount??We.amount??0):Pe},0)},[ne]),he=()=>{E(null),u(!0)},se=()=>{E(null),f(!0)},ge=()=>{E(null),N(!0)},ee=ve=>{T(ve),n(!0)},de=ve=>{T(ve),m(!0)},U=async ve=>{if(ve.type==="brokerage_invoice"){E(ve),u(!0);return}if(ve.type==="brokerage_receipt"){E(ve),f(!0);return}if(ve.type==="property_payment_receipt"){const Pe=await K(ve.id);E(Pe||ve),N(!0)}},X=l.useCallback(async ve=>{try{if(!(ve!=null&&ve.id))return;await bl.delete(ve.id),le(Pe=>Pe.filter(We=>We.id!==ve.id)),Z.success("Receipt deleted")}catch(Pe){console.error("delete receipt",Pe),Z.error("Failed to delete receipt")}},[]),re=ve=>{T(ve),v(!0)},fe=ve=>{T(ve),w(!0)},G=ve=>{T(ve),y(!0)},me=ve=>{const Pe="JVBERi0xLjQKJdPr6eEKMSAwIG9iag...",We=document.createElement("a");We.href=`data:application/pdf;base64,${Pe}`,We.download=`${ve.invoice_id??ve.receipt_id??"document"}.pdf`,document.body.appendChild(We),We.click(),We.remove()},oe=async ve=>{try{if(ve.type==="property_payment_receipt")(j==null?void 0:j.type)==="property_payment_receipt"&&j.id?(await bl.update(j.id,{type:"property_payment_receipt",status:ve.status??"paid",payment_status:ve.payment_status??"paid",related_party:ve.related_party,seller_id:ve.seller_id,seller_name:ve.seller_name,seller_phone:ve.seller_phone,seller_email:ve.seller_email,buyer_id:ve.buyer_id,buyer_name:ve.buyer_name,buyer_phone:ve.buyer_phone,buyer_email:ve.buyer_email,property_id:ve.property_id,property_address:ve.property_address,property_details:ve.property_details,deal_value:ve.deal_value,payment_type:ve.payment_type,amount:ve.amount,amount_in_words:ve.amount_in_words,receipt_date:ve.receipt_date,payment_date:ve.payment_date,payment_reference:ve.payment_reference,payment_method:ve.payment_method,transaction_details:ve.transaction_details,notes:ve.notes,ledger_entries:ve.ledger_entries}),Z.success("Receipt Updated"),await Y()):(await bl.create({type:"property_payment_receipt",status:"paid",payment_status:"paid",related_party:ve.related_party,seller_id:ve.seller_id,seller_name:ve.seller_name,seller_phone:ve.seller_phone,seller_email:ve.seller_email,buyer_id:ve.buyer_id,buyer_name:ve.buyer_name,buyer_phone:ve.buyer_phone,buyer_email:ve.buyer_email,property_id:ve.property_id,property_address:ve.property_address,property_details:ve.property_details,deal_value:ve.deal_value,payment_type:ve.payment_type,amount:ve.amount,amount_in_words:ve.amount_in_words,receipt_date:ve.receipt_date,payment_date:ve.payment_date,payment_reference:ve.payment_reference,transaction_details:ve.transaction_details,notes:ve.notes,ledger_entries:ve.ledger_entries,created_by:ve.created_by,updated_by:ve.updated_by}),Z.success("Receipt Created"),await Y());else if(j){const Pe={...j,...ve};Pe.client_name||(Pe.client_name=ve.buyer_name||ve.seller_name||j.client_name||"â€”"),le(We=>We.map(pe=>pe.id===j.id?Pe:pe))}else{const Pe=ne.length?Math.max(...ne.map(pe=>pe.id)):0,We={...ve,id:Pe+1};We.client_name||(We.client_name=(ve==null?void 0:ve.buyer_name)||(ve==null?void 0:ve.seller_name)||"â€”"),le(pe=>[We,...pe])}}catch(Pe){console.error("Save error",Pe),Z.error("Failed to save document")}finally{u(!1),f(!1),N(!1),E(null)}},Fe=(ve,Pe)=>{le(We=>We.map(pe=>pe.id===ve?{...pe,requires_approval:!1,status:Pe?"active":"rejected",approved_by:"Admin User",approved_at:new Date().toISOString()}:pe)),y(!1),T(null)},$e=ve=>{B(Pe=>Pe.includes(ve)?Pe.filter(We=>We!==ve):[...Pe,ve])},Le=()=>{W.length===S.length&&S.length>0?B([]):B(S.map(ve=>ve.id))},je=(ve,Pe)=>{if(ve==="pending_approval")return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800",children:[e.jsx(Xa,{size:14,className:"mr-1"}),"Pending Approval"]});const We={paid:{bg:"bg-green-100",text:"text-green-800",label:"Paid",icon:bs},sent:{bg:"bg-blue-100",text:"text-blue-800",label:"Sent",icon:Dt},pending:{bg:"bg-orange-100",text:"text-orange-800",label:"Pending",icon:Ls},overdue:{bg:"bg-red-100",text:"text-red-800",label:"Overdue",icon:ct},active:{bg:"bg-blue-100",text:"text-blue-800",label:"Active",icon:Ah}},O=We[Pe??ve??"pending"]??We.pending,Ie=O.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${O.bg} ${O.text}`,children:[e.jsx(Ie,{size:14,className:"mr-1"}),O.label]})},_e=ve=>{const Pe={brokerage_invoice:{label:"Brokerage Invoice",icon:ws,color:"text-purple-600",bg:"bg-purple-100"},brokerage_receipt:{label:"Brokerage Receipt",icon:Pa,color:"text-green-600",bg:"bg-green-100"},property_payment_receipt:{label:"Property Payment Receipt",icon:Ut,color:"text-orange-600",bg:"bg-orange-100"}};return Pe[ve]??Pe.brokerage_invoice};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-green-600 to-emerald-600 rounded-xl",children:e.jsx(Pa,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Accounts Management"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base mt-1",children:"Complete financial document management with ledger tracking"})]})]}),e.jsx("div",{className:"flex items-start sm:items-center justify-end",children:e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm sm:text-base",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Create Document"})]}),e.jsx("div",{className:"absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10 w-64",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("button",{onClick:he,className:"flex items-start space-x-3 px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 rounded-lg w-full text-left",children:[e.jsx(ws,{className:"text-purple-600 mt-1",size:16}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Brokerage Invoice"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Commission invoice to client"})]})]}),e.jsxs("button",{onClick:se,className:"flex items-start space-x-3 px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 rounded-lg w-full text-left",children:[e.jsx(Pa,{className:"text-green-600 mt-1",size:16}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Brokerage Receipt"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Commission payment received"})]})]}),e.jsxs("button",{onClick:ge,className:"flex items-start space-x-3 px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 rounded-lg w-full text-left",children:[e.jsx(Ut,{className:"text-orange-600 mt-1",size:16}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Property Payment Receipt"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Property payment acknowledgment"})]})]})]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"Total Amount"}),e.jsxs("p",{className:"text-2xl font-bold",children:["â‚¹",(C/1e5).toFixed(1),"L"]})]}),e.jsx(ka,{size:24,className:"text-blue-200"})]}),e.jsxs("div",{className:"flex items-center mt-2 text-blue-100 text-sm",children:[e.jsx(Li,{size:14,className:"mr-1"}),e.jsx("span",{children:"+12% from last month"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"Paid Amount"}),e.jsxs("p",{className:"text-2xl font-bold",children:["â‚¹",(J/1e5).toFixed(1),"L"]})]}),e.jsx(bs,{size:24,className:"text-green-200"})]}),e.jsxs("div",{className:"flex items-center mt-2 text-green-100 text-sm",children:[e.jsx(Li,{size:14,className:"mr-1"}),e.jsx("span",{children:"+8% from last month"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm",children:"Pending Amount"}),e.jsxs("p",{className:"text-2xl font-bold",children:["â‚¹",(ue/1e5).toFixed(1),"L"]})]}),e.jsx(Ls,{size:24,className:"text-orange-200"})]}),e.jsxs("div",{className:"flex items-center mt-2 text-orange-100 text-sm",children:[e.jsx(_u,{size:14,className:"mr-1"}),e.jsx("span",{children:"-5% from last month"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"This Month"}),e.jsxs("p",{className:"text-2xl font-bold",children:["â‚¹",(Q/1e5).toFixed(1),"L"]})]}),e.jsx(Rs,{size:24,className:"text-purple-200"})]}),e.jsxs("div",{className:"flex items-center mt-2 text-purple-100 text-sm",children:[e.jsx(Li,{size:14,className:"mr-1"}),e.jsx("span",{children:"+15% from last month"})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:q.map(ve=>e.jsxs("button",{onClick:()=>a(ve.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors whitespace-nowrap ${s===ve.id?`bg-${ve.color}-100 text-${ve.color}-700 border border-${ve.color}-200`:"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"font-medium",children:ve.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${s===ve.id?`bg-${ve.color}-200`:"bg-gray-200"}`,children:ve.count})]},ve.id))})})]}),e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:t,onChange:ve=>r(ve.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("button",{onClick:()=>R(!k),className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(Na,{size:16}),e.jsx("span",{children:"Filters"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[W.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:[W.length," selected"]}),e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Bulk Action"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Export"})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"bg-white",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left w-8",children:e.jsx("input",{type:"checkbox",checked:W.length===S.length&&S.length>0,onChange:Le,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Document Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Parties & Property"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Financial Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status & Approval"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(ve=>{const Pe=_e(ve.type),We=Pe.icon;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:W.includes(ve.id),onChange:()=>$e(ve.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${Pe.bg}`,children:e.jsx(We,{className:Pe.color,size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:ve.invoice_id??ve.receipt_id}),e.jsx("div",{className:"text-sm text-gray-600",children:Pe.label}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",dc(ve.date??ve.receipt_date)]}),ve.payment_date&&e.jsxs("div",{className:"text-xs text-green-600",children:["Paid: ",dc(ve.payment_date)]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Seller:"})," ",ve.seller_name]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Buyer:"})," ",ve.buyer_name]}),e.jsxs("div",{className:"flex items-start space-x-1 text-sm text-gray-600",children:[e.jsx(Qs,{size:12,className:"mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"line-clamp-2",children:ve.property_address})]}),ve.property_details&&e.jsxs("div",{className:"text-xs text-gray-500",children:[ve.property_details.type," â€¢ ",ve.property_details.area," â€¢ ",ve.property_details.floor]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-2",children:[ve.deal_value&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Deal Value:"}),e.jsxs("span",{className:"font-bold text-blue-600 ml-1",children:["â‚¹",(ve.deal_value/1e5).toFixed(1),"L"]})]}),ve.brokerage_percentage&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Brokerage:"}),e.jsxs("span",{className:"font-medium text-purple-600 ml-1",children:[ve.brokerage_percentage,"%"]})]}),e.jsxs("div",{className:"font-bold text-lg text-gray-900",children:["â‚¹",(ve.total_amount??ve.amount??0).toLocaleString("en-IN")]}),e.jsx("div",{className:"text-xs text-gray-500",children:ve.amount_in_words}),ve.payment_method&&e.jsxs("div",{className:"text-xs text-blue-600",children:["via ",ve.payment_method,ve.payment_date?` â€¢ ${dc(ve.payment_date)}`:""]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-2",children:[je(ve.status,ve.payment_status),ve.requires_approval&&e.jsxs("div",{className:"flex items-center space-x-1 text-xs text-orange-600",children:[e.jsx(kh,{size:12}),e.jsx("span",{children:"Awaiting Approval"})]}),ve.approved_by&&e.jsxs("div",{className:"text-xs text-green-600",children:["Approved by ",ve.approved_by]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[" ",e.jsx("span",{className:"font-bold",children:"Created By: "})," ",ve.created_by_name]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-bold",children:" Updated By: "}),"  ",ve.updated_by_name]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>fe(ve),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",title:"View Ledger",children:e.jsx(Ch,{size:16})}),e.jsx("button",{onClick:()=>de(ve),className:"p-2 text-indigo-600 hover:bg-indigo-100 rounded-lg transition-colors",title:"View Tracking",children:e.jsx(ks,{size:16})}),e.jsx("button",{onClick:()=>ee(ve),className:"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors",title:"Share Document",children:e.jsx(Wt,{size:16})}),e.jsx("button",{onClick:()=>me(ve),className:"p-2 text-purple-600 hover:bg-purple-100 rounded-lg transition-colors",title:"Download",children:e.jsx(Ys,{size:16})}),ve.requires_approval&&V==="admin"&&e.jsx("button",{onClick:()=>G(ve),className:"p-2 text-orange-600 hover:bg-orange-100 rounded-lg transition-colors",title:"Approve/Reject",children:e.jsx(at,{size:16})}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(xr,{size:16})}),e.jsx("div",{className:"absolute right-0 top-10 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:e.jsxs("div",{className:"p-1",children:[e.jsxs("button",{onClick:()=>U(ve),className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(ft,{size:14}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:()=>{ve.type==="property_payment_receipt"?window.confirm(`Delete receipt ${ve.receipt_id??ve.id}?`)&&X(ve):re(ve)},className:"flex items-center space-x-2 px-3 py-2 text-sm text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(Es,{size:14}),e.jsx("span",{children:"Delete"})]})]})})]})]})})]},ve.id)})})]})})}),i&&F&&e.jsx(Jw,{isOpen:i,onClose:()=>{n(!1),T(null)},item:F,type:F==null?void 0:F.type,onShare:ve=>{n(!1),T(null)}}),o&&F&&e.jsx(Qw,{isOpen:o,onClose:()=>{m(!1),T(null)},item:F,type:F==null?void 0:F.type}),g&&F&&e.jsx(Zw,{isOpen:g,onClose:()=>{b(!1),T(null)},document:F,userRole:V,onSave:ve=>{b(!1),T(null)}}),d&&F&&e.jsx(Xw,{isOpen:d,onClose:()=>{v(!1),T(null)},document:F,userRole:V,onSubmit:ve=>{v(!1),T(null)}}),x&&e.jsx(e1,{isOpen:x,onClose:()=>{u(!1),E(null)},invoice:j,onSave:oe,userRole:V}),c&&e.jsx(s1,{isOpen:c,onClose:()=>{f(!1),E(null)},receipt:j,onSave:oe,userRole:V}),p&&e.jsx(r1,{isOpen:p,onClose:()=>{N(!1),E(null)},receipt:j,onSave:oe,userRole:V}),P&&F&&e.jsx(t1,{isOpen:P,onClose:()=>{w(!1),T(null)},document:F}),$&&F&&e.jsx(a1,{isOpen:$,onClose:()=>{y(!1),T(null)},document:F,onApprove:ve=>Fe(F.id,ve),userRole:V})]})},n1=({isOpen:s,onClose:a,vendor:t,onSave:r})=>{const[i,n]=l.useState({salutation:"Mr.",name:"",businessName:"",category:"plumber",countryCode:"+91",phone:"",whatsapp:"",email:"",address:"",rating:4.5,experience:1,verified:!1,reExpertVerified:!1,reSuggested:!1,services:[],tags:[],rateIdea:"",portfolio:[],description:"",availability:{days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],startTime:"09:00",endTime:"18:00",weeklyOff:"Sunday"},languages:[],certifications:[],completedProjects:0,responseTime:"1 hour",status:"active"}),[o,m]=l.useState({name:"",rate:"",unit:"per sq ft",description:""}),[g,b]=l.useState(""),[d,v]=l.useState(""),[x,u]=l.useState(""),[c,f]=l.useState(!1),[p,N]=l.useState(!0),P={plumber:[{name:"Pipe Fitting",rate:"â‚¹800-1200",unit:"per point",description:"Professional pipe fitting and connection"},{name:"Leak Repair",rate:"â‚¹500-800",unit:"per repair",description:"Quick leak detection and repair"},{name:"Bathroom Installation",rate:"â‚¹15000-25000",unit:"lumpsum",description:"Complete bathroom plumbing setup"},{name:"Kitchen Plumbing",rate:"â‚¹8000-15000",unit:"lumpsum",description:"Kitchen sink and appliance connections"},{name:"Water Tank Installation",rate:"â‚¹3000-5000",unit:"per tank",description:"Water tank setup and connection"}],tiles:[{name:"Tile Installation",rate:"â‚¹80-150",unit:"per sq ft",description:"Professional tile laying and installation"},{name:"Marble Flooring",rate:"â‚¹200-500",unit:"per sq ft",description:"Premium marble flooring installation"},{name:"Wall Tiling",rate:"â‚¹60-120",unit:"per sq ft",description:"Wall tile installation with perfect alignment"},{name:"Bathroom Tiling",rate:"â‚¹25000-45000",unit:"lumpsum",description:"Complete bathroom tiling solution"},{name:"Kitchen Tiling",rate:"â‚¹15000-30000",unit:"lumpsum",description:"Kitchen backsplash and flooring"}],painter:[{name:"Interior Painting",rate:"â‚¹18-35",unit:"per sq ft",description:"Premium interior wall painting"},{name:"Exterior Painting",rate:"â‚¹25-45",unit:"per sq ft",description:"Weather resistant exterior painting"},{name:"Texture Work",rate:"â‚¹35-60",unit:"per sq ft",description:"Designer texture and pattern work"},{name:"Complete Home Painting",rate:"â‚¹80000-150000",unit:"lumpsum",description:"Full home painting package"},{name:"Wood Polishing",rate:"â‚¹40-80",unit:"per sq ft",description:"Wood furniture polishing and finishing"}],carpenter:[{name:"Custom Furniture",rate:"â‚¹1200-2500",unit:"per sq ft",description:"Custom designed furniture making"},{name:"Kitchen Cabinets",rate:"â‚¹800-1800",unit:"per sq ft",description:"Modular kitchen cabinet installation"},{name:"Wardrobes",rate:"â‚¹1000-2200",unit:"per sq ft",description:"Built-in wardrobe construction"},{name:"Door Installation",rate:"â‚¹3000-8000",unit:"per door",description:"Door frame and installation"},{name:"Ceiling Work",rate:"â‚¹150-300",unit:"per sq ft",description:"False ceiling and wooden ceiling work"}],interior:[{name:"Complete Interior Design",rate:"â‚¹1200-3500",unit:"per sq ft",description:"Full interior design and execution"},{name:"3D Visualization",rate:"â‚¹15000-35000",unit:"lumpsum",description:"3D design and visualization"},{name:"Space Planning",rate:"â‚¹50-150",unit:"per sq ft",description:"Optimal space utilization planning"},{name:"Furniture Selection",rate:"â‚¹25000-75000",unit:"lumpsum",description:"Furniture selection and procurement"},{name:"Lighting Design",rate:"â‚¹200-500",unit:"per sq ft",description:"Lighting design and installation"}],waterproofing:[{name:"Terrace Waterproofing",rate:"â‚¹45-120",unit:"per sq ft",description:"Complete terrace waterproofing solution"},{name:"Bathroom Waterproofing",rate:"â‚¹80-150",unit:"per sq ft",description:"Bathroom waterproofing with warranty"},{name:"External Wall Treatment",rate:"â‚¹35-80",unit:"per sq ft",description:"External wall waterproofing treatment"},{name:"Basement Waterproofing",rate:"â‚¹100-200",unit:"per sq ft",description:"Basement waterproofing and dampproofing"},{name:"Swimming Pool Waterproofing",rate:"â‚¹200-400",unit:"per sq ft",description:"Swimming pool waterproofing"}],electrician:[{name:"Electrical Wiring",rate:"â‚¹80-150",unit:"per point",description:"Complete electrical wiring installation"},{name:"Switch Board Installation",rate:"â‚¹200-500",unit:"per board",description:"Electrical switch board setup"},{name:"Fan Installation",rate:"â‚¹300-600",unit:"per fan",description:"Ceiling fan installation with wiring"},{name:"Light Fitting",rate:"â‚¹150-400",unit:"per fitting",description:"Light fixture installation"},{name:"Home Automation",rate:"â‚¹25000-75000",unit:"lumpsum",description:"Smart home automation setup"}]},w={plumber:["24/7 Service","Emergency","Licensed","Insured","Warranty","Quick Response"],tiles:["Premium Quality","Designer Tiles","Warranty","Installation Included","Showroom"],painter:["Asian Paints Dealer","Texture Expert","Quick Service","Warranty","Color Consultant"],carpenter:["Custom Work","Quality Wood","Warranty","Design","Modular","Installation"],interior:["Luxury Design","3D Design","Turnkey","Award Winner","Consultation","Premium"],waterproofing:["10 Year Warranty","Chemical Treatment","Expert Team","Leak Proof","Certified"],electrician:["Licensed","Safety Certified","24/7 Service","Smart Home","Warranty","Emergency"]},$=["Hindi","English","Marathi","Gujarati","Tamil","Telugu","Bengali","Punjabi"],y=[{id:"plumber",label:"Plumber"},{id:"tiles",label:"Tiles & Flooring"},{id:"painter",label:"Painter"},{id:"carpenter",label:"Carpenter"},{id:"interior",label:"Interior Designer"},{id:"waterproofing",label:"Water Proofing"},{id:"electrician",label:"Electrician"}],k=["30 minutes","1 hour","2 hours","4 hours","1 day","2 days"],R=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],F=["per sq ft","per point","per repair","per day","per hour","lumpsum","per door","per window","per room","per tank","per fan","per fitting"];l.useEffect(()=>{t&&(n({...t,availability:t.availability||{days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],startTime:"09:00",endTime:"18:00",weeklyOff:"Sunday"}}),N(t.phone===t.whatsapp))},[t]);const T=(q,ne)=>{n(le=>({...le,[q]:ne})),q==="phone"&&p&&n(le=>({...le,whatsapp:ne}))},j=q=>{N(q),q&&n(ne=>({...ne,whatsapp:ne.phone}))},E=q=>{n(ne=>({...ne,category:q,services:P[q]||[],tags:w[q]||[],languages:["Hindi","English"]})),V(q)},V=q=>{const ne={plumber:"Professional plumbing services with extensive experience in residential and commercial projects. Specializes in pipe fitting, leak repairs, and complete bathroom installations with 24/7 emergency support.",tiles:"Premium tiles and marble installation services with extensive showroom and quality materials. Expert in luxury flooring solutions with designer collections and professional installation.",painter:"Professional painting services with expertise in interior and exterior painting. Authorized dealer with quality materials and skilled workforce for residential and commercial projects.",carpenter:"Expert carpentry services specializing in custom furniture and modular solutions. Quality craftsmanship with modern designs and professional installation services.",interior:"Professional interior design services with expertise in luxury residential and commercial spaces. Complete design solutions from concept to execution with 3D visualization.",waterproofing:"Professional waterproofing solutions with long-term warranty. Specialized in residential and commercial projects with chemical treatment and expert application.",electrician:"Licensed electrical services with expertise in residential and commercial wiring. Safety certified with experience in modern electrical systems and smart home automation."};n(le=>({...le,description:ne[q]||""}))},W=()=>{o.name.trim()&&(n(q=>({...q,services:[...q.services,{...o}]})),m({name:"",rate:"",unit:"per sq ft",description:""}))},B=q=>{n(ne=>({...ne,services:ne.services.filter((le,S)=>S!==q)}))},M=()=>{g.trim()&&!i.tags.includes(g.trim())&&(n(q=>({...q,tags:[...q.tags,g.trim()]})),b(""))},A=q=>{n(ne=>({...ne,tags:ne.tags.filter(le=>le!==q)}))},L=()=>{d.trim()&&!i.languages.includes(d.trim())&&(n(q=>({...q,languages:[...q.languages,d.trim()]})),v(""))},D=q=>{n(ne=>({...ne,languages:ne.languages.filter(le=>le!==q)}))},I=()=>{x.trim()&&!i.certifications.includes(x.trim())&&(n(q=>({...q,certifications:[...q.certifications,x.trim()]})),u(""))},H=q=>{n(ne=>({...ne,certifications:ne.certifications.filter(le=>le!==q)}))},h=(q,ne)=>{n(le=>({...le,availability:{...le.availability,[q]:ne}}))},Y=q=>{n(ne=>({...ne,availability:{...ne.availability,days:ne.availability.days.includes(q)?ne.availability.days.filter(le=>le!==q):[...ne.availability.days,q]}}))},K=async()=>{if(!i.name.trim()){alert("Please enter vendor name");return}if(!i.businessName.trim()){alert("Please enter business name");return}if(!i.phone.trim()){alert("Please enter phone number");return}if(!i.email.trim()){alert("Please enter email address");return}f(!0);try{const q={...i,phone:i.phone.replace(/\D/g,""),whatsapp:i.whatsapp.replace(/\D/g,""),created_at:(t==null?void 0:t.created_at)||new Date().toISOString(),lastActive:new Date().toISOString()};await r(q)}catch(q){console.error("Error saving vendor:",q)}finally{f(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Vendor":"Add New Vendor"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Complete vendor information with services and rates"})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ns,{className:"mr-2",size:20}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salutation"}),e.jsxs("select",{value:i.salutation,onChange:q=>T("salutation",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"Mr.",children:"Mr."}),e.jsx("option",{value:"Mrs.",children:"Mrs."}),e.jsx("option",{value:"Ms.",children:"Ms."}),e.jsx("option",{value:"Dr.",children:"Dr."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.name,onChange:q=>T("name",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter vendor name",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Business Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i.businessName,onChange:q=>T("businessName",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter business name",required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:i.category,onChange:q=>E(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:y.map(q=>e.jsx("option",{value:q.id,children:q.label},q.id))})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Cs,{className:"mr-2",size:20}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("select",{value:i.countryCode,onChange:q=>T("countryCode",q.target.value),className:"px-3 py-2 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50",children:[e.jsx("option",{value:"+91",children:"+91 (India)"}),e.jsx("option",{value:"+1",children:"+1 (USA)"}),e.jsx("option",{value:"+44",children:"+44 (UK)"}),e.jsx("option",{value:"+971",children:"+971 (UAE)"})]}),e.jsx("input",{type:"tel",value:i.phone,onChange:q=>T("phone",q.target.value),className:"flex-1 px-3 py-2 border border-l-0 border-gray-300 rounded-r-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"9876543210",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Number"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"tel",value:i.whatsapp,onChange:q=>T("whatsapp",q.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"WhatsApp number",disabled:p}),e.jsx("button",{type:"button",onClick:()=>j(!p),className:`p-2 rounded-lg transition-colors ${p?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,title:"Same as phone number",children:e.jsx(_a,{size:16})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:i.email,onChange:q=>T("email",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"vendor@email.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:i.address,onChange:q=>T("address",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Shop/Office address"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(On,{className:"mr-2",size:20}),"Business Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Experience (Years)"}),e.jsx("input",{type:"number",value:i.experience,onChange:q=>T("experience",Number(q.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rating"}),e.jsx("input",{type:"number",value:i.rating,onChange:q=>T("rating",Number(q.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"5",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Completed Projects"}),e.jsx("input",{type:"number",value:i.completedProjects,onChange:q=>T("completedProjects",Number(q.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Response Time"}),e.jsx("select",{value:i.responseTime,onChange:q=>T("responseTime",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:k.map(q=>e.jsx("option",{value:q,children:q},q))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rate Idea"}),e.jsx("input",{type:"text",value:i.rateIdea,onChange:q=>T("rateIdea",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"â‚¹500-1500 per visit"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ts,{className:"mr-2",size:20}),"Availability"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Working Days"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:R.map(q=>e.jsx("button",{type:"button",onClick:()=>Y(q),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${i.availability.days.includes(q)?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-600 border border-gray-200"}`,children:q.slice(0,3)},q))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"time",value:i.availability.startTime,onChange:q=>h("startTime",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),e.jsx("input",{type:"time",value:i.availability.endTime,onChange:q=>h("endTime",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weekly Off"}),e.jsx("select",{value:i.availability.weeklyOff,onChange:q=>h("weeklyOff",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:R.map(q=>e.jsx("option",{value:q,children:q},q))})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Services & Rate Cards"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",value:o.name,onChange:q=>m({...o,name:q.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Service name"}),e.jsx("input",{type:"text",value:o.rate,onChange:q=>m({...o,rate:q.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Rate (e.g., â‚¹800-1200)"}),e.jsx("select",{value:o.unit,onChange:q=>m({...o,unit:q.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:F.map(q=>e.jsx("option",{value:q,children:q},q))}),e.jsx("button",{onClick:W,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:e.jsx(fs,{size:16})})]}),e.jsx("input",{type:"text",value:o.description,onChange:q=>m({...o,description:q.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Service description"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:i.services.map((q,ne)=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:q.name}),e.jsx("div",{className:"text-sm text-gray-600",children:q.description}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:"text-sm font-bold text-green-600",children:q.rate}),e.jsx("span",{className:"text-xs text-gray-500",children:q.unit})]})]}),e.jsx("button",{onClick:()=>B(ne),className:"text-red-600 hover:text-red-800",children:e.jsx(Es,{size:14})})]})},ne))})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(mr,{className:"mr-2",size:20}),"Tags"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:g,onChange:q=>b(q.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Add tag (e.g., 24/7 Service)",onKeyPress:q=>q.key==="Enter"&&M()}),e.jsx("button",{onClick:M,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:e.jsx(fs,{size:16})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.tags.map((q,ne)=>e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-800 rounded-full",children:[e.jsx("span",{className:"text-sm",children:q}),e.jsx("button",{onClick:()=>A(q),className:"text-green-600 hover:text-green-800",children:e.jsx(ns,{size:12})})]},ne))})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(_t,{className:"mr-2",size:20}),"Languages"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("select",{value:d,onChange:q=>v(q.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select language"}),$.map(q=>e.jsx("option",{value:q,children:q},q))]}),e.jsx("button",{onClick:L,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:e.jsx(fs,{size:16})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.languages.map((q,ne)=>e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1 bg-purple-100 text-purple-800 rounded-full",children:[e.jsx("span",{className:"text-sm",children:q}),e.jsx("button",{onClick:()=>D(q),className:"text-purple-600 hover:text-purple-800",children:e.jsx(ns,{size:12})})]},ne))})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ct,{className:"mr-2",size:20}),"Certifications"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:x,onChange:q=>u(q.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Add certification",onKeyPress:q=>q.key==="Enter"&&I()}),e.jsx("button",{onClick:I,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:e.jsx(fs,{size:16})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.certifications.map((q,ne)=>e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1 bg-orange-100 text-orange-800 rounded-full",children:[e.jsx("span",{className:"text-sm",children:q}),e.jsx("button",{onClick:()=>H(q),className:"text-orange-600 hover:text-orange-800",children:e.jsx(ns,{size:12})})]},ne))})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ws,{className:"mr-2",size:20}),"Description"]}),e.jsx("textarea",{value:i.description,onChange:q=>T("description",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4,placeholder:"Brief description about the vendor and services..."})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(at,{className:"mr-2",size:20}),"Verification & Status"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:i.verified,onChange:q=>T("verified",q.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Verified Vendor"})]}),e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:i.reExpertVerified,onChange:q=>T("reExpertVerified",q.target.checked),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(va,{className:"text-purple-600",size:16}),e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"RE Expert Verified"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:i.reSuggested,onChange:q=>T("reSuggested",q.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"text-green-600",size:16}),e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:"RE Suggested"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:i.status,onChange:q=>T("status",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"})]})]})]})]})]})]})}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"All required fields must be filled"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:K,disabled:c||!i.name.trim()||!i.businessName.trim()||!i.phone.trim()||!i.email.trim(),className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:c?"Saving...":t?"Update Vendor":"Save Vendor"})]})]})]})})]})}):null},xc=[{id:"all",label:"All Vendors",icon:Yt,count:28,color:"blue"},{id:"plumber",label:"Plumber",icon:nn,count:5,color:"blue"},{id:"tiles",label:"Tiles & Flooring",icon:yt,count:4,color:"green"},{id:"painter",label:"Painter",icon:Vc,count:6,color:"purple"},{id:"carpenter",label:"Carpenter",icon:Su,count:4,color:"orange"},{id:"interior",label:"Interior Designer",icon:yt,count:5,color:"pink"},{id:"waterproofing",label:"Water Proofing",icon:fl,count:2,color:"cyan"},{id:"electrician",label:"Electrician",icon:Ft,count:2,color:"yellow"}],Ci={blue:{bg:"bg-blue-100",text:"text-blue-700",pillBg:"bg-blue-200",iconText:"text-blue-600"},green:{bg:"bg-green-100",text:"text-green-700",pillBg:"bg-green-200",iconText:"text-green-600"},purple:{bg:"bg-purple-100",text:"text-purple-700",pillBg:"bg-purple-200",iconText:"text-purple-600"},orange:{bg:"bg-orange-100",text:"text-orange-700",pillBg:"bg-orange-200",iconText:"text-orange-600"},pink:{bg:"bg-pink-100",text:"text-pink-700",pillBg:"bg-pink-200",iconText:"text-pink-600"},cyan:{bg:"bg-cyan-100",text:"text-cyan-700",pillBg:"bg-cyan-200",iconText:"text-cyan-600"},yellow:{bg:"bg-yellow-100",text:"text-yellow-700",pillBg:"bg-yellow-200",iconText:"text-yellow-600"},default:{bg:"bg-gray-100",text:"text-gray-700",pillBg:"bg-gray-200",iconText:"text-gray-600"}},i1=()=>{const[s,a]=l.useState(""),[t,r]=l.useState("all"),[i,n]=l.useState(!1),[o,m]=l.useState(null),[g,b]=l.useState(!1),[d,v]=l.useState("grid"),[x,u]=l.useState([]),[c,f]=l.useState([{id:1,salutation:"Mr.",name:"Rajesh Kumar",businessName:"Rajesh Plumbing Services",category:"plumber",countryCode:"+91",phone:"9876543210",whatsapp:"9876543210",email:"rajesh.plumber@email.com",address:"Shop 15, Andheri West, Mumbai",rating:4.8,experience:12,verified:!0,reExpertVerified:!0,reSuggested:!0,services:[{name:"Pipe Fitting",rate:"â‚¹800-1200",unit:"per point",description:"Professional pipe fitting and connection"},{name:"Leak Repair",rate:"â‚¹500-800",unit:"per repair",description:"Quick leak detection and repair"},{name:"Bathroom Installation",rate:"â‚¹15000-25000",unit:"lumpsum",description:"Complete bathroom plumbing setup"},{name:"Kitchen Plumbing",rate:"â‚¹8000-15000",unit:"lumpsum",description:"Kitchen sink and appliance connections"}],tags:["24/7 Service","Emergency","Licensed","Insured","Warranty"],rateIdea:"â‚¹500-1500 per visit",portfolio:["https://images.pexels.com/photos/1129019/pexels-photo-1129019.jpeg?auto=compress&cs=tinysrgb&w=400","https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=400"],description:"Professional plumbing services with 12+ years experience. Specializes in residential and commercial plumbing solutions with 24/7 emergency support.",availability:{days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],startTime:"08:00",endTime:"20:00",weeklyOff:"Sunday"},languages:["Hindi","English","Marathi"],certifications:["Licensed Plumber","Safety Certified","Insurance Approved"],completedProjects:450,responseTime:"30 minutes",created_at:"2025-01-01",lastActive:"2025-01-12",status:"active"},{id:2,salutation:"Mr.",name:"Suresh Patel",businessName:"Premium Tiles & Marble",category:"tiles",countryCode:"+91",phone:"8765432109",whatsapp:"8765432109",email:"premium.tiles@email.com",address:"Showroom 5, Bandra East, Mumbai",rating:4.9,experience:15,verified:!0,reExpertVerified:!0,reSuggested:!0,services:[{name:"Tile Installation",rate:"â‚¹80-150",unit:"per sq ft",description:"Professional tile laying and installation"},{name:"Marble Flooring",rate:"â‚¹200-500",unit:"per sq ft",description:"Premium marble flooring installation"},{name:"Wall Tiling",rate:"â‚¹60-120",unit:"per sq ft",description:"Wall tile installation with perfect alignment"},{name:"Bathroom Tiling",rate:"â‚¹25000-45000",unit:"lumpsum",description:"Complete bathroom tiling solution"}],tags:["Premium Quality","Designer Tiles","5 Year Warranty","Installation Included"],rateIdea:"â‚¹80-300 per sq ft",portfolio:["https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=400","https://images.pexels.com/photos/1129019/pexels-photo-1129019.jpeg?auto=compress&cs=tinysrgb&w=400"],description:"Premium tiles and marble installation with designer collections. Expert in luxury flooring solutions with extensive showroom and quality materials.",availability:{days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],startTime:"09:00",endTime:"19:00",weeklyOff:"Sunday"},languages:["Hindi","English","Gujarati"],certifications:["Certified Installer","Quality Assured","Showroom Partner"],completedProjects:320,responseTime:"1 hour",created_at:"2025-01-02",lastActive:"2025-01-11",status:"active"},{id:3,salutation:"Mr.",name:"Amit Sharma",businessName:"Color Magic Painters",category:"painter",countryCode:"+91",phone:"7654321098",whatsapp:"7654321098",email:"colormagic@email.com",address:"Office 12, Powai, Mumbai",rating:4.7,experience:8,verified:!0,reExpertVerified:!1,reSuggested:!1,services:[{name:"Interior Painting",rate:"â‚¹18-35",unit:"per sq ft",description:"Premium interior wall painting"},{name:"Exterior Painting",rate:"â‚¹25-45",unit:"per sq ft",description:"Weather resistant exterior painting"},{name:"Texture Work",rate:"â‚¹35-60",unit:"per sq ft",description:"Designer texture and pattern work"},{name:"Complete Home Painting",rate:"â‚¹80000-150000",unit:"lumpsum",description:"Full home painting package"}],tags:["Asian Paints Dealer","Texture Expert","Quick Service","2 Year Warranty"],rateIdea:"â‚¹18-45 per sq ft",portfolio:["https://images.pexels.com/photos/1129019/pexels-photo-1129019.jpeg?auto=compress&cs=tinysrgb&w=400"],description:"Professional painting services with expertise in interior and exterior painting. Asian Paints authorized dealer with quality materials and skilled workforce.",availability:{days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],startTime:"08:00",endTime:"18:00",weeklyOff:"Sunday"},languages:["Hindi","English"],certifications:["Asian Paints Certified","Color Consultant"],completedProjects:280,responseTime:"2 hours",created_at:"2025-01-03",lastActive:"2025-01-10",status:"active"}]),p=c.filter(W=>{const B=s.trim().toLowerCase(),M=!B||W.name.toLowerCase().includes(B)||W.businessName&&W.businessName.toLowerCase().includes(B)||W.services.some(L=>L.name.toLowerCase().includes(B))||W.tags.some(L=>L.toLowerCase().includes(B)),A=t==="all"||W.category===t;return M&&A}),N=()=>{m(null),n(!0)},P=W=>{m(W),n(!0)},w=W=>{window.confirm("Are you sure you want to delete this vendor?")&&f(B=>B.filter(M=>M.id!==W))},$=W=>{if(o)f(B=>B.map(M=>M.id===o.id?{...W,id:o.id}:M));else{const B=c.length>0?Math.max(...c.map(A=>A.id))+1:1,M={...W,id:B};f(A=>[...A,M])}n(!1),m(null)},y=W=>{f(B=>B.map(M=>M.id===W?{...M,reExpertVerified:!M.reExpertVerified}:M))},k=W=>{f(B=>B.map(M=>M.id===W?{...M,reSuggested:!M.reSuggested}:M))},R=(W,B)=>{if(!W)return;const M=`Hi ${B||"there"}, I found your contact through ResaleExpert. I would like to discuss my requirements.`,A=`https://wa.me/91${W}?text=${encodeURIComponent(M)}`;window.open(A,"_blank")},F=(W,B)=>{if(!W)return;const M="Inquiry from ResaleExpert",A=`Hi ${B||"there"},

I found your contact through ResaleExpert. I would like to discuss my requirements.

Best regards`,L=`mailto:${W}?subject=${encodeURIComponent(M)}&body=${encodeURIComponent(A)}`;window.open(L,"_blank")},T=()=>{if(x.length===0){alert("Please select vendors to send");return}c.filter(W=>x.includes(W.id)),alert(`${x.length} vendors sent to seller account directory`),u([])},j=W=>{u(B=>B.includes(W)?B.filter(M=>M!==W):[...B,W])},E=W=>{const B=xc.find(M=>M.id===W);return(B==null?void 0:B.icon)??Yt},V=W=>{const B=xc.find(M=>M.id===W);return(B==null?void 0:B.color)??"default"};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 sm:px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start sm:items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl shrink-0",children:e.jsx(Ns,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Vendor Directory"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Manage trusted vendors and service providers"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[x.length>0&&e.jsxs("button",{onClick:T,className:"flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors w-full sm:w-auto",children:[e.jsx(Dt,{size:16}),e.jsxs("span",{children:["Send to Seller (",x.length,")"]})]}),e.jsxs("button",{className:"flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors w-full sm:w-auto",children:[e.jsx(dt,{size:16}),e.jsx("span",{children:"Import"})]}),e.jsxs("button",{onClick:N,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Vendor"})]})]})]}),e.jsx("div",{className:"mt-5",children:e.jsx("div",{role:"tablist","aria-label":"Vendor categories",className:"flex gap-2 overflow-x-auto pb-1 -mx-4 sm:mx-0 px-4 sm:px-0 no-scrollbar",children:xc.map(W=>{const B=W.icon,M=W.color,A=Ci[M]??Ci.default,L=t===W.id;return e.jsxs("button",{role:"tab","aria-selected":L,onClick:()=>r(W.id),className:`shrink-0 flex items-center gap-2 px-4 py-2 rounded-lg transition-colors whitespace-nowrap border
              ${L?`${A.bg} ${A.text} ${A.pillBg}`:"text-gray-700 bg-white hover:bg-gray-100 border-gray-200"}`,children:[e.jsx(B,{size:16}),e.jsx("span",{className:"font-medium",children:W.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs
              ${L?A.pillBg:"bg-gray-200 text-gray-800"}`,children:W.count})]},W.id)})})})]}),e.jsx("div",{className:"bg-white border-b border-gray-200 px-4 sm:px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex w-full items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"relative flex-1 min-w-0",children:[e.jsx(it,{"aria-hidden":!0,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search vendors, services, tags...",value:s,onChange:W=>a(W.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("button",{onClick:()=>b(!g),className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 shrink-0","aria-pressed":g,children:[e.jsx(Na,{size:16}),e.jsx("span",{className:"hidden xs:inline",children:"Filters"})]})]}),e.jsxs("div",{className:"flex w-full sm:w-auto items-center justify-between sm:justify-end gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 rounded-lg p-1 shrink-0",children:[e.jsx("button",{onClick:()=>v("grid"),className:`p-2 rounded ${d==="grid"?"bg-white shadow-sm":""}`,"aria-pressed":d==="grid","aria-label":"Grid view",children:e.jsx(Uc,{size:16,className:d==="grid"?"text-blue-600":"text-gray-400"})}),e.jsx("button",{onClick:()=>v("list"),className:`p-2 rounded ${d==="list"?"bg-white shadow-sm":""}`,"aria-pressed":d==="list","aria-label":"List view",children:e.jsx(dn,{size:16,className:d==="list"?"text-blue-600":"text-gray-400"})})]}),e.jsxs("button",{className:"flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 w-auto sm:w-auto",children:[e.jsx(Ys,{size:16}),e.jsx("span",{className:"hidden xs:inline",children:"Export"})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:p.map(W=>{var D,I,H;const B=E(W.category),M=V(W.category),A=Ci[M]??Ci.default,L=x.includes(W.id);return e.jsxs("div",{className:`bg-white rounded-xl shadow-sm border-2 transition-all hover:shadow-lg ${L?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:L,onChange:()=>j(W.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("div",{className:`${A.bg} p-2 rounded-lg`,children:e.jsx(B,{className:A.iconText??"text-gray-600",size:20})})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[W.verified&&e.jsx(bs,{className:"text-blue-500",size:16,role:"img","aria-label":"Verified"}),W.reExpertVerified&&e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full",children:[e.jsx(va,{className:"text-white",size:12}),e.jsx("span",{className:"text-white text-xs font-bold",children:"RE EXPERT"})]}),W.reSuggested&&e.jsx("div",{className:"px-2 py-1 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"RE SUGGESTED"})}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-1 rounded hover:bg-gray-100",children:e.jsx(xr,{size:16})}),e.jsx("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10 w-48",children:e.jsxs("div",{className:"p-1",children:[e.jsxs("button",{onClick:()=>P(W),className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(ft,{size:14}),e.jsx("span",{children:"Edit Vendor"})]}),e.jsxs("button",{onClick:()=>y(W.id),className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(va,{size:14}),e.jsx("span",{children:W.reExpertVerified?"Remove RE Expert":"Make RE Expert"})]}),e.jsxs("button",{onClick:()=>k(W.id),className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded w-full text-left",children:[e.jsx(Ct,{size:14}),e.jsx("span",{children:W.reSuggested?"Remove RE Suggested":"Make RE Suggested"})]}),e.jsxs("button",{onClick:()=>w(W.id),className:"flex items-center space-x-2 px-3 py-2 text-sm text-red-600 hover:bg-red-100 rounded w-full text-left",children:[e.jsx(Es,{size:14}),e.jsx("span",{children:"Delete Vendor"})]})]})})]})]})]}),e.jsxs("h3",{className:"font-bold text-gray-900 mb-1",children:[W.salutation," ",W.name]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:W.businessName}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Xs,{className:"text-yellow-500",size:14}),e.jsx("span",{className:"text-sm font-medium",children:W.rating})]}),e.jsx("span",{className:"text-gray-300",children:"â€¢"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[W.experience," years"]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 mb-3",children:[e.jsx(Qs,{size:12}),e.jsx("span",{className:"truncate",children:W.address})]}),e.jsx("div",{className:"text-sm font-medium text-green-600 mb-3",children:W.rateIdea}),e.jsxs("div",{className:"text-xs text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ls,{size:10}),e.jsxs("span",{children:[(D=W.availability)==null?void 0:D.startTime," - ",(I=W.availability)==null?void 0:I.endTime]})]}),e.jsxs("div",{children:["Weekly Off: ",(H=W.availability)==null?void 0:H.weeklyOff]})]})]}),e.jsxs("div",{className:"p-4 border-b border-gray-100",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Services & Rates"}),e.jsxs("div",{className:"space-y-2",children:[W.services.slice(0,2).map((h,Y)=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:h.name}),e.jsx("div",{className:"text-xs text-gray-600",children:h.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-bold text-green-600",children:h.rate}),e.jsx("div",{className:"text-xs text-gray-500",children:h.unit})]})]})},Y)),W.services.length>2&&e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",W.services.length-2," more services"]})]})]}),e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[W.tags.slice(0,3).map((h,Y)=>e.jsx("span",{className:`px-2 py-1 ${A.pillBg} ${A.text} rounded-full text-xs font-medium`,children:h},Y)),W.tags.length>3&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-full text-xs",children:["+",W.tags.length-3]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>R(W.whatsapp,W.name),className:"flex-1 flex items-center justify-center space-x-2 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(tt,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:"WhatsApp"})]}),e.jsxs("button",{onClick:()=>F(W.email,W.name),className:"flex-1 flex items-center justify-center space-x-2 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ds,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:"Email"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 text-xs text-gray-500",children:[e.jsxs("span",{children:[W.completedProjects," projects"]}),e.jsxs("span",{children:["Response: ",W.responseTime]})]})]})]},W.id)})})}),i&&e.jsx(n1,{isOpen:i,onClose:()=>{n(!1),m(null)},vendor:o,onSave:$})]})};function o1({formData:s,setFormData:a,endpoint:t}){const[r,i]=l.useState(!1),[n,o]=l.useState(!1),[m,g]=l.useState(()=>s.content??""),[b,d]=l.useState(()=>s.subject??""),[v,x]=l.useState("friendly"),[u,c]=l.useState("English"),[f,p]=l.useState("short"),[N,P]=l.useState(null),w=l.useRef(null),$=l.useRef(null),[y,k]=l.useState(null),[R,F]=l.useState(typeof window<"u"?window.innerWidth<640:!1);l.useEffect(()=>{const E=s.content??"";E!==m&&g(E)},[s.content]),l.useEffect(()=>{const E=s.subject??"";E!==b&&d(E)},[s.subject]),l.useEffect(()=>{const E=s.content??"";m!==E&&a(V=>({...V,content:m}))},[m]),l.useEffect(()=>{(s.subject??"")!==b&&a(V=>({...V,subject:b}))},[b]),l.useEffect(()=>{const E=()=>{F(window.innerWidth<640),n&&T()};return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[n]),l.useEffect(()=>{if(!n)return;const E=W=>{const B=W.target;$.current&&w.current&&!$.current.contains(B)&&!w.current.contains(B)&&o(!1)},V=W=>{W.key==="Escape"&&o(!1)};return document.addEventListener("mousedown",E),document.addEventListener("keydown",V),()=>{document.removeEventListener("mousedown",E),document.removeEventListener("keydown",V)}},[n]);const T=()=>{const E=w.current;if(!E){k(null);return}const V=E.getBoundingClientRect(),W=window.innerWidth,B=window.innerHeight,M=Math.min(340,Math.max(260,Math.floor(W*.28))),A=220,L=8,D=V.top,I=B-V.bottom,h=D>A+L+10||D>=I?Math.max(8,V.top-A-L):Math.min(B-A-8,V.bottom+L);let Y=V.right-M;Y<8&&(Y=8),Y+M>W-8&&(Y=W-M-8),k({position:"fixed",top:`${h}px`,left:`${Y}px`,width:`${M}px`,height:`${A}px`,zIndex:9999,boxShadow:"0 8px 40px rgba(17,24,39,0.12)",overflow:"hidden",borderRadius:8,background:"white",border:"1px solid rgba(0,0,0,0.06)"})};l.useEffect(()=>{n&&T()},[n,R]);async function j(){var B,M,A,L,D,I,H,h,Y,K,q,ne;if(r)return;P(null);const E=((L=(A=(M=(B=s.channel)==null?void 0:B.toString)==null?void 0:M.call(B))==null?void 0:A.trim)==null?void 0:L.call(A))||"",V=((h=(H=(I=(D=s.category)==null?void 0:D.toString)==null?void 0:I.call(D))==null?void 0:H.trim)==null?void 0:h.call(H))||"",W=((ne=(q=(K=(Y=s.priority)==null?void 0:Y.toString)==null?void 0:K.call(Y))==null?void 0:q.trim)==null?void 0:ne.call(q))||"";if(!E){P("Please select channel (sms/whatsapp/email)."),o(!0);return}if(!b&&!V){P("Provide at least one: Content Subject or Category to generate a template."),o(!0);return}i(!0);try{const C=await fetch(t??"/api/ai/generate-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:b||void 0,channel:E,category:V||void 0,priority:W||void 0,tone:v,lang:u,length:f})}),J=await C.text();if(!C.ok)try{const Q=JSON.parse(J);throw new Error((Q==null?void 0:Q.error)||(Q==null?void 0:Q.message)||`Request failed (${C.status})`)}catch{throw new Error(J||`Request failed (${C.status})`)}let ue="";try{const Q=JSON.parse(J);ue=(Q==null?void 0:Q.content)??(Q==null?void 0:Q.generated)??(Q==null?void 0:Q.template)??""}catch{throw new Error("Invalid JSON returned from server.")}if(!ue)throw new Error("AI returned empty content.");a(Q=>{var ge,ee,de;const he=((de=(ee=(ge=Q.content)==null?void 0:ge.toString())==null?void 0:ee.trim)==null?void 0:de.call(ee))||"",se=he?`${he}

${ue}`:ue;return{...Q,content:se}}),g(Q=>{var se,ge;const he=((ge=(se=Q==null?void 0:Q.toString())==null?void 0:se.trim)==null?void 0:ge.call(se))||"";return he?`${he}

${ue}`:ue}),o(!1)}catch(le){const S=(le==null?void 0:le.message)||"Failed to generate template. Please try again.";P(S),o(!0)}finally{i(!1)}}return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:m,onChange:E=>g(E.target.value),className:"w-full px-3 py-3 pr-32 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[140px]",placeholder:"Template content will appear here. You can edit it after generation."}),e.jsx("button",{ref:w,type:"button",onClick:()=>{o(E=>{const V=!E;return V&&setTimeout(()=>T(),0),V})},disabled:r,"aria-expanded":n,"aria-controls":"ai-settings-panel",className:"absolute bottom-2 right-2 inline-flex items-center gap-2 rounded-md border border-gray-200 bg-white/90 px-3 py-1.5 text-sm font-medium shadow-sm hover:bg-white disabled:opacity-50",children:r?e.jsxs(e.Fragment,{children:[e.jsx(Kr,{className:"h-4 w-4 animate-spin"}),"Generatingâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx(Al,{className:"h-4 w-4"}),"Generate with AI"]})}),n&&e.jsxs(e.Fragment,{children:[R&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-[9998]",onClick:()=>o(!1),"aria-hidden":!0}),e.jsxs("div",{id:"ai-settings-panel",ref:$,role:"dialog","aria-modal":R?"true":"false",className:`bg-white rounded shadow-lg border border-gray-200 z-[9999] ${R?"fixed inset-x-4 top-20 mx-auto max-w-md p-3":"p-0 overflow-hidden"}`,style:R?void 0:y??{position:"fixed",top:"calc(50% - 110px)",left:"calc(50% - 180px)",width:"220px",height:"220px",zIndex:9999},children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[e.jsxs("span",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(ro,{className:"h-4 w-4"}),"AI Settings"]}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"p-1 rounded hover:bg-gray-100","aria-label":"Close",children:e.jsx(ns,{className:"h-4 w-4 text-gray-500"})})]}),e.jsxs("div",{className:"p-3 pb-0 space-y-2",style:{maxHeight:176,overflowY:"auto"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-gray-600 block mb-1",children:"Content Subject*"}),e.jsx("input",{type:"text",value:b,onChange:E=>d(E.target.value),placeholder:"Enter your content subject",className:"w-full border rounded px-2 py-1 text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-gray-600 block mb-1",children:"Tone"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1 text-xs",value:v,onChange:E=>x(E.target.value),children:[e.jsx("option",{value:"friendly",children:"Friendly"}),e.jsx("option",{value:"formal",children:"Formal"}),e.jsx("option",{value:"marketing",children:"Marketing"}),e.jsx("option",{value:"concise",children:"Concise"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-gray-600 block mb-1",children:"Language"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1 text-xs",value:u,onChange:E=>c(E.target.value),children:[e.jsx("option",{children:"English"}),e.jsx("option",{children:"Hindi"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] text-gray-600 block mb-1",children:"Length"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1 text-xs",value:f,onChange:E=>p(E.target.value),children:[e.jsx("option",{value:"short",children:"Short"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"long",children:"Long"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:j,disabled:r,className:"inline-flex items-center gap-2 rounded bg-blue-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-blue-700 disabled:opacity-60",children:r?e.jsxs(e.Fragment,{children:[e.jsx(Kr,{className:"h-4 w-4 animate-spin"}),"Generatingâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx(Al,{className:"h-4 w-4"}),"Generate"]})})}),N&&e.jsx("p",{className:"text-xs text-red-600 break-words",children:N})]})]})]})]}),e.jsx("p",{className:"text-[11px] text-gray-500",children:"Tip: Provide a content subject or a category and select the channel for best results."})]})}const qx={sms:[{key:"{name}",desc:"Recipient name",cat:"Basic"},{key:"{otp}",desc:"One-time password",cat:"Security"},{key:"{order_id}",desc:"Order ID",cat:"Order"},{key:"{amount}",desc:"Amount",cat:"Order"},{key:"{store_name}",desc:"Store name",cat:"Business"},{key:"{date}",desc:"Date",cat:"Time"},{key:"{time}",desc:"Time",cat:"Time"}],whatsapp:[{key:"{name}",desc:"Recipient name",cat:"Basic"},{key:"{order_id}",desc:"Order ID",cat:"Order"},{key:"{product_name}",desc:"Product name",cat:"Order"},{key:"{amount}",desc:"Amount",cat:"Order"},{key:"{cta_url}",desc:"CTA URL",cat:"Marketing"},{key:"{coupon_code}",desc:"Coupon code",cat:"Marketing"}],email:[{key:"{name}",desc:"Recipient name",cat:"Basic"},{key:"{first_name}",desc:"First name",cat:"Basic"},{key:"{subject}",desc:"Subject line",cat:"Basic"},{key:"{invoice_id}",desc:"Invoice ID",cat:"Billing"},{key:"{amount}",desc:"Amount",cat:"Billing"},{key:"{unsubscribe_link}",desc:"Unsubscribe",cat:"Compliance"}]},Vx=({children:s,className:a=""})=>e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${a}`,children:s});function c1({channel:s,onInsert:a}){const[t,r]=l.useState(""),[i,n]=l.useState(""),[o,m]=l.useState("All"),g=qx[s]||qx.sms,b=l.useMemo(()=>["All",...Array.from(new Set(g.map(x=>x.cat)))],[g]),d=l.useMemo(()=>{let x=g;if(o!=="All"&&(x=x.filter(c=>c.cat===o)),!t)return x;const u=t.toLowerCase();return x.filter(c=>c.key.toLowerCase().includes(u)||c.desc.toLowerCase().includes(u))},[g,t,o]),v=async x=>{try{navigator.clipboard&&navigator.clipboard.writeText&&(await navigator.clipboard.writeText(x),n(x),setTimeout(()=>n(""),800))}catch{}};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("h4",{className:"font-medium text-gray-800 text-xs",children:"Variables"}),e.jsx("select",{value:o,onChange:x=>m(x.target.value),className:"px-2 py-1 text-xs border rounded-md bg-white","aria-label":"Variable category filter",children:b.map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsx("div",{className:"relative",children:e.jsx("input",{value:t,onChange:x=>r(x.target.value),placeholder:"Search variables...",className:"w-full px-2.5 py-2 text-xs border rounded-lg focus:ring-2 focus:ring-blue-500","aria-label":"Search variables"})}),e.jsxs("div",{className:"max-h-56 overflow-auto space-y-1 pr-0.5",children:[d.map(x=>e.jsxs("div",{className:"group flex items-center gap-2 p-2 rounded-lg border bg-white hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("code",{className:"text-[11px] bg-blue-50 text-blue-700 px-1.5 py-0.5 rounded font-mono",children:x.key}),e.jsx("div",{className:"text-[10px] text-gray-500 truncate mt-1",children:x.desc})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>v(x.key),className:"p-1 rounded hover:bg-gray-200",title:"Copy",type:"button",children:i===x.key?e.jsx(_a,{className:"w-3 h-3 text-green-600"}):e.jsx(Xt,{className:"w-3 h-3 text-gray-500"})}),e.jsx("button",{onClick:()=>a(x.key),className:"p-1 rounded hover:bg-blue-100 text-blue-600",title:"Insert",type:"button",children:e.jsx(fs,{className:"w-3 h-3"})})]})]},x.key)),d.length===0&&e.jsx("div",{className:"text-[11px] text-gray-500 py-4 text-center",children:"No variables match your search."})]})]})}function Wx({open:s,onClose:a,onSubmit:t,channel:r="sms",initial:i=null,title:n}){const[o,m]=l.useState(""),[g,b]=l.useState(""),[d,v]=l.useState(""),[x,u]=l.useState("Normal"),[c,f]=l.useState(!1),[p,N]=l.useState("pending"),[P,w]=l.useState(!1),[$,y]=l.useState(!1),k=l.useRef(null),[R,F]=l.useState(!0),[T,j]=l.useState({});l.useEffect(()=>{(async()=>{try{F(!0);const L=await Gt(["common"]);j(L)}catch(L){console.error("Error fetching master options:",L)}finally{F(!1)}})()},[]);const E=l.useMemo(()=>{var L;return((L=T==null?void 0:T.common)==null?void 0:L.category)??(T==null?void 0:T.category)??[]},[T]),V=l.useMemo(()=>r==="sms"?1e3:r==="whatsapp"?2e3:5e3,[r]),W=V-d.length;l.useEffect(()=>{s&&(i?(m(i.name??""),b(i.category??""),v(i.content??""),u(i.priority??"Normal"),f(!!i.autoApprove),N(i.status??(i.autoApprove?"approved":"pending"))):(m(""),b(""),v(""),u("Normal"),f(!1),N("pending")))},[s,i]),l.useEffect(()=>{!R&&(i!=null&&i.category)&&((E||[]).some(D=>D.value===i.category)||j(D=>{var I;return{...D,common:{...D.common||{},category:[{value:i.category,label:i.category},...((I=D.common)==null?void 0:I.category)||[]]}}}))},[R,i,E.length]),l.useEffect(()=>{if(!s)return;const A=L=>{L.key==="Escape"&&(a==null||a())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[s,a]);const B=A=>{const L=k.current;if(!L){v(h=>h+A);return}const D=typeof L.selectionStart=="number"?L.selectionStart:d.length,I=typeof L.selectionEnd=="number"?L.selectionEnd:d.length,H=d.slice(0,D)+A+d.slice(I);v(H),requestAnimationFrame(()=>{L.focus();const h=D+A.length;try{L.setSelectionRange(h,h)}catch{}})},M=A=>{var L;if((L=A==null?void 0:A.preventDefault)==null||L.call(A),!o.trim()||!g||!d.trim()){console.warn("Validation failed â€” required fields missing",{name:o,category:g,content:d});return}w(!0),setTimeout(()=>{const D={id:i==null?void 0:i.id,name:o.trim(),category:g,content:d,priority:x,autoApprove:c,status:c?"approved":p,channel:r,updatedAt:new Date().toISOString()};t==null||t(D),w(!1),a==null||a()},250)};return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[1.5px]",onClick:a}),e.jsxs("div",{role:"dialog","aria-modal":"true",className:"relative bg-white w-full max-w-2xl md:max-w-3xl rounded-2xl shadow-2xl border overflow-hidden animate-in fade-in zoom-in-95 flex flex-col max-h-[88vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 border-b bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base truncate",children:n||(i?"Edit Template":"Create Template")}),e.jsxs("p",{className:"text-[11px] text-gray-500 capitalize",children:[r," Template"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsxs(Vx,{className:"bg-emerald-100 text-emerald-700",children:[e.jsx(at,{className:"w-3.5 h-3.5 mr-1"})," Auto-approve ON"]}):e.jsxs(Vx,{className:"bg-amber-100 text-amber-700",children:[e.jsx(Ft,{className:"w-3.5 h-3.5 mr-1"})," Manual review"]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-white transition-colors","aria-label":"Close",type:"button",children:e.jsx(ns,{className:"w-5 h-5 text-gray-600"})})]})]}),e.jsx("form",{onSubmit:M,className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-3 md:p-4 space-y-4 pt-0 md:pt-0",children:[e.jsxs("button",{type:"button",onClick:()=>y(A=>!A),className:"md:hidden inline-flex items-center justify-between w-full text-xs px-3 py-2 rounded-lg border bg-gray-50","aria-expanded":$,children:["Variables",e.jsx(ea,{className:`w-4 h-4 transition ${$?"rotate-180":""}`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Template Name"}),e.jsx("input",{type:"text",value:o,onChange:A=>m(A.target.value),className:"w-60 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Enter template name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{value:g,onChange:A=>b(A.target.value),className:"w-60 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-sm",required:!0,disabled:R||E.length===0,children:[e.jsx("option",{value:"",children:"Select category"}),E.map(A=>e.jsx("option",{value:A.value,children:A.label??A.value},A.value))]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Template Content"}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:["Limit ",V.toLocaleString()," â€¢",e.jsxs("span",{className:`ml-1 ${W<100?"text-red-600 font-medium":"text-gray-500"}`,children:[W," left"]})]})]})]}),e.jsxs("div",{children:[e.jsx(o1,{formData:{content:d,name:o,channel:r,category:g,priority:x},setFormData:A=>{const L=typeof A=="function"?A({content:d,name:o,channel:r,category:g,priority:x}):A;L&&(typeof L.content<"u"&&v(L.content),typeof L.name<"u"&&m(L.name),typeof L.category<"u"&&b(L.category),typeof L.priority<"u"&&u(L.priority))},endpoint:"/api/ai/generate-template"}),e.jsx("textarea",{ref:k,value:d,onChange:A=>v(A.target.value),className:"hidden","aria-hidden":!0})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs text-gray-700",children:"Priority"}),e.jsxs("select",{value:x,onChange:A=>u(A.target.value),className:"px-3 py-1.5 text-xs border rounded-md bg-white",children:[e.jsx("option",{children:"Normal"}),e.jsx("option",{children:"High"}),e.jsx("option",{children:"Critical"})]})]}),e.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:c,onChange:A=>f(A.target.checked)}),e.jsx("span",{className:"w-9 h-5 bg-gray-200 rounded-full relative transition peer-checked:bg-emerald-500",children:e.jsx("span",{className:"absolute top-0.5 left-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform peer-checked:translate-x-4"})}),e.jsx("span",{className:"text-xs text-gray-700",children:"Auto-approve"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-xs text-gray-700",children:"Status"}),e.jsxs("select",{value:c?"approved":p,onChange:A=>N(A.target.value),className:"px-3 py-1.5 text-xs border rounded-md bg-white min-w-[120px]",disabled:c,title:"Status",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]})]}),e.jsx("div",{className:`md:col-span-1 bg-gray-50 rounded-lg p-3 border ${$?"block":"hidden"} md:block`,children:e.jsx(c1,{channel:r,onInsert:B})})]})]})}),e.jsx("div",{className:"p-3 md:p-4 border-t bg-white sticky bottom-0",children:e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row sm:justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Cancel"}),e.jsxs("button",{type:"submit",onClick:M,disabled:P,className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-60 text-sm",children:[P?e.jsx(Kr,{className:"w-4 h-4 animate-spin"}):e.jsx(ut,{className:"w-4 h-4"}),i?"Update":"Create"]})]})})]})]}):null}const Vl={add:async s=>(await Ae.post("/templates/add",s)).data,getAll:async()=>(await Ae.get("/templates/get-all")).data,getById:async s=>(await Ae.get("/templates/get/id",{params:{id:s}})).data,update:async(s,a)=>(await Ae.put(`/templates/update/${s}`,a)).data,delete:async s=>(await Ae.delete(`/templates/delete/${s}`)).data},d1=["Welcome","Security","Order","Payment","Marketing","Support","Delivery","Newsletter","Onboarding","Notification","Billing"],m1={approved:{color:"bg-green-100 text-green-800 border-green-200",icon:e.jsx(bs,{className:"w-4 h-4 text-green-600"}),label:"Approved"},pending:{color:"bg-yellow-100 text-yellow-800 border-yellow-200",icon:e.jsx(Ls,{className:"w-4 h-4 text-yellow-600"}),label:"Pending"},rejected:{color:"bg-red-100 text-red-800 border-red-200",icon:e.jsx(Ta,{className:"w-4 h-4 text-red-600"}),label:"Rejected"}};function Tl(...s){return s.filter(Boolean).join(" ")}function Mc(s){if(!s)return[];const a=new Set,t=/(\{[^}]+\}|\$\{[^}]+\}|#[a-zA-Z0-9_]+)/g;let r;for(;r=t.exec(s);)a.add(r[0]);return[...a]}function x1(s){return s?s.split(/(\{[^}]+\}|#[a-zA-Z0-9_]+|\$\{[^}]+\})/g).map((t,r)=>/^\{[^}]+\}$/.test(t)?e.jsx("span",{className:"bg-amber-100 text-amber-800 px-1 rounded font-mono",children:t},r):/^\$\{[^}]+\}$/.test(t)?e.jsx("span",{className:"bg-emerald-100 text-emerald-800 px-1 rounded font-mono",children:t},r):/^#[a-zA-Z0-9_]+$/.test(t)?e.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-1 rounded font-mono",children:t},r):e.jsx("span",{children:t},r)):null}function u1({toast:s,onClose:a}){return l.useEffect(()=>{const t=setTimeout(a,s.duration??1800);return()=>clearTimeout(t)},[s,a]),e.jsx("div",{className:"pointer-events-auto w-full max-w-xs overflow-hidden rounded-xl bg-white shadow-lg ring-1 ring-black/5",children:e.jsxs("div",{className:"p-3 flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:s.icon??e.jsx(bs,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{className:"w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.title}),s.message&&e.jsx("p",{className:"mt-0.5 text-xs text-gray-600",children:s.message})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 rounded p-1",children:e.jsx(ns,{className:"h-4 w-4"})})]})})}function uc({open:s,onClose:a,children:t,size:r="xl"}){if(!s)return null;const i=r==="lg"?"max-w-lg":r==="md"?"max-w-md":"max-w-xl";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:a}),e.jsx("div",{className:Tl("relative bg-white w-full mx-auto rounded-2xl shadow-xl border border-gray-200",i),children:t})]})}function g1(s,a=9){const[t,r]=l.useState(1),i=s.length,n=Math.max(1,Math.ceil(i/a)),o=l.useMemo(()=>{const m=(t-1)*a;return s.slice(m,m+a)},[s,t,a]);return l.useEffect(()=>{t>n&&r(1)},[n]),{page:t,setPage:r,pages:n,pageItems:o,total:i}}function kg({status:s}){const a=s&&m1[s]||{color:"bg-gray-100 text-gray-800 border-gray-200",label:s??"Unknown",icon:null};return e.jsxs("span",{className:Tl("inline-flex items-center gap-1 px-2 py-0.5 text-[11px] font-medium rounded-full border",a.color),children:[a.icon,e.jsx("span",{children:a.label})]})}function h1({children:s,className:a}){return e.jsx("span",{className:Tl("px-2 py-0.5 rounded-full border text-[11px]",a??""),children:s})}function p1({active:s,children:a}){return e.jsx("span",{className:Tl("ml-1 inline-flex items-center justify-center rounded-full px-2 py-0.5 text-[10px] sm:text-xs font-bold",s?"bg-white/25 text-white":"bg-gray-200 text-gray-700"),children:a})}function Hx({active:s,children:a,onClick:t,leftIcon:r,className:i,size:n="md",variant:o="solid"}){const m={sm:"px-3 py-2 text-xs",md:"px-4 py-2.5 text-sm"},g="inline-flex items-center justify-center gap-2 rounded-2xl font-semibold transition-all border",b=s?o==="solid"?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-blue-50 text-blue-700 border-blue-200 ring-1 ring-blue-200":o==="solid"?"bg-white text-gray-700 hover:bg-gray-50 border-gray-200":"bg-white text-gray-600 hover:text-gray-800 hover:bg-gray-50 border-transparent";return e.jsxs("button",{onClick:t,className:Tl(g,m[n],b,i??""),children:[r,a]})}function b1({template:s,onPreview:a,onEdit:t,onDuplicate:r,onDelete:i}){const n=Mc(s.content);return e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-all group",children:e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1 group-hover:text-blue-600 truncate text-sm sm:text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h1,{className:"bg-blue-50 border-blue-200 text-blue-700 font-semibold",children:s.category}),e.jsx(kg,{status:s.status})]})]})}),n.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:n.map(o=>e.jsx("span",{className:"text-[10px] bg-amber-50 text-amber-700 border border-amber-200 rounded px-1.5 py-0.5 font-mono",children:o},o))}),e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mb-3 line-clamp-3 leading-relaxed",children:s.content}),e.jsxs("div",{className:"text-[11px] text-gray-400 mb-3",children:["Created: ",s.createdAt?new Date(s.createdAt).toLocaleDateString():"-"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("button",{className:"flex-1 bg-blue-50 text-blue-600 px-2.5 py-1.5 rounded-lg hover:bg-blue-100 transition-colors flex items-center justify-center gap-1.5 font-medium text-xs sm:text-sm",onClick:a,children:[e.jsx(ks,{className:"w-4 h-4"})," Preview"]}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-blue-500 hover:bg-blue-50 rounded-lg",title:"Edit",onClick:t,children:e.jsx(ft,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg",title:"Duplicate",onClick:r,children:e.jsx(Xt,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",onClick:i,children:e.jsx(Es,{className:"w-4 h-4"})})]})]})})}function f1(){var de;const[s,a]=l.useState({sms:{created:[]},whatsapp:{created:[]},email:{created:[]}}),[t,r]=l.useState("sms"),[i,n]=l.useState("created"),[o,m]=l.useState(""),[g,b]=l.useState("all"),[d,v]=l.useState("all"),[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState(null),[P,w]=l.useState(null),[$,y]=l.useState(null),[k,R]=l.useState([]),[F,T]=l.useState(!1),[j,E]=l.useState(!1),V=l.useRef(null),W=((de=s[t])==null?void 0:de.created)??[],[B,M]=l.useState(!0),[A,L]=l.useState({});l.useEffect(()=>{(async()=>{try{M(!0);const X=await Gt(["common"]);L(X)}catch(X){console.error("Error fetching master options:",X)}finally{M(!1)}})()},[]);const D=(U=[])=>{const X={sms:[],whatsapp:[],email:[]};return U.forEach(re=>{const fe=(re.channel||re.type||re.channel_type||"email").toString().toLowerCase();fe.includes("sms")?X.sms.push(re):fe.includes("whatsapp")||fe.includes("wa")?X.whatsapp.push(re):X.email.push(re)}),{sms:{created:X.sms},whatsapp:{created:X.whatsapp},email:{created:X.email}}};l.useEffect(()=>{(async()=>{E(!0);try{const X=await Vl.getAll(),re=X&&typeof X=="object"&&Array.isArray(X.data)?X.data:Array.isArray(X)?X:(X==null?void 0:X.data)??X,fe=Array.isArray(re)?re:[],G=D(fe);a(G)}catch(X){console.error("Error fetching templates:",X),S({id:Math.random().toString(36).slice(2),title:"Failed to load templates",message:String(X)})}finally{E(!1)}})()},[]);const I=l.useMemo(()=>{let U=[...W];if(i==="pending"?U=U.filter(X=>X.status==="pending"):i==="approved"&&(U=U.filter(X=>X.status==="approved")),d!=="all"&&(U=U.filter(X=>X.status===d)),g!=="all"&&(U=U.filter(X=>X.category===g)),o){const X=o.toLowerCase();U=U.filter(re=>(re.name??"").toString().toLowerCase().includes(X)||(re.content??"").toString().toLowerCase().includes(X)||(re.category??"").toString().toLowerCase().includes(X))}return U.sort((X,re)=>{const fe=X.createdAt?new Date(X.createdAt).getTime():0;return(re.createdAt?new Date(re.createdAt).getTime():0)-fe}),U},[W,i,g,d,o]),{page:H,setPage:h,pages:Y,pageItems:K,total:q}=g1(I,9),ne=[{id:"sms",label:"SMS Templates",icon:e.jsx(Ui,{className:"w-4 h-4 sm:w-5 sm:h-5"}),count:s.sms.created.length},{id:"whatsapp",label:"WhatsApp Templates",icon:e.jsx(Bt,{className:"w-4 h-4 sm:w-5 sm:h-5"}),count:s.whatsapp.created.length},{id:"email",label:"Email Templates",icon:e.jsx(Ds,{className:"w-4 h-4 sm:w-5 sm:h-5"}),count:s.email.created.length}],le=[{id:"created",label:"All Template",icon:e.jsx(ks,{className:"w-4 h-4 text-blue-600"})},{id:"pending",label:"Pending Template",icon:e.jsx(Ls,{className:"w-4 h-4 text-yellow-600"})},{id:"approved",label:"Approved Template",icon:e.jsx(bs,{className:"w-4 h-4 text-green-600"})}];function S(U){const X=U.id??Math.random().toString(36).slice(2);R(re=>[...re,{id:X,...U}])}function C(U){R(X=>X.filter(re=>re.id!==U))}function J(U,X){a(re=>({...re,[X]:{...re[X],created:U}}))}async function ue(U){try{if(U.id){const X=U.id,re={...U},G=await Vl.update(String(X),re)??re,me=s[t].created.map(oe=>String(oe.id)===String(X)?G:oe);J(me,t),S({title:"Template updated",icon:e.jsx(zt,{className:"w-4 h-4 text-blue-600"})})}else{const X={...U,channel:t},fe=await Vl.add(X)??X;fe.createdAt=fe.createdAt??new Date().toISOString().slice(0,10),J([fe,...s[t].created],t),S({title:"Template created",icon:e.jsx(zt,{className:"w-4 h-4 text-blue-600"})})}}catch(X){console.error("Create/Update error:",X),S({title:"Save failed",message:String(X)})}finally{u(!1),N(null),n("created")}}async function Q(){if($)try{await Vl.delete(String($.id));const U=s[t].created.filter(X=>String(X.id)!==String($.id));J(U,t),S({id:Math.random().toString(36).slice(2),title:"Template deleted"})}catch(U){console.error("Delete error:",U),S({id:Math.random().toString(36).slice(2),title:"Delete failed",message:String(U)})}finally{y(null)}}async function he(U){try{const X={...U,name:`${U.name} (Copy)`,createdAt:new Date().toISOString().slice(0,10),channel:t};delete X.id;const fe=await Vl.add(X)??X;J([fe,...s[t].created],t),S({title:"Template duplicated"})}catch(X){console.error("Duplicate error:",X),S({title:"Duplicate failed",message:String(X)})}}async function se(U="json"){try{T(!0);const X=I;if(U==="json"){const re=new Blob([JSON.stringify(X,null,2)],{type:"application/json"}),fe=URL.createObjectURL(re),G=document.createElement("a");G.href=fe,G.download=`${t}-templates.json`,G.click(),URL.revokeObjectURL(fe)}else{const re=["id","name","category","status","createdAt","priority","autoApprove","content"],fe=X.map($e=>re.map(Le=>($e[Le]??"").toString().replace(/,/g,"\\,")).join(",")),G=[re.join(","),...fe].join(`
`),me=new Blob([G],{type:"text/csv"}),oe=URL.createObjectURL(me),Fe=document.createElement("a");Fe.href=oe,Fe.download=`${t}-templates.csv`,Fe.click(),URL.revokeObjectURL(oe)}S({title:`Exported ${U.toUpperCase()}`})}finally{T(!1)}}async function ge(U){if(!U)return;const X=U.name.toLowerCase().endsWith(".csv"),re=new FileReader;re.onload=async()=>{try{let fe=[];if(X){const me=typeof re.result=="string"?re.result:"",[oe,...Fe]=me.split(/\r?\n/).filter(Boolean),$e=oe.split(",").map(Le=>Le.trim());fe=Fe.map((Le,je)=>{const _e=Le.split(","),ve=Object.fromEntries($e.map((Pe,We)=>[Pe,_e[We]]));return{name:ve.name||`Imported ${je+1}`,content:ve.content||"",status:ve.status||"pending",createdAt:ve.createdAt||new Date().toISOString().slice(0,10),category:ve.category||"Marketing",priority:ve.priority||"Normal",autoApprove:ve.autoApprove==="true",channel:t}})}else{const me=typeof re.result=="string"?JSON.parse(re.result):re.result;fe=Array.isArray(me)?me:(me==null?void 0:me.created)||[],fe=fe.map((oe,Fe)=>({name:oe.name||`Imported ${Fe+1}`,content:oe.content||"",status:oe.status||"pending",createdAt:oe.createdAt||new Date().toISOString().slice(0,10),category:oe.category||"Marketing",priority:oe.priority||"Normal",autoApprove:!!oe.autoApprove,channel:t}))}if(fe.length===0){S({title:"Nothing to import",icon:e.jsx(zc,{className:"w-4 h-4 text-amber-600"})});return}const G=[];for(const me of fe)try{const oe=await Vl.add(me);G.push(oe??me)}catch(oe){console.warn("Failed to import item",me,oe)}G.length===0?S({title:"Import failed",message:"No items were saved to backend"}):(J([...G,...s[t].created],t),S({title:`Imported ${G.length} template(s)`,icon:e.jsx(dt,{className:"w-4 h-4 text-green-700"})}),f(!1))}catch(fe){S({title:"Import failed",message:String(fe)})}},re.readAsText(U)}const ee=U=>{var re;const X=((re=s[t])==null?void 0:re.created)||[];return U==="pending"?X.filter(fe=>fe.status==="pending").length:U==="approved"?X.filter(fe=>fe.status==="approved").length:X.length};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 shadow-md",children:e.jsx("div",{className:"max-w-6xl mx-auto px-3 sm:px-4",children:e.jsx("div",{className:"flex items-center justify-between h-16 sm:h-18",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(Bt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-white leading-tight flex items-center gap-2",children:["Template Center ",e.jsx(zt,{className:"w-4 h-4 text-white/80"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-blue-100",children:"Create, manage, and deploy templates"})]})]})})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-4 py-6 sm:py-8",children:[e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-1.5 sm:p-2",children:e.jsx("nav",{className:"grid grid-cols-1 sm:grid-cols-5 gap-1.5 sm:gap-2",children:ne.map(U=>{const X=t===U.id;return e.jsxs(Hx,{active:X,onClick:()=>{r(U.id),n("created"),m(""),b("all"),v("all"),h(1)},leftIcon:U.icon,size:"md",variant:"solid",className:"w-full",children:[e.jsx("span",{className:"truncate",children:U.label}),e.jsx(p1,{active:X,children:U.count})]},U.id)})})})}),e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-1.5 sm:p-2",children:e.jsx("nav",{role:"tablist",className:"grid lg:grid-cols-6 md:grid-cols-3 sm:grid-cols-1 gap-1.5 sm:gap-2",children:le.map(U=>{const X=i===U.id;return e.jsxs(Hx,{active:X,onClick:()=>n(U.id),leftIcon:U.icon,size:"sm",variant:"outline",className:Tl("w-full",X&&"shadow-[0_0_0_1px_rgba(59,130,246,.3)] bg-blue-50"),children:[e.jsx("span",{className:"truncate",children:U.label}),e.jsx("span",{className:Tl("ml-auto inline-flex items-center justify-center rounded-full px-2 py-0.5 text-[10px] font-bold",X?"bg-blue-200/80 text-blue-900":"bg-gray-200 text-gray-700"),children:ee(U.id)})]},U.id)})})})}),i!=="create"&&e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-2 sm:p-3 mb-3 sm:mb-6 sticky top-2 z-10",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"relative w-full sm:w-auto min-w-[200px]",children:[e.jsx(it,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:o,onChange:U=>m(U.target.value),placeholder:"Search templates...",className:"pl-9 pr-3 py-1.5 w-full border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("select",{value:g,onChange:U=>b(U.target.value),className:"min-w-[140px] sm:min-w-[160px] px-3 py-1.5 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Categories"}),d1.map(U=>e.jsx("option",{value:U,children:U},U))]}),e.jsxs("select",{value:d,onChange:U=>v(U.target.value),className:"min-w-[140px] sm:min-w-[160px] px-3 py-1.5 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("button",{onClick:()=>{m(""),b("all"),v("all"),h(1)},className:"px-3 py-1.5 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 text-sm shrink-0",children:[e.jsx(Na,{className:"w-4 h-4 inline mr-2"})," Reset"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2 sm:gap-3",children:[e.jsxs("button",{onClick:()=>n("create"),className:"w-full sm:w-auto bg-blue-600 text-white px-3 sm:px-4 py-2 rounded-xl hover:bg-blue-700 flex items-center justify-center gap-1.5 text-sm",children:[e.jsx(fs,{className:"w-4 h-4"})," Create Template"]}),e.jsxs("button",{onClick:()=>f(!0),className:"w-full sm:w-auto bg-white px-3 sm:px-4 py-2 rounded-xl border border-blue-200 text-blue-700 hover:bg-blue-50 flex items-center justify-center gap-1.5 text-sm",children:[e.jsx(dt,{className:"w-4 h-4"})," Import"]}),e.jsxs("button",{onClick:()=>se("csv"),disabled:F,"aria-disabled":F,className:"w-full sm:w-auto bg-white px-3 sm:px-4 py-2 rounded-xl border border-blue-200 text-blue-700 hover:bg-blue-50 flex items-center justify-center gap-1.5 text-sm",title:"Export CSV",children:[F?e.jsx(Kr,{className:"w-4 h-4 animate-spin"}):e.jsx(Ys,{className:"w-4 h-4"}),e.jsx("span",{children:"Export"})]})]})]})}),i==="create"?e.jsx(Wx,{open:!0,channel:t,onClose:()=>n("created"),onSubmit:ue,title:"Create Template"}):e.jsx("div",{className:"space-y-4 sm:space-y-6",children:j?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8 text-center",children:"Loading templates..."}):q===0?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8 sm:p-10 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-5",children:e.jsx(Bt,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-500 mb-6 sm:mb-8 leading-relaxed text-sm",children:"Get started by creating your first template."}),e.jsxs("button",{onClick:()=>n("create"),className:"bg-blue-600 text-white px-6 sm:px-8 py-2.5 sm:py-3 rounded-xl hover:bg-blue-700 transition-colors inline-flex items-center gap-2 font-semibold text-sm",children:[e.jsx(fs,{className:"w-4 h-4"})," Create Template"]})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 sm:gap-5",children:K.map(U=>e.jsx(b1,{template:U,onPreview:()=>w(U),onEdit:()=>N(U),onDuplicate:()=>he(U),onDelete:()=>y(U)},String(U.id??U.name)))}),Y>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{disabled:H===1,onClick:()=>h(U=>Math.max(1,U-1)),className:"px-3 py-1.5 rounded-lg border bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",e.jsx("span",{className:"font-semibold",children:H})," of ",e.jsxs("span",{className:"font-semibold",children:[" ",Y]})]}),e.jsx("button",{disabled:H===Y,onClick:()=>h(U=>Math.min(Y,U+1)),className:"px-3 py-1.5 rounded-lg border bg-white text-sm disabled:opacity-50",children:"Next"})]})]})})]}),e.jsx(Wx,{open:x||!!p,title:p?"Edit Template":"Create Template",initial:p||null,channel:t,onClose:()=>{u(!1),N(null)},onSubmit:ue}),e.jsx(uc,{open:!!P,onClose:()=>w(null),children:P&&e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-0.5",children:P.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block px-2.5 py-0.5 text-[11px] font-semibold bg-blue-50 text-blue-700 rounded-full border border-blue-200",children:P.category}),e.jsx(kg,{status:P.status})]})]}),e.jsx("button",{onClick:()=>w(null),className:"p-2 rounded-lg hover:bg-gray-100",children:e.jsx(ns,{className:"w-4 h-4 text-gray-600"})})]}),Mc(P.content).length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:Mc(P.content).map(U=>e.jsx("span",{className:"text-[10px] bg-amber-50 text-amber-700 border border-amber-200 rounded px-1.5 py-0.5 font-mono",children:U},U))}),e.jsx("div",{className:"rounded-xl border bg-gray-50 p-3 text-gray-800 leading-relaxed whitespace-pre-wrap text-sm",children:x1(P.content)}),e.jsx("div",{className:"mt-3 flex items-center justify-end text-xs text-gray-500",children:e.jsxs("div",{children:["Created: ",P.createdAt?new Date(P.createdAt).toLocaleDateString():"-"]})}),e.jsx("div",{className:"mt-4 flex items-center justify-end gap-2",children:e.jsx("button",{className:"px-3 py-1.5 rounded-lg border bg-white text-sm",onClick:()=>w(null),children:"Close"})})]})}),e.jsx(uc,{open:!!$,onClose:()=>y(null),size:"md",children:$&&e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-50 text-red-600",children:e.jsx(Es,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Delete template?"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This action cannot be undone."})]})]}),e.jsxs("div",{className:"mt-4 sm:mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 rounded-lg border bg-white text-sm",onClick:()=>y(null),children:"Cancel"}),e.jsx("button",{className:"px-3 py-1.5 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm",onClick:Q,children:"Delete"})]})]})}),e.jsx(uc,{open:c,onClose:()=>f(!1),children:e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-50 text-blue-600",children:e.jsx(dt,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Import templates"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Upload a ",e.jsx("strong",{children:".json"})," (array or ","{ created: [...] }",") or ",e.jsx("strong",{children:" .csv"})," file with columns like ",e.jsx("em",{children:" name, content, category, status, createdAt, priority, autoApprove"}),"."]})]})]}),e.jsxs("div",{className:"rounded-xl border bg-gray-50 p-4",children:[e.jsx("input",{ref:V,type:"file",accept:".json,.csv",onChange:U=>{var X;return ge(((X=U.target.files)==null?void 0:X[0])??null)},className:"block w-full text-sm text-gray-700 file:mr-3 file:py-2 file:px-3 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-2",children:[e.jsx(Ph,{className:"w-4 h-4"})," Sample JSON is also supported"]})]}),e.jsx("div",{className:"mt-4 flex items-center justify-end gap-2",children:e.jsx("button",{className:"px-3 py-1.5 rounded-lg border bg-white text-sm",onClick:()=>f(!1),children:"Close"})})]})}),e.jsx("div",{className:"fixed inset-0 px-3 py-4 sm:px-4 sm:py-6 pointer-events-none flex flex-col items-end gap-2 z-50",children:k.map(U=>e.jsx(u1,{toast:U,onClose:()=>C(U.id)},U.id))})]})}const ta=s=>(s==null?void 0:s.data)!==void 0&&(s==null?void 0:s.success)!==void 0||(s==null?void 0:s.data)!==void 0&&(s==null?void 0:s.success)===void 0?s.data:s??{},Cg=s=>{if(!s&&s!=="")return[];if(Array.isArray(s))return s;if(typeof s=="string"){const a=s.trim();if(!a)return[];try{const t=JSON.parse(a);if(Array.isArray(t))return t}catch{}return a.split(",").map(t=>t.trim()).filter(Boolean)}return[]},Ag=s=>s===!0||s==="true"||s==="1"||s===1,Yx=s=>s instanceof FormData?s:{...s,tags:Cg(s==null?void 0:s.tags),featured:Ag((s==null?void 0:s.featured)||!1)},y1=s=>{const a=String(s??"").toLowerCase().trim();if(a==="approved"||a==="unapproved"||a==="pending")return a},Pg=async s=>{const a=await Ae.get("/blog-posts/public/get-all",{params:s});return ta(a.data)},j1=async s=>{const a=await Ae.get(`/blog-posts/public/${s}`);return ta(a.data)},kt={createPost:async s=>{const a=s instanceof FormData?s:{status:"draft",...Yx(s)},t=await Ae.post("/blog-posts",a);return ta(t.data)},updatePost:async(s,a)=>{const t=a instanceof FormData?a:Yx(a),r=await Ae.put(`/blog-posts/update/${s}`,t);return ta(r.data)},getAllPosts:async s=>{const a=await Ae.get("/blog-posts/get-all",{params:s});return ta(a.data)},getPost:async s=>{const a=await Ae.get(`/blog-posts/get/${s}`);return ta(a.data)},getPostBySlug:async s=>{const a=await Ae.get(`/blog-posts/${s}`);return ta(a.data)},deletePost:async s=>{const a=await Ae.delete(`/blog-posts/delete/${s}`);return ta(a.data)},aiGenerateFromTitle:async s=>{const{data:a}=await Ae.post("/ai-blogs/generate",s);return a},getComments:async s=>{try{const a=await Ae.get(`/public/blogs/${encodeURIComponent(s)}/comments`);return ta(a.data)}catch(a){return console.error("blogsAPI.getComments error",a),[]}},postComment:async(s,a)=>{try{const t=await Ae.post(`/public/blogs/${encodeURIComponent(s)}/comments`,a);return ta(t.data)}catch(t){return console.error("blogsAPI.postComment error",t),{success:!1,message:"Failed to post comment"}}},likePost:async s=>{try{const a=await Ae.post(`/blog-posts/${s}/like`);return ta(a.data)}catch{const a=await Ae.post(`/posts/${s}/like`);return ta(a.data)}},bookmarkPost:async s=>{const a=await Ae.post(`/blog-posts/${s}/bookmark`);return ta(a.data)},bulkUpdate:async s=>{const a={...s.data};a.tags!==void 0&&(a.tags=Cg(a.tags)),a.featured!==void 0&&(a.featured=Ag(a.featured));const t=await Ae.put("/blog-posts/bulk-update",{ids:s.ids,data:a});return ta(t.data)},bulkDelete:async s=>{const a=await Ae.post("/blog-posts/bulk-delete",s);return ta(a.data)},deleteMany:async s=>{const a=await Ae.post("/blog-posts/delete-many",{ids:s});return ta(a.data)},listComments:async s=>{const t=(await Ae.get("/blog-comments",{params:s})).data;return{data:ta(t),total:(t==null?void 0:t.total)??(Array.isArray(t)?t.length:0),success:(t==null?void 0:t.success)??!0}},getComment:async s=>{const a=await Ae.get(`/blog-comments/${s}`);return ta(a.data)},updateComment:async(s,a)=>{const t={};if(a.author!==void 0&&(t.author=a.author),a.email!==void 0&&(t.email=a.email),a.content!==void 0&&(t.content=a.content),a.status!==void 0){const i=y1(a.status);i&&(t.status=i)}const r=await Ae.patch(`/blog-comments/${s}`,t);return ta(r.data)},deleteComment:async s=>{const a=await Ae.delete(`/blog-comments/${s}`);return ta(a.data)}},Ga=s=>encodeURIComponent(s||""),v1=s=>{var a;return typeof window<"u"&&((a=window.location)!=null&&a.origin)?window.location.origin:s||"https://investordeal.in"},N1=({url:s,slug:a,trackingToken:t,absoluteBase:r})=>{if(s)return s;const i=v1(r);let n=a?`/blogs/${encodeURIComponent(a)}`:"";if(!n)return typeof window<"u"?window.location.href:i+"/blogs";const o=new URL(i+n);return t&&o.searchParams.set("tf",t),o.toString()};function w1(s){const{onClose:a,title:t="Blog",description:r="",image:i,url:n,slug:o,trackingToken:m,absoluteBase:g}=s,b=t||"",d=r||"",v=N1({url:n,slug:o,trackingToken:m,absoluteBase:g}),x=b+(d?` â€” ${d}`:""),u=`${x}

${v}`,c=`https://wa.me/?text=${Ga(u)}`,f=`https://www.facebook.com/sharer/sharer.php?u=${Ga(v)}`,p=`https://twitter.com/intent/tweet?text=${Ga(x)}&url=${Ga(v)}`,N=`https://www.linkedin.com/shareArticle?mini=true&url=${Ga(v)}&title=${Ga(b)}&summary=${Ga(d)}`,P=`https://t.me/share/url?url=${Ga(v)}&text=${Ga(x)}`,w=`mailto:?subject=${Ga(b)}&body=${Ga(u)}`,$=async()=>{var y;try{if((y=navigator.clipboard)!=null&&y.writeText)await navigator.clipboard.writeText(v);else{const k=document.createElement("textarea");k.value=v,k.style.position="fixed",k.style.left="-9999px",document.body.appendChild(k),k.select(),document.execCommand("copy"),document.body.removeChild(k)}Z.success("Share link copied to clipboard!")}catch(k){console.error("Copy failed",k),Z.error("Could not copy. Please copy manually.")}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"relative w-full max-w-sm rounded-lg bg-white p-4 shadow-lg",children:[e.jsx("button",{onClick:a,"aria-label":"Close share modal",className:"absolute right-2 top-2 text-gray-500 hover:text-gray-800",children:e.jsx(ns,{size:20})}),e.jsx("h2",{className:"mb-2 text-lg font-semibold",children:"Share"}),b&&e.jsx("h3",{className:"mb-1 truncate text-sm font-medium",children:b}),d?e.jsx("p",{className:"mb-2 line-clamp-3 text-sm text-gray-500",children:d}):null,i?e.jsx("img",{src:i,alt:b,className:"mb-3 max-h-48 w-full rounded-md object-cover"}):null,e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx("input",{value:v,readOnly:!0,className:"flex-1 text-xs border rounded px-2 py-1 bg-gray-50",onFocus:y=>y.currentTarget.select()}),e.jsxs("button",{onClick:$,className:"flex items-center gap-1 px-2 py-1 text-sm border rounded hover:bg-gray-100",children:[e.jsx(Xt,{size:14})," Copy"]})]}),e.jsxs("div",{className:"mb-2 grid grid-cols-3 gap-2",children:[e.jsxs("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 rounded-md p-2 text-xs hover:bg-gray-100",children:[e.jsx(Yn,{size:18,className:"text-green-600"}),"WhatsApp"]}),e.jsxs("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 rounded-md p-2 text-xs hover:bg-gray-100",children:[e.jsx(Sr,{size:18,className:"text-blue-600"}),"Facebook"]}),e.jsxs("a",{href:p,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 rounded-md p-2 text-xs hover:bg-gray-100",children:[e.jsx(kr,{size:18,className:"text-sky-500"}),"Twitter"]}),e.jsxs("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 rounded-md p-2 text-xs hover:bg-gray-100",children:[e.jsx(Cr,{size:18,className:"text-blue-700"}),"LinkedIn"]}),e.jsxs("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center gap-1 rounded-md p-2 text-xs hover:bg-gray-100",children:[e.jsx(Dt,{size:18,className:"text-sky-600"}),"Telegram"]}),e.jsxs("a",{href:w,className:"flex flex-col items-center gap-1 rounded-md p-2 text-xs hover:bg-gray-100",children:[e.jsx(Ds,{size:18,className:"text-red-500"}),"Email"]})]})]})})}const gc="bookmarks:v1",hc="likes:v1",Tg=s=>!!s&&typeof s=="object",Tn=s=>Array.isArray(s),Gx=s=>{if(Tn(s))return s;if(!Tg(s))return[];if("data"in s&&Tn(s.data))return s.data;if("items"in s&&Tn(s.items))return s.items;if("posts"in s&&Tn(s.posts))return s.posts;if("results"in s&&Tn(s.results))return s.results;const a=s;return a!=null&&a.id||a!=null&&a.title||a!=null&&a.slug?[a]:[]},Kx=s=>{if(Tg(s))return"data"in s?s.data:s};function Jx(s){if(!s)return[];if(Array.isArray(s))return s.map(a=>String(a));if(typeof s=="string")try{const a=JSON.parse(s);if(Array.isArray(a))return a.map(t=>String(t))}catch{return s.split(",").map(a=>a.trim()).filter(Boolean)}return[]}const _1=s=>{const a=r=>String(r??"").toLowerCase(),t=r=>Object.prototype.hasOwnProperty.call(s||{},r);if(!s)return!0;if(t("visibility")){const r=a(s.visibility);if(r==="public")return!0;if(r==="private")return!1}if(t("status")){const r=a(s.status);if(r==="published"||r==="active"||r==="public")return!0;if(r==="draft"||r==="inactive"||r==="private")return!1}return t("isPublic")?!!s.isPublic:t("is_public")?!!s.is_public:t("published")?!!s.published:t("draft")?!s.draft:!0},S1=({onPost:s,posting:a})=>{const[t,r]=l.useState(""),[i,n]=l.useState(""),[o,m]=l.useState("");return e.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 sm:p-5 lg:p-6 bg-gradient-to-br from-gray-50 to-white shadow-sm",children:[e.jsx("textarea",{value:t,onChange:g=>r(g.target.value),rows:3,placeholder:"Share your thoughts...",className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-300 rounded-lg mb-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base resize-none transition-all"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 mb-3 sm:mb-4",children:[e.jsx("input",{className:"px-3 sm:px-4 py-2 sm:py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-all",placeholder:"Name (optional)",value:i,onChange:g=>n(g.target.value)}),e.jsx("input",{className:"px-3 sm:px-4 py-2 sm:py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base transition-all",placeholder:"Email (optional)",value:o,onChange:g=>m(g.target.value)})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-2 justify-end",children:[e.jsx("button",{onClick:()=>{r(""),n(""),m("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all text-sm sm:text-base font-medium",children:"Clear"}),e.jsx("button",{onClick:()=>{s(t,i,o),r("")},disabled:a||!t.trim(),className:"px-4 py-2 bg-[#E6761D] hover:bg-[#CC6A1A] text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transition-all text-sm sm:text-base font-medium",children:a?"Posting...":"Post Comment"})]})]})},k1=({slug:s,post:a,loading:t=!1,onBack:r})=>{const i=Ca(),[n,o]=l.useState(a??null),[m,g]=l.useState(t),[b,d]=l.useState([]),[v,x]=l.useState([]),[u,c]=l.useState([]),[f,p]=l.useState(null),[N,P]=l.useState([]),[w,$]=l.useState(!1),[y,k]=l.useState(!1),[R,F]=l.useState(null),[T,j]=l.useState(!1),[E,V]=l.useState(!1),[W,B]=l.useState(!1),[M,A]=l.useState(!1),[L,D]=l.useState(!1),[I,H]=l.useState(!1),h=C=>`blog_like:${C.slug??C.id}`;l.useEffect(()=>{o(a??null)},[a]),l.useEffect(()=>{if(!s)return;let C=!1;return(async()=>{g(!0),p(null);try{if(a&&a.slug===s&&a.content)o(a);else{const ue=await kt.getPostBySlug(s),Q=Kx(ue);if(!Q){o(null);return}const he={id:Q.id??Q._id??Q.slug??s,slug:Q.slug??s,title:Q.title??"Untitled",excerpt:Q.excerpt??(typeof Q.content=="string"?Q.content.slice(0,160)+(Q.content.length>160?"â€¦":""):""),content:Q.content??"",author:Q.author??"Admin",date:Q.publishedAt??Q.published_at??Q.createdAt??Q.created_at??new Date().toISOString(),category:Q.category??"Uncategorized",readTime:Q.readTime?String(Q.readTime):Q.read_time?String(Q.read_time):"5 min read",image:Q.featuredImage??Q.featured_image??Q.image??"",tags:Jx(Q.tags??[]),views:Number(Q.views??0),likes:Number(Q.likes??0),comments:Number(Q.comments??0),featured:!!Q.featured};C||o(he)}}catch(ue){C||(p((ue==null?void 0:ue.message)??"Failed to load post"),o(null))}finally{C||g(!1)}})(),()=>{C=!0}},[s,a]),l.useEffect(()=>{let C=!1;return(async()=>{try{const ue=await Pg(),he=(Gx(ue)||[]).map((se,ge)=>{const ee=Jx(se.tags??se.tag??[]),de=se.slug??se.slugified??(se.title?String(se.title).toLowerCase().replace(/\s+/g,"-"):String(se.id??ge)),U={id:se.id??se._id??de??ge,slug:de,title:se.title??"Untitled",excerpt:se.excerpt??(typeof se.content=="string"?se.content.slice(0,160)+(se.content.length>160?"â€¦":""):""),content:se.content??"",author:se.author??"Admin",date:se.publishedAt??se.published_at??se.createdAt??se.created_at??new Date().toISOString(),category:se.category??"Uncategorized",readTime:se.readTime?String(se.readTime):se.read_time?String(se.read_time):"5 min read",image:se.featuredImage??se.featured_image??se.image??"",tags:ee,views:Number(se.views??0),likes:Number(se.likes??0),comments:Number(se.comments??0),featured:!!se.featured};return U.__isPublic=_1(se),U});if(!C){const se=he.filter(de=>de.__isPublic!==!1),ge=[...se].sort((de,U)=>new Date(U.date??"").getTime()-new Date(de.date??"").getTime()).slice(0,5);x(ge);const ee=Array.from(new Set(se.map(de=>de.category||"Uncategorized")));if(c(ee),n){const U=se.filter(X=>X.slug!==n.slug).map(X=>{const re=(X.tags||[]).filter(me=>(n.tags||[]).includes(me)).length,fe=X.category===n.category?1:0,G=re*2+fe;return{c:X,score:G}}).sort((X,re)=>re.score-X.score).slice(0,6).map(X=>X.c);d(U.map(X=>({...X,content:X.content??""})))}}}catch{C||(d([]),x([]),c([]))}})(),()=>{C=!0}},[n]),l.useEffect(()=>{let C=!1;return(async()=>{if(n){$(!0);try{let ue;kt.getCommentsByPostSlug?ue=await kt.getCommentsByPostSlug(n.slug??String(n.id)):kt.getComments?ue=await kt.getComments(n.slug??String(n.id)):ue=[];const Q=Gx(ue),he=Array.isArray(Q)?Q.map(se=>({id:se.id??se._id??`${se.email||"anon"}-${Math.random().toString(36).slice(2,8)}`,postId:se.postId??se.post_id??n.id,author:se.author??se.name??"Anonymous",email:se.email,content:se.content??se.body??"",date:se.date??se.createdAt??se.created_at??new Date().toISOString()})):[];C||P(he)}catch{C||P([])}finally{C||$(!1)}}})(),()=>{C=!0}},[n]),l.useEffect(()=>{if(n){try{const C=localStorage.getItem(hc);if(C){const J=JSON.parse(C);j(J.includes(n.id))}}catch{}try{const C=localStorage.getItem(gc);if(C){const J=JSON.parse(C);V(J.includes(n.id))}}catch{}}},[n]),l.useEffect(()=>{if(n)try{const C=h(n),J=localStorage.getItem(C)==="1";H(J||T)}catch{H(T)}},[n,T]);const Y=(C,J)=>{try{const ue=localStorage.getItem(hc),Q=ue?JSON.parse(ue):[],he=Q.findIndex(se=>String(se)===String(C));J&&he===-1&&Q.push(C),!J&&he!==-1&&Q.splice(he,1),localStorage.setItem(hc,JSON.stringify(Q))}catch{}},K=async()=>{if(!n||W)return;const C=T;j(!C),o(J=>J&&{...J,likes:(J.likes??0)+(C?-1:1)}),B(!0);try{kt.likePost?await kt.likePost(n.id):Y(n.id,!C)}catch{j(C),o(ue=>ue&&{...ue,likes:(ue.likes??0)+(C?1:-1)})}finally{B(!1)}},q=C=>{if(C&&(C.stopPropagation(),C.preventDefault()),!n)return;const J=h(n);H(ue=>{const Q=!ue;try{Q?localStorage.setItem(J,"1"):localStorage.removeItem(J)}catch{}return Q}),K()},ne=C=>{try{const J=localStorage.getItem(gc),ue=J?JSON.parse(J):[],Q=ue.findIndex(he=>String(he)===String(C));return Q===-1?ue.push(C):ue.splice(Q,1),localStorage.setItem(gc,JSON.stringify(ue)),Q===-1}catch{return!E}},le=async()=>{if(!n||M)return;const C=E;V(!C),A(!0);try{kt.bookmarkPost?await kt.bookmarkPost(n.id):ne(n.id)}catch{V(C)}finally{A(!1)}},S=async(C,J,ue)=>{if(F(null),!n)return F("Cannot post comment: missing post.");if(!C.trim())return F("Please write a comment.");const Q=`temp-${Date.now()}`,he={id:Q,postId:n.id,author:(J==null?void 0:J.trim())||"Guest",email:ue,content:C.trim(),date:new Date().toISOString()};P(se=>[he,...se]),k(!0);try{if(kt.postComment){const se=await kt.postComment(n.slug??String(n.id),{author:he.author,email:he.email,content:he.content}),ge=Kx(se);ge&&P(ee=>ee.map(de=>de.id===Q?{id:ge.id??ge._id??de.id,postId:de.postId,author:ge.author??de.author,email:ge.email??de.email,content:ge.content??de.content,date:ge.date??ge.createdAt??de.date}:de))}o(se=>se&&{...se,comments:(se.comments??0)+1})}catch(se){P(ge=>ge.filter(ee=>ee.id!==Q)),F((se==null?void 0:se.message)??"Failed to post comment")}finally{k(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50/30 to-purple-50/30",children:[e.jsx("div",{className:"bg-white shadow-sm border-b pt-20 sticky top-0 z-40",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between ",children:e.jsxs("button",{onClick:()=>r?r():i("/blogs"),className:"flex items-center text-white hover:text-gray-200 transition-colors text-sm font-medium",children:[e.jsx(ga,{size:18,className:"mr-1"}),"Back to articles"]})})})}),L&&e.jsx(w1,{slug:(n==null?void 0:n.slug)||String((n==null?void 0:n.id)||""),title:n==null?void 0:n.title,description:n==null?void 0:n.excerpt,image:n==null?void 0:n.image,onClose:()=>D(!1)}),e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-5 lg:gap-8 mt-1.5  pb-6 sm:pb-8 lg:pb-12",children:[e.jsxs("div",{className:"lg:col-span-2",children:[m?e.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 md:p-8 shadow-lg",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 rounded w-5/6"})]})}):f?e.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 md:p-8 shadow-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 md:w-20 md:h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:e.jsx(ns,{className:"w-7 h-7 sm:w-8 sm:h-8 md:w-10 md:h-10 text-red-600"})}),e.jsx("p",{className:"text-red-600 text-sm sm:text-base",children:f})]})}):n?e.jsxs("article",{className:"bg-white rounded-xl shadow-xl overflow-hidden",children:[n.image&&e.jsxs("div",{className:"relative w-full h-52 sm:h-64 md:h-80 lg:h-96 overflow-hidden group",children:[e.jsx("img",{src:n.image,alt:n.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),e.jsxs("div",{className:"absolute top-2 sm:top-3 md:top-4 right-2 sm:right-3 md:right-4 flex flex-col gap-1.5 sm:gap-2",children:[e.jsx("button",{onClick:q,"aria-label":I?"Remove from shortlist":"Add to shortlist",className:"w-9 h-9 sm:w-10 sm:h-10 md:w-11 md:h-11 flex items-center justify-center rounded-full bg-white/95 backdrop-blur-md shadow-lg ring-1 ring-black/10 hover:bg-white hover:scale-110 hover:shadow-xl transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/60",children:e.jsx(Ra,{className:`w-4 h-4 sm:w-5 sm:h-5 ${I?"text-red-500 fill-current":"text-gray-700"}`})}),e.jsx("button",{onClick:()=>D(!0),title:"Share",className:"w-9 h-9 sm:w-10 sm:h-10 md:w-11 md:h-11 flex items-center justify-center rounded-full bg-white/95 backdrop-blur-md shadow-lg ring-1 ring-black/10 hover:bg-white hover:scale-110 hover:shadow-xl transition-all duration-200 text-gray-700 hover:text-blue-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/60",children:e.jsx(Wt,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 lg:p-10",children:[e.jsx("h1",{className:"text-xl font-bold mb-3 sm:mb-4 text-gray-900 leading-tight  hover:text-orange-500",children:n.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm text-gray-500 mb-4 sm:mb-5 md:mb-6",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0"}),e.jsx("span",{className:"truncate max-w-[80px] sm:max-w-[120px] md:max-w-none",children:n.author})]}),e.jsx("button",{onClick:K,disabled:W,title:T?"Unlike":"Like",className:`flex items-center gap-1 px-2 py-1 rounded-md transition-all ${T?"text-red-600 bg-red-50":"text-gray-600 hover:text-red-600 hover:bg-red-50"}`,"aria-pressed":T}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Bt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0"}),e.jsxs("span",{className:"hidden sm:inline",children:[N.length," comments"]}),e.jsx("span",{className:"sm:hidden",children:N.length})]})]}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg text-gray-600 mb-4 sm:mb-6 leading-relaxed",children:n.excerpt}),e.jsx("div",{className:"prose prose-sm sm:prose md:prose-lg max-w-none text-gray-800 mb-6 sm:mb-8",children:n.content?e.jsx("div",{dangerouslySetInnerHTML:{__html:n.content}}):e.jsx("p",{children:"No content available for this article."})}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-4 sm:mt-6",children:(n.tags||[]).map(C=>e.jsxs("span",{className:"flex items-center gap-1.5 sm:gap-2 text-xs sm:text-sm text-gray-600 bg-gray-100 px-2.5 sm:px-3 py-1 sm:py-1.5 rounded-full hover:bg-gray-200 transition-colors",children:[e.jsx(mr,{className:"w-3 h-3 flex-shrink-0"})," ",C]},C))}),e.jsxs("section",{className:"mt-8 sm:mt-10 lg:mt-12",children:[e.jsxs("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold mb-4 sm:mb-5",children:["Comments (",N.length,")"]}),e.jsx(S1,{onPost:S,posting:y}),R&&e.jsx("div",{className:"text-xs sm:text-sm text-red-600 mt-2 p-2 bg-red-50 rounded",children:R})]})]})]}):e.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 md:p-8 shadow-lg text-center",children:e.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Article not found."})}),b.length>0&&e.jsxs("div",{className:"mt-6 sm:mt-8",children:[e.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold mb-3 sm:mb-4",children:"Related articles"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:b.map(C=>{const J=`/blogs/${encodeURIComponent(String(C.slug??C.id))}`;return e.jsx("div",{className:"bg-white rounded-lg p-3 sm:p-4 shadow-sm hover:shadow-md transition-all border border-gray-100",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[C.image?e.jsx(Bs,{to:J,className:"w-20 h-16 sm:w-24 sm:h-20 rounded overflow-hidden flex-shrink-0 group/image","aria-label":`Open ${C.title}`,children:e.jsx("img",{src:C.image,alt:C.title,className:"w-full h-full object-cover group-hover/image:opacity-90 transition",onError:ue=>{ue.currentTarget.style.display="none"}})}):null,e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Bs,{to:J,className:"font-medium text-sm sm:text-base text-gray-800 hover:text-orange-500 hover:underline underline-offset-2 transition-colors line-clamp-2",children:C.title}),e.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0 hidden sm:block",children:C.readTime}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 line-clamp-2 mb-2",children:C.excerpt}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{className:"truncate",children:C.author}),e.jsx("span",{children:"Â·"}),e.jsx("span",{className:"flex-shrink-0",children:new Date(C.date??"").toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]})]})},C.id)})})]})]}),e.jsxs("aside",{className:"space-y-4 sm:space-y-5 lg:space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 shadow-md border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full ring-1 ring-gray-200  text-black flex items-center justify-center  font-bold text-sm sm:text-base flex-shrink-0",children:String((n==null?void 0:n.author)??"A").split(" ").map(C=>C[0]).join("")}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-sm sm:text-base truncate",children:(n==null?void 0:n.author)??"Admin"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Contributor"})]})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-3 sm:mt-4",children:n!=null&&n.author?`Read more from ${n.author}.`:"This author shares insights, market analysis and real estate tips."}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex gap-2",children:[e.jsx("button",{className:"flex-1 bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-3 py-2 rounded-lg text-xs sm:text-sm font-medium hover:shadow-lg transition-all",children:"Follow"}),e.jsxs("button",{onClick:le,disabled:M,className:`flex items-center gap-1.5 sm:gap-2 border px-3 py-2 rounded-lg text-xs sm:text-sm font-medium transition-all ${E?"bg-yellow-50 text-yellow-700 border-yellow-200":"border-gray-200 hover:bg-gray-50"}`,title:E?"Remove bookmark":"Save","aria-pressed":E,children:[e.jsx(kl,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:E?"Saved":"Save"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 shadow-md border border-gray-100",children:[e.jsx("h4",{className:"font-medium text-sm sm:text-base mb-3 sm:mb-4",children:"Recent posts"}),e.jsxs("div",{className:"space-y-3",children:[v.map(C=>{const J=`/blogs/${encodeURIComponent(String(C.slug??C.id))}`;return e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 group",children:[C.image?e.jsx(Bs,{to:J,className:"w-14 h-12 sm:w-16 sm:h-12 rounded overflow-hidden flex-shrink-0 group/image","aria-label":`Open ${C.title}`,children:e.jsx("img",{src:C.image,alt:C.title,className:"w-full h-full object-cover group-hover/image:opacity-80 transition-opacity",onError:ue=>{ue.currentTarget.style.display="none"}})}):e.jsx("div",{className:"w-14 h-12 sm:w-16 sm:h-12 bg-gray-100 rounded flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Bs,{to:J,className:"text-xs sm:text-sm text-left font-medium hover:text-orange-500 hover:underline line-clamp-2 transition-colors",children:C.title}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(C.date??"").toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]},C.id)}),v.length===0&&e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 text-center py-3",children:"No recent posts"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 shadow-md border border-gray-100",children:[e.jsx("h4",{className:"font-medium text-sm sm:text-base mb-3 sm:mb-4",children:"Recent comments"}),e.jsxs("div",{className:"space-y-3",children:[N.slice(0,5).map(C=>e.jsx("div",{className:"text-xs sm:text-sm text-left font-medium text-gray-700 hover:text-orange-500",children:e.jsx("p",{className:"text-left cursor-default",children:C.content.length>140?C.content.slice(0,140)+"...":C.content})},C.id)),N.length===0&&e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 text-center py-3",children:"No recent comments"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 shadow-md border border-gray-100",children:[e.jsx("h4",{className:"font-medium text-sm sm:text-base mb-3 sm:mb-4",children:"Categories"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.map(C=>e.jsx("button",{onClick:()=>{i(`/blogs?category=${encodeURIComponent(C)}`)},className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-gray-100 text-xs sm:text-sm rounded-lg hover:bg-gray-200 transition-colors",children:C},C)),u.length===0&&e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 text-center w-full py-2",children:"No categories"})]})]}),e.jsxs("div",{className:"text-white rounded-xl p-4 sm:p-5 shadow-lg",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:[e.jsx("h4",{className:"text-base sm:text-lg font-semibold mb-2",children:"Join our newsletter"}),e.jsx("p",{className:"text-xs sm:text-sm mb-3 sm:mb-4 opacity-95",children:"Weekly insights, market updates and featured listings â€” delivered to your inbox."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{type:"email",placeholder:"Your email",className:"flex-1 px-3 py-2 rounded-lg text-black text-sm focus:ring-2 focus:ring-white/50 focus:outline-none"}),e.jsx("button",{className:"px-4 py-2 bg-[#E6761D] hover:bg-[#CC6A1A] text-white rounded-lg font-medium text-sm transition-colors whitespace-nowrap",children:"Subscribe"})]})]})]})]})]})},Ig=s=>!!s&&typeof s=="object",In=s=>Array.isArray(s),Qx=s=>{if(In(s))return s;if(!Ig(s))return[];if("data"in s&&In(s.data))return s.data;if("items"in s&&In(s.items))return s.items;if("posts"in s&&In(s.posts))return s.posts;if("results"in s&&In(s.results))return s.results;const a=s;return a!=null&&a.id||a!=null&&a.title||a!=null&&a.slug?[a]:[]},C1=s=>{if(Ig(s))return"data"in s?s.data:s};function Zx(s){if(!s)return[];if(Array.isArray(s))return s.map(a=>String(a));if(typeof s=="string")try{const a=JSON.parse(s);if(Array.isArray(a))return a.map(t=>String(t))}catch{return s.split(",").map(a=>a.trim()).filter(Boolean)}return[]}function A1(s){if(!(!s||typeof s!="string"))return String(s).toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").replace(/-+/g,"-")}const P1=["All","Real Estate","Investment","Market Analysis","Legal","Home Buying","Home Selling","Property News","Construction","Finance"],Xx=({onPageChange:s})=>{const a=Ca(),t=on(),[r,i]=l.useState(""),[n,o]=l.useState("All"),[m,g]=l.useState(null),[b,d]=l.useState(null),[v,x]=l.useState(!1),[u,c]=l.useState("newest"),[f,p]=l.useState([]),[N,P]=l.useState(!1),[w,$]=l.useState(null),[y,k]=l.useState({}),R=l.useMemo(()=>P1,[]);l.useEffect(()=>{const B=t.slug??null;g(B)},[t.slug]),l.useEffect(()=>{let B=!1;return(async()=>{P(!0),$(null);try{const A=await Pg(),D=Qx(A).map((I,H)=>{const h=Zx(I.tags??I.tag??[]),Y=I.slug??I.slugified??A1(I.title)??String(I.id??H),K=I.featuredImage??I.featured_image??I.image??"",q=I.publishedAt??I.published_at??I.createdAt??I.created_at??new Date().toISOString();return{id:I.id??I._id??Y??H,slug:Y,title:I.title??"Untitled",excerpt:I.excerpt??(typeof I.content=="string"?I.content.slice(0,160)+(I.content.length>160?"â€¦":""):""),content:I.content??"",author:I.author??"Admin",date:q,category:I.category??"Uncategorized",readTime:I.readTime?String(I.readTime):I.read_time?String(I.read_time):"5 min read",image:K,tags:h,views:Number(I.views??0),likes:Number(I.likes??0),comments:Number(I.comments??0),featured:!!I.featured,sourceId:I.sourceId,sourceName:I.sourceName}});B||p(D)}catch(A){console.error("Failed fetching posts",A),B||$((A==null?void 0:A.message)||"Failed to load posts")}finally{B||P(!1)}})(),()=>{B=!0}},[]),l.useEffect(()=>{if(!f||f.length===0)return;let B=!1;const M=async(L,D,I)=>{const H=new Array(L.length);let h=0;const Y=new Array(Math.min(D,L.length)).fill(0).map(async()=>{for(;h<L.length;){const K=h++;H[K]=await I(L[K],K)}});return await Promise.all(Y),H},A=f.filter(L=>{const D=L.slug??String(L.id),I=y[D],H=typeof L.comments=="number"?L.comments:void 0;return I==null&&(!H||H<1)||I===0});if(A.length!==0)return(async()=>{try{await M(A,4,async L=>{if(B)return 0;const D=L.slug??String(L.id);let I;try{if(kt.getCommentsByPostSlug)I=await kt.getCommentsByPostSlug(D);else if(kt.getComments)I=await kt.getComments(D);else return 0;const H=Qx(I),h=Array.isArray(H)?H.length:0;return B||k(Y=>({...Y,[D]:h})),h}catch{return B||k(H=>({...H,[D]:H[D]??L.comments??0})),0}})}catch{}})(),()=>{B=!0}},[f]),l.useEffect(()=>{if(!m){d(null);return}let B=!1;return(async()=>{x(!0);try{const A=await j1(m),L=C1(A);if(!L){B||d(null);return}const D={id:L.id??L._id??L.slug??m,slug:L.slug??m,title:L.title??"Untitled",excerpt:L.excerpt??(typeof L.content=="string"?L.content.slice(0,160)+(L.content.length>160?"â€¦":""):""),content:L.content??"",author:L.author??"Admin",date:L.publishedAt??L.published_at??L.createdAt??L.created_at??new Date().toISOString(),category:L.category??"Uncategorized",readTime:L.readTime?String(L.readTime):L.read_time?String(L.read_time):"5 min read",image:L.featuredImage??L.featured_image??L.image??"",tags:Zx(L.tags??[]),views:Number(L.views??0),likes:Number(L.likes??0),comments:Number(L.comments??0),featured:!!L.featured,sourceId:L.sourceId,sourceName:L.sourceName};B||d(D)}catch(A){console.error("Failed loading post by slug",A),B||d(null)}finally{B||x(!1)}})(),()=>{B=!0}},[m]);const F=l.useMemo(()=>{const B=r.trim().toLowerCase();return f.filter(M=>{const A=!B||M.title&&M.title.toLowerCase().includes(B)||M.excerpt&&M.excerpt.toLowerCase().includes(B)||M.tags&&M.tags.some(D=>D.toLowerCase().includes(B)),L=n==="All"||M.category===n;return A&&L})},[f,r,n]),T=l.useMemo(()=>{const B=[...F];return B.sort((M,A)=>{switch(u){case"oldest":return new Date(M.date??"").getTime()-new Date(A.date??"").getTime();case"popular":return(A.views||0)-(M.views||0);case"trending":return(A.likes||0)-(M.likes||0);default:return new Date(A.date??"").getTime()-new Date(M.date??"").getTime()}}),B},[F,u]),j=f.find(B=>B.featured)??f[0],E=B=>{const M=B.slug??String(B.id);a(`/blogs/${encodeURIComponent(M)}`),g(M),s&&s(1)},V=()=>{a("/blogs"),g(null),d(null)},W=!N&&!w&&T.length===0;return m?e.jsx(k1,{slug:m,post:b??void 0,loading:v,onBack:V}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50",children:[e.jsx("div",{className:"py-32",style:{background:"linear-gradient(135deg, #0b3856 0%, #0c3854 50%, #1a4d6d 100%)"},children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-3 text-white",children:"Real Estate Insights & News"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg mb-6 sm:mb-8 md:mb-10 text-blue-100 max-w-3xl mx-auto leading-relaxed px-4",children:"Stay informed with the latest market trends, expert tips, and property updates. From buying and selling guidance to investment insights and design ideas â€” everything you need in one place."})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 -mt-6 sm:-mt-8 md:-mt-10 relative z-10",children:[N?e.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center shadow-xl",children:e.jsx("div",{className:"animate-pulse",children:"Loading posts..."})}):w?e.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center text-red-600 shadow-xl",children:w}):j?e.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl overflow-hidden mb-6 sm:mb-8 hover:shadow-3xl transition-all duration-300",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[j.image?e.jsxs("div",{className:"w-full md:w-1/2 relative overflow-hidden group",children:[e.jsx("img",{src:j.image,alt:j.title,className:"w-full h-48 sm:h-64 md:h-full object-cover group-hover:scale-105 transition-transform duration-500"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent md:hidden"})]}):null,e.jsxs("div",{className:"w-full md:w-1/2 p-4 sm:p-6 md:p-8 lg:p-10",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3 sm:mb-4",children:[e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-3 py-1 rounded-full text-xs sm:text-sm font-semibold shadow-lg",children:"Featured"}),e.jsx("span",{className:"ml-1 text-gray-600 text-xs sm:text-sm font-medium bg-gray-100 px-3 py-1 rounded-full",children:j.category})]}),e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3 sm:mb-4 leading-tight hover:text-orange-500 transition-colors",children:j.title}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-4 sm:mb-6 leading-relaxed line-clamp-3",children:j.excerpt}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 text-xs sm:text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),e.jsx("span",{className:"truncate max-w-[100px] sm:max-w-none",children:j.author})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ts,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:new Date(j.date??"").toLocaleDateString()}),e.jsx("span",{className:"sm:hidden",children:new Date(j.date??"").toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ls,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),j.readTime]})]}),e.jsxs("button",{onClick:()=>E(j),className:"flex items-center justify-center gap-2 bg-[#E6761D] hover:bg-[#CC6A1A] text-white font-semibold px-4 py-2 rounded-md shadow-sm transition-all",children:["Read More",e.jsx(la,{className:"w-4 h-4 transition-transform group-hover:translate-x-1"})]})]})]})]})}):null,e.jsxs("div",{className:"py-2 sm:py-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4 mb-6 sm:mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("input",{type:"text",placeholder:"Search articles...",value:r,onChange:B=>i(B.target.value),className:"w-full pl-9 sm:pl-10 pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm"})]}),e.jsxs("select",{value:u,onChange:B=>c(B.target.value),className:"px-3 sm:px-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white shadow-sm min-w-[140px] sm:min-w-[160px]",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"popular",children:"Most Popular"}),e.jsx("option",{value:"trending",children:"Trending"})]})]}),e.jsx("div",{className:"overflow-x-auto pb-2 -mx-3 px-3 sm:mx-0 sm:px-0",children:e.jsx("div",{className:"flex gap-2 min-w-max sm:min-w-0 sm:flex-wrap",children:R.map(B=>e.jsx("button",{onClick:()=>o(B),className:`px-3 sm:px-4 py-2 rounded-lg font-medium transition-all text-xs sm:text-sm whitespace-nowrap ${n===B?"bg-[#E6761D]  hover:bg-[#E6761D] text-white shadow-lg scale-105":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:B},B))})})]}),!N&&!w&&W?e.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 text-center shadow-lg",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(it,{className:"w-8 h-8 sm:w-10 sm:h-10 text-gray-400"})}),e.jsx("h3",{className:"text-xl sm:text-2xl font-semibold text-gray-900 mb-2",children:"No posts available"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6",children:r?e.jsxs(e.Fragment,{children:["No articles found for ",e.jsxs("span",{className:"font-medium",children:['"',r,'"']}),n&&n!=="All"?e.jsxs(e.Fragment,{children:[" ","in ",e.jsx("span",{className:"font-medium",children:n})]}):null,"."]}):e.jsxs(e.Fragment,{children:["There are no articles in"," ",e.jsx("span",{className:"font-medium",children:n==="All"?"the selected filters":n}),"."]})})]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:T.map(B=>{const M=B.slug??String(B.id),A=y[M],L=typeof A=="number"?A:B.comments??0;return e.jsxs("article",{className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 cursor-pointer group transform hover:-translate-y-1",onClick:()=>E(B),children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("img",{src:B.image,alt:B.title,className:"w-full h-44 sm:h-48 object-cover group-hover:scale-110 transition-transform duration-500"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsxs("div",{className:"absolute top-2 sm:top-3 left-2 sm:left-3 flex flex-wrap gap-1.5 sm:gap-2 max-w-[calc(100%-1rem)]",children:[e.jsx("span",{className:"bg-blue-600 text-white px-2 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-semibold shadow-lg",children:B.category}),B.featured&&e.jsx("span",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-2 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-semibold shadow-lg",children:"Featured"})]}),e.jsxs("div",{className:"p-4 sm:p-5 lg:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[e.jsxs("div",{className:"flex items-center text-gray-500 text-xs sm:text-sm",children:[e.jsx(Ls,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),B.readTime]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 text-xs sm:text-sm text-gray-500",children:[e.jsx("span",{className:"flex items-center space-x-1"}),e.jsx("span",{className:"flex items-center space-x-1"})]})]}),e.jsx("h3",{className:"text-base sm:text-lg lg:text-xl font-bold text-gray-800 mb-2 sm:mb-3 line-clamp-2 group-hover:text-orange-500 transition-colors leading-tight",children:B.title}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4 line-clamp-2 sm:line-clamp-3 leading-relaxed",children:B.excerpt}),e.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 mb-3 sm:mb-4",children:(B.tags||[]).slice(0,3).map(D=>e.jsxs("span",{className:"flex items-center text-[10px] sm:text-xs text-gray-500 bg-gray-100 px-2 py-0.5 sm:py-1 rounded hover:bg-blue-50 hover:text-blue-600 transition-colors",children:[e.jsx(mr,{className:"w-2.5 h-2.5 sm:w-3 sm:h-3 mr-0.5 sm:mr-1"}),e.jsx("span",{className:"truncate max-w-[80px] sm:max-w-none",children:D})]},D))}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between pt-3 sm:pt-4 border-t border-gray-100 gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center ring-1 ring-gray-200  flex-shrink-0",children:e.jsx("span",{className:"text-black text-[10px] sm:text-xs font-bold",children:String(B.author||"A").split(" ").map(D=>D[0]).join("").slice(0,2)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:B.author}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500",children:new Date(B.date??"").toLocaleDateString("en-US",{month:"short",day:"numeric",year:window.innerWidth>640?"numeric":void 0})})]})]}),e.jsxs("div",{className:"flex items-center justify-between sm:justify-end gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center text-[10px] sm:text-xs text-gray-500",children:[e.jsx(Bt,{size:12,className:"mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:[L," comments"]}),e.jsx("span",{className:"sm:hidden",children:L})]}),e.jsxs("button",{className:"group flex items-center justify-center gap-2 bg-[#E6761D] hover:bg-[#CC6A1A] text-white font-semibold text-xs sm:text-sm px-2 py-1 rounded-md shadow-sm hover:shadow-md hover:-translate-y-0.5 transition-all",children:["Read",e.jsx(la,{className:"w-3 h-3 sm:w-4 sm:h-4 transition-transform group-hover:translate-x-0.5"})]})]})]})]})]},B.id)})})]}),e.jsx("div",{className:"mt-2 sm:mt-12 mb-1 rounded-xl sm:rounded-2xl p-6 sm:p-8 md:p-10 lg:p-12 text-center shadow-2xl",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center mx-auto mb-4 sm:mb-6",children:e.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),e.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-white mb-2 sm:mb-3 leading-tight",children:"Stay Updated with Our Newsletter"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-blue-100 mb-6 sm:mb-8 leading-relaxed px-2",children:"Get the latest real estate insights, market updates, and expert tips delivered directly to your inbox."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 max-w-md mx-auto",children:[e.jsx("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-4 py-2.5 sm:py-3 text-sm sm:text-base rounded-lg border-0 focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-blue-600 shadow-lg"}),e.jsx("button",{className:"w-full sm:w-auto bg-[#E6761D] hover:bg-[#CC6A1A] text-white px-5 py-3 rounded-xl font-semibold shadow-md transition-colors duration-300",children:"Subscribe"})]})]})})]})]})},il={submitContact:async s=>(await Ae.post("/contact/submit",s)).data,getContacts:async()=>(await Ae.get("/contact/list")).data,getContactById:async s=>(await Ae.get(`/contact/${s}`)).data,updateContact:async(s,a)=>(await Ae.put(`/contact/${s}`,a)).data,deleteContact:async s=>(await Ae.delete(`/contact/${s}`)).data,updateStatus:async(s,a)=>{var r;const t=await Ae.patch(`/contact/${s}/status`,{status:a});return t.data||((r=t.data)==null?void 0:r.data)||t},addReply:async(s,a)=>{var r;const t=await Ae.post(`/contact/${s}/reply`,a);return t.data||((r=t.data)==null?void 0:r.data)||t}},T1=()=>{const[s,a]=l.useState({name:"",email:"",phone:"",subject:"",message:"",propertyType:"",budget:""}),[t,r]=l.useState(!1),[i,n]=l.useState(!0),[o,m]=l.useState({}),[g,b]=l.useState({type:"",message:""}),[d,v]=l.useState(null),x=y=>v(k=>k===y?null:y),u=y=>{if(!y)return;let k="";if(typeof y=="object"){const{lat:R,lng:F}=y;k=`https://www.google.com/maps/dir/?api=1&destination=${R},${F}&travelmode=driving&origin=Current+Location`}else k=`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(y)}&travelmode=driving&origin=Current+Location`;window.open(k,"_blank","noopener,noreferrer")};l.useEffect(()=>{(async()=>{try{n(!0);const k=await Gt(["common","lead","property"]);m(k||{})}catch(k){console.error("Error fetching master options:",k),b({type:"error",message:"Failed to load dropdown options"})}finally{n(!1)}})()},[]);const c=async y=>{var k,R;if(y.preventDefault(),b({type:"",message:""}),!s.name.trim()||!s.email.trim()||!s.phone.trim()||!s.subject.trim()||!s.message.trim()){b({type:"error",message:"Please fill all required fields."});return}r(!0);try{const F={name:s.name.trim(),email:s.email.trim(),phone:s.phone.trim(),subject:s.subject.trim(),message:s.message.trim(),propertyType:s.propertyType||null,budget:s.budget||null,source:"website"};await il.submitContact(F),b({type:"success",message:"Thank you! We will get back to you within 24 hours."}),a({name:"",email:"",phone:"",subject:"",message:"",propertyType:"",budget:""})}catch(F){console.error("Submit failed",F);const T=((R=(k=F==null?void 0:F.response)==null?void 0:k.data)==null?void 0:R.message)||"Failed to send message. Please try again later.";b({type:"error",message:T})}finally{r(!1)}},f=y=>{const{name:k,value:R}=y.target;a(F=>({...F,[k]:R}))},p=[{icon:Cs,title:"Call Us",details:["+91 9637 00 9639","+91 9146 00 9176"],description:"24/7 Customer Support",color:"green"},{icon:Ds,title:"Email Us",details:["info@resaleexpert.in"],description:"Quick Response Guaranteed",color:"blue"},{icon:Qs,title:"Visit Us",details:["Shubhchandra, Nakhate Chowk","Rahatani, Pimpri-Chinchwad"],description:"Pune, Maharashtra 411017, India",color:"purple"},{icon:Ls,title:"Office Hours",details:["Mon - Fri: 10:00 AM - 8:00 PM","Sat - Sun: 9:00 AM - 9:00 PM"],description:"Extended Hours Available",color:"orange"}],N=[{city:"Pune",address:"Shubhchandra, Rahatani, Pune - 411017",phone:"+91 9637 00 9639",email:"pune@resaleexpert.in",lat:18.607,lng:73.7919}],P=[{question:"How quickly do you respond to inquiries?",answer:"We respond to all inquiries within 2-4 hours during business hours and within 24 hours on weekends."},{question:"Do you charge for consultation?",answer:"Our initial consultation is completely free. We only charge when you decide to proceed with our services."},{question:"What areas do you cover?",answer:"We currently operate in Mumbai, Pune, Delhi, Bangalore, and Hyderabad, with plans to expand to more cities."},{question:"Can I schedule a property visit?",answer:"Yes! You can schedule property visits through our website, mobile app, or by calling our customer service team."}],w=o["property type"]||[],$=o["price range"]||[];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("section",{className:"py-28 pt-28",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-3 text-white",children:"Get in Touch"}),e.jsx("p",{className:"text-lg mb-2 text-blue-100 max-w-3xl mx-auto",children:"Ready to find your dream property or sell your current one? Our expert team is here to help you every step of the way."}),e.jsxs("div",{className:"flex items-center justify-center space-x-8 mt-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold mb-2 text-white",children:"2-4 Hours"}),e.jsx("div",{className:"text-blue-200",children:"Response Time"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold mb-2 text-white",children:"24/7"}),e.jsx("div",{className:"text-blue-200",children:"Support Available"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-bold mb-2 text-white",children:"98%"}),e.jsx("div",{className:"text-blue-200",children:"Satisfaction Rate"})]})]})]})})}),e.jsx("section",{className:"py-3",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Send us a Message"}),e.jsx("p",{className:"text-gray-600",children:"Fill out the form below and we'll get back to you within 24 hours with personalized assistance."})]}),g.message&&e.jsx("div",{className:`px-4 py-2 rounded-md text-sm ${g.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:g.message})]}),e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",name:"name",value:s.name,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your full name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),e.jsx("input",{type:"tel",name:"phone",value:s.phone,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your phone number",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email address",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Type"}),e.jsxs("select",{name:"propertyType",value:s.propertyType,onChange:f,disabled:i,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select property type"}),(w||[]).map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget Range"}),e.jsxs("select",{name:"budget",value:s.budget,onChange:f,disabled:i,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select budget range"}),($||[]).map(y=>e.jsx("option",{value:y.value,children:y.label},y.value))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),e.jsx("input",{type:"text",name:"subject",value:s.subject,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"What can we help you with?",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),e.jsx("textarea",{name:"message",value:s.message,onChange:f,rows:5,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tell us more about your requirements...",required:!0})]}),e.jsx("button",{type:"submit",disabled:t,className:"w-full bg-[#E6761D] hover:bg-[#CC6A1A] text-white py-4 px-6 rounded-lg transition-all font-semibold flex items-center justify-center space-x-2 disabled:opacity-50",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dt,{size:20}),e.jsx("span",{children:"Send Message"})]})})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"Contact Information"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Multiple ways to reach us. Choose what works best for you."})]}),e.jsx("div",{className:"space-y-6",children:p.map((y,k)=>{const R=y.icon,F="bg-[#E6761D]",T=y.title==="Visit Us";return e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${F}`,children:e.jsx(R,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:y.title}),e.jsx("div",{className:"space-y-1",children:y.details.map((j,E)=>T?e.jsx("p",{className:"text-gray-700 font-medium",children:e.jsx("a",{href:`https://www.google.com/maps/place/Resale+Expert/@18.6043773,73.7822784,786m/data=!3m2!1e3!4b1!4m6!3m5!1s0x210d06d018a02fa1:0xcb55e5426416ae86!8m2!3d18.6043723!4d73.7871493!16s%2Fg%2F11ksnvr1rf?entry=ttu&g_ep=EgoyMDI1MTIwOS4wIKXMDSoASAFQAw%3D%3D=${encodeURIComponent(j)}`,target:"_blank",rel:"noopener noreferrer",className:"underline hover:no-underline",children:j})},E):e.jsx("p",{className:"text-gray-700 font-medium",children:j},E))}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:y.description})]})]})},k)})}),e.jsxs("div",{className:"rounded-xl p-6 text-white",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Need Immediate Assistance?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsxs("button",{onClick:()=>window.open("tel:+919637009639"),"aria-label":"Call Now",className:"flex-1 bg-[#E6761D] text-white py-3 px-4 rounded-lg font-semibold transition-colors duration-300 flex items-center justify-center space-x-2 focus:outline-none focus:ring-2 focus:ring-white/30",children:[e.jsx(Cs,{size:18}),e.jsx("span",{children:"Call Now"})]}),e.jsxs("button",{onClick:()=>window.open("https://wa.me/919637009639","_blank"),"aria-label":"WhatsApp",className:"flex-1 bg-[#25D366] hover:bg-[#1ebe57] active:bg-[#19a94d] text-white py-3 px-4 rounded-lg font-semibold transition-colors duration-300 flex items-center justify-center space-x-2 focus:outline-none focus:ring-2 focus:ring-white/30",children:[e.jsx(Ia,{size:18}),e.jsx("span",{children:"WhatsApp"})]})]})]})]})]})})}),e.jsx("section",{className:"py-3 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800",children:"Our Office Locations"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Visit us at our offices across major cities"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:N.map((y,k)=>e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Is,{className:"text-blue-600",size:20})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:y.city})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Qs,{className:"text-gray-500 mt-1",size:16}),e.jsx("p",{className:"text-gray-700",children:y.address})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{className:"text-gray-500",size:16}),e.jsx("p",{className:"text-gray-700",children:y.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"text-gray-500",size:16}),e.jsx("p",{className:"text-gray-700",children:y.email})]})]}),e.jsx("button",{onClick:()=>y.lat&&y.lng?u({lat:y.lat,lng:y.lng}):u(y.address),className:"w-full mt-4 bg-[#E6761D] hover:bg-[#CC6A1A] text-white py-2 px-4 rounded-lg transition-colors",children:"Get Directions"})]},k))})]})}),e.jsx("section",{className:"py-3 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Frequently Asked Questions"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Quick answers to common questions"})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:P.map((y,k)=>{const R=d===k;return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[e.jsxs("button",{type:"button",onClick:()=>x(k),"aria-expanded":R,"aria-controls":`faq-panel-${k}`,className:"w-full flex items-center justify-between gap-4 p-6 text-left",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:y.question}),e.jsx(ea,{className:`shrink-0 transition-transform duration-300 ${R?"rotate-180":""}`})]}),e.jsx("div",{id:`faq-panel-${k}`,role:"region",className:`grid transition-[grid-template-rows] duration-300 ease-out ${R?"grid-rows-[1fr]":"grid-rows-[0fr]"}`,children:e.jsx("div",{className:"overflow-hidden",children:e.jsx("div",{className:"px-6 pb-6 pt-0 text-gray-700 leading-relaxed",children:y.answer})})})]},k)})})]})}),e.jsx("section",{className:"py-3 text-white",style:{background:"linear-gradient(to right, #0b3856, #0c3854)"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-white",children:"Stay Connected"}),e.jsx("p",{className:"text-lg text-blue-100 mb-8 max-w-2xl mx-auto",children:"Follow us on social media for the latest updates, property listings, and real estate tips"}),e.jsx("div",{className:"flex items-center justify-center space-x-6 mb-6",children:[{icon:Sr,href:"https://www.facebook.com/resaleexpert.i",label:"Facebook"},{icon:kr,href:"https://twitter.com/resaleexpertin",label:"Twitter"},{icon:El,href:"https://www.instagram.com/resaleexpert.in/",label:"Instagram"},{icon:Cr,href:"https://www.linkedin.com/company/resaleexpertin/",label:"LinkedIn"}].map((y,k)=>{const R=y.icon;return e.jsx("a",{href:y.href,target:"_blank",rel:"noopener noreferrer",className:"p-4 bg-white bg-opacity-10 rounded-xl hover:bg-opacity-20 transition-all group","aria-label":y.label,children:e.jsx(R,{size:20,className:"group-hover:scale-110 transition-transform"})},k)})}),e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-2xl p-8 backdrop-blur-sm",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4 text-white",children:"Emergency Contact"}),e.jsx("p",{className:"text-blue-100 mb-6",children:"Need urgent assistance outside business hours?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{size:20}),e.jsx("span",{className:"font-semibold",children:"Emergency: +91 9146 00 9176"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{size:20}),e.jsx("span",{className:"font-semibold",children:"urgent@resaleexpert.in"})]})]})]})]})})})]})},I1=()=>{const[s,a]=l.useState({width:0,height:0});return l.useEffect(()=>{const t=()=>a({width:window.innerWidth,height:window.innerHeight});return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),s},$1=({isPropertyDetail:s=!1})=>{const{width:a}=I1(),t=a>0?a<640:!1,[r,i]=l.useState(!1),[n,o]=l.useState(!1),[m,g]=l.useState(""),[b,d]=l.useState(!1),[v,x]=l.useState([{id:"1",text:"ðŸ‘‹ Namaste! I'm RE AI Agent, your intelligent real estate assistant. I can help you with property search, market analysis, pricing, legal guidance, and investment advice. How can I assist you today?",sender:"bot",timestamp:new Date,suggestions:["Find properties under â‚¹1 Cr","Market trends in Bandra","Calculate EMI","Best investment areas"]}]),u=l.useMemo(()=>["Properties under â‚¹1 Cr","Best areas for investment","Calculate EMI for home loan","Market trends analysis","Legal documentation help","Property valuation"],[]),c=l.useRef(null),f=l.useRef(null),p=l.useRef(null),N=()=>s?t?"bottom-24 right-4":"bottom-6 right-6":t?"bottom-6 right-4":"bottom-2 right-6";l.useEffect(()=>{var T;(T=c.current)==null||T.scrollIntoView({behavior:"smooth"})},[v,n,r]),l.useEffect(()=>{var T;r&&!n&&((T=f.current)==null||T.focus())},[r,n]),l.useEffect(()=>{if(!r)return;const T=j=>{if(j.key==="Escape"&&i(!1),j.key==="Tab"&&p.current){const E=p.current.querySelectorAll('button, [href], input, textarea, [tabindex]:not([tabindex="-1"])');if(E.length===0)return;const V=E[0],W=E[E.length-1];j.shiftKey&&document.activeElement===V?(W.focus(),j.preventDefault()):!j.shiftKey&&document.activeElement===W&&(V.focus(),j.preventDefault())}};return document.addEventListener("keydown",T),()=>document.removeEventListener("keydown",T)},[r]);const P=T=>{const j=T.toLowerCase();return j.includes("price")||j.includes("cost")||j.includes("â‚¹")||j.includes("under")?{text:`ðŸ’° **Property Pricing Analysis**

Based on current market data:

ðŸ“ **Mumbai Average Prices:**
â€¢ Andheri West: â‚¹15,000-â‚¹22,000/sq ft
â€¢ Bandra West: â‚¹25,000-â‚¹35,000/sq ft
â€¢ Powai: â‚¹12,000-â‚¹18,000/sq ft
â€¢ Juhu: â‚¹20,000-â‚¹30,000/sq ft

ðŸ  **For Budget â‚¹1 Cr, you can get:**
â€¢ 600-800 sq ft in Andheri West
â€¢ 450-550 sq ft in Bandra West
â€¢ 700-900 sq ft in Powai

Would you like me to show you specific properties in your budget range?`,suggestions:["Show properties under â‚¹1 Cr","Calculate affordability","Compare locations","EMI calculator"]}:j.includes("investment")||j.includes("roi")||j.includes("growth")||j.includes("best area")?{text:`ðŸ“ˆ **AI Investment Analysis**

ðŸŽ¯ **Top Investment Hotspots 2025:**

1ï¸âƒ£ **Powai** - 18% projected growth
   â€¢ IT hub proximity
   â€¢ Infrastructure development
   â€¢ Lake-facing premium

2ï¸âƒ£ **Andheri West** - 15% projected growth
   â€¢ Metro connectivity
   â€¢ Commercial hub
   â€¢ Airport proximity

3ï¸âƒ£ **Thane West** - 22% projected growth
   â€¢ Affordable entry point
   â€¢ Rapid development
   â€¢ Good connectivity

ðŸ¤– **AI Recommendation:** Powai offers the best risk-to-reward ratio for 2025.`,suggestions:["Show Powai properties","Investment calculator","Market trends","Risk analysis"]}:j.includes("emi")||j.includes("loan")||j.includes("mortgage")||j.includes("calculate")?{text:`ðŸ¦ **Smart EMI Calculator**

ðŸ“Š **Sample Calculations:**

**â‚¹50L Loan @ 8.5% for 20 years:**
ðŸ’³ Monthly EMI: â‚¹43,391
ðŸ’° Total Interest: â‚¹54.14L
ðŸ“ˆ Total Amount: â‚¹1.04 Cr

**â‚¹1Cr Loan @ 8.5% for 20 years:**
ðŸ’³ Monthly EMI: â‚¹86,782
ðŸ’° Total Interest: â‚¹1.08 Cr
ðŸ“ˆ Total Amount: â‚¹2.08 Cr

ðŸŽ¯ **AI Tips:**
â€¢ Choose 15-year tenure to save â‚¹20L+ interest
â€¢ Prepay â‚¹1L annually to reduce tenure by 3 years
â€¢ CIBIL 750+ gets you 0.5% lower rates

Want me to calculate for your specific amount?`,suggestions:["Calculate for my amount","Loan eligibility check","Compare banks","Prepayment benefits"]}:j.includes("trend")||j.includes("market")||j.includes("bandra")||j.includes("andheri")?{text:`ðŸ“Š **AI Market Intelligence**

ðŸ”¥ **Current Trends (Jan 2025):**

**ðŸ† Bandra West:**
â€¢ Price: +12.8% in 6 months
â€¢ Demand: Very High (9.2/10)
â€¢ Supply: Limited (4.1/10)
â€¢ Rental Yield: 2.8%

**ðŸ“ˆ Andheri West:**
â€¢ Price: +8.7% in 6 months
â€¢ Demand: High (8.5/10)
â€¢ Supply: Moderate (6.2/10)
â€¢ Rental Yield: 3.2%

**ðŸš€ Price Drivers:**
â€¢ Metro Line 3 completion
â€¢ IT company expansions
â€¢ Premium retail developments

**ðŸŽ¯ AI Prediction:** 15-18% growth expected in next 12 months.`,suggestions:["Location comparison","Future predictions","Investment hotspots","Rental analysis"]}:j.includes("legal")||j.includes("document")||j.includes("paper")||j.includes("registration")?{text:`âš–ï¸ **Legal Documentation Guide**

ðŸ“‹ **Essential Documents for Purchase:**

âœ… **Seller Documents:**
â€¢ Original Sale Deed
â€¢ Title Certificate Chain
â€¢ Approved Building Plan
â€¢ Occupancy Certificate
â€¢ Property Tax Receipts (3 years)
â€¢ Society NOC

âœ… **Verification Required:**
â€¢ Encumbrance Certificate (30 years)
â€¢ Revenue Records
â€¢ RERA Registration
â€¢ Completion Certificate

âš¡ **Our Legal AI checks:**
â€¢ Document authenticity
â€¢ Legal title verification
â€¢ Compliance status
â€¢ Hidden liabilities

ðŸ›¡ï¸ **Risk Score:** We provide 0-100 legal safety score for every property.`,suggestions:["Document verification","Legal consultation","Title search","Registration process"]}:j.includes("amenities")||j.includes("facilities")||j.includes("club")||j.includes("gym")?{text:`ðŸ¢ **Premium Amenities Analysis**

ðŸŒŸ **Must-Have Modern Amenities:**

ðŸŠâ€â™‚ï¸ **Wellness:**
â€¢ Swimming Pool (adds 15% value)
â€¢ Fully-equipped Gym
â€¢ Yoga/Meditation Area
â€¢ Spa & Wellness Center

ðŸŽ¯ **Entertainment:**
â€¢ Clubhouse with Events Hall
â€¢ Indoor Games Room
â€¢ Kids Play Area
â€¢ Library & Co-working

ðŸ”’ **Security & Tech:**
â€¢ 24/7 CCTV Surveillance
â€¢ Biometric Access
â€¢ Intercom Systems
â€¢ Smart Home Integration

ðŸš— **Convenience:**
â€¢ Covered Parking
â€¢ EV Charging Stations
â€¢ Power Backup
â€¢ Water Treatment Plant

ðŸ¤– **AI Insight:** Properties with 8+ premium amenities appreciate 25% faster.`,suggestions:["Amenity-rich properties","Compare amenities","Value analysis","Future amenities"]}:j.includes("hello")||j.includes("hi")||j.includes("hey")||j.includes("namaste")?{text:`ðŸ™ **Namaste & Welcome to RE AI Agent!**

I'm your intelligent real estate companion, powered by advanced AI algorithms and real-time market data. Here's how I can supercharge your property journey:

ðŸ  **Smart Property Search**
â€¢ AI-matched recommendations
â€¢ Budget optimization
â€¢ Location intelligence

ðŸ’¡ **Market Intelligence**
â€¢ Real-time price trends
â€¢ ROI predictions
â€¢ Investment hotspots

ðŸ¤– **Personalized Assistance**
â€¢ EMI calculations
â€¢ Legal guidance
â€¢ Documentation support

What would you like to explore first? I'm here 24/7 to help!`,suggestions:["Find my dream home","Investment opportunities","Market analysis","Calculate affordability"]}:j.includes("compare")||j.includes("vs")||j.includes("difference")?{text:`âš–ï¸ **AI Property Comparison**

ðŸ“Š **Location Comparison Matrix:**

**Andheri West vs Bandra West:**

ðŸ† **Andheri West:**
â€¢ Price: â‚¹15-22K/sq ft
â€¢ Connectivity: Metro + Airport
â€¢ Growth: 15% annually
â€¢ Best for: IT professionals

ðŸ† **Bandra West:**
â€¢ Price: â‚¹25-35K/sq ft
â€¢ Connectivity: Station + Sea link
â€¢ Growth: 12% annually
â€¢ Best for: Premium lifestyle

**Winner depends on:**
â€¢ Budget: Andheri (affordable)
â€¢ Luxury: Bandra (premium)
â€¢ ROI: Andheri (higher returns)
â€¢ Prestige: Bandra (status symbol)

Which locations would you like me to compare in detail?`,suggestions:["Compare 3 locations","Price comparison","Connectivity analysis","Lifestyle comparison"]}:j.includes("school")||j.includes("education")||j.includes("children")||j.includes("family")?{text:`ðŸŽ“ **Family-Friendly Areas Analysis**

ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ **Best Areas for Families with Kids:**

ðŸ« **Top Educational Hubs:**

1ï¸âƒ£ **Bandra West**
â€¢ Dhirubhai Ambani International School
â€¢ Jamnabai Narsee School
â€¢ Hill Spring International

2ï¸âƒ£ **Powai**
â€¢ Hiranandani Foundation School
â€¢ Delhi Public School
â€¢ JBCN International

3ï¸âƒ£ **Juhu**
â€¢ Jamnabai Narsee School
â€¢ Utpal Shanghvi Global School
â€¢ SVKM International School

ðŸŽ¯ **Family Amenities Nearby:**
â€¢ Parks & playgrounds
â€¢ Pediatric healthcare
â€¢ Activity centers
â€¢ Safe neighborhoods

ðŸ¤– **AI Family Score:** Each area rated 0-100 for family suitability.`,suggestions:["School ratings","Family properties","Safety analysis","Kids activities nearby"]}:{text:`ðŸ¤– **RE AI Agent Understanding...**

I'm here to help with all your real estate needs! I can assist you with:

ðŸ  **Property Search & Analysis**
ðŸ’° **Pricing & Investment Advice**
ðŸ“Š **Market Trends & Predictions**
âš–ï¸ **Legal Documentation**
ðŸ¦ **Loan & EMI Calculations**
ðŸ“ **Location Intelligence**

Could you please be more specific about what you're looking for? For example:
â€¢ "Show me 2BHK under â‚¹80L in Andheri"
â€¢ "Best investment areas in Mumbai"
â€¢ "Calculate EMI for â‚¹60L loan"

I'm powered by real-time data and machine learning to give you the most accurate insights!`,suggestions:["Property search help","Investment advice","Market analysis","EMI calculator"]}},w=async()=>{if(!m.trim())return;const T={id:Date.now().toString(),text:m,sender:"user",timestamp:new Date};x(j=>[...j,T]),g(""),d(!0),setTimeout(()=>{const j=P(T.text),E={id:(Date.now()+1).toString(),text:j.text,sender:"bot",timestamp:new Date,suggestions:j.suggestions};x(V=>[...V,E]),d(!1)},1200)},$=T=>{g(T),setTimeout(()=>w(),120)},y=e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-white shadow ring-1 ring-gray-200 flex items-center justify-center shrink-0",children:e.jsx("img",{src:Ri,alt:"RE AI",className:"w-1/2 h-1/2 object-cover"})}),k=e.jsx("div",{className:"w-8 h-8 rounded-full  bg-blue-500 text-white flex items-center justify-center",children:e.jsx(Ms,{size:16})});if(!r)return e.jsx("div",{className:`fixed ${N()} z-[70]`,children:e.jsx("button",{onClick:()=>i(!0),"aria-label":"Open chat",className:`${t?"w-12 h-12 p-2":"w-14 h-14 p-3"} bg-gradient-to-r bg-white/50 text-white rounded-full ring-2 shadow-2xl hover:scale-105 transform transition flex items-center justify-center relative overflow-hidden`,children:e.jsx("img",{src:Ri,alt:"AI Chatbot",className:`${t?"w-7 h-7":"w-8 h-8"} object-contain relative z-10`})})});const R=`bg-white rounded-2xl shadow-2xl border border-gray-200 transition-all duration-300 ${t?"w-full h-[75vh] rounded-t-2xl":"w-96 h-[600px]"} overflow-hidden flex flex-col`;return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 z-40",onClick:()=>i(!1),"aria-hidden":!0}),e.jsx("div",{className:`fixed z-[70] ${t?"inset-x-0 bottom-0 flex justify-center":N()}`,role:"dialog","aria-modal":"true","aria-label":"RE AI Agent chat",children:e.jsxs("div",{ref:p,className:R,style:{maxWidth:t?"100%":void 0},children:[e.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-200 rounded-t-2xl bg-gradient-to-r from-[#0b3856] to-[#0c3854] text-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-white/50 flex items-center justify-center overflow-hidden ring-1 ring-white/20",children:e.jsx("img",{src:Ri,alt:"RE AI",className:"w-8 h-8 object-contain"})}),e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2.5 h-2.5 bg-emerald-400 rounded-full animate-pulse ring-2 ring-blue-600"})]}),e.jsxs("div",{className:"leading-tight",children:[e.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"RE AI Agent"}),e.jsxs("p",{className:"text-[10px] sm:text-xs text-blue-100 flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-400 rounded-full"})," Online"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>o(!n),className:"text-white/90 hover:bg-white/15 p-1.5 rounded-lg transition-colors","aria-label":n?"Maximize chat":"Minimize chat",children:n?e.jsx(Vn,{size:16}):e.jsx(Wc,{size:16})}),e.jsx("button",{onClick:()=>i(!1),className:"text-white/90 hover:bg-white/15 p-1.5 rounded-lg transition-colors","aria-label":"Close chat",children:e.jsx(ns,{size:16})})]})]}),n?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Chat minimized"}),e.jsx("button",{onClick:()=>o(!1),className:"px-3 py-1.5 bg-blue-600 text-white rounded-full text-sm hover:bg-blue-700",children:"Open"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 sm:px-4 py-3 overflow-y-auto flex-1 space-y-4",style:{maxHeight:t?"calc(75vh - 160px)":void 0},children:[v.map(T=>e.jsxs("div",{children:[e.jsx("div",{className:`flex ${T.sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-start gap-2 max-w-[85%] ${T.sender==="user"?"flex-row-reverse gap-2":""}`,children:[T.sender==="user"?k:y,e.jsxs("div",{className:`px-3 py-2 rounded-2xl text-sm leading-relaxed shadow-sm ${T.sender==="user"?"bg-blue-600 text-white rounded-br-sm":"bg-gray-50 text-gray-800 rounded-bl-sm ring-1 ring-gray-100"}`,children:[e.jsx("p",{className:"whitespace-pre-line",children:T.text}),e.jsx("p",{className:`text-[10px] mt-2 ${T.sender==="user"?"text-blue-100":"text-gray-500"}`,children:T.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})}),T.sender==="bot"&&T.suggestions&&e.jsx("div",{className:"ml-10 mt-2 flex flex-wrap gap-2",children:T.suggestions.map((j,E)=>e.jsx("button",{onClick:()=>$(j),className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-xs hover:bg-blue-100 transition-colors",children:j},E))})]},T.id)),b&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"flex items-start gap-2",children:[y,e.jsx("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-bl-sm ring-1 ring-gray-100",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500/80 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-purple-500/80 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-500/80 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})}),e.jsx("div",{ref:c})]}),e.jsx("div",{className:"px-3 sm:px-4 py-2 border-t border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:u.slice(0,3).map((T,j)=>e.jsx("button",{onClick:()=>$(T),className:"text-xs bg-white border border-gray-200 text-gray-700 px-3 py-1.5 rounded-full hover:bg-blue-50 hover:border-blue-200 hover:text-blue-700 transition-all",children:T},j))})}),e.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200 bg-white",children:e.jsxs("form",{className:"flex items-center gap-2",onSubmit:T=>{T.preventDefault(),w()},children:[e.jsx("input",{ref:f,type:"text",value:m,onChange:T=>g(T.target.value),placeholder:"Ask RE AI Agent anything...",className:"flex-1 px-3 py-2 border border-gray-300 text-gray-800 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm","aria-label":"Message input"}),e.jsx("button",{type:"submit",disabled:!m.trim()||b,className:" bg-[#E6761D] text-white p-2 rounded-xl hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center","aria-label":"Send message",children:e.jsx(Dt,{size:16})})]})})]})]})})]})},E1=({open:s,onClose:a})=>s?e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/60 flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white w-full max-w-[95vw] lg:max-w-[90vw] xl:max-w-[85vw] rounded-2xl shadow-2xl overflow-hidden animate-fadeIn relative",children:[e.jsxs("div",{className:"flex justify-between items-center border-b px-6 py-4 bg-gray-100 sticky top-0 z-10",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Privacy Policy"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:e.jsx(ns,{size:24,className:"text-gray-700"})})]}),e.jsxs("div",{className:"p-8 max-h-[80vh] overflow-y-auto text-gray-700 text-base leading-relaxed space-y-5",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Effective Date:"})," 24/06/2023"]}),e.jsxs("p",{children:["At ",e.jsx("strong",{className:"text-[#E6761D]",children:"resaleexpert.in"}),", we are committed to protecting the privacy of our users in accordance with the applicable laws and regulations of India. This Privacy Policy outlines how we collect, use, and protect the information provided by users of our website."]}),e.jsxs("ol",{className:"list-decimal pl-8 space-y-3",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Collection of Personal Information:"})," We may collect personal information from users, including but not limited to names, email addresses, contact numbers, and other details provided voluntarily."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Use of Personal Information:"})," The collected data helps us provide and improve our services, respond to inquiries, and send promotional offers with user consent."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Information Sharing:"})," We may share data with trusted partners and service providers but never sell or rent information without user consent."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Data Security:"})," We implement appropriate measures to protect your information in accordance with Indian data protection laws."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cookies and Tracking Technologies:"})," Cookies may be used to enhance user experience and analyze website traffic."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Third-Party Websites:"})," Our website may contain external links; we are not responsible for their privacy practices."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Childrenâ€™s Privacy:"})," Our services are not intended for children under 18. We do not knowingly collect data from minors."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Changes to this Policy:"})," We may update this Privacy Policy periodically. Users are encouraged to review it regularly."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Contact Us:"})," For questions, email us at"," ",e.jsx("a",{href:"mailto:admin@resaleexpert.in",className:"text-[#E6761D] underline",children:"admin@resaleexpert.in"}),"."]})]}),e.jsx("p",{className:"pt-2 text-gray-600",children:"By using resaleexpert.in, you acknowledge that you have read, understood, and agreed to this Privacy Policy under the laws of India."}),e.jsx("div",{className:"flex justify-end pt-6 border-t",children:e.jsx("button",{onClick:a,className:"px-6 py-2 bg-[#E6761D] text-white rounded-lg hover:bg-[#d1651a] transition",children:"Close"})})]})]})}):null,M1=({open:s,onClose:a})=>s?e.jsx("div",{className:"fixed inset-0 z-[999] bg-black/60 flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white w-full max-w-[95vw] lg:max-w-[90vw] xl:max-w-[85vw] rounded-2xl shadow-2xl overflow-hidden animate-fadeIn relative",children:[e.jsxs("div",{className:"flex justify-between items-center border-b px-6 py-4 bg-gray-100 sticky top-0 z-10",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Terms & Conditions"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:e.jsx(ns,{size:24,className:"text-gray-700"})})]}),e.jsxs("div",{className:"p-8 max-h-[80vh] overflow-y-auto text-gray-700 text-base leading-relaxed space-y-5",children:[e.jsxs("p",{children:["Welcome to ",e.jsx("strong",{className:"text-[#E6761D]",children:"resaleexpert.in"}),". By accessing or using our website, you agree to comply with and be bound by the following terms and conditions."]}),e.jsx("p",{children:"These Terms govern your use of our website and services. Please read them carefully before using resaleexpert.in."}),e.jsxs("ul",{className:"list-disc pl-8 space-y-3",children:[e.jsx("li",{children:"Use of the website is subject to compliance with applicable laws and regulations of India."}),e.jsxs("li",{children:["All content and materials on this website are the property of"," ",e.jsx("strong",{className:"text-[#E6761D]",children:"resaleexpert.in"})," and may not be copied or redistributed without written consent."]}),e.jsx("li",{children:"We reserve the right to modify, suspend, or discontinue any part of the website without prior notice."}),e.jsx("li",{children:"Users are responsible for maintaining confidentiality of login credentials and any activities under their account."}),e.jsx("li",{children:"We shall not be liable for any loss or damage resulting from the use of this website or reliance on any information provided herein."}),e.jsx("li",{children:"Links to third-party websites are provided for convenience; we do not endorse their content or privacy practices."}),e.jsx("li",{children:"These terms are governed by and construed under the laws of India. Any disputes shall be subject to the jurisdiction of Pune courts."})]}),e.jsx("p",{children:"By continuing to use our services, you acknowledge that you have read and agreed to these Terms & Conditions."}),e.jsx("div",{className:"flex justify-end pt-6 border-t",children:e.jsx("button",{onClick:a,className:"px-6 py-2 bg-[#E6761D] text-white rounded-lg hover:bg-[#d1651a] transition",children:"Close"})})]})]})}):null,L1=({onPageChange:s})=>{const a=Jr(),t=Ca(),r=!!(Gl({path:"/properties/:slug"},a.pathname)||Gl({path:"/property/:slug"},a.pathname)),i=new Date().getFullYear(),[n,o]=l.useState(!0),[m,g]=l.useState(!1),[b,d]=l.useState(!1),v=[{id:"home",label:"Home",to:"/home"},{id:"properties",label:"Properties",to:"/properties"},{id:"about",label:"About Us",to:"/about"},{id:"contact",label:"Contact Us",to:"/contact"}],x=[{label:"Property Selling",href:"services"},{label:"Property Buying",href:"services"},{label:"Property Rental",href:"services"},{label:"Legal Services",href:"services"},{label:"Loan Assistance",href:"services"},{label:"Property Management",href:"services"}],u=[{icon:Sr,href:"https://www.facebook.com/resaleexpert.i",color:"text-blue-600"},{icon:kr,href:"https://twitter.com/resaleexpertin",color:"text-blue-400"},{icon:El,href:"https://www.instagram.com/resaleexpert.in",color:"text-pink-600"},{icon:Cr,href:"https://www.linkedin.com/company/resaleexpertin/",color:"text-blue-700"},{icon:Cu,href:"https://www.youtube.com/channel/UCYuJPmp-d7HIdfPgSejWzvg",color:"text-red-600"}],{systemSettings:c}=ur(),f=(c==null?void 0:c.company_name)||"Resale Expert",p=c==null?void 0:c.footer_logo,[N,P]=l.useState({});l.useEffect(()=>{(async()=>{try{o(!0);const $=await Gt(["common"]);P($)}finally{o(!1)}})()},[]);const w=$=>{t(`/properties?location=${encodeURIComponent($)}`)};return e.jsxs("footer",{className:`bg-gray-900 text-white lg:pb-0 md:pb-0 ${r?"pb-24":"pb-0"} z-[70]`,children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 lg:gap-8 md:gap-8 sm:gap-8 gap-2",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("div",{className:"flex items-center space-x-3 mb-6",children:e.jsx(Bs,{to:"/",className:"flex items-center space-x-2",children:e.jsx("div",{className:"flex items-center space-x-3",children:p?e.jsx("img",{src:p,alt:`${f} Footer Logo`,className:"h-14 w-auto object-contain"}):e.jsx("div",{className:"hidden sm:block",children:e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-800 to-orange-500 bg-clip-text text-transparent",children:f})})})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(at,{className:"text-green-400",size:16}),e.jsx("span",{className:"text-sm text-gray-300",children:"100% Verified Properties"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ct,{className:"text-yellow-400",size:16}),e.jsx("span",{className:"text-sm text-gray-300",children:"Award Winning Service"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-blue-400",size:16}),e.jsx("span",{className:"text-sm text-gray-300",children:"10,000+ Happy Customers"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Quick Links"}),e.jsxs("ul",{className:"space-y-3",children:[v.map($=>e.jsx("li",{children:e.jsxs(Bs,{to:$.to,className:"text-gray-300 hover:text-white transition-colors duration-200 flex items-center space-x-2",onClick:()=>{},children:[e.jsx("span",{className:"w-1 h-1 bg-blue-500 rounded-full"}),e.jsx("span",{children:$.label})]})},$.id)),e.jsx("li",{children:e.jsxs("button",{onClick:()=>g(!0),className:"text-gray-300 hover:text-white transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("span",{className:"w-1 h-1 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Privacy Policy"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>d(!0),className:"text-gray-300 hover:text-white transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("span",{className:"w-1 h-1 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Terms & Conditions"})]})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Our Services"}),e.jsx("ul",{className:"space-y-3",children:x.map(($,y)=>e.jsx("li",{children:e.jsxs("a",{href:$.href,className:"text-gray-300 hover:text-white transition-colors duration-200 flex items-center space-x-2",children:[e.jsx("span",{className:"w-1 h-1 bg-orange-500 rounded-full"}),e.jsx("span",{children:$.label})]})},y))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Contact Info"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Qs,{className:"text-blue-400 mt-1 flex-shrink-0",size:18}),e.jsx("div",{children:e.jsxs("p",{className:"text-gray-300",children:["Shubhchandra, Nakhate Chowk,",e.jsx("br",{}),"Rahatani, Pimpri-Chinchwad",e.jsx("br",{}),"Pune, Maharashtra 411017, India"]})})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Cs,{className:"text-green-400",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-300",children:"+91 9637 00 9639"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"24/7 Support Available"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ds,{className:"text-purple-400",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-300",children:"info@resaleexpert.in"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Quick Response Guaranteed"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ls,{className:"text-orange-400",size:18}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-300",children:"Mon - Fri: 9:00 AM - 8:00 PM"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Sat - Sun: 9:00 AM - 9:00 PM"})]})]})]})]})]}),e.jsxs("div",{className:"mt-4 border-t border-gray-800 pt-6",children:[e.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Popular Locations"}),n?e.jsx("div",{className:"text-gray-400 text-sm",children:"Loading locationsâ€¦"}):Array.isArray(N.location)&&N.location.length>0?e.jsx("div",{className:"flex flex-wrap gap-3",children:N.location.map(($,y)=>e.jsx("button",{onClick:()=>w($.value),className:"px-4 py-2 bg-gray-800 text-gray-300 rounded-lg hover:bg-gray-700 hover:text-white transition-colors text-sm",title:$.label,children:$.value},y))}):e.jsx("div",{className:"text-gray-400 text-sm italic",children:"No locations available"})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-6",children:[e.jsx("span",{className:"text-gray-400 text-sm mr-2",children:"Follow us:"}),u.map(($,y)=>{const k=$.icon;return e.jsx("a",{href:$.href,className:`p-2 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors ${$.color}`,target:"_blank",rel:"noopener noreferrer",children:e.jsx(k,{size:14})},y)})]})]}),e.jsx("div",{className:"bg-gray-950 border-t border-gray-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"flex flex-col md:flex-row items-center justify-between",children:e.jsxs("div",{className:"text-gray-400 text-sm mb-4 md:mb-0 text-center md:text-left",children:["Â© ",i," ",f,". All rights reserved."," ",e.jsx("span",{className:"mx-2 text-gray-500",children:"|"}),e.jsxs("span",{className:"text-gray-400",children:["Developed by ",e.jsx("span",{className:"font-semibold text-white",children:"Hously Finntech Realty"})]}),e.jsx("span",{className:"mx-2 text-gray-500",children:"|"}),e.jsx("span",{className:"text-gray-400",children:"Real Estate Experience."})]})})})}),e.jsx(E1,{open:m,onClose:()=>g(!1)}),e.jsx(M1,{open:b,onClose:()=>d(!1)}),e.jsx($1,{isPropertyDetail:r})]})},It={brand:"#E6761D",brandHover:"#CC6A1A",accent:"#0b3856",navText:"#0c3854"},bd=s=>typeof s=="object"&&s!==null,eu=s=>{var i;if(!bd(s))return!1;const a=s,t=(i=a.role)==null?void 0:i.toLowerCase(),r=a.buyer_id;return t==="buyer"&&r!=null&&r!==""},su=s=>{var i;if(!bd(s))return!1;const a=s,t=(i=a.role)==null?void 0:i.toLowerCase(),r=a.seller_id;return t==="seller"&&r!=null&&r!==""},D1=s=>{var r;if(!bd(s))return!1;const t=(r=s.role)==null?void 0:r.toLowerCase();return["admin","manager","executive","team leader","agent","staff"].includes(t||"")},R1=({currentPage:s=null,onPageChange:a,onAuthAction:t})=>{const r=Jr(),i=Ca(),{user:n,isAuthenticated:o,logout:m}=Hs(),{systemSettings:g}=ur(),b=(g==null?void 0:g.company_name)??"ResaleExpert",d=g==null?void 0:g.company_logo,v=g==null?void 0:g.footer_logo,[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState(!1),P=l.useRef(null),w=r.pathname==="/",[$,y]=l.useState(!w);l.useEffect(()=>{if(w){const h=()=>y(window.scrollY>10||x);return h(),window.addEventListener("scroll",h,{passive:!0}),()=>window.removeEventListener("scroll",h)}else y(!0)},[w,x]),l.useEffect(()=>{if(!o||!n)return;const h=r.pathname;if(!(!(h==="/login"||h==="/register")&&!h.includes("dashboard"))){if(eu(n)){const K=`/buyer-dashboard/${String(n.buyer_id)}`;h!==K&&i(K,{replace:!0});return}if(su(n)){const K=`/seller-dashboard/${String(n.seller_id)}`;h!==K&&i(K,{replace:!0});return}(D1(n)||n)&&h!=="/dashboard"&&i("/dashboard",{replace:!0})}},[o,n,r.pathname,i]);const k=()=>!o||!n?"/login":eu(n)?`/buyer-dashboard/${String(n.buyer_id)}`:su(n)?`/seller-dashboard/${String(n.seller_id)}`:"/dashboard",R=k();l.useEffect(()=>{var h;if(n){const Y=(h=n.role)==null?void 0:h.toLowerCase();N(Y==="admin"||Y==="manager")}else N(!1)},[n]),l.useEffect(()=>{const h=Y=>{if(!P.current)return;const K=Y.target;K&&!P.current.contains(K)&&f(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const F=[{id:"home",label:"Home",href:"/"},{id:"properties",label:"Properties",href:"/properties"},{id:"services",label:"Services",href:"/services"},{id:"about",label:"About",href:"/about"},{id:"blogs",label:"Blogs",href:"/blogs"},{id:"contact",label:"Contact",href:"/contact"}],T=h=>{a==null||a(h),u(!1)},j=(h,Y)=>s?s===h:Y?r.pathname===Y:!1,E=()=>{t?t("sell"):W(!0)},[V,W]=l.useState(!1),B=async h=>{try{alert("Seller information saved successfully!"),W(!1)}catch(Y){console.error("Error saving seller:",Y),alert("Failed to save seller information. Please try again.")}},M=(()=>{if(!n)return"User";const h=n==null?void 0:n.salutation,Y=n==null?void 0:n.first_name,K=n==null?void 0:n.last_name,q=[h,Y,K].filter(Boolean);return q.length?q.join(" "):"User"})(),A=o&&n?n.role:"",L=$?It.navText:"#ffffff",D=$?It.navText:"#ffffff",I="#E6761D",H=(()=>{const h=d||v,Y=v||d;return w?$?h:Y:h})();return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:$t("fixed top-0 left-0 right-0 z-50 transition-all duration-300",$?"bg-white backdrop-blur supports-[backdrop-filter]:backdrop-blur border-b border-gray-200 shadow-sm":"bg-transparent"),children:[e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-10",children:e.jsxs("div",{className:"flex items-center justify-between h-20",children:[e.jsx(Bs,{to:"/",className:"flex items-center space-x-3",children:H?e.jsx("img",{src:H,alt:`${b} Logo`,className:$t("h-16 w-auto object-contain rounded-lg p-1 transition-shadow",$?"":" ")}):e.jsx("h1",{className:"text-2xl font-bold bg-clip-text text-transparent",style:{backgroundImage:$?`linear-gradient(to right, ${It.navText}, ${It.brand})`:`linear-gradient(to right, #ffffff, ${It.brand})`},children:b})}),e.jsx("nav",{className:"hidden lg:flex items-center space-x-1",children:F.map(h=>{const Y=j(h.id,h.href),K="flex items-center mx-4 py-1 text-[16px] xl:text-[17px] font-medium border-b-2 transition-all duration-300 ease-in-out";return e.jsx("div",{className:"relative",children:h.href?e.jsx(Bs,{to:h.href,onClick:()=>T(h.id),"aria-current":Y?"page":void 0,style:{color:Y?I:L},className:$t(K,Y?"border-[#E6761D]":"border-transparent"),onMouseEnter:q=>{q.currentTarget.style.color=I,q.currentTarget.classList.add("border-[#E6761D]")},onMouseLeave:q=>{q.currentTarget.style.color=Y?I:L,q.currentTarget.classList.remove("border-[#E6761D]"),q.currentTarget.classList.add("border-transparent")},children:e.jsx("span",{children:h.label})}):e.jsx("button",{onClick:()=>T(h.id),"aria-current":Y?"page":void 0,style:{color:Y?I:L},className:$t(K,Y?"border-[#E6761D]":"border-transparent"),onMouseEnter:q=>{const ne=q.currentTarget;ne.style.color=I,ne.classList.add("border-[#E6761D]")},onMouseLeave:q=>{const ne=q.currentTarget;ne.style.color=Y?I:L,ne.classList.remove("border-[#E6761D]"),ne.classList.add("border-transparent")},children:e.jsx("span",{children:h.label})})},h.id)})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:E,className:"hidden sm:flex items-center space-x-2 text-white px-4 py-2.5 rounded-xl transition-all text-sm font-medium shadow-md hover:shadow-lg",style:{backgroundColor:It.brand},onMouseEnter:h=>h.currentTarget.style.backgroundColor=It.brandHover,onMouseLeave:h=>h.currentTarget.style.backgroundColor=It.brand,"aria-label":"Sell property",children:e.jsx("span",{className:"font-semibold",children:"Sell Property"})}),o?e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(Bs,{to:R,className:"hidden sm:flex items-center space-x-2 text-white px-5 py-2.5 rounded-xl text-sm font-medium transition-colors shadow-md hover:shadow-lg",style:{backgroundColor:It.navText},children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs("div",{className:"relative",ref:P,children:[e.jsx("button",{type:"button",onClick:()=>f(h=>!h),"aria-haspopup":"true","aria-expanded":c,className:"w-10 h-10 rounded-xl flex items-center justify-center border",style:{background:`linear-gradient(to right, ${It.brand}1A, ${It.accent}1A)`,borderColor:`${It.brand}4D`},children:e.jsx(Ms,{size:16,style:{color:"#E6761D"}})}),c&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-white rounded-2xl shadow-xl border border-gray-100 py-3 z-50",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:M}),e.jsx("div",{className:"text-xs text-[#E6761D] bg-orange-50 px-2 py-1 rounded-full inline-block mt-1",children:A?`${A.charAt(0).toUpperCase()+A.slice(1)} User`:"User"})]}),e.jsx("button",{className:"w-full text-left px-4 py-3 text-sm flex items-center space-x-3 text-gray-700 hover:text-[#E6761D] hover:bg-orange-50",children:e.jsx("span",{children:"Upgrade Plan"})}),e.jsx("div",{className:"border-t border-gray-100 mt-2 pt-2",children:e.jsx("button",{onClick:async()=>{f(!1),await m(),window.location.href="/login"},className:"w-full text-left px-4 py-3 text-sm flex items-center space-x-3 text-[#E6761D] hover:bg-red-50",children:e.jsx("span",{children:"Logout"})})})]})]})]}):e.jsx("div",{className:"hidden md:flex space-x-2 items-center",children:t?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>t("login"),className:"px-5 py-2.5 rounded-xl text-sm font-medium transition-colors duration-300 border",style:{color:L,borderColor:D,backgroundColor:"transparent"},onMouseEnter:h=>{const Y=h.currentTarget;Y.style.backgroundColor=It.brand,Y.style.color="#ffffff",Y.style.borderColor=It.brand},onMouseLeave:h=>{const Y=h.currentTarget;Y.style.backgroundColor="transparent",Y.style.color=L,Y.style.borderColor=D},children:"Login"}),e.jsx("button",{onClick:()=>t("signup"),className:"text-white px-5 py-2.5 rounded-xl transition-all text-sm font-medium shadow-md hover:shadow-lg",style:{background:`linear-gradient(to right, ${It.accent}, ${It.navText})`},children:"Sign Up"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Bs,{to:"/login",className:"flex items-center space-x-1 px-4 py-2.5 rounded-xl text-sm font-medium transition-colors duration-300 border",style:{color:L,borderColor:D,backgroundColor:"transparent"},onMouseEnter:h=>{const Y=h.currentTarget;Y.style.backgroundColor=It.brand,Y.style.color="#ffffff",Y.style.borderColor=It.brand},onMouseLeave:h=>{const Y=h.currentTarget;Y.style.backgroundColor="transparent",Y.style.color=L,Y.style.borderColor=D},children:e.jsx("span",{children:"Login"})}),e.jsx(Bs,{to:"/register",className:"text-white px-3.5 py-2.5 rounded-xl text-sm font-medium transition-shadow shadow-md hover:shadow-lg",style:{background:"linear-gradient(to right, #072c42, #092a3a)"},onMouseEnter:h=>{h.currentTarget.style.background="linear-gradient(to right, #0b3856, #0c3854)"},onMouseLeave:h=>{h.currentTarget.style.background="linear-gradient(to right, #072c42, #092a3a)"},children:"Get Started"})]})}),!o&&a&&e.jsx("button",{onClick:()=>a("admin-ai"),className:"hidden md:block text-xs px-3 py-2 rounded-full transition-colors border",style:{backgroundColor:"rgba(230,118,29,0.10)",color:It.brandHover,borderColor:"rgba(230,118,29,0.30)"},children:"Admin Panel"}),e.jsx("button",{onClick:()=>u(h=>!h),className:$t("lg:hidden p-2 rounded-xl transition-colors",$?"text-gray-700":"text-white"),"aria-label":x?"Close mobile menu":"Open mobile menu","aria-expanded":x,children:x?e.jsx(ns,{size:20}):e.jsx(so,{size:20})})]})]})}),x&&e.jsx("div",{className:"lg:hidden bg-white border-t border-gray-200 shadow-lg",children:e.jsxs("div",{className:"px-4 py-4 space-y-2",children:[F.map(h=>{const Y=j(h.id,h.href),K="w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-colors text-left border-b text-base";return h.href?e.jsx(Bs,{to:h.href,onClick:()=>T(h.id),"aria-current":Y?"page":void 0,style:{color:Y?"#E6761D":It.navText},className:$t(K,Y?"border-[#E6761D]":"border-transparent hover:text-[#E6761D] hover:border-[#E6761D]"),children:e.jsx("span",{className:"font-medium",children:h.label})},h.id):e.jsx("button",{onClick:()=>T(h.id),"aria-current":Y?"page":void 0,style:{color:Y?"#E6761D":It.navText},className:$t(K,Y?"border-[#E6761D]":"border-transparent hover:text-[#E6761D] hover:border-[#E6761D]"),children:e.jsx("span",{className:"font-medium",children:h.label})},h.id)}),e.jsxs("div",{className:"pt-4 border-t border-gray-200 space-y-3",children:[e.jsx("button",{onClick:E,className:"w-full flex items-center justify-center space-x-2 text-white px-4 py-3 rounded-xl font-medium text-sm shadow-md",style:{backgroundColor:It.brand},children:e.jsx("span",{children:"Sell Property"})}),o?e.jsxs(Bs,{to:k(),className:"w-full flex items-center justify-center space-x-2 text-white px-4 py-3 rounded-xl font-medium text-sm",style:{background:`linear-gradient(to right, ${It.accent}, ${It.navText})`},children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx("span",{children:"Dashboard"})]}):t?e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>t("login"),className:"flex-1 border px-4 py-3 rounded-xl font-medium text-sm transition-colors duration-300",style:{color:It.navText,borderColor:D},children:"Login"}),e.jsx("button",{onClick:()=>t("signup"),className:"flex-1 text-white px-4 py-3 rounded-xl font-medium text-sm",style:{background:`linear-gradient(to right, ${It.accent}, ${It.navText})`},children:"Sign Up"})]}):e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(Bs,{to:"/login",className:"flex-1 text-center border px-4 py-3 rounded-xl font-medium text-sm transition-colors duration-300",style:{color:It.navText,borderColor:D},children:"Login"}),e.jsx(Bs,{to:"/register",className:"flex-1 text-center text-white px-4 py-3 rounded-xl font-medium text-sm shadow-md hover:shadow-lg",style:{background:"linear-gradient(to right, #072c42, #092a3a)"},onMouseEnter:h=>{h.currentTarget.style.background="linear-gradient(to right, #0b3856, #0c3854)"},onMouseLeave:h=>{h.currentTarget.style.background="linear-gradient(to right, #072c42, #092a3a)"},children:"Get Started"})]})]})]})})]}),e.jsx("main",{className:"flex-1 ",children:e.jsx(uu,{})}),e.jsx(L1,{}),e.jsx(Bu,{isOpen:V,onClose:()=>W(!1),onSubmit:B})]})},z1=["Real Estate","Investment","Market Analysis","Legal","Home Buying","Home Selling","Property News","Construction","Finance"],Lc=/[\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,fr=s=>(s||"").replace(Lc,"").replace(/\sdir\s*=\s*"(?:rtl|auto)"/gi,' dir="ltr"').replace(/\sdir\s*=\s*'(?:rtl|auto)'/gi," dir='ltr'").replace(/direction\s*:\s*rtl\s*;?/gi,"direction:ltr;").replace(/unicode-bidi\s*:\s*(?:bidi-override|plaintext|isolate-override)\s*;?/gi,"unicode-bidi:isolate;"),F1=({post:s,onSave:a,onCancel:t,isOpen:r,currentUserName:i})=>{var Q,he;const n=!!(s!=null&&s.id),o=l.useMemo(()=>[i||"Admin","Admin",(s==null?void 0:s.author)||""].filter(Boolean),[i,s==null?void 0:s.author]),[m,g]=l.useState({title:"",content:"",excerpt:"",author:i||"Admin",category:"",tags:[],featured:!1,featuredImage:"",seoTitle:"",seoDescription:"",status:"draft"}),[b,d]=l.useState("edit"),[v,x]=l.useState(""),[u,c]=l.useState(!1),[f,p]=l.useState(!1),[N,P]=l.useState(null),[w,$]=l.useState(!1),[y,k]=l.useState(null),[R,F]=l.useState(null),T=l.useRef(null),[j,E]=l.useState("visual"),[V,W]=l.useState("");if(l.useEffect(()=>{var se;if(s){g({...s}),x(((se=s.tags)==null?void 0:se.join(", "))||"");const ge=fr(s.content||"");W(ge),s.featuredImage&&typeof s.featuredImage=="string"&&!s.featuredImage.startsWith("data:")?le(s.featuredImage):(k(null),$(!1),F(null))}else g({title:"",content:"",excerpt:"",author:i||"Admin",category:"",tags:[],featured:!1,featuredImage:"",seoTitle:"",seoDescription:"",status:"draft"}),x(""),W(""),k(null),$(!1),F(null)},[s,i]),l.useEffect(()=>{g(se=>({...se,content:V}))},[V]),l.useEffect(()=>{if(j!=="visual"||!T.current)return;const se=T.current,ge=fr(V||"");se.setAttribute("dir","ltr"),se.style.direction="ltr",se.style.textAlign="left",se.style.setProperty("unicode-bidi","isolate"),se.style.setProperty("writing-mode","horizontal-tb"),se.innerHTML!==ge&&(se.innerHTML=ge)},[j,V,b]),l.useEffect(()=>{const se=T.current;if(!se)return;const ge=de=>{var fe,G;de.preventDefault();const U=((fe=de.clipboardData)==null?void 0:fe.getData("text/html"))??"",X=((G=de.clipboardData)==null?void 0:G.getData("text"))??"",re=fr(U||X);document.execCommand(U?"insertHTML":"insertText",!1,re),W(se.innerHTML)},ee=de=>{const U=de.data??null;if(U&&Lc.test(U)){de.preventDefault();const X=U.replace(Lc,"");document.execCommand("insertText",!1,X),W(se.innerHTML)}};return se.addEventListener("paste",ge),se.addEventListener("beforeinput",ee),()=>{se.removeEventListener("paste",ge),se.removeEventListener("beforeinput",ee)}},[]),!r)return null;const B=se=>{const{name:ge,value:ee,type:de}=se.target,U=se.target.checked;if(ge==="featuredImage"){const X=ee;g(re=>({...re,featuredImage:X})),typeof X=="string"&&X.startsWith("data:")?(k(null),$(!1),F(null)):le(String(X));return}g(X=>({...X,[ge]:de==="checkbox"?U:ee}))},M=se=>{x(se),g(ge=>({...ge,tags:se.split(",").map(ee=>ee.trim()).filter(Boolean)}))},A=l.useCallback((se,ge)=>{var ee;j==="visual"&&((ee=T.current)==null||ee.focus(),document.execCommand(se,!1,ge),T.current&&W(T.current.innerHTML))},[j]),L=se=>{if(j!=="visual"||!T.current){W(re=>fr(re+se));return}T.current.focus();const ge=window.getSelection();if(!ge||!ge.rangeCount){const re=(T.current.innerHTML||"")+se;T.current.innerHTML=re,W(fr(re));return}const ee=ge.getRangeAt(0),de=document.createElement("div");de.innerHTML=se;const U=document.createDocumentFragment();let X;for(;X=de.firstChild;)U.appendChild(X);ee.deleteContents(),ee.insertNode(U),ge.collapseToEnd(),W(fr(T.current.innerHTML))},D=()=>L('<pre style="background:#0b1220;color:#d1fae5;padding:10px;border-radius:8px;overflow:auto;"><code>// your code here</code></pre>'),I=()=>L('<blockquote style="border-left:4px solid #2563eb;padding-left:12px;color:#334155;margin:8px 0;">Type your quoteâ€¦</blockquote>'),H=se=>{const ge=se.split(","),ee=(ge[0].match(/:(.*?);/)||[])[1]||"image/png",de=atob(ge[1]);let U=de.length;const X=new Uint8Array(U);for(;U--;)X[U]=de.charCodeAt(U);return new Blob([X],{type:ee})},h=se=>{const ge=se??m.status??"draft",ee={title:m.title||"",content:m.content||"",excerpt:m.excerpt||"",author:m.author||"",category:m.category||"",tags:m.tags||[],featured:!!m.featured,seoTitle:m.seoTitle||"",seoDescription:m.seoDescription||"",status:ge,publishedAt:ge==="published"?new Date().toISOString():null};if(m.featuredImage&&typeof m.featuredImage=="string"&&m.featuredImage.startsWith("data:")){const de=new FormData;Object.entries(ee).forEach(([re,fe])=>{fe!==void 0&&(re==="tags"?de.append("tags",JSON.stringify(fe)):de.append(re,String(fe)))});const U=H(m.featuredImage),X=U.type.split("/")[1]||"png";return de.append("featuredImage",U,`featured.${X}`),{payload:de,isFormData:!0}}return m.featuredImage&&(ee.featuredImage=m.featuredImage),{payload:ee,isFormData:!1}},Y=()=>(s==null?void 0:s.id)??(m==null?void 0:m.id),K=async se=>{c(!0),P(null);try{const{payload:ge,isFormData:ee}=h(se),de=Y();let U;de!=null?U=ee?await kt.updatePost(de,ge):await kt.updatePost(de,ge):U=ee?await kt.createPost(ge):await kt.createPost(ge),a(U),g(X=>({...X,...U||{}}))}catch(ge){console.error("Error saving post",ge),P((ge==null?void 0:ge.message)||"Failed to save post. Please try again.")}finally{c(!1)}},q=()=>K("draft"),ne=()=>K("published"),le=se=>{if(!se){k(null),$(!1),F(null);return}if(se.startsWith("data:")){k(null),$(!1);return}try{new URL(se)}catch{k("Invalid image URL"),$(!1),F(null);return}$(!0),k(null);const ge=new Image;ge.crossOrigin="anonymous",ge.src=se,ge.onload=()=>{$(!1),k(null),F({w:ge.naturalWidth,h:ge.naturalHeight}),g(ee=>({...ee,featuredImage:se}))},ge.onerror=()=>{$(!1),k("Could not load image from URL"),F(null)}},S=se=>{if(!se)return;const ge=new FileReader;ge.onload=ee=>{var X;const de=(X=ee.target)==null?void 0:X.result;g(re=>({...re,featuredImage:de}));const U=new Image;U.src=de,$(!0),U.onload=()=>{$(!1),k(null),F({w:U.naturalWidth,h:U.naturalHeight})},U.onerror=()=>{$(!1),k("Uploaded image could not be processed"),F(null)}},ge.readAsDataURL(se)},C=async()=>{const se=m.featuredImage||"";if(se)try{await navigator.clipboard.writeText(se),alert("Image URL copied to clipboard")}catch{}},J=()=>{const se=m.featuredImage||"";se&&window.open(se,"_blank","noopener")};Array.from(new Set([...o||[],m.author||""].filter(Boolean)));const ue=async()=>{if(!m.title){P("Enter a title first");return}p(!0),P(null);try{const se=await kt.aiGenerateFromTitle({title:m.title,tone:"professional",length:"medium",includeSEO:!0,includeImages:!0,includeToc:!0,audience:"general-public",category:m.category||" Real Estate"});if(!(se!=null&&se.success)||!(se!=null&&se.article))throw new Error((se==null?void 0:se.message)||"AI failed");const ge=se.article;W(fr(ge.content||"")),g(ee=>({...ee,title:ge.title||ee.title,excerpt:ge.excerpt||ee.excerpt,seoTitle:ge.seoTitle||ee.seoTitle,seoDescription:ge.seoDescription||ee.seoDescription,tags:Array.isArray(ge.tags)?ge.tags:ee.tags,category:ge.category||ee.category,status:"draft",publishedAt:null})),E("visual"),d("preview")}catch(se){P((se==null?void 0:se.message)||"AI request failed")}finally{p(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-6xl h-[92vh] flex flex-col",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-3 sm:p-4 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold",children:n?"Edit Post":"Create New Blog Post"}),e.jsx("p",{className:"text-xs opacity-90 hidden sm:block",children:n?`Editing: ${s==null?void 0:s.title}`:"Write and publish new content"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e.jsx(ns,{size:18})})]})}),e.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex",children:["edit","preview"].map(se=>e.jsx("button",{onClick:()=>d(se),className:`px-4 py-2 font-medium capitalize text-sm transition-colors ${b===se?"bg-white text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:se},se))})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:b==="edit"?e.jsxs("div",{className:"h-full overflow-y-auto p-3 sm:p-4 space-y-4",children:[e.jsx("section",{className:"bg-white p-1 sm:p-1",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Title *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",name:"title",value:m.title||"",onChange:B,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter title",required:!0}),e.jsx("button",{type:"button",onClick:ue,disabled:f||!m.title,className:"inline-flex items-center gap-1 whitespace-nowrap rounded-md bg-purple-600 px-3 py-2 text-xs text-white hover:bg-purple-700 disabled:opacity-60",title:"Generate full SEO article from Title",children:f?"Generatingâ€¦":e.jsxs(e.Fragment,{children:[e.jsx(Al,{size:14})," AI Write"]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Category *"}),e.jsxs("select",{name:"category",value:m.category||"",onChange:B,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select category"}),z1.map(se=>e.jsx("option",{value:se,children:se},se))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Author"}),e.jsx("select",{name:"author",value:m.author||"",onChange:B,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",children:Array.from(new Set([...o||[],m.author||""].filter(Boolean))).map(se=>e.jsx("option",{value:se,children:se},se))})]})]})}),e.jsxs("section",{className:"bg-white p-1 sm:p-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Featured Image URL"}),e.jsx("input",{type:"url",name:"featuredImage",value:m.featuredImage||"",onChange:B,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/image.jpg"}),e.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:[w&&e.jsx("span",{children:"Validating image..."}),y&&e.jsx("span",{className:"text-red-600",children:y}),!w&&!y&&R&&e.jsxs("span",{children:["Image size: ",R.w,"Ã—",R.h,"px"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Upload Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:se=>{var ee;const ge=(ee=se.target.files)==null?void 0:ee[0];S(ge)},className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500 file:mr-2 file:py-1 file:px-2 file:rounded-md file:border-0 file:text-xs file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Tags"}),e.jsx("input",{type:"text",value:v,onChange:se=>M(se.target.value),className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"tag1, tag2, tag3"}),m.tags&&m.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:m.tags.map((se,ge)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs",children:se},ge))})]})]}),m.featuredImage&&e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"relative max-w-xl",children:[e.jsx("img",{src:m.featuredImage,alt:"Featured preview",className:"w-full h-28 sm:h-32 object-cover rounded-md border",onLoad:se=>{const ge=se.currentTarget;R||(F({w:ge.naturalWidth,h:ge.naturalHeight}),k(null),$(!1))},onError:()=>k("Could not load preview")}),e.jsxs("div",{className:"absolute top-1 right-1 flex gap-1",children:[e.jsx("button",{type:"button",onClick:J,className:"bg-white text-gray-700 rounded px-2 py-1 text-xs hover:bg-gray-100",children:"Open"}),e.jsx("button",{type:"button",onClick:C,className:"bg-white text-gray-700 rounded px-2 py-1 text-xs hover:bg-gray-100",children:"Copy"}),e.jsx("button",{type:"button",onClick:()=>{g(se=>({...se,featuredImage:""})),F(null),k(null)},className:"bg-red-500 text-white rounded px-2 py-1 text-xs hover:bg-red-600",children:e.jsx(ns,{size:12})})]})]})})]}),e.jsxs("section",{className:"bg-white p-1 sm:p-1 space-y-2",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Excerpt *"}),e.jsx("textarea",{name:"excerpt",value:m.excerpt||"",onChange:B,rows:2,className:"w-full px-2 py-1.5 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Brief description",required:!0})]})}),e.jsxs("fieldset",{className:"border rounded-md",children:[e.jsx("legend",{className:"text-sm font-medium text-gray-600 px-2",children:"Content"}),e.jsxs("div",{className:"p-1 border-b border-gray-200 bg-gray-50 flex flex-wrap items-center gap-1 text-gray-700",children:[e.jsx("button",{onClick:()=>A("bold"),title:"Bold",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Hc,{size:16})}),e.jsx("button",{onClick:()=>A("italic"),title:"Italic",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Yc,{size:16})}),e.jsx("button",{onClick:()=>A("underline"),title:"Underline",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Gc,{size:16})}),e.jsx("button",{onClick:()=>A("strikeThrough"),title:"Strikethrough",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Kc,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>A("justifyLeft"),title:"Align Left",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Jc,{size:16})}),e.jsx("button",{onClick:()=>A("justifyCenter"),title:"Align Center",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Qc,{size:16})}),e.jsx("button",{onClick:()=>A("justifyRight"),title:"Align Right",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Zc,{size:16})}),e.jsx("button",{onClick:()=>A("justifyFull"),title:"Justify",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Xc,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>A("insertUnorderedList"),title:"Bulleted List",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(dn,{size:16})}),e.jsx("button",{onClick:()=>A("insertOrderedList"),title:"Numbered List",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(ed,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>{if(j!=="visual")return;const se=window.prompt("Enter URL (https://...)","https://");se&&A("createLink",se)},title:"Insert Link",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(za,{size:16})}),e.jsx("button",{onClick:()=>{if(j!=="visual")return;const se=window.prompt("Image URL (https://...)","https://");se&&A("insertImage",se)},title:"Insert Image",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Vi,{size:16})}),e.jsx("button",{onClick:D,title:"Code Block",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(rn,{size:16})}),e.jsx("button",{onClick:I,title:"Quote",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Au,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>A("undo"),title:"Undo",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(sd,{size:16})}),e.jsx("button",{onClick:()=>A("redo"),title:"Redo",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(td,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>E(se=>se==="visual"?"source":"visual"),title:j==="source"?"Switch to Visual":"Show HTML Source",className:`p-2 rounded hover:bg-gray-200 ${j==="source"?"bg-blue-100 text-blue-700":""}`,children:e.jsx(rn,{size:16})})]}),e.jsx("div",{className:"overflow-hidden",children:j==="visual"?e.jsx("div",{ref:T,contentEditable:!0,suppressContentEditableWarning:!0,onInput:se=>W(se.currentTarget.innerHTML),className:"min-h-[320px] p-4 text-gray-900 focus:outline-none max-w-none",dir:"ltr",style:{whiteSpace:"normal",direction:"ltr",textAlign:"left",unicodeBidi:"isolate",writingMode:"horizontal-tb"}}):e.jsx("textarea",{value:V,onChange:se=>W(fr(se.target.value)),className:"w-full min-h-[320px] p-4 font-mono text-sm bg-gray-900 text-green-300 rounded-b-md focus:outline-none resize-none",placeholder:"HTML source",dir:"ltr",style:{direction:"ltr",textAlign:"left"}})})]})]}),e.jsx("section",{className:"bg-white p-1 sm:p-1",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"SEO Title"}),e.jsx("input",{type:"text",name:"seoTitle",value:m.seoTitle||"",onChange:B,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",maxLength:60}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((Q=m.seoTitle)==null?void 0:Q.length)||0,"/60"]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"SEO Description"}),e.jsx("textarea",{name:"seoDescription",value:m.seoDescription||"",onChange:B,rows:2,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",maxLength:160}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((he=m.seoDescription)==null?void 0:he.length)||0,"/160"]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",name:"featured",checked:!!m.featured,onChange:B,className:"rounded mr-2"}),e.jsx("span",{children:"Featured Post"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:m.status||"draft",onChange:B,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsx("div",{className:"hidden lg:block"})]})})]}):e.jsx("div",{className:"h-full overflow-y-auto p-3 sm:p-4",children:e.jsxs("article",{className:"max-w-4xl mx-auto",children:[e.jsxs("header",{className:"text-center mb-4",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-2",children:m.title}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ms,{size:14}),e.jsx("span",{children:m.author})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ts,{size:14}),e.jsx("span",{children:new Date().toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mr,{size:14}),e.jsx("span",{children:m.category})]})]})]}),m.featuredImage&&e.jsx("img",{src:m.featuredImage,alt:m.title,className:"w-full h-32 sm:h-40 object-cover rounded-lg mb-4"}),e.jsx("div",{className:"prose prose-sm max-w-none text-sm",dir:"ltr",style:{direction:"ltr",textAlign:"left"},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:`<div class="leading-relaxed" dir="ltr" style="direction:ltr;text-align:left">${fr(m.content||"")}</div>`}})}),m.tags&&m.tags.length>0&&e.jsxs("footer",{className:"mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(mr,{size:16}),e.jsx("span",{className:"font-medium text-sm",children:"Tags:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:m.tags.map((se,ge)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:se},ge))})]})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between p-3 border-t bg-gray-50 gap-2",children:[e.jsxs("div",{className:"text-xs text-gray-600",children:["Status"," ",e.jsx("span",{className:`font-medium ${m.status==="published"?"text-green-600":m.status==="draft"?"text-yellow-600":"text-gray-600"}`,children:String(m.status||"draft").charAt(0).toUpperCase()+String(m.status||"draft").slice(1)}),N&&e.jsxs("span",{className:"text-red-600 ml-3",children:["Error: ",N]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:t,className:"flex-1 sm:flex-none px-3 py-1.5 text-sm border text-gray-700 rounded-md hover:bg-gray-100 transition-colors",disabled:u,children:"Cancel"}),e.jsxs("button",{onClick:q,className:"flex-1 sm:flex-none px-3 py-1.5 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors flex items-center justify-center gap-1",disabled:u,title:u?"Saving...":"Save as draft",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:u?"Saving...":"Draft"})]}),e.jsxs("button",{onClick:ne,className:"flex-1 sm:flex-none px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-1",disabled:u,title:u?"Publishing...":"Publish",children:[e.jsx(Dt,{size:14}),e.jsx("span",{children:u?m.status==="published"?"Publishing...":"Processing...":"Publish"})]})]})]})]})})},tu=["Real Estate","Investment","Market Analysis","Legal","Home Buying","Home Selling","Property News","Construction","Finance","Legal Updates"],B1=[{value:"professional",label:"Professional",description:"Formal and authoritative"},{value:"conversational",label:"Conversational",description:"Friendly and approachable"},{value:"expert",label:"Expert",description:"Technical and detailed"},{value:"beginner-friendly",label:"Beginner-Friendly",description:"Simple and educational"}],O1=[{value:"short",label:"Short",description:"300-500 words",time:"2-3 min read"},{value:"medium",label:"Medium",description:"800-1200 words",time:"4-6 min read"},{value:"long",label:"Long",description:"1500-2500 words",time:"7-12 min read"},{value:"comprehensive",label:"Comprehensive",description:"3000+ words",time:"15+ min read"}],U1=[{value:"property-investors",label:"Property Investors",description:"Looking for investment opportunities"},{value:"first-time-buyers",label:"First-time Buyers",description:"New to property buying"},{value:"real-estate-agents",label:"Real Estate Agents",description:"Industry professionals"},{value:"property-sellers",label:"Property Sellers",description:"Looking to sell properties"},{value:"general-public",label:"General Public",description:"Broad audience interest"}],Dc=/[\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,yr=s=>(s||"").replace(Dc,"").replace(/\sdir\s*=\s*"(?:rtl|auto)"/gi,' dir="ltr"').replace(/\sdir\s*=\s*'(?:rtl|auto)'/gi," dir='ltr'").replace(/direction\s*:\s*rtl\s*;?/gi,"direction:ltr;").replace(/unicode-bidi\s*:\s*(?:bidi-override|plaintext|isolate-override)\s*;?/gi,"unicode-bidi:isolate;");function au(s,a=400){const[t,r]=l.useState(s);return l.useEffect(()=>{const i=setTimeout(()=>r(s),a);return()=>clearTimeout(i)},[s,a]),t}const q1=({post:s,onSave:a,onCancel:t,isOpen:r,currentUserName:i})=>{var Me,Ye;const n=l.useRef(null),o=l.useRef(null);l.useEffect(()=>{n.current=typeof a=="function"?a:null},[a]),l.useEffect(()=>{o.current=typeof t=="function"?t:null},[t]),l.useEffect(()=>{n.current||console.warn("[AIBlogWriter] onSave prop was not provided or is not a function. Drafts will save but no parent callback will run.")},[]);const m=!!(s!=null&&s.id),g=l.useMemo(()=>[i||"Admin","Admin",(s==null?void 0:s.author)||""].filter(Boolean),[i,s==null?void 0:s.author]),[b,d]=l.useState({title:"",content:"",excerpt:"",author:i||"Admin",category:"",tags:[],featured:!1,featuredImage:"",seoTitle:"",seoDescription:"",status:"draft",publishedAt:null}),[v,x]=l.useState("edit"),[u,c]=l.useState(""),f=au(u,350),[p,N]=l.useState(!1),[P,w]=l.useState(null),[$,y]=l.useState(!1),[k,R]=l.useState(null),[F,T]=l.useState(null),j=l.useRef(null),[E,V]=l.useState("visual"),[W,B]=l.useState(""),[M,A]=l.useState(!1),[L,D]=l.useState(""),[I,H]=l.useState([]),[h,Y]=l.useState(""),[K,q]=l.useState("professional"),[ne,le]=l.useState("medium"),[S,C]=l.useState("Real Estate"),[J,ue]=l.useState("property-investors"),[Q,he]=l.useState(!0),[se,ge]=l.useState(!0),[ee,de]=l.useState(!0),[U,X]=l.useState(!1),[re,fe]=l.useState([]);if(l.useEffect(()=>{var ie;if(s){d({...s}),c(((ie=s.tags)==null?void 0:ie.join(", "))||"");const we=yr(s.content||"");B(we),C(s.category||"Real Estate"),s.featuredImage&&typeof s.featuredImage=="string"&&!s.featuredImage.startsWith("data:")?O(s.featuredImage):(R(null),y(!1),T(null))}else d({title:"",content:"",excerpt:"",author:i||"Admin",category:"Real Estate",tags:[],featured:!1,featuredImage:"",seoTitle:"",seoDescription:"",status:"draft",publishedAt:null}),c(""),B(""),C("Real Estate"),R(null),y(!1),T(null)},[s,i]),l.useEffect(()=>{d(ie=>({...ie,content:W}))},[W]),l.useEffect(()=>{if(E!=="visual"||!j.current)return;const ie=j.current,we=yr(W||"");ie.setAttribute("dir","ltr"),ie.style.direction="ltr",ie.style.textAlign="left",ie.style.setProperty("unicode-bidi","isolate"),ie.style.setProperty("writing-mode","horizontal-tb"),ie.innerHTML!==we&&(ie.innerHTML=we)},[E,W,v]),l.useEffect(()=>{const ie=j.current;if(!ie)return;const we=Ve=>{var rs,ms;Ve.preventDefault();const Je=((rs=Ve.clipboardData)==null?void 0:rs.getData("text/html"))??"",Ue=((ms=Ve.clipboardData)==null?void 0:ms.getData("text"))??"",Oe=yr(Je||Ue);document.execCommand(Je?"insertHTML":"insertText",!1,Oe),B(ie.innerHTML)},Be=Ve=>{const Je=Ve.data??null;if(Je&&Dc.test(Je)){Ve.preventDefault();const Ue=Je.replace(Dc,"");document.execCommand("insertText",!1,Ue),B(ie.innerHTML)}};return ie.addEventListener("paste",we),ie.addEventListener("beforeinput",Be),()=>{ie.removeEventListener("paste",we),ie.removeEventListener("beforeinput",Be)}},[]),!r)return null;const G=ie=>{const{name:we,value:Be,type:Ve}=ie.target,Je=ie.target.checked;if(we==="featuredImage"){const Ue=Be;d(Oe=>({...Oe,featuredImage:Ue})),typeof Ue=="string"&&Ue.startsWith("data:")?(R(null),y(!1),T(null)):O(String(Ue));return}d(Ue=>({...Ue,[we]:Ve==="checkbox"?Je:Be}))},me=ie=>{c(ie);const we=ie.split(",").map(Be=>Be.trim()).filter(Boolean);d(Be=>({...Be,tags:we})),H(we)},oe=l.useCallback((ie,we)=>{var Be;E==="visual"&&((Be=j.current)==null||Be.focus(),document.execCommand(ie,!1,we),j.current&&B(j.current.innerHTML))},[E]),Fe=ie=>{if(E!=="visual"||!j.current){B(Oe=>yr((Oe||"")+ie));return}j.current.focus();const we=window.getSelection();if(!we||!we.rangeCount){const Oe=(j.current.innerHTML||"")+ie;j.current.innerHTML=Oe,B(yr(Oe));return}const Be=we.getRangeAt(0),Ve=document.createElement("div");Ve.innerHTML=ie;const Je=document.createDocumentFragment();let Ue;for(;Ue=Ve.firstChild;)Je.appendChild(Ue);Be.deleteContents(),Be.insertNode(Je),we.collapseToEnd(),B(yr(j.current.innerHTML))},$e=()=>Fe('<pre style="background:#0b1220;color:#d1fae5;padding:10px;border-radius:8px;overflow:auto;"><code>// your code here</code></pre>'),Le=()=>Fe('<blockquote style="border-left:4px solid #2563eb;padding-left:12px;color:#334155;margin:8px 0;">Type your quoteâ€¦</blockquote>'),je=ie=>{const we=ie.split(","),Be=(we[0].match(/:(.*?);/)||[])[1]||"image/png",Ve=atob(we[1]);let Je=Ve.length;const Ue=new Uint8Array(Je);for(;Je--;)Ue[Je]=Ve.charCodeAt(Je);return new Blob([Ue],{type:Be})},_e=ie=>{const we=ie??b.status??"draft",Be={title:b.title||"",content:b.content||"",excerpt:b.excerpt||"",author:b.author||"",category:b.category||"",tags:b.tags||[],featured:!!b.featured,seoTitle:b.seoTitle||"",seoDescription:b.seoDescription||"",status:we,publishedAt:we==="published"?new Date().toISOString():null};if(b.featuredImage&&typeof b.featuredImage=="string"&&b.featuredImage.startsWith("data:")){const Ve=new FormData;Object.entries(Be).forEach(([Oe,rs])=>{rs!==void 0&&(Oe==="tags"?Ve.append("tags",JSON.stringify(rs)):Ve.append(Oe,String(rs)))});const Je=je(b.featuredImage),Ue=Je.type.split("/")[1]||"png";return Ve.append("featuredImage",Je,`featured.${Ue}`),{payload:Ve,isFormData:!0}}return b.featuredImage&&(Be.featuredImage=b.featuredImage),{payload:Be,isFormData:!1}},ve=()=>(s==null?void 0:s.id)??(b==null?void 0:b.id),Pe=async ie=>{N(!0),w(null);try{const{payload:we,isFormData:Be}=_e(ie),Ve=ve();let Je;if(Ve!=null?Je=Be?await kt.updatePost(Ve,we):await kt.updatePost(Ve,we):Je=Be?await kt.createPost(we):await kt.createPost(we),n.current)try{n.current(Je)}catch(Ue){console.warn("[AIBlogWriter] onSave callback threw:",Ue)}d(Ue=>({...Ue,...Je||{}})),Z.success(ie==="published"?"Post published":"Draft saved")}catch(we){console.error("Error saving post",we),w((we==null?void 0:we.message)||"Failed to save post. Please try again."),Z.error("Save failed")}finally{N(!1)}},We=()=>Pe("draft"),pe=()=>Pe("published"),O=ie=>{if(!ie){R(null),y(!1),T(null);return}if(ie.startsWith("data:")){R(null),y(!1);return}try{new URL(ie)}catch{R("Invalid image URL"),y(!1),T(null);return}y(!0),R(null);const we=new Image;we.crossOrigin="anonymous",we.src=ie,we.onload=()=>{y(!1),R(null),T({w:we.naturalWidth,h:we.naturalHeight}),d(Be=>({...Be,featuredImage:ie}))},we.onerror=()=>{y(!1),R("Could not load image from URL"),T(null)}},Ie=ie=>{if(!ie)return;const we=new FileReader;we.onload=Be=>{var Ue;const Ve=(Ue=Be.target)==null?void 0:Ue.result;d(Oe=>({...Oe,featuredImage:Ve}));const Je=new Image;Je.src=Ve,y(!0),Je.onload=()=>{y(!1),R(null),T({w:Je.naturalWidth,h:Je.naturalHeight})},Je.onerror=()=>{y(!1),R("Uploaded image could not be processed"),T(null)}},we.readAsDataURL(ie)},ze=async()=>{const ie=b.featuredImage||"";if(ie)try{await navigator.clipboard.writeText(ie),Z.success("Image URL copied")}catch{}},xe=()=>{const ie=b.featuredImage||"";ie&&window.open(ie,"_blank","noopener")},Ee=Array.from(new Set([...g||[],b.author||""].filter(Boolean))),Ke=["Best Areas for Real Estate Investment in Mumbai 2025","Complete Guide to Home Loan Process in India","How to Calculate Property ROI and Investment Returns","Legal Documents Required for Property Purchase","Real Estate Market Predictions for Next 5 Years","Commercial vs Residential Property Investment","Tax Benefits and Deductions for Property Owners","How to Evaluate Property Before Buying","Real Estate Investment Trusts (REITs) Guide","Property Valuation Methods and Techniques","Understanding RERA and its Impact on Buyers","Rental Property Management Best Practices"],Xe={"property-investors":["investment","roi","returns","portfolio","analysis","yield","cash flow"],"first-time-buyers":["guide","beginner","process","tips","checklist","loan","emi"],"real-estate-agents":["market","leads","sales","clients","strategies","crm"],"property-sellers":["selling","valuation","marketing","pricing","documents","staging"],"general-public":["trends","news","market","overview","updates"]},ye=l.useCallback(()=>{const ie=new Set([...I||[],...b.tags||[],...b.category?[b.category]:[],...b.title?b.title.split(/\W+/):[]].map(Ve=>(Ve||"").toString().toLowerCase()).filter(Boolean)),we=Xe[J]||[],Be=Ke.map(Ve=>({text:Ve,score:0})).map(Ve=>{const Je=Ve.text.toLowerCase();return ie.forEach(Ue=>{Ue&&Je.includes(Ue)&&(Ve.score+=2)}),we.forEach(Ue=>{Je.includes(Ue)&&(Ve.score+=1)}),Je.includes("mumbai")&&(Ve.score+=1),Je.includes("india")&&(Ve.score+=1),Je.includes("2025")&&(Ve.score+=1),Ve}).sort((Ve,Je)=>Je.score-Ve.score).slice(0,6).map(Ve=>Ve.text);fe(Be.length?Be:Ke.slice(0,6))},[J,I,b.tags,b.category,b.title]),Ce=au(b.title||"",350);l.useEffect(()=>{ye()},[ye,Ce,f]);const _=async()=>{var we;if(!b.title&&!L){w("Enter a Title (or AI Topic) first"),Z.error("Enter a Title or choose a suggested topic");return}const ie=((we=b.title)==null?void 0:we.trim())||L.trim();X(!0),w(null);try{const Be=[(b.category||S||"Real Estate").toLowerCase(),(J||"general-public").replace("-"," "),"2025","Mumbai","India",...b.tags||[]],Ve=Array.from(new Set([...I||[],...Be])),Je=await kt.aiGenerateFromTitle({title:ie,tone:K,length:ne,includeSEO:se,includeImages:Q,includeToc:ee,audience:J||"general-public",category:b.category||S||"Real Estate",keywords:Ve});if(!(Je!=null&&Je.success)||!(Je!=null&&Je.article))throw new Error((Je==null?void 0:Je.message)||"AI failed");const Ue=Je.article,Oe=(typeof(Ue==null?void 0:Ue.featuredImage)=="string"?Ue.featuredImage:"")||b.featuredImage||"";B(yr(Ue.content||"")),d(rs=>({...rs,title:Ue.title||rs.title||ie,excerpt:Ue.excerpt||rs.excerpt||"",seoTitle:Ue.seoTitle||rs.seoTitle||Ue.title||ie,seoDescription:Ue.seoDescription||rs.seoDescription||"",tags:Array.isArray(Ue.tags)?Ue.tags:rs.tags||[],category:Ue.category||rs.category||S,featuredImage:Oe,status:"draft",publishedAt:null})),Oe&&!Oe.startsWith("data:")&&O(Oe),V("visual"),x("preview"),Z.success("AI draft generated")}catch(Be){w((Be==null?void 0:Be.message)||"AI request failed"),Z.error((Be==null?void 0:Be.message)||"AI request failed")}finally{X(!1)}},ae=()=>{const ie=h.trim();if(ie){if(I.includes(ie)||H([...I,ie]),!(b.tags||[]).includes(ie)){const we=Array.from(new Set([...b.tags||[],ie]));d(Be=>({...Be,tags:we})),c(we.join(", "))}Y("")}},ke=ie=>{H(I.filter(Be=>Be!==ie));const we=(b.tags||[]).filter(Be=>Be!==ie);d(Be=>({...Be,tags:we})),c(we.join(", "))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-7xl h-[92vh] flex",children:[e.jsxs("aside",{className:"border-r bg-gray-50 w-80 shrink-0 hidden md:flex md:flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-r from-purple-600 to-pink-600 text-white flex items-center justify-center",children:e.jsx(Mt,{size:18})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"AI Blog Writer"}),e.jsx("div",{className:"text-xs text-gray-500",children:"SEO + ToC + Images"})]})]}),e.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"AI Topic / Title"}),e.jsx("textarea",{value:L,onChange:ie=>D(ie.target.value),rows:2,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",placeholder:""})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:"Smart Suggestions"}),e.jsxs("button",{onClick:ye,className:"text-xs text-purple-600 hover:text-purple-800 flex items-center gap-1",children:[e.jsx(na,{size:12})," Refresh"]})]}),e.jsx("div",{className:"space-y-2",children:re.map((ie,we)=>e.jsx("button",{onClick:()=>{D(ie),d(Be=>({...Be,title:Be.title||ie}))},className:"w-full p-2 text-left bg-white border rounded-lg hover:border-purple-300 hover:bg-purple-50 text-xs",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(zt,{className:"text-purple-600 mt-0.5",size:14}),e.jsx("span",{children:ie})]})},we))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Target Audience"}),e.jsx("select",{value:J,onChange:ie=>ue(ie.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm",children:U1.map(ie=>e.jsxs("option",{value:ie.value,children:[ie.label," â€” ",ie.description]},ie.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("select",{value:b.category||S,onChange:ie=>{C(ie.target.value),d(we=>({...we,category:ie.target.value}))},className:"w-full px-3 py-2 border rounded-lg text-sm",children:tu.map(ie=>e.jsx("option",{value:ie,children:ie},ie))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Writing Tone"}),e.jsx("select",{value:K,onChange:ie=>q(ie.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm",children:B1.map(ie=>e.jsx("option",{value:ie.value,children:ie.label},ie.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Content Length"}),e.jsx("select",{value:ne,onChange:ie=>le(ie.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm",children:O1.map(ie=>e.jsxs("option",{value:ie.value,children:[ie.label," â€¢ ",ie.time]},ie.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Keywords & Tags"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:ie=>Y(ie.target.value),onKeyDown:ie=>ie.key==="Enter"&&(ie.preventDefault(),ae()),placeholder:"Add keywordâ€¦",className:"flex-1 px-3 py-2 border rounded-lg text-sm"}),e.jsx("button",{onClick:ae,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:e.jsx(fs,{size:16})})]}),I.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:I.map((ie,we)=>e.jsxs("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs flex items-center gap-1",children:[ie,e.jsx("button",{onClick:()=>ke(ie),className:"hover:text-purple-900",children:e.jsx(ns,{size:12})})]},we))})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-gray-900 mb-1",children:[e.jsx(Yt,{className:"text-blue-600",size:18}),"Advanced"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:ee,onChange:ie=>de(ie.target.checked),className:"rounded border-gray-300 text-purple-600"}),e.jsx("span",{children:"Table of Contents"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:ie=>he(ie.target.checked),className:"rounded border-gray-300 text-purple-600"}),e.jsx("span",{children:"Auto Images"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:se,onChange:ie=>ge(ie.target.checked),className:"rounded border-gray-300 text-purple-600"}),e.jsx("span",{children:"SEO Optimization"})]})]}),e.jsx("button",{onClick:_,disabled:U||!b.title&&!L,className:"w-full mt-1 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-3 rounded-lg hover:from-purple-700 hover:to-pink-700 font-semibold disabled:opacity-50 flex items-center justify-center gap-2",children:U?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Generatingâ€¦"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Al,{size:18}),e.jsx("span",{children:"Generate AI Draft"}),e.jsx(zt,{size:16})]})}),U&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 mt-2 text-xs space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-purple-900",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600"}),"AI is generating your contentâ€¦"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"text-green-600",size:12})," Analyzing topic & keywords"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"text-yellow-600",size:12})," Writing SEO-optimized article"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ls,{className:"text-gray-400",size:12})," Building ToC & anchors"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-3 mt-2 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx(Va,{className:"text-green-600",size:16})," AI Content Insights"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Rs,{className:"text-green-600",size:14}),e.jsx("span",{className:"font-medium",children:"Trending"})]}),e.jsxs("ul",{className:"space-y-0.5",children:[e.jsx("li",{children:"â€¢ Investment strategies"}),e.jsx("li",{children:"â€¢ Mumbai market analysis"}),e.jsx("li",{children:"â€¢ Home loan updates"}),e.jsx("li",{children:"â€¢ RERA compliance"})]})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(it,{className:"text-blue-600",size:14}),e.jsx("span",{className:"font-medium",children:"High-Ranking Keywords"})]}),e.jsxs("ul",{className:"space-y-0.5",children:[e.jsx("li",{children:"â€¢ real estate investment"}),e.jsx("li",{children:"â€¢ property market trends"}),e.jsx("li",{children:"â€¢ home buying guide"}),e.jsx("li",{children:"â€¢ Mumbai properties"})]})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ot,{className:"text-purple-600",size:14}),e.jsx("span",{className:"font-medium",children:"Performance Hints"})]}),e.jsxs("ul",{className:"space-y-0.5",children:[e.jsx("li",{children:"â€¢ Guides: +30% time on page"}),e.jsx("li",{children:"â€¢ Market analysis: +22% shares"}),e.jsx("li",{children:"â€¢ Investment: +15% engagement"})]})]})]})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-3 sm:p-4 rounded-t-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold",children:m?"Edit Post":"Create New Blog Post"}),e.jsx("p",{className:"text-xs opacity-90 hidden sm:block",children:m?`Editing: ${s==null?void 0:s.title}`:"Write and publish new content"})]})}),e.jsx("button",{onClick:()=>{var ie;return(ie=o.current)==null?void 0:ie.call(o)},className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e.jsx(ns,{size:18})})]})}),e.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:e.jsx("div",{className:"flex",children:["edit","preview"].map(ie=>e.jsx("button",{onClick:()=>x(ie),className:`px-4 py-2 font-medium capitalize text-sm transition-colors ${v===ie?"bg-white text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:ie},ie))})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:v==="edit"?e.jsxs("div",{className:"h-full overflow-y-auto p-3 sm:p-4 space-y-4",children:[e.jsx("section",{className:"bg-white p-1 sm:p-1",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Title *"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{type:"text",name:"title",value:b.title||"",onChange:ie=>{G(ie)},className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter title",required:!0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Category *"}),e.jsxs("select",{name:"category",value:b.category||"",onChange:G,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select category"}),tu.map(ie=>e.jsx("option",{value:ie,children:ie},ie))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Author"}),e.jsx("select",{name:"author",value:b.author||"",onChange:G,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",children:Ee.map(ie=>e.jsx("option",{value:ie,children:ie},ie))})]})]})}),e.jsxs("section",{className:"bg-white p-1 sm:p-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Featured Image URL"}),e.jsx("input",{type:"url",name:"featuredImage",value:b.featuredImage||"",onChange:G,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com/image.jpg"}),e.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:[$&&e.jsx("span",{children:"Validating image..."}),k&&e.jsx("span",{className:"text-red-600",children:k}),!$&&!k&&F&&e.jsxs("span",{children:["Image size: ",F.w,"Ã—",F.h,"px"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Upload Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:ie=>{var Be;const we=(Be=ie.target.files)==null?void 0:Be[0];Ie(we)},className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500 file:mr-2 file:py-1 file:px-2 file:rounded-md file:border-0 file:text-xs file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Tags / Keywords"}),e.jsx("input",{type:"text",value:u,onChange:ie=>me(ie.target.value),className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"tag1, tag2, tag3"}),b.tags&&b.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:b.tags.map((ie,we)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs",children:ie},we))})]})]}),b.featuredImage&&e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"relative max-w-xl",children:[e.jsx("img",{src:b.featuredImage,alt:"Featured preview",className:"w-full h-28 sm:h-32 object-cover rounded-md border",onLoad:ie=>{const we=ie.currentTarget;F||(T({w:we.naturalWidth,h:we.naturalHeight}),R(null),y(!1))},onError:()=>R("Could not load preview")}),e.jsxs("div",{className:"absolute top-1 right-1 flex gap-1",children:[e.jsx("button",{type:"button",onClick:xe,className:"bg-white text-gray-700 rounded px-2 py-1 text-xs hover:bg-gray-100",children:"Open"}),e.jsx("button",{type:"button",onClick:ze,className:"bg-white text-gray-700 rounded px-2 py-1 text-xs hover:bg-gray-100",children:"Copy"}),e.jsx("button",{type:"button",onClick:()=>{d(ie=>({...ie,featuredImage:""})),T(null),R(null)},className:"bg-red-500 text-white rounded px-2 py-1 text-xs hover:bg-red-600",children:e.jsx(ns,{size:12})})]})]})})]}),e.jsxs("section",{className:"bg-white p-1 sm:p-1 space-y-2",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Excerpt *"}),e.jsx("textarea",{name:"excerpt",value:b.excerpt||"",onChange:G,rows:2,className:"w-full px-2 py-1.5 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Brief description",required:!0})]})}),e.jsxs("fieldset",{className:"border rounded-md",children:[e.jsx("legend",{className:"text-sm font-medium text-gray-600 px-2",children:"Content"}),e.jsxs("div",{className:"p-1 border-b border-gray-200 bg-gray-50 flex flex-wrap items-center gap-1 text-gray-700",children:[e.jsx("button",{onClick:()=>oe("bold"),title:"Bold",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Hc,{size:16})}),e.jsx("button",{onClick:()=>oe("italic"),title:"Italic",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Yc,{size:16})}),e.jsx("button",{onClick:()=>oe("underline"),title:"Underline",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Gc,{size:16})}),e.jsx("button",{onClick:()=>oe("strikeThrough"),title:"Strikethrough",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Kc,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>oe("justifyLeft"),title:"Align Left",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Jc,{size:16})}),e.jsx("button",{onClick:()=>oe("justifyCenter"),title:"Align Center",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Qc,{size:16})}),e.jsx("button",{onClick:()=>oe("justifyRight"),title:"Align Right",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Zc,{size:16})}),e.jsx("button",{onClick:()=>oe("justifyFull"),title:"Justify",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Xc,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>oe("insertUnorderedList"),title:"Bulleted List",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(dn,{size:16})}),e.jsx("button",{onClick:()=>oe("insertOrderedList"),title:"Numbered List",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(ed,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>{if(E!=="visual")return;const ie=window.prompt("Enter URL (https://...)","https://");ie&&oe("createLink",ie)},title:"Insert Link",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(za,{size:16})}),e.jsx("button",{onClick:()=>{if(E!=="visual")return;const ie=window.prompt("Image URL (https://...)","https://");ie&&oe("insertImage",ie)},title:"Insert Image",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Vi,{size:16})}),e.jsx("button",{onClick:$e,title:"Code Block",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(rn,{size:16})}),e.jsx("button",{onClick:Le,title:"Quote",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(Au,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>oe("undo"),title:"Undo",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(sd,{size:16})}),e.jsx("button",{onClick:()=>oe("redo"),title:"Redo",className:"p-2 rounded hover:bg-gray-200",children:e.jsx(td,{size:16})}),e.jsx("span",{className:"w-px h-5 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>V(ie=>ie==="visual"?"source":"visual"),title:E==="source"?"Switch to Visual":"Show HTML Source",className:`p-2 rounded hover:bg-gray-200 ${E==="source"?"bg-blue-100 text-blue-700":""}`,children:e.jsx(rn,{size:16})})]}),e.jsx("div",{className:"overflow-hidden",children:E==="visual"?e.jsx("div",{ref:j,contentEditable:!0,suppressContentEditableWarning:!0,onInput:ie=>B(ie.currentTarget.innerHTML),className:"min-h-[320px] p-4 text-gray-900 focus:outline-none max-w-none",dir:"ltr",style:{whiteSpace:"normal",direction:"ltr",textAlign:"left",unicodeBidi:"isolate",writingMode:"horizontal-tb"}}):e.jsx("textarea",{value:W,onChange:ie=>B(yr(ie.target.value)),className:"w-full min-h-[320px] p-4 font-mono text-sm bg-gray-900 text-green-300 rounded-b-md focus:outline-none resize-none",placeholder:"HTML source",dir:"ltr",style:{direction:"ltr",textAlign:"left"}})})]})]}),e.jsx("section",{className:"bg-white p-1 sm:p-1",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"SEO Title"}),e.jsx("input",{type:"text",name:"seoTitle",value:b.seoTitle||"",onChange:G,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",maxLength:60}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((Me=b.seoTitle)==null?void 0:Me.length)||0,"/60"]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"SEO Description"}),e.jsx("textarea",{name:"seoDescription",value:b.seoDescription||"",onChange:G,rows:2,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",maxLength:160}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((Ye=b.seoDescription)==null?void 0:Ye.length)||0,"/160"]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx("input",{type:"checkbox",name:"featured",checked:!!b.featured,onChange:G,className:"rounded mr-2"}),e.jsx("span",{children:"Featured Post"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:b.status||"draft",onChange:G,className:"w-full px-4 py-2 text-sm border rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsx("div",{className:"hidden lg:block"})]})})]}):e.jsx("div",{className:"h-full overflow-y-auto p-3 sm:p-4",children:e.jsxs("article",{className:"max-w-4xl mx-auto",children:[e.jsxs("header",{className:"text-center mb-4",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-2",children:b.title}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ms,{size:14}),e.jsx("span",{children:b.author})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ts,{size:14}),e.jsx("span",{children:new Date().toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mr,{size:14}),e.jsx("span",{children:b.category})]})]})]}),b.featuredImage&&e.jsx("img",{src:b.featuredImage,alt:b.title,className:"w-full h-32 sm:h-40 object-cover rounded-lg mb-4"}),e.jsx("div",{className:"prose prose-sm max-w-none text-sm",dir:"ltr",style:{direction:"ltr",textAlign:"left"},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:`<div class="leading-relaxed" dir="ltr" style="direction:ltr;text-align:left">${yr(b.content||"")}</div>`}})}),b.tags&&b.tags.length>0&&e.jsxs("footer",{className:"mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(mr,{size:16}),e.jsx("span",{className:"font-medium text-sm",children:"Tags:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:b.tags.map((ie,we)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:ie},we))})]})]})})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between p-3 border-t bg-gray-50 gap-2 rounded-b-xl",children:[e.jsxs("div",{className:"text-xs text-gray-600",children:["Status"," ",e.jsx("span",{className:`font-medium ${b.status==="published"?"text-green-600":b.status==="draft"?"text-yellow-600":"text-gray-600"}`,children:String(b.status||"draft").charAt(0).toUpperCase()+String(b.status||"draft").slice(1)}),P&&e.jsxs("span",{className:"text-red-600 ml-3",children:["Error: ",P]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>{var ie;return(ie=o.current)==null?void 0:ie.call(o)},className:"flex-1 sm:flex-none px-3 py-1.5 text-sm border text-gray-700 rounded-md hover:bg-gray-100 transition-colors",disabled:p,children:"Cancel"}),e.jsxs("button",{onClick:We,className:"flex-1 sm:flex-none px-3 py-1.5 text-sm bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors flex items-center justify-center gap-1",disabled:p,title:p?"Saving...":"Save as draft",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:p?"Savingâ€¦":"Draft"})]}),e.jsxs("button",{onClick:pe,className:"flex-1 sm:flex-none px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-1",disabled:p,title:p?"Publishing...":"Publish",children:[e.jsx(Dt,{size:14}),e.jsx("span",{children:p?b.status==="published"?"Publishingâ€¦":"Processingâ€¦":"Publish"})]})]})]})]})]})})},Qa={getAll:async()=>{const{data:s}=await Ae.get("/rss-sources");return s},getById:async s=>{if(s==null)throw new Error("RSS Source ID is required");const{data:a}=await Ae.get(`/rss-sources/${s}`);return a},create:async s=>{if(!(s!=null&&s.name)||!(s!=null&&s.url))throw new Error("Name and URL are required");const{data:a}=await Ae.post("/rss-sources",s);return a},update:async(s,a)=>{if(s==null)throw new Error("RSS Source ID is required");const{data:t}=await Ae.put(`/rss-sources/${s}`,a);return t},delete:async s=>{if(s==null)throw new Error("RSS Source ID is required");const{data:a}=await Ae.delete(`/rss-sources/${s}`);return a},toggle:async s=>{if(s==null)throw new Error("RSS Source ID is required");const{data:a}=await Ae.patch(`/rss-sources/${s}/toggle`);return a},syncOne:async s=>{if(s==null)throw new Error("RSS Source ID is required");const{data:a}=await Ae.post(`/rss-sources/${s}/sync`);return a},syncAll:async()=>{const{data:s}=await Ae.post("/rss-sources/sync-all");return s},validate:async s=>{if(!s)throw new Error("URL is required");const{data:a}=await Ae.get("/rss-sources/validate",{params:{url:s}});return a},proxy:async(s,a=10)=>{if(!s)throw new Error("URL is required");const{data:t}=await Ae.get("/rss-sources/proxy",{params:{url:s,limit:a}});return t},scan:async s=>{if(s==null)throw new Error("RSS Source ID is required");const{data:a}=await Ae.post(`/rss-sources/${s}/scan`);return a},importDrafts:async s=>{if(s==null)throw new Error("RSS Source ID is required");const{data:a}=await Ae.post(`/rss-sources/${s}/import`);return a}};function $g(s){if(!s)return null;const a=new Date(s);return isNaN(a.getTime())?null:a}function V1(s){const a=$g(s);return a?a.toLocaleString("en-IN",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"Never"}function W1(s){const a=$g(s);if(!a)return{color:"gray",text:"Not synced"};const t=Date.now()-a.getTime();if(t<0)return{color:"green",text:"just now"};const r=Math.floor(t/(1e3*60*60));return r<1?{color:"green",text:"Recently synced"}:r<24?{color:"yellow",text:`${r}h ago`}:{color:"red",text:`${Math.floor(r/24)}d ago`}}const H1={green:"text-green-600",yellow:"text-yellow-600",red:"text-red-600",gray:"text-gray-500"},ru=s=>s===!0||s===1,Y1=({source:s,isLoading:a=!1,onSync:t,onImport:r,onToggle:i,onEdit:n,onDelete:o})=>{const m=ru(s.active),g=ru(s.autoPublish),b=W1(s.lastSync??null),d=H1[b.color];return e.jsxs("div",{className:`border-2 rounded-xl p-4 sm:p-5 md:p-6 transition-all hover:shadow-lg ${m?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50"}`,"aria-busy":a,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center flex-wrap gap-2 mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${m?"bg-green-500 animate-pulse":"bg-gray-400"}`,"aria-label":m?"Active":"Inactive",title:m?"Active":"Inactive"}),e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-900 truncate",children:s.name}),g&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs font-medium inline-flex items-center gap-1",children:[e.jsx(Ft,{size:10,"aria-hidden":!0}),e.jsx("span",{children:"Auto"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2 min-w-0",children:[e.jsx(_t,{size:14,className:"shrink-0","aria-hidden":!0}),e.jsx("span",{className:"truncate break-all max-w-full sm:max-w-[28rem] md:max-w-[36rem]",children:s.url})]}),s.category&&e.jsx("span",{className:"inline-block bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs",children:s.category})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:justify-end",children:[e.jsx("button",{onClick:()=>t(s.id),disabled:a||!m,className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:m?"Sync Now (scan only)":"Activate to sync","aria-label":"Sync Now (scan only)",children:e.jsx(na,{className:a?"animate-spin":"",size:16})}),e.jsx("button",{onClick:()=>i(s.id),className:`p-2 rounded-lg transition-colors ${m?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:m?"Deactivate":"Activate","aria-label":m?"Deactivate":"Activate",children:m?e.jsx(_a,{size:16}):e.jsx(ns,{size:16})}),e.jsx("button",{onClick:()=>n(s),className:"p-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors",title:"Edit","aria-label":"Edit",children:e.jsx(ft,{size:16})}),e.jsx("button",{onClick:()=>o(s.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Delete","aria-label":"Delete",children:e.jsx(Es,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:s.totalPosts??0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Posts"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[e.jsx("div",{className:`text-lg font-bold ${(s.newPosts??0)>0?"text-green-600":"text-gray-500"}`,children:s.newPosts??0}),e.jsx("div",{className:"text-xs text-gray-600",children:"New Posts"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[e.jsx("div",{className:`text-xs font-medium ${d}`,children:b.text}),e.jsx("div",{className:"text-xs text-gray-600",children:"Sync Status"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(Ls,{size:12,className:"text-gray-500","aria-hidden":!0}),e.jsx("span",{className:"text-xs text-gray-600",children:V1(s.lastSync??null)})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Last Sync"})]})]}),(s.newPosts??0)>0&&e.jsxs("div",{className:"bg-green-100 border border-green-200 rounded-lg p-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"text-green-600",size:16,"aria-hidden":!0}),e.jsxs("span",{className:"text-green-800 text-sm",children:[s.newPosts," new articles ready to import"]})]}),e.jsx("button",{onClick:()=>r(s.id),className:"sm:ml-auto text-green-700 hover:text-green-800 font-medium text-sm","aria-label":"Import new articles as drafts",children:"Import Now"})]}),!m&&e.jsxs("div",{className:"mt-2 bg-gray-100 border border-gray-200 rounded-lg p-3 flex items-start sm:items-center gap-2",children:[e.jsx(ct,{className:"text-gray-500 shrink-0",size:16,"aria-hidden":!0}),e.jsx("span",{className:"text-gray-600 text-sm",children:"Source is inactive â€” no automatic syncing"})]})]})},G1=({open:s,onClose:a,form:t,setForm:r,editingSource:i,onSubmit:n,categories:o,predefinedSources:m,onAddPredefined:g})=>s?e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-2 sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/60 via-black/50 to-black/60 backdrop-blur-sm",onClick:a,"aria-hidden":!0}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[92vh] overflow-hidden border border-gray-100",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-gradient-to-r from-blue-600 via-blue-700 to-purple-600 px-4 sm:px-6 py-4 sm:py-5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Th,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:i?"Edit RSS Source":"Add New RSS Source"}),e.jsx("p",{className:"text-xs sm:text-sm text-white/90 hidden sm:block",children:i?"Update source configuration":"Configure your RSS feed source"})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg text-white hover:bg-white/20 transition-all duration-200 hover:scale-110","aria-label":"Close modal",children:e.jsx(ns,{size:20})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(92vh-180px)] p-4 sm:p-6",children:e.jsxs("div",{className:"space-y-6",children:[!i&&m.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-4 sm:p-5 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-blue-600 to-purple-600 rounded-full"}),e.jsx("h4",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Quick Add Popular Sources"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.map((b,d)=>e.jsx("button",{onClick:()=>g(b),className:"group p-4 bg-white border-2 border-gray-200 rounded-xl text-left hover:border-blue-400 hover:shadow-lg transition-all duration-200 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex-shrink-0 group-hover:scale-110 transition-transform",children:e.jsx(_t,{className:"text-white",size:18})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h5",{className:"font-semibold text-gray-900 group-hover:text-blue-700 transition-colors truncate",children:b.name}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-2 line-clamp-2",children:b.description}),e.jsx("span",{className:"inline-block text-xs bg-gradient-to-r from-blue-100 to-purple-100 text-blue-800 px-3 py-1 rounded-full font-medium",children:b.category})]})]})},d))}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t-2 border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-4 bg-gradient-to-r from-blue-50 to-purple-50 text-gray-600 font-medium",children:"Or add custom source"})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 sm:p-5 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-gray-600 to-gray-800 rounded-full"}),e.jsx("h4",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Source Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Source Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.name??"",onChange:b=>r(d=>({...d,name:b.target.value})),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white",placeholder:"Economic Times Real Estate"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["RSS Feed URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"url",value:t.url??"",onChange:b=>r(d=>({...d,url:b.target.value})),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white",placeholder:"https://example.com/rss"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:t.category??"Property News",onChange:b=>r(d=>({...d,category:b.target.value})),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white",children:o.map(b=>e.jsx("option",{value:b,children:b},b))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-teal-50 rounded-xl p-4 sm:p-5 border border-green-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ls,{className:"text-green-600",size:18}),e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Sync Frequency"})]}),e.jsxs("select",{value:t.syncFrequency??"daily",onChange:b=>r(d=>({...d,syncFrequency:b.target.value})),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all bg-white",children:[e.jsx("option",{value:"hourly",children:"âš¡ Every Hour"}),e.jsx("option",{value:"daily",children:"ðŸ“… Daily"}),e.jsx("option",{value:"weekly",children:"ðŸ“† Weekly"}),e.jsx("option",{value:"manual",children:"âœ‹ Manual Only"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4 sm:p-5 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Na,{className:"text-purple-600",size:18}),e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Content Keywords"})]}),e.jsx("input",{type:"text",placeholder:"real estate, property, investment",value:(t.keywords??[]).join(", "),onChange:b=>r(d=>({...d,keywords:b.target.value.split(",").map(v=>v.trim()).filter(Boolean)})),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all bg-white"}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Filter content by keywords (comma separated)"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl p-4 sm:p-5 border border-orange-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-orange-500 to-yellow-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Settings"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border-2 border-gray-200 rounded-lg hover:border-blue-400 transition-all cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:!!t.active,onChange:b=>r(d=>({...d,active:b.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 w-5 h-5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 group-hover:text-blue-700",children:"Active"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Enable source"})]})]}),e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border-2 border-gray-200 rounded-lg hover:border-green-400 transition-all cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:!!t.autoPublish,onChange:b=>r(d=>({...d,autoPublish:b.target.checked})),className:"rounded border-gray-300 text-green-600 focus:ring-green-500 w-5 h-5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 group-hover:text-green-700",children:"Auto Publish"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Publish posts"})]})]}),e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border-2 border-gray-200 rounded-lg hover:border-purple-400 transition-all cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:(t.contentFilter??"keywords")!=="all",onChange:b=>r(d=>({...d,contentFilter:b.target.checked?"keywords":"all"})),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500 w-5 h-5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 group-hover:text-purple-700",children:"Keyword Filter"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Filter content"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-blue-100 hover:border-blue-300 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors",children:e.jsx(at,{className:"text-blue-600",size:18})}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Plagiarism Check"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"AI ensures 95%+ originality score"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-green-100 hover:border-green-300 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors",children:e.jsx(Ft,{className:"text-green-600",size:18})}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Smart Formatting"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Auto TOC, headings & structure"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-purple-100 hover:border-purple-300 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg group-hover:bg-purple-200 transition-colors",children:e.jsx(Rs,{className:"text-purple-600",size:18})}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"SEO Optimization"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Meta tags & keyword tuning"})]})]})]})}),e.jsxs("div",{className:"sticky bottom-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 backdrop-blur-sm px-4 sm:px-6 py-4 border-t border-gray-200 flex flex-col sm:flex-row items-center justify-end gap-3",children:[e.jsx("button",{onClick:a,className:"w-full sm:w-auto px-5 py-2.5 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-white hover:border-gray-400 transition-all font-medium",children:"Cancel"}),e.jsxs("button",{onClick:n,className:"w-full sm:w-auto px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all font-medium shadow-lg hover:shadow-xl flex items-center justify-center gap-2",children:[e.jsx(_a,{size:18}),i?"Update Source":"Add Source"]})]})]})]}):null;function $n(s){return s===!0||s===1||s==="1"?!0:!!s}function ol(s){return{id:String(s.id??s.source_id??""),name:s.name??"",url:s.url??"",category:s.category??"Property News",description:s.description??null,active:s.active??!0,autoPublish:s.autoPublish??!1,syncFrequency:s.syncFrequency??"daily",contentFilter:s.contentFilter??"keywords",keywords:Array.isArray(s.keywords)?s.keywords:typeof s.keywords=="string"?s.keywords.split(",").map(a=>a.trim()).filter(Boolean):[],lastSync:s.lastSync??null,totalPosts:Number(s.totalPosts??0),newPosts:Number(s.newPosts??0),createdAt:s.createdAt??s.created_at??void 0,updatedAt:s.updatedAt??s.updated_at??void 0}}function lu(s){return(Array.isArray(s==null?void 0:s.data)?s.data:Array.isArray(s)?s:[]).map(ol)}const nu=({isOpen:s,onClose:a})=>{const[t,r]=l.useState([]),[i,n]=l.useState(!1),[o,m]=l.useState(!1),[g,b]=l.useState(null),[d,v]=l.useState(null),[x,u]=l.useState(!1),[c,f]=l.useState({name:"",url:"",category:"Property News",description:"",active:!0,autoPublish:!1,syncFrequency:"daily",contentFilter:"keywords",keywords:[]}),p=["Property News","Market Analysis","Investment","Legal","Home Buying","Home Selling","Construction","Finance"],N=[{name:"Economic Times Real Estate",url:"https://cfo.economictimes.indiatimes.com/rss/topstories",category:"Market Analysis",description:"Leading business news on real estate market"},{name:"Housing.com News",url:"https://housing.com/news/feed/",category:"Property News",description:"Latest property news and updates"},{name:"MoneyControl Real Estate",url:"https://www.moneycontrol.com/rss/realestate.xml",category:"Investment",description:"Investment focused real estate content"},{name:"PropTiger Blog",url:"https://www.proptiger.com/blog/feed/",category:"Property News",description:"Property insights and market trends"},{name:"Magicbricks Blog",url:"https://www.magicbricks.com/blog/feed/",category:"Home Buying",description:"Home buying and selling guides"},{name:"Square Yards News",url:"https://www.squareyards.com/blog/feed",category:"Market Analysis",description:"Real estate market analysis and trends"}];l.useEffect(()=>{(async()=>{try{n(!0);const L=await Qa.getAll(),D=lu(L);r(D)}catch(L){gt.error((L==null?void 0:L.message)||"Failed to load sources")}finally{n(!1)}})()},[]);const P=async L=>{try{const D={...L,active:!0,autoPublish:!1,syncFrequency:"daily",contentFilter:"keywords",keywords:["real estate","property","investment"]},I=await Qa.create(D),H=ol(I==null?void 0:I.data);r(h=>[H,...h]),m(!1),gt.success("RSS source added")}catch(D){gt.error((D==null?void 0:D.message)||"Failed to add source")}},w=async()=>{if(!c.name||!c.url){gt.error("Name and URL are required");return}try{const L={...c,active:$n(c.active),autoPublish:$n(c.autoPublish),contentFilter:c.contentFilter??"keywords",syncFrequency:c.syncFrequency??"daily",keywords:(c.keywords??[]).map(H=>String(H))},D=await Qa.create(L),I=ol(D==null?void 0:D.data);r(H=>[I,...H]),f({name:"",url:"",category:"Property News",description:"",active:!0,autoPublish:!1,syncFrequency:"daily",contentFilter:"keywords",keywords:[]}),m(!1),gt.success("RSS source added")}catch(L){gt.error((L==null?void 0:L.message)||"Failed to add source")}},$=L=>{b(L),f({...L}),m(!0)},y=async()=>{if(g)try{const L=Number(g.id),D={...c,active:$n(c.active),autoPublish:$n(c.autoPublish),contentFilter:c.contentFilter??"keywords",syncFrequency:c.syncFrequency??"daily",keywords:(c.keywords??[]).map(h=>String(h))},I=await Qa.update(L,D),H=ol(I==null?void 0:I.data);r(h=>h.map(Y=>Y.id===H.id?H:Y)),b(null),m(!1),f({name:"",url:"",category:"Property News",description:"",active:!0,autoPublish:!1,syncFrequency:"daily",contentFilter:"keywords",keywords:[]}),gt.success("Source updated")}catch(L){gt.error((L==null?void 0:L.message)||"Failed to update")}},k=async L=>{try{const D=await Qa.toggle(Number(L)),I=ol(D==null?void 0:D.data);r(H=>H.map(h=>h.id===L?I:h)),gt.success("Source status updated")}catch(D){gt.error((D==null?void 0:D.message)||"Failed to toggle")}},R=async L=>{try{if(!confirm("Are you sure you want to delete this source?"))return;await Qa.delete(Number(L)),r(D=>D.filter(I=>I.id!==L)),gt.success("RSS source deleted")}catch(D){gt.error((D==null?void 0:D.message)||"Failed to delete source")}},F=async L=>{try{v(L);const D=await Qa.scan(Number(L)),I=ol(D==null?void 0:D.data);r(h=>h.map(Y=>Y.id===L?I:Y));const H=(D==null?void 0:D.meta)||{};gt.success(`Scanned: ${(H==null?void 0:H.newCount)??0} new / ${(H==null?void 0:H.fetched)??0} fetched`)}catch(D){gt.error((D==null?void 0:D.message)||"Failed to scan")}finally{v(null)}},T=async L=>{try{v(L);const D=await Qa.importDrafts(Number(L)),I=ol(D==null?void 0:D.data);r(h=>h.map(Y=>Y.id===L?I:Y));const H=(D==null?void 0:D.meta)||{};gt.success(`Imported ${(H==null?void 0:H.inserted)??0} article(s) as drafts`)}catch(D){gt.error((D==null?void 0:D.message)||"Failed to import")}finally{v(null)}},j=async()=>{try{u(!0),await Qa.syncAll();const L=await Qa.getAll(),D=lu(L);r(D),gt.success("Scan all completed")}catch(L){gt.error((L==null?void 0:L.message)||"Failed to scan all")}finally{u(!1)}},E=l.useMemo(()=>({sources:t.length,active:t.filter(L=>$n(L.active)).length,totalPosts:t.reduce((L,D)=>L+Number(D.totalPosts??0),0),newPosts:t.reduce((L,D)=>L+Number(D.newPosts??0),0)}),[t]),V=e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2 sm:mb-1",children:"RSS Source Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage and monitor RSS feeds for controlled content import"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>{b(null),m(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 w-full sm:w-auto",children:[e.jsx(fs,{size:18}),e.jsx("span",{children:"Add Source"})]}),e.jsxs("button",{onClick:j,disabled:x||i,className:"bg-green-600 disabled:opacity-60 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 w-full sm:w-auto",children:[e.jsx(na,{size:18,className:x?"animate-spin":""}),e.jsx("span",{children:x?"Scanningâ€¦":"Scan All"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"text-blue-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:E.sources}),e.jsx("div",{className:"text-sm text-blue-700",children:"Total Sources"})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"text-green-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:E.active}),e.jsx("div",{className:"text-sm text-green-700",children:"Active Sources"})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"text-purple-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-purple-600",children:E.totalPosts}),e.jsx("div",{className:"text-sm text-purple-700",children:"Total Posts"})]})]})}),e.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"text-orange-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-orange-600",children:E.newPosts}),e.jsx("div",{className:"text-sm text-orange-700",children:"Pending Import"})]})]})})]})]}),W=e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(i?[]:t).map(L=>e.jsx(Y1,{source:L,isLoading:d===L.id,onSync:()=>F(L.id),onImport:()=>T(L.id),onToggle:()=>k(L.id),onEdit:()=>$(L),onDelete:()=>R(L.id)},L.id))}),B=!i&&t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_t,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No RSS Sources Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Add RSS sources to scan and import articles as drafts"}),e.jsx("button",{onClick:()=>{b(null),m(!0)},className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Add Your First Source"})]}):null,M=e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Mt,{className:"text-purple-600",size:20}),e.jsx("span",{children:"Advanced RSS Features"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(at,{className:"text-blue-600",size:18}),e.jsx("span",{className:"font-medium text-gray-900",children:"Plagiarism Check"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI automatically checks and rewrites content to ensure 95%+ originality score"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ft,{className:"text-green-600",size:18}),e.jsx("span",{className:"font-medium text-gray-900",children:"Smart Formatting"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Auto-generates table of contents, proper headings, and professional formatting"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Rs,{className:"text-purple-600",size:18}),e.jsx("span",{className:"font-medium text-gray-900",children:"SEO Optimization"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Automatically optimizes content for search engines with meta tags and keywords"})]})]})]}),A=()=>e.jsxs("div",{className:"space-y-6",children:[V,e.jsx(G1,{open:o,onClose:()=>{m(!1),b(null),f({name:"",url:"",category:"Property News",description:"",active:!0,autoPublish:!1,syncFrequency:"daily",contentFilter:"keywords",keywords:[]})},form:c,setForm:f,editingSource:g,onSubmit:g?y:w,categories:p,predefinedSources:N,onAddPredefined:P}),W,B,M]});return s!==void 0&&!s?null:s!==void 0?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"RSS Source Management"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ns,{size:24})})]}),A()]})})}):A()},iu=({isOpen:s,onClose:a,posts:t})=>{const[r,i]=l.useState("posts"),[n,o]=l.useState(null),[m,g]=l.useState(!1),[b,d]=l.useState({platform:"facebook",content:"",scheduledDate:"",scheduledTime:"",includeImage:!0,customImage:""}),[v,x]=l.useState([{id:"SP001",blogPostId:"POST001",platform:"facebook",content:`ðŸ  Top 10 Real Estate Investment Tips for 2025

Discover proven strategies to build wealth through property investments. Our latest blog covers everything from market research to financing options.

#RealEstate #Investment #Mumbai #PropertyTips #WealthBuilding`,scheduledDate:"2025-01-16T10:00:00Z",status:"posted",engagement:{likes:45,shares:12,comments:8,clicks:234},imageUrl:"https://images.pexels.com/photos/280229/pexels-photo-280229.jpeg"},{id:"SP002",blogPostId:"POST002",platform:"twitter",content:`ðŸ“ˆ Mumbai property market sees 15% growth in western suburbs!

Key drivers: Metro connectivity, IT expansions, premium retail developments

Read our full analysis ðŸ‘‡

#MumbaiRealEstate #PropertyMarket #Investment`,scheduledDate:"2025-01-17T14:30:00Z",status:"scheduled",engagement:{likes:0,shares:0,comments:0,clicks:0}}]),u=[{name:"Facebook",icon:Sr,color:"blue",characterLimit:2200,features:["Long-form posts","Image carousels","Video content","Event promotion"],connected:!0},{name:"Twitter",icon:kr,color:"blue",characterLimit:280,features:["Hashtag trending","Real-time updates","Thread posting","Quick engagement"],connected:!0},{name:"LinkedIn",icon:Cr,color:"blue",characterLimit:3e3,features:["Professional audience","Industry insights","B2B networking","Thought leadership"],connected:!1},{name:"Instagram",icon:El,color:"pink",characterLimit:2200,features:["Visual content","Stories & Reels","Hashtag discovery","Young audience"],connected:!1}],c=[{id:"posts",label:"Social Posts",icon:ja},{id:"schedule",label:"Schedule Posts",icon:Ts},{id:"analytics",label:"Analytics",icon:Ot},{id:"settings",label:"Platform Settings",icon:Yt}],f=(F,T)=>{const E=`https://resaleexpert.in/blog/${F.slug}`,V={facebook:`ðŸ  ${F.title}

${F.excerpt}

Read the full article to discover expert insights and actionable strategies for your real estate journey.

ðŸ‘† Link in comments

#RealEstate #Property #Mumbai #Investment #${F.category.replace(/\s/g,"")}`,twitter:`ðŸ“Š ${F.title}

${F.excerpt.substring(0,120)}...

Read more ðŸ‘‰ ${E}

#RealEstate #Property #${F.category.replace(/\s/g,"")}`,linkedin:`Professional Insights: ${F.title}

${F.excerpt}

As real estate professionals, staying informed about market trends and investment strategies is crucial for success. This comprehensive analysis provides valuable insights for:

âœ… Property investors looking for high-ROI opportunities
âœ… First-time homebuyers navigating the market
âœ… Real estate agents serving clients better

Read the full analysis: ${E}

#RealEstate #PropertyInvestment #MarketAnalysis #MumbaiRealEstate`,instagram:`ðŸ¡ ${F.title}

${F.excerpt}

Swipe ðŸ‘‰ for key insights!

ðŸ’¡ Pro Tip: Save this post for your property research

Link in bio for full article

#RealEstate #Property #Mumbai #Investment #PropertyTips #HomeSearch #${F.category.replace(/\s/g,"")}`};return V[T]||V.facebook},p=()=>{if(!n||!b.platform||!b.scheduledDate){gt.error("Please fill all required fields");return}const F={id:`SP${Date.now()}`,blogPostId:String(n.id),platform:b.platform,content:b.content||f(n,b.platform),scheduledDate:new Date(`${b.scheduledDate}T${b.scheduledTime}`).toISOString(),status:"scheduled",engagement:{likes:0,shares:0,comments:0,clicks:0},imageUrl:b.includeImage?b.customImage||n.featuredImage:void 0};x(T=>[F,...T]),g(!1),o(null),d({platform:"facebook",content:"",scheduledDate:"",scheduledTime:"",includeImage:!0,customImage:""}),gt.success("Post scheduled successfully!")},N=(F,T)=>{const j=f(F,T),E={id:`SP${Date.now()}`,blogPostId:String(F.id),platform:T,content:j,scheduledDate:new Date().toISOString(),status:"posted",engagement:{likes:Math.floor(Math.random()*50),shares:Math.floor(Math.random()*20),comments:Math.floor(Math.random()*15),clicks:Math.floor(Math.random()*200)+50},imageUrl:F.featuredImage};x(V=>[E,...V]),gt.success(`Posted to ${T} successfully!`)},P=F=>{navigator.clipboard.writeText(F),gt.success("Content copied to clipboard!")},w=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Published Blog Posts"}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:t.map(F=>e.jsx("div",{className:"border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{src:F.featuredImage,alt:F.title,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900 mb-2",children:F.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:F.excerpt}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:F.category}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(ks,{size:14}),e.jsx("span",{children:F.views})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Ra,{size:14}),e.jsx("span",{children:F.likes})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Bt,{size:14}),e.jsx("span",{children:F.comments})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:u.filter(T=>T.connected).map(T=>{const j=T.icon,E=v.find(V=>V.blogPostId===F.id&&V.platform.toLowerCase()===T.name.toLowerCase());return e.jsxs("button",{onClick:()=>E?null:N(F,T.name.toLowerCase()),disabled:!!E,className:`p-2 rounded-lg transition-colors flex items-center space-x-1 ${E?"bg-green-100 text-green-600 cursor-default":`hover:bg-${T.color}-100 text-${T.color}-600 border border-${T.color}-200`}`,title:E?"Already posted":`Post to ${T.name}`,children:[e.jsx(j,{size:16}),E&&e.jsx(bs,{size:12})]},T.name)})}),e.jsx("button",{onClick:()=>{o(F),g(!0),d(T=>({...T,content:f(F,T.platform)}))},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Schedule Post"})]})]})]})},F.id))}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ja,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Published Posts"}),e.jsx("p",{className:"text-gray-600",children:"Publish some blog posts to start sharing on social media"})]})]})}),$=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Scheduled Posts"}),e.jsxs("button",{onClick:()=>g(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(fs,{size:18}),e.jsx("span",{children:"Schedule Post"})]})]}),e.jsx("div",{className:"space-y-4",children:v.filter(F=>F.status==="scheduled").map(F=>{const T=t.find(V=>V.id===F.blogPostId),j=u.find(V=>V.name.toLowerCase()===F.platform),E=(j==null?void 0:j.icon)||ja;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-2 bg-${(j==null?void 0:j.color)||"gray"}-100 rounded-lg`,children:e.jsx(E,{className:`text-${(j==null?void 0:j.color)||"gray"}-600`,size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:T==null?void 0:T.title}),e.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs",children:"Scheduled"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-3",children:F.content}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ts,{size:14}),e.jsx("span",{children:new Date(F.scheduledDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ls,{size:14}),e.jsx("span",{children:new Date(F.scheduledDate).toLocaleTimeString()})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_t,{size:14}),e.jsx("span",{className:"capitalize",children:F.platform})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:e.jsx(ks,{size:16})}),e.jsx("button",{className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:e.jsx(ns,{size:16})})]})]})},F.id)})}),v.filter(F=>F.status==="scheduled").length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ts,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Scheduled Posts"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Schedule your blog posts for social media sharing"}),e.jsx("button",{onClick:()=>g(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Schedule Your First Post"})]})]})}),y=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(ja,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Total Posts"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:v.length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Rs,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Total Engagement"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:v.reduce((F,T)=>F+T.engagement.likes+T.engagement.shares+T.engagement.comments,0)})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(Ns,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Total Clicks"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:v.reduce((F,T)=>F+T.engagement.clicks,0)})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(rt,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Avg. Engagement"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:"12.5%"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Performance by Platform"}),e.jsx("div",{className:"space-y-4",children:u.filter(F=>F.connected).map(F=>{const T=v.filter(V=>V.platform.toLowerCase()===F.name.toLowerCase()),j=T.reduce((V,W)=>V+W.engagement.likes+W.engagement.shares+W.engagement.comments,0),E=F.icon;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(E,{className:`text-${F.color}-600`,size:24}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:F.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[T.length," posts"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:j}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total engagement"})]})]},F.name)})})]})]}),k=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Platform Connections"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:u.map(F=>{const T=F.icon;return e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(T,{className:`text-${F.color}-600`,size:24}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:F.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Character limit: ",F.characterLimit]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${F.connected?"bg-green-500":"bg-gray-300"}`}),e.jsx("span",{className:`text-sm font-medium ${F.connected?"text-green-600":"text-gray-500"}`,children:F.connected?"Connected":"Not Connected"})]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:F.features.map((j,E)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"text-green-500",size:14}),e.jsx("span",{className:"text-sm text-gray-700",children:j})]},E))}),e.jsx("button",{className:`w-full py-2 px-4 rounded-lg font-medium transition-colors ${F.connected?"bg-red-100 text-red-600 hover:bg-red-200":`bg-${F.color}-600 text-white hover:bg-${F.color}-700`}`,children:F.connected?"Disconnect":"Connect"})]},F.name)})})]})}),R=()=>{var F;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center",children:e.jsx(ja,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Social Media Management"}),e.jsx("p",{className:"text-gray-600",children:"Automate and schedule your blog content across social platforms"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ja,{className:"text-blue-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:v.filter(T=>T.status==="posted").length}),e.jsx("div",{className:"text-sm text-blue-700",children:"Posts Shared"})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ts,{className:"text-green-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:v.filter(T=>T.status==="scheduled").length}),e.jsx("div",{className:"text-sm text-green-700",children:"Scheduled"})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rs,{className:"text-purple-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-purple-600",children:v.reduce((T,j)=>T+j.engagement.clicks,0)}),e.jsx("div",{className:"text-sm text-purple-700",children:"Total Clicks"})]})]})}),e.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ns,{className:"text-orange-600",size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-orange-600",children:v.reduce((T,j)=>T+j.engagement.likes+j.engagement.shares,0)}),e.jsx("div",{className:"text-sm text-orange-700",children:"Engagement"})]})]})})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:e.jsx("div",{className:"flex border-b border-gray-200",children:c.map(T=>{const j=T.icon;return e.jsxs("button",{onClick:()=>i(T.id),className:`flex items-center space-x-2 px-6 py-4 font-medium transition-colors ${r===T.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(j,{size:18}),e.jsx("span",{children:T.label})]},T.id)})})}),r==="posts"&&w(),r==="schedule"&&$(),r==="analytics"&&y(),r==="settings"&&k(),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Schedule Social Media Post"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ns,{size:24})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Blog Post"}),e.jsxs("select",{value:(n==null?void 0:n.id)||"",onChange:T=>{const j=t.find(E=>E.id===T.target.value);o(j||null),j&&d(E=>({...E,content:f(j,E.platform)}))},className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Choose a blog post"}),t.map(T=>e.jsx("option",{value:T.id,children:T.title},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Platform"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:u.filter(T=>T.connected).map(T=>{const j=T.icon;return e.jsxs("button",{onClick:()=>{d(E=>({...E,platform:T.name.toLowerCase()})),n&&d(E=>({...E,content:f(n,T.name.toLowerCase())}))},className:`p-3 border-2 rounded-lg transition-colors ${b.platform===T.name.toLowerCase()?`border-${T.color}-500 bg-${T.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(j,{className:`mx-auto mb-2 text-${T.color}-600`,size:24}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.name})]},T.name)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:b.scheduledDate,onChange:T=>d(j=>({...j,scheduledDate:T.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:b.scheduledTime,onChange:T=>d(j=>({...j,scheduledTime:T.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Post Content"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:b.content,onChange:T=>d(j=>({...j,content:T.target.value})),rows:8,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 pr-12",placeholder:"Your social media post content..."}),e.jsx("button",{type:"button",onClick:()=>P(b.content),className:"absolute top-3 right-3 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Xt,{size:16})})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[b.content.length," / ",((F=u.find(T=>T.name.toLowerCase()===b.platform))==null?void 0:F.characterLimit)||2200," characters"]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:b.includeImage,onChange:T=>d(j=>({...j,includeImage:T.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Include featured image"})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:p,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ts,{size:18}),e.jsx("span",{children:"Schedule Post"})]})]})]})]})})]})};return s!==void 0?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Social Media Management"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ns,{size:24})})]}),R()]})})}):R()},K1=({posts:s})=>{const a=s.length,t=s.filter(g=>g.status==="published").length,r=s.filter(g=>g.status==="draft").length,i=s.reduce((g,b)=>g+(b.views||0),0),n=s.reduce((g,b)=>g+(b.likes||0),0),o=s.reduce((g,b)=>g+(b.comments||0),0),m=[{title:"Total Posts",value:a,icon:Ad,color:"text-blue-600",bg:"bg-blue-100"},{title:"Published",value:t,icon:Rs,color:"text-green-600",bg:"bg-green-100"},{title:"Total Views",value:i.toLocaleString(),icon:ks,color:"text-purple-600",bg:"bg-purple-100"},{title:"Engagement",value:n+o,icon:Ns,color:"text-orange-600",bg:"bg-orange-100"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ad,{className:"w-6 h-6 text-gray-700"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Blog Analytics"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:m.map((g,b)=>{const d=g.icon;return e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:g.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:g.value})]}),e.jsx("div",{className:`p-3 rounded-full ${g.bg}`,children:e.jsx(d,{className:`w-6 h-6 ${g.color}`})})]})},b)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Post Status Distribution"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Published"}),e.jsx("span",{className:"font-semibold text-green-600",children:t})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Drafts"}),e.jsx("span",{className:"font-semibold text-orange-600",children:r})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total"}),e.jsx("span",{className:"font-semibold text-gray-800",children:a})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Recent Activity"}),e.jsx("div",{className:"space-y-3",children:s.slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ts,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:g.title}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(g.createdAt).toLocaleDateString()})]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g.status==="published"?"bg-green-100 text-green-800":g.status==="draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:String(g.status)})]},String(g.id)))})]})]})]})},oa=(kt==null?void 0:kt.default)??kt,J1=()=>{var gs;const{user:s}=Hs()??{user:null},a=Ws(s,"blog.read"),t=Ws(s,"blog.create"),r=Ws(s,"blog.update"),i=Ws(s,"blog.delete"),n=Ws(s,"blog.bulk_delete");if(!a)return e.jsx("div",{className:"h-full flex flex-col bg-gray-50",children:e.jsx("div",{className:"flex-1 grid place-items-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Access Denied"}),e.jsx("div",{className:"text-gray-600 text-sm",children:"You do not have permission to view sellers."})]})})});const o=Ne=>{var ls,$s,Gs;if(!Ne)return"Admin";if(typeof Ne=="string"&&Ne.trim())return Ne;const Ze=[Ne.name,Ne.fullName,Ne.displayName,Ne.firstName&&Ne.lastName?`${Ne.firstName} ${Ne.lastName}`:null,Ne.first_name&&Ne.last_name?`${Ne.first_name} ${Ne.last_name}`:null,(ls=Ne.profile)==null?void 0:ls.name,($s=Ne.attributes)==null?void 0:$s.name,(Gs=Ne.user_metadata)==null?void 0:Gs.full_name,Ne.username,Ne.nick,Ne.preferred_username];for(const Se of Ze)if(Se&&String(Se).trim())return String(Se).trim();return Ne!=null&&Ne.email?Ne.email:Ne!=null&&Ne.emails&&Array.isArray(Ne.emails)&&Ne.emails[0]?Ne.emails[0].value||Ne.emails[0]:"Admin"},[m,g]=l.useState("dashboard"),[b,d]=l.useState([]),[v,x]=l.useState([]),[u,c]=l.useState(null),[f,p]=l.useState(!1),[N,P]=l.useState(!1),[w,$]=l.useState(!1),[y,k]=l.useState(!1),[R,F]=l.useState(""),[T,j]=l.useState("All"),[E,V]=l.useState("All"),[W,B]=l.useState(!1),[M,A]=l.useState(!1),[L,D]=l.useState(null),[I,H]=l.useState("draft"),[h,Y]=l.useState(1),[K,q]=l.useState(10),[ne,le]=l.useState(null),[S,C]=l.useState(!1),[J,ue]=l.useState([]),[Q,he]=l.useState(!1),[se,ge]=l.useState(""),[ee,de]=l.useState(null),[U,X]=l.useState(null),[re,fe]=l.useState(new Set),G=l.useMemo(()=>(v||[]).reduce((Ne,Ze)=>{const ls=String((Ze==null?void 0:Ze.id)??(Ze==null?void 0:Ze._id)??(Ze==null?void 0:Ze.slug)??"");return ls&&(Ne[ls]=String((Ze==null?void 0:Ze.name)??(Ze==null?void 0:Ze.title)??(Ze==null?void 0:Ze.label)??(Ze==null?void 0:Ze.sourceName)??"RSS")),Ne},{}),[v]),me=l.useCallback(Ne=>{var Gs,Se,Ge;const Ze=(Ne==null?void 0:Ne.sourceName)??(Ne==null?void 0:Ne.source_name)??(Ne==null?void 0:Ne.sourceLabel)??(Ne==null?void 0:Ne.rssSourceName)??(Ne==null?void 0:Ne.rss_source_name)??((Gs=Ne==null?void 0:Ne.source)==null?void 0:Gs.name)??((Se=Ne==null?void 0:Ne.rss)==null?void 0:Se.name),ls=(Ne==null?void 0:Ne.sourceId)??(Ne==null?void 0:Ne.source_id)??(Ne==null?void 0:Ne.rssSourceId)??(Ne==null?void 0:Ne.rss_source_id)??((Ge=Ne==null?void 0:Ne.source)==null?void 0:Ge.id)??void 0,$s=ls!=null?G[String(ls)]:void 0;return Ze||$s||"Manual"},[G]),oe=[{id:"dashboard",label:"Dashboard",icon:Ot,description:"Overview and quick actions",permission:a},{id:"content",label:"Content Management",icon:ws,description:"Manage all blog posts",permission:a},{id:"comments",label:"Comments",icon:Bt,description:"Manage comments & replies",permission:a},{id:"ai-writer",label:"AI Content Studio",icon:Mt,description:"Create content with AI",permission:t},{id:"ai-tools",label:"AI Enhancement Tools",icon:nn,description:"Enhance existing content",permission:r},{id:"rss",label:"RSS Sources",icon:_t,description:"Auto-import from RSS feeds",permission:t},{id:"social",label:"Social Media",icon:ja,description:"Schedule posts",permission:t},{id:"seo",label:"SEO Tools",icon:Rs,description:"Optimize for search engines",permission:r},{id:"analytics",label:"Analytics",icon:Rs,description:"Performance insights",permission:a}].filter(Ne=>Ne.permission),Fe=Ne=>{var $s,Gs,Se,Ge;const Ze=Ne.sourceId??Ne.source_id??Ne.rssSourceId??Ne.rss_source_id??Ne.rssId??(($s=Ne.source)==null?void 0:$s.id),ls=Ne.sourceName??Ne.source_name??Ne.sourceLabel??Ne.rssSourceName??Ne.rss_source_name??((Gs=Ne.source)==null?void 0:Gs.name)??((Se=Ne.rss)==null?void 0:Se.name);return{id:Ne.id??Ne._id??Ne.slug??`LOCAL_${Date.now()}`,slug:Ne.slug??Ne.permalink??Ne.seoSlug??((Ge=Ne.meta)==null?void 0:Ge.slug)??"",title:Ne.title??"Untitled",content:Ne.content??"",excerpt:Ne.excerpt??"",author:Ne.author??"Admin",category:Ne.category??"Uncategorized",tags:Ne.tags??[],status:Ne.status??"draft",featured:!!Ne.featured,featuredImage:Ne.featuredImage??Ne.featured_image??Ne.image??Ne.imageUrl??"",publishedAt:Ne.publishedAt??Ne.published_at??"",createdAt:Ne.createdAt??Ne.created_at??new Date().toISOString(),updatedAt:Ne.updatedAt??Ne.updated_at??new Date().toISOString(),views:Ne.views??0,likes:Ne.likes??0,comments:Ne.comments??0,seoTitle:Ne.seoTitle??Ne.seo_title??Ne.metaTitle??"",seoDescription:Ne.seoDescription??Ne.seo_description??Ne.metaDescription??"",readTime:typeof Ne.readTime=="number"?Ne.readTime:Math.ceil(((Ne.content||"").length||0)/200),...Ze!==void 0?{sourceId:Ze}:{},sourceName:ls||"Manual"}},$e=l.useCallback(async Ne=>{var Ze;if(!a){Z.error("You do not have permission to view blog posts");return}A(!0),D(null);try{const ls=await oa.getAllPosts(Ne);let $s=[];if(Array.isArray(ls))$s=ls;else if(ls&&Array.isArray(ls.items))$s=ls.items;else if(ls&&Array.isArray(ls.data))$s=ls.data;else if(ls&&typeof ls=="object")if(Array.isArray(ls.posts))$s=ls.posts;else if(Array.isArray(ls.results))$s=ls.results;else{const Se=ls;(Se!=null&&Se.id||Se!=null&&Se.title)&&($s=[Se])}const Gs=($s||[]).map(Fe);d(Gs),fe(new Set)}catch(ls){console.error("Failed to load posts",ls),ls!=null&&ls.response?D(`Server responded ${ls.response.status}: ${((Ze=ls.response.data)==null?void 0:Ze.message)||JSON.stringify(ls.response.data)}`):ls!=null&&ls.request?D("No response from server. Is backend running and reachable?"):D(ls.message||"Failed to fetch posts from server"),Z.error("Could not fetch posts from server"),d([]),fe(new Set)}finally{A(!1)}},[a]);l.useEffect(()=>{a&&$e({status:I})},[$e,I,a]),l.useEffect(()=>{t&&(async()=>{try{const Ne=await Qa.getAll(),Ze=Array.isArray(Ne==null?void 0:Ne.data)?Ne.data:Array.isArray(Ne)?Ne:[];x(Ze)}catch{}})()},[t]);const Le=async()=>{if(!a){Z.error("You do not have permission to refresh posts");return}try{Y(1),await $e({status:I,_ts:Date.now()}),Z.success("List refreshed")}catch{}},je=Ne=>{if(!Ne)return;const Ze=!Ne.id;if(Ze&&!t){Z.error("You do not have permission to create blog posts");return}if(!Ze&&!r){Z.error("You do not have permission to update blog posts");return}const ls=(Ne==null?void 0:Ne.data)??(Ne==null?void 0:Ne.post)??Ne,$s=Fe(ls);d(Gs=>{const Se=Array.isArray(Gs)?Gs:[],Ge=Se.findIndex(ce=>String(ce.id)===String($s.id));let z="created",te;return Ge>=0?(z="updated",te=[...Se],te[Ge]={...te[Ge],...$s}):te=[$s,...Se],$s.status==="published"?Z.success(z==="created"?"Post published!":"Post republished!"):Z.success(z==="created"?"Post created!":"Post updated!"),te}),p(!1),c(null)},_e=async Ne=>{if(!i){Z.error("You do not have permission to delete blog posts");return}if(window.confirm("Are you sure you want to delete this post?"))try{d(Ze=>(Array.isArray(Ze)?Ze:[]).filter(ls=>String(ls.id)!==String(Ne))),typeof oa.deletePost=="function"&&await oa.deletePost(Ne),Z.success("Post deleted successfully!"),fe(Ze=>{const ls=new Set(Ze);return ls.delete(String(Ne)),ls})}catch{Z.error("Failed to delete post. Refreshing list."),Le()}},ve=Ne=>{fe(Ze=>{const ls=new Set(Ze),$s=String(Ne);return ls.has($s)?ls.delete($s):ls.add($s),ls})},Pe=Ne=>Ne.length>0&&Ne.every(Ze=>re.has(String(Ze.id))),We=Ne=>{fe(Ze=>{const ls=new Set(Ze),$s=Pe(Ne);for(const Gs of Ne){const Se=String(Gs.id);$s?ls.delete(Se):ls.add(Se)}return ls})},pe=async()=>{if(!n){Z.error("You do not have permission to bulk delete posts");return}const Ne=Array.from(re);if(Ne.length===0)return Z.info("No posts selected");if(window.confirm(`Delete ${Ne.length} selected post(s)? This cannot be undone.`))try{d(Ze=>(Ze??[]).filter(ls=>!re.has(String(ls.id)))),fe(new Set),typeof oa.deleteMany=="function"?await oa.deleteMany(Ne):typeof oa.bulkDelete=="function"?await oa.bulkDelete({ids:Ne}):typeof oa.deletePost=="function"&&await Promise.all(Ne.map(Ze=>oa.deletePost(Ze).catch(()=>{}))),Z.success("Selected posts deleted")}catch(Ze){console.error(Ze),Z.error("Bulk delete failed. Refreshing list to resync."),Le()}},O=async()=>{if(!r){Z.error("You do not have permission to publish posts");return}const Ne=Array.from(re);if(Ne.length===0)return Z.info("No posts selected");try{const Ze=new Date().toISOString();d(ls=>(ls??[]).map($s=>Ne.includes(String($s.id))?{...$s,status:"published",publishedAt:Ze}:$s)),typeof oa.bulkUpdate=="function"?await oa.bulkUpdate({ids:Ne,data:{status:"published",publishedAt:Ze}}):typeof oa.updatePost=="function"&&await Promise.all(Ne.map(ls=>oa.updatePost(ls,{status:"published",publishedAt:Ze}))),Z.success("Selected posts published"),fe(new Set),H("published")}catch(Ze){console.error(Ze),Z.error("Bulk publish failed. Refreshing list to resync."),Le()}},Ie=Ne=>{if(!r){Z.error("You do not have permission to edit blog posts");return}c(Ne),p(!0)},ze=Ne=>{if(!Ne)return"";try{return new Date(Ne).toLocaleDateString()}catch{return String(Ne)}},xe=Ne=>(Ne||"").replace(/^# (.*$)/gim,'<h1 class="text-2xl font-bold mb-4">$1</h1>').replace(/^## (.*$)/gim,'<h2 class="text-xl font-bold mb-3">$1</h2>').replace(/\*\*(.*?)\*\*/gim,"<strong>$1</strong>").replace(/\*(.*?)\*/gim,"<em>$1</em>").replace(/`(.*?)`/gim,'<code style="background:#f3f4f6;padding:2px 4px;border-radius:4px;">$1</code>').replace(/^- (.*$)/gim,'<li class="ml-4">â€¢ $1</li>').replace(/\n\n/g,'</p><p class="mb-4">').replace(/\n/g,"<br>"),Ee=Ne=>{if(!Ne)return;le(Ne),C(!0);const Ze=ls=>{ls.key==="Escape"&&(C(!1),le(null),window.removeEventListener("keydown",Ze))};window.addEventListener("keydown",Ze)},Ke=()=>{C(!1),le(null)},Xe=Ne=>Ne.created_at||Ne.createdAt||"",ye=Ne=>{const Ze=new Map;return Ne.forEach(ls=>{const $s=(ls==null?void 0:ls.id)!=null?String(ls.id):"",Gs=ls!=null&&ls.slug?String(ls.slug):"";$s&&Ze.set($s,ls.title||"Untitled"),Gs&&Ze.set(Gs,ls.title||"Untitled")}),Ze},Ce=async()=>{try{const Ne=await oa.getAllPosts({});let Ze=[];return Array.isArray(Ne)?Ze=Ne:Array.isArray(Ne==null?void 0:Ne.items)?Ze=Ne.items:Array.isArray(Ne==null?void 0:Ne.data)?Ze=Ne.data:Array.isArray(Ne==null?void 0:Ne.results)?Ze=Ne.results:Array.isArray(Ne==null?void 0:Ne.posts)?Ze=Ne.posts:Ne&&(Ne.id||Ne.title)&&(Ze=[Ne]),(Ze||[]).map(Fe)}catch{return Array.isArray(b)?b:[]}},_=l.useCallback(async()=>{if(!a){Z.error("You do not have permission to view comments");return}he(!0);try{const Ne=await Ce(),Ze=ye(Ne);if(typeof oa.getAllComments=="function")try{const Se=await oa.getAllComments(),z=((Array.isArray(Se==null?void 0:Se.data)?Se.data:Array.isArray(Se)?Se:[])||[]).map(te=>{const ce=(te.post_id!=null?String(te.post_id):"")||(te.postId!=null?String(te.postId):"")||(te.post_slug?String(te.post_slug):"")||(te.postSlug?String(te.postSlug):"");return{id:String(te.id??""),postTitle:Ze.get(ce)||ce||"â€”",author:String(te.author||"â€”"),email:String(te.email||"â€”"),content:String(te.content||"").slice(0,200),status:String(te.status||"pending"),createdAt:String(Xe(te)||"")}});z.sort((te,ce)=>new Date(ce.createdAt).getTime()-new Date(te.createdAt).getTime()),ue(z),he(!1);return}catch{}const Gs=(await Promise.all(Ne.map(async Se=>{try{const Ge=(Se==null?void 0:Se.slug)||String((Se==null?void 0:Se.id)||"");if(!Ge)return[];const z=await oa.getComments(Ge);return(Array.isArray(z==null?void 0:z.data)?z.data:Array.isArray(z==null?void 0:z.comments)?z.comments:Array.isArray(z)?z:[]).map(ce=>({...ce,post_id:ce.post_id??ce.postId??Se.id,post_slug:ce.post_slug??ce.postSlug??Se.slug}))}catch{return[]}}))).flat().map(Se=>{const Ge=(Se.post_id!=null?String(Se.post_id):"")||(Se.postId!=null?String(Se.postId):"")||(Se.post_slug?String(Se.post_slug):"")||(Se.postSlug?String(Se.postSlug):"");return{id:String(Se.id??""),postTitle:Ze.get(Ge)||Ge||"â€”",author:String(Se.author||"â€”"),email:String(Se.email||"â€”"),content:String(Se.content||"").slice(0,200),status:String(Se.status||"pending"),createdAt:String(Xe(Se)||"")}});Gs.sort((Se,Ge)=>new Date(Ge.createdAt).getTime()-new Date(Se.createdAt).getTime()),ue(Gs)}catch(Ne){console.error(Ne),Z.error("Failed to load comments."),ue([])}finally{he(!1)}},[b,a]);l.useEffect(()=>{m==="comments"&&a&&_()},[m,_,a]);const ae=Array.isArray(b)?b:[],ke=ae.filter(Ne=>{var Se,Ge;const Ze=!R||((Se=Ne.title)==null?void 0:Se.toLowerCase().includes(R.toLowerCase()))||((Ge=Ne.content)==null?void 0:Ge.toLowerCase().includes(R.toLowerCase())),ls=T==="All"||Ne.category===T,$s=E==="All"||Ne.status===E,Gs=I==="draft"?Ne.status==="draft":Ne.status==="published";return Ze&&ls&&$s&&Gs}),Me=ke.length,Ye=Math.max(1,Math.ceil(Me/K)),ie=Math.min(h,Ye);l.useEffect(()=>{Y(1)},[R,T,E,I]);const we=l.useMemo(()=>{const Ne=(ie-1)*K,Ze=Ne+K;return ke.slice(Ne,Ze)},[ke,ie,K]),Be=["Real Estate","Investment","Market Analysis","Legal","Home Buying","Home Selling","Property News","Construction","Finance"],Ve=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(ws,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Posts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ae.length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(ks,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Views"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ae.reduce((Ne,Ze)=>Ne+(Ze.views||0),0).toLocaleString()})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(_t,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"RSS Sources"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(Ra,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Engagement"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ae.reduce((Ne,Ze)=>Ne+((Ze.likes||0)+(Ze.comments||0)),0)})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t&&e.jsxs("button",{onClick:()=>{c(null),P(!0)},className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-4 rounded-xl hover:shadow-lg transition-all text-left",children:[e.jsx(Mt,{className:"mb-2",size:24}),e.jsx("div",{className:"font-semibold",children:"AI Writer"}),e.jsx("div",{className:"text-xs text-purple-100",children:"Generate new content"})]}),t&&e.jsxs("button",{onClick:()=>{p(!0),c(null)},className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-4 rounded-xl hover:shadow-lg transition-all text-left",children:[e.jsx(fs,{className:"mb-2",size:24}),e.jsx("div",{className:"font-semibold",children:"New Post"}),e.jsx("div",{className:"text-xs text-blue-100",children:"Create manually"})]}),t&&e.jsxs("button",{onClick:()=>$(!0),className:"bg-gradient-to-r from-green-600 to-emerald-600 text-white p-4 rounded-xl hover:shadow-lg transition-all text-left",children:[e.jsx(_t,{className:"mb-2",size:24}),e.jsx("div",{className:"font-semibold",children:"RSS Import"}),e.jsx("div",{className:"text-xs text-green-100",children:"Auto-import content"})]}),t&&e.jsxs("button",{onClick:()=>k(!0),className:"bg-gradient-to-r from-orange-600 to-red-600 text-white p-4 rounded-xl hover:shadow-lg transition-all text-left",children:[e.jsx(ja,{className:"mb-2",size:24}),e.jsx("div",{className:"font-semibold",children:"Social Media"}),e.jsx("div",{className:"text-xs text-orange-100",children:"Schedule posts"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Recent Posts"}),e.jsx("div",{className:"space-y-3",children:ae.slice(0,5).map(Ne=>{const Ze=me(Ne);return e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:shadow-sm transition-all",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[Ne.featuredImage?e.jsx("img",{src:Ne.featuredImage,alt:Ne.title,className:"w-12 h-12 object-cover rounded-lg"}):e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M3 3v18h18"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:Ne.title}),e.jsxs("div",{className:"flex items-center flex-wrap gap-x-3 gap-y-1 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(ks,{size:12}),e.jsx("span",{children:Ne.views||0})]}),e.jsx("span",{children:Ne.category}),Ze?e.jsxs("span",{children:["â€¢ ",Ze]}):null,e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${Ne.status==="published"?"bg-green-100 text-green-800":Ne.status==="draft"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Ne.status})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Ee(Ne),className:"text-blue-600 hover:text-blue-700",title:"Preview",children:e.jsx(ks,{size:20})}),r&&e.jsx("button",{onClick:()=>Ie(Ne),className:"text-blue-600 hover:text-blue-700",title:"Edit",children:e.jsx(ft,{size:20})})]})]},Ne.id)})})]})]}),Je=()=>(Pe(we),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 p-1 rounded-full",children:[e.jsx("button",{onClick:()=>H("draft"),className:`px-4 py-2 rounded-full text-sm font-medium transition ${I==="draft"?"bg-white shadow border text-gray-900":"text-gray-600 hover:text-gray-900"}`,children:"Draft"}),e.jsx("button",{onClick:()=>H("published"),className:`px-4 py-2 rounded-full text-sm font-medium transition ${I==="published"?"bg-white shadow border text-gray-900":"text-gray-600 hover:text-gray-900"}`,children:"Published"})]}),e.jsxs("div",{className:"flex gap-2",children:[t&&e.jsxs("button",{onClick:()=>p(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(fs,{size:18}),e.jsx("span",{children:"New Post"})]}),e.jsxs("button",{onClick:Le,disabled:M,className:`px-3 py-2 border rounded-md transition-colors flex items-center gap-2 ${M?"opacity-60 cursor-not-allowed":"hover:bg-gray-100"}`,title:"Refresh list",children:[e.jsx(na,{size:16,className:M?"animate-spin":""}),e.jsx("span",{children:M?"Refreshing...":"Refresh"})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:`Search ${I==="draft"?"drafts":"published"}...`,value:R,onChange:Ne=>F(Ne.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("select",{value:T,onChange:Ne=>j(Ne.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"All",children:"All Categories"}),Be.map(Ne=>e.jsx("option",{value:Ne,children:Ne},Ne))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Page size"}),e.jsx("select",{value:K,onChange:Ne=>q(Number(Ne.target.value)),className:"px-3 py-2 border rounded-md",children:[5,10,15,20].map(Ne=>e.jsx("option",{value:Ne,children:Ne},Ne))})]})]})]}),(r||n)&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:["Selected: ",e.jsx("span",{className:"font-semibold",children:re.size})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsx("button",{onClick:O,disabled:re.size===0,className:`px-3 py-2 rounded-md border ${re.size===0?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,title:"Publish selected",children:"Publish Selected"}),n&&e.jsx("button",{onClick:pe,disabled:re.size===0,className:`px-3 py-2 rounded-md border text-red-600 ${re.size===0?"opacity-50 cursor-not-allowed":"hover:bg-red-50 border-red-300"}`,title:"Delete selected",children:"Delete Selected"}),e.jsx("button",{onClick:()=>fe(new Set),disabled:re.size===0,className:`px-3 py-2 rounded-md border ${re.size===0?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Clear Selection"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:[I==="draft"?"Draft Posts":"Published Posts"," (",Me,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Y(Ne=>Math.max(1,Ne-1)),disabled:ie<=1,className:`p-2 rounded-md border ${ie<=1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,title:"Previous",children:e.jsx(Wa,{size:18})}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",e.jsx("span",{className:"font-semibold",children:ie})," / ",Ye]}),e.jsx("button",{onClick:()=>Y(Ne=>Math.min(Ye,Ne+1)),disabled:ie>=Ye,className:`p-2 rounded-md border ${ie>=Ye?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,title:"Next",children:e.jsx(pa,{size:18})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[(r||n)&&e.jsx("th",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",checked:we.length>0&&we.every(Ne=>re.has(String(Ne.id))),onChange:()=>We(we)})}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Title"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Source"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Category"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Stats"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Quality"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Actions"})]})}),e.jsxs("tbody",{children:[we.map(Ne=>{const Ze=z=>{const te=z.includes("#")&&z.includes("##")?85:65,ce=z.length>500?88:75;return{overall:Math.round((te+ce)/2),seo:te,readability:ce}},ls=z=>Math.floor(Math.random()*5)+95,$s=Ze(Ne.content||""),Gs=ls(Ne.content||""),Se=me(Ne),Ge=re.has(String(Ne.id));return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(r||n)&&e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",checked:Ge,onChange:()=>ve(Ne.id)})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[Ne.featuredImage?e.jsx("img",{src:Ne.featuredImage,alt:Ne.title,className:"w-10 h-10 object-cover rounded-lg"}):e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M3 3v18h18"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:Ne.title}),e.jsxs("p",{className:"text-xs text-gray-600",children:[Ne.author," â€¢ ",new Date(Ne.createdAt||Date.now()).toLocaleDateString()]})]})]})}),e.jsx("td",{className:"py-3 px-4",children:Se?e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs ${Se==="Manual"?"bg-gray-100 text-gray-700":"bg-indigo-50 text-indigo-700"}`,children:[Se!=="Manual"&&e.jsx(_t,{size:12}),Se]}):e.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-gray-100 text-gray-700 px-2 py-0.5 text-xs",children:"Manual"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-indigo-50 text-blue-800  px-2 py-1 text-xs",children:Ne.category})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Ne.status==="published"?"bg-green-100 text-green-800":Ne.status==="draft"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Ne.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsxs("div",{children:[Ne.views||0," views"]}),e.jsxs("div",{children:[Ne.likes||0," likes"]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"SEO:"}),e.jsxs("div",{className:`text-xs font-medium ${$s.seo>80?"text-green-600":"text-yellow-600"}`,children:[$s.seo,"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Original:"}),e.jsxs("div",{className:"text-xs font-medium text-green-600",children:[Gs,"%"]})]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-3 whitespace-nowrap",children:[r&&e.jsx("button",{onClick:()=>Ie(Ne),className:"inline-flex items-center justify-center w-9 h-9 rounded-lg border border-gray-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300 transition",title:"Edit",children:e.jsx(ft,{size:18,className:"shrink-0"})}),e.jsx("button",{onClick:()=>Ee(Ne),className:"inline-flex items-center justify-center w-9 h-9 rounded-lg border border-gray-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300 transition",title:"Preview",children:e.jsx(ks,{size:18,className:"shrink-0"})}),a&&e.jsx("button",{onClick:()=>{g("comments")},className:"inline-flex items-center justify-center w-9 h-9 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 hover:border-gray-300 transition",title:"Comments",children:e.jsx(Bt,{size:18,className:"shrink-0"})}),t&&e.jsx("button",{onClick:()=>P(!0),className:"inline-flex items-center justify-center w-9 h-9 rounded-lg border border-gray-200 text-purple-600 hover:bg-purple-50 hover:border-purple-300 transition",title:"AI Rewrite",children:e.jsx(Al,{size:18,className:"shrink-0"})}),i&&e.jsx("button",{onClick:()=>_e(Ne.id),className:"inline-flex items-center justify-center w-9 h-9 rounded-lg border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-300 transition",title:"Delete",children:e.jsx(Es,{size:18,className:"shrink-0"})})]})})]},Ne.id)}),we.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:8,className:"py-10 text-center text-gray-500",children:["No ",I," posts found."]})})]})]})}),e.jsxs("div",{className:"mt-6 flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing"," ",e.jsx("span",{className:"font-semibold",children:Me===0?0:(ie-1)*K+1})," - ",e.jsx("span",{className:"font-semibold",children:Math.min(ie*K,Me)})," ","of ",e.jsx("span",{className:"font-semibold",children:Me})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Y(1),disabled:ie===1,className:`px-3 py-2 border rounded-md ${ie===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"First"}),e.jsx("button",{onClick:()=>Y(Ne=>Math.max(1,Ne-1)),disabled:ie===1,className:`px-3 py-2 border rounded-md ${ie===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Prev"}),e.jsxs("span",{className:"px-3 py-2 text-sm",children:["Page ",e.jsx("span",{className:"font-semibold",children:ie})," / ",Ye]}),e.jsx("button",{onClick:()=>Y(Ne=>Math.min(Ye,Ne+1)),disabled:ie===Ye,className:`px-3 py-2 border rounded-md ${ie===Ye?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Next"}),e.jsx("button",{onClick:()=>Y(Ye),disabled:ie===Ye,className:`px-3 py-2 border rounded-md ${ie===Ye?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Last"})]})]})]})]})),Ue=async Ne=>{if(!i){Z.error("You do not have permission to delete comments");return}if(window.confirm("Delete this comment?"))try{de(Ne),await oa.deleteComment(Ne),ue(Ze=>Ze.filter(ls=>ls.id!==Ne)),Z.success("Comment deleted")}catch(Ze){console.error(Ze),Z.error("Failed to delete")}finally{de(null)}},Oe=async Ne=>{if(!r){Z.error("You do not have permission to edit comments");return}try{const Ze=window.prompt("Edit author",Ne.author??"")??Ne.author,ls=window.prompt("Edit email",Ne.email??"")??Ne.email,$s=window.prompt("Edit content",Ne.content??"")??Ne.content;if(Ze===Ne.author&&ls===Ne.email&&$s===Ne.content)return;de(Ne.id),await oa.updateComment(Ne.id,{author:Ze,email:ls,content:$s}),ue(Gs=>Gs.map(Se=>Se.id===Ne.id?{...Se,author:Ze,email:ls,content:$s}:Se)),Z.success("Comment updated")}catch(Ze){console.error(Ze),Z.error("Failed to update comment")}finally{de(null)}},rs=()=>{if(!a)return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center",children:e.jsx("div",{className:"text-gray-500",children:"You do not have permission to view comments."})});const Ne=J.filter(Ze=>{if(!se)return!0;const ls=se.toLowerCase();return Ze.postTitle.toLowerCase().includes(ls)||Ze.author.toLowerCase().includes(ls)||Ze.email.toLowerCase().includes(ls)||Ze.content.toLowerCase().includes(ls)||Ze.status.toLowerCase().includes(ls)});return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Comments"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{value:se,onChange:Ze=>ge(Ze.target.value),placeholder:"Search comments...",className:"pl-9 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("button",{onClick:_,disabled:Q,className:`px-3 py-2 border rounded-lg flex items-center gap-2 ${Q?"opacity-60 cursor-not-allowed":"hover:bg-gray-50"}`,title:"Refresh comments",children:[e.jsx(na,{size:16,className:Q?"animate-spin":""}),e.jsx("span",{children:Q?"Loading...":"Refresh"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 text-left",children:[e.jsx("th",{className:"py-3 px-4 text-gray-700 font-medium",children:"Post"}),e.jsx("th",{className:"py-3 px-4 text-gray-700 font-medium",children:"Author"}),e.jsx("th",{className:"py-3 px-4 text-gray-700 font-medium",children:"Email"}),e.jsx("th",{className:"py-3 px-4 text-gray-700 font-medium",children:"Content"}),e.jsx("th",{className:"py-3 px-4 text-gray-700 font-medium",children:"Status"}),e.jsx("th",{className:"py-3 px-4 text-gray-700 font-medium",children:"Created At"}),e.jsx("th",{className:"py-3 px-4 text-gray-700 font-medium",children:"Actions"})]})}),e.jsxs("tbody",{children:[Ne.map(Ze=>{const ls=ee===Ze.id;return Ze.status,e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:Ze.postTitle}),e.jsx("td",{className:"py-3 px-4",children:Ze.author}),e.jsx("td",{className:"py-3 px-4",children:Ze.email||"â€”"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{title:Ze.content,children:Ze.content})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Ze.status==="approved"?"bg-green-100 text-green-800":Ze.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-800"}`,children:Ze.status})}),e.jsx("td",{className:"py-3 px-4",children:Ze.createdAt?ze(Ze.createdAt):"â€”"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("button",{disabled:ls,onClick:()=>Oe(Ze),title:"Edit",className:`inline-flex items-center justify-center w-9 h-9 rounded-lg border border-gray-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300 transition ${ls?"opacity-60 cursor-not-allowed":""}`,children:e.jsx(ft,{size:18})}),i&&e.jsx("button",{disabled:ls,onClick:()=>Ue(Ze.id),title:"Delete",className:`inline-flex items-center justify-center w-9 h-9 rounded-lg border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-300 transition ${ls?"opacity-60 cursor-not-allowed":""}`,children:e.jsx(Es,{size:18})})]})})]},Ze.id)}),!Q&&Ne.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-10 text-center text-gray-500",children:"No comments found."})}),Q&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-10 text-center text-gray-500",children:"Loading commentsâ€¦"})})]})]})}),e.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-semibold",children:Ne.length})," comment(s)"]})]})})},ms=()=>r?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"AI Enhancement Tools"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(ut,{className:"text-green-600",size:20})}),e.jsx("h4",{className:"font-semibold text-gray-900",children:"Plagiarism Checker"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Advanced AI-powered plagiarism detection with 99.7% accuracy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Accuracy Rate"}),e.jsx("span",{className:"font-bold text-green-600",children:"99.7%"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Avg Originality"}),e.jsx("span",{className:"font-bold text-green-600",children:"97.2%"})]})]}),e.jsx("button",{className:"w-full mt-4 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors",children:"Run Bulk Check"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Rs,{className:"text-blue-600",size:20})}),e.jsx("h4",{className:"font-semibold text-gray-900",children:"SEO Optimizer"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Automatically optimize content for search engines"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Avg SEO Score"}),e.jsx("span",{className:"font-bold text-blue-600",children:"89.5%"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Posts Optimized"}),e.jsx("span",{className:"font-bold text-blue-600",children:ae.length})]})]}),e.jsx("button",{className:"w-full mt-4 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Optimize All"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Al,{className:"text-purple-600",size:20})}),e.jsx("h4",{className:"font-semibold text-gray-900",children:"AI Enhancer"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Improve readability, tone, and engagement"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Enhancement Rate"}),e.jsx("span",{className:"font-bold text-purple-600",children:"92.8%"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Improved Posts"}),e.jsx("span",{className:"font-bold text-purple-600",children:Math.floor(ae.length*.8)})]})]}),e.jsx("button",{className:"w-full mt-4 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors",children:"Bulk Enhance"})]})]})]})}):e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center",children:e.jsx("div",{className:"text-gray-500",children:"You do not have permission to access AI tools."})}),cs=()=>r?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"SEO Optimization Tools"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Keyword Analysis"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Top Performing Keywords"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:'"real estate investment"'}),e.jsx("span",{className:"font-bold text-blue-600",children:"1,200 searches"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:'"mumbai property"'}),e.jsx("span",{className:"font-bold text-blue-600",children:"890 searches"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:'"home buying guide"'}),e.jsx("span",{className:"font-bold text-blue-600",children:"650 searches"})]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Content Optimization"}),e.jsx("div",{className:"space-y-4",children:ae.slice(0,3).map(Ne=>{const Ze=(Ne.content||"").includes("#")?85:65;return e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-sm",children:Ne.title}),e.jsxs("span",{className:`text-xs font-bold ${Ze>80?"text-green-600":Ze>60?"text-yellow-600":"text-red-600"}`,children:[Ze,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-3",children:e.jsx("div",{className:`h-2 rounded-full ${Ze>80?"bg-green-500":Ze>60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Ze}%`}})}),e.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-xs",children:"Optimize"})]})]},Ne.id)})})]})]})]})}):e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center",children:e.jsx("div",{className:"text-gray-500",children:"You do not have permission to access SEO tools."})});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Blog Management Center"}),e.jsx("p",{className:"text-gray-600",children:"Comprehensive blog management with AI-powered tools"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:e.jsx("div",{className:"flex flex-nowrap border-b border-gray-200 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300",children:oe.map(Ne=>{const Ze=Ne.icon;return e.jsxs("button",{onClick:()=>g(Ne.id),className:`flex items-center space-x-2 px-5 py-3 sm:px-6 sm:py-4 font-medium transition-colors whitespace-nowrap shrink-0 ${m===Ne.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(Ze,{size:18,className:"shrink-0"}),e.jsx("span",{className:"truncate",children:Ne.label})]},Ne.id)})})}),e.jsxs("div",{children:[m==="dashboard"&&Ve(),m==="content"&&Je(),m==="comments"&&rs(),m==="ai-writer"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"AI Content Studio"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Generate long-form, SEO-optimized posts with images & ToC."}),t?e.jsxs("button",{onClick:()=>{c(null),P(!0)},className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700",children:[e.jsx(Mt,{size:18})," Open AI Writer"]}):e.jsx("div",{className:"text-gray-500",children:"You do not have permission to access AI Writer."})]}),m==="ai-tools"&&ms(),m==="rss"&&e.jsx(nu,{}),m==="social"&&e.jsx(iu,{posts:ae}),m==="seo"&&cs(),m==="analytics"&&e.jsx(K1,{posts:ae})]}),f&&e.jsx(F1,{post:u,onSave:Ne=>je(Ne),onCancel:()=>{p(!1),c(null)},isOpen:f,currentUserName:o(s),lockAuthor:!0}),N&&t&&e.jsx(q1,{isOpen:!0,post:u,onSave:Ne=>{je(Ne),P(!1),c(null),X(null)},onCancel:()=>{P(!1),c(null),X(null)},currentUserName:o(s)}),w&&t&&e.jsx(nu,{isOpen:!0,onClose:()=>$(!1)}),y&&t&&e.jsx(iu,{posts:ae,isOpen:!0,onClose:()=>k(!1)})]}),S&&ne&&e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Ke}),e.jsxs("div",{className:"bg-white w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl shadow-2xl z-[70] relative",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-md flex items-center justify-center text-white font-bold text-sm",children:String(ne.author||"A").split(" ").map(Ne=>Ne[0]).join("")}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:ne.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:[ne.author," â€¢ ",ze(ne.publishedAt||ne.createdAt),(()=>{const Ne=me(ne);return Ne?` â€¢ ${Ne}`:""})()]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:Ke,className:"p-2 rounded-md hover:bg-gray-100",children:e.jsx(ns,{size:16})})})]}),e.jsxs("div",{className:"p-4",children:[ne.featuredImage&&e.jsx("img",{src:ne.featuredImage,alt:ne.title,className:"w-full h-48 object-cover rounded-lg mb-4"}),e.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:xe(ne.content)}}),ne.tags&&((gs=ne.tags)==null?void 0:gs.length)>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ne.tags.map((Ne,Ze)=>e.jsx("span",{className:"bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-sm",children:Ne},Ze))})]})]})]})]})]})},Q1=()=>{const[s,a]=l.useState("dashboard"),[t,r]=l.useState(!1),[i,n]=l.useState(0),[o,m]=l.useState([]),[g,b]=l.useState({propertyData:"",marketTrends:"",clientInteractions:"",pricingHistory:""}),d=[{id:"dashboard",label:"AI Dashboard",icon:Va},{id:"data",label:"Training Data",icon:Vr},{id:"uploads",label:"Data Management",icon:dt},{id:"model",label:"Model Training",icon:Yt},{id:"analytics",label:"Performance",icon:Ot}],v=(P,w)=>{const $=w.target.files[0];if($){const y={id:Date.now(),name:$.name,type:P,size:($.size/1024/1024).toFixed(2)+" MB",uploadDate:new Date().toISOString().split("T")[0],status:"Processing",records:Math.floor(Math.random()*1e4)+1e3};m(k=>[...k,y]),setTimeout(()=>{m(k=>k.map(R=>R.id===y.id?{...R,status:"Processed"}:R))},3e3)}},x=()=>{r(!0),n(0);const P=setInterval(()=>{n(w=>w>=100?(clearInterval(P),r(!1),100):w+10)},1e3)},u=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Va,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"AI Model Status"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"Active"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Last trained: 2 hours ago"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(Vr,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Data Points"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"125,847"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Properties analyzed"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(Rs,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Accuracy Rate"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"94.2%"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Price predictions"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(jt,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"API Requests"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:"8,743"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Today"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Recent AI Activities"}),e.jsx("div",{className:"space-y-4",children:[{action:"Price Prediction Model Updated",time:"2 hours ago",status:"success"},{action:"Market Trend Analysis Completed",time:"4 hours ago",status:"success"},{action:"New Property Data Ingested",time:"6 hours ago",status:"success"},{action:"Investment Analysis Model Trained",time:"8 hours ago",status:"success"},{action:"Chatbot Response Optimized",time:"12 hours ago",status:"success"}].map((P,w)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bs,{className:"text-green-500",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:P.action}),e.jsx("p",{className:"text-sm text-gray-500",children:P.time})]})]}),e.jsx("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm",children:"Success"})]},w))})]})]}),c=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Training Data Sources"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Property Data (JSON/CSV)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(dt,{className:"mx-auto text-gray-400 mb-3",size:48}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Upload property database"}),e.jsx("input",{type:"file",accept:".json,.csv",className:"hidden",id:"property-data",onChange:P=>v("Property Data",P)}),e.jsx("label",{htmlFor:"property-data",className:"bg-blue-600 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-blue-700 transition-colors",children:"Choose Files"}),e.jsx("a",{href:"/sample-data/property-training-data.json",download:!0,className:"ml-2 text-blue-600 hover:text-blue-700 text-sm underline",children:"Download Sample"})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"Current: 125,847 properties loaded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Market Trends Data"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(Rs,{className:"mx-auto text-gray-400 mb-3",size:48}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Upload market analysis data"}),e.jsx("input",{type:"file",accept:".json,.csv",className:"hidden",id:"market-data",onChange:P=>v("Market Trends",P)}),e.jsx("label",{htmlFor:"market-data",className:"bg-green-600 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-green-700 transition-colors",children:"Choose Files"}),e.jsx("a",{href:"/sample-data/market-trends-data.csv",download:!0,className:"ml-2 text-green-600 hover:text-green-700 text-sm underline",children:"Download Sample"})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"Current: 45,623 market data points"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Client Interaction Data"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(ws,{className:"mx-auto text-gray-400 mb-3",size:48}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Upload chat & interaction logs"}),e.jsx("input",{type:"file",accept:".json,.csv",className:"hidden",id:"interaction-data",onChange:P=>v("Client Interactions",P)}),e.jsx("label",{htmlFor:"interaction-data",className:"bg-purple-600 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-purple-700 transition-colors",children:"Choose Files"}),e.jsx("a",{href:"/sample-data/client-interactions-data.json",download:!0,className:"ml-2 text-purple-600 hover:text-purple-700 text-sm underline",children:"Download Sample"})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"Current: 78,945 interactions analyzed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Pricing History"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(Ot,{className:"mx-auto text-gray-400 mb-3",size:48}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Upload historical pricing data"}),e.jsx("input",{type:"file",accept:".json,.csv",className:"hidden",id:"pricing-data",onChange:P=>v("Pricing History",P)}),e.jsx("label",{htmlFor:"pricing-data",className:"bg-orange-600 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-orange-700 transition-colors",children:"Choose Files"})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"Current: 234,567 price points tracked"})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Data Processing Status"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Properties: "}),e.jsx("span",{className:"font-bold text-green-600",children:"âœ“ Processed"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Market Data: "}),e.jsx("span",{className:"font-bold text-green-600",children:"âœ“ Processed"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Interactions: "}),e.jsx("span",{className:"font-bold text-yellow-600",children:"â³ Processing"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Pricing: "}),e.jsx("span",{className:"font-bold text-green-600",children:"âœ“ Processed"})]})]})]})]})}),f=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Uploaded Training Data"}),o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Vr,{className:"mx-auto text-gray-300 mb-4",size:48}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Data Uploaded Yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Upload your training data files to get started"}),e.jsx("button",{onClick:()=>a("data"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Upload Data Files"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"File Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Type"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Size"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Records"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Upload Date"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:o.map(P=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 font-medium text-gray-900",children:P.name}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:P.type})}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:P.size}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:P.records.toLocaleString()}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:P.uploadDate}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${P.status==="Processed"?"bg-green-100 text-green-800":P.status==="Processing"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:P.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"text-blue-600 hover:text-blue-700",children:e.jsx(ks,{size:16})}),e.jsx("button",{className:"text-green-600 hover:text-green-700",children:e.jsx(Ys,{size:16})}),e.jsx("button",{className:"text-red-600 hover:text-red-700",children:e.jsx(Es,{size:16})})]})})]},P.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(ws,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Property Files"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.filter(P=>P.type==="Property Data").length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Rs,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Market Files"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.filter(P=>P.type==="Market Trends").length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(Ns,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Interaction Files"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:o.filter(P=>P.type==="Client Interactions").length})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(Vr,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Total Records"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o.reduce((P,w)=>P+w.records,0).toLocaleString()})]})]})})]})]}),p=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"AI Model Training"}),t&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(na,{className:"animate-spin text-blue-600",size:20}),e.jsx("span",{className:"font-semibold text-blue-900",children:"Training in Progress..."})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${i}%`}})}),e.jsxs("p",{className:"text-sm text-blue-700 mt-2",children:[i,"% Complete"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Available Models"}),e.jsx("div",{className:"space-y-3",children:[{name:"Property Price Prediction",status:"active",accuracy:"94.2%"},{name:"Market Trend Analysis",status:"active",accuracy:"89.7%"},{name:"Investment Recommendation",status:"active",accuracy:"91.3%"},{name:"Chatbot Response Generation",status:"training",accuracy:"87.1%"}].map((P,w)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:P.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Accuracy: ",P.accuracy]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${P.status==="active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:P.status==="active"?"Active":"Training"})]},w))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Training Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Training Mode"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Full Model Retrain"}),e.jsx("option",{children:"Incremental Learning"}),e.jsx("option",{children:"Fine-tuning"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Split"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("input",{type:"number",placeholder:"Train %",className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",defaultValue:"70"}),e.jsx("input",{type:"number",placeholder:"Valid %",className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",defaultValue:"20"}),e.jsx("input",{type:"number",placeholder:"Test %",className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",defaultValue:"10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Learning Rate"}),e.jsx("input",{type:"number",step:"0.0001",placeholder:"0.0001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",defaultValue:"0.0001"})]}),e.jsx("button",{onClick:x,disabled:t,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all font-semibold disabled:opacity-50",children:t?"Training in Progress...":"Start Training"})]})]})]})]})}),N=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(rt,{className:"text-blue-600",size:24}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Model Performance"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Accuracy"}),e.jsx("span",{className:"text-sm font-medium",children:"94.2%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"94.2%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Precision"}),e.jsx("span",{className:"text-sm font-medium",children:"89.7%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"89.7%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Recall"}),e.jsx("span",{className:"text-sm font-medium",children:"91.3%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"91.3%"}})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(ks,{className:"text-green-600",size:24}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Usage Statistics"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"API Calls Today"}),e.jsx("span",{className:"font-bold text-green-600",children:"8,743"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Active Users"}),e.jsx("span",{className:"font-bold text-blue-600",children:"2,456"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Properties Analyzed"}),e.jsx("span",{className:"font-bold text-purple-600",children:"1,234"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Chat Sessions"}),e.jsx("span",{className:"font-bold text-orange-600",children:"567"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(Ft,{className:"text-orange-600",size:24}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"System Health"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"API Response Time"}),e.jsx("span",{className:"text-green-600 font-medium",children:"120ms"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Uptime"}),e.jsx("span",{className:"text-green-600 font-medium",children:"99.9%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Error Rate"}),e.jsx("span",{className:"text-green-600 font-medium",children:"0.1%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"CPU Usage"}),e.jsx("span",{className:"text-yellow-600 font-medium",children:"45%"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Recent AI Predictions"}),e.jsxs("button",{className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Export Data"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"Property ID"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Predicted Price"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Actual Price"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Accuracy"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Confidence"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Date"})]})}),e.jsx("tbody",{children:[{id:"PROP001",predicted:"â‚¹2.5Cr",actual:"â‚¹2.4Cr",accuracy:"96%",confidence:"94%",date:"2025-01-15"},{id:"PROP002",predicted:"â‚¹4.2Cr",actual:"â‚¹4.5Cr",accuracy:"93%",confidence:"91%",date:"2025-01-15"},{id:"PROP003",predicted:"â‚¹1.8Cr",actual:"â‚¹1.9Cr",accuracy:"95%",confidence:"89%",date:"2025-01-14"},{id:"PROP004",predicted:"â‚¹3.1Cr",actual:"â‚¹2.9Cr",accuracy:"94%",confidence:"92%",date:"2025-01-14"},{id:"PROP005",predicted:"â‚¹5.7Cr",actual:"â‚¹5.6Cr",accuracy:"98%",confidence:"96%",date:"2025-01-13"}].map((P,w)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:P.id}),e.jsx("td",{className:"py-3 px-4",children:P.predicted}),e.jsx("td",{className:"py-3 px-4",children:P.actual}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:P.accuracy})}),e.jsx("td",{className:"py-3 px-4",children:P.confidence}),e.jsx("td",{className:"py-3 px-4 text-gray-500",children:P.date})]},w))})]})})]})]});return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"AI Training & Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage and train your AI models for better property insights"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:e.jsx("div",{className:"flex overflow-x-auto whitespace-nowrap border-b border-gray-200 no-scrollbar",children:d.map(P=>{const w=P.icon,$=s===P.id;return e.jsxs("button",{onClick:()=>a(P.id),className:`flex items-center gap-2 px-6 py-4 font-medium transition-colors shrink-0
            ${$?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(w,{size:18}),e.jsx("span",{children:P.label})]},P.id)})})}),s==="dashboard"&&u(),s==="data"&&c(),s==="uploads"&&f(),s==="model"&&p(),s==="analytics"&&N()]})})},Z1=({smooth:s=!0})=>{const a=Jr(),t=Ih();return l.useEffect(()=>{if(t!=="POP"){if(a.hash){const r=a.hash.replace("#","");setTimeout(()=>{var n;const i=document.getElementById(r);i?(i.scrollIntoView({behavior:s?"smooth":"auto",block:"start"}),(n=i.focus)==null||n.call(i)):window.scrollTo({top:0,behavior:s?"smooth":"auto"})},0);return}window.scrollTo({top:0,behavior:s?"smooth":"auto"})}},[a.pathname,a.search]),null},X1=()=>{var Q,he,se,ge;const[s,a]=l.useState([]),[t,r]=l.useState([]),[i,n]=l.useState(""),[o,m]=l.useState("all"),[g,b]=l.useState(null),[d,v]=l.useState(!1),[x,u]=l.useState(""),[c,f]=l.useState(1),[p,N]=l.useState(!1),[P,w]=l.useState(null),[$,y]=l.useState([]),[k,R]=l.useState([]),F=10,T=ee=>R(de=>de.includes(ee)?de:[...de,ee]),j=ee=>R(de=>de.filter(U=>U!==ee)),E=ee=>k.includes(ee),V=ee=>({id:ee.id??ee._id??ee.contactId,name:ee.name??ee.fullName??"â€”",email:ee.email??"",phone:ee.phone??"",subject:ee.subject??"No subject",message:ee.message??"",propertyType:ee.propertyType??ee.property_type??ee.type??"",budget:ee.budget??ee.price??"",status:ee.status??"new",priority:ee.priority??"low",timestamp:ee.timestamp??ee.createdAt??new Date().toISOString(),isStarred:!!(ee.isStarred??ee.is_starred??!1),assignedTo:ee.assignedTo??ee.assigned_to??null,replies:Array.isArray(ee.replies)?ee.replies:ee.replies?[ee.replies]:[]}),W=async()=>{N(!0),w(null);try{const ee=await il.getContacts(),U=(Array.isArray(ee)?ee:(ee==null?void 0:ee.data)||[]).map(V);a(U),r(U),y([])}catch(ee){console.error("Failed to fetch contacts",ee),w("Failed to load messages")}finally{N(!1)}};l.useEffect(()=>{W()},[]),l.useEffect(()=>{let ee=s.filter(de=>{const U=i.trim().toLowerCase(),X=!U||de.name&&de.name.toLowerCase().includes(U)||de.email&&de.email.toLowerCase().includes(U)||de.subject&&de.subject.toLowerCase().includes(U)||de.message&&de.message.toLowerCase().includes(U),re=o==="all"||de.status===o;return X&&re});ee.sort((de,U)=>new Date(U.timestamp).getTime()-new Date(de.timestamp).getTime()),r(ee),f(1)},[s,i,o]);const B=c*F,M=B-F,A=t.slice(M,B),L=Math.max(1,Math.ceil(t.length/F)),D=ee=>$.includes(ee),I=ee=>{y(de=>de.includes(ee)?de.filter(U=>U!==ee):[...de,ee])},H=A.length>0&&A.every(ee=>$.includes(ee.id)),h=()=>{if(H){const ee=new Set(A.map(de=>de.id));y(de=>de.filter(U=>!ee.has(U)))}else{const ee=A.map(de=>de.id);y(de=>Array.from(new Set([...de,...ee])))}},Y={new:s.filter(ee=>ee.status==="new").length,replied:s.filter(ee=>ee.status==="replied").length,"in-progress":s.filter(ee=>ee.status==="in-progress").length,resolved:s.filter(ee=>ee.status==="resolved").length},K={new:{color:"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 border border-blue-200 shadow-sm",dotColor:"bg-blue-500",bgColor:"bg-blue-50",borderColor:"border-l-blue-500",label:"New",count:Y.new,icon:ct,description:"Awaiting review"},replied:{color:"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-800 border border-emerald-200 shadow-sm",dotColor:"bg-emerald-500",bgColor:"bg-emerald-50",borderColor:"border-l-emerald-500",label:"Replied",count:Y.replied,icon:Eh,description:"Response sent"},"in-progress":{color:"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-800 border border-amber-200 shadow-sm",dotColor:"bg-amber-500",bgColor:"bg-amber-50",borderColor:"border-l-amber-500",label:"In Progress",count:Y["in-progress"],icon:$h,description:"Being processed"},resolved:{color:"bg-gradient-to-r from-purple-50 to-purple-100 text-purple-800 border border-purple-200 shadow-sm",dotColor:"bg-purple-500",bgColor:"bg-purple-50",borderColor:"border-l-purple-500",label:"Resolved",count:Y.resolved,icon:bs,description:"Successfully closed"}},q={high:"border-l-red-500 bg-gradient-to-r from-red-50 to-red-100 shadow-sm",medium:"border-l-yellow-500 bg-gradient-to-r from-yellow-50 to-yellow-100 shadow-sm",low:"border-l-green-500 bg-gradient-to-r from-green-50 to-green-100 shadow-sm"},ne=ee=>{const de=new Date(ee),X=Math.abs(new Date().getTime()-de.getTime()),re=Math.floor(X/(1e3*60*60*24));return re===0?"Today "+de.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):re===1?"Yesterday":re<7?`${re} days ago`:de.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})},le=()=>{const ee=$.length?s.filter(oe=>$.includes(oe.id)):t;if(!ee.length){console.warn("No rows to export");return}const de=["id","name","email","phone","subject","message","propertyType","budget","status","priority","timestamp","assignedTo","isStarred","repliesCount"],U=[];U.push(de.join(","));const X=oe=>{if(oe==null)return"";const Fe=String(oe).replace(/"/g,'""');return/[",\n]/.test(Fe)?`"${Fe}"`:Fe};ee.forEach(oe=>{var Fe;U.push([X(oe.id),X(oe.name),X(oe.email),X(oe.phone),X(oe.subject),X(oe.message),X(oe.propertyType||""),X(oe.budget||""),X(oe.status),X(oe.priority),X(oe.timestamp),X(oe.assignedTo||""),X(oe.isStarred?"yes":"no"),X(((Fe=oe.replies)==null?void 0:Fe.length)||0)].join(","))});const re=new Blob(["\uFEFF"+U.join(`
`)],{type:"text/csv;charset=utf-8;"}),fe=URL.createObjectURL(re),G=document.createElement("a"),me=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");G.href=fe,G.download=`contact-messages-${$.length?"selected":"filtered"}-${me}.csv`,document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(fe)},S=async(ee,de)=>{a(U=>U.map(X=>X.id===ee?{...X,status:de}:X)),g&&g.id===ee&&b(U=>({...U,status:de})),T(ee);try{const U=await il.updateStatus(ee,de);if(U&&(U.id||U._id||U.contactId)){const X=V(U);a(re=>re.map(fe=>fe.id===ee?X:fe)),g&&g.id===ee&&b(X)}}catch(U){console.error("Failed to update status",U),await W()}finally{j(ee)}},C=async ee=>{const de=s.find(X=>X.id===ee),U=!(de!=null&&de.isStarred);a(X=>X.map(re=>re.id===ee?{...re,isStarred:U}:re)),g&&g.id===ee&&b(X=>({...X,isStarred:U})),T(ee);try{await il.updateContact(ee,{isStarred:U})}catch(X){console.error("Failed to persist star toggle",X),await W()}finally{j(ee)}},J=async()=>{if(!x.trim()||!g)return;const ee={id:Date.now(),message:x.trim(),timestamp:new Date().toISOString(),sender:"Agent"};a(de=>de.map(U=>U.id===g.id?{...U,status:"replied",replies:[...U.replies||[],ee]}:U)),b(de=>de&&{...de,status:"replied",replies:[...de.replies||[],ee]}),u(""),T(g.id);try{const de=await il.addReply(g.id,{message:ee.message,sender:ee.sender});if(de&&(de.id||de._id||de.contactId)){const U=V(de);a(X=>X.map(re=>re.id===g.id?U:re)),b(U)}else try{await il.updateContact(g.id,{replies:[...g.replies||[],ee],status:"replied"})}catch{}}catch(de){console.error("Failed to persist reply",de),await W();const U=s.find(X=>X.id===g.id);U&&b(U)}finally{j(g.id)}},ue=async ee=>{try{const de=await il.getContactById(ee.id),U=de&&(de.id||de._id||de.contactId)?de:ee;b(V(U)),v(!0)}catch(de){console.warn("Could not fetch single contact, opening cached version",de),b(ee),v(!0)}};return p?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8 bg-gradient-to-br from-gray-50 to-gray-100",children:e.jsxs("div",{className:"text-center bg-white p-8 rounded-2xl shadow-lg",children:[e.jsx(na,{className:"animate-spin mx-auto text-blue-500",size:48}),e.jsx("p",{className:"mt-4 text-gray-700 font-medium",children:"Loading messages..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Please wait while we fetch your data"})]})}):P?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8 bg-gradient-to-br from-gray-50 to-gray-100",children:e.jsxs("div",{className:"text-center bg-white p-8 rounded-2xl shadow-lg",children:[e.jsx(Ta,{size:48,className:"text-red-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-red-700 font-medium",children:P}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Something went wrong while loading your messages"}),e.jsx("button",{onClick:W,className:"mt-6 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl font-medium hover:from-blue-700 hover:to-blue-800 transform hover:scale-105 transition-all duration-200 shadow-lg",children:"Try Again"})]})}):d&&g?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[e.jsx("div",{className:"bg-white shadow-lg border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>v(!1),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-xl transition-all duration-200",children:e.jsx(ga,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Message Details"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["From: ",g.name]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>C(g.id),disabled:E(g.id),className:`p-2 rounded-xl transition-all duration-200 ${g.isStarred?"text-yellow-500 bg-yellow-50 border border-yellow-200":"text-gray-400 hover:text-yellow-500 hover:bg-yellow-50 border border-gray-200"}`,children:e.jsx(Xs,{size:20,fill:g.isStarred?"currentColor":"none"})}),e.jsxs("select",{value:g.status,onChange:ee=>S(g.id,ee.target.value),disabled:E(g.id),className:"px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 text-sm font-medium bg-white shadow-sm",children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"replied",children:"Replied"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"resolved",children:"Resolved"})]})]})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[e.jsx("div",{className:`p-6 border-b ${((Q=K[g.status])==null?void 0:Q.bgColor)||"bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:g.subject}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ms,{size:16}),e.jsx("span",{className:"font-medium",children:g.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{size:16}),e.jsx("span",{children:g.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{size:16}),e.jsx("span",{children:g.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ls,{size:16}),e.jsx("span",{children:ne(g.timestamp)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`px-4 py-2 rounded-xl text-sm font-medium ${((he=K[g.status])==null?void 0:he.color)||"bg-gray-100 text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${((se=K[g.status])==null?void 0:se.dotColor)||"bg-gray-400"}`}),e.jsx("span",{children:((ge=K[g.status])==null?void 0:ge.label)||g.status})]})}),e.jsxs("span",{className:`px-3 py-1 text-xs rounded-full font-medium ${g.priority==="high"?"bg-red-100 text-red-800 border border-red-200":g.priority==="medium"?"bg-yellow-100 text-yellow-800 border border-yellow-200":"bg-green-100 text-green-800 border border-green-200"}`,children:[g.priority," priority"]})]})]})}),e.jsxs("div",{className:"p-6 border-b bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Property Requirements"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 bg-white p-4 rounded-xl shadow-sm border border-blue-100",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(yt,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Property Type"}),e.jsx("p",{className:"font-semibold text-gray-900",children:g.propertyType||"â€”"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 bg-white p-4 rounded-xl shadow-sm border border-green-100",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(cn,{className:"text-green-600",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Budget"}),e.jsx("p",{className:"font-semibold text-gray-900",children:g.budget||"â€”"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 bg-white p-4 rounded-xl shadow-sm border border-purple-100",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Ms,{className:"text-purple-600",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Assigned To"}),e.jsx("p",{className:"font-semibold text-gray-900",children:g.assignedTo||"Unassigned"})]})]})]})]}),e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Original Message"}),e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6 border border-gray-200",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:g.message})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Conversation"}),g.replies&&g.replies.length>0&&e.jsx("div",{className:"space-y-6 mb-8",children:g.replies.map((ee,de)=>e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-sm font-semibold",children:"A"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200",children:e.jsx("p",{className:"text-gray-900",children:ee.message})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 font-medium",children:ne(ee.timestamp)})]})]},de))}),e.jsx("div",{className:"border-t pt-6",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-gray-500 to-gray-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-sm font-semibold",children:"You"})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx("textarea",{value:x,onChange:ee=>u(ee.target.value),placeholder:"Type your reply here...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none shadow-sm",rows:4,disabled:E(g.id)}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>window.open(`tel:${g.phone}`),className:"flex items-center space-x-2 px-4 py-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-xl transition-all duration-200 border border-green-200",children:[e.jsx(Cs,{size:16}),e.jsx("span",{children:"Call"})]}),e.jsxs("button",{onClick:()=>window.open(`mailto:${g.email}`),className:"flex items-center space-x-2 px-4 py-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-xl transition-all duration-200 border border-blue-200",children:[e.jsx(Ds,{size:16}),e.jsx("span",{children:"Email"})]})]}),e.jsxs("button",{onClick:J,disabled:!x.trim()||E(g.id),className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg font-medium",children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:E(g.id)?"Sending...":"Send Reply"})]})]})]})]})})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 ",children:[e.jsx("div",{className:"bg-white shadow-md border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-center h-16 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-md",children:e.jsx(tt,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Messages"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage all contact form submissions"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsxs("label",{className:"flex items-center gap-2 mr-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",checked:H,onChange:h}),e.jsx("span",{children:"Select page"})]}),$.length>0&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded-lg bg-blue-50 text-blue-700 border border-blue-200 mr-2",children:[$.length," selected"]}),e.jsx("button",{onClick:W,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200","aria-label":"Refresh Messages",children:e.jsx(na,{size:20})}),e.jsxs("button",{onClick:le,className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 border border-gray-300 rounded-lg transition-colors duration-200",children:[e.jsx(Ys,{size:18}),e.jsx("span",{children:"Export"})]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto   py-6 sm:py-8 mt-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-4 mb-6 sm:mb-8",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 border border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 mb-1",children:"Total Messages"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:s.length}),e.jsx("p",{className:"text-[11px] sm:text-xs text-gray-500 mt-1",children:"All inquiries"})]}),e.jsx("div",{className:"p-2.5 sm:p-3 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl",children:e.jsx(tt,{className:"text-white",size:24})})]})}),Object.entries(K).map(([ee,de])=>{const U=de.icon;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 border border-gray-200 hover:shadow-xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 mb-1",children:de.label}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:de.count}),e.jsx("p",{className:"text-[11px] sm:text-xs text-gray-500 mt-1 truncate",children:de.description})]}),e.jsx("div",{className:`p-2.5 sm:p-3 rounded-xl ${de.bgColor} border ${de.color.includes("border-blue")?"border-blue-200":de.color.includes("border-emerald")?"border-emerald-200":de.color.includes("border-amber")?"border-amber-200":"border-purple-200"}`,children:e.jsx(U,{size:24,className:de.color.includes("text-blue")?"text-blue-600":de.color.includes("text-emerald")?"text-emerald-600":de.color.includes("text-amber")?"text-amber-600":"text-purple-600"})})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 sm:h-2",children:e.jsx("div",{className:`h-1.5 sm:h-2 rounded-full ${de.dotColor}`,style:{width:`${s.length>0?de.count/s.length*100:0}%`}})})})]},ee)})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 mb-6 sm:mb-8 border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 items-center",children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search messages...",className:"w-full pl-10 pr-3 py-2.5 sm:py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm text-sm",value:i,onChange:ee=>n(ee.target.value)})]})}),e.jsx("div",{children:e.jsxs("select",{value:o,onChange:ee=>m(ee.target.value),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm font-medium text-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"new",children:"New Messages"}),e.jsx("option",{value:"replied",children:"Replied"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"resolved",children:"Resolved"})]})})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200",children:[e.jsx("div",{className:"divide-y divide-gray-200",children:A.map(ee=>{var de,U,X;return e.jsx("div",{className:`p-4 sm:p-6 hover:bg-gray-50 cursor-pointer transition-all duration-200 border-l-4 ${q[ee.priority]||"border-l-gray-300 bg-white"}`,onClick:()=>ue(ee),children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 md:gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-gray-300",checked:D(ee.id),onChange:re=>{re.stopPropagation(),I(ee.id)},onClick:re=>re.stopPropagation()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 truncate max-w-[60%] sm:max-w-none",children:ee.name}),e.jsx("span",{className:`px-2.5 py-1 rounded-xl text-[11px] sm:text-xs font-medium ${((de=K[ee.status])==null?void 0:de.color)||"bg-gray-100 text-gray-700"}`,children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${((U=K[ee.status])==null?void 0:U.dotColor)||"bg-gray-400"}`}),((X=K[ee.status])==null?void 0:X.label)||ee.status]})}),ee.isStarred&&e.jsx(Xs,{size:14,className:"text-yellow-500",fill:"currentColor"}),e.jsx("span",{className:`px-2 py-0.5 text-[11px] sm:text-xs rounded-full font-medium ${ee.priority==="high"?"bg-red-100 text-red-700 border border-red-200":ee.priority==="medium"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-green-100 text-green-700 border border-green-200"}`,children:ee.priority})]}),e.jsx("h4",{className:"text-sm sm:text-base font-medium text-gray-800 mb-2 sm:mb-3 truncate",children:ee.subject}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 sm:mb-4 line-clamp-2",children:ee.message}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 text-xs sm:text-sm text-gray-500",children:[e.jsxs("div",{className:"inline-flex items-center gap-1.5 min-w-0",children:[e.jsx(Ds,{size:14}),e.jsx("span",{className:"truncate",children:ee.email})]}),e.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[e.jsx(Cs,{size:14}),e.jsx("span",{children:ee.phone})]}),ee.propertyType&&e.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[e.jsx(yt,{size:14}),e.jsx("span",{children:ee.propertyType})]}),ee.assignedTo&&e.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[e.jsx(Ms,{size:14}),e.jsxs("span",{children:["Assigned to ",ee.assignedTo]})]})]})]})]}),e.jsxs("div",{className:"flex md:flex-col items-center md:items-end justify-between gap-3 md:gap-2",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-500 font-medium whitespace-nowrap",children:ne(ee.timestamp)}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[e.jsx("button",{onClick:re=>{re.stopPropagation(),window.open(`tel:${ee.phone}`)},className:"p-2 text-green-600 hover:text-green-800 hover:bg-green-100 rounded-xl transition-all duration-200 border border-green-200",children:e.jsx(Cs,{size:16})}),e.jsx("button",{onClick:re=>{re.stopPropagation(),window.open(`mailto:${ee.email}`)},className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-xl transition-all duration-200 border border-blue-200",children:e.jsx(Ds,{size:16})}),e.jsx("button",{onClick:re=>{re.stopPropagation(),C(ee.id)},className:`p-2 rounded-xl transition-all duration-200 border ${ee.isStarred?"text-yellow-500 bg-yellow-100 border-yellow-200":"text-gray-400 hover:text-yellow-500 hover:bg-yellow-50 border-gray-200"}`,children:e.jsx(Xs,{size:16,fill:ee.isStarred?"currentColor":"none"})})]}),ee.replies&&ee.replies.length>0&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-[11px] sm:text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-lg",children:[e.jsx(Bt,{size:12}),e.jsxs("span",{children:[ee.replies.length," replies"]})]})]})]})},ee.id)})}),L>1&&e.jsx("div",{className:"bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("p",{className:"text-xs sm:text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:M+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(B,t.length)})," of"," ",e.jsx("span",{className:"font-medium",children:t.length})," messages"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:()=>f(ee=>Math.max(ee-1,1)),disabled:c===1,className:"px-3 sm:px-4 py-2 text-sm text-gray-600 hover:text-gray-800 disabled:opacity-50 rounded-lg hover:bg-gray-100 transition-all duration-200",children:"Previous"}),Array.from({length:L},(ee,de)=>de+1).map(ee=>e.jsx("button",{onClick:()=>f(ee),className:`px-2.5 sm:px-3 py-2 text-sm rounded-lg transition-all duration-200 ${c===ee?"bg-blue-600 text-white shadow":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"}`,children:ee},ee)),e.jsx("button",{onClick:()=>f(ee=>Math.min(ee+1,L)),disabled:c===L,className:"px-3 sm:px-4 py-2 text-sm text-gray-600 hover:text-gray-800 disabled:opacity-50 rounded-lg hover:bg-gray-100 transition-all duration-200",children:"Next"})]})]})})]})]})]})},e2=()=>{var K;const[s,a]=l.useState({title:"About ResaleExpert",description:"India's most trusted real estate platform, connecting millions of buyers, sellers, and renters with verified properties and expert guidance since 2010.",stats:[{label:"Years Experience",value:"15+"},{label:"Properties Sold",value:"10K+"},{label:"Happy Customers",value:"25K+"}]}),[t,r]=l.useState({title:"Our Mission",description:"To make real estate transactions transparent, efficient, and accessible for everyone. We leverage technology and expertise to simplify the complex process of buying, selling, and renting properties.",features:["100% Verified Properties","Expert Legal Guidance","End-to-End Support","AI-Powered Matching"],image:"https://images.pexels.com/photos/3184291/pexels-photo-3184291.jpeg?auto=compress&cs=tinysrgb&w=600",satisfactionRate:"98%"}),[i,n]=l.useState([{label:"Properties Sold",value:"10,000+",icon:"Home"},{label:"Happy Customers",value:"25,000+",icon:"Users"},{label:"Years of Experience",value:"15+",icon:"Award"},{label:"Cities Covered",value:"50+",icon:"Building"}]),[o,m]=l.useState([{icon:"Shield",title:"Trust & Transparency",description:"We believe in complete transparency in all our dealings. Every property is verified, and all information is accurate and up-to-date."},{icon:"Target",title:"Customer First",description:"Our customers are at the heart of everything we do. We go above and beyond to ensure their real estate journey is smooth and successful."},{icon:"Star",title:"Excellence",description:"We strive for excellence in every aspect of our service, from property listings to customer support and after-sales service."},{icon:"Heart",title:"Integrity",description:"We conduct our business with the highest level of integrity, ensuring fair deals and honest communication with all parties."}]),[g,b]=l.useState([{name:"Rajesh Patel",role:"Founder & CEO",experience:"15+ years",specialization:"Luxury Properties",image:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=300"},{name:"Priya Sharma",role:"Head of Sales",experience:"12+ years",specialization:"Residential Sales",image:"https://images.pexels.com/photos/3756679/pexels-photo-3756679.jpeg?auto=compress&cs=tinysrgb&w=300"},{name:"Amit Kumar",role:"Legal Advisor",experience:"10+ years",specialization:"Property Law",image:"https://images.pexels.com/photos/2182970/pexels-photo-2182970.jpeg?auto=compress&cs=tinysrgb&w=300"},{name:"Neha Gupta",role:"Customer Relations",experience:"8+ years",specialization:"Client Support",image:"https://images.pexels.com/photos/3756679/pexels-photo-3756679.jpeg?auto=compress&cs=tinysrgb&w=300"}]),[d,v]=l.useState([{year:"2010",title:"Company Founded",description:"Started with a vision to revolutionize real estate in Mumbai"},{year:"2015",title:"Digital Transformation",description:"Launched online platform and mobile app for seamless property search"},{year:"2018",title:"Pan-India Expansion",description:"Expanded operations to 25+ cities across India"},{year:"2020",title:"AI Integration",description:"Introduced AI-powered property matching and market analysis"},{year:"2023",title:"Industry Recognition",description:'Awarded "Best Real Estate Platform" by Property Awards India'}]),[x,u]=l.useState([{title:"Best Real Estate Platform 2023",organization:"Property Awards India",icon:"Crown"},{title:"Customer Choice Award 2022",organization:"Real Estate Excellence Awards",icon:"Award"},{title:"Innovation in PropTech 2021",organization:"Technology Innovation Awards",icon:"Rocket"}]),[c,f]=l.useState([{icon:"Shield",title:"100% Verified Properties",description:"Every property on our platform is thoroughly verified for legal compliance, ownership, and authenticity before listing."},{icon:"Zap",title:"AI-Powered Matching",description:"Our advanced AI algorithms match buyers with perfect properties based on preferences, budget, and lifestyle requirements."},{icon:"Handshake",title:"End-to-End Support",description:"From property search to final registration, we provide complete support throughout your real estate journey."}]),[p,N]=l.useState({title:"Ready to Start Your Real Estate Journey?",description:"Join thousands of satisfied customers who have found their dream properties with ResaleExpert",phone:"+91 99999 99999",email:"info@resaleexpert.in",address:"Mumbai, India"}),[P,w]=l.useState("hero"),[$,y]=l.useState(!1),k=l.useRef(null),R=[{id:"hero",name:"Hero Section",icon:_t},{id:"mission",name:"Mission & Vision",icon:rt},{id:"statistics",name:"Statistics",icon:Rs},{id:"values",name:"Core Values",icon:Xs},{id:"team",name:"Team Members",icon:Ns},{id:"timeline",name:"Company Journey",icon:Ts},{id:"whychoose",name:"Why Choose Us",icon:bs},{id:"awards",name:"Awards & Recognition",icon:Ct},{id:"contact",name:"Contact Information",icon:Cs}],F={Home:yt,Users:Ns,Award:Ct,Building:Is,Shield:at,Target:rt,Star:Xs,Heart:Ra,Crown:va,Rocket:Xl,Zap:Ft,Handshake:Cl},T=q=>{k.current.click(),k.current.onchange=ne=>{const le=ne.target.files[0];if(le){const S=new FileReader;S.onload=C=>{q(C.target.result)},S.readAsDataURL(le)}}},j=()=>{const q={hero:s,mission:t,statistics:i,values:o,team:g,timeline:d,whyChoose:c,awards:x,contact:p};localStorage.setItem("aboutPageData",JSON.stringify(q));const ne=document.createElement("div");ne.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50",ne.textContent="About page data saved successfully!",document.body.appendChild(ne),setTimeout(()=>document.body.removeChild(ne),3e3)},E=()=>{const ne=JSON.stringify({hero:s,mission:t,statistics:i,values:o,team:g,timeline:d,whyChoose:c,awards:x,contact:p},null,2),le=new Blob([ne],{type:"application/json"}),S=document.createElement("a");S.href=URL.createObjectURL(le),S.download="about-page-data.json",S.click()},V=q=>{const ne=q.target.files[0];if(ne){const le=new FileReader;le.onload=S=>{try{const C=JSON.parse(typeof S.target.result=="string"?S.target.result:"");C.hero&&a(C.hero),C.mission&&r(C.mission),C.statistics&&n(C.statistics),C.values&&m(C.values),C.team&&b(C.team),C.timeline&&v(C.timeline),C.whyChoose&&f(C.whyChoose),C.awards&&u(C.awards),C.contact&&N(C.contact),alert("Data imported successfully!")}catch{alert("Error importing data. Please check the file format.")}},le.readAsText(ne)}},W=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Page Title"}),e.jsx("input",{type:"text",value:s.title,onChange:q=>a({...s,title:q.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:q=>a({...s,description:q.target.value}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Hero Statistics"}),e.jsx("div",{className:"space-y-4",children:s.stats.map((q,ne)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Label"}),e.jsx("input",{type:"text",value:q.label,onChange:le=>{const S=[...s.stats];S[ne].label=le.target.value,a({...s,stats:S})},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:q.value,onChange:le=>{const S=[...s.stats];S[ne].value=le.target.value,a({...s,stats:S})},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},ne))})]})]}),B=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section Title"}),e.jsx("input",{type:"text",value:t.title,onChange:q=>r({...t,title:q.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:q=>r({...t,description:q.target.value}),rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Features List"}),e.jsxs("div",{className:"space-y-2",children:[t.features.map((q,ne)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:q,onChange:le=>{const S=[...t.features];S[ne]=le.target.value,r({...t,features:S})},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>{const le=t.features.filter((S,C)=>C!==ne);r({...t,features:le})},className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:e.jsx(Es,{size:16})})]},ne)),e.jsxs("button",{onClick:()=>r({...t,features:[...t.features,"New Feature"]}),className:"flex items-center space-x-2 p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Feature"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:t.image,onChange:q=>r({...t,image:q.target.value}),className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>T(q=>r({...t,image:q})),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:e.jsx(dt,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Satisfaction Rate"}),e.jsx("input",{type:"text",value:t.satisfactionRate,onChange:q=>r({...t,satisfactionRate:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]}),M=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Statistics Management"}),e.jsxs("button",{onClick:()=>n([...i,{label:"New Stat",value:"0+",icon:"Star"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Statistic"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((q,ne)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Statistic ",ne+1]}),e.jsx("button",{onClick:()=>n(i.filter((le,S)=>S!==ne)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Label"}),e.jsx("input",{type:"text",value:q.label,onChange:le=>{const S=[...i];S[ne].label=le.target.value,n(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:q.value,onChange:le=>{const S=[...i];S[ne].value=le.target.value,n(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:q.icon,onChange:le=>{const S=[...i];S[ne].icon=le.target.value,n(S)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(F).map(le=>e.jsx("option",{value:le,children:le},le))})]})]},ne))})]}),A=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Team Management"}),e.jsxs("button",{onClick:()=>b([...g,{name:"New Member",role:"Position",experience:"0+ years",specialization:"Specialization",image:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=300"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Team Member"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:g.map((q,ne)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Team Member ",ne+1]}),e.jsx("button",{onClick:()=>b(g.filter((le,S)=>S!==ne)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:q.name,onChange:le=>{const S=[...g];S[ne].name=le.target.value,b(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Role"}),e.jsx("input",{type:"text",value:q.role,onChange:le=>{const S=[...g];S[ne].role=le.target.value,b(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Experience"}),e.jsx("input",{type:"text",value:q.experience,onChange:le=>{const S=[...g];S[ne].experience=le.target.value,b(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Specialization"}),e.jsx("input",{type:"text",value:q.specialization,onChange:le=>{const S=[...g];S[ne].specialization=le.target.value,b(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Profile Image"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:q.image,onChange:le=>{const S=[...g];S[ne].image=le.target.value,b(S)},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>T(le=>{const S=[...g];S[ne].image=le,b(S)}),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:e.jsx(Sa,{size:16})})]})]})]},ne))})]}),L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Core Values Management"}),e.jsxs("button",{onClick:()=>m([...o,{icon:"Star",title:"New Value",description:"Description of the value"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Value"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map((q,ne)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Value ",ne+1]}),e.jsx("button",{onClick:()=>m(o.filter((le,S)=>S!==ne)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:q.title,onChange:le=>{const S=[...o];S[ne].title=le.target.value,m(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("textarea",{value:q.description,onChange:le=>{const S=[...o];S[ne].description=le.target.value,m(S)},rows:3,className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:q.icon,onChange:le=>{const S=[...o];S[ne].icon=le.target.value,m(S)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(F).map(le=>e.jsx("option",{value:le,children:le},le))})]})]},ne))})]}),D=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Company Timeline Management"}),e.jsxs("button",{onClick:()=>v([...d,{year:"2024",title:"New Milestone",description:"Description of the milestone"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Milestone"})]})]}),e.jsx("div",{className:"space-y-4",children:d.map((q,ne)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"font-medium",children:["Milestone ",ne+1]}),e.jsx("button",{onClick:()=>v(d.filter((le,S)=>S!==ne)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Year"}),e.jsx("input",{type:"text",value:q.year,onChange:le=>{const S=[...d];S[ne].year=le.target.value,v(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:q.title,onChange:le=>{const S=[...d];S[ne].title=le.target.value,v(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("textarea",{value:q.description,onChange:le=>{const S=[...d];S[ne].description=le.target.value,v(S)},rows:2,className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},ne))})]}),I=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Why Choose Us Management"}),e.jsxs("button",{onClick:()=>f([...c,{icon:"Star",title:"New Feature",description:"Description of the feature"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Feature"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map((q,ne)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Feature ",ne+1]}),e.jsx("button",{onClick:()=>f(c.filter((le,S)=>S!==ne)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:q.title,onChange:le=>{const S=[...c];S[ne].title=le.target.value,f(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("textarea",{value:q.description,onChange:le=>{const S=[...c];S[ne].description=le.target.value,f(S)},rows:3,className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:q.icon,onChange:le=>{const S=[...c];S[ne].icon=le.target.value,f(S)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(F).map(le=>e.jsx("option",{value:le,children:le},le))})]})]},ne))})]}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Awards & Recognition Management"}),e.jsxs("button",{onClick:()=>u([...x,{title:"New Award",organization:"Organization Name",icon:"Award"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Award"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map((q,ne)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Award ",ne+1]}),e.jsx("button",{onClick:()=>u(x.filter((le,S)=>S!==ne)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Award Title"}),e.jsx("input",{type:"text",value:q.title,onChange:le=>{const S=[...x];S[ne].title=le.target.value,u(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Organization"}),e.jsx("input",{type:"text",value:q.organization,onChange:le=>{const S=[...x];S[ne].organization=le.target.value,u(S)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:q.icon,onChange:le=>{const S=[...x];S[ne].icon=le.target.value,u(S)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(F).map(le=>e.jsx("option",{value:le,children:le},le))})]})]},ne))})]}),h=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section Title"}),e.jsx("input",{type:"text",value:p.title,onChange:q=>N({...p,title:q.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:p.description,onChange:q=>N({...p,description:q.target.value}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"text",value:p.phone,onChange:q=>N({...p,phone:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:p.email,onChange:q=>N({...p,email:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("input",{type:"text",value:p.address,onChange:q=>N({...p,address:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]}),Y=()=>{switch(P){case"hero":return W();case"mission":return B();case"statistics":return M();case"values":return L();case"team":return A();case"timeline":return D();case"whychoose":return I();case"awards":return H();case"contact":return h();default:return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"Select a section to edit"})}};return $?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"About Page Preview"}),e.jsxs("button",{onClick:()=>y(!1),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ln,{size:16}),e.jsx("span",{children:"Edit Mode"})]})]})})}),e.jsxs("div",{className:"space-y-8",children:[e.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-purple-700 text-white py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center",children:[e.jsx("h2",{className:"text-4xl font-bold mb-4",children:s.title}),e.jsx("p",{className:"text-xl text-blue-100 mb-8",children:s.description}),e.jsx("div",{className:"flex justify-center space-x-8",children:s.stats.map((q,ne)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:q.value}),e.jsx("div",{className:"text-blue-200",children:q.label})]},ne))})]})}),e.jsx("section",{className:"bg-gray-50 py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:t.title}),e.jsx("p",{className:"text-lg text-gray-700 mb-6",children:t.description}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.features.map((q,ne)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bs,{className:"text-green-600",size:20}),e.jsx("span",{className:"text-gray-700",children:q})]},ne))})]})}),e.jsx("section",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-8 text-center",children:"Our Impact in Numbers"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:i.map((q,ne)=>{const le=F[q.icon]||Xs;return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 w-12 h-12 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{className:"text-white",size:24})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-2",children:q.value}),e.jsx("div",{className:"text-gray-600",children:q.label})]},ne)})})]})}),e.jsx("section",{className:"bg-gray-50 py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-8 text-center",children:"Meet Our Team"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:g.slice(0,4).map((q,ne)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("img",{src:q.image,alt:q.name,className:"w-20 h-20 rounded-full mx-auto mb-4 object-cover"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:q.name}),e.jsx("p",{className:"text-blue-600 font-medium",children:q.role}),e.jsx("p",{className:"text-sm text-gray-600",children:q.experience})]},ne))})]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("input",{type:"file",ref:k,accept:"image/*",style:{display:"none"}}),e.jsx("input",{type:"file",accept:".json",onChange:V,style:{display:"none"},id:"import-file"}),e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_t,{className:"text-blue-600 shrink-0",size:24}),e.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"About Page Management"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>{var q;return(q=document.getElementById("import-file"))==null?void 0:q.click()},className:"flex items-center justify-center space-x-2 px-3 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 w-full sm:w-auto",children:[e.jsx(dt,{size:16}),e.jsx("span",{children:"Import"})]}),e.jsxs("button",{onClick:E,className:"flex items-center justify-center space-x-2 px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 w-full sm:w-auto",children:[e.jsx(ws,{size:16}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 w-full sm:w-auto",children:[e.jsx(ks,{size:16}),e.jsx("span",{children:"Preview"})]}),e.jsxs("button",{onClick:j,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 w-full sm:w-auto",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:"Save Changes"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Page Sections"}),e.jsx("nav",{className:"space-y-2",children:R.map(q=>{const ne=q.icon;return e.jsxs("button",{onClick:()=>w(q.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${P===q.id?"bg-blue-100 text-blue-700 border-l-4 border-blue-600":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ne,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:q.name})]},q.id)})})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:((K=R.find(q=>q.id===P))==null?void 0:K.name)||"Content Management"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(Yt,{className:"text-gray-400",size:20})})]}),e.jsx("div",{className:"max-h-screen overflow-y-auto",children:Y()})]})})]})})]})},s2=()=>{var L;const[s,a]=l.useState({title:"Get in Touch",description:"Ready to find your dream property or sell your current one? Our expert team is here to help you every step of the way.",stats:[{label:"Response Time",value:"2-4 Hours"},{label:"Support Available",value:"24/7"},{label:"Satisfaction Rate",value:"98%"}]}),[t,r]=l.useState([{icon:"Phone",title:"Call Us",details:["+91 99999 99999","+91 88888 88888"],description:"24/7 Customer Support",color:"green"},{icon:"Mail",title:"Email Us",details:["info@resaleexpert.in","support@resaleexpert.in"],description:"Quick Response Guaranteed",color:"blue"},{icon:"MapPin",title:"Visit Us",details:["Office 501, Business Tower","Andheri West, Mumbai - 400058"],description:"Maharashtra, India",color:"purple"},{icon:"Clock",title:"Office Hours",details:["Mon - Sat: 9:00 AM - 8:00 PM","Sunday: 10:00 AM - 6:00 PM"],description:"Extended Hours Available",color:"orange"}]),[i,n]=l.useState([{city:"Mumbai",address:"Office 501, Business Tower, Andheri West, Mumbai - 400058",phone:"+91 99999 99999",email:"mumbai@resaleexpert.in"},{city:"Pune",address:"Floor 3, Tech Park, Hinjewadi, Pune - 411057",phone:"+91 99999 99998",email:"pune@resaleexpert.in"},{city:"Delhi",address:"Tower A, Business Complex, Connaught Place, Delhi - 110001",phone:"+91 99999 99997",email:"delhi@resaleexpert.in"}]),[o,m]=l.useState([{question:"How quickly do you respond to inquiries?",answer:"We respond to all inquiries within 2-4 hours during business hours and within 24 hours on weekends."},{question:"Do you charge for consultation?",answer:"Our initial consultation is completely free. We only charge when you decide to proceed with our services."},{question:"What areas do you cover?",answer:"We currently operate in Mumbai, Pune, Delhi, Bangalore, and Hyderabad, with plans to expand to more cities."},{question:"Can I schedule a property visit?",answer:"Yes! You can schedule property visits through our website, mobile app, or by calling our customer service team."}]),[g,b]=l.useState([{platform:"Facebook",icon:"Facebook",url:"https://facebook.com/resaleexpert",isActive:!0},{platform:"Twitter",icon:"Twitter",url:"https://twitter.com/resaleexpert",isActive:!0},{platform:"Instagram",icon:"Instagram",url:"https://instagram.com/resaleexpert",isActive:!0},{platform:"LinkedIn",icon:"Linkedin",url:"https://linkedin.com/company/resaleexpert",isActive:!0}]),[d,v]=l.useState({title:"Emergency Contact",description:"Need urgent assistance outside business hours?",phone:"+91 77777 77777",email:"urgent@resaleexpert.in"}),[x,u]=l.useState({title:"Send us a Message",description:"Fill out the form below and we'll get back to you within 24 hours with personalized assistance.",fields:{name:{label:"Full Name",required:!0,placeholder:"Enter your full name"},email:{label:"Email Address",required:!0,placeholder:"Enter your email address"},phone:{label:"Phone Number",required:!0,placeholder:"Enter your phone number"},subject:{label:"Subject",required:!0,placeholder:"What can we help you with?"},message:{label:"Message",required:!0,placeholder:"Tell us more about your requirements..."},propertyType:{label:"Property Type",required:!1,placeholder:"Select property type"},budget:{label:"Budget Range",required:!1,placeholder:"Select budget range"}},submitButtonText:"Send Message",successMessage:"Thank you! We will get back to you within 24 hours.",errorMessage:"Please fill all required fields."}),[c,f]=l.useState("hero"),[p,N]=l.useState(!1),P=l.useRef(null),w=[{id:"hero",name:"Hero Section",icon:_t},{id:"form",name:"Contact Form Settings",icon:tt},{id:"contactinfo",name:"Contact Information",icon:Cs},{id:"offices",name:"Office Locations",icon:Is},{id:"faq",name:"FAQ Management",icon:to},{id:"social",name:"Social Media Links",icon:Ns},{id:"emergency",name:"Emergency Contact",icon:ct}],$={Phone:Cs,Mail:Ds,MapPin:Qs,Clock:Ls,MessageCircle:tt,Building:Is,Facebook:Sr,Twitter:kr,Instagram:El,Linkedin:Cr,Globe:_t,Users:Ns,Settings:Yt},y=["green","blue","purple","orange","red","indigo","pink","yellow"],k=()=>{const D=document.createElement("div");D.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50",D.textContent="Contact page data saved successfully!",document.body.appendChild(D),setTimeout(()=>document.body.removeChild(D),3e3)},R=()=>{const I=JSON.stringify({hero:s,contactInfo:t,offices:i,faq:o,social:g,emergency:d,form:x},null,2),H=new Blob([I],{type:"application/json"}),h=document.createElement("a");h.href=URL.createObjectURL(H),h.download="contact-page-data.json",h.click()},F=D=>{const I=D.target.files[0];if(I){const H=new FileReader;H.onload=h=>{try{const Y=JSON.parse(typeof h.target.result=="string"?h.target.result:"");Y.hero&&a(Y.hero),Y.contactInfo&&r(Y.contactInfo),Y.offices&&n(Y.offices),Y.faq&&m(Y.faq),Y.social&&b(Y.social),Y.emergency&&v(Y.emergency),Y.form&&u(Y.form),alert("Data imported successfully!")}catch{alert("Error importing data. Please check the file format.")}},H.readAsText(I)}},T=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Page Title"}),e.jsx("input",{type:"text",value:s.title,onChange:D=>a({...s,title:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:D=>a({...s,description:D.target.value}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Hero Statistics"}),e.jsx("div",{className:"space-y-4",children:s.stats.map((D,I)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Label"}),e.jsx("input",{type:"text",value:D.label,onChange:H=>{const h=[...s.stats];h[I].label=H.target.value,a({...s,stats:h})},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:D.value,onChange:H=>{const h=[...s.stats];h[I].value=H.target.value,a({...s,stats:h})},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},I))})]})]}),j=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Form Title"}),e.jsx("input",{type:"text",value:x.title,onChange:D=>u({...x,title:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Submit Button Text"}),e.jsx("input",{type:"text",value:x.submitButtonText,onChange:D=>u({...x,submitButtonText:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Form Description"}),e.jsx("textarea",{value:x.description,onChange:D=>u({...x,description:D.target.value}),rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Success Message"}),e.jsx("textarea",{value:x.successMessage,onChange:D=>u({...x,successMessage:D.target.value}),rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Error Message"}),e.jsx("textarea",{value:x.errorMessage,onChange:D=>u({...x,errorMessage:D.target.value}),rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Form Fields Configuration"}),e.jsx("div",{className:"space-y-4",children:Object.entries(x.fields).map(([D,I])=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3 capitalize",children:D.replace(/([A-Z])/g," $1")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Label"}),e.jsx("input",{type:"text",value:I.label,onChange:H=>{const h={...x.fields};h[D].label=H.target.value,u({...x,fields:h})},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Placeholder"}),e.jsx("input",{type:"text",value:I.placeholder,onChange:H=>{const h={...x.fields};h[D].placeholder=H.target.value,u({...x,fields:h})},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:I.required,onChange:H=>{const h={...x.fields};h[D].required=H.target.checked,u({...x,fields:h})},className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Required Field"})]})})]})]},D))})]})]}),E=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Contact Information Management"}),e.jsxs("button",{onClick:()=>r([...t,{icon:"Phone",title:"New Contact",details:["Detail 1","Detail 2"],description:"Description",color:"blue"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Contact Info"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map((D,I)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Contact Info ",I+1]}),e.jsx("button",{onClick:()=>r(t.filter((H,h)=>h!==I)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:D.title,onChange:H=>{const h=[...t];h[I].title=H.target.value,r(h)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:D.icon,onChange:H=>{const h=[...t];h[I].icon=H.target.value,r(h)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys($).map(H=>e.jsx("option",{value:H,children:H},H))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:D.description,onChange:H=>{const h=[...t];h[I].description=H.target.value,r(h)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Color Theme"}),e.jsx("select",{value:D.color,onChange:H=>{const h=[...t];h[I].color=H.target.value,r(h)},className:"w-full p-2 border border-gray-300 rounded-lg",children:y.map(H=>e.jsx("option",{value:H,children:H.charAt(0).toUpperCase()+H.slice(1)},H))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Contact Details"}),e.jsxs("div",{className:"space-y-2",children:[D.details.map((H,h)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:H,onChange:Y=>{const K=[...t];K[I].details[h]=Y.target.value,r(K)},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>{const Y=[...t];Y[I].details.splice(h,1),r(Y)},className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:e.jsx(Es,{size:16})})]},h)),e.jsxs("button",{onClick:()=>{const H=[...t];H[I].details.push("New Detail"),r(H)},className:"flex items-center space-x-2 p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Detail"})]})]})]})]},I))})]}),V=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Office Locations Management"}),e.jsxs("button",{onClick:()=>n([...i,{city:"New City",address:"New Address",phone:"+91 00000 00000",email:"newcity@resaleexpert.in"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Office"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((D,I)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Office ",I+1]}),e.jsx("button",{onClick:()=>n(i.filter((H,h)=>h!==I)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"City"}),e.jsx("input",{type:"text",value:D.city,onChange:H=>{const h=[...i];h[I].city=H.target.value,n(h)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Address"}),e.jsx("textarea",{value:D.address,onChange:H=>{const h=[...i];h[I].address=H.target.value,n(h)},rows:3,className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phone"}),e.jsx("input",{type:"text",value:D.phone,onChange:H=>{const h=[...i];h[I].phone=H.target.value,n(h)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:D.email,onChange:H=>{const h=[...i];h[I].email=H.target.value,n(h)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},I))})]}),W=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"FAQ Management"}),e.jsxs("button",{onClick:()=>m([...o,{question:"New Question?",answer:"Answer to the new question."}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add FAQ"})]})]}),e.jsx("div",{className:"space-y-4",children:o.map((D,I)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"font-medium",children:["FAQ ",I+1]}),e.jsx("button",{onClick:()=>m(o.filter((H,h)=>h!==I)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Question"}),e.jsx("input",{type:"text",value:D.question,onChange:H=>{const h=[...o];h[I].question=H.target.value,m(h)},className:"w-full p-3 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Answer"}),e.jsx("textarea",{value:D.answer,onChange:H=>{const h=[...o];h[I].answer=H.target.value,m(h)},rows:3,className:"w-full p-3 border border-gray-300 rounded-lg"})]})]})]},I))})]}),B=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Social Media Links Management"}),e.jsxs("button",{onClick:()=>b([...g,{platform:"New Platform",icon:"Globe",url:"https://",isActive:!0}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Social Link"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:g.map((D,I)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:D.platform}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:D.isActive,onChange:H=>{const h=[...g];h[I].isActive=H.target.checked,b(h)},className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Active"})]}),e.jsx("button",{onClick:()=>b(g.filter((H,h)=>h!==I)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Platform Name"}),e.jsx("input",{type:"text",value:D.platform,onChange:H=>{const h=[...g];h[I].platform=H.target.value,b(h)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:D.icon,onChange:H=>{const h=[...g];h[I].icon=H.target.value,b(h)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys($).map(H=>e.jsx("option",{value:H,children:H},H))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:D.url,onChange:H=>{const h=[...g];h[I].url=H.target.value,b(h)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},I))})]}),M=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section Title"}),e.jsx("input",{type:"text",value:d.title,onChange:D=>v({...d,title:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:d.description,onChange:D=>v({...d,description:D.target.value}),rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Phone"}),e.jsx("input",{type:"text",value:d.phone,onChange:D=>v({...d,phone:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Email"}),e.jsx("input",{type:"email",value:d.email,onChange:D=>v({...d,email:D.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg"})]})]})]}),A=()=>{switch(c){case"hero":return T();case"form":return j();case"contactinfo":return E();case"offices":return V();case"faq":return W();case"social":return B();case"emergency":return M();default:return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"Select a section to edit"})}};return p?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Contact Page Preview"}),e.jsxs("button",{onClick:()=>N(!1),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ln,{size:16}),e.jsx("span",{children:"Edit Mode"})]})]})})}),e.jsxs("div",{className:"space-y-8",children:[e.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-purple-700 text-white py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center",children:[e.jsx("h2",{className:"text-4xl font-bold mb-4",children:s.title}),e.jsx("p",{className:"text-xl text-blue-100 mb-8",children:s.description}),e.jsx("div",{className:"flex justify-center space-x-8",children:s.stats.map((D,I)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:D.value}),e.jsx("div",{className:"text-blue-200",children:D.label})]},I))})]})}),e.jsx("section",{className:"py-12",children:e.jsx("div",{className:"max-w-4xl mx-auto px-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:x.title}),e.jsx("p",{className:"text-gray-600 mb-6",children:x.description}),e.jsxs("div",{className:"space-y-4",children:[Object.entries(x.fields).map(([D,I])=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[I.label," ",I.required&&"*"]}),e.jsx("input",{type:"text",placeholder:I.placeholder,className:"w-full p-3 border border-gray-300 rounded-lg",disabled:!0})]},D)),e.jsx("button",{className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 px-6 rounded-lg font-semibold",children:x.submitButtonText})]})]})})}),e.jsx("section",{className:"py-12 bg-gray-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-8 text-center",children:"Contact Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.slice(0,4).map((D,I)=>{const H=$[D.icon]||Cs;return e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${D.color==="green"?"bg-green-500":D.color==="blue"?"bg-blue-500":D.color==="purple"?"bg-purple-500":"bg-orange-500"}`,children:e.jsx(H,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:D.title}),D.details.map((h,Y)=>e.jsx("p",{className:"text-gray-700",children:h},Y)),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:D.description})]})]})},I)})})]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("input",{type:"file",ref:P,accept:"image/*",style:{display:"none"}}),e.jsx("input",{type:"file",accept:".json",onChange:F,style:{display:"none"},id:"import-file"}),e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[e.jsx(Cs,{className:"text-blue-600 shrink-0",size:24}),e.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:"Contact Page Management"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>{var D;return(D=document.getElementById("import-file"))==null?void 0:D.click()},className:"flex items-center justify-center space-x-2 px-3 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Import",children:[e.jsx(dt,{size:16}),e.jsx("span",{children:"Import"})]}),e.jsxs("button",{onClick:R,className:"flex items-center justify-center space-x-2 px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Export",children:[e.jsx(ws,{size:16}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Preview",children:[e.jsx(ks,{size:16}),e.jsx("span",{children:"Preview"})]}),e.jsxs("button",{onClick:k,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Save Changes",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:"Save Changes"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Page Sections"}),e.jsx("nav",{className:"space-y-2",children:w.map(D=>{const I=D.icon;return e.jsxs("button",{onClick:()=>f(D.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${c===D.id?"bg-blue-100 text-blue-700 border-l-4 border-blue-600":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(I,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:D.name})]},D.id)})})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 truncate",children:((L=w.find(D=>D.id===c))==null?void 0:L.name)||"Content Management"}),e.jsx("div",{className:"flex items-center justify-end sm:justify-start space-x-2",children:e.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition","aria-label":"Settings",children:e.jsx(Yt,{className:"text-gray-500",size:20})})})]}),e.jsx("div",{className:"max-h-[70vh] lg:max-h-screen overflow-y-auto",children:A()})]})})]})})]})},t2=()=>{var Y;const[s,a]=l.useState({name:"ResaleExpert",logo:"",tagline:"Your Trusted Real Estate Partner",description:"India's most trusted real estate platform connecting millions with verified properties.",trustIndicators:[{icon:"Shield",text:"100% Verified Properties"},{icon:"Award",text:"Award Winning Service"},{icon:"CheckCircle",text:"10,000+ Happy Customers"}]}),[t,r]=l.useState([{id:"home",label:"Home",href:"/"},{id:"properties",label:"Properties",href:"/properties"},{id:"about",label:"About Us",href:"/about"},{id:"contact",label:"Contact Us",href:"/contact"},{id:"privacy",label:"Privacy Policy",href:"/privacy"},{id:"terms",label:"Terms & Conditions",href:"/terms"}]),[i,n]=l.useState([{label:"Property Selling",href:"/services/selling"},{label:"Property Buying",href:"/services/buying"},{label:"Property Rental",href:"/services/rental"},{label:"Legal Services",href:"/services/legal"},{label:"Loan Assistance",href:"/services/loans"},{label:"Property Management",href:"/services/management"}]),[o,m]=l.useState({address:{line1:"Office 501, Business Tower",line2:"Andheri West, Mumbai - 400058",line3:"Maharashtra, India"},phone:{number:"+91 99999 99999",description:"24/7 Support Available"},email:{address:"info@resaleexpert.in",description:"Quick Response Guaranteed"},hours:{weekdays:"Mon - Sat: 9:00 AM - 8:00 PM",sunday:"Sunday: 10:00 AM - 6:00 PM"}}),[g,b]=l.useState(["Andheri West","Bandra West","Juhu","Powai","Versova","Malad West"]),[d,v]=l.useState([{platform:"Facebook",icon:"Facebook",url:"https://facebook.com/resaleexpert",color:"text-blue-600",isActive:!0},{platform:"Twitter",icon:"Twitter",url:"https://twitter.com/resaleexpert",color:"text-blue-400",isActive:!0},{platform:"Instagram",icon:"Instagram",url:"https://instagram.com/resaleexpert",color:"text-pink-600",isActive:!0},{platform:"LinkedIn",icon:"Linkedin",url:"https://linkedin.com/company/resaleexpert",color:"text-blue-700",isActive:!0},{platform:"YouTube",icon:"Youtube",url:"https://youtube.com/@resaleexpert",color:"text-red-600",isActive:!0}]),[x,u]=l.useState({copyrightText:"All rights reserved. | Designed with â¤ï¸ for better real estate experience.",followText:"Follow us:"}),[c,f]=l.useState({isEnabled:!0,phoneNumber:"919999999999",defaultMessage:"Hi, I'm interested in your real estate services",buttonText:"Chat with us"}),[p,N]=l.useState("company"),[P,w]=l.useState(!1),$=l.useRef(null),y=l.useRef(null),k=[{id:"company",name:"Company Information",icon:Is},{id:"quicklinks",name:"Quick Links",icon:za},{id:"services",name:"Services",icon:On},{id:"contact",name:"Contact Information",icon:Cs},{id:"locations",name:"Popular Locations",icon:Qs},{id:"social",name:"Social Media",icon:Ns},{id:"bottom",name:"Footer Bottom",icon:_t},{id:"whatsapp",name:"WhatsApp Chat",icon:tt}],R={Home:yt,Phone:Cs,Mail:Ds,MapPin:Qs,Facebook:Sr,Twitter:kr,Instagram:El,Linkedin:Cr,Youtube:Cu,Building:Is,Users:Ns,Briefcase:On,MessageCircle:tt,Star:Xs,Shield:at,Award:Ct,Clock:Ls,CheckCircle:bs},F=["text-blue-600","text-blue-400","text-pink-600","text-blue-700","text-red-600","text-green-600","text-purple-600","text-yellow-600","text-indigo-600","text-gray-600"],T=K=>{$.current.click(),$.current.onchange=q=>{const ne=q.target.files[0];if(ne){const le=new FileReader;le.onload=S=>{K(S.target.result)},le.readAsDataURL(ne)}}},j=()=>{const K=document.createElement("div");K.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50",K.textContent="Footer data saved successfully!",document.body.appendChild(K),setTimeout(()=>document.body.removeChild(K),3e3)},E=()=>{const q=JSON.stringify({company:s,quickLinks:t,services:i,contact:o,locations:g,social:d,footerBottom:x,whatsapp:c},null,2),ne=new Blob([q],{type:"application/json"}),le=document.createElement("a");le.href=URL.createObjectURL(ne),le.download="footer-data.json",le.click()},V=K=>{const q=K.target.files[0];if(q){const ne=new FileReader;ne.onload=le=>{try{const S=JSON.parse(typeof le.target.result=="string"?le.target.result:"");S.company&&a(S.company),S.quickLinks&&r(S.quickLinks),S.services&&n(S.services),S.contact&&m(S.contact),S.locations&&b(S.locations),S.social&&v(S.social),S.footerBottom&&u(S.footerBottom),S.whatsapp&&f(S.whatsapp),alert("Data imported successfully!")}catch{alert("Error importing data. Please check the file format.")}},ne.readAsText(q)}},W=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),e.jsx("input",{type:"text",value:s.name,onChange:K=>a({...s,name:K.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tagline"}),e.jsx("input",{type:"text",value:s.tagline,onChange:K=>a({...s,tagline:K.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Logo"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"text",value:s.logo,onChange:K=>a({...s,logo:K.target.value}),className:"flex-1 p-3 border border-gray-300 rounded-lg",placeholder:"Logo URL or upload image"}),e.jsx("button",{onClick:()=>T(K=>a({...s,logo:K})),className:"p-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:e.jsx(Sa,{size:20})})]}),s.logo&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:s.logo,alt:"Company Logo",className:"h-12 object-contain"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:K=>a({...s,description:K.target.value}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Trust Indicators"}),e.jsxs("div",{className:"space-y-4",children:[s.trustIndicators.map((K,q)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:K.icon,onChange:ne=>{const le=[...s.trustIndicators];le[q].icon=ne.target.value,a({...s,trustIndicators:le})},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(R).map(ne=>e.jsx("option",{value:ne,children:ne},ne))})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:K.text,onChange:ne=>{const le=[...s.trustIndicators];le[q].text=ne.target.value,a({...s,trustIndicators:le})},className:"flex-1 p-2 border border-gray-300 rounded-lg",placeholder:"Trust indicator text"}),e.jsx("button",{onClick:()=>{const ne=s.trustIndicators.filter((le,S)=>S!==q);a({...s,trustIndicators:ne})},className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:e.jsx(Es,{size:16})})]})]},q)),e.jsxs("button",{onClick:()=>a({...s,trustIndicators:[...s.trustIndicators,{icon:"Star",text:"New Feature"}]}),className:"flex items-center space-x-2 p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Trust Indicator"})]})]})]})]}),B=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Quick Links Management"}),e.jsxs("button",{onClick:()=>r([...t,{id:"new",label:"New Link",href:"#"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Link"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((K,q)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Link ",q+1]}),e.jsx("button",{onClick:()=>r(t.filter((ne,le)=>le!==q)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Label"}),e.jsx("input",{type:"text",value:K.label,onChange:ne=>{const le=[...t];le[q].label=ne.target.value,r(le)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"URL/Path"}),e.jsx("input",{type:"text",value:K.href,onChange:ne=>{const le=[...t];le[q].href=ne.target.value,r(le)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"ID (for routing)"}),e.jsx("input",{type:"text",value:K.id,onChange:ne=>{const le=[...t];le[q].id=ne.target.value,r(le)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},q))})]}),M=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Services Management"}),e.jsxs("button",{onClick:()=>n([...i,{label:"New Service",href:"#"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Service"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((K,q)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-medium",children:["Service ",q+1]}),e.jsx("button",{onClick:()=>n(i.filter((ne,le)=>le!==q)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Service Name"}),e.jsx("input",{type:"text",value:K.label,onChange:ne=>{const le=[...i];le[q].label=ne.target.value,n(le)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Service URL"}),e.jsx("input",{type:"text",value:K.href,onChange:ne=>{const le=[...i];le[q].href=ne.target.value,n(le)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},q))})]}),A=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Address Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Address Line 1"}),e.jsx("input",{type:"text",value:o.address.line1,onChange:K=>m({...o,address:{...o.address,line1:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Address Line 2"}),e.jsx("input",{type:"text",value:o.address.line2,onChange:K=>m({...o,address:{...o.address,line2:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Address Line 3"}),e.jsx("input",{type:"text",value:o.address.line3,onChange:K=>m({...o,address:{...o.address,line3:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Phone Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phone Number"}),e.jsx("input",{type:"text",value:o.phone.number,onChange:K=>m({...o,phone:{...o.phone,number:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phone Description"}),e.jsx("input",{type:"text",value:o.phone.description,onChange:K=>m({...o,phone:{...o.phone,description:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Email Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:o.email.address,onChange:K=>m({...o,email:{...o.email,address:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Email Description"}),e.jsx("input",{type:"text",value:o.email.description,onChange:K=>m({...o,email:{...o.email,description:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Business Hours"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Weekdays Schedule"}),e.jsx("input",{type:"text",value:o.hours.weekdays,onChange:K=>m({...o,hours:{...o.hours,weekdays:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Sunday Schedule"}),e.jsx("input",{type:"text",value:o.hours.sunday,onChange:K=>m({...o,hours:{...o.hours,sunday:K.target.value}}),className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]})]}),L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Popular Locations Management"}),e.jsxs("button",{onClick:()=>b([...g,"New Location"]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Location"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:g.map((K,q)=>e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:K,onChange:ne=>{const le=[...g];le[q]=ne.target.value,b(le)},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>b(g.filter((ne,le)=>le!==q)),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:e.jsx(Es,{size:16})})]})},q))})]}),D=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Social Media Links Management"}),e.jsxs("button",{onClick:()=>v([...d,{platform:"New Platform",icon:"Users",url:"https://",color:"text-blue-600",isActive:!0}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Social Link"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map((K,q)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:K.platform}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:K.isActive,onChange:ne=>{const le=[...d];le[q].isActive=ne.target.checked,v(le)},className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Active"})]}),e.jsx("button",{onClick:()=>v(d.filter((ne,le)=>le!==q)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Platform Name"}),e.jsx("input",{type:"text",value:K.platform,onChange:ne=>{const le=[...d];le[q].platform=ne.target.value,v(le)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:K.icon,onChange:ne=>{const le=[...d];le[q].icon=ne.target.value,v(le)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(R).map(ne=>e.jsx("option",{value:ne,children:ne},ne))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"URL"}),e.jsx("input",{type:"url",value:K.url,onChange:ne=>{const le=[...d];le[q].url=ne.target.value,v(le)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Color Class"}),e.jsx("select",{value:K.color,onChange:ne=>{const le=[...d];le[q].color=ne.target.value,v(le)},className:"w-full p-2 border border-gray-300 rounded-lg",children:F.map(ne=>e.jsx("option",{value:ne,children:ne.replace("text-","").replace("-"," ")},ne))})]})]},q))})]}),I=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Copyright Text"}),e.jsx("textarea",{value:x.copyrightText,onChange:K=>u({...x,copyrightText:K.target.value}),rows:2,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"All rights reserved. | Designed with â¤ï¸ for better real estate experience."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Social Follow Text"}),e.jsx("input",{type:"text",value:x.followText,onChange:K=>u({...x,followText:K.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Follow us:"})]})]}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("input",{type:"checkbox",checked:c.isEnabled,onChange:K=>f({...c,isEnabled:K.target.checked}),className:"rounded"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Enable WhatsApp Chat Button"})]}),c.isEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"text",value:c.phoneNumber,onChange:K=>f({...c,phoneNumber:K.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg",placeholder:"919999999999"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Include country code without + sign"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Text"}),e.jsx("input",{type:"text",value:c.buttonText,onChange:K=>f({...c,buttonText:K.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg",placeholder:"Chat with us"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Message"}),e.jsx("textarea",{value:c.defaultMessage,onChange:K=>f({...c,defaultMessage:K.target.value}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Hi, I'm interested in your real estate services"})]})]})]}),h=()=>{switch(p){case"company":return W();case"quicklinks":return B();case"services":return M();case"contact":return A();case"locations":return L();case"social":return D();case"bottom":return I();case"whatsapp":return H();default:return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"Select a section to edit"})}};return P?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Footer Preview"}),e.jsxs("button",{onClick:()=>w(!1),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ln,{size:16}),e.jsx("span",{children:"Edit Mode"})]})]})})}),e.jsx("div",{className:"bg-gray-900 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[s.logo&&e.jsx("img",{src:s.logo,alt:s.name,className:"h-10 object-contain"}),e.jsx("span",{className:"text-xl font-bold",children:s.name})]}),e.jsx("p",{className:"text-gray-300 mb-6",children:s.tagline}),e.jsx("div",{className:"space-y-2",children:s.trustIndicators.map((K,q)=>{const ne=R[K.icon]||Xs;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"text-green-400",size:16}),e.jsx("span",{className:"text-sm text-gray-300",children:K.text})]},q)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Quick Links"}),e.jsx("ul",{className:"space-y-2",children:t.map((K,q)=>e.jsx("li",{children:e.jsx("a",{href:K.href,className:"text-gray-300 hover:text-white text-sm",children:K.label})},q))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Our Services"}),e.jsx("ul",{className:"space-y-2",children:i.slice(0,6).map((K,q)=>e.jsx("li",{children:e.jsx("a",{href:K.href,className:"text-gray-300 hover:text-white text-sm",children:K.label})},q))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6",children:"Contact Info"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Qs,{className:"text-blue-400 mt-1",size:16}),e.jsxs("div",{className:"text-gray-300",children:[e.jsx("p",{children:o.address.line1}),e.jsx("p",{children:o.address.line2}),e.jsx("p",{children:o.address.line3})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cs,{className:"text-green-400",size:16}),e.jsxs("div",{className:"text-gray-300",children:[e.jsx("p",{children:o.phone.number}),e.jsx("p",{className:"text-xs text-gray-400",children:o.phone.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ds,{className:"text-purple-400",size:16}),e.jsxs("div",{className:"text-gray-300",children:[e.jsx("p",{children:o.email.address}),e.jsx("p",{className:"text-xs text-gray-400",children:o.email.description})]})]})]})]})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-800",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Popular Locations"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((K,q)=>e.jsx("button",{className:"px-3 py-1 bg-gray-800 text-gray-300 rounded text-sm hover:bg-gray-700",children:K},q))})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-800 flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"text-gray-400 text-sm mb-4 md:mb-0",children:["Â© ",new Date().getFullYear()," ",s.name,". ",x.copyrightText]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:x.followText}),d.filter(K=>K.isActive).map((K,q)=>{const ne=R[K.icon]||Ns;return e.jsx("a",{href:K.url,className:`p-2 bg-gray-800 rounded-lg hover:bg-gray-700 ${K.color}`,children:e.jsx(ne,{size:16})},q)})]})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("input",{type:"file",ref:$,accept:"image/*",style:{display:"none"}}),e.jsx("input",{type:"file",ref:y,accept:".json",onChange:V,style:{display:"none"}}),e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[e.jsx(Mh,{className:"text-blue-600 shrink-0",size:24}),e.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:"Footer Management"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>{var K;return(K=y==null?void 0:y.current)==null?void 0:K.click()},className:"flex items-center justify-center space-x-2 px-3 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 w-full sm:w-auto whitespace-nowrap",children:[e.jsx(dt,{size:16}),e.jsx("span",{children:"Import"})]}),e.jsxs("button",{onClick:E,className:"flex items-center justify-center space-x-2 px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 w-full sm:w-auto whitespace-nowrap",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:()=>w(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 w-full sm:w-auto whitespace-nowrap",children:[e.jsx(ks,{size:16}),e.jsx("span",{children:"Preview"})]}),e.jsxs("button",{onClick:j,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 w-full sm:w-auto whitespace-nowrap",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:"Save Changes"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Footer Sections"}),e.jsx("nav",{className:"space-y-2",children:k.map(K=>{const q=K.icon;return e.jsxs("button",{onClick:()=>N(K.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${p===K.id?"bg-blue-100 text-blue-700 border-l-4 border-blue-600":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(q,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:K.name})]},K.id)})})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:((Y=k.find(K=>K.id===p))==null?void 0:Y.name)||"Content Management"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(Yt,{className:"text-gray-400",size:20})})]}),e.jsx("div",{className:"max-h-screen overflow-y-auto",children:h()})]})})]})})]})},a2=()=>{var ne;const[s,a]=l.useState({title:"Complete Real Estate Solutions",description:"From property search to final registration, we provide end-to-end real estate services with expert guidance and transparent pricing",primaryButtonText:"Get Free Consultation",secondaryButtonText:"View All Services"}),[t,r]=l.useState([{id:"property-buying",title:"Property Buying",subtitle:"Find Your Dream Home",description:"Comprehensive assistance in finding and purchasing your perfect property with expert guidance and verified listings.",icon:"Home",color:"blue",features:["AI-powered property matching","Verified property listings","Expert property evaluation","Negotiation support","Legal documentation assistance","Post-purchase support"],process:["Requirement Analysis","Property Shortlisting","Site Visits & Evaluation","Price Negotiation","Legal Verification","Registration & Handover"],price:"No Hidden Charges",duration:"15-30 days",successRate:"95%"},{id:"property-selling",title:"Property Selling",subtitle:"Maximize Your Returns",description:"End-to-end selling support with premium marketing, verified buyers, and transparent pricing to get the best value.",icon:"Building",color:"green",features:["Professional property photography","Multi-channel marketing","Verified buyer database","Price optimization strategies","Legal documentation support","Hassle-free transactions"],process:["Property Valuation","Documentation Review","Marketing & Promotion","Buyer Screening","Negotiation & Closure","Registration Support"],price:"2% Commission",duration:"30-60 days",successRate:"92%"}]),[i,n]=l.useState([{title:"Property Valuation",description:"Professional property valuation for accurate market pricing",icon:"Calculator",price:"â‚¹5,000"},{title:"Virtual Property Tours",description:"360Â° virtual tours for remote property viewing",icon:"Eye",price:"â‚¹8,000"}]),[o,m]=l.useState([{title:"15+ Years Experience",description:"Decades of expertise in real estate",icon:"Award",stat:"15+"},{title:"Verified Properties",description:"100% legal and verified listings",icon:"Shield",stat:"100%"}]),[g,b]=l.useState([{step:"1",title:"Consultation",description:"Free consultation to understand your requirements"},{step:"2",title:"Planning",description:"Detailed planning and strategy development"},{step:"3",title:"Execution",description:"Professional execution with regular updates"},{step:"4",title:"Completion",description:"Successful completion with post-service support"}]),[d,v]=l.useState([{name:"Rajesh Kumar",service:"Property Buying",text:"ResaleExpert helped me find my dream home within my budget. Their AI matching is incredible!",rating:5,location:"Mumbai",image:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=200"},{name:"Priya Sharma",service:"Property Selling",text:"Sold my property 20% above market rate with their expert marketing strategies.",rating:5,location:"Pune",image:"https://images.pexels.com/photos/3756679/pexels-photo-3756679.jpeg?auto=compress&cs=tinysrgb&w=200"}]),[x,u]=l.useState([{name:"Basic",price:"Free",description:"Perfect for first-time users",features:["Property search & listings","Basic property details","Contact property owners","Basic market insights"],buttonText:"Get Started",buttonColor:"gray",isPopular:!1},{name:"Premium",price:"â‚¹2,999",description:"Most popular choice",features:["Everything in Basic","Expert consultation","Site visit assistance","Legal verification","Loan assistance"],buttonText:"Choose Premium",buttonColor:"blue",isPopular:!0},{name:"Enterprise",price:"Custom",description:"For large portfolios",features:["Everything in Premium","Dedicated relationship manager","Priority support","Custom solutions"],buttonText:"Contact Sales",buttonColor:"purple",isPopular:!1}]),[c,f]=l.useState([{question:"What makes ResaleExpert different from other platforms?",answer:"We offer 100% verified properties, AI-powered matching, and end-to-end support with transparent pricing. Our expert team ensures a smooth experience from search to registration."},{question:"How do you verify properties?",answer:"Our verification process includes legal document checks, physical property inspection, ownership verification, and compliance checks to ensure authenticity and legal clarity."}]),[p,N]=l.useState({title:"Ready to Get Started?",description:"Let our experts help you with your real estate needs. Get a free consultation today!",primaryButtonText:"Get Free Consultation",secondaryButtonText:"Call Now: +91 99999 99999",features:[{icon:"Phone",text:"24/7 Support"},{icon:"Shield",text:"100% Verified"},{icon:"Award",text:"Award Winning"}]}),[P,w]=l.useState("hero"),[$,y]=l.useState(!1),k=l.useRef(null),R=l.useRef(null),F=[{id:"hero",name:"Hero Section",icon:_t},{id:"coreservices",name:"Core Services",icon:at},{id:"additionalservices",name:"Additional Services",icon:fs},{id:"whychoose",name:"Why Choose Us",icon:Ct},{id:"process",name:"Service Process",icon:rt},{id:"testimonials",name:"Testimonials",icon:Ns},{id:"pricing",name:"Pricing Plans",icon:ka},{id:"faq",name:"FAQ Section",icon:to},{id:"cta",name:"Call to Action",icon:Cs}],T={Home:yt,Building:Is,CreditCard:Ut,FileText:ws,Shield:at,Users:Ns,TrendingUp:Rs,Award:Ct,Star:Xs,Phone:Cs,CheckCircle:bs,Calculator:sr,Search:it,HandHeart:gu,Briefcase:On,Clock:Ls,DollarSign:ka,Crown:va,Gem:vl,Zap:Ft,Bot:Mt,Rocket:Xl,Target:rt,Eye:ks},j=["blue","green","purple","orange","indigo","pink","red","yellow"],E=le=>{k.current.click(),k.current.onchange=S=>{const C=S.target.files[0];if(C){const J=new FileReader;J.onload=ue=>{le(ue.target.result)},J.readAsDataURL(C)}}},V=()=>{const le=document.createElement("div");le.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50",le.textContent="Services page data saved successfully!",document.body.appendChild(le),setTimeout(()=>document.body.removeChild(le),3e3)},W=()=>{const S=JSON.stringify({hero:s,coreServices:t,additionalServices:i,whyChooseUs:o,serviceProcess:g,testimonials:d,pricingPlans:x,faq:c,cta:p},null,2),C=new Blob([S],{type:"application/json"}),J=document.createElement("a");J.href=URL.createObjectURL(C),J.download="services-data.json",J.click()},B=le=>{const S=le.target.files[0];if(S){const C=new FileReader;C.onload=J=>{try{const ue=JSON.parse(typeof J.target.result=="string"?J.target.result:"");ue.hero&&a(ue.hero),ue.coreServices&&r(ue.coreServices),ue.additionalServices&&n(ue.additionalServices),ue.whyChooseUs&&m(ue.whyChooseUs),ue.serviceProcess&&b(ue.serviceProcess),ue.testimonials&&v(ue.testimonials),ue.pricingPlans&&u(ue.pricingPlans),ue.faq&&f(ue.faq),ue.cta&&N(ue.cta),alert("Data imported successfully!")}catch{alert("Error importing data. Please check the file format.")}},C.readAsText(S)}},M=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Page Title"}),e.jsx("input",{type:"text",value:s.title,onChange:le=>a({...s,title:le.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:s.description,onChange:le=>a({...s,description:le.target.value}),rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Button Text"}),e.jsx("input",{type:"text",value:s.primaryButtonText,onChange:le=>a({...s,primaryButtonText:le.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secondary Button Text"}),e.jsx("input",{type:"text",value:s.secondaryButtonText,onChange:le=>a({...s,secondaryButtonText:le.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg"})]})]})]}),A=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Core Services Management"}),e.jsxs("button",{onClick:()=>r([...t,{id:`service-${Date.now()}`,title:"New Service",subtitle:"Service Subtitle",description:"Service description",icon:"Shield",color:"blue",features:["Feature 1","Feature 2"],process:["Step 1","Step 2"],price:"Contact for pricing",duration:"Variable",successRate:"90%"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Service"})]})]}),e.jsx("div",{className:"space-y-8",children:t.map((le,S)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-lg font-medium",children:le.title}),e.jsx("button",{onClick:()=>r(t.filter((C,J)=>J!==S)),className:"text-red-600 hover:bg-red-100 p-2 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Service Title"}),e.jsx("input",{type:"text",value:le.title,onChange:C=>{const J=[...t];J[S].title=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Subtitle"}),e.jsx("input",{type:"text",value:le.subtitle,onChange:C=>{const J=[...t];J[S].subtitle=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("textarea",{value:le.description,onChange:C=>{const J=[...t];J[S].description=C.target.value,r(J)},rows:3,className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:le.icon,onChange:C=>{const J=[...t];J[S].icon=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(T).map(C=>e.jsx("option",{value:C,children:C},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Color"}),e.jsx("select",{value:le.color,onChange:C=>{const J=[...t];J[S].color=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg",children:j.map(C=>e.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1)},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Service ID"}),e.jsx("input",{type:"text",value:le.id,onChange:C=>{const J=[...t];J[S].id=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Features"}),e.jsxs("div",{className:"space-y-2",children:[le.features.map((C,J)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:C,onChange:ue=>{const Q=[...t];Q[S].features[J]=ue.target.value,r(Q)},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>{const ue=[...t];ue[S].features.splice(J,1),r(ue)},className:"p-2 text-red-600 hover:bg-red-100 rounded",children:e.jsx(Es,{size:14})})]},J)),e.jsxs("button",{onClick:()=>{const C=[...t];C[S].features.push("New Feature"),r(C)},className:"flex items-center space-x-2 p-2 text-blue-600 hover:bg-blue-100 rounded",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Feature"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Process Steps"}),e.jsxs("div",{className:"space-y-2",children:[le.process.map((C,J)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:C,onChange:ue=>{const Q=[...t];Q[S].process[J]=ue.target.value,r(Q)},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>{const ue=[...t];ue[S].process.splice(J,1),r(ue)},className:"p-2 text-red-600 hover:bg-red-100 rounded",children:e.jsx(Es,{size:14})})]},J)),e.jsxs("button",{onClick:()=>{const C=[...t];C[S].process.push("New Step"),r(C)},className:"flex items-center space-x-2 p-2 text-blue-600 hover:bg-blue-100 rounded",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Step"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Price"}),e.jsx("input",{type:"text",value:le.price,onChange:C=>{const J=[...t];J[S].price=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Duration"}),e.jsx("input",{type:"text",value:le.duration,onChange:C=>{const J=[...t];J[S].duration=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Success Rate"}),e.jsx("input",{type:"text",value:le.successRate,onChange:C=>{const J=[...t];J[S].successRate=C.target.value,r(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]},le.id))})]}),L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Testimonials Management"}),e.jsxs("button",{onClick:()=>v([...d,{name:"New Client",service:"Service Name",text:"Testimonial text goes here...",rating:5,location:"City",image:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=200"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Testimonial"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map((le,S)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:le.name}),e.jsx("button",{onClick:()=>v(d.filter((C,J)=>J!==S)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Client Name"}),e.jsx("input",{type:"text",value:le.name,onChange:C=>{const J=[...d];J[S].name=C.target.value,v(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Service Used"}),e.jsx("input",{type:"text",value:le.service,onChange:C=>{const J=[...d];J[S].service=C.target.value,v(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Testimonial Text"}),e.jsx("textarea",{value:le.text,onChange:C=>{const J=[...d];J[S].text=C.target.value,v(J)},rows:3,className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Rating (1-5)"}),e.jsx("input",{type:"number",min:"1",max:"5",value:le.rating,onChange:C=>{const J=[...d];J[S].rating=parseInt(C.target.value),v(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:le.location,onChange:C=>{const J=[...d];J[S].location=C.target.value,v(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Profile Image"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:le.image,onChange:C=>{const J=[...d];J[S].image=C.target.value,v(J)},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>E(C=>{const J=[...d];J[S].image=C,v(J)}),className:"p-2 bg-blue-600 text-white rounded-lg",children:e.jsx(Sa,{size:16})})]})]})]})]},S))})]}),D=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Pricing Plans Management"}),e.jsxs("button",{onClick:()=>u([...x,{name:"New Plan",price:"â‚¹0",description:"Plan description",features:["Feature 1","Feature 2"],buttonText:"Get Started",buttonColor:"blue",isPopular:!1}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Plan"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:x.map((le,S)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:le.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("label",{className:"flex items-center space-x-1",children:[e.jsx("input",{type:"checkbox",checked:le.isPopular,onChange:C=>{const J=[...x];J[S].isPopular=C.target.checked,u(J)},className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Popular"})]}),e.jsx("button",{onClick:()=>u(x.filter((C,J)=>J!==S)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Plan Name"}),e.jsx("input",{type:"text",value:le.name,onChange:C=>{const J=[...x];J[S].name=C.target.value,u(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Price"}),e.jsx("input",{type:"text",value:le.price,onChange:C=>{const J=[...x];J[S].price=C.target.value,u(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Button Color"}),e.jsx("select",{value:le.buttonColor,onChange:C=>{const J=[...x];J[S].buttonColor=C.target.value,u(J)},className:"w-full p-2 border border-gray-300 rounded-lg",children:j.map(C=>e.jsx("option",{value:C,children:C},C))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:le.description,onChange:C=>{const J=[...x];J[S].description=C.target.value,u(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Button Text"}),e.jsx("input",{type:"text",value:le.buttonText,onChange:C=>{const J=[...x];J[S].buttonText=C.target.value,u(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Features"}),e.jsxs("div",{className:"space-y-2",children:[le.features.map((C,J)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:C,onChange:ue=>{const Q=[...x];Q[S].features[J]=ue.target.value,u(Q)},className:"flex-1 p-2 border border-gray-300 rounded-lg"}),e.jsx("button",{onClick:()=>{const ue=[...x];ue[S].features.splice(J,1),u(ue)},className:"p-2 text-red-600 hover:bg-red-100 rounded",children:e.jsx(Es,{size:14})})]},J)),e.jsxs("button",{onClick:()=>{const C=[...x];C[S].features.push("New Feature"),u(C)},className:"flex items-center space-x-2 p-2 text-blue-600 hover:bg-blue-100 rounded",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Add Feature"})]})]})]})]})]},S))})]}),I=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Additional Services Management"}),e.jsxs("button",{onClick:()=>n([...i,{title:"New Service",description:"Service description",icon:"Shield",price:"â‚¹0"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Service"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i.map((le,S)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:le.title}),e.jsx("button",{onClick:()=>n(i.filter((C,J)=>J!==S)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Service Title"}),e.jsx("input",{type:"text",value:le.title,onChange:C=>{const J=[...i];J[S].title=C.target.value,n(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("textarea",{value:le.description,onChange:C=>{const J=[...i];J[S].description=C.target.value,n(J)},rows:3,className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:le.icon,onChange:C=>{const J=[...i];J[S].icon=C.target.value,n(J)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(T).map(C=>e.jsx("option",{value:C,children:C},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Price"}),e.jsx("input",{type:"text",value:le.price,onChange:C=>{const J=[...i];J[S].price=C.target.value,n(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]})]},S))})]}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Why Choose Us Management"}),e.jsxs("button",{onClick:()=>m([...o,{title:"New Reason",description:"Description of why to choose us",icon:"Award",stat:"100%"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Reason"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map((le,S)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:le.title}),e.jsx("button",{onClick:()=>m(o.filter((C,J)=>J!==S)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:le.title,onChange:C=>{const J=[...o];J[S].title=C.target.value,m(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("textarea",{value:le.description,onChange:C=>{const J=[...o];J[S].description=C.target.value,m(J)},rows:2,className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:le.icon,onChange:C=>{const J=[...o];J[S].icon=C.target.value,m(J)},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(T).map(C=>e.jsx("option",{value:C,children:C},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Statistic"}),e.jsx("input",{type:"text",value:le.stat,onChange:C=>{const J=[...o];J[S].stat=C.target.value,m(J)},className:"w-full p-2 border border-gray-300 rounded-lg",placeholder:"15+, 100%, etc."})]})]})]},S))})]}),h=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Service Process Management"}),e.jsxs("button",{onClick:()=>b([...g,{step:(g.length+1).toString(),title:"New Step",description:"Step description"}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Step"})]})]}),e.jsx("div",{className:"space-y-4",children:g.map((le,S)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Step ",le.step,": ",le.title]}),e.jsx("button",{onClick:()=>{const J=g.filter((ue,Q)=>Q!==S).map((ue,Q)=>({...ue,step:(Q+1).toString()}));b(J)},className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Step Number"}),e.jsx("input",{type:"text",value:le.step,onChange:C=>{const J=[...g];J[S].step=C.target.value,b(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Step Title"}),e.jsx("input",{type:"text",value:le.title,onChange:C=>{const J=[...g];J[S].title=C.target.value,b(J)},className:"w-full p-2 border border-gray-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),e.jsx("textarea",{value:le.description,onChange:C=>{const J=[...g];J[S].description=C.target.value,b(J)},rows:2,className:"w-full p-2 border border-gray-300 rounded-lg"})]})]},S))})]}),Y=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"FAQ Management"}),e.jsxs("button",{onClick:()=>f([...c,{question:"New Question?",answer:"Answer to the new question."}]),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add FAQ"})]})]}),e.jsx("div",{className:"space-y-4",children:c.map((le,S)=>e.jsxs("div",{className:"p-6 bg-gray-50 rounded-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["FAQ ",S+1]}),e.jsx("button",{onClick:()=>f(c.filter((C,J)=>J!==S)),className:"text-red-600 hover:bg-red-100 p-1 rounded",children:e.jsx(Es,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Question"}),e.jsx("input",{type:"text",value:le.question,onChange:C=>{const J=[...c];J[S].question=C.target.value,f(J)},className:"w-full p-3 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Answer"}),e.jsx("textarea",{value:le.answer,onChange:C=>{const J=[...c];J[S].answer=C.target.value,f(J)},rows:4,className:"w-full p-3 border border-gray-300 rounded-lg"})]})]},S))})]}),K=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section Title"}),e.jsx("input",{type:"text",value:p.title,onChange:le=>N({...p,title:le.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:p.description,onChange:le=>N({...p,description:le.target.value}),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Button Text"}),e.jsx("input",{type:"text",value:p.primaryButtonText,onChange:le=>N({...p,primaryButtonText:le.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secondary Button Text"}),e.jsx("input",{type:"text",value:p.secondaryButtonText,onChange:le=>N({...p,secondaryButtonText:le.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Features List"}),e.jsxs("div",{className:"space-y-3",children:[p.features.map((le,S)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Icon"}),e.jsx("select",{value:le.icon,onChange:C=>{const J=[...p.features];J[S].icon=C.target.value,N({...p,features:J})},className:"w-full p-2 border border-gray-300 rounded-lg",children:Object.keys(T).map(C=>e.jsx("option",{value:C,children:C},C))})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:le.text,onChange:C=>{const J=[...p.features];J[S].text=C.target.value,N({...p,features:J})},className:"flex-1 p-2 border border-gray-300 rounded-lg",placeholder:"Feature text"}),e.jsx("button",{onClick:()=>{const C=p.features.filter((J,ue)=>ue!==S);N({...p,features:C})},className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:e.jsx(Es,{size:16})})]})]},S)),e.jsxs("button",{onClick:()=>N({...p,features:[...p.features,{icon:"Shield",text:"New Feature"}]}),className:"flex items-center space-x-2 p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Add Feature"})]})]})]})]}),q=()=>{switch(P){case"hero":return M();case"coreservices":return A();case"additionalservices":return I();case"whychoose":return H();case"process":return h();case"testimonials":return L();case"pricing":return D();case"faq":return Y();case"cta":return K();default:return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"Select a section to edit"})}};return $?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Services Page Preview"}),e.jsxs("button",{onClick:()=>y(!1),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(ln,{size:16}),e.jsx("span",{children:"Edit Mode"})]})]})})}),e.jsxs("div",{className:"space-y-8",children:[e.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-purple-700 text-white py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center",children:[e.jsx("h2",{className:"text-4xl font-bold mb-6",children:s.title}),e.jsx("p",{className:"text-xl text-blue-100 mb-8",children:s.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsx("button",{className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-bold",children:s.primaryButtonText}),e.jsx("button",{className:"border-2 border-white text-white px-6 py-3 rounded-xl font-bold",children:s.secondaryButtonText})]})]})}),e.jsx("section",{className:"py-12 bg-gray-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Our Core Services"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Comprehensive real estate solutions"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:t.slice(0,4).map((le,S)=>{const C=T[le.icon]||at;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-4",children:[e.jsx("div",{className:`p-4 bg-${le.color}-500 rounded-2xl`,children:e.jsx(C,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:le.title}),e.jsx("p",{className:`text-${le.color}-600 font-semibold`,children:le.subtitle}),e.jsx("p",{className:"text-gray-700 mt-2",children:le.description})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:le.price}),e.jsx("div",{className:"text-xs text-gray-600",children:"Pricing"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:le.duration}),e.jsx("div",{className:"text-xs text-gray-600",children:"Duration"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:le.successRate}),e.jsx("div",{className:"text-xs text-gray-600",children:"Success Rate"})]})]})]},S)})})]})}),e.jsx("section",{className:"py-12 bg-white",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-8 text-center",children:"Client Testimonials"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:d.map((le,S)=>e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[e.jsx("div",{className:"flex items-center space-x-1 mb-4",children:Array.from({length:le.rating},(C,J)=>e.jsx(Xs,{size:16,className:"text-yellow-400 fill-current"},J))}),e.jsxs("p",{className:"text-gray-700 mb-6",children:['"',le.text,'"']}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:le.image,alt:le.name,className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:le.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[le.service," â€¢ ",le.location]})]})]})]},S))})]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("input",{type:"file",ref:k,accept:"image/*",style:{display:"none"}}),e.jsx("input",{type:"file",ref:R,accept:".json",onChange:B,style:{display:"none"}}),e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[e.jsx(at,{className:"text-blue-600 shrink-0",size:24}),e.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:"Services Page Management"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>{var le;return(le=R==null?void 0:R.current)==null?void 0:le.click()},className:"flex items-center justify-center space-x-2 px-3 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Import",children:[e.jsx(dt,{size:16}),e.jsx("span",{children:"Import"})]}),e.jsxs("button",{onClick:W,className:"flex items-center justify-center space-x-2 px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Export",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:()=>y(!0),className:"flex items-center justify-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Preview",children:[e.jsx(ks,{size:16}),e.jsx("span",{children:"Preview"})]}),e.jsxs("button",{onClick:V,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 w-full sm:w-auto whitespace-nowrap","aria-label":"Save Changes",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:"Save Changes"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Page Sections"}),e.jsx("nav",{className:"space-y-2",children:F.map(le=>{const S=le.icon;return e.jsxs("button",{onClick:()=>w(le.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${P===le.id?"bg-blue-100 text-blue-700 border-l-4 border-blue-600":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(S,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:le.name})]},le.id)})})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:((ne=F.find(le=>le.id===P))==null?void 0:ne.name)||"Content Management"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(Yt,{className:"text-gray-400",size:20})})]}),e.jsx("div",{className:"max-h-screen overflow-y-auto",children:q()})]})})]})})]})},r2=({isOpen:s,onClose:a,buyer:t})=>{var N,P,w,$;const[r,i]=l.useState({loanAmount:((N=t==null?void 0:t.financials)==null?void 0:N.loanAmount)||2e6,interestRate:8.5,loanTenure:20,downPayment:((P=t==null?void 0:t.financials)==null?void 0:P.downPayment)||5e5,propertyValue:((w=t==null?void 0:t.budget)==null?void 0:w.max)||25e5}),[n,o]=l.useState({emi:0,totalAmount:0,totalInterest:0,loanToValue:0,monthlyIncome:(($=t==null?void 0:t.financials)==null?void 0:$.monthlyIncome)||1e5,emiToIncomeRatio:0}),[m,g]=l.useState("emi");if(l.useEffect(()=>{b()},[r]),!s)return null;const b=()=>{const{loanAmount:y,interestRate:k,loanTenure:R}=r,F=k/1200,T=R*12,j=y*F*Math.pow(1+F,T)/(Math.pow(1+F,T)-1),E=j*T,V=E-y,W=y/r.propertyValue*100,B=j/n.monthlyIncome*100;o({emi:Math.round(j),totalAmount:Math.round(E),totalInterest:Math.round(V),loanToValue:Math.round(W),monthlyIncome:n.monthlyIncome,emiToIncomeRatio:Math.round(B)})},d=()=>{const y=n.monthlyIncome*.6,k=r.interestRate/1200,R=r.loanTenure*12,F=y*(Math.pow(1+k,R)-1)/(k*Math.pow(1+k,R));return Math.round(F)},v=y=>y>=1e7?`â‚¹${(y/1e7).toFixed(1)}Cr`:y>=1e5?`â‚¹${(y/1e5).toFixed(1)}L`:`â‚¹${y.toLocaleString("en-IN")}`,x=[{id:"emi",label:"EMI Calculator",icon:sr},{id:"affordability",label:"Affordability",icon:ka},{id:"comparison",label:"Loan Comparison",icon:Ot},{id:"prepayment",label:"Prepayment",icon:Rs}],u=[{name:"HDFC Bank",rate:8.5,processing:.5},{name:"ICICI Bank",rate:8.7,processing:.5},{name:"SBI",rate:8.4,processing:.25},{name:"Axis Bank",rate:8.8,processing:.5},{name:"Kotak Bank",rate:8.6,processing:.5}],c=(y,k)=>{i(R=>({...R,[y]:k}))},f=()=>{const y=[],{loanAmount:k,interestRate:R}=r,F=R/1200;let T=k;for(let j=1;j<=Math.min(12,r.loanTenure*12);j++){const E=T*F,V=n.emi-E;T-=V,y.push({month:j,emi:n.emi,principal:Math.round(V),interest:Math.round(E),balance:Math.round(T)})}return y};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[95vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(sr,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Financial Calculators"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Plan your home purchase with accurate calculations"})]})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl bg-white hover:bg-gray-50 transition-colors shadow-lg",children:e.jsx(ns,{size:20})})]})}),e.jsxs("div",{className:"flex h-[80vh]",children:[e.jsxs("div",{className:"w-80 border-r border-gray-200 bg-gray-50 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Calculators"}),e.jsx("div",{className:"space-y-2",children:x.map(y=>{const k=y.icon;return e.jsxs("button",{onClick:()=>g(y.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors text-left ${m===y.id?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(k,{size:16}),e.jsx("span",{children:y.label})]},y.id)})}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loan Amount (â‚¹)"}),e.jsx("input",{type:"number",value:r.loanAmount,onChange:y=>c("loanAmount",Number(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interest Rate (%)"}),e.jsx("input",{type:"number",value:r.interestRate,onChange:y=>c("interestRate",Number(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loan Tenure (Years)"}),e.jsx("select",{value:r.loanTenure,onChange:y=>c("loanTenure",Number(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[5,10,15,20,25,30].map(y=>e.jsxs("option",{value:y,children:[y," years"]},y))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Value (â‚¹)"}),e.jsx("input",{type:"number",value:r.propertyValue,onChange:y=>c("propertyValue",Number(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-auto",children:[m==="emi"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"EMI Calculator Results"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"Monthly EMI"}),e.jsx("p",{className:"text-2xl font-bold",children:v(n.emi)})]}),e.jsx(sr,{size:24,className:"text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"Total Amount"}),e.jsx("p",{className:"text-2xl font-bold",children:v(n.totalAmount)})]}),e.jsx(ka,{size:24,className:"text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm",children:"Total Interest"}),e.jsx("p",{className:"text-2xl font-bold",children:v(n.totalInterest)})]}),e.jsx(lo,{size:24,className:"text-orange-200"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"LTV Ratio"}),e.jsxs("p",{className:"text-2xl font-bold",children:[n.loanToValue,"%"]})]}),e.jsx(Oi,{size:24,className:"text-purple-200"})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"EMI Breakdown"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Oi,{className:"mx-auto text-gray-400 mb-2",size:48}),e.jsx("p",{className:"text-gray-500",children:"Principal vs Interest Chart"})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsx("span",{className:"text-blue-700",children:"Principal Amount"}),e.jsx("span",{className:"font-bold text-blue-900",children:v(r.loanAmount)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[e.jsx("span",{className:"text-orange-700",children:"Interest Amount"}),e.jsx("span",{className:"font-bold text-orange-900",children:v(n.totalInterest)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-green-700",children:"Down Payment"}),e.jsx("span",{className:"font-bold text-green-900",children:v(r.downPayment)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[e.jsx("span",{className:"text-purple-700",children:"EMI to Income Ratio"}),e.jsxs("span",{className:"font-bold text-purple-900",children:[n.emiToIncomeRatio,"%"]})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Amortization Schedule (First Year)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Month"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"EMI"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Principal"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Interest"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Balance"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:f().map(y=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:y.month}),e.jsx("td",{className:"px-4 py-2 font-medium",children:v(y.emi)}),e.jsx("td",{className:"px-4 py-2 text-blue-600",children:v(y.principal)}),e.jsx("td",{className:"px-4 py-2 text-orange-600",children:v(y.interest)}),e.jsx("td",{className:"px-4 py-2 text-gray-600",children:v(y.balance)})]},y.month))})]})})]})]}),m==="affordability"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Affordability Calculator"}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-4",children:"What You Can Afford"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:v(d())}),e.jsx("p",{className:"text-green-700",children:"Maximum Loan Amount"}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Based on 60% of your income"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:v(d()+r.downPayment)}),e.jsx("p",{className:"text-blue-700",children:"Maximum Property Value"}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Including down payment"})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Income Analysis"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Income (â‚¹)"}),e.jsx("input",{type:"number",value:n.monthlyIncome,onChange:y=>o({...n,monthlyIncome:Number(y.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:v(n.monthlyIncome*.6)}),e.jsx("div",{className:"text-sm text-blue-700",children:"Max EMI (60%)"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:v(n.monthlyIncome*.4)}),e.jsx("div",{className:"text-sm text-green-700",children:"Available for Expenses"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[n.emiToIncomeRatio,"%"]}),e.jsx("div",{className:"text-sm text-purple-700",children:"Current EMI Ratio"})]})]})]})]})]}),m==="comparison"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Bank Loan Comparison"}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Compare Loan Offers"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Bank"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Interest Rate"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Processing Fee"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Monthly EMI"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Total Interest"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map((y,k)=>{const R=p(y.rate),F=R*r.loanTenure*12-r.loanAmount;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:y.name}),e.jsxs("td",{className:"px-4 py-3 text-green-600 font-bold",children:[y.rate,"%"]}),e.jsxs("td",{className:"px-4 py-3",children:[y.processing,"%"]}),e.jsx("td",{className:"px-4 py-3 font-bold",children:v(R)}),e.jsx("td",{className:"px-4 py-3 text-orange-600",children:v(F)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Apply"})})]},k)})})]})})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"All calculations are approximate and for reference only"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Ys,{size:16}),e.jsx("span",{children:"Download Report"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(Wt,{size:16}),e.jsx("span",{children:"Share Results"})]}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})]})]})})]})});function p(y){const k=y/1200,R=r.loanTenure*12,F=r.loanAmount*k*Math.pow(1+k,R)/(Math.pow(1+k,R)-1);return Math.round(F)}},Rc=s=>{if(!s)return[];if(Array.isArray(s))return s.filter(Boolean).map(String);if(typeof s=="string"){try{const a=JSON.parse(s);if(Array.isArray(a))return a.filter(Boolean).map(String)}catch{}return s.split(",").map(a=>a.trim()).filter(Boolean)}return[]},l2=s=>{const a=[s==null?void 0:s.thumbnail_url,s==null?void 0:s.thumbnailUrl,s==null?void 0:s.coverImage,s==null?void 0:s.image,s==null?void 0:s.images,s==null?void 0:s.photo,s==null?void 0:s.photoUrl,s==null?void 0:s.photoUrls,s==null?void 0:s.photos];for(const t of a)if(t){if(typeof t=="string"){const r=Rc(t);if(r.length)return r[0];if(/^https?:\/\//i.test(t)||t.startsWith("/"))return t}else if(Array.isArray(t)){const r=t.filter(Boolean).map(String);if(r.length)return r[0]}}return null},n2=s=>{const a=((s==null?void 0:s.property_type_name)??(s==null?void 0:s.property_type)??(s==null?void 0:s.type)??"").toString().trim(),t=((s==null?void 0:s.unit_type_name)??(s==null?void 0:s.unit_type)??(s==null?void 0:s.unitType)??"").toString().trim(),r=((s==null?void 0:s.property_subtype_name)??(s==null?void 0:s.property_subtype)??(s==null?void 0:s.subtype)??"").toString().trim();return[a,t,r].filter(Boolean).join(" ")||"Property"},i2=s=>{const a=(s==null?void 0:s.location_name)??(s==null?void 0:s.location)??(s==null?void 0:s.area)??(s==null?void 0:s.neighbourhood)??(s==null?void 0:s.neighborhood)??"",t=(s==null?void 0:s.city_name)??(s==null?void 0:s.city)??"",r=(s==null?void 0:s.state)??"";return[a,t,r].filter(Boolean).slice(0,2).join(", ")||"Unknown location"},o2=(...s)=>{for(const a of s){const t=Number(a);if(Number.isFinite(t)&&t>0)return t}return null},c2=s=>o2(s==null?void 0:s.final_price,s==null?void 0:s.price,s==null?void 0:s.expected_price,s==null?void 0:s.budget),d2=s=>{const a=Number(s??0);return!Number.isFinite(a)||a<=0?"N/A":a>=1e7?`â‚¹${(a/1e7).toFixed(2)}Cr`:a>=1e5?`â‚¹${(a/1e5).toFixed(2)}L`:`â‚¹${a.toLocaleString("en-IN")}`},m2=s=>{const a=Number(s==null?void 0:s.carpet_area)||0,t=Number(s==null?void 0:s.builtup_area)||0,r=Number(s==null?void 0:s.super_builtup_area)||0;return a||t||r||Number(s==null?void 0:s.area)||void 0},x2=(s,a)=>!s||!a?"-":`â‚¹${Math.round(s/a).toLocaleString("en-IN")}`,u2=({tags:s})=>{if(!s||s.length===0)return null;const a=s.slice(0,2);return e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[a.map((t,r)=>{const i=Ea(t),n=typeof i.emoji=="string"?()=>e.jsx("span",{className:"text-xs mr-1 uppercase","aria-hidden":"true",children:i.emoji}):i.emoji;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-bold uppercase ${i.bg} ${i.text} ring-1 ${i.ring} transition-all duration-200`,children:[i.emoji&&(typeof i.emoji=="string"?e.jsx(n,{}):e.jsx(n,{size:10,className:"mr-1"})),t]},r)}),s.length>2&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:["+",s.length-2]})]})},g2=({buyer:s})=>{const[a,t]=l.useState([]),[r,i]=l.useState(!0);l.useEffect(()=>{if(!(s!=null&&s.id))return;(async()=>{try{i(!0);const d=await Hr.listByBuyer(s.id,{includeProperty:!0}),v=Array.isArray(d)?d:Array.isArray(d==null?void 0:d.data)?d.data:[],x=await Promise.all(v.map(async u=>{const c=u.property??{};let f=[];if(Array.isArray(c==null?void 0:c.tags)?f=c.tags.filter(Boolean).map(String):typeof(c==null?void 0:c.tags)=="string"&&(f=Rc(c.tags)),(!f||f.length===0)&&(c!=null&&c.id||u.property_id))try{const P=await Qt.getById((c==null?void 0:c.id)??u.property_id);f=Array.isArray(P==null?void 0:P.tags)?P.tags:typeof(P==null?void 0:P.tags)=="string"?Rc(P.tags):[]}catch(P){console.warn(`Could not fetch tags for property ${(c==null?void 0:c.id)??u.property_id}`,P)}const p=[];(c!=null&&c.rera_number||c!=null&&c.rera_approved||c!=null&&c.is_rera)&&p.push("verified"),(c!=null&&c.is_featured||c!=null&&c.featured)&&p.push("featured"),(c!=null&&c.under_construction||c!=null&&c.is_new_listing)&&p.push("new listing"),(c!=null&&c.is_resale||(c==null?void 0:c.sale_type)==="resale")&&p.push("resale");const N=Array.from(new Set([...f||[],...p])).filter(Boolean);return u.property={...u.property,tags:N},u}));t(x)}catch(d){console.error("âŒ ShortlistTab - Error loading saved properties:",d),Z.error("Failed to load saved properties")}finally{i(!1)}})()},[s==null?void 0:s.id]);const n=async b=>{try{await Hr.toggle(s.id,b,"unsave"),t(d=>d.filter(v=>v.property_id!==b)),Z.success("Removed from shortlist")}catch{Z.error("Failed to remove")}},o=b=>{window.open(`tel:${b}`,"_self")},m=(b,d)=>{const v=`Hi, I'm interested in your property: ${d}. Please share more details.`,x=encodeURIComponent(v);window.open(`https://wa.me/${b}?text=${x}`,"_blank","noopener,noreferrer")},g=b=>{var P;const d=b.property||b,v=typeof window<"u"&&((P=window.location)!=null&&P.origin)?window.location.origin:"https://investordeal.in",x=(d==null?void 0:d.slug)||(d==null?void 0:d.property_slug)||(d==null?void 0:d.id),u=`${v}/properties/${encodeURIComponent(String(x))}`,c="fltcnt",f="re_filter_token",p="re_filter_payload",N=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`flt_${Math.random().toString(36).slice(2)}_${Date.now()}`;try{const w=N(),$=(()=>{var T,j;const R=s||{},F=(R==null?void 0:R.requirements)||{};return{name:(R==null?void 0:R.name)||void 0,budgetMin:((T=R==null?void 0:R.budget)==null?void 0:T.min)??(R==null?void 0:R.budget_min)??void 0,budgetMax:((j=R==null?void 0:R.budget)==null?void 0:j.max)??(R==null?void 0:R.budget_max)??void 0,unitType:(F==null?void 0:F.unitType)??(F==null?void 0:F.unitTypes)??void 0,preferredLocations:(F==null?void 0:F.preferredLocations)??(F==null?void 0:F.preferredlocations)??void 0,city:(F==null?void 0:F.city)??(R==null?void 0:R.city)??void 0}})(),y={ts:Date.now(),source:"ShortlistTab",propertyId:(d==null?void 0:d.id)??null,buyer:$,from:{path:typeof window<"u"?window.location.pathname:void 0,query:typeof window<"u"?window.location.search:void 0}};if(typeof window<"u"){const R=`${p}:${w}`;localStorage.setItem(R,JSON.stringify(y)),localStorage.setItem(f,w)}const k=new URL(u,typeof window<"u"?window.location.origin:"https://investordeal.in");k.searchParams.set(c,w),window.open(k.toString(),"_blank","noopener,noreferrer")}catch(w){console.error("âŒ ShortlistTab - Error creating filter context:",w),window.open(u,"_blank","noopener,noreferrer")}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"My Shortlist"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[a.length," properties"]}),e.jsxs("button",{onClick:()=>Z.info("Share feature coming soon"),className:`flex items-center space-x-1 px-3 py-1.5 \r
             bg-gradient-to-r from-[#E6761D] to-[#CC6A1A] \r
             text-white text-xs rounded-lg \r
             hover:from-[#CC6A1A] hover:to-[#B85E15] \r
             transition-all duration-300 shadow-sm`,children:[e.jsx(Wt,{size:14}),e.jsx("span",{children:"Share Shortlist"})]})]})]}),r&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:Array.from({length:6}).map((b,d)=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden h-full flex flex-col animate-pulse",children:[e.jsx("div",{className:"h-48 bg-gray-200"}),e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("div",{className:"h-5 w-2/3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-1/3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-6 w-1/4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-8 w-full bg-gray-200 rounded"})]})]},d))}),!r&&a.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 items-stretch",children:a.map(b=>{var R;const d=b.property??{},v=l2(d),x=n2(d),u=i2(d),c=c2(d),f=m2(d),p=d==null?void 0:d.assigned_to_user,N=(p==null?void 0:p.phone)||(d==null?void 0:d.contact_number)||(d==null?void 0:d.phone)||(d==null?void 0:d.seller_phone)||"+911234567890",P=(p==null?void 0:p.name)||(d==null?void 0:d.seller_name)||(d==null?void 0:d.owner_name)||"Property Owner",w=Array.isArray(d==null?void 0:d.tags)?d.tags:[],$=typeof(d==null?void 0:d.rating)=="number"?d.rating:void 0,y=Number((d==null?void 0:d.total_views)??(d==null?void 0:d.public_views)??(d==null?void 0:d.views)??0)||void 0,k=Number(d==null?void 0:d.aiScore)||void 0;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden group h-full flex flex-col",children:[e.jsxs("div",{className:"relative",children:[v?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:v,alt:x,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform",onError:F=>{F.target.src="https://via.placeholder.com/400x300?text=No+Image"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("span",{className:"text-white text-2xl font-bold opacity-40 select-none",children:"ResaleExpert.in"})})]}):e.jsx("div",{className:"h-48 bg-gray-200 flex items-center justify-center",children:e.jsx(Is,{className:"text-gray-400",size:48})}),e.jsxs("div",{className:"absolute top-3 left-3 flex items-start flex-wrap gap-2 z-20",children:[e.jsx("div",{className:"max-w-[72vw] sm:max-w-none overflow-hidden",children:e.jsx(u2,{tags:w})}),k&&k>=90&&e.jsxs("span",{className:"flex-none whitespace-nowrap bg-purple-600 text-white px-2 py-1 rounded-full text-[10px] sm:text-xs font-bold leading-none flex items-center shadow-sm",children:[e.jsx(Mt,{size:12,className:"mr-1"}),"AI ",Math.round(k)]})]}),e.jsx("button",{onClick:()=>n(b.property_id),className:"absolute top-3 right-3 p-2 rounded-lg bg-white/90 text-red-600 hover:bg-red-50 shadow-sm",title:"Remove from shortlist",children:e.jsx(kl,{className:"fill-current",size:16})}),($||y)&&e.jsxs("div",{className:"absolute bottom-4 left-4 flex items-center gap-2",children:[$&&e.jsxs("div",{className:"bg-white/90 rounded-full px-2 py-1 flex items-center gap-1",children:[e.jsx(Xs,{className:"text-yellow-500",size:12}),e.jsx("span",{className:"text-xs font-semibold text-gray-900",children:$.toFixed(1)})]}),typeof y=="number"&&e.jsx("div",{className:"bg-white/90 rounded-full px-2 py-1",children:e.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[y," views"]})})]})]}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"pr-4",children:[e.jsx("div",{className:"text-lg font-bold text-[#0b3856] mb-1 group-hover:text-[#E6761D] transition-colors",children:x}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(Qs,{size:16,className:"mr-2"}),e.jsx("span",{className:"line-clamp-1",children:u})]})]}),(d==null?void 0:d.id)&&e.jsx("div",{className:"text-lg text-gray-500",children:((R=d.property_id)==null?void 0:R.toString().trim())||`REX${String(d.id).padStart(4,"0")}`})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:d2(c)}),e.jsxs("div",{className:"text-sm text-gray-500",children:[((d==null?void 0:d.unit_type_name)??(d==null?void 0:d.unit_type)??(d==null?void 0:d.unitType)??(d==null?void 0:d.property_type_name)??(d==null?void 0:d.property_type)??(d==null?void 0:d.type))||"-"," ","â€¢ ",f||"-"," sq ft"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Price per sq ft"}),e.jsx("div",{className:"font-semibold text-gray-900",children:x2(c??void 0,f)})]})]}),e.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:P}),e.jsx("div",{className:"text-xs text-gray-600",children:N}),(p==null?void 0:p.email)&&e.jsx("div",{className:"text-xs text-gray-500",children:p.email})]}),p&&e.jsx("div",{className:"text-right text-xs text-gray-500",children:"Executive"})]})}),e.jsxs("div",{className:"mt-auto flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g(b),className:"flex-1 bg-[#E6761D] text-white py-2 rounded-lg hover:bg-[#CC6A1A] transition-colors text-center font-semibold text-sm",children:"View Details"}),e.jsx("button",{onClick:()=>o(N),className:"p-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:`Call ${P}`,children:e.jsx(Cs,{size:16})}),e.jsx("button",{onClick:()=>m(N,x),className:"p-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",title:`WhatsApp ${P}`,children:e.jsx(Yn,{size:16})})]}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:["Saved on ",new Date(b.created_at).toLocaleDateString()]})]})]},b.id)})}),!r&&a.length===0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(kl,{className:"mx-auto text-gray-300 mb-3",size:48}),e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-1",children:"No Properties Shortlisted"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Start exploring properties and add them to your shortlist"}),e.jsx("button",{onClick:()=>Z.info("Redirect to Explore Page"),className:"px-4 py-2 bg-purple-600 text-white text-xs rounded-lg hover:bg-purple-700 transition-colors",children:"Explore Properties"})]})]})},Ql=s=>{if(!s)return new Date(NaN);const a=String(s).trim();if(a.endsWith("Z")){const r=new Date(a),i=5.5*60*60*1e3;return new Date(r.getTime()+i)}if(/[tT]|\+/.test(a))return new Date(a);const t=a.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{1,2}):(\d{2})(?::(\d{2}))?$/);if(t){const[,r,i,n,o,m,g="0"]=t;return new Date(Number(r),Number(i)-1,Number(n),Number(o),Number(m),Number(g))}return new Date(a)},h2=s=>{if(Number.isNaN(s.getTime()))return"Unknown time";const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()],r=s.getDate(),i=s.getFullYear();let n=s.getHours();const o=s.getMinutes(),m=n>=12?"PM":"AM";n=n%12||12;const g=o<10?`0${o}`:`${o}`;return`${t} ${r}, ${i}, ${n}:${g} ${m}`},p2=s=>{const a=Ql(s??"");if(Number.isNaN(a.getTime()))return"Unknown time";const t=Math.floor((Date.now()-a.getTime())/6e4);if(t<1)return"Just now";if(t<60)return`${t} min ago`;const r=Math.round(t/60);return r<24?`${r}h ago`:`${Math.round(r/24)}d ago`},b2=s=>{const a=String(s).trim().toLowerCase(),t=a.match(/^(\d{1,2}):(\d{2})\s*([ap]m)$/i);if(t){let n=Number(t[1]);const o=Number(t[2]),m=t[3].toLowerCase();return m==="pm"&&n<12&&(n+=12),m==="am"&&n===12&&(n=0),`${String(n).padStart(2,"0")}:${String(o).padStart(2,"0")}:00`}const r=a.match(/^(\d{1,2}):(\d{2})$/);if(r){const n=Math.min(23,Math.max(0,Number(r[1]))),o=Math.min(59,Math.max(0,Number(r[2])));return`${String(n).padStart(2,"0")}:${String(o).padStart(2,"0")}:00`}const i=new Date(a);return Number.isNaN(i.getTime())?"":`${String(i.getHours()).padStart(2,"0")}:${String(i.getMinutes()).padStart(2,"0")}:00`},Wl=(s,a)=>{if(!s)return"";const t=b2(a||"10:00");return`${s} ${t}`},ou=s=>{const a=Ql(s??"");return`${h2(a)} Â· ${p2(s??"")}`},f2=({buyer:s,onScheduleVisit:a})=>{const[t,r]=l.useState(!0),[i,n]=l.useState(null),[o,m]=l.useState([]),[g,b]=l.useState({}),[d,v]=l.useState({});l.useEffect(()=>{let f=!0;return(async()=>{r(!0),n(null);try{const p=await or.getAllVisits({buyer_id:s==null?void 0:s.id,limit:100,page:1}),P=(Array.isArray(p==null?void 0:p.data)?p.data:Array.isArray(p)?p:[]).map(w=>({id:w.id??w.visit_id??w._id??Math.random(),property:`${w.property_title??w.property??"Property"}`,address:w.address??w.meet_point??"",seller:w.seller_name??"",seller_phone:w.seller_phone??null,visit_datetime:w.visit_datetime??w.datetime??null,visit_date:w.visit_date??null,visit_time:w.visit_time??null,status:(w.status??"scheduled").toString(),rating:Number.isFinite(+w.rating)?+w.rating:0,feedback:w.feedback??null}));P.sort((w,$)=>{const y=Ql(w.visit_datetime||Wl(w.visit_date,w.visit_time)).getTime();return Ql($.visit_datetime||Wl($.visit_date,$.visit_time)).getTime()-y}),f&&m(P)}catch(p){f&&n((p==null?void 0:p.message)||"Failed to load visits")}finally{f&&r(!1)}})(),()=>{f=!1}},[s==null?void 0:s.id]);const x=f=>{const p=(f||"").toLowerCase(),N={scheduled:{bg:"bg-blue-100",text:"text-blue-700",label:"Scheduled",icon:"ðŸ“…"},completed:{bg:"bg-green-100",text:"text-green-700",label:"Completed",icon:"âœ…"},cancelled:{bg:"bg-red-100",text:"text-red-700",label:"Cancelled",icon:"âŒ"},rescheduled:{bg:"bg-orange-100",text:"text-orange-700",label:"Rescheduled",icon:"ðŸ”„"},done:{bg:"bg-green-100",text:"text-green-700",label:"Completed",icon:"âœ…"}},P=N[p]||N.scheduled;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${P.bg} ${P.text}`,children:[P.icon," ",P.label]})},u=l.useMemo(()=>{const f=o.length,p=o.filter(w=>["completed","done"].includes((w.status||"").toLowerCase())).length,N=o.filter(w=>(w.status||"").toLowerCase()==="scheduled").length,P=o.filter(w=>(w.rating??0)>=4).length;return{total:f,completed:p,scheduled:N,highRated:P}},[o]),c=async f=>{if(g[f]){const p={...g};delete p[f],b(p);return}v(p=>({...p,[f]:!0}));try{const p=await or.getRevisitsByVisit(f);console.log("[Revisits] raw response for visit",f,p);const P=(Array.isArray(p==null?void 0:p.data)?p.data:Array.isArray(p)?p:[]).map(w=>({id:w.id??w.revisit_id??Math.random(),revisit_datetime:w.revisit_datetime??w.datetime??null,revisit_date:w.revisit_date??null,revisit_time:w.revisit_time??w.time??null,status:w.status??"scheduled",remarks:w.remarks??w.feedback??null,rating:Number.isFinite(+w.rating)?+w.rating:null}));console.log("[Revisits] normalized list for visit",f,P),P.sort((w,$)=>{const y=Ql(w.revisit_datetime||Wl(w.revisit_date,w.revisit_time)).getTime(),k=Ql($.revisit_datetime||Wl($.revisit_date,$.revisit_time)).getTime();return y-k}),b(w=>({...w,[f]:P}))}catch(p){console.warn("[Revisits] fetch failed for visit",f,p)}finally{v(p=>{const N={...p};return delete N[f],N})}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900",children:"Site Visits"}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-1 px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Schedule Visit"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:u.total}),e.jsx("div",{className:"text-xs text-blue-700",children:"Total Visits"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:u.completed}),e.jsx("div",{className:"text-xs text-green-700",children:"Completed"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:u.scheduled}),e.jsx("div",{className:"text-xs text-orange-700",children:"Scheduled"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:u.highRated}),e.jsx("div",{className:"text-xs text-purple-700",children:"Highly Rated"})]})]}),e.jsx("div",{className:"space-y-3",children:t?e.jsx("div",{className:"text-xs text-gray-500",children:"Loading visitsâ€¦"}):i?e.jsx("div",{className:"text-xs text-red-600",children:i}):o.length===0?e.jsx("div",{className:"text-xs text-gray-500",children:"No visits yet."}):o.map(f=>{const p=f.visit_datetime||Wl(f.visit_date||void 0,f.visit_time||void 0);return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:f.property}),!!f.address&&e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600 mt-0.5 text-xs",children:[e.jsx(Qs,{size:12}),e.jsx("span",{children:f.address})]}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2 mt-1",children:[x(f.status),e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] px-2 py-0.5 rounded-full bg-gray-100 text-gray-700",children:[e.jsx(Ls,{size:11}),ou(p)]})]})]}),e.jsxs("div",{className:"text-right",children:[!!f.seller&&e.jsxs("div",{className:"text-xs text-gray-500 mb-0.5",children:["Seller: ",f.seller]}),(f.rating??0)>0&&e.jsx("div",{className:"flex items-center justify-end space-x-0.5",children:Array.from({length:5},(N,P)=>e.jsx(Xs,{size:12,className:P<(f.rating??0)?"text-yellow-400 fill-current":"text-gray-300"},P))})]})]}),f.feedback?e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("span",{className:"text-gray-500 text-xs",children:"Feedback:"}),e.jsx("p",{className:"text-gray-700 mt-0.5 text-xs",children:f.feedback})]}):null,e.jsxs("div",{className:"flex items-center flex-wrap gap-2 mt-3",children:[e.jsxs("button",{className:"flex items-center space-x-1 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(ks,{size:12}),e.jsx("span",{children:"View Property"})]}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-1 px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-xs",children:[e.jsx(Ts,{size:12}),e.jsx("span",{children:"Schedule Revisit"})]}),e.jsxs("a",{href:f.seller_phone?`tel:${String(f.seller_phone).replace(/\D/g,"")}`:"#",className:`flex items-center space-x-1 px-3 py-1.5 rounded-lg transition-colors text-xs ${f.seller_phone?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,onClick:N=>{f.seller_phone||N.preventDefault()},children:[e.jsx(tt,{size:12}),e.jsx("span",{children:"Contact Seller"})]}),e.jsxs("button",{onClick:()=>c(f.id),className:"ml-auto inline-flex items-center space-x-1 px-2 py-1 text-xs rounded border border-gray-300 hover:bg-gray-50",title:g[f.id]?"Hide revisits":"Show revisits",children:[g[f.id]?e.jsx(ea,{size:14}):e.jsx(pa,{size:14}),e.jsx("span",{children:g[f.id]?"Hide Revisits":"Show Revisits"})]})]}),g[f.id]&&e.jsx("div",{className:"mt-2 border border-gray-200 rounded-md p-2 bg-white",children:d[f.id]?e.jsx("div",{className:"text-[11px] text-gray-500",children:"Loading revisitsâ€¦"}):g[f.id].length===0?e.jsx("div",{className:"text-[11px] text-gray-500",children:"No revisits yet."}):e.jsx("ul",{className:"space-y-1",children:g[f.id].map(N=>{const P=N.revisit_datetime||Wl(N.revisit_date||void 0,N.revisit_time||void 0);return e.jsxs("li",{className:"text-[11px] text-gray-700 flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 text-gray-700",children:[e.jsx(Ls,{size:11}),ou(P)]}),e.jsx("span",{className:"px-1 rounded bg-gray-100 text-gray-700",children:N.status||"scheduled"}),N.rating!=null&&N.rating>0?e.jsx("span",{className:"inline-flex items-center gap-0.5 ml-1",children:Array.from({length:5},(w,$)=>e.jsx(Xs,{size:11,className:$<(N.rating??0)?"text-yellow-400 fill-current":"text-gray-300"},$))}):null,N.remarks?e.jsxs("span",{className:"text-gray-500",children:["â€” ",N.remarks]}):null]},N.id)})})})]},f.id)})})]})},y2=({buyer:s,onShowLoanApplication:a})=>{var i;const t=n=>n>=1e7?`â‚¹${(n/1e7).toFixed(1)}Cr`:n>=1e5?`â‚¹${(n/1e5).toFixed(1)}L`:`â‚¹${n.toLocaleString("en-IN")}`,r=[{bank:"HDFC Bank",rate:8.5,processing:.5,maxAmount:2e7,features:["Quick approval","Digital process"]},{bank:"ICICI Bank",rate:8.7,processing:.5,maxAmount:18e6,features:["Pre-approved","Online tracking"]},{bank:"SBI",rate:8.4,processing:.25,maxAmount:22e6,features:["Lowest rates","Government backing"]},{bank:"Axis Bank",rate:8.8,processing:.5,maxAmount:19e6,features:["Quick disbursal","Flexible EMI"]}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Loan Center"}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-2 px-3 py-1.5 bg-green-600 text-white text-xs rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(fs,{size:14}),e.jsx("span",{children:"Apply for Loan"})]})]}),((i=s.financials)==null?void 0:i.loanRequired)&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-3",children:"Your Loan Application"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Application ID:"}),e.jsx("div",{className:"font-medium",children:s.financials.applicationId||"Not Applied"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("div",{className:"font-medium",children:s.financials.loanStatus.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Bank:"}),e.jsx("div",{className:"font-medium",children:s.financials.bankPreference})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-3",children:"Available Loan Offers"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.map((n,o)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"font-semibold text-gray-900",children:n.bank}),e.jsxs("span",{className:"text-green-600 font-bold",children:[n.rate,"%"]})]}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Max Amount:"}),e.jsx("span",{className:"font-medium",children:t(n.maxAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Processing:"}),e.jsxs("span",{className:"font-medium",children:[n.processing,"%"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:n.features.map((m,g)=>e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-[10px]",children:m},g))}),e.jsx("button",{className:"bg-green-600 text-white px-3 py-1 text-sm rounded-md hover:bg-green-700 transition-colors",children:"Apply Now"})]},o))})]})]})},j2=({buyer:s,onShowEMICalculator:a})=>{const t=[{id:"emi",title:"EMI Calculator",description:"Calculate your monthly EMI based on loan amount, interest rate, and tenure",icon:sr,color:"blue",action:a},{id:"affordability",title:"Affordability Calculator",description:"Find out how much property you can afford based on your income",icon:ka,color:"green",action:()=>console.log("Affordability calculator")},{id:"stamp_duty",title:"Stamp Duty Calculator",description:"Calculate stamp duty and registration charges for your property",icon:ws,color:"purple",action:()=>console.log("Stamp duty calculator")},{id:"roi",title:"ROI Calculator",description:"Calculate return on investment for property purchases",icon:Rs,color:"orange",action:()=>console.log("ROI calculator")}];return e.jsxs("div",{className:"p-6 space-y-6 text-xs",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Financial Calculators"}),e.jsx("p",{className:"text-gray-600",children:"Make informed decisions with our financial tools"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(r=>{const i=r.icon;return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-2 bg-${r.color}-100 rounded-lg`,children:e.jsx(i,{className:`text-${r.color}-600`,size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1 text-sm",children:r.title}),e.jsx("p",{className:"text-gray-600 mb-3",children:r.description}),e.jsx("button",{onClick:r.action,className:`w-full bg-${r.color}-600 text-white py-1.5 px-3 text-xs rounded-md hover:bg-${r.color}-700 transition-colors`,children:"Open Calculator"})]})]})},r.id)})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-sm",children:"Quick EMI Preview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:"â‚¹45,678"}),e.jsx("div",{className:"text-blue-700 text-xs",children:"Estimated EMI"}),e.jsx("div",{className:"text-gray-500 text-[10px]",children:"For â‚¹1.8Cr @ 8.5%"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:"â‚¹7L"}),e.jsx("div",{className:"text-green-700 text-xs",children:"Down Payment"}),e.jsx("div",{className:"text-gray-500 text-[10px]",children:"30% of property value"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:"20 Years"}),e.jsx("div",{className:"text-purple-700 text-xs",children:"Loan Tenure"}),e.jsx("div",{className:"text-gray-500 text-[10px]",children:"Recommended"})]})]})]})]})},v2=({buyer:s})=>{var r;const a=((r=s==null?void 0:s.requirements)==null?void 0:r.preferredLocations)||(s==null?void 0:s.preferred_locations)||(s==null?void 0:s.preferredLocations)||["Mumbai","Pune","Bangalore"],t=Array.isArray(a)?a.slice(0,3):["Mumbai","Pune","Bangalore"];return e.jsxs("div",{className:"p-6 space-y-6 text-xs",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Market Insights"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:t.map((i,n)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:i}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Avg. Price/sq ft:"}),e.jsxs("span",{className:"font-bold text-green-600",children:["â‚¹",(15e3+n*2e3).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Price Trend:"}),e.jsxs("span",{className:"font-bold text-blue-600",children:["+",5+n,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Demand:"}),e.jsx("span",{className:"font-bold text-purple-600",children:"High"})]})]})]},n))}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Price Trends - Your Preferred Areas"}),e.jsx("div",{className:"h-56 bg-gray-50 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ot,{className:"mx-auto text-gray-400 mb-1",size:36}),e.jsx("p",{className:"text-gray-500",children:"Interactive price trend charts will be displayed here"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Investment Recommendations"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1.5",children:[e.jsx(Rs,{className:"text-green-600",size:14}),e.jsx("span",{className:"font-medium text-green-800",children:"Best Time to Buy"})]}),e.jsx("p",{className:"text-[11px] text-green-700",children:"Current market conditions are favorable for buyers in your budget range. Interest rates are stable and inventory levels provide good negotiation opportunities."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1.5",children:[e.jsx(Ct,{className:"text-blue-600",size:14}),e.jsx("span",{className:"font-medium text-blue-800",children:"Recommended Areas"})]}),e.jsxs("p",{className:"text-[11px] text-blue-700",children:["Based on your requirements, ",t[0]||"your preferred areas"," offer the best value proposition with strong appreciation potential and excellent connectivity."]})]})]})]})]})},N2=({buyer:s})=>{const a=[{id:"financial",label:"Financial Documents",count:4,color:"green"},{id:"identity",label:"Identity Proofs",count:2,color:"blue"},{id:"property",label:"Property Documents",count:3,color:"purple"},{id:"loan",label:"Loan Documents",count:2,color:"orange"}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"My Documents"}),e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(dt,{size:14}),e.jsx("span",{children:"Upload"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:a.map(t=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3 hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 text-xs",children:t.label}),e.jsxs("p",{className:"text-xs text-gray-600",children:[t.count," docs"]})]}),e.jsx("div",{className:`w-3 h-3 bg-${t.color}-500 rounded-full`})]})},t.id))}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3 text-xs",children:"Document Upload Guidelines"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-blue-800 mb-1",children:"Required for Loan Application:"}),e.jsxs("ul",{className:"space-y-0.5 text-blue-700",children:[e.jsx("li",{children:"â€¢ Last 3 months salary slips"}),e.jsx("li",{children:"â€¢ Bank statements (6 months)"}),e.jsx("li",{children:"â€¢ ITR for last 2 years"}),e.jsx("li",{children:"â€¢ PAN and Aadhar cards"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-blue-800 mb-1",children:"Property Documents:"}),e.jsxs("ul",{className:"space-y-0.5 text-blue-700",children:[e.jsx("li",{children:"â€¢ Property agreement copy"}),e.jsx("li",{children:"â€¢ Builder NOC"}),e.jsx("li",{children:"â€¢ Approved building plans"}),e.jsx("li",{children:"â€¢ Property tax receipts"})]})]})]})]})]})},w2=({buyer:s,onUpdateBuyer:a})=>{const[t,r]=l.useState(!1),[i,n]=l.useState(s),o=()=>{a(i),r(!1)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Profile Settings"}),e.jsxs("button",{onClick:()=>t?o():r(!0),className:"flex items-center space-x-1 px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-xs",children:[e.jsx(ft,{size:14}),e.jsx("span",{children:t?"Save":"Edit"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-xs",children:"Personal Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:i.name,onChange:m=>n({...i,name:m.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-xs",readOnly:!t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:i.phone,onChange:m=>n({...i,phone:m.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-xs",readOnly:!t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:i.email,onChange:m=>n({...i,email:m.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-xs",readOnly:!t})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-xs",children:"Property Requirements"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Budget Range"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"number",value:i.budget.min,onChange:m=>n({...i,budget:{...i.budget,min:Number(m.target.value)}}),className:"px-2 py-1 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-xs",placeholder:"Min",readOnly:!t}),e.jsx("input",{type:"number",value:i.budget.max,onChange:m=>n({...i,budget:{...i.budget,max:Number(m.target.value)}}),className:"px-2 py-1 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-xs",placeholder:"Max",readOnly:!t})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit Type"}),e.jsxs("select",{value:i.requirements.unitTypes,onChange:m=>n({...i,requirements:{...i.requirements,unitTypes:m.target.value}}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-xs",disabled:!t,children:[e.jsx("option",{value:"1BHK",children:"1BHK"}),e.jsx("option",{value:"2BHK",children:"2BHK"}),e.jsx("option",{value:"3BHK",children:"3BHK"}),e.jsx("option",{value:"4BHK",children:"4BHK"}),e.jsx("option",{value:"Villa",children:"Villa"}),e.jsx("option",{value:"Penthouse",children:"Penthouse"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Furnishing Preference"}),e.jsxs("select",{value:i.requirements.furnishing,onChange:m=>n({...i,requirements:{...i.requirements,furnishing:m.target.value}}),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 text-xs",disabled:!t,children:[e.jsx("option",{value:"Fully Furnished",children:"Fully Furnished"}),e.jsx("option",{value:"Semi Furnished",children:"Semi Furnished"}),e.jsx("option",{value:"Unfurnished",children:"Unfurnished"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3 text-xs",children:"Notification Preferences"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"New property matches"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Price drop alerts"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Visit reminders"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Market insights"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Promotional offers"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Loan updates"})]})]})]})]})]})},_2=({buyer:s,onBack:a,onUpdateBuyer:t})=>{const{logout:r}=Hs(),[i,n]=l.useState("dashboard"),[o,m]=l.useState(!1),[g,b]=l.useState(!1),[d,v]=l.useState(!1),[x,u]=l.useState(!1),[c,f]=l.useState(!1),[p,N]=l.useState(!1),P=l.useRef(null);return l.useEffect(()=>{const w=$=>$.key==="Escape"&&m(!1);return o&&window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[o]),l.useEffect(()=>{const w=$=>{o&&P.current&&!P.current.contains($.target)&&m(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[o]),e.jsxs("div",{className:"h-screen w-full bg-gray-50 flex overflow-hidden relative",children:[e.jsx("aside",{className:"hidden md:flex w-80 shrink-0 bg-white border-r flex-col h-full",children:e.jsx(cu,{buyer:s,activeTab:i,setActiveTab:n,logout:r,setShowPropertySuggestions:b,setShowEMICalculator:u})}),o&&e.jsxs("div",{className:"fixed inset-0 z-40 md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[1px] transition-opacity",onClick:()=>m(!1)}),e.jsxs("div",{ref:P,className:`absolute left-0 top-0 h-full w-72 max-w-[85vw] bg-white border-r shadow-xl transform transition-transform duration-300 ${o?"translate-x-0":"-translate-x-full"} relative`,children:[e.jsx("button",{className:"absolute top-2 right-2 p-2 rounded-md hover:bg-gray-100",onClick:()=>m(!1),"aria-label":"Close menu",children:e.jsx(ns,{size:18})}),e.jsx(cu,{buyer:s,activeTab:i,setActiveTab:w=>{n(w),m(!1)},logout:r,setShowPropertySuggestions:b,setShowEMICalculator:u})]})]}),e.jsxs("div",{className:"flex-1 min-w-0 h-full flex flex-col",children:[e.jsx("div",{className:"bg-[#0b3856] text-[#E6761D]",children:e.jsx("header",{className:"sticky top-0 z-30 bg-[#0b3856] hover:bg-[#0c3854] px-4 md:px-6 py-4 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>m(!0),className:"p-2 rounded-lg bg-white/90 text-[#0b3856] hover:bg-white transition-colors md:hidden","aria-label":"Open menu",children:e.jsx(so,{size:20})}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-white/90 text-gray-700 hover:bg-white transition-colors hidden sm:inline-flex","aria-label":"Back",children:e.jsx(ga,{size:20})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-base sm:text-lg md:text-xl font-bold text-[#E6761D] leading-tight truncate",children:["Welcome, ",s.salutation," ",s.name,"!"]}),e.jsx("p",{className:"text-xs text-white",children:"Your personalized property search dashboard"}),e.jsx("h2",{className:"flex gap-x-2 md:gap-x-3 gap-y-0.5 text-[11px] sm:text-xs md:text-sm text-[#E6761D] font-bold mt-1",children:"Buyer Account"})]})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-[#E6761D] text-white rounded-lg hover:bg-[#CC6A1A] transition-colors text-xs",title:"Open public property page",onClick:()=>window.open("http://investordeal.in/","_blank"),children:[e.jsx(Kn,{size:14}),e.jsx("span",{children:"Visit Website"})]}),e.jsx("div",{className:"text-xl font-bold text-[#E6761D]",children:s.leadScore||"-"}),e.jsx("div",{className:"text-xs text-white",children:"Profile Score"})]})]})})}),e.jsxs("main",{className:"flex-1 overflow-y-auto text-sm",children:[i==="dashboard"&&e.jsx(S2,{buyer:s}),i==="properties"&&e.jsx(k2,{buyer:s,onShowPropertySuggestions:()=>b(!0),onShowPropertyMatch:()=>f(!0)}),i==="shortlist"&&e.jsx(g2,{buyer:s}),i==="visits"&&e.jsx(f2,{buyer:s,onScheduleVisit:()=>N(!0)}),i==="loans"&&e.jsx(y2,{buyer:s,onShowLoanApplication:()=>v(!0)}),i==="calculators"&&e.jsx(j2,{buyer:s,onShowEMICalculator:()=>u(!0)}),i==="insights"&&e.jsx(v2,{buyer:s}),i==="documents"&&e.jsx(N2,{buyer:s}),i==="profile"&&e.jsx(w2,{buyer:s,onUpdateBuyer:t})]})]}),g&&e.jsx(Zu,{isOpen:g,onClose:()=>b(!1),buyer:s}),d&&e.jsx(Xu,{isOpen:d,onClose:()=>v(!1),buyer:s,onUpdateBuyer:t}),x&&e.jsx(r2,{isOpen:x,onClose:()=>u(!1),buyer:s}),c&&e.jsx(Ju,{isOpen:c,onClose:()=>f(!1),buyer:s}),p&&e.jsx(od,{isOpen:p,onClose:()=>N(!1),buyer:s,onSave:w=>{N(!1)}})]})},cu=({buyer:s,activeTab:a,setActiveTab:t,logout:r,setShowPropertySuggestions:i,setShowEMICalculator:n})=>{var N,P,w;const o=[{id:"dashboard",label:"Dashboard",icon:Ot},{id:"properties",label:"Property Search",icon:Is},{id:"shortlist",label:"My Shortlist",icon:kl},{id:"visits",label:"Site Visits",icon:Ts},{id:"loans",label:"Loan Center",icon:Ut},{id:"calculators",label:"Calculators",icon:sr},{id:"insights",label:"Market Insights",icon:Rs},{id:"documents",label:"My Documents",icon:ws},{id:"profile",label:"Profile",icon:Ms}],m=$=>{if(!$)return null;if(typeof $=="object")return $;if(typeof $=="string")try{return JSON.parse($)}catch{return null}return null},g=$=>{if($==null)return[];if(Array.isArray($))return $.filter(Boolean).map(String);if(typeof $=="number")return[String($)];if(typeof $=="string"){const y=m($);return Array.isArray(y)?y.filter(Boolean).map(String):$.split(",").map(k=>k.trim()).filter(Boolean)}return[]},b=$=>{const y=Number($??0)||0;return y>=1e7?`â‚¹${(y/1e7).toFixed(1)}Cr`:y>=1e5?`â‚¹${(y/1e5).toFixed(1)}L`:`â‚¹${y.toLocaleString("en-IN")}`},d=typeof(s==null?void 0:s.requirements)=="string"?m(s.requirements):(s==null?void 0:s.requirements)||{},v=(d==null?void 0:d.unitTypes)??(d==null?void 0:d.unit_types)??(d==null?void 0:d.preferred_units)??(d==null?void 0:d.preferredUnitTypes)??(d==null?void 0:d.unitType)??(d==null?void 0:d.unit_type)??(d==null?void 0:d.unit)??(d==null?void 0:d.bhk)??(d==null?void 0:d.bedrooms)??null;let x=g(v);x.length&&x.every($=>/^\d+(\s*bhk)?$/i.test($))&&(x=x.map($=>/\b\b/i.test($)?$.replace(/\s+/g," ").toUpperCase():`${$}`));const u=((N=s==null?void 0:s.budget)==null?void 0:N.min)??(s==null?void 0:s.budget_min)??(s==null?void 0:s.budgetMin)??(Array.isArray(s==null?void 0:s.budget)?s.budget[0]:void 0),c=((P=s==null?void 0:s.budget)==null?void 0:P.max)??(s==null?void 0:s.budget_max)??(s==null?void 0:s.budgetMax)??(Array.isArray(s==null?void 0:s.budget)?s.budget[1]:void 0),f=Number(u??0),p=Number(c??0);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 shrink-0",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#E6761D] to-[#CC6A1A] rounded-full flex items-center justify-center text-white font-bold text-lg shadow-md",children:(w=(s==null?void 0:s.name)||"U")==null?void 0:w.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-gray-900",children:(s!=null&&s.salutation?s.salutation+" ":"")+((s==null?void 0:s.name)||"Unknown")}),e.jsx("div",{className:"text-xs text-gray-600",children:[s==null?void 0:s.city,s==null?void 0:s.state].filter(Boolean).join(", ")||"â€”"})]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Budget:"}),e.jsx("span",{className:"font-medium text-green-600",children:f||p?`${b(f)} - ${b(p)}`:"â€”"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Preferred Units"}),e.jsx("span",{className:"font-medium",children:x.length?x.join(", "):"â€”"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Lead Score:"}),e.jsxs("span",{className:"font-medium text-purple-600",children:[((s==null?void 0:s.leadScore)??0).toString(),"/100"]})]})]})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto px-4 py-3",children:o.map($=>{const y=$.icon;return e.jsxs("button",{onClick:()=>t($.id),className:`w-full flex items-center space-x-3 px-3 py-2.5 rounded-lg transition-colors text-left mb-1 text-sm ${a===$.id?"bg-purple-50 text-purple-700 border border-purple-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(y,{size:16}),e.jsx("span",{className:"font-medium",children:$.label})]},$.id)})}),e.jsx("div",{className:"p-4 border-t border-gray-200 shrink-0",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("button",{onClick:()=>i(!0),className:"w-full flex items-center space-x-2 px-3 py-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all",children:[e.jsx(Mt,{size:14}),e.jsx("span",{children:"AI Property Search"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"w-full flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(sr,{size:14}),e.jsx("span",{children:"EMI Calculator"})]}),e.jsxs("button",{onClick:async()=>{await r(),window.location.href="/login"},className:"w-full flex items-center gap-2 px-2 py-1.5 text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:[e.jsx(eo,{size:15}),e.jsx("span",{className:"text-sm",children:"Sign Out"})]})]})})]})},S2=({buyer:s})=>{var v,x,u,c;const[a,t]=l.useState(0),[r,i]=l.useState(!0),n=l.useMemo(()=>{var f;return((f=s==null?void 0:s.matchedProperties)==null?void 0:f.filter(p=>(p==null?void 0:p.status)==="shortlisted").length)||0},[s==null?void 0:s.matchedProperties]),o=l.useMemo(()=>Number((s==null?void 0:s.id)??(s==null?void 0:s.buyer_id)??0),[s==null?void 0:s.id,s==null?void 0:s.buyer_id]);l.useEffect(()=>{let f=!1;return(async()=>{if(!o){t(n),i(!1);return}try{i(!0);const p=await Hr.countByBuyer(o);f||t((p==null?void 0:p.count)??n)}catch{f||t(n)}finally{f||i(!1)}})(),()=>{f=!0}},[o,n]);const m=f=>f>=1e7?`â‚¹${(f/1e7).toFixed(1)}Cr`:f>=1e5?`â‚¹${(f/1e5).toFixed(1)}L`:`â‚¹${f==null?void 0:f.toLocaleString("en-IN")}`,g={blue:"bg-blue-100",red:"bg-red-100",green:"bg-green-100",purple:"bg-purple-100"},b={blue:"text-blue-600",red:"text-red-600",green:"text-green-600",purple:"text-purple-600"},d=[{label:"Properties Viewed",value:(s==null?void 0:s.visits)||0,icon:ks,color:"blue"},{label:"Shortlisted",value:r?"â€”":a,icon:kl,color:"red"},{label:"Visits Scheduled",value:((v=s==null?void 0:s.followups)==null?void 0:v.filter(f=>(f==null?void 0:f.type)==="visit").length)||0,icon:Ts,color:"green"},{label:"Documents",value:((x=s==null?void 0:s.documents)==null?void 0:x.length)||0,icon:ws,color:"purple"}];return e.jsx("div",{className:"",children:e.jsxs("div",{className:"px-4 md:px-6 py-4 z-30 top-0 sticky",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:d.map((f,p)=>{const N=f.icon;return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:f.label}),e.jsx("p",{className:"text-lg font-bold text-gray-900 mt-0.5",children:f.value})]}),e.jsx("div",{className:`p-2 rounded-lg ${g[f.color]}`,children:e.jsx(N,{className:`${b[f.color]}`,size:18})})]})},p)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Property Search"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{className:"w-full text-xs bg-gradient-to-r from-purple-500 to-pink-600 text-white py-1.5 px-3 rounded-lg hover:from-purple-600 hover:to-pink-700 transition-all",children:"AI Property Suggestions"}),e.jsx("button",{className:"w-full text-xs bg-blue-600 text-white py-1.5 px-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Browse All Properties"}),e.jsx("button",{className:"w-full text-xs bg-green-600 text-white py-1.5 px-3 rounded-lg hover:bg-green-700 transition-colors",children:"Schedule Site Visit"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Financial Tools"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{className:"w-full text-xs bg-orange-600 text-white py-1.5 px-3 rounded-lg hover:bg-orange-700 transition-colors",children:"EMI Calculator"}),e.jsx("button",{className:"w-full text-xs bg-indigo-600 text-white py-1.5 px-3 rounded-lg hover:bg-indigo-700 transition-colors",children:"Loan Application"}),e.jsx("button",{className:"w-full text-xs bg-teal-600 text-white py-1.5 px-3 rounded-lg hover:bg-teal-700 transition-colors",children:"Affordability Calculator"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Market Analysis"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{className:"w-full text-xs bg-cyan-600 text-white py-1.5 px-3 rounded-lg hover:bg-cyan-700 transition-colors",children:"Price Trends"}),e.jsx("button",{className:"w-full text-xs bg-pink-600 text-white py-1.5 px-3 rounded-lg hover:bg-pink-700 transition-colors",children:"Area Analysis"}),e.jsx("button",{className:"w-full text-xs bg-violet-600 text-white py-1.5 px-3 rounded-lg hover:bg-violet-700 transition-colors",children:"Investment Insights"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 mt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Recent Activity"}),((u=s==null?void 0:s.activities)==null?void 0:u.length)>0?e.jsx("div",{className:"space-y-2",children:s.activities.slice(0,5).map(f=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(jt,{className:"text-blue-600",size:14})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900",children:f.description}),e.jsxs("div",{className:"text-[10px] text-gray-600",children:[f.date," â€¢ ",f.time]})]})]},f.id))}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(jt,{className:"mx-auto text-gray-300 mb-3",size:36}),e.jsx("p",{className:"text-xs text-gray-500",children:"No recent activities"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Recommended for You"}),e.jsx("button",{className:"text-xs text-purple-600 hover:text-purple-800 font-medium",children:"View All"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(c=s==null?void 0:s.matchedProperties)==null?void 0:c.slice(0,2).map(f=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-1.5",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-900",children:f.title}),e.jsxs("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-[10px] font-medium",children:[f.matchScore,"% Match"]})]}),e.jsx("p",{className:"text-[11px] text-gray-600 mb-1.5",children:f.address}),e.jsx("div",{className:"text-sm font-bold text-green-600 mb-2",children:m(f.price)}),e.jsxs("div",{className:"flex space-x-1.5",children:[e.jsx("button",{className:"flex-1 text-xs bg-blue-600 text-white py-1 px-2 rounded hover:bg-blue-700 transition-colors",children:"View Details"}),e.jsx("button",{className:"flex-1 text-xs bg-green-600 text-white py-1 px-2 rounded hover:bg-green-700 transition-colors",children:"Schedule Visit"})]})]},f.id))})]})]})})},k2=({buyer:s,onShowPropertySuggestions:a,onShowPropertyMatch:t,onVisitClick:r})=>{var Ce;const i=(_,ae)=>{var ms,cs,gs,Ne,Ze;let ke=0;const Me=100,Ye=Number((_==null?void 0:_.price)||(_==null?void 0:_.final_price)||0),ie=Number(((ms=ae==null?void 0:ae.budget)==null?void 0:ms.min)||(ae==null?void 0:ae.budget_min)||0),we=Number(((cs=ae==null?void 0:ae.budget)==null?void 0:cs.max)||(ae==null?void 0:ae.budget_max)||0);ie>0&&we>0&&(Ye>=ie&&Ye<=we?ke+=30:Ye<=we*1.2?ke+=15:Ye<=we*1.5&&(ke+=10));const Be=((gs=ae==null?void 0:ae.requirements)==null?void 0:gs.preferredLocations)||(ae==null?void 0:ae.preferred_locations)||[],Ve=(_==null?void 0:_.location_name)||(_==null?void 0:_.location)||(_==null?void 0:_.area)||"";Array.isArray(Be)&&Be.length>0?Be.some(ls=>Ve.toLowerCase().includes(ls.toLowerCase()))&&(ke+=25):ae!=null&&ae.city&&Ve.toLowerCase().includes(ae.city.toLowerCase())&&(ke+=15);const Je=((Ne=ae==null?void 0:ae.requirements)==null?void 0:Ne.unitTypes)||(ae==null?void 0:ae.preferred_units)||[],Ue=(_==null?void 0:_.unit_type_name)||(_==null?void 0:_.unit_type)||"";Array.isArray(Je)&&Je.length>0&&Je.some(ls=>Ue.toLowerCase().includes(ls.toLowerCase()))&&(ke+=20);const Oe=((Ze=ae==null?void 0:ae.requirements)==null?void 0:Ze.propertyType)||(ae==null?void 0:ae.preferred_property_type)||"",rs=(_==null?void 0:_.property_type_name)||(_==null?void 0:_.property_type)||"";return Oe&&rs.toLowerCase().includes(Oe.toLowerCase())&&(ke+=15),(_!=null&&_.is_featured||_!=null&&_.is_rera||_!=null&&_.rera_number)&&(ke+=10),Math.min(ke,Me)},n=_=>{const ae=(_==null?void 0:_.property_type_name)||(_==null?void 0:_.property_type)||"",ke=(_==null?void 0:_.unit_type_name)||(_==null?void 0:_.unit_type)||"",Me=(_==null?void 0:_.property_subtype_name)||(_==null?void 0:_.property_subtype)||"",Ye=[ae,ke,Me].filter(Boolean);return Ye.length>0?Ye.join(" â€¢ "):"Property Listing"},o=_=>_!=null&&_.possession_status?_.possession_status:_!=null&&_.possession_date?`Ready by ${_.possession_date}`:_!=null&&_.under_construction?"Under Construction":_!=null&&_.ready_to_move?"Ready to Move":"Immediate",m=_=>_!=null&&_.floor?`${_.floor}`:_!=null&&_.floor_number?`${_.floor_number}`:_!=null&&_.total_floors&&(_!=null&&_.floor_range)?`${_.floor_range} of ${_.total_floors}`:"Info not available",{properties:g,loadingProps:b,propsError:d,fetchProperties:v,searchProperties:x,utils:u}=cd({autoLog:!0}),{norm:c,toArr:f,hasAny:p,formatCurrency:N,getAvailabilityBadgeClass:P,unitTypeFrom:w,locTokensFrom:$,propTypeFrom:y,addressFrom:k,priceFrom:R,priceRangeFrom:F,sizeFrom:T,facingFrom:j,parkingFrom:E,photoFrom:V,computeReasons:W,isWithinBuyerBudget:B,makeItem:M}=u,A=typeof window<"u"&&((Ce=window.location)!=null&&Ce.origin)?window.location.origin:"https://investordeal.in",L="data:image/svg+xml;utf8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="320" height="200" viewBox="0 0 320 200" role="img" aria-label="No image">
         <rect width="320" height="200" fill="#f3f4f6"/>
         <g fill="#9ca3af" font-family="Arial,Helvetica,sans-serif" font-size="14">
           <text x="160" y="102" text-anchor="middle">No Image</text>
         </g>
       </svg>`),D=_=>{if(!_)return null;const ae=String(_).trim();return ae?/^https?:\/\//i.test(ae)?ae:ae.startsWith("//")?`https:${ae}`:ae.startsWith("/")?`${A}${ae}`:`${A}/${ae.replace(/^\/+/,"")}`:null},I=_=>{if(!_)return[];if(Array.isArray(_))return _.filter(Boolean).map(String);if(typeof _=="string"){try{const ae=JSON.parse(_);if(Array.isArray(ae))return ae.filter(Boolean).map(String)}catch{}return _.split(/[,\s]+/).map(ae=>ae.trim()).filter(Boolean)}return[]},H=_=>{const ae=[_==null?void 0:_.thumbnail_url,_==null?void 0:_.thumbnailUrl,_==null?void 0:_.coverImage,_==null?void 0:_.image,_==null?void 0:_.images,_==null?void 0:_.photo,_==null?void 0:_.photoUrl,_==null?void 0:_.photoUrls,_==null?void 0:_.photos,_==null?void 0:_.primary_image,_==null?void 0:_.media];for(const ke of ae)if(ke){if(typeof ke=="string"){const Me=I(ke);return Me.length?D(Me[0]):D(ke)}if(Array.isArray(ke)&&ke.length){const Me=String(ke[0]);if(Me)return D(Me)}}return null},h=_=>{const ae=V(_);if(ae){const ie=D(ae);if(ie)return ie}const ke=(_==null?void 0:_._raw)??_,Me=H(ke);return Me||(()=>{try{if(ke!=null&&ke.media&&typeof ke.media=="object"){const ie=Array.isArray(ke.media)?ke.media:Object.values(ke.media),we=ie==null?void 0:ie[0];if(typeof we=="string")return D(we);if(we!=null&&we.url)return D(we.url);if(we!=null&&we.src)return D(we.src)}}catch{}return null})()||null},Y=({src:_,alt:ae})=>{const[ke,Me]=l.useState(_||L);return l.useEffect(()=>Me(_||L),[_]),e.jsx("img",{src:ke,alt:ae||"Property",loading:"lazy",referrerPolicy:"no-referrer",className:"w-full h-full object-cover",onError:()=>Me(L)})},K={location:"",minPrice:null,maxPrice:null,propertyType:"",unitTypes:[],sort:"newest"},[q,ne]=l.useState(K),[le,S]=l.useState(K),[C,J]=l.useState(!1),[ue,Q]=l.useState(new Set),[he,se]=l.useState(!1),[ge,ee]=l.useState(!1),de=l.useRef(null),[U,X]=l.useState(!1),[re,fe]=l.useState(null);l.useEffect(()=>{v()},[]);const G=_=>{if(!_)return!1;const ae=_._raw||_;return[ae==null?void 0:ae.is_public,ae==null?void 0:ae.isPublic,ae==null?void 0:ae.public,ae==null?void 0:ae.is_public_listing,ae==null?void 0:ae.public_listing,ae==null?void 0:ae.visible_to_buyers,ae==null?void 0:ae.buyer_visible,_==null?void 0:_.is_public,_==null?void 0:_.isPublic,_==null?void 0:_.public,_==null?void 0:_.is_public_listing,_==null?void 0:_.public_listing,_==null?void 0:_.visible_to_buyers,_==null?void 0:_.buyer_visible].some(Me=>Me===!0||Me===1||Me==="1"||Me==="true"||Me==="yes")},me=l.useMemo(()=>Array.isArray(g)?g.map(_=>M(_,s)):[],[g,s,M]),oe=l.useMemo(()=>me.filter(G),[me]),Fe=async()=>{const _={location:q.location||void 0,minPrice:q.minPrice!==null&&q.minPrice!==void 0?q.minPrice:void 0,maxPrice:q.maxPrice!==null&&q.maxPrice!==void 0?q.maxPrice:void 0,sort:q.sort,propertyType:q.propertyType||void 0,unitTypes:q.unitTypes.length?q.unitTypes:void 0,is_public:1};await x(_),S(q),ee(!0),se(!0)},$e=async()=>{ne(K),S(K),await v(),ee(!1)},Le="fltcnt",je="re_filter_token",_e="re_filter_payload",ve=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`flt_${Math.random().toString(36).slice(2)}_${Date.now()}`,Pe=(_,ae)=>{var ke;try{const Me=ve(),Ye=(()=>{var Je,Ue;const Be=s||{},Ve=(Be==null?void 0:Be.requirements)||{};return{name:(Be==null?void 0:Be.name)||void 0,budgetMin:((Je=Be==null?void 0:Be.budget)==null?void 0:Je.min)??(Be==null?void 0:Be.budget_min)??void 0,budgetMax:((Ue=Be==null?void 0:Be.budget)==null?void 0:Ue.max)??(Be==null?void 0:Be.budget_max)??void 0,unitType:(Ve==null?void 0:Ve.unitType)??(Ve==null?void 0:Ve.unitTypes)??void 0,preferredLocations:(Ve==null?void 0:Ve.preferredLocations)??(Ve==null?void 0:Ve.preferredlocations)??void 0,city:(Ve==null?void 0:Ve.city)??(Be==null?void 0:Be.city)??void 0}})(),ie={ts:Date.now(),source:"PropertySearchTab",propertyId:(ae==null?void 0:ae.id)??((ke=ae==null?void 0:ae._raw)==null?void 0:ke.id)??null,respectBuyerBudget:C,appliedFilters:le,buyer:Ye,from:{path:typeof window<"u"?window.location.pathname:void 0,query:typeof window<"u"?window.location.search:void 0}};if(typeof window<"u"){const Be=`${_e}:${Me}`;localStorage.setItem(Be,JSON.stringify(ie)),localStorage.setItem(je,Me)}const we=new URL(_,A);return we.searchParams.set(Le,Me),{token:Me,urlWithToken:we.toString()}}catch{return{token:void 0,urlWithToken:_}}},We=_=>{const ae=(_==null?void 0:_.external_url)||(_==null?void 0:_.public_url)||(_==null?void 0:_.website)||(_==null?void 0:_.url)||null;if(typeof ae=="string"&&ae.trim()){const Ye=ae.trim();return/^https?:\/\//i.test(Ye)?Ye:Ye.startsWith("//")?`https:${Ye}`:Ye.startsWith("/")?`${A}${Ye}`:`${A}/${Ye.replace(/^\/+/,"")}`}const ke=(_==null?void 0:_.slug)||(_==null?void 0:_.property_slug)||(_==null?void 0:_.public_slug)||(_==null?void 0:_.seo_slug),Me=(_==null?void 0:_.id)||(_==null?void 0:_.property_id)||(_==null?void 0:_._id);return ke?`${A}/properties/${encodeURIComponent(String(ke).replace(/^\/+/,""))}`:Me?`${A}/properties/${encodeURIComponent(String(Me))}`:`${A}/properties`},pe=_=>{const ae=_._raw||_,ke=[];if(Array.isArray(ae==null?void 0:ae.tags))ke.push(...ae.tags.filter(Boolean).map(String));else if(typeof(ae==null?void 0:ae.tags)=="string"){const Me=I(ae.tags);ke.push(...Me)}if(Array.isArray(ae==null?void 0:ae.amenities)){const Me=ae.amenities.slice(0,3);ke.push(...Me.filter(Boolean).map(String))}return ae!=null&&ae.is_featured&&ke.push("Featured"),(ae!=null&&ae.is_rera||ae!=null&&ae.rera_number)&&ke.push("RERA Approved"),ae!=null&&ae.ready_to_move&&ke.push("Ready to Move"),ae!=null&&ae.under_construction&&ke.push("Under Construction"),ae!=null&&ae.is_resale&&ke.push("Resale"),Array.from(new Set(ke)).slice(0,5)},O=l.useMemo(()=>{const _=c(le.location),ae=Number(le.minPrice||0),ke=Number(le.maxPrice||0),Me=c(le.propertyType),Ye=f(le.unitTypes).map(c),ie=Be=>{if(_&&!p($(Be),[_]))return!1;const{min:Ve,max:Je}=F(Be),Ue=R(Be),Oe=!!Ve&&!!Je&&Je>=Ve;if(ae||ke){if(Oe){const rs=ae||Number.NEGATIVE_INFINITY,ms=ke||Number.POSITIVE_INFINITY;if(Math.max(Ve??-1/0,rs)>Math.min(Je??1/0,ms))return!1}else if(Ue&&(ae&&Ue<ae||ke&&Ue>ke))return!1}if(Me&&!y(Be).includes(Me))return!1;if(Ye.length){const rs=c(w(Be));if(!rs||!Ye.includes(rs))return!1}return!0};let we=oe.filter(ie);return C&&(we=we.filter(Be=>B(Be,s))),we.map(Be=>{const Ve=Be._raw??Be,Je=We(Ve);return{id:String((Ve==null?void 0:Ve.id)??(Ve==null?void 0:Ve.property_id)??(Ve==null?void 0:Ve._id)??Math.random()),title:n(Ve),address:k(Be),price:R(Be),size:T(Be),floorLine:m(Ve),facing:j(Be),parking:E(Be),possession:o(Ve),amenities:(Be==null?void 0:Be.amenities)||[],statusText:(Be==null?void 0:Be.status)||"Available",matchScore:i(Ve,s),photo:h(Be),_raw:Ve,reasons:W(Be,s),publicUrl:Je,tags:pe(Be)}})},[oe,le,C,s,c,f,p,$,F,R,y,w,B,k,T,j,E,W]),Ie=_=>_>=90?"text-green-700 bg-green-100":_>=80?"text-blue-700 bg-blue-100":_>=70?"text-orange-700 bg-orange-100":"text-red-700 bg-red-100",ze=({status:_})=>{const ae=P(_);return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-medium ${ae}`,children:_||"Available"})},xe=async _=>{var ke;const ae=Number(((ke=_._raw)==null?void 0:ke.id)||_.id);if(!ae){Z.error("Invalid property ID");return}try{ue.has(_.id)?(await Hr.toggle(s.id,ae,"unsave"),Q(Me=>{const Ye=new Set(Me);return Ye.delete(_.id),Ye}),Z.success("Removed from shortlist")):(await Hr.toggle(s.id,ae,"save"),Q(Me=>new Set(Me.add(_.id))),Z.success("Added to shortlist"))}catch(Me){console.error("Shortlist toggle error:",Me),Z.error("Failed to update shortlist")}};l.useEffect(()=>{(async()=>{if(s!=null&&s.id)try{const ae=await Hr.listByBuyer(s.id,{includeProperty:!0}),ke=(Array.isArray(ae)?ae:[]).map(Me=>{var Ye;return String(Me.property_id||((Ye=Me.property)==null?void 0:Ye.id))});Q(new Set(ke))}catch(ae){console.error("Failed to load shortlisted properties:",ae)}})()},[s==null?void 0:s.id]);const Ee=_=>{const ae=_.publicUrl||We(_._raw),{token:ke,urlWithToken:Me}=Pe(ae,_);fe({url:Me,title:_.title,description:_.address||"",image:_.photo,trackingToken:ke}),X(!0)},Ke=_=>{const ae=_.publicUrl||We(_._raw),{urlWithToken:ke}=Pe(ae,_);ke&&window.open(ke,"_blank","noopener,noreferrer")},Xe=_=>{const ae=_.publicUrl||We(_._raw),{urlWithToken:ke}=Pe(ae,_);ke&&window.open(ke,"_blank","noopener,noreferrer")},ye=({propertyId:_,tags:ae})=>{const[ke,Me]=l.useState([]),[Ye,ie]=l.useState(!1);if(l.useEffect(()=>{(async()=>{if(!_){Me(ae||[]);return}try{ie(!0);const Ve=await Qt.getById(_);let Je=[];Ve&&typeof Ve=="object"&&(Array.isArray(Ve.tags)?Je=Ve.tags.filter(Ue=>Ue!=null).map(String):typeof Ve.tags=="string"?Je=Ve.tags.split(",").map(Ue=>Ue.trim()).filter(Boolean):Array.isArray(Ve)&&(Je=Ve.filter(Ue=>Ue!=null).map(String))),Me(Je.length>0?Je:ae||[])}catch(Ve){console.warn(`Could not fetch tags for property ${_}`,Ve),Me(ae||[])}finally{ie(!1)}})()},[_,ae]),Ye)return e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Array.from({length:2}).map((Be,Ve)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-[10px] font-medium bg-gray-200 text-gray-200 animate-pulse",children:"Loading..."},Ve))});if(!ke||ke.length===0)return null;const we=ke.slice(0,3);return e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[we.map((Be,Ve)=>{const Je=Ea(Be),Ue=typeof Je.emoji=="string"?()=>e.jsx("span",{className:"text-xs mr-1","aria-hidden":"true",children:Je.emoji}):Je.emoji;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-[10px] font-medium ${Je.bg} ${Je.text} ${Je.ring}`,children:[Je.emoji&&(typeof Je.emoji=="string"?e.jsx("span",{className:"text-xs mr-1","aria-hidden":"true",children:Je.emoji}):e.jsx(Ue,{size:8,className:"mr-1"})),Be]},Ve)}),ke.length>3&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-[10px] font-medium bg-gray-100 text-gray-600",children:["+",ke.length-3]})]})};return e.jsxs("div",{className:"p-6 pt-2 space-y-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-4 pt-1 pb-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Property Search"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white text-xs rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(rt,{size:14}),e.jsx("span",{children:"Smart Match"})]}),e.jsxs("button",{onClick:a,className:"flex items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-[#E6761D] to-[#CC6A1A] text-white text-xs rounded-lg hover:from-[#CC6A1A] hover:to-[#B85E15] transition-all",children:[e.jsx(Mt,{size:14}),e.jsx("span",{children:"AI Suggestions"})]}),e.jsxs("button",{onClick:()=>{he?se(!1):(se(!0),requestAnimationFrame(()=>{var _;(_=de.current)==null||_.scrollIntoView({behavior:"smooth",block:"start"})}))},className:"flex items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-[#E6761D] to-[#CC6A1A] text-white rounded-lg text-xs hover:from-[#CC6A1A] hover:to-[#B85E15] transition-all",children:[e.jsx(ro,{size:14}),e.jsx("span",{children:he?"Hide Filters":"Search Filters"})]}),e.jsxs("label",{className:"flex items-center gap-2 ml-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"respectBudget",checked:C,onChange:_=>J(_.target.checked),className:"w-4 h-4 text-[#E6761D] bg-gray-100 border-gray-300 rounded focus:ring-[#E6761D] focus:ring-2"}),e.jsx("span",{className:"text-xs text-gray-700",children:"Respect Buyer Budget"})]})]})]})}),e.jsx("div",{children:e.jsx("div",{ref:de,className:"scroll-mt-20",children:he&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:q.location,onChange:_=>ne({...q,location:_.target.value}),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] text-xs",placeholder:"Enter location (e.g., hinjewadi)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Min Price"}),e.jsx("input",{type:"number",placeholder:"500000",value:q.minPrice??"",onChange:_=>ne({...q,minPrice:_.target.value===""?null:Number(_.target.value)}),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Max Price"}),e.jsx("input",{type:"number",placeholder:"1000000",value:q.maxPrice??"",onChange:_=>ne({...q,maxPrice:_.target.value===""?null:Number(_.target.value)}),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit Types"}),e.jsx("input",{type:"text",value:q.unitTypes.join(","),onChange:_=>ne({...q,unitTypes:_.target.value.split(",").map(ae=>ae.trim()).filter(Boolean)}),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] text-xs",placeholder:"1BHK,2BHK,3BHK"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sort"}),e.jsxs("select",{value:q.sort,onChange:_=>ne({...q,sort:_.target.value}),className:"w-full px-2.5 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#E6761D] text-xs",children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"low_to_high",children:"Price: Low to High"}),e.jsx("option",{value:"high_to_low",children:"Price: High to Low"}),e.jsx("option",{value:"medium",children:"Price: Mid"})]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:$e,className:"px-3 py-1.5 bg-gray-100 text-gray-700 text-xs rounded-lg hover:bg-gray-200 transition-colors",children:"Reset"}),e.jsx("button",{onClick:Fe,className:"px-4 py-1.5 bg-emerald-600 text-white text-xs rounded-lg hover:bg-emerald-700 transition-colors",children:"Search Properties"})]})]})})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Search Results"}),b&&e.jsx("div",{className:"text-center py-10 text-sm text-gray-600",children:"Loading propertiesâ€¦"}),d&&!b&&e.jsx("div",{className:"text-center py-10 text-sm text-red-600",children:d}),!b&&!d&&O.length===0&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(Is,{className:"mx-auto text-gray-300 mb-3",size:48}),ge?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-1",children:"No Results Found"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Try adjusting your filters to find matching properties."}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx("button",{onClick:$e,className:"px-3 py-1.5 bg-gray-100 text-gray-700 text-xs rounded-lg hover:bg-gray-200 transition-colors",children:"Reset Filters"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-1",children:"Start Your Property Search"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Use our AI-powered tools to find your perfect home"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:a,className:"flex items-center gap-1.5 px-4 py-2 bg-gradient-to-r from-[#E6761D] to-[#CC6A1A] text-white text-xs rounded-lg hover:from-[#CC6A1A] hover:to-[#B85E15] transition-all",children:[e.jsx(Mt,{size:14}),e.jsx("span",{children:"AI Property Search"})]}),e.jsxs("button",{onClick:t,className:"flex items-center gap-1.5 px-4 py-2 bg-blue-600 text-white text-xs rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(rt,{size:14}),e.jsx("span",{children:"Smart Matching"})]})]})]})]}),!b&&!d&&O.length>0&&e.jsx("div",{className:"space-y-3",children:O.map(_=>{var ae,ke;return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-28 h-20 rounded-lg overflow-hidden bg-gray-100 flex-none",children:e.jsx(Y,{src:_.photo,alt:_.title})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-[#0b3856]",children:_.title}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-600 mt-0.5 text-xs",children:[e.jsx(Qs,{size:12}),e.jsx("span",{className:"truncate max-w-[60vw] sm:max-w-[40vw]",children:_.address||"â€”"})]}),e.jsx("div",{className:"uppercase",children:e.jsx(ye,{propertyId:((ae=_._raw)==null?void 0:ae.id)||_.id,tags:_.tags})}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("div",{className:`px-2 py-0.5 rounded-full text-[11px] font-semibold ${Ie(_.matchScore)}`,children:[_.matchScore,"% Match"]}),e.jsx(ze,{status:_.statusText}),ue.has(_.id)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-medium bg-purple-100 text-purple-700",children:"â­ Shortlisted"})]})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("div",{className:"text-base font-bold text-green-600",children:N(_.price)}),e.jsx("div",{className:"text-[11px] text-gray-500",children:_.size})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-1 mt-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Floor:"})," ",e.jsx("span",{className:"font-semibold",children:_.floorLine})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Facing:"})," ",e.jsx("span",{className:"font-semibold",children:_.facing})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Possession:"})," ",e.jsx("span",{className:"font-semibold",children:_.possession})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Parking:"})," ",e.jsx("span",{className:"font-semibold",children:_.parking})]})]}),((ke=_.reasons)==null?void 0:ke.length)>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Why it matches:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:_.reasons.slice(0,4).map((Me,Ye)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[11px] font-medium bg-blue-50 text-blue-600",children:Me},`${Me}-${Ye}`))})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs",onClick:()=>r?r(_):console.log("Visit",_),children:[e.jsx(Ts,{size:14}),e.jsx("span",{children:"Visit"})]}),e.jsxs("button",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg transition-colors text-xs ${ue.has(_.id)?"bg-purple-600 text-white hover:bg-purple-700":"bg-purple-100 text-purple-700 hover:bg-purple-200"}`,onClick:()=>xe(_),children:[e.jsx(kl,{size:12,className:ue.has(_.id)?"fill-current":""}),e.jsx("span",{children:ue.has(_.id)?"Shortlisted":"Shortlist"})]}),e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-gray-200 text-gray-700 rounded-lg text-xs hover:bg-gray-300 transition-colors",onClick:()=>Xe(_),title:"View property details",children:[e.jsx(ks,{size:14}),e.jsx("span",{children:"View Details"})]}),e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-xs",onClick:()=>Ke(_),title:"Open public property page",children:[e.jsx(Kn,{size:14}),e.jsx("span",{children:"Visit Website"})]}),e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200 transition-colors text-xs",onClick:()=>Ee(_),title:"Share property",children:[e.jsx(ja,{size:14}),e.jsx("span",{children:"Share"})]})]})]})]})},_.id)})})]}),U&&re&&e.jsx(xn,{url:re.url,title:re.title,description:re.description,image:re.image,trackingToken:re.trackingToken,onClose:()=>{X(!1),fe(null)}})]})},du=()=>{const{id:s}=on(),a=Ca(),[t,r]=l.useState(null),[i,n]=l.useState(!0),[o,m]=l.useState(null);l.useEffect(()=>{(async()=>{if(!s){n(!1),m("No buyer id provided");return}try{n(!0);const v=await Vt.getById(s);r(v||null),m(null)}catch{m("Failed to load buyer data"),r(null)}finally{n(!1)}})()},[s]);const g=()=>a("/"),b=async d=>{try{await Vt.update(s,d),r(d)}catch(v){Z.error("Error updating buyer:",v)}};return i?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Kr,{className:"h-8 w-8 animate-spin mx-auto text-purple-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading buyer account..."})]})}):o||!t?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("svg",{className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Buyer Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:o||"The buyer you are looking for does not exist."}),e.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors mx-auto",children:[e.jsx(ga,{size:16}),e.jsx("span",{children:"Back to Buyers"})]})]})}):e.jsx(_2,{buyer:t,onBack:g,onUpdateBuyer:b})},mu=()=>{const{id:s}=on(),a=Ca(),[t,r]=l.useState(null),[i,n]=l.useState(!0),[o,m]=l.useState(null);l.useEffect(()=>{let d=!0;return(async()=>{var x;if(!s){d&&(n(!1),m("No seller id provided"));return}try{n(!0);const u=await st.getById(s);d&&(r({...u.data.seller,properties:u.data.properties||[],properties_count:((x=u.data.properties)==null?void 0:x.length)||0}),m(null))}catch(u){Z.error("Error fetching seller:",u),d&&(m("Failed to load seller data"),r(null))}finally{d&&n(!1)}})(),()=>{d=!1}},[s]);const g=()=>a("/"),b=async d=>{try{const v=await st.update(s,d);r(v)}catch(v){Z.error("Error updating seller:",v)}};return i?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Kr,{className:"h-8 w-8 animate-spin mx-auto text-blue-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading seller account..."})]})}):o||!t?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("svg",{className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.962-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Seller Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:o||"The seller you are looking for does not exist."}),e.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors mx-auto",children:[e.jsx(ga,{size:16}),e.jsx("span",{children:"Back to Sellers"})]})]})}):e.jsx(fg,{seller:t,onBack:g,onUpdateSeller:b})},Ai=[{id:"buyer",label:"Buyer Variables"},{id:"seller",label:"Seller Variables"},{id:"property",label:"Property Variables"},{id:"leads",label:"Leads Variables"},{id:"account",label:"Account Variables"},{id:"company",label:"Company Variables"},{id:"common",label:"Common Variables"}],Pi=(s="")=>s.trim().replace(/[^a-zA-Z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"").toLowerCase(),Rr=(s="")=>s?`{{${s}}}`:"",C2={buyer:{display:"Buyer Name",key:"buyer_name"},seller:{display:"Seller Name",key:"seller_name"},property:{display:"Property Title",key:"property_title"},leads:{display:"Lead Name",key:"lead_name"},account:{display:"Account Name",key:"account_name"},company:{display:"Company Name",key:"company_name"},common:{display:"Common Variable",key:"common_variable"}},A2=()=>{var ee,de;const[s,a]=l.useState({}),[t,r]=l.useState(Ai[0].id),[i,n]=l.useState(""),[o,m]=l.useState(!1),[g,b]=l.useState(null),[d,v]=l.useState({name:"",variable_key:"",placeholder:"",status:"active"}),[x,u]=l.useState(!1),[c,f]=l.useState(""),[p,N]=l.useState(new Set),P=l.useRef(null),[w,$]=l.useState(!1),[y,k]=l.useState(!1),[R,F]=l.useState(t),[T,j]=l.useState(!0),E=l.useRef(null),V=l.useMemo(()=>{const U=new Map;return Ai.forEach(X=>U.set(X.id,X)),U},[]),W=((ee=V.get(t))==null?void 0:ee.label)??"Variables",B=C2[t]||{display:"Variable Name",key:"variable_name"},M=U=>{const X=["name","variable_key","placeholder","variable_tab_id","category","status"],fe={buyer:[["Buyer Name","buyer_name","{{buyer_name}}","buyer","buyer","active"]],seller:[["Seller Name","seller_name","{{seller_name}}","seller","seller","active"]],property:[["Property Title","property_title","{{property_title}}","property","property","active"]],leads:[["Lead Name","lead_name","{{lead_name}}","leads","leads","active"]],account:[["Account Name","account_name","{{account_name}}","account","account","active"],["Account Number","account_number","{{account_number}}","account","account","inactive"]],company:[["Company Name","company_name","{{company_name}}","company","company","active"]],common:[["Common Variable","common_variable","{{common_variable}}","common","common","active"]]}[U]||[["Sample Name","sample_key","{{sample_key}}",U,U,"active"]],G=[X,...fe].map(me=>me.map(oe=>`"${String(oe).replace(/"/g,'""')}"`).join(",")).join(`
`);return new Blob([G],{type:"text/csv;charset=utf-8;"})},A=(U,X)=>{const re=M(U),fe=URL.createObjectURL(re),G=document.createElement("a");G.href=fe,G.download=`Import_Template_${X.replace(/\s+/g,"_")}.csv`,G.click(),URL.revokeObjectURL(fe)},L=async U=>{try{$(!0);const X=await ll.getByTab(U);X!=null&&X.success?a(re=>({...re,[U]:X.data||[]})):Z.error("Failed to fetch variables.")}catch(X){console.error("Error fetching variables:",X),Z.error("Failed to fetch variables.")}finally{$(!1)}};l.useEffect(()=>{L(t),N(new Set)},[t]);const D=l.useMemo(()=>{const U=i.trim().toLowerCase(),X=s[t]||[];return U?X.filter(re=>re.name.toLowerCase().includes(U)||re.variable_key.toLowerCase().includes(U)||re.placeholder.toLowerCase().includes(U)):X},[s,t,i]),I=l.useMemo(()=>Object.values(s).reduce((U,X)=>U+((X==null?void 0:X.length)||0),0),[s]),H=l.useMemo(()=>{var X;const U=new Map;for(const re of Ai)U.set(re.id,((X=s[re.id])==null?void 0:X.length)??0);return U},[s]),h=()=>{b(null),v({name:"",variable_key:"",placeholder:"",status:"active"}),u(!1),f(""),m(!1)},Y=()=>{b(null),v({name:"",variable_key:"",placeholder:"",status:"active"}),u(!1),f(""),m(!0)},K=U=>{b(U.id),v({name:U.name,variable_key:U.variable_key,placeholder:U.placeholder,status:U.status}),u(!0),f(""),m(!0)},q=(U,X,re,fe)=>U.trim()?X.trim()?/^[a-z0-9_]+$/.test(X)?re!==Rr(X)?`Placeholder must be ${Rr(X)}`:(s[t]||[]).some(oe=>oe.variable_key.toLowerCase()===X.toLowerCase()&&oe.id!==fe)?`Variable Key '${X}' already exists in this tab.`:"":"Variable Key must contain only lowercase letters, numbers, and underscores.":"Please enter Variable Key.":"Please enter Name.",ne=async()=>{const U=d.name.trim(),X=x&&d.variable_key?d.variable_key:Pi(U),re=Rr(X),fe=q(U,X,re,null);if(fe){f(fe),Z.error(fe);return}try{const G={name:U,variable_key:X,placeholder:re,variable_tab_id:t,category:t,status:d.status},me=await ll.create(G);me!=null&&me.success?(Z.success("Variable added."),await L(t),h()):Z.error("Failed to add variable.")}catch(G){const me=(G==null?void 0:G.message)||"Error adding variable";f(me),Z.error(me)}},le=async()=>{if(!g)return;const U=d.variable_key||Pi(d.name),X=Rr(U),re=q(d.name,U,X,g);if(re){f(re),Z.error(re);return}try{const fe={name:d.name,variable_key:U,placeholder:X,status:d.status},G=await ll.update(g,fe);G!=null&&G.success?(Z.success("Variable updated."),await L(t),h()):Z.error("Failed to update variable.")}catch(fe){const G=(fe==null?void 0:fe.message)||"Error updating variable";f(G),Z.error(G)}},S=async U=>{if(window.confirm("Delete this variable?"))try{const X=await ll.delete(U);X!=null&&X.success?(Z.success("Variable deleted."),await L(t)):Z.error("Failed to delete variable.")}catch(X){console.error(X),Z.error("Failed to delete variable.")}},C=async()=>{if(p.size&&window.confirm(`Delete ${p.size} selected variable(s)?`))try{const U=await ll.bulkDelete(Array.from(p));U!=null&&U.success?(Z.success(`${p.size} variable(s) deleted.`),await L(t),N(new Set)):Z.error("Failed to delete selected variables.")}catch(U){console.error(U),Z.error("Failed to delete selected variables.")}},J=async U=>{if(p.size)try{const X=await ll.bulkUpdateStatus(Array.from(p),U);X!=null&&X.success?(Z.success(`Marked ${p.size} as ${U==="active"?"Active":"Inactive"}.`),await L(t),N(new Set)):Z.error("Failed to update status.")}catch(X){console.error(X),Z.error("Failed to update status.")}},ue=U=>{U.target.checked?N(new Set(D.map(X=>X.id))):N(new Set)},Q=U=>{N(X=>{const re=new Set(X);return re.has(U)?re.delete(U):re.add(U),re})},he=()=>{const U=s[t]||[],re=[["id","name","variable_key","placeholder","variable_tab_id","category","status"].join(","),...U.map(oe=>[oe.id,`"${oe.name.replace(/"/g,'""')}"`,oe.variable_key,oe.placeholder,oe.variable_tab_id,oe.category,oe.status].join(","))].join(`
`),fe=new Blob([re],{type:"text/csv;charset=utf-8;"}),G=URL.createObjectURL(fe),me=document.createElement("a");me.href=G,me.download=`${t}-variables.csv`,me.click(),URL.revokeObjectURL(G),Z.success(`Exported ${U.length} item(s).`)},se=()=>{F(t),j(!0),k(!0)},ge=async()=>{var X,re;const U=(re=(X=E.current)==null?void 0:X.files)==null?void 0:re[0];if(!U){Z.error("Please select a file to import.");return}try{const fe=new FormData;fe.append("file",U),fe.append("tabId",R),fe.append("skipDup",String(T));const G=await fetch(`/variables/import?tabId=${encodeURIComponent(R)}&skipDup=${T?"1":"0"}`,{method:"POST",body:fe}),me=await G.json().catch(()=>({}));G.ok&&(me!=null&&me.success)?(Z.success((me==null?void 0:me.message)||"Import completed."),k(!1),await L(R)):Z.error((me==null?void 0:me.message)||"Import failed.")}catch(fe){console.error(fe),Z.error((fe==null?void 0:fe.message)||"Import failed.")}};return e.jsxs("div",{className:"bg-slate-50 text-xs",children:[e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsx("header",{className:"flex items-center justify-between gap-3 p-4 border-b bg-white shadow-sm",children:e.jsxs("h1",{className:"text-lg font-semibold",children:["Variable Data Management",e.jsxs("span",{className:"ml-2 rounded-full bg-slate-100 px-2 py-0.5 text-xs text-slate-700",children:["Total: ",I]})]})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"no-scrollbar flex gap-2 overflow-x-auto px-3 py-2",children:Ai.map(U=>e.jsx("button",{onClick:()=>r(U.id),className:`flex-shrink-0 whitespace-nowrap rounded-lg px-3 py-1 transition-colors ${t===U.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.jsx("span",{children:U.label})},U.id))})}),e.jsxs("div",{className:"mt-4 flex items-center gap-3 p-4",children:[e.jsx("div",{className:"font-bold text-slate-900",children:W}),e.jsxs("div",{className:"text-slate-500",children:[H.get(t)??0," items"]}),e.jsx("div",{className:"ml-auto w-full max-w-md",children:e.jsx("input",{className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100",placeholder:`Search in ${W}...`,value:i,onChange:U=>n(U.target.value)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-md bg-emerald-600 px-3 py-2 text-white hover:bg-emerald-700",onClick:se,children:[e.jsx(dt,{size:14}),"Import"]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-md bg-orange-600 px-3 py-2 text-white hover:bg-orange-700",onClick:he,children:[e.jsx(Ys,{size:14}),"Export"]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-3 py-2 text-white hover:bg-blue-700",onClick:Y,children:[e.jsx(fs,{size:14}),"Add Variable"]})]})]}),e.jsxs("div",{className:"mx-4 mt-4 rounded-xl bg-white shadow-sm ring-1 ring-slate-200",children:[p.size>0&&e.jsxs("div",{className:"flex items-center justify-between rounded-t-xl border-b border-blue-200 bg-blue-50 px-4 py-2",children:[e.jsxs("div",{className:"font-semibold text-blue-800",children:[p.size," selected"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>J("active"),className:"inline-flex items-center gap-1 font-medium text-green-600 hover:text-green-800",children:[e.jsx($l,{size:12}),"Mark as Active"]}),e.jsxs("button",{onClick:()=>J("inactive"),className:"inline-flex items-center gap-1 font-medium text-slate-600 hover:text-slate-800",children:[e.jsx(Ta,{size:12}),"Mark as Inactive"]}),e.jsxs("button",{onClick:C,className:"inline-flex items-center gap-1 font-medium text-red-600 hover:text-red-800",children:[e.jsx(Es,{size:12}),"Delete Selected"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 uppercase text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-4 p-3",children:e.jsx("input",{type:"checkbox",ref:P,onChange:ue,className:"h-4 w-4 rounded border-slate-300 bg-slate-100 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-6 py-3",children:"Name"}),e.jsx("th",{className:"px-6 py-3",children:"Key"}),e.jsx("th",{className:"px-6 py-3",children:"Placeholder"}),e.jsx("th",{className:"px-6 py-3",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:w?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-0",children:e.jsx(md,{colSpan:6})})}):D.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"py-16 text-center text-slate-500",children:[e.jsx("p",{className:"font-semibold",children:"No variables found."}),e.jsx("p",{className:"mt-1",children:"Try another search or click â€œAdd Variableâ€."})]})}):D.map(U=>e.jsxs("tr",{className:`border-b ${p.has(U.id)?"bg-blue-50":"bg-white"} hover:bg-slate-50`,children:[e.jsx("td",{className:"w-4 p-3",children:e.jsx("input",{type:"checkbox",checked:p.has(U.id),onChange:()=>Q(U.id),className:"h-4 w-4 rounded border-slate-300 bg-slate-100 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:U.name}),e.jsx("td",{className:"px-6 py-3 font-mono text-slate-800",children:U.variable_key}),e.jsx("td",{className:"px-6 py-3 font-mono text-blue-700",children:U.placeholder}),e.jsx("td",{className:"px-6 py-3",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 font-medium ${U.status==="active"?"bg-green-100 text-green-800":"bg-slate-100 text-slate-600"}`,children:U.status==="active"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>K(U),className:"rounded-md p-2 text-blue-600 hover:bg-blue-100",title:"Edit",children:e.jsx(Ei,{size:14})}),e.jsx("button",{onClick:()=>S(U.id),className:"rounded-md p-2 text-red-600 hover:bg-red-100",title:"Delete",children:e.jsx(Es,{size:14})})]})})]},U.id))})]})})]})]}),e.jsxs(ma,{isOpen:o,onClose:h,title:g?`Edit Variable â€” ${W}`:`Add New Variable â€” ${W}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block font-medium text-slate-700",children:"Name"}),e.jsx("input",{type:"text",value:d.name,onChange:U=>{const X=U.target.value,re=Pi(X);v(fe=>({...fe,name:X,variable_key:x?fe.variable_key:re,placeholder:Rr(x?fe.variable_key:re)})),f("")},placeholder:`e.g., ${B.display}`,className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block font-medium text-slate-700",children:"Variable Key"}),e.jsx("input",{type:"text",value:d.variable_key,onChange:U=>{u(!0);const X=Pi(U.target.value);v(re=>({...re,variable_key:X,placeholder:Rr(X)})),f("")},placeholder:B.key,className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 font-mono outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"mb-1 block font-medium text-slate-700",children:"Placeholder"}),e.jsx("input",{type:"text",value:d.placeholder,onChange:U=>{v(X=>({...X,placeholder:U.target.value.trim()})),f("")},placeholder:Rr(B.key),className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 font-mono outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),e.jsxs("p",{className:"mt-1 text-[11px] text-slate-500",children:["Must match ",e.jsx("span",{className:"font-mono",children:"{{"+(d.variable_key||B.key)+"}}"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"mb-1 block font-medium text-slate-700",children:"Status"}),e.jsxs("select",{value:d.status,onChange:U=>v(X=>({...X,status:U.target.value})),className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),c&&e.jsx("div",{className:"mt-3 font-medium text-red-600",children:c})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("button",{onClick:h,className:"rounded-md bg-white px-3 py-2 font-medium text-slate-700 ring-1 ring-slate-300 hover:bg-slate-100",children:"Cancel"}),e.jsxs("button",{onClick:g?le:ne,className:"inline-flex items-center justify-center gap-2 rounded-md bg-blue-600 px-3 py-2 font-medium text-white hover:bg-blue-700",children:[g?e.jsx(_a,{size:14}):e.jsx(fs,{size:14}),g?"Update Variable":"Add Variable"]})]})]}),e.jsx(ma,{isOpen:y,onClose:()=>k(!1),title:`Import ${((de=V.get(R))==null?void 0:de.label)||"Variables"}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>{var U;return A(R,((U=V.get(R))==null?void 0:U.label)||"Variables")},className:"inline-flex items-center gap-2 rounded-md bg-green-600 px-3 py-2 text-sm font-medium text-white hover:bg-green-700",children:[e.jsx(Ys,{size:14}),"Download Template"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{id:"skipDup",type:"checkbox",checked:T,onChange:U=>j(U.target.checked),className:"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("label",{htmlFor:"skipDup",className:"text-sm text-slate-700",children:["Skip duplicates (by ",e.jsx("span",{className:"font-mono",children:"variable_key"}),")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-slate-700",children:"Select File (CSV or Excel)"}),e.jsx("input",{ref:E,type:"file",accept:".csv,.xlsx,.xls",className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),e.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Supported columns: ",e.jsx("span",{className:"font-mono",children:"name, variable_key, placeholder, variable_tab_id, category, status"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("button",{onClick:()=>k(!1),className:"rounded-md bg-white px-3 py-2 font-medium text-slate-700 ring-1 ring-slate-300 hover:bg-slate-100",children:"Cancel"}),e.jsxs("button",{onClick:ge,className:"inline-flex items-center justify-center gap-2 rounded-md bg-blue-600 px-3 py-2 font-medium text-white hover:bg-blue-700",children:[e.jsx(dt,{size:14}),"Import"]})]})]})})]})},Ti="block text-sm font-medium text-gray-700 mb-2",xu=()=>new Date().toISOString(),P2=(...s)=>s.filter(Boolean).join(" ");function cl(s,a="success"){const t=document.createElement("div");t.className=P2("fixed top-4 right-4 z-[9999] px-4 py-3 rounded-lg shadow-lg text-white transition-all",a==="success"&&"bg-emerald-600",a==="error"&&"bg-red-600",a==="info"&&"bg-gray-800"),t.textContent=s,document.body.appendChild(t),setTimeout(()=>{t.style.opacity="0",t.style.transform="translateY(-6px)"},2200),setTimeout(()=>t.remove(),2800)}const Ii=(s,a)=>String(s)===String(a),T2=s=>{if(!s)return"â€”";const a=new Date(s);return isNaN(a.getTime())?"â€”":a.toLocaleString()},zr=s=>[...s].sort((a,t)=>new Date(t.updated_at).getTime()-new Date(a.updated_at).getTime());function I2({preview:s,onRemove:a}){return e.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-gray-200 bg-white group",children:[e.jsx("img",{src:s.url,alt:s.name,className:"w-full h-28 object-cover"}),e.jsx("button",{type:"button",onClick:a,title:"Remove",className:"absolute top-2 right-2 inline-flex items-center justify-center rounded-full bg-white/95 hover:bg-white shadow p-1 opacity-0 group-hover:opacity-100 transition",children:e.jsx(Es,{className:"h-4 w-4 text-red-600"})}),e.jsx("div",{className:"px-2 py-1 text-[11px] text-gray-600 truncate",children:s.name})]})}function $2({open:s,onClose:a,block:t}){var r;return!s||!t?null:e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-semibold",children:[e.jsx(ks,{className:"h-5 w-5 text-blue-600"})," Preview"]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100",children:e.jsx(ns,{className:"h-5 w-5"})})]}),e.jsx("section",{className:"bg-gradient-to-r from-blue-600 to-purple-700 text-white py-12",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 text-center",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-3",children:t.title}),e.jsx("p",{className:"text-base md:text-lg text-blue-100 mb-8",children:t.description}),((r=t.photos)==null?void 0:r.length)>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.photos.map((i,n)=>e.jsx("img",{src:i.url,alt:i.name,className:"w-full h-32 object-cover rounded-lg border border-white/20"},n))})]})})]})]})}function E2({open:s,onClose:a,onConfirm:t,itemId:r,title:i="Are you sure?",body:n="This action cannot be undone."}){if(!s)return null;const o=r==null;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),e.jsx("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:e.jsxs("div",{className:"px-6 py-5",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:i}),e.jsx("p",{className:"text-gray-600 text-sm",children:n}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg border hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>{r!=null&&t(r),a()},className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 disabled:opacity-50",disabled:o,children:"Delete"})]})]})})]})}function M2({open:s,onClose:a,onSubmit:t,initial:r}){const[i,n]=l.useState((r==null?void 0:r.title)??""),[o,m]=l.useState((r==null?void 0:r.description)??""),[g,b]=l.useState((r==null?void 0:r.photos)??[]);l.useEffect(()=>{s&&(n((r==null?void 0:r.title)??""),m((r==null?void 0:r.description)??""),b((r==null?void 0:r.photos)??[]))},[s]);const d=v=>{const u=["image/jpeg","image/png","image/webp","image/gif","image/x-icon"],c=v.map(f=>new Promise(p=>{if(!u.includes(f.type)||f.size>5242880)return p(null);const N=new FileReader;N.onload=()=>p({url:String(N.result||""),name:f.name,size:f.size,file:f}),N.readAsDataURL(f)}));Promise.all(c).then(f=>{const p=f.filter(Boolean);p.length&&b(N=>[...N,...p])})};return s?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-semibold",children:[e.jsx(bc,{className:"h-5 w-5 text-blue-600"})," ",r!=null&&r.id?"Edit Hero Block":"Add Hero Block"]}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100",children:e.jsx(ns,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:Ti,children:"Title"}),e.jsx("input",{type:"text",value:i,onChange:v=>n(v.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:Ti,children:"Description"}),e.jsx("textarea",{value:o,onChange:v=>m(v.target.value),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:Ti,children:" Photos (JPG/PNG, Multiple)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center hover:border-gray-300 transition-colors bg-white",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png",multiple:!0,onChange:v=>{const x=Array.from(v.target.files||[]);x.length>0&&d(x),v.currentTarget.value=""},className:"hidden",id:"hero-photos"}),e.jsxs("label",{htmlFor:"hero-photos",className:"cursor-pointer",children:[e.jsx(dt,{className:"h-5 w-5 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:g.length>0?"Add More Photos":"Choose Photos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG up to 5MB each"})]})]})]}),g.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:Ti,children:["Photos Preview (",g.length," files)"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 max-h-56 overflow-y-auto",children:g.map((v,x)=>e.jsx(I2,{preview:v,onRemove:()=>b(u=>u.filter((c,f)=>f!==x))},`${v.name}-${x}`))})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg border hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>{if(!i.trim())return cl("Title is required","error");t({title:i.trim(),description:o.trim(),photos:g}),a()},className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700",children:r!=null&&r.id?"Update":"Create"})]})]})]}):null}function L2(){const[s,a]=l.useState([]),[t,r]=l.useState(!0),[i,n]=l.useState(""),[o,m]=l.useState(!1),[g,b]=l.useState(null),[d,v]=l.useState(!1),[x,u]=l.useState(null),[c,f]=l.useState(!1),[p,N]=l.useState(null);l.useEffect(()=>{(async()=>{var k,R;try{r(!0);const F=await Fr.list();a(zr(F))}catch(F){console.error(F),cl(((R=(k=F==null?void 0:F.response)==null?void 0:k.data)==null?void 0:R.error)||"Failed to load hero blocks","error")}finally{r(!1)}})()},[]);const P=l.useMemo(()=>{if(!i.trim())return s;const k=i.toLowerCase();return s.filter(R=>[R.title,R.description].some(F=>F==null?void 0:F.toLowerCase().includes(k)))},[s,i]),w=async(k,R)=>{var T,j;const F=async()=>{try{const E=await Fr.list();a(zr(E))}catch{}};try{if(R!=null){const E=xu();a(W=>zr(W.map(B=>Ii(B.id,R)?{...B,...k,updated_at:E}:B)));const V=await Fr.update(R,k);a(W=>zr(W.map(B=>{var M;return Ii(B.id,R)?{...B,...V,title:V.title||B.title,description:V.description||B.description,photos:((M=V.photos)!=null&&M.length?V.photos:B.photos)||[],created_at:V.created_at||B.created_at,updated_at:V.updated_at||B.updated_at}:B}))),cl("Block updated","success")}else{const E=`temp-${Date.now()}`,V=xu(),W={id:E,...k,created_at:V,updated_at:V};a(M=>zr([W,...M]));const B=await Fr.create(k);a(M=>zr(M.map(A=>{var L;return Ii(A.id,E)?{...A,...B,title:B.title||A.title,description:B.description||A.description,photos:((L=B.photos)!=null&&L.length?B.photos:A.photos)||[],created_at:B.created_at||A.created_at,updated_at:B.updated_at||A.updated_at}:A}))),cl("Block created","success")}}catch(E){console.error(E),cl(((j=(T=E==null?void 0:E.response)==null?void 0:T.data)==null?void 0:j.error)||"Save failed","error"),await F()}},$=k=>{N(k),f(!0)},y=async k=>{var R,F;a(T=>T.filter(j=>!Ii(j.id,k)));try{await Fr.remove(k),cl("Deleted successfully","success")}catch(T){console.error(T),cl(((F=(R=T==null?void 0:T.response)==null?void 0:R.data)==null?void 0:F.error)||"Delete failed","error");try{const j=await Fr.getById(k);a(E=>zr([j,...E]))}catch{const j=await Fr.list();a(zr(j))}}finally{N(null)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 py-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_t,{className:"text-blue-600",size:24}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Home Page Management"})]}),e.jsxs("div",{className:"flex flex-1 md:flex-none items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 md:w-80",children:[e.jsx(it,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{value:i,onChange:k=>n(k.target.value),placeholder:"Search blocks...",className:"w-full pl-9 pr-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("button",{onClick:()=>{b(null),m(!0)},className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700",children:[e.jsx(fs,{className:"h-4 w-4"})," New Block"]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t?e.jsx("div",{className:"bg-white rounded-2xl shadow p-10 text-center text-gray-600",children:"Loading hero blocksâ€¦"}):P.length===0?e.jsxs("div",{className:"bg-white rounded-2xl shadow p-10 text-center",children:[e.jsx(bc,{className:"w-10 h-10 text-gray-300 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"No hero blocks yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first home page hero block to get started."}),e.jsxs("button",{onClick:()=>{b(null),m(!0)},className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700",children:[e.jsx(fs,{className:"h-4 w-4"})," Add Hero Block"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:P.map(k=>{var R,F;return e.jsxs("div",{className:"bg-white rounded-2xl shadow border overflow-hidden flex flex-col",children:[(R=k.photos)!=null&&R[0]?e.jsx("img",{src:k.photos[0].url,className:"w-full h-40 object-cover",alt:k.photos[0].name}):e.jsx("div",{className:"w-full h-40 bg-gray-100 flex items-center justify-center text-gray-400",children:e.jsx(bc,{className:"h-7 w-7"})}),e.jsxs("div",{className:"p-5 flex flex-col gap-3 flex-1",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-1",children:k.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:k.description})]}),e.jsxs("div",{className:"mt-auto flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Updated: ",T2(k.updated_at)]}),e.jsxs("span",{children:[((F=k.photos)==null?void 0:F.length)||0," photo(s)"]})]})]}),e.jsxs("div",{className:"px-5 pb-5 pt-3 flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{u(k),v(!0)},className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg border hover:bg-gray-50",children:[e.jsx(ks,{className:"h-4 w-4"})," Preview"]}),e.jsxs("button",{onClick:()=>{b(k),m(!0)},className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-900 text-white hover:bg-black",children:[e.jsx(ln,{className:"h-4 w-4"})," Edit"]}),e.jsxs("button",{onClick:()=>$(k),className:"ml-auto inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",children:[e.jsx(Es,{className:"h-4 w-4"})," Delete"]})]})]},String(k.id))})})}),e.jsx(M2,{open:o,initial:g||void 0,onClose:()=>m(!1),onSubmit:k=>w(k,g==null?void 0:g.id)}),e.jsx($2,{open:d,block:x,onClose:()=>v(!1)}),e.jsx(E2,{open:c,onClose:()=>f(!1),onConfirm:y,itemId:p==null?void 0:p.id,title:"Delete this block?",body:"This will permanently remove the hero block."})]})}const D2=()=>e.jsx("div",{children:"DigioSuccess"});function R2(){return dp(),e.jsxs(e.Fragment,{children:[e.jsx(Lh,{children:e.jsx("meta",{property:"og:url",content:window.location.href})}),e.jsx(Dh,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsx(sp,{children:e.jsx(ap,{children:e.jsx($u,{children:e.jsxs(Rh,{children:[e.jsx(Z1,{smooth:!1}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs(zh,{children:[e.jsx(Ks,{path:"/buyer-dashboard/:id",element:e.jsx(ho,{children:e.jsx(du,{})})}),e.jsx(Ks,{path:"/seller-dashboard/:id",element:e.jsx(ho,{children:e.jsx(mu,{})})}),e.jsx(Ks,{path:"/digio/success",element:e.jsx(D2,{})}),e.jsxs(Ks,{path:"/",element:e.jsx(R1,{}),children:[e.jsx(Ks,{index:!0,element:e.jsx(d0,{})}),e.jsx(Ks,{path:"properties",element:e.jsx(f0,{})}),e.jsx(Ks,{path:"properties/:slug",element:e.jsx(rd,{})}),e.jsx(Ks,{path:"about",element:e.jsx(y0,{})}),e.jsx(Ks,{path:"blogs",element:e.jsx(Xx,{})}),e.jsx(Ks,{path:"/blogs/:slug",element:e.jsx(Xx,{})}),e.jsx(Ks,{path:"services",element:e.jsx(N0,{})}),e.jsx(Ks,{path:"contact",element:e.jsx(T1,{})})]}),e.jsx(Ks,{path:"/login",element:e.jsx(cp,{children:e.jsx(w0,{})})}),e.jsxs(Ks,{path:"/dashboard/*",element:e.jsx(ho,{children:e.jsx(wp,{})}),children:[e.jsx(Ks,{index:!0,element:e.jsx(k0,{})}),e.jsx(Ks,{path:"admin",element:e.jsx(ib,{})}),e.jsx(Ks,{path:"manager",element:e.jsx(cb,{})}),e.jsx(Ks,{path:"agent",element:e.jsx(pb,{})}),e.jsx(Ks,{path:"leads",element:e.jsx(F0,{})}),e.jsx(Ks,{path:"leads/:id",element:e.jsx(Z0,{})}),e.jsx(Ks,{path:"buyers",element:e.jsx(py,{})}),e.jsx(Ks,{path:"buyers-account/:id",element:e.jsx(du,{})}),e.jsx(Ks,{path:"properties",element:e.jsx(qj,{})}),e.jsx(Ks,{path:"properties/:id",element:e.jsx(X0,{})}),e.jsx(Ks,{path:"sellers",element:e.jsx(kN,{})}),e.jsx(Ks,{path:"sellers-account/:id",element:e.jsx(mu,{})}),e.jsx(Ks,{path:"document-center",element:e.jsx(Kw,{})}),e.jsx(Ks,{path:"home-manager",element:e.jsx(L2,{})}),e.jsx(Ks,{path:"blog-manager",element:e.jsx(J1,{})}),e.jsx(Ks,{path:"about-cms",element:e.jsx(e2,{})}),e.jsx(Ks,{path:"contact-cms",element:e.jsx(s2,{})}),e.jsx(Ks,{path:"footer-cms",element:e.jsx(t2,{})}),e.jsx(Ks,{path:"service-cms",element:e.jsx(a2,{})}),e.jsx(Ks,{path:"contact-messages",element:e.jsx(X1,{})}),e.jsx(Ks,{path:"ai-training",element:e.jsx(Q1,{})}),e.jsx(Ks,{path:"template-center",element:e.jsx(f1,{})}),e.jsx(Ks,{path:"accounts",element:e.jsx(l1,{})}),e.jsx(Ks,{path:"vendors",element:e.jsx(i1,{})}),e.jsx(Ks,{path:"activities",element:e.jsx(eb,{})}),e.jsx(Ks,{path:"analytics",element:e.jsx(tb,{})}),e.jsx(Ks,{path:"users",element:e.jsx(lb,{})}),e.jsx(Ks,{path:"profile",element:e.jsx(tm,{})}),e.jsx(Ks,{path:"communication",element:e.jsx(Db,{})}),e.jsx(Ks,{path:"settings",element:e.jsx(tm,{})}),e.jsx(Ks,{path:"settings/roles-permissions",element:e.jsx(bb,{})}),e.jsx(Ks,{path:"settings/integrations",element:e.jsx(Ab,{})}),e.jsx(Ks,{path:"settings/ai",element:e.jsx(Pb,{})}),e.jsx(Ks,{path:"settings/master-data",element:e.jsx($b,{})}),e.jsx(Ks,{path:"settings/veriable-center",element:e.jsx(A2,{})}),e.jsx(Ks,{path:"settings/import-export",element:e.jsx(Lb,{})})]}),e.jsx(Ks,{path:"*",element:e.jsx(ar,{to:"/",replace:!0})})]}),e.jsx(ip,{})]})]})})})})]})}Tu.workerSrc=new URL("/assets/mjs/pdf.worker.min-qwK7q_zL.mjs",import.meta.url).toString();Fh.createRoot(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(Yh,{children:e.jsx($u,{children:e.jsx(R2,{})})})}));
